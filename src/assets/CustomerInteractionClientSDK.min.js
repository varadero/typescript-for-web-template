/*! jQuery v3.3.1 | (c) JS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){"use strict";var n=[],r=e.document,i=Object.getPrototypeOf,o=n.slice,a=n.concat,s=n.push,u=n.indexOf,l={},c=l.toString,f=l.hasOwnProperty,p=f.toString,d=p.call(Object),h={},g=function e(t){return"function"==typeof t&&"number"!=typeof t.nodeType},y=function e(t){return null!=t&&t===t.window},v={type:!0,src:!0,noModule:!0};function m(e,t,n){var i,o=(t=t||r).createElement("script");if(o.text=e,n)for(i in v)n[i]&&(o[i]=n[i]);t.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[c.call(e)]||"object":typeof e}var b="3.3.1",w=function(e,t){return new w.fn.init(e,t)},T=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;w.fn=w.prototype={jquery:"3.3.1",constructor:w,length:0,toArray:function(){return o.call(this)},get:function(e){return null==e?o.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||g(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],a!==(r=e[t])&&(l&&r&&(w.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,o=n&&Array.isArray(n)?n:[]):o=n&&w.isPlainObject(n)?n:{},a[t]=w.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},w.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==c.call(e))&&(!(t=i(e))||"function"==typeof(n=f.call(t,"constructor")&&t.constructor)&&p.call(n)===d)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e){m(e)},each:function(e,t){var n,r=0;if(C(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?"":(e+"").replace(T,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(C(Object(e))?w.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:u.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r,i=[],o=0,a=e.length,s=!n;o<a;o++)(r=!t(e[o],o))!==s&&i.push(e[o]);return i},map:function(e,t,n){var r,i,o=0,s=[];if(C(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&s.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&s.push(i);return a.apply([],s)},guid:1,support:h}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function C(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!g(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}var E=function(e){var t,n,r,i,o,a,s,u,l,c,f,p,d,h,g,y,v,m,x,b="sizzle"+1*new Date,w=e.document,T=0,C=0,E=ae(),k=ae(),S=ae(),D=function(e,t){return e===t&&(f=!0),0},N={}.hasOwnProperty,A=[],j=A.pop,q=A.push,L=A.push,H=A.slice,O=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},P="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",R="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",I="\\["+M+"*("+R+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+R+"))|)"+M+"*\\]",W=":("+R+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+I+")*)|.*)\\)|)",$=new RegExp(M+"+","g"),B=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),F=new RegExp("^"+M+"*,"+M+"*"),_=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),z=new RegExp("="+M+"*([^\\]'\"]*?)"+M+"*\\]","g"),X=new RegExp(W),U=new RegExp("^"+R+"$"),V={ID:new RegExp("^#("+R+")"),CLASS:new RegExp("^\\.("+R+")"),TAG:new RegExp("^("+R+"|[*])"),ATTR:new RegExp("^"+I),PSEUDO:new RegExp("^"+W),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+P+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},G=/^(?:input|select|textarea|button)$/i,Y=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,K=/[+~]/,Z=new RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),ee=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},te=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ne=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},re=function(){p()},ie=me(function(e){return!0===e.disabled&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{L.apply(A=H.call(w.childNodes),w.childNodes),A[w.childNodes.length].nodeType}catch(e){L={apply:A.length?function(e,t){q.apply(e,H.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function oe(e,t,r,i){var o,s,l,c,f,h,v,m=t&&t.ownerDocument,T=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==T&&9!==T&&11!==T)return r;if(!i&&((t?t.ownerDocument||t:w)!==d&&p(t),t=t||d,g)){if(11!==T&&(f=J.exec(e)))if(o=f[1]){if(9===T){if(!(l=t.getElementById(o)))return r;if(l.id===o)return r.push(l),r}else if(m&&(l=m.getElementById(o))&&x(t,l)&&l.id===o)return r.push(l),r}else{if(f[2])return L.apply(r,t.getElementsByTagName(e)),r;if((o=f[3])&&n.getElementsByClassName&&t.getElementsByClassName)return L.apply(r,t.getElementsByClassName(o)),r}if(n.qsa&&!S[e+" "]&&(!y||!y.test(e))){if(1!==T)m=t,v=e;else if("object"!==t.nodeName.toLowerCase()){(c=t.getAttribute("id"))?c=c.replace(te,ne):t.setAttribute("id",c=b),s=(h=a(e)).length;while(s--)h[s]="#"+c+" "+ve(h[s]);v=h.join(","),m=K.test(e)&&ge(t.parentNode)||t}if(v)try{return L.apply(r,m.querySelectorAll(v)),r}catch(e){}finally{c===b&&t.removeAttribute("id")}}}return u(e.replace(B,"$1"),t,r,i)}function ae(){var e=[];function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}return t}function se(e){return e[b]=!0,e}function ue(e){var t=d.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function le(e,t){var n=e.split("|"),i=n.length;while(i--)r.attrHandle[n[i]]=t}function ce(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function fe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function pe(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function de(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&ie(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function he(e){return se(function(t){return t=+t,se(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function ge(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}n=oe.support={},o=oe.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},p=oe.setDocument=function(e){var t,i,a=e?e.ownerDocument||e:w;return a!==d&&9===a.nodeType&&a.documentElement?(d=a,h=d.documentElement,g=!o(d),w!==d&&(i=d.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",re,!1):i.attachEvent&&i.attachEvent("onunload",re)),n.attributes=ue(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ue(function(e){return e.appendChild(d.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Q.test(d.getElementsByClassName),n.getById=ue(function(e){return h.appendChild(e).id=b,!d.getElementsByName||!d.getElementsByName(b).length}),n.getById?(r.filter.ID=function(e){var t=e.replace(Z,ee);return function(e){return e.getAttribute("id")===t}},r.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}}):(r.filter.ID=function(e){var t=e.replace(Z,ee);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},r.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&g){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),r.find.TAG=n.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},r.find.CLASS=n.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&g)return t.getElementsByClassName(e)},v=[],y=[],(n.qsa=Q.test(d.querySelectorAll))&&(ue(function(e){h.appendChild(e).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&y.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||y.push("\\["+M+"*(?:value|"+P+")"),e.querySelectorAll("[id~="+b+"-]").length||y.push("~="),e.querySelectorAll(":checked").length||y.push(":checked"),e.querySelectorAll("a#"+b+"+*").length||y.push(".#.+[+~]")}),ue(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=d.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&y.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&y.push(":enabled",":disabled"),h.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&y.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),y.push(",.*:")})),(n.matchesSelector=Q.test(m=h.matches||h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&ue(function(e){n.disconnectedMatch=m.call(e,"*"),m.call(e,"[s!='']:x"),v.push("!=",W)}),y=y.length&&new RegExp(y.join("|")),v=v.length&&new RegExp(v.join("|")),t=Q.test(h.compareDocumentPosition),x=t||Q.test(h.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},D=t?function(e,t){if(e===t)return f=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===r?e===d||e.ownerDocument===w&&x(w,e)?-1:t===d||t.ownerDocument===w&&x(w,t)?1:c?O(c,e)-O(c,t):0:4&r?-1:1)}:function(e,t){if(e===t)return f=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e===d?-1:t===d?1:i?-1:o?1:c?O(c,e)-O(c,t):0;if(i===o)return ce(e,t);n=e;while(n=n.parentNode)a.unshift(n);n=t;while(n=n.parentNode)s.unshift(n);while(a[r]===s[r])r++;return r?ce(a[r],s[r]):a[r]===w?-1:s[r]===w?1:0},d):d},oe.matches=function(e,t){return oe(e,null,null,t)},oe.matchesSelector=function(e,t){if((e.ownerDocument||e)!==d&&p(e),t=t.replace(z,"='$1']"),n.matchesSelector&&g&&!S[t+" "]&&(!v||!v.test(t))&&(!y||!y.test(t)))try{var r=m.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return oe(t,d,null,[e]).length>0},oe.contains=function(e,t){return(e.ownerDocument||e)!==d&&p(e),x(e,t)},oe.attr=function(e,t){(e.ownerDocument||e)!==d&&p(e);var i=r.attrHandle[t.toLowerCase()],o=i&&N.call(r.attrHandle,t.toLowerCase())?i(e,t,!g):void 0;return void 0!==o?o:n.attributes||!g?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},oe.escape=function(e){return(e+"").replace(te,ne)},oe.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},oe.uniqueSort=function(e){var t,r=[],i=0,o=0;if(f=!n.detectDuplicates,c=!n.sortStable&&e.slice(0),e.sort(D),f){while(t=e[o++])t===e[o]&&(i=r.push(o));while(i--)e.splice(r[i],1)}return c=null,e},i=oe.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(3===o||4===o)return e.nodeValue}else while(t=e[r++])n+=i(t);return n},(r=oe.selectors={cacheLength:50,createPseudo:se,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Z,ee),e[3]=(e[3]||e[4]||e[5]||"").replace(Z,ee),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||oe.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&oe.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return V.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=a(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Z,ee).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=E[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&E(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=oe.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace($," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,f,p,d,h,g=o!==a?"nextSibling":"previousSibling",y=t.parentNode,v=s&&t.nodeName.toLowerCase(),m=!u&&!s,x=!1;if(y){if(o){while(g){p=t;while(p=p[g])if(s?p.nodeName.toLowerCase()===v:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?y.firstChild:y.lastChild],a&&m){x=(d=(l=(c=(f=(p=y)[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]||[])[0]===T&&l[1])&&l[2],p=d&&y.childNodes[d];while(p=++d&&p&&p[g]||(x=d=0)||h.pop())if(1===p.nodeType&&++x&&p===t){c[e]=[T,d,x];break}}else if(m&&(x=d=(l=(c=(f=(p=t)[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]||[])[0]===T&&l[1]),!1===x)while(p=++d&&p&&p[g]||(x=d=0)||h.pop())if((s?p.nodeName.toLowerCase()===v:1===p.nodeType)&&++x&&(m&&((c=(f=p[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]=[T,x]),p===t))break;return(x-=i)===r||x%r==0&&x/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||oe.error("unsupported pseudo: "+e);return i[b]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?se(function(e,n){var r,o=i(e,t),a=o.length;while(a--)e[r=O(e,o[a])]=!(n[r]=o[a])}):function(e){return i(e,0,n)}):i}},pseudos:{not:se(function(e){var t=[],n=[],r=s(e.replace(B,"$1"));return r[b]?se(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}}),has:se(function(e){return function(t){return oe(e,t).length>0}}),contains:se(function(e){return e=e.replace(Z,ee),function(t){return(t.textContent||t.innerText||i(t)).indexOf(e)>-1}}),lang:se(function(e){return U.test(e||"")||oe.error("unsupported lang: "+e),e=e.replace(Z,ee).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:de(!1),disabled:de(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return Y.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:he(function(){return[0]}),last:he(function(e,t){return[t-1]}),eq:he(function(e,t,n){return[n<0?n+t:n]}),even:he(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:he(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:he(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:he(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=r.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=fe(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=pe(t);function ye(){}ye.prototype=r.filters=r.pseudos,r.setFilters=new ye,a=oe.tokenize=function(e,t){var n,i,o,a,s,u,l,c=k[e+" "];if(c)return t?0:c.slice(0);s=e,u=[],l=r.preFilter;while(s){n&&!(i=F.exec(s))||(i&&(s=s.slice(i[0].length)||s),u.push(o=[])),n=!1,(i=_.exec(s))&&(n=i.shift(),o.push({value:n,type:i[0].replace(B," ")}),s=s.slice(n.length));for(a in r.filter)!(i=V[a].exec(s))||l[a]&&!(i=l[a](i))||(n=i.shift(),o.push({value:n,type:a,matches:i}),s=s.slice(n.length));if(!n)break}return t?s.length:s?oe.error(e):k(e,u).slice(0)};function ve(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function me(e,t,n){var r=t.dir,i=t.next,o=i||r,a=n&&"parentNode"===o,s=C++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||a)return e(t,n,i);return!1}:function(t,n,u){var l,c,f,p=[T,s];if(u){while(t=t[r])if((1===t.nodeType||a)&&e(t,n,u))return!0}else while(t=t[r])if(1===t.nodeType||a)if(f=t[b]||(t[b]={}),c=f[t.uniqueID]||(f[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;else{if((l=c[o])&&l[0]===T&&l[1]===s)return p[2]=l[2];if(c[o]=p,p[2]=e(t,n,u))return!0}return!1}}function xe(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function be(e,t,n){for(var r=0,i=t.length;r<i;r++)oe(e,t[r],n);return n}function we(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Te(e,t,n,r,i,o){return r&&!r[b]&&(r=Te(r)),i&&!i[b]&&(i=Te(i,o)),se(function(o,a,s,u){var l,c,f,p=[],d=[],h=a.length,g=o||be(t||"*",s.nodeType?[s]:s,[]),y=!e||!o&&t?g:we(g,p,e,s,u),v=n?i||(o?e:h||r)?[]:a:y;if(n&&n(y,v,s,u),r){l=we(v,d),r(l,[],s,u),c=l.length;while(c--)(f=l[c])&&(v[d[c]]=!(y[d[c]]=f))}if(o){if(i||e){if(i){l=[],c=v.length;while(c--)(f=v[c])&&l.push(y[c]=f);i(null,v=[],l,u)}c=v.length;while(c--)(f=v[c])&&(l=i?O(o,f):p[c])>-1&&(o[l]=!(a[l]=f))}}else v=we(v===a?v.splice(h,v.length):v),i?i(null,a,v,u):L.apply(a,v)})}function Ce(e){for(var t,n,i,o=e.length,a=r.relative[e[0].type],s=a||r.relative[" "],u=a?1:0,c=me(function(e){return e===t},s,!0),f=me(function(e){return O(t,e)>-1},s,!0),p=[function(e,n,r){var i=!a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):f(e,n,r));return t=null,i}];u<o;u++)if(n=r.relative[e[u].type])p=[me(xe(p),n)];else{if((n=r.filter[e[u].type].apply(null,e[u].matches))[b]){for(i=++u;i<o;i++)if(r.relative[e[i].type])break;return Te(u>1&&xe(p),u>1&&ve(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(B,"$1"),n,u<i&&Ce(e.slice(u,i)),i<o&&Ce(e=e.slice(i)),i<o&&ve(e))}p.push(n)}return xe(p)}function Ee(e,t){var n=t.length>0,i=e.length>0,o=function(o,a,s,u,c){var f,h,y,v=0,m="0",x=o&&[],b=[],w=l,C=o||i&&r.find.TAG("*",c),E=T+=null==w?1:Math.random()||.1,k=C.length;for(c&&(l=a===d||a||c);m!==k&&null!=(f=C[m]);m++){if(i&&f){h=0,a||f.ownerDocument===d||(p(f),s=!g);while(y=e[h++])if(y(f,a||d,s)){u.push(f);break}c&&(T=E)}n&&((f=!y&&f)&&v--,o&&x.push(f))}if(v+=m,n&&m!==v){h=0;while(y=t[h++])y(x,b,a,s);if(o){if(v>0)while(m--)x[m]||b[m]||(b[m]=j.call(u));b=we(b)}L.apply(u,b),c&&!o&&b.length>0&&v+t.length>1&&oe.uniqueSort(u)}return c&&(T=E,l=w),x};return n?se(o):o}return s=oe.compile=function(e,t){var n,r=[],i=[],o=S[e+" "];if(!o){t||(t=a(e)),n=t.length;while(n--)(o=Ce(t[n]))[b]?r.push(o):i.push(o);(o=S(e,Ee(i,r))).selector=e}return o},u=oe.select=function(e,t,n,i){var o,u,l,c,f,p="function"==typeof e&&e,d=!i&&a(e=p.selector||e);if(n=n||[],1===d.length){if((u=d[0]=d[0].slice(0)).length>2&&"ID"===(l=u[0]).type&&9===t.nodeType&&g&&r.relative[u[1].type]){if(!(t=(r.find.ID(l.matches[0].replace(Z,ee),t)||[])[0]))return n;p&&(t=t.parentNode),e=e.slice(u.shift().value.length)}o=V.needsContext.test(e)?0:u.length;while(o--){if(l=u[o],r.relative[c=l.type])break;if((f=r.find[c])&&(i=f(l.matches[0].replace(Z,ee),K.test(u[0].type)&&ge(t.parentNode)||t))){if(u.splice(o,1),!(e=i.length&&ve(u)))return L.apply(n,i),n;break}}}return(p||s(e,d))(i,t,!g,n,!t||K.test(e)&&ge(t.parentNode)||t),n},n.sortStable=b.split("").sort(D).join("")===b,n.detectDuplicates=!!f,p(),n.sortDetached=ue(function(e){return 1&e.compareDocumentPosition(d.createElement("fieldset"))}),ue(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||le("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ue(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||le("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ue(function(e){return null==e.getAttribute("disabled")})||le(P,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),oe}(e);w.find=E,w.expr=E.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=E.uniqueSort,w.text=E.getText,w.isXMLDoc=E.isXML,w.contains=E.contains,w.escapeSelector=E.escape;var k=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&w(e).is(n))break;r.push(e)}return r},S=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},D=w.expr.match.needsContext;function N(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var A=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,t,n){return g(t)?w.grep(e,function(e,r){return!!t.call(e,r,e)!==n}):t.nodeType?w.grep(e,function(e){return e===t!==n}):"string"!=typeof t?w.grep(e,function(e){return u.call(t,e)>-1!==n}):w.filter(t,e,n)}w.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?w.find.matchesSelector(r,e)?[r]:[]:w.find.matches(e,w.grep(t,function(e){return 1===e.nodeType}))},w.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(w(e).filter(function(){for(t=0;t<r;t++)if(w.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)w.find(e,i[t],n);return r>1?w.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&D.test(e)?w(e):e||[],!1).length}});var q,L=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(e,t,n){var i,o;if(!e)return this;if(n=n||q,"string"==typeof e){if(!(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:L.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof w?t[0]:t,w.merge(this,w.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:r,!0)),A.test(i[1])&&w.isPlainObject(t))for(i in t)g(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(o=r.getElementById(i[2]))&&(this[0]=o,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):g(e)?void 0!==n.ready?n.ready(e):e(w):w.makeArray(e,this)}).prototype=w.fn,q=w(r);var H=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};w.fn.extend({has:function(e){var t=w(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(w.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&w(e);if(!D.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?w.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?u.call(w(e),this[0]):u.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function P(e,t){while((e=e[t])&&1!==e.nodeType);return e}w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return k(e,"parentNode")},parentsUntil:function(e,t,n){return k(e,"parentNode",n)},next:function(e){return P(e,"nextSibling")},prev:function(e){return P(e,"previousSibling")},nextAll:function(e){return k(e,"nextSibling")},prevAll:function(e){return k(e,"previousSibling")},nextUntil:function(e,t,n){return k(e,"nextSibling",n)},prevUntil:function(e,t,n){return k(e,"previousSibling",n)},siblings:function(e){return S((e.parentNode||{}).firstChild,e)},children:function(e){return S(e.firstChild)},contents:function(e){return N(e,"iframe")?e.contentDocument:(N(e,"template")&&(e=e.content||e),w.merge([],e.childNodes))}},function(e,t){w.fn[e]=function(n,r){var i=w.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=w.filter(r,i)),this.length>1&&(O[e]||w.uniqueSort(i),H.test(e)&&i.reverse()),this.pushStack(i)}});var M=/[^\x20\t\r\n\f]+/g;function R(e){var t={};return w.each(e.match(M)||[],function(e,n){t[n]=!0}),t}w.Callbacks=function(e){e="string"==typeof e?R(e):w.extend({},e);var t,n,r,i,o=[],a=[],s=-1,u=function(){for(i=i||e.once,r=t=!0;a.length;s=-1){n=a.shift();while(++s<o.length)!1===o[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=o.length,n=!1)}e.memory||(n=!1),t=!1,i&&(o=n?[]:"")},l={add:function(){return o&&(n&&!t&&(s=o.length-1,a.push(n)),function t(n){w.each(n,function(n,r){g(r)?e.unique&&l.has(r)||o.push(r):r&&r.length&&"string"!==x(r)&&t(r)})}(arguments),n&&!t&&u()),this},remove:function(){return w.each(arguments,function(e,t){var n;while((n=w.inArray(t,o,n))>-1)o.splice(n,1),n<=s&&s--}),this},has:function(e){return e?w.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=a=[],n||t||(o=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],a.push(n),t||u()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l};function I(e){return e}function W(e){throw e}function $(e,t,n,r){var i;try{e&&g(i=e.promise)?i.call(e).done(t).fail(n):e&&g(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}w.extend({Deferred:function(t){var n=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},"catch":function(e){return i.then(null,e)},pipe:function(){var e=arguments;return w.Deferred(function(t){w.each(n,function(n,r){var i=g(e[r[4]])&&e[r[4]];o[r[1]](function(){var e=i&&i.apply(this,arguments);e&&g(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[r[0]+"With"](this,i?[e]:arguments)})}),e=null}).promise()},then:function(t,r,i){var o=0;function a(t,n,r,i){return function(){var s=this,u=arguments,l=function(){var e,l;if(!(t<o)){if((e=r.apply(s,u))===n.promise())throw new TypeError("Thenable self-resolution");l=e&&("object"==typeof e||"function"==typeof e)&&e.then,g(l)?i?l.call(e,a(o,n,I,i),a(o,n,W,i)):(o++,l.call(e,a(o,n,I,i),a(o,n,W,i),a(o,n,I,n.notifyWith))):(r!==I&&(s=void 0,u=[e]),(i||n.resolveWith)(s,u))}},c=i?l:function(){try{l()}catch(e){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(e,c.stackTrace),t+1>=o&&(r!==W&&(s=void 0,u=[e]),n.rejectWith(s,u))}};t?c():(w.Deferred.getStackHook&&(c.stackTrace=w.Deferred.getStackHook()),e.setTimeout(c))}}return w.Deferred(function(e){n[0][3].add(a(0,e,g(i)?i:I,e.notifyWith)),n[1][3].add(a(0,e,g(t)?t:I)),n[2][3].add(a(0,e,g(r)?r:W))}).promise()},promise:function(e){return null!=e?w.extend(e,i):i}},o={};return w.each(n,function(e,t){var a=t[2],s=t[5];i[t[1]]=a.add,s&&a.add(function(){r=s},n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),a.add(t[3].fire),o[t[0]]=function(){return o[t[0]+"With"](this===o?void 0:this,arguments),this},o[t[0]+"With"]=a.fireWith}),i.promise(o),t&&t.call(o,o),o},when:function(e){var t=arguments.length,n=t,r=Array(n),i=o.call(arguments),a=w.Deferred(),s=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?o.call(arguments):n,--t||a.resolveWith(r,i)}};if(t<=1&&($(e,a.done(s(n)).resolve,a.reject,!t),"pending"===a.state()||g(i[n]&&i[n].then)))return a.then();while(n--)$(i[n],s(n),a.reject);return a.promise()}});var B=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&B.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},w.readyException=function(t){e.setTimeout(function(){throw t})};var F=w.Deferred();w.fn.ready=function(e){return F.then(e)["catch"](function(e){w.readyException(e)}),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==e&&--w.readyWait>0||F.resolveWith(r,[w]))}}),w.ready.then=F.then;function _(){r.removeEventListener("DOMContentLoaded",_),e.removeEventListener("load",_),w.ready()}"complete"===r.readyState||"loading"!==r.readyState&&!r.documentElement.doScroll?e.setTimeout(w.ready):(r.addEventListener("DOMContentLoaded",_),e.addEventListener("load",_));var z=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===x(n)){i=!0;for(s in n)z(e,t,s,n[s],!0,o,a)}else if(void 0!==r&&(i=!0,g(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(w(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},X=/^-ms-/,U=/-([a-z])/g;function V(e,t){return t.toUpperCase()}function G(e){return e.replace(X,"ms-").replace(U,V)}var Y=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function Q(){this.expando=w.expando+Q.uid++}Q.uid=1,Q.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Y(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[G(t)]=n;else for(r in t)i[G(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][G(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(G):(t=G(t))in r?[t]:t.match(M)||[]).length;while(n--)delete r[t[n]]}(void 0===t||w.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!w.isEmptyObject(t)}};var J=new Q,K=new Q,Z=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ee=/[A-Z]/g;function te(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:Z.test(e)?JSON.parse(e):e)}function ne(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(ee,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=te(n)}catch(e){}K.set(e,t,n)}else n=void 0;return n}w.extend({hasData:function(e){return K.hasData(e)||J.hasData(e)},data:function(e,t,n){return K.access(e,t,n)},removeData:function(e,t){K.remove(e,t)},_data:function(e,t,n){return J.access(e,t,n)},_removeData:function(e,t){J.remove(e,t)}}),w.fn.extend({data:function(e,t){var n,r,i,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(i=K.get(o),1===o.nodeType&&!J.get(o,"hasDataAttrs"))){n=a.length;while(n--)a[n]&&0===(r=a[n].name).indexOf("data-")&&(r=G(r.slice(5)),ne(o,r,i[r]));J.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each(function(){K.set(this,e)}):z(this,function(t){var n;if(o&&void 0===t){if(void 0!==(n=K.get(o,e)))return n;if(void 0!==(n=ne(o,e)))return n}else this.each(function(){K.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){K.remove(this,e)})}}),w.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=J.get(e,t),n&&(!r||Array.isArray(n)?r=J.access(e,t,w.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),r=n.length,i=n.shift(),o=w._queueHooks(e,t),a=function(){w.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return J.get(e,n)||J.access(e,n,{empty:w.Callbacks("once memory").add(function(){J.remove(e,[t+"queue",n])})})}}),w.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?w.queue(this[0],e):void 0===t?this:this.each(function(){var n=w.queue(this,e,t);w._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&w.dequeue(this,e)})},dequeue:function(e){return this.each(function(){w.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=w.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=J.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var re=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ie=new RegExp("^(?:([+-])=|)("+re+")([a-z%]*)$","i"),oe=["Top","Right","Bottom","Left"],ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&w.contains(e.ownerDocument,e)&&"none"===w.css(e,"display")},se=function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i};function ue(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return w.css(e,t,"")},u=s(),l=n&&n[3]||(w.cssNumber[t]?"":"px"),c=(w.cssNumber[t]||"px"!==l&&+u)&&ie.exec(w.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)w.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,w.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var le={};function ce(e){var t,n=e.ownerDocument,r=e.nodeName,i=le[r];return i||(t=n.body.appendChild(n.createElement(r)),i=w.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),le[r]=i,i)}function fe(e,t){for(var n,r,i=[],o=0,a=e.length;o<a;o++)(r=e[o]).style&&(n=r.style.display,t?("none"===n&&(i[o]=J.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&ae(r)&&(i[o]=ce(r))):"none"!==n&&(i[o]="none",J.set(r,"display",n)));for(o=0;o<a;o++)null!=i[o]&&(e[o].style.display=i[o]);return e}w.fn.extend({show:function(){return fe(this,!0)},hide:function(){return fe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?w(this).show():w(this).hide()})}});var pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,he=/^$|^module$|\/(?:java|ecma)script/i,ge={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ge.optgroup=ge.option,ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td;function ye(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&N(e,t)?w.merge([e],n):n}function ve(e,t){for(var n=0,r=e.length;n<r;n++)J.set(e[n],"globalEval",!t||J.get(t[n],"globalEval"))}var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===x(o))w.merge(p,o.nodeType?[o]:o);else if(me.test(o)){a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+w.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;w.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&w.inArray(o,r)>-1)i&&i.push(o);else if(l=w.contains(o.ownerDocument,o),a=ye(f.appendChild(o),"script"),l&&ve(a),n){c=0;while(o=a[c++])he.test(o.type||"")&&n.push(o)}return f}!function(){var e=r.createDocumentFragment().appendChild(r.createElement("div")),t=r.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),h.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",h.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var be=r.documentElement,we=/^key/,Te=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ce=/^([^.]*)(?:\.(.+)|)/;function Ee(){return!0}function ke(){return!1}function Se(){try{return r.activeElement}catch(e){}}function De(e,t,n,r,i,o){var a,s;if("object"==typeof t){"string"!=typeof n&&(r=r||n,n=void 0);for(s in t)De(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=ke;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return w().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=w.guid++)),e.each(function(){w.event.add(this,t,i,r,n)})}w.event={global:{},add:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,y=J.get(e);if(y){n.handler&&(n=(o=n).handler,i=o.selector),i&&w.find.matchesSelector(be,i),n.guid||(n.guid=w.guid++),(u=y.events)||(u=y.events={}),(a=y.handle)||(a=y.handle=function(t){return"undefined"!=typeof w&&w.event.triggered!==t.type?w.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(M)||[""]).length;while(l--)d=g=(s=Ce.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=w.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=w.event.special[d]||{},c=w.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&w.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(e,r,h,a)||e.addEventListener&&e.addEventListener(d,a)),f.add&&(f.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),w.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,y=J.hasData(e)&&J.get(e);if(y&&(u=y.events)){l=(t=(t||"").match(M)||[""]).length;while(l--)if(s=Ce.exec(t[l])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){f=w.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,y.handle)||w.removeEvent(e,d,y.handle),delete u[d])}else for(d in u)w.event.remove(e,d+t[l],n,r,!0);w.isEmptyObject(u)&&J.remove(e,"handle events")}},dispatch:function(e){var t=w.event.fix(e),n,r,i,o,a,s,u=new Array(arguments.length),l=(J.get(this,"events")||{})[t.type]||[],c=w.event.special[t.type]||{};for(u[0]=t,n=1;n<arguments.length;n++)u[n]=arguments[n];if(t.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,t)){s=w.event.handlers.call(this,t,l),n=0;while((o=s[n++])&&!t.isPropagationStopped()){t.currentTarget=o.elem,r=0;while((a=o.handlers[r++])&&!t.isImmediatePropagationStopped())t.rnamespace&&!t.rnamespace.test(a.namespace)||(t.handleObj=a,t.data=a.data,void 0!==(i=((w.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,u))&&!1===(t.result=i)&&(t.preventDefault(),t.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&e.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?w(i,this).index(l)>-1:w.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(e,t){Object.defineProperty(w.Event.prototype,e,{enumerable:!0,configurable:!0,get:g(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[w.expando]?e:new w.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Se()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Se()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&N(this,"input"))return this.click(),!1},_default:function(e){return N(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},w.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},w.Event=function(e,t){if(!(this instanceof w.Event))return new w.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ee:ke,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:ke,isPropagationStopped:ke,isImmediatePropagationStopped:ke,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ee,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ee,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ee,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&we.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&Te.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},w.event.addProp),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return i&&(i===r||w.contains(r,i))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),w.fn.extend({on:function(e,t,n,r){return De(this,e,t,n,r)},one:function(e,t,n,r){return De(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,w(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=ke),this.each(function(){w.event.remove(this,e,n,t)})}});var Ne=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Ae=/<script|<style|<link/i,je=/checked\s*(?:[^=]|=\s*.checked.)/i,qe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Le(e,t){return N(e,"table")&&N(11!==t.nodeType?t:t.firstChild,"tr")?w(e).children("tbody")[0]||e:e}function He(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Oe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Pe(e,t){var n,r,i,o,a,s,u,l;if(1===t.nodeType){if(J.hasData(e)&&(o=J.access(e),a=J.set(t,o),l=o.events)){delete a.handle,a.events={};for(i in l)for(n=0,r=l[i].length;n<r;n++)w.event.add(t,i,l[i][n])}K.hasData(e)&&(s=K.access(e),u=w.extend({},s),K.set(t,u))}}function Me(e,t){var n=t.nodeName.toLowerCase();"input"===n&&pe.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function Re(e,t,n,r){t=a.apply([],t);var i,o,s,u,l,c,f=0,p=e.length,d=p-1,y=t[0],v=g(y);if(v||p>1&&"string"==typeof y&&!h.checkClone&&je.test(y))return e.each(function(i){var o=e.eq(i);v&&(t[0]=y.call(this,i,o.html())),Re(o,t,n,r)});if(p&&(i=xe(t,e[0].ownerDocument,!1,e,r),o=i.firstChild,1===i.childNodes.length&&(i=o),o||r)){for(u=(s=w.map(ye(i,"script"),He)).length;f<p;f++)l=i,f!==d&&(l=w.clone(l,!0,!0),u&&w.merge(s,ye(l,"script"))),n.call(e[f],l,f);if(u)for(c=s[s.length-1].ownerDocument,w.map(s,Oe),f=0;f<u;f++)l=s[f],he.test(l.type||"")&&!J.access(l,"globalEval")&&w.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?w._evalUrl&&w._evalUrl(l.src):m(l.textContent.replace(qe,""),c,l))}return e}function Ie(e,t,n){for(var r,i=t?w.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||w.cleanData(ye(r)),r.parentNode&&(n&&w.contains(r.ownerDocument,r)&&ve(ye(r,"script")),r.parentNode.removeChild(r));return e}w.extend({htmlPrefilter:function(e){return e.replace(Ne,"<$1></$2>")},clone:function(e,t,n){var r,i,o,a,s=e.cloneNode(!0),u=w.contains(e.ownerDocument,e);if(!(h.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(a=ye(s),r=0,i=(o=ye(e)).length;r<i;r++)Me(o[r],a[r]);if(t)if(n)for(o=o||ye(e),a=a||ye(s),r=0,i=o.length;r<i;r++)Pe(o[r],a[r]);else Pe(e,s);return(a=ye(s,"script")).length>0&&ve(a,!u&&ye(e,"script")),s},cleanData:function(e){for(var t,n,r,i=w.event.special,o=0;void 0!==(n=e[o]);o++)if(Y(n)){if(t=n[J.expando]){if(t.events)for(r in t.events)i[r]?w.event.remove(n,r):w.removeEvent(n,r,t.handle);n[J.expando]=void 0}n[K.expando]&&(n[K.expando]=void 0)}}}),w.fn.extend({detach:function(e){return Ie(this,e,!0)},remove:function(e){return Ie(this,e)},text:function(e){return z(this,function(e){return void 0===e?w.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return Re(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Le(this,e).appendChild(e)})},prepend:function(){return Re(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Le(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Re(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Re(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(w.cleanData(ye(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return w.clone(this,e,t)})},html:function(e){return z(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ae.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=w.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(w.cleanData(ye(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return Re(this,arguments,function(t){var n=this.parentNode;w.inArray(this,e)<0&&(w.cleanData(ye(this)),n&&n.replaceChild(t,this))},e)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){w.fn[e]=function(e){for(var n,r=[],i=w(e),o=i.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),w(i[a])[t](n),s.apply(r,n.get());return this.pushStack(r)}});var We=new RegExp("^("+re+")(?!px)[a-z%]+$","i"),$e=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},Be=new RegExp(oe.join("|"),"i");!function(){function t(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",be.appendChild(l).appendChild(c);var t=e.getComputedStyle(c);i="1%"!==t.top,u=12===n(t.marginLeft),c.style.right="60%",s=36===n(t.right),o=36===n(t.width),c.style.position="absolute",a=36===c.offsetWidth||"absolute",be.removeChild(l),c=null}}function n(e){return Math.round(parseFloat(e))}var i,o,a,s,u,l=r.createElement("div"),c=r.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",h.clearCloneStyle="content-box"===c.style.backgroundClip,w.extend(h,{boxSizingReliable:function(){return t(),o},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),u},scrollboxSize:function(){return t(),a}}))}();function Fe(e,t,n){var r,i,o,a,s=e.style;return(n=n||$e(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||w.contains(e.ownerDocument,e)||(a=w.style(e,t)),!h.pixelBoxStyles()&&We.test(a)&&Be.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function _e(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}var ze=/^(none|table(?!-c[ea]).+)/,Xe=/^--/,Ue={position:"absolute",visibility:"hidden",display:"block"},Ve={letterSpacing:"0",fontWeight:"400"},Ge=["Webkit","Moz","ms"],Ye=r.createElement("div").style;function Qe(e){if(e in Ye)return e;var t=e[0].toUpperCase()+e.slice(1),n=Ge.length;while(n--)if((e=Ge[n]+t)in Ye)return e}function Je(e){var t=w.cssProps[e];return t||(t=w.cssProps[e]=Qe(e)||e),t}function Ke(e,t,n){var r=ie.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Ze(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=w.css(e,n+oe[a],!0,i)),r?("content"===n&&(u-=w.css(e,"padding"+oe[a],!0,i)),"margin"!==n&&(u-=w.css(e,"border"+oe[a]+"Width",!0,i))):(u+=w.css(e,"padding"+oe[a],!0,i),"padding"!==n?u+=w.css(e,"border"+oe[a]+"Width",!0,i):s+=w.css(e,"border"+oe[a]+"Width",!0,i));return!r&&o>=0&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))),u}function et(e,t,n){var r=$e(e),i=Fe(e,t,r),o="border-box"===w.css(e,"boxSizing",!1,r),a=o;if(We.test(i)){if(!n)return i;i="auto"}return a=a&&(h.boxSizingReliable()||i===e.style[t]),("auto"===i||!parseFloat(i)&&"inline"===w.css(e,"display",!1,r))&&(i=e["offset"+t[0].toUpperCase()+t.slice(1)],a=!0),(i=parseFloat(i)||0)+Ze(e,t,n||(o?"border":"content"),a,r,i)+"px"}w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Fe(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=G(t),u=Xe.test(t),l=e.style;if(u||(t=Je(s)),a=w.cssHooks[t]||w.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"==(o=typeof n)&&(i=ie.exec(n))&&i[1]&&(n=ue(e,t,i),o="number"),null!=n&&n===n&&("number"===o&&(n+=i&&i[3]||(w.cssNumber[s]?"":"px")),h.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=G(t);return Xe.test(t)||(t=Je(s)),(a=w.cssHooks[t]||w.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Fe(e,t,r)),"normal"===i&&t in Ve&&(i=Ve[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),w.each(["height","width"],function(e,t){w.cssHooks[t]={get:function(e,n,r){if(n)return!ze.test(w.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?et(e,t,r):se(e,Ue,function(){return et(e,t,r)})},set:function(e,n,r){var i,o=$e(e),a="border-box"===w.css(e,"boxSizing",!1,o),s=r&&Ze(e,t,r,a,o);return a&&h.scrollboxSize()===o.position&&(s-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-Ze(e,t,"border",!1,o)-.5)),s&&(i=ie.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=w.css(e,t)),Ke(e,n,s)}}}),w.cssHooks.marginLeft=_e(h.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Fe(e,"marginLeft"))||e.getBoundingClientRect().left-se(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),w.each({margin:"",padding:"",border:"Width"},function(e,t){w.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+oe[r]+t]=o[r]||o[r-2]||o[0];return i}},"margin"!==e&&(w.cssHooks[e+t].set=Ke)}),w.fn.extend({css:function(e,t){return z(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=$e(e),i=t.length;a<i;a++)o[t[a]]=w.css(e,t[a],!1,r);return o}return void 0!==n?w.style(e,t,n):w.css(e,t)},e,t,arguments.length>1)}});function tt(e,t,n,r,i){return new tt.prototype.init(e,t,n,r,i)}w.Tween=tt,tt.prototype={constructor:tt,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||w.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(w.cssNumber[n]?"":"px")},cur:function(){var e=tt.propHooks[this.prop];return e&&e.get?e.get(this):tt.propHooks._default.get(this)},run:function(e){var t,n=tt.propHooks[this.prop];return this.options.duration?this.pos=t=w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):tt.propHooks._default.set(this),this}},tt.prototype.init.prototype=tt.prototype,tt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[w.cssProps[e.prop]]&&!w.cssHooks[e.prop]?e.elem[e.prop]=e.now:w.style(e.elem,e.prop,e.now+e.unit)}}},tt.propHooks.scrollTop=tt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},w.fx=tt.prototype.init,w.fx.step={};var nt,rt,it=/^(?:toggle|show|hide)$/,ot=/queueHooks$/;function at(){rt&&(!1===r.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(at):e.setTimeout(at,w.fx.interval),w.fx.tick())}function st(){return e.setTimeout(function(){nt=void 0}),nt=Date.now()}function ut(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=oe[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function lt(e,t,n){for(var r,i=(pt.tweeners[t]||[]).concat(pt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function ct(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),y=J.get(e,"fxshow");n.queue||(null==(a=w._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,w.queue(e,"fx").length||a.empty.fire()})}));for(r in t)if(i=t[r],it.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!y||void 0===y[r])continue;g=!0}d[r]=y&&y[r]||w.style(e,r)}if((u=!w.isEmptyObject(t))||!w.isEmptyObject(d)){f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=y&&y.display)&&(l=J.get(e,"display")),"none"===(c=w.css(e,"display"))&&(l?c=l:(fe([e],!0),l=e.style.display||l,c=w.css(e,"display"),fe([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===w.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1;for(r in d)u||(y?"hidden"in y&&(g=y.hidden):y=J.access(e,"fxshow",{display:l}),o&&(y.hidden=!g),g&&fe([e],!0),p.done(function(){g||fe([e]),J.remove(e,"fxshow");for(r in d)w.style(e,r,d[r])})),u=lt(g?y[r]:0,r,p),r in y||(y[r]=u.start,g&&(u.end=u.start,u.start=0))}}function ft(e,t){var n,r,i,o,a;for(n in e)if(r=G(n),i=t[r],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=w.cssHooks[r])&&"expand"in a){o=a.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}function pt(e,t,n){var r,i,o=0,a=pt.prefilters.length,s=w.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var t=nt||st(),n=Math.max(0,l.startTime+l.duration-t),r=1-(n/l.duration||0),o=0,a=l.tweens.length;o<a;o++)l.tweens[o].run(r);return s.notifyWith(e,[l,r,n]),r<1&&a?n:(a||s.notifyWith(e,[l,1,0]),s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},n),originalProperties:t,originalOptions:n,startTime:nt||st(),duration:n.duration,tweens:[],createTween:function(t,n){var r=w.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)l.tweens[n].run(1);return t?(s.notifyWith(e,[l,1,0]),s.resolveWith(e,[l,t])):s.rejectWith(e,[l,t]),this}}),c=l.props;for(ft(c,l.opts.specialEasing);o<a;o++)if(r=pt.prefilters[o].call(l,e,c,l.opts))return g(r.stop)&&(w._queueHooks(l.elem,l.opts.queue).stop=r.stop.bind(r)),r;return w.map(c,lt,l),g(l.opts.start)&&l.opts.start.call(e,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),w.fx.timer(w.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l}w.Animation=w.extend(pt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ue(n.elem,e,ie.exec(t),n),n}]},tweener:function(e,t){g(e)?(t=e,e=["*"]):e=e.match(M);for(var n,r=0,i=e.length;r<i;r++)n=e[r],pt.tweeners[n]=pt.tweeners[n]||[],pt.tweeners[n].unshift(t)},prefilters:[ct],prefilter:function(e,t){t?pt.prefilters.unshift(e):pt.prefilters.push(e)}}),w.speed=function(e,t,n){var r=e&&"object"==typeof e?w.extend({},e):{complete:n||!n&&t||g(e)&&e,duration:e,easing:n&&t||t&&!g(t)&&t};return w.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in w.fx.speeds?r.duration=w.fx.speeds[r.duration]:r.duration=w.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){g(r.old)&&r.old.call(this),r.queue&&w.dequeue(this,r.queue)},r},w.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=w.isEmptyObject(e),o=w.speed(t,n,r),a=function(){var t=pt(this,w.extend({},e),o);(i||J.get(this,"finish"))&&t.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=w.timers,a=J.get(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&ot.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||w.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=J.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=w.timers,a=r?r.length:0;for(n.finish=!0,w.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),w.each(["toggle","show","hide"],function(e,t){var n=w.fn[t];w.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ut(t,!0),e,r,i)}}),w.each({slideDown:ut("show"),slideUp:ut("hide"),slideToggle:ut("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){w.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),w.timers=[],w.fx.tick=function(){var e,t=0,n=w.timers;for(nt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||w.fx.stop(),nt=void 0},w.fx.timer=function(e){w.timers.push(e),w.fx.start()},w.fx.interval=13,w.fx.start=function(){rt||(rt=!0,at())},w.fx.stop=function(){rt=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(t,n){return t=w.fx?w.fx.speeds[t]||t:t,n=n||"fx",this.queue(n,function(n,r){var i=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(i)}})},function(){var e=r.createElement("input"),t=r.createElement("select").appendChild(r.createElement("option"));e.type="checkbox",h.checkOn=""!==e.value,h.optSelected=t.selected,(e=r.createElement("input")).value="t",e.type="radio",h.radioValue="t"===e.value}();var dt,ht=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return z(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})}}),w.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?w.prop(e,t,n):(1===o&&w.isXMLDoc(e)||(i=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?dt:void 0)),void 0!==n?null===n?void w.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=w.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!h.radioValue&&"radio"===t&&N(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(M);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),dt={set:function(e,t,n){return!1===t?w.removeAttr(e,n):e.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,t){var n=ht[t]||w.find.attr;ht[t]=function(e,t,r){var i,o,a=t.toLowerCase();return r||(o=ht[a],ht[a]=i,i=null!=n(e,t,r)?a:null,ht[a]=o),i}});var gt=/^(?:input|select|textarea|button)$/i,yt=/^(?:a|area)$/i;w.fn.extend({prop:function(e,t){return z(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[w.propFix[e]||e]})}}),w.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&w.isXMLDoc(e)||(t=w.propFix[t]||t,i=w.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):gt.test(e.nodeName)||yt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),h.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this});function vt(e){return(e.match(M)||[]).join(" ")}function mt(e){return e.getAttribute&&e.getAttribute("class")||""}function xt(e){return Array.isArray(e)?e:"string"==typeof e?e.match(M)||[]:[]}w.fn.extend({addClass:function(e){var t,n,r,i,o,a,s,u=0;if(g(e))return this.each(function(t){w(this).addClass(e.call(this,t,mt(this)))});if((t=xt(e)).length)while(n=this[u++])if(i=mt(n),r=1===n.nodeType&&" "+vt(i)+" "){a=0;while(o=t[a++])r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=vt(r))&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,r,i,o,a,s,u=0;if(g(e))return this.each(function(t){w(this).removeClass(e.call(this,t,mt(this)))});if(!arguments.length)return this.attr("class","");if((t=xt(e)).length)while(n=this[u++])if(i=mt(n),r=1===n.nodeType&&" "+vt(i)+" "){a=0;while(o=t[a++])while(r.indexOf(" "+o+" ")>-1)r=r.replace(" "+o+" "," ");i!==(s=vt(r))&&n.setAttribute("class",s)}return this},toggleClass:function(e,t){var n=typeof e,r="string"===n||Array.isArray(e);return"boolean"==typeof t&&r?t?this.addClass(e):this.removeClass(e):g(e)?this.each(function(n){w(this).toggleClass(e.call(this,n,mt(this),t),t)}):this.each(function(){var t,i,o,a;if(r){i=0,o=w(this),a=xt(e);while(t=a[i++])o.hasClass(t)?o.removeClass(t):o.addClass(t)}else void 0!==e&&"boolean"!==n||((t=mt(this))&&J.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":J.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&(" "+vt(mt(n))+" ").indexOf(t)>-1)return!0;return!1}});var bt=/\r/g;w.fn.extend({val:function(e){var t,n,r,i=this[0];{if(arguments.length)return r=g(e),this.each(function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,w(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=w.map(i,function(e){return null==e?"":e+""})),(t=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))});if(i)return(t=w.valHooks[i.type]||w.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(bt,""):null==n?"":n}}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:vt(w.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!N(n.parentNode,"optgroup"))){if(t=w(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=w.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=w.inArray(w.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=w.inArray(w(e).val(),t)>-1}},h.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),h.focusin="onfocusin"in e;var wt=/^(?:focusinfocus|focusoutblur)$/,Tt=function(e){e.stopPropagation()};w.extend(w.event,{trigger:function(t,n,i,o){var a,s,u,l,c,p,d,h,v=[i||r],m=f.call(t,"type")?t.type:t,x=f.call(t,"namespace")?t.namespace.split("."):[];if(s=h=u=i=i||r,3!==i.nodeType&&8!==i.nodeType&&!wt.test(m+w.event.triggered)&&(m.indexOf(".")>-1&&(m=(x=m.split(".")).shift(),x.sort()),c=m.indexOf(":")<0&&"on"+m,t=t[w.expando]?t:new w.Event(m,"object"==typeof t&&t),t.isTrigger=o?2:3,t.namespace=x.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+x.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:w.makeArray(n,[t]),d=w.event.special[m]||{},o||!d.trigger||!1!==d.trigger.apply(i,n))){if(!o&&!d.noBubble&&!y(i)){for(l=d.delegateType||m,wt.test(l+m)||(s=s.parentNode);s;s=s.parentNode)v.push(s),u=s;u===(i.ownerDocument||r)&&v.push(u.defaultView||u.parentWindow||e)}a=0;while((s=v[a++])&&!t.isPropagationStopped())h=s,t.type=a>1?l:d.bindType||m,(p=(J.get(s,"events")||{})[t.type]&&J.get(s,"handle"))&&p.apply(s,n),(p=c&&s[c])&&p.apply&&Y(s)&&(t.result=p.apply(s,n),!1===t.result&&t.preventDefault());return t.type=m,o||t.isDefaultPrevented()||d._default&&!1!==d._default.apply(v.pop(),n)||!Y(i)||c&&g(i[m])&&!y(i)&&((u=i[c])&&(i[c]=null),w.event.triggered=m,t.isPropagationStopped()&&h.addEventListener(m,Tt),i[m](),t.isPropagationStopped()&&h.removeEventListener(m,Tt),w.event.triggered=void 0,u&&(i[c]=u)),t.result}},simulate:function(e,t,n){var r=w.extend(new w.Event,n,{type:e,isSimulated:!0});w.event.trigger(r,null,t)}}),w.fn.extend({trigger:function(e,t){return this.each(function(){w.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return w.event.trigger(e,t,n,!0)}}),h.focusin||w.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){w.event.simulate(t,e.target,w.event.fix(e))};w.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=J.access(r,t);i||r.addEventListener(e,n,!0),J.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=J.access(r,t)-1;i?J.access(r,t,i):(r.removeEventListener(e,n,!0),J.remove(r,t))}}});var Ct=e.location,Et=Date.now(),kt=/\?/;w.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+t),n};var St=/\[\]$/,Dt=/\r?\n/g,Nt=/^(?:submit|button|image|reset|file)$/i,At=/^(?:input|select|textarea|keygen)/i;function jt(e,t,n,r){var i;if(Array.isArray(t))w.each(t,function(t,i){n||St.test(e)?r(e,i):jt(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)});else if(n||"object"!==x(t))r(e,t);else for(i in t)jt(e+"["+i+"]",t[i],n,r)}w.param=function(e,t){var n,r=[],i=function(e,t){var n=g(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,function(){i(this.name,this.value)});else for(n in e)jt(n,e[n],t,i);return r.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&At.test(this.nodeName)&&!Nt.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=w(this).val();return null==n?null:Array.isArray(n)?w.map(n,function(e){return{name:t.name,value:e.replace(Dt,"\r\n")}}):{name:t.name,value:n.replace(Dt,"\r\n")}}).get()}});var qt=/%20/g,Lt=/#.*$/,Ht=/([?&])_=[^&]*/,Ot=/^(.*?):[ \t]*([^\r\n]*)$/gm,Pt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Mt=/^(?:GET|HEAD)$/,Rt=/^\/\//,It={},Wt={},$t="*/".concat("*"),Bt=r.createElement("a");Bt.href=Ct.href;function Ft(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(M)||[];if(g(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function _t(e,t,n,r){var i={},o=e===Wt;function a(s){var u;return i[s]=!0,w.each(e[s]||[],function(e,s){var l=s(t,n,r);return"string"!=typeof l||o||i[l]?o?!(u=l):void 0:(t.dataTypes.unshift(l),a(l),!1)}),u}return a(t.dataTypes[0])||!i["*"]&&a("*")}function zt(e,t){var n,r,i=w.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&w.extend(!0,e,r),e}function Xt(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}function Ut(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ct.href,type:"GET",isLocal:Pt.test(Ct.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":$t,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?zt(zt(e,w.ajaxSettings),t):zt(w.ajaxSettings,e)},ajaxPrefilter:Ft(It),ajaxTransport:Ft(Wt),ajax:function(t,n){"object"==typeof t&&(n=t,t=void 0),n=n||{};var i,o,a,s,u,l,c,f,p,d,h=w.ajaxSetup({},n),g=h.context||h,y=h.context&&(g.nodeType||g.jquery)?w(g):w.event,v=w.Deferred(),m=w.Callbacks("once memory"),x=h.statusCode||{},b={},T={},C="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(c){if(!s){s={};while(t=Ot.exec(a))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return c?a:null},setRequestHeader:function(e,t){return null==c&&(e=T[e.toLowerCase()]=T[e.toLowerCase()]||e,b[e]=t),this},overrideMimeType:function(e){return null==c&&(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)E.always(e[E.status]);else for(t in e)x[t]=[x[t],e[t]];return this},abort:function(e){var t=e||C;return i&&i.abort(t),k(0,t),this}};if(v.promise(E),h.url=((t||h.url||Ct.href)+"").replace(Rt,Ct.protocol+"//"),h.type=n.method||n.type||h.method||h.type,h.dataTypes=(h.dataType||"*").toLowerCase().match(M)||[""],null==h.crossDomain){l=r.createElement("a");try{l.href=h.url,l.href=l.href,h.crossDomain=Bt.protocol+"//"+Bt.host!=l.protocol+"//"+l.host}catch(e){h.crossDomain=!0}}if(h.data&&h.processData&&"string"!=typeof h.data&&(h.data=w.param(h.data,h.traditional)),_t(It,h,n,E),c)return E;(f=w.event&&h.global)&&0==w.active++&&w.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!Mt.test(h.type),o=h.url.replace(Lt,""),h.hasContent?h.data&&h.processData&&0===(h.contentType||"").indexOf("application/x-www-form-urlencoded")&&(h.data=h.data.replace(qt,"+")):(d=h.url.slice(o.length),h.data&&(h.processData||"string"==typeof h.data)&&(o+=(kt.test(o)?"&":"?")+h.data,delete h.data),!1===h.cache&&(o=o.replace(Ht,"$1"),d=(kt.test(o)?"&":"?")+"_="+Et+++d),h.url=o+d),h.ifModified&&(w.lastModified[o]&&E.setRequestHeader("If-Modified-Since",w.lastModified[o]),w.etag[o]&&E.setRequestHeader("If-None-Match",w.etag[o])),(h.data&&h.hasContent&&!1!==h.contentType||n.contentType)&&E.setRequestHeader("Content-Type",h.contentType),E.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+$t+"; q=0.01":""):h.accepts["*"]);for(p in h.headers)E.setRequestHeader(p,h.headers[p]);if(h.beforeSend&&(!1===h.beforeSend.call(g,E,h)||c))return E.abort();if(C="abort",m.add(h.complete),E.done(h.success),E.fail(h.error),i=_t(Wt,h,n,E)){if(E.readyState=1,f&&y.trigger("ajaxSend",[E,h]),c)return E;h.async&&h.timeout>0&&(u=e.setTimeout(function(){E.abort("timeout")},h.timeout));try{c=!1,i.send(b,k)}catch(e){if(c)throw e;k(-1,e)}}else k(-1,"No Transport");function k(t,n,r,s){var l,p,d,b,T,C=n;c||(c=!0,u&&e.clearTimeout(u),i=void 0,a=s||"",E.readyState=t>0?4:0,l=t>=200&&t<300||304===t,r&&(b=Xt(h,E,r)),b=Ut(h,b,E,l),l?(h.ifModified&&((T=E.getResponseHeader("Last-Modified"))&&(w.lastModified[o]=T),(T=E.getResponseHeader("etag"))&&(w.etag[o]=T)),204===t||"HEAD"===h.type?C="nocontent":304===t?C="notmodified":(C=b.state,p=b.data,l=!(d=b.error))):(d=C,!t&&C||(C="error",t<0&&(t=0))),E.status=t,E.statusText=(n||C)+"",l?v.resolveWith(g,[p,C,E]):v.rejectWith(g,[E,C,d]),E.statusCode(x),x=void 0,f&&y.trigger(l?"ajaxSuccess":"ajaxError",[E,h,l?p:d]),m.fireWith(g,[E,C]),f&&(y.trigger("ajaxComplete",[E,h]),--w.active||w.event.trigger("ajaxStop")))}return E},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],function(e,t){w[t]=function(e,n,r,i){return g(n)&&(i=i||r,r=n,n=void 0),w.ajax(w.extend({url:e,type:t,dataType:i,data:n,success:r},w.isPlainObject(e)&&e))}}),w._evalUrl=function(e){return w.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},w.fn.extend({wrapAll:function(e){var t;return this[0]&&(g(e)&&(e=e.call(this[0])),t=w(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return g(e)?this.each(function(t){w(this).wrapInner(e.call(this,t))}):this.each(function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=g(e);return this.each(function(n){w(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){w(this).replaceWith(this.childNodes)}),this}}),w.expr.pseudos.hidden=function(e){return!w.expr.pseudos.visible(e)},w.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Vt={0:200,1223:204},Gt=w.ajaxSettings.xhr();h.cors=!!Gt&&"withCredentials"in Gt,h.ajax=Gt=!!Gt,w.ajaxTransport(function(t){var n,r;if(h.cors||Gt&&!t.crossDomain)return{send:function(i,o){var a,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)s[a]=t.xhrFields[a];t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(a in i)s.setRequestHeader(a,i[a]);n=function(e){return function(){n&&(n=r=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(Vt[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),r=s.onerror=s.ontimeout=n("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&e.setTimeout(function(){n&&r()})},n=n("abort");try{s.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}}),w.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),w.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(i,o){t=w("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&o("error"===e.type?404:200,e.type)}),r.head.appendChild(t[0])},abort:function(){n&&n()}}}});var Yt=[],Qt=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Yt.pop()||w.expando+"_"+Et++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,a,s=!1!==t.jsonp&&(Qt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qt.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return i=t.jsonpCallback=g(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Qt,"$1"+i):!1!==t.jsonp&&(t.url+=(kt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return a||w.error(i+" was not called"),a[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){a=arguments},r.always(function(){void 0===o?w(e).removeProp(i):e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,Yt.push(i)),a&&g(o)&&o(a[0]),a=o=void 0}),"script"}),h.createHTMLDocument=function(){var e=r.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),w.parseHTML=function(e,t,n){if("string"!=typeof e)return[];"boolean"==typeof t&&(n=t,t=!1);var i,o,a;return t||(h.createHTMLDocument?((i=(t=r.implementation.createHTMLDocument("")).createElement("base")).href=r.location.href,t.head.appendChild(i)):t=r),o=A.exec(e),a=!n&&[],o?[t.createElement(o[1])]:(o=xe([e],t,a),a&&a.length&&w(a).remove(),w.merge([],o.childNodes))},w.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return s>-1&&(r=vt(e.slice(s)),e=e.slice(0,s)),g(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),a.length>0&&w.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?w("<div>").append(w.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){w.fn[t]=function(e){return this.on(t,e)}}),w.expr.pseudos.animated=function(e){return w.grep(w.timers,function(t){return e===t.elem}).length},w.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l,c=w.css(e,"position"),f=w(e),p={};"static"===c&&(e.style.position="relative"),s=f.offset(),o=w.css(e,"top"),u=w.css(e,"left"),(l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1)?(a=(r=f.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),g(t)&&(t=t.call(e,n,w.extend({},s))),null!=t.top&&(p.top=t.top-s.top+a),null!=t.left&&(p.left=t.left-s.left+i),"using"in t?t.using.call(e,p):f.css(p)}},w.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){w.offset.setOffset(this,e,t)});var t,n,r=this[0];if(r)return r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===w.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===w.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=w(e).offset()).top+=w.css(e,"borderTopWidth",!0),i.left+=w.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-w.css(r,"marginTop",!0),left:t.left-i.left-w.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===w.css(e,"position"))e=e.offsetParent;return e||be})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;w.fn[e]=function(r){return z(this,function(e,r,i){var o;if(y(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===i)return o?o[t]:e[r];o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):e[r]=i},e,r,arguments.length)}}),w.each(["top","left"],function(e,t){w.cssHooks[t]=_e(h.pixelPosition,function(e,n){if(n)return n=Fe(e,t),We.test(n)?w(e).position()[t]+"px":n})}),w.each({Height:"height",Width:"width"},function(e,t){w.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){w.fn[r]=function(i,o){var a=arguments.length&&(n||"boolean"!=typeof i),s=n||(!0===i||!0===o?"margin":"border");return z(this,function(t,n,i){var o;return y(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?w.css(t,n,s):w.style(t,n,i,s)},t,a?i:void 0,a)}})}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),w.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),w.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),g(e))return r=o.call(arguments,2),i=function(){return e.apply(t||this,r.concat(o.call(arguments)))},i.guid=e.guid=e.guid||w.guid++,i},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=N,w.isFunction=g,w.isWindow=y,w.camelCase=G,w.type=x,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},"function"==typeof define&&define.amd&&define("jquery",[],function(){return w});var Jt=e.jQuery,Kt=e.$;return w.noConflict=function(t){return e.$===w&&(e.$=Kt),t&&e.jQuery===w&&(e.jQuery=Jt),w},t||(e.jQuery=e.$=w),w});

var xmlToJSON=function(){this.version="1.3";var m={mergeCDATA:!0,grokAttr:!0,grokText:!0,normalize:!0,xmlns:!0,namespaceKey:"_ns",textKey:"_text",valueKey:"_value",attrKey:"_attr",cdataKey:"_cdata",attrsAsObject:!0,stripAttrPrefix:!0,stripElemPrefix:!0,childrenAsArray:!0},x=new RegExp(/(?!xmlns)^.*:/),h=new RegExp(/^\s+|\s+$/g);return this.grokType=function(e){return/^\s*$/.test(e)?null:/^(?:true|false)$/i.test(e)?"true"===e.toLowerCase():isFinite(e)?parseFloat(e):e},this.parseString=function(e,t){return this.parseXML(this.stringToXML(e),t)},this.parseXML=function(e,t){for(var r in t)m[r]=t[r];var a,n={},s=0,l="";if(m.xmlns&&e.namespaceURI&&(n[m.namespaceKey]=e.namespaceURI),e.attributes&&0<e.attributes.length){for(var i={};s<e.attributes.length;s++){var o=e.attributes.item(s),u={},c="",c=m.stripAttrPrefix?o.name.replace(x,""):o.name;m.grokAttr?u[m.valueKey]=this.grokType(o.value.replace(h,"")):u[m.valueKey]=o.value.replace(h,""),m.xmlns&&o.namespaceURI&&(u[m.namespaceKey]=o.namespaceURI),m.attrsAsObject?i[c]=u:n[m.attrKey+c]=u}m.attrsAsObject&&(n[m.attrKey]=i)}if(e.hasChildNodes())for(var p,y,u,d=0;d<e.childNodes.length;d++)4===(p=e.childNodes.item(d)).nodeType?m.mergeCDATA?l+=p.nodeValue:n.hasOwnProperty(m.cdataKey)?(n[m.cdataKey].constructor!==Array&&(n[m.cdataKey]=[n[m.cdataKey]]),n[m.cdataKey].push(p.nodeValue)):m.childrenAsArray?(n[m.cdataKey]=[],n[m.cdataKey].push(p.nodeValue)):n[m.cdataKey]=p.nodeValue:3===p.nodeType?l+=p.nodeValue:1===p.nodeType&&(0===s&&(n={}),y=m.stripElemPrefix?p.nodeName.replace(x,""):p.nodeName,u=xmlToJSON.parseXML(p),n.hasOwnProperty(y)?(n[y].constructor!==Array&&(n[y]=[n[y]]),n[y].push(u)):(m.childrenAsArray?(n[y]=[],n[y].push(u)):n[y]=u,s++));else l||(m.childrenAsArray?(n[m.textKey]=[],n[m.textKey].push(null)):n[m.textKey]=null);return l&&(m.grokText?null!=(a=this.grokType(l.replace(h,"")))&&(n[m.textKey]=a):m.normalize?n[m.textKey]=l.replace(h,"").replace(/\s+/g," "):n[m.textKey]=l.replace(h,"")),n},this.xmlToString=function(e){try{return e.xml?e.xml:(new XMLSerializer).serializeToString(e)}catch(e){return null}},this.stringToXML=function(e){try{var t=null;return window.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e),t)}catch(e){return null}},this}();"undefined"!=typeof module&&null!==module&&module.exports?module.exports=xmlToJSON:"function"==typeof define&&define.amd&&define(function(){return xmlToJSON});
/** @license
 * eventsource.js
 * Available under MIT License (MIT)
 * https://github.com/Yaffle/EventSource/
 * event-source-polyfill@1.0.3
 */
!function(a){"use strict";function b(){this.bitsNeeded=0,this.codePoint=0}function c(a){this.withCredentials=!1,this.readyState=0,this.status=0,this.statusText="",this.responseText="",this.onprogress=G,this.onload=G,this.onerror=G,this.onreadystatechange=G,this._contentType="",this._xhr=a,this._sendTimeout=0,this._abort=G}function d(a){return a.replace(/[A-Z]/g,function(a){return String.fromCharCode(a.charCodeAt(0)+32)})}function e(a){for(var b=Object.create(null),c=a.split("\r\n"),e=0;e<c.length;e+=1){var f=c[e],g=f.split(": "),h=g.shift(),i=g.join(": ");b[d(h)]=i}this._map=b}function f(){}function g(a){this._headers=a}function h(){}function i(){this._listeners=Object.create(null)}function j(a){r(function(){throw a},0)}function k(a){this.type=a,this.target=void 0}function l(a,b){k.call(this,a),this.data=b.data,this.lastEventId=b.lastEventId}function m(a,b){k.call(this,a),this.status=b.status,this.statusText=b.statusText,this.headers=b.headers}function n(a,b){k.call(this,a),this.error=b.error}function o(a,b){i.call(this),b=b||{},this.onopen=void 0,this.onmessage=void 0,this.onerror=void 0,this.url=void 0,this.readyState=void 0,this.withCredentials=void 0,this.headers=void 0,this._close=void 0,q(this,a,b)}function p(){return void 0!=t&&"withCredentials"in t.prototype||void 0==u?new t:new u}function q(a,b,d){b=String(b);var e=Boolean(d.withCredentials),g=U(1e3),i=T(d.heartbeatTimeout,45e3),j="",k=g,o=!1,q=0,t=d.headers||{},u=d.Transport,v=W&&void 0==u?void 0:new c(void 0!=u?new u:p()),w=null!=u&&"string"!=typeof u?new u:void 0==v?new h:new f,x=void 0,y=0,z=H,A="",B="",C="",D="",E=M,F=0,G=0,R=function(b,c,d,e){if(z===I)if(200===b&&void 0!=d&&Q.test(d)){z=J,o=Date.now(),k=g,a.readyState=J;var f=new m("open",{status:b,statusText:c,headers:e});a.dispatchEvent(f),V(a,a.onopen,f)}else{var h="";200!==b?(c&&(c=c.replace(/\s+/g," ")),h="EventSource's response has a status "+b+" "+c+" that is not 200. Aborting the connection."):h="EventSource's response has a Content-Type specifying an unsupported type: "+(void 0==d?"-":d.replace(/\s+/g," "))+". Aborting the connection.",Y();var f=new m("error",{status:b,statusText:c,headers:e});a.dispatchEvent(f),V(a,a.onerror,f)}},S=function(b){if(z===J){for(var c=-1,d=0;d<b.length;d+=1){var e=b.charCodeAt(d);(e==="\n".charCodeAt(0)||e==="\r".charCodeAt(0))&&(c=d)}var f=(-1!==c?D:"")+b.slice(0,c+1);D=(-1===c?D:"")+b.slice(c+1),""!==b&&(o=Date.now(),q+=b.length);for(var h=0;h<f.length;h+=1){var e=f.charCodeAt(h);if(E===L&&e==="\n".charCodeAt(0))E=M;else if(E===L&&(E=M),e==="\r".charCodeAt(0)||e==="\n".charCodeAt(0)){if(E!==M){E===N&&(G=h+1);var m=f.slice(F,G-1),n=f.slice(G+(h>G&&f.charCodeAt(G)===" ".charCodeAt(0)?1:0),h);"data"===m?(A+="\n",A+=n):"id"===m?B=n:"event"===m?C=n:"retry"===m?(g=T(n,g),k=g):"heartbeatTimeout"===m&&(i=T(n,i),0!==y&&(s(y),y=r(function(){Z()},i)))}if(E===M){if(""!==A){j=B,""===C&&(C="message");var p=new l(C,{data:A.slice(1),lastEventId:B});if(a.dispatchEvent(p),"open"===C?V(a,a.onopen,p):"message"===C?V(a,a.onmessage,p):"error"===C&&V(a,a.onerror,p),z===K)return}A="",C=""}E=e==="\r".charCodeAt(0)?L:M}else E===M&&(F=h,E=N),E===N?e===":".charCodeAt(0)&&(G=h+1,E=O):E===O&&(E=P)}}},X=function(b){if(z===J||z===I){z=H,0!==y&&(s(y),y=0),y=r(function(){Z()},k),k=U(Math.min(16*g,2*k)),a.readyState=I;var c=new n("error",{error:b});a.dispatchEvent(c),V(a,a.onerror,c)}},Y=function(){z=K,void 0!=x&&(x.abort(),x=void 0),0!==y&&(s(y),y=0),a.readyState=K},Z=function(){if(y=0,z===H){o=!1,q=0,y=r(function(){Z()},i),z=I,A="",C="",B=j,D="",F=0,G=0,E=M;var c=b;"data:"!==b.slice(0,5)&&"blob:"!==b.slice(0,5)&&""!==j&&(c+=(-1===b.indexOf("?")?"?":"&")+"lastEventId="+encodeURIComponent(j));var d=a.withCredentials,e={};e.Accept="text/event-stream";var f=a.headers;if(void 0!=f)for(var g in f)Object.prototype.hasOwnProperty.call(f,g)&&(e[g]=f[g]);try{x=w.open(v,R,S,X,c,d,e)}catch(h){throw Y(),h}}else if(o||void 0==x){var k=Math.max((o||Date.now())+i-Date.now(),1);o=!1,y=r(function(){Z()},k)}else X(new Error("No activity within "+i+" milliseconds. "+(z===I?"No response received.":q+" chars received.")+" Reconnecting.")),void 0!=x&&(x.abort(),x=void 0)};a.url=b,a.readyState=I,a.withCredentials=e,a.headers=t,a._close=Y,Z()}var r=a.setTimeout,s=a.clearTimeout,t=a.XMLHttpRequest,u=a.XDomainRequest,v=a.ActiveXObject,w=a.EventSource,x=a.document,y=a.Promise,z=a.fetch,A=a.Response,B=a.TextDecoder,C=a.TextEncoder,D=a.AbortController;if("undefined"==typeof window||"readyState"in x||null!=x.body||(x.readyState="loading",window.addEventListener("load",function(a){x.readyState="complete"},!1)),null==t&&(t=function(){return new v("Microsoft.XMLHTTP")}),void 0==Object.create&&(Object.create=function(a){function b(){}return b.prototype=a,new b}),Date.now||(Date.now=function(){return(new Date).getTime()}),void 0==D){var E=z;z=function(a,b){var c=b.signal;return E(a,{headers:b.headers,credentials:b.credentials,cache:b.cache}).then(function(a){var b=a.body.getReader();return c._reader=b,c._aborted&&c._reader.cancel(),{status:a.status,statusText:a.statusText,headers:a.headers,body:{getReader:function(){return b}}}})},D=function(){this.signal={_reader:null,_aborted:!1},this.abort=function(){null!=this.signal._reader&&this.signal._reader.cancel(),this.signal._aborted=!0}}}b.prototype.decode=function(a){function b(a,b,c){if(1===c)return a>=128>>b&&2047>=a<<b;if(2===c)return a>=2048>>b&&55295>=a<<b||a>=57344>>b&&65535>=a<<b;if(3===c)return a>=65536>>b&&1114111>=a<<b;throw new Error}function c(a,b){if(6===a)return b>>6>15?3:b>31?2:1;if(12===a)return b>15?3:2;if(18===a)return 3;throw new Error}for(var d=65533,e="",f=this.bitsNeeded,g=this.codePoint,h=0;h<a.length;h+=1){var i=a[h];0!==f&&(128>i||i>191||!b(g<<6|63&i,f-6,c(f,g)))&&(f=0,g=d,e+=String.fromCharCode(g)),0===f?(i>=0&&127>=i?(f=0,g=i):i>=192&&223>=i?(f=6,g=31&i):i>=224&&239>=i?(f=12,g=15&i):i>=240&&247>=i?(f=18,g=7&i):(f=0,g=d),0===f||b(g,f,c(f,g))||(f=0,g=d)):(f-=6,g=g<<6|63&i),0===f&&(65535>=g?e+=String.fromCharCode(g):(e+=String.fromCharCode(55296+(g-65535-1>>10)),e+=String.fromCharCode(56320+(g-65535-1&1023))))}return this.bitsNeeded=f,this.codePoint=g,e};var F=function(){try{return"test"===(new B).decode((new C).encode("test"),{stream:!0})}catch(a){}return!1};void 0!=B&&void 0!=C&&F()||(B=b);var G=function(){};c.prototype.open=function(a,b){this._abort(!0);var c=this,d=this._xhr,e=1,f=0;this._abort=function(a){0!==c._sendTimeout&&(s(c._sendTimeout),c._sendTimeout=0),(1===e||2===e||3===e)&&(e=4,d.onload=G,d.onerror=G,d.onabort=G,d.onprogress=G,d.onreadystatechange=G,d.abort(),0!==f&&(s(f),f=0),a||(c.readyState=4,c.onabort(null),c.onreadystatechange())),e=0};var g=function(){if(1===e){var a=0,b="",f=void 0;if("contentType"in d)a=200,b="OK",f=d.contentType;else try{a=d.status,b=d.statusText,f=d.getResponseHeader("Content-Type")}catch(g){a=0,b="",f=void 0}0!==a&&(e=2,c.readyState=2,c.status=a,c.statusText=b,c._contentType=f,c.onreadystatechange())}},h=function(){if(g(),2===e||3===e){e=3;var a="";try{a=d.responseText}catch(b){}c.readyState=3,c.responseText=a,c.onprogress()}},i=function(a,b){if((null==b||null==b.preventDefault)&&(b={preventDefault:G}),h(),1===e||2===e||3===e){if(e=4,0!==f&&(s(f),f=0),c.readyState=4,"load"===a)c.onload(b);else if("error"===a)c.onerror(b);else{if("abort"!==a)throw new TypeError;c.onabort(b)}c.onreadystatechange()}},j=function(a){void 0!=d&&(4===d.readyState?"onload"in d&&"onerror"in d&&"onabort"in d||i(""===d.responseText?"error":"load",a):3===d.readyState?"onprogress"in d||h():2===d.readyState&&g())},k=function(){f=r(function(){k()},500),3===d.readyState&&h()};"onload"in d&&(d.onload=function(a){i("load",a)}),"onerror"in d&&(d.onerror=function(a){i("error",a)}),"onabort"in d&&(d.onabort=function(a){i("abort",a)}),"onprogress"in d&&(d.onprogress=h),"onreadystatechange"in d&&(d.onreadystatechange=function(a){j(a)}),("contentType"in d||!("ontimeout"in t.prototype))&&(b+=(-1===b.indexOf("?")?"?":"&")+"padding=true"),d.open(a,b,!0),"readyState"in d&&(f=r(function(){k()},0))},c.prototype.abort=function(){this._abort(!1)},c.prototype.getResponseHeader=function(a){return this._contentType},c.prototype.setRequestHeader=function(a,b){var c=this._xhr;"setRequestHeader"in c&&c.setRequestHeader(a,b)},c.prototype.getAllResponseHeaders=function(){return void 0!=this._xhr.getAllResponseHeaders?this._xhr.getAllResponseHeaders()||"":""},c.prototype.send=function(){if(!("ontimeout"in t.prototype&&("sendAsBinary"in t.prototype||"mozAnon"in t.prototype)||void 0==x||void 0==x.readyState||"complete"===x.readyState)){var a=this;return void(a._sendTimeout=r(function(){a._sendTimeout=0,a.send()},4))}var b=this._xhr;"withCredentials"in b&&(b.withCredentials=this.withCredentials);try{b.send(void 0)}catch(c){throw c}},e.prototype.get=function(a){return this._map[d(a)]},null!=t&&null==t.HEADERS_RECEIVED&&(t.HEADERS_RECEIVED=2),f.prototype.open=function(a,b,c,d,f,g,h){a.open("GET",f);var i=0;a.onprogress=function(){var b=a.responseText,d=b.slice(i);i+=d.length,c(d)},a.onerror=function(a){a.preventDefault(),d(new Error("NetworkError"))},a.onload=function(){d(null)},a.onabort=function(){d(null)},a.onreadystatechange=function(){if(a.readyState===t.HEADERS_RECEIVED){var c=a.status,d=a.statusText,f=a.getResponseHeader("Content-Type"),g=a.getAllResponseHeaders();b(c,d,f,new e(g))}},a.withCredentials=g;for(var j in h)Object.prototype.hasOwnProperty.call(h,j)&&a.setRequestHeader(j,h[j]);return a.send(),a},g.prototype.get=function(a){return this._headers.get(a)},h.prototype.open=function(a,b,c,d,e,f,h){var i=null,j=new D,k=j.signal,l=new B;return z(e,{headers:h,credentials:f?"include":"same-origin",signal:k,cache:"no-store"}).then(function(a){return i=a.body.getReader(),b(a.status,a.statusText,a.headers.get("Content-Type"),new g(a.headers)),new y(function(a,b){var d=function(){i.read().then(function(b){if(b.done)a(void 0);else{var e=l.decode(b.value,{stream:!0});c(e),d()}})["catch"](function(a){b(a)})};d()})})["catch"](function(a){return"AbortError"===a.name?void 0:a}).then(function(a){d(a)}),{abort:function(){null!=i&&i.cancel(),j.abort()}}},i.prototype.dispatchEvent=function(a){a.target=this;var b=this._listeners[a.type];if(void 0!=b)for(var c=b.length,d=0;c>d;d+=1){var e=b[d];try{"function"==typeof e.handleEvent?e.handleEvent(a):e.call(this,a)}catch(f){j(f)}}},i.prototype.addEventListener=function(a,b){a=String(a);var c=this._listeners,d=c[a];void 0==d&&(d=[],c[a]=d);for(var e=!1,f=0;f<d.length;f+=1)d[f]===b&&(e=!0);e||d.push(b)},i.prototype.removeEventListener=function(a,b){a=String(a);var c=this._listeners,d=c[a];if(void 0!=d){for(var e=[],f=0;f<d.length;f+=1)d[f]!==b&&e.push(d[f]);0===e.length?delete c[a]:c[a]=e}},l.prototype=Object.create(k.prototype),m.prototype=Object.create(k.prototype),n.prototype=Object.create(k.prototype);var H=-1,I=0,J=1,K=2,L=-1,M=0,N=1,O=2,P=3,Q=/^text\/event\-stream;?(\s*charset\=utf\-8)?$/i,R=1e3,S=18e6,T=function(a,b){var c=null==a?b:parseInt(a,10);return c!==c&&(c=b),U(c)},U=function(a){return Math.min(Math.max(a,R),S)},V=function(a,b,c){try{"function"==typeof b&&b.call(a,c)}catch(d){j(d)}},W=void 0!=z&&void 0!=A&&"body"in A.prototype;o.prototype=Object.create(i.prototype),o.prototype.CONNECTING=I,o.prototype.OPEN=J,o.prototype.CLOSED=K,o.prototype.close=function(){this._close()},o.CONNECTING=I,o.OPEN=J,o.CLOSED=K,o.prototype.withCredentials=void 0;var X=w;void 0==t||void 0!=w&&"withCredentials"in w.prototype||(X=o),function(b){if("object"==typeof module&&"object"==typeof module.exports){var c=b(exports);void 0!==c&&(module.exports=c)}else"function"==typeof define&&define.amd?define(["exports"],b):b(a)}(function(a){a.EventSourcePolyfill=o,a.NativeEventSource=w,a.EventSource=X})}("undefined"!=typeof window?window:"undefined"!=typeof self?self:this);
/*
 * UnicodeNormalizer 1.4.1
 * Copyright (c) 2008 Matsuza
 * Dual licensed under the MIT (MIT-LICENSE.txt) and GPL (GPL-LICENSE.txt) licenses.
 * $Date: 2008-06-05 16:44:17 +0200 (Thu, 05 Jun 2008) $
 * $Rev: 13309 $
 */
!function(t){"use strict";for(var i=[null,0,{}],h=44032,a=4352,c=function(t,r){this.codepoint=t,this.feature=r},o={},s=[],r=0;r<=255;++r)s[r]=0;c.fromCharCode=[function(t,r,e){return r<60||13311<r&&r<42607?new c(r,i):t(r,e)},function(t,r,e){var n=o[r];return n||(n=t(r,e)).feature&&10<++s[r>>8&255]&&(o[r]=n),n},function(t,r,e){return e?t(r,e):new c(r,null)},function(t,r,e){if(r<a||4371<=r&&r<h||55204<r)return t(r,e);if(a<=r&&r<4371){for(var n={},i=21*(r-a),o=0;o<21;++o)n[4449+o]=h+28*(o+i);return new c(r,[,,n])}var s=r-h,u=s%28,f=[];if(0!=u)f[0]=[h+s-u,4519+u];else for(f[0]=[a+Math.floor(s/588),4449+Math.floor(s%588/28)],f[2]={},o=1;o<28;++o)f[2][4519+o]=r+o;return new c(r,f)},function(t,r,e){var n=(c.udata[65280&r]||{})[r];return new c(r,n||i)}].reduceRight(function(e,n){return function(t,r){return n(e,t,r)}},null),c.isHighSurrogate=function(t){return 55296<=t&&t<=56319},c.isLowSurrogate=function(t){return 56320<=t&&t<=57343},c.prototype.prepFeature=function(){this.feature||(this.feature=c.fromCharCode(this.codepoint,!0).feature)},c.prototype.toString=function(){if(this.codepoint<65536)return String.fromCharCode(this.codepoint);var t=this.codepoint-65536;return String.fromCharCode(Math.floor(t/1024)+55296,t%1024+56320)},c.prototype.getDecomp=function(){return this.prepFeature(),this.feature[0]||null},c.prototype.isCompatibility=function(){return this.prepFeature(),!!this.feature[1]&&256&this.feature[1]},c.prototype.isExclude=function(){return this.prepFeature(),!!this.feature[1]&&512&this.feature[1]},c.prototype.getCanonicalClass=function(){return this.prepFeature(),this.feature[1]?255&this.feature[1]:0},c.prototype.getComposite=function(t){if(this.prepFeature(),!this.feature[2])return null;var r=this.feature[2][t.codepoint];return r?c.fromCharCode(r):null};function u(t){this.str=t,this.cursor=0}u.prototype.next=function(){if(this.str&&this.cursor<this.str.length){var t,r=this.str.charCodeAt(this.cursor++);return c.isHighSurrogate(r)&&this.cursor<this.str.length&&c.isLowSurrogate(t=this.str.charCodeAt(this.cursor))&&(r=1024*(r-55296)+(t-56320)+65536,++this.cursor),c.fromCharCode(r)}return this.str=null};function f(t,r){this.it=t,this.canonical=r,this.resBuf=[]}f.prototype.next=function(){if(0===this.resBuf.length){var t=this.it.next();if(!t)return null;this.resBuf=function t(r,e){var n=e.getDecomp();if(!n||r&&e.isCompatibility())return[e];for(var i=[],o=0;o<n.length;++o)var s=t(r,c.fromCharCode(n[o])),i=i.concat(s);return i}(this.canonical,t)}return this.resBuf.shift()};function p(t){this.it=t,this.resBuf=[]}p.prototype.next=function(){var t;if(0===this.resBuf.length)do{var r=this.it.next();if(!r)break;t=r.getCanonicalClass();var e=this.resBuf.length;if(0!==t)for(;0<e;--e){if(this.resBuf[e-1].getCanonicalClass()<=t)break}this.resBuf.splice(e,0,r)}while(0!==t);return this.resBuf.shift()};function l(t){this.it=t,this.procBuf=[],this.resBuf=[],this.lastClass=null}l.prototype.next=function(){for(;0===this.resBuf.length;){var t,r,e=this.it.next();if(!e){this.resBuf=this.procBuf,this.procBuf=[];break}0===this.procBuf.length?(this.lastClass=e.getCanonicalClass(),this.procBuf.push(e)):(t=this.procBuf[0].getComposite(e),r=e.getCanonicalClass(),t&&(this.lastClass<r||0===this.lastClass)?this.procBuf[0]=t:(0===r&&(this.resBuf=this.procBuf,this.procBuf=[]),this.lastClass=r,this.procBuf.push(e)))}return this.resBuf.shift()};function e(t,r){for(var e,n=function(t,r){switch(t){case"NFD":return new p(new f(new u(r),!0));case"NFKD":return new p(new f(new u(r),!1));case"NFC":return new l(new p(new f(new u(r),!0)));case"NFKC":return new l(new p(new f(new u(r),!1)))}throw t+" is invalid"}(t,r),i="";e=n.next();)i+=e.toString();return i}c.udata={0:{60:[,,{824:8814}],61:[,,{824:8800}],62:[,,{824:8815}],65:[,,{768:192,769:193,770:194,771:195,772:256,774:258,775:550,776:196,777:7842,778:197,780:461,783:512,785:514,803:7840,805:7680,808:260}],66:[,,{775:7682,803:7684,817:7686}],67:[,,{769:262,770:264,775:266,780:268,807:199}],68:[,,{775:7690,780:270,803:7692,807:7696,813:7698,817:7694}],69:[,,{768:200,769:201,770:202,771:7868,772:274,774:276,775:278,776:203,777:7866,780:282,783:516,785:518,803:7864,807:552,808:280,813:7704,816:7706}],70:[,,{775:7710}],71:[,,{769:500,770:284,772:7712,774:286,775:288,780:486,807:290}],72:[,,{770:292,775:7714,776:7718,780:542,803:7716,807:7720,814:7722}],73:[,,{768:204,769:205,770:206,771:296,772:298,774:300,775:304,776:207,777:7880,780:463,783:520,785:522,803:7882,808:302,816:7724}],74:[,,{770:308}],75:[,,{769:7728,780:488,803:7730,807:310,817:7732}],76:[,,{769:313,780:317,803:7734,807:315,813:7740,817:7738}],77:[,,{769:7742,775:7744,803:7746}],78:[,,{768:504,769:323,771:209,775:7748,780:327,803:7750,807:325,813:7754,817:7752}],79:[,,{768:210,769:211,770:212,771:213,772:332,774:334,775:558,776:214,777:7886,779:336,780:465,783:524,785:526,795:416,803:7884,808:490}],80:[,,{769:7764,775:7766}],82:[,,{769:340,775:7768,780:344,783:528,785:530,803:7770,807:342,817:7774}],83:[,,{769:346,770:348,775:7776,780:352,803:7778,806:536,807:350}],84:[,,{775:7786,780:356,803:7788,806:538,807:354,813:7792,817:7790}],85:[,,{768:217,769:218,770:219,771:360,772:362,774:364,776:220,777:7910,778:366,779:368,780:467,783:532,785:534,795:431,803:7908,804:7794,808:370,813:7798,816:7796}],86:[,,{771:7804,803:7806}],87:[,,{768:7808,769:7810,770:372,775:7814,776:7812,803:7816}],88:[,,{775:7818,776:7820}],89:[,,{768:7922,769:221,770:374,771:7928,772:562,775:7822,776:376,777:7926,803:7924}],90:[,,{769:377,770:7824,775:379,780:381,803:7826,817:7828}],97:[,,{768:224,769:225,770:226,771:227,772:257,774:259,775:551,776:228,777:7843,778:229,780:462,783:513,785:515,803:7841,805:7681,808:261}],98:[,,{775:7683,803:7685,817:7687}],99:[,,{769:263,770:265,775:267,780:269,807:231}],100:[,,{775:7691,780:271,803:7693,807:7697,813:7699,817:7695}],101:[,,{768:232,769:233,770:234,771:7869,772:275,774:277,775:279,776:235,777:7867,780:283,783:517,785:519,803:7865,807:553,808:281,813:7705,816:7707}],102:[,,{775:7711}],103:[,,{769:501,770:285,772:7713,774:287,775:289,780:487,807:291}],104:[,,{770:293,775:7715,776:7719,780:543,803:7717,807:7721,814:7723,817:7830}],105:[,,{768:236,769:237,770:238,771:297,772:299,774:301,776:239,777:7881,780:464,783:521,785:523,803:7883,808:303,816:7725}],106:[,,{770:309,780:496}],107:[,,{769:7729,780:489,803:7731,807:311,817:7733}],108:[,,{769:314,780:318,803:7735,807:316,813:7741,817:7739}],109:[,,{769:7743,775:7745,803:7747}],110:[,,{768:505,769:324,771:241,775:7749,780:328,803:7751,807:326,813:7755,817:7753}],111:[,,{768:242,769:243,770:244,771:245,772:333,774:335,775:559,776:246,777:7887,779:337,780:466,783:525,785:527,795:417,803:7885,808:491}],112:[,,{769:7765,775:7767}],114:[,,{769:341,775:7769,780:345,783:529,785:531,803:7771,807:343,817:7775}],115:[,,{769:347,770:349,775:7777,780:353,803:7779,806:537,807:351}],116:[,,{775:7787,776:7831,780:357,803:7789,806:539,807:355,813:7793,817:7791}],117:[,,{768:249,769:250,770:251,771:361,772:363,774:365,776:252,777:7911,778:367,779:369,780:468,783:533,785:535,795:432,803:7909,804:7795,808:371,813:7799,816:7797}],118:[,,{771:7805,803:7807}],119:[,,{768:7809,769:7811,770:373,775:7815,776:7813,778:7832,803:7817}],120:[,,{775:7819,776:7821}],121:[,,{768:7923,769:253,770:375,771:7929,772:563,775:7823,776:255,777:7927,778:7833,803:7925}],122:[,,{769:378,770:7825,775:380,780:382,803:7827,817:7829}],160:[[32],256],168:[[32,776],256,{768:8173,769:901,834:8129}],170:[[97],256],175:[[32,772],256],178:[[50],256],179:[[51],256],180:[[32,769],256],181:[[956],256],184:[[32,807],256],185:[[49],256],186:[[111],256],188:[[49,8260,52],256],189:[[49,8260,50],256],190:[[51,8260,52],256],192:[[65,768]],193:[[65,769]],194:[[65,770],,{768:7846,769:7844,771:7850,777:7848}],195:[[65,771]],196:[[65,776],,{772:478}],197:[[65,778],,{769:506}],198:[,,{769:508,772:482}],199:[[67,807],,{769:7688}],200:[[69,768]],201:[[69,769]],202:[[69,770],,{768:7872,769:7870,771:7876,777:7874}],203:[[69,776]],204:[[73,768]],205:[[73,769]],206:[[73,770]],207:[[73,776],,{769:7726}],209:[[78,771]],210:[[79,768]],211:[[79,769]],212:[[79,770],,{768:7890,769:7888,771:7894,777:7892}],213:[[79,771],,{769:7756,772:556,776:7758}],214:[[79,776],,{772:554}],216:[,,{769:510}],217:[[85,768]],218:[[85,769]],219:[[85,770]],220:[[85,776],,{768:475,769:471,772:469,780:473}],221:[[89,769]],224:[[97,768]],225:[[97,769]],226:[[97,770],,{768:7847,769:7845,771:7851,777:7849}],227:[[97,771]],228:[[97,776],,{772:479}],229:[[97,778],,{769:507}],230:[,,{769:509,772:483}],231:[[99,807],,{769:7689}],232:[[101,768]],233:[[101,769]],234:[[101,770],,{768:7873,769:7871,771:7877,777:7875}],235:[[101,776]],236:[[105,768]],237:[[105,769]],238:[[105,770]],239:[[105,776],,{769:7727}],241:[[110,771]],242:[[111,768]],243:[[111,769]],244:[[111,770],,{768:7891,769:7889,771:7895,777:7893}],245:[[111,771],,{769:7757,772:557,776:7759}],246:[[111,776],,{772:555}],248:[,,{769:511}],249:[[117,768]],250:[[117,769]],251:[[117,770]],252:[[117,776],,{768:476,769:472,772:470,780:474}],253:[[121,769]],255:[[121,776]]},256:{256:[[65,772]],257:[[97,772]],258:[[65,774],,{768:7856,769:7854,771:7860,777:7858}],259:[[97,774],,{768:7857,769:7855,771:7861,777:7859}],260:[[65,808]],261:[[97,808]],262:[[67,769]],263:[[99,769]],264:[[67,770]],265:[[99,770]],266:[[67,775]],267:[[99,775]],268:[[67,780]],269:[[99,780]],270:[[68,780]],271:[[100,780]],274:[[69,772],,{768:7700,769:7702}],275:[[101,772],,{768:7701,769:7703}],276:[[69,774]],277:[[101,774]],278:[[69,775]],279:[[101,775]],280:[[69,808]],281:[[101,808]],282:[[69,780]],283:[[101,780]],284:[[71,770]],285:[[103,770]],286:[[71,774]],287:[[103,774]],288:[[71,775]],289:[[103,775]],290:[[71,807]],291:[[103,807]],292:[[72,770]],293:[[104,770]],296:[[73,771]],297:[[105,771]],298:[[73,772]],299:[[105,772]],300:[[73,774]],301:[[105,774]],302:[[73,808]],303:[[105,808]],304:[[73,775]],306:[[73,74],256],307:[[105,106],256],308:[[74,770]],309:[[106,770]],310:[[75,807]],311:[[107,807]],313:[[76,769]],314:[[108,769]],315:[[76,807]],316:[[108,807]],317:[[76,780]],318:[[108,780]],319:[[76,183],256],320:[[108,183],256],323:[[78,769]],324:[[110,769]],325:[[78,807]],326:[[110,807]],327:[[78,780]],328:[[110,780]],329:[[700,110],256],332:[[79,772],,{768:7760,769:7762}],333:[[111,772],,{768:7761,769:7763}],334:[[79,774]],335:[[111,774]],336:[[79,779]],337:[[111,779]],340:[[82,769]],341:[[114,769]],342:[[82,807]],343:[[114,807]],344:[[82,780]],345:[[114,780]],346:[[83,769],,{775:7780}],347:[[115,769],,{775:7781}],348:[[83,770]],349:[[115,770]],350:[[83,807]],351:[[115,807]],352:[[83,780],,{775:7782}],353:[[115,780],,{775:7783}],354:[[84,807]],355:[[116,807]],356:[[84,780]],357:[[116,780]],360:[[85,771],,{769:7800}],361:[[117,771],,{769:7801}],362:[[85,772],,{776:7802}],363:[[117,772],,{776:7803}],364:[[85,774]],365:[[117,774]],366:[[85,778]],367:[[117,778]],368:[[85,779]],369:[[117,779]],370:[[85,808]],371:[[117,808]],372:[[87,770]],373:[[119,770]],374:[[89,770]],375:[[121,770]],376:[[89,776]],377:[[90,769]],378:[[122,769]],379:[[90,775]],380:[[122,775]],381:[[90,780]],382:[[122,780]],383:[[115],256,{775:7835}],416:[[79,795],,{768:7900,769:7898,771:7904,777:7902,803:7906}],417:[[111,795],,{768:7901,769:7899,771:7905,777:7903,803:7907}],431:[[85,795],,{768:7914,769:7912,771:7918,777:7916,803:7920}],432:[[117,795],,{768:7915,769:7913,771:7919,777:7917,803:7921}],439:[,,{780:494}],452:[[68,381],256],453:[[68,382],256],454:[[100,382],256],455:[[76,74],256],456:[[76,106],256],457:[[108,106],256],458:[[78,74],256],459:[[78,106],256],460:[[110,106],256],461:[[65,780]],462:[[97,780]],463:[[73,780]],464:[[105,780]],465:[[79,780]],466:[[111,780]],467:[[85,780]],468:[[117,780]],469:[[220,772]],470:[[252,772]],471:[[220,769]],472:[[252,769]],473:[[220,780]],474:[[252,780]],475:[[220,768]],476:[[252,768]],478:[[196,772]],479:[[228,772]],480:[[550,772]],481:[[551,772]],482:[[198,772]],483:[[230,772]],486:[[71,780]],487:[[103,780]],488:[[75,780]],489:[[107,780]],490:[[79,808],,{772:492}],491:[[111,808],,{772:493}],492:[[490,772]],493:[[491,772]],494:[[439,780]],495:[[658,780]],496:[[106,780]],497:[[68,90],256],498:[[68,122],256],499:[[100,122],256],500:[[71,769]],501:[[103,769]],504:[[78,768]],505:[[110,768]],506:[[197,769]],507:[[229,769]],508:[[198,769]],509:[[230,769]],510:[[216,769]],511:[[248,769]],66045:[,220]},512:{512:[[65,783]],513:[[97,783]],514:[[65,785]],515:[[97,785]],516:[[69,783]],517:[[101,783]],518:[[69,785]],519:[[101,785]],520:[[73,783]],521:[[105,783]],522:[[73,785]],523:[[105,785]],524:[[79,783]],525:[[111,783]],526:[[79,785]],527:[[111,785]],528:[[82,783]],529:[[114,783]],530:[[82,785]],531:[[114,785]],532:[[85,783]],533:[[117,783]],534:[[85,785]],535:[[117,785]],536:[[83,806]],537:[[115,806]],538:[[84,806]],539:[[116,806]],542:[[72,780]],543:[[104,780]],550:[[65,775],,{772:480}],551:[[97,775],,{772:481}],552:[[69,807],,{774:7708}],553:[[101,807],,{774:7709}],554:[[214,772]],555:[[246,772]],556:[[213,772]],557:[[245,772]],558:[[79,775],,{772:560}],559:[[111,775],,{772:561}],560:[[558,772]],561:[[559,772]],562:[[89,772]],563:[[121,772]],658:[,,{780:495}],688:[[104],256],689:[[614],256],690:[[106],256],691:[[114],256],692:[[633],256],693:[[635],256],694:[[641],256],695:[[119],256],696:[[121],256],728:[[32,774],256],729:[[32,775],256],730:[[32,778],256],731:[[32,808],256],732:[[32,771],256],733:[[32,779],256],736:[[611],256],737:[[108],256],738:[[115],256],739:[[120],256],740:[[661],256],66272:[,220]},768:{768:[,230],769:[,230],770:[,230],771:[,230],772:[,230],773:[,230],774:[,230],775:[,230],776:[,230,{769:836}],777:[,230],778:[,230],779:[,230],780:[,230],781:[,230],782:[,230],783:[,230],784:[,230],785:[,230],786:[,230],787:[,230],788:[,230],789:[,232],790:[,220],791:[,220],792:[,220],793:[,220],794:[,232],795:[,216],796:[,220],797:[,220],798:[,220],799:[,220],800:[,220],801:[,202],802:[,202],803:[,220],804:[,220],805:[,220],806:[,220],807:[,202],808:[,202],809:[,220],810:[,220],811:[,220],812:[,220],813:[,220],814:[,220],815:[,220],816:[,220],817:[,220],818:[,220],819:[,220],820:[,1],821:[,1],822:[,1],823:[,1],824:[,1],825:[,220],826:[,220],827:[,220],828:[,220],829:[,230],830:[,230],831:[,230],832:[[768],230],833:[[769],230],834:[,230],835:[[787],230],836:[[776,769],230],837:[,240],838:[,230],839:[,220],840:[,220],841:[,220],842:[,230],843:[,230],844:[,230],845:[,220],846:[,220],848:[,230],849:[,230],850:[,230],851:[,220],852:[,220],853:[,220],854:[,220],855:[,230],856:[,232],857:[,220],858:[,220],859:[,230],860:[,233],861:[,234],862:[,234],863:[,233],864:[,234],865:[,234],866:[,233],867:[,230],868:[,230],869:[,230],870:[,230],871:[,230],872:[,230],873:[,230],874:[,230],875:[,230],876:[,230],877:[,230],878:[,230],879:[,230],884:[[697]],890:[[32,837],256],894:[[59]],900:[[32,769],256],901:[[168,769]],902:[[913,769]],903:[[183]],904:[[917,769]],905:[[919,769]],906:[[921,769]],908:[[927,769]],910:[[933,769]],911:[[937,769]],912:[[970,769]],913:[,,{768:8122,769:902,772:8121,774:8120,787:7944,788:7945,837:8124}],917:[,,{768:8136,769:904,787:7960,788:7961}],919:[,,{768:8138,769:905,787:7976,788:7977,837:8140}],921:[,,{768:8154,769:906,772:8153,774:8152,776:938,787:7992,788:7993}],927:[,,{768:8184,769:908,787:8008,788:8009}],929:[,,{788:8172}],933:[,,{768:8170,769:910,772:8169,774:8168,776:939,788:8025}],937:[,,{768:8186,769:911,787:8040,788:8041,837:8188}],938:[[921,776]],939:[[933,776]],940:[[945,769],,{837:8116}],941:[[949,769]],942:[[951,769],,{837:8132}],943:[[953,769]],944:[[971,769]],945:[,,{768:8048,769:940,772:8113,774:8112,787:7936,788:7937,834:8118,837:8115}],949:[,,{768:8050,769:941,787:7952,788:7953}],951:[,,{768:8052,769:942,787:7968,788:7969,834:8134,837:8131}],953:[,,{768:8054,769:943,772:8145,774:8144,776:970,787:7984,788:7985,834:8150}],959:[,,{768:8056,769:972,787:8e3,788:8001}],961:[,,{787:8164,788:8165}],965:[,,{768:8058,769:973,772:8161,774:8160,776:971,787:8016,788:8017,834:8166}],969:[,,{768:8060,769:974,787:8032,788:8033,834:8182,837:8179}],970:[[953,776],,{768:8146,769:912,834:8151}],971:[[965,776],,{768:8162,769:944,834:8167}],972:[[959,769]],973:[[965,769]],974:[[969,769],,{837:8180}],976:[[946],256],977:[[952],256],978:[[933],256,{769:979,776:980}],979:[[978,769]],980:[[978,776]],981:[[966],256],982:[[960],256],1008:[[954],256],1009:[[961],256],1010:[[962],256],1012:[[920],256],1013:[[949],256],1017:[[931],256],66422:[,230],66423:[,230],66424:[,230],66425:[,230],66426:[,230]},1024:{1024:[[1045,768]],1025:[[1045,776]],1027:[[1043,769]],1030:[,,{776:1031}],1031:[[1030,776]],1036:[[1050,769]],1037:[[1048,768]],1038:[[1059,774]],1040:[,,{774:1232,776:1234}],1043:[,,{769:1027}],1045:[,,{768:1024,774:1238,776:1025}],1046:[,,{774:1217,776:1244}],1047:[,,{776:1246}],1048:[,,{768:1037,772:1250,774:1049,776:1252}],1049:[[1048,774]],1050:[,,{769:1036}],1054:[,,{776:1254}],1059:[,,{772:1262,774:1038,776:1264,779:1266}],1063:[,,{776:1268}],1067:[,,{776:1272}],1069:[,,{776:1260}],1072:[,,{774:1233,776:1235}],1075:[,,{769:1107}],1077:[,,{768:1104,774:1239,776:1105}],1078:[,,{774:1218,776:1245}],1079:[,,{776:1247}],1080:[,,{768:1117,772:1251,774:1081,776:1253}],1081:[[1080,774]],1082:[,,{769:1116}],1086:[,,{776:1255}],1091:[,,{772:1263,774:1118,776:1265,779:1267}],1095:[,,{776:1269}],1099:[,,{776:1273}],1101:[,,{776:1261}],1104:[[1077,768]],1105:[[1077,776]],1107:[[1075,769]],1110:[,,{776:1111}],1111:[[1110,776]],1116:[[1082,769]],1117:[[1080,768]],1118:[[1091,774]],1140:[,,{783:1142}],1141:[,,{783:1143}],1142:[[1140,783]],1143:[[1141,783]],1155:[,230],1156:[,230],1157:[,230],1158:[,230],1159:[,230],1217:[[1046,774]],1218:[[1078,774]],1232:[[1040,774]],1233:[[1072,774]],1234:[[1040,776]],1235:[[1072,776]],1238:[[1045,774]],1239:[[1077,774]],1240:[,,{776:1242}],1241:[,,{776:1243}],1242:[[1240,776]],1243:[[1241,776]],1244:[[1046,776]],1245:[[1078,776]],1246:[[1047,776]],1247:[[1079,776]],1250:[[1048,772]],1251:[[1080,772]],1252:[[1048,776]],1253:[[1080,776]],1254:[[1054,776]],1255:[[1086,776]],1256:[,,{776:1258}],1257:[,,{776:1259}],1258:[[1256,776]],1259:[[1257,776]],1260:[[1069,776]],1261:[[1101,776]],1262:[[1059,772]],1263:[[1091,772]],1264:[[1059,776]],1265:[[1091,776]],1266:[[1059,779]],1267:[[1091,779]],1268:[[1063,776]],1269:[[1095,776]],1272:[[1067,776]],1273:[[1099,776]]},1280:{1415:[[1381,1410],256],1425:[,220],1426:[,230],1427:[,230],1428:[,230],1429:[,230],1430:[,220],1431:[,230],1432:[,230],1433:[,230],1434:[,222],1435:[,220],1436:[,230],1437:[,230],1438:[,230],1439:[,230],1440:[,230],1441:[,230],1442:[,220],1443:[,220],1444:[,220],1445:[,220],1446:[,220],1447:[,220],1448:[,230],1449:[,230],1450:[,220],1451:[,230],1452:[,230],1453:[,222],1454:[,228],1455:[,230],1456:[,10],1457:[,11],1458:[,12],1459:[,13],1460:[,14],1461:[,15],1462:[,16],1463:[,17],1464:[,18],1465:[,19],1466:[,19],1467:[,20],1468:[,21],1469:[,22],1471:[,23],1473:[,24],1474:[,25],1476:[,230],1477:[,220],1479:[,18]},1536:{1552:[,230],1553:[,230],1554:[,230],1555:[,230],1556:[,230],1557:[,230],1558:[,230],1559:[,230],1560:[,30],1561:[,31],1562:[,32],1570:[[1575,1619]],1571:[[1575,1620]],1572:[[1608,1620]],1573:[[1575,1621]],1574:[[1610,1620]],1575:[,,{1619:1570,1620:1571,1621:1573}],1608:[,,{1620:1572}],1610:[,,{1620:1574}],1611:[,27],1612:[,28],1613:[,29],1614:[,30],1615:[,31],1616:[,32],1617:[,33],1618:[,34],1619:[,230],1620:[,230],1621:[,220],1622:[,220],1623:[,230],1624:[,230],1625:[,230],1626:[,230],1627:[,230],1628:[,220],1629:[,230],1630:[,230],1631:[,220],1648:[,35],1653:[[1575,1652],256],1654:[[1608,1652],256],1655:[[1735,1652],256],1656:[[1610,1652],256],1728:[[1749,1620]],1729:[,,{1620:1730}],1730:[[1729,1620]],1746:[,,{1620:1747}],1747:[[1746,1620]],1749:[,,{1620:1728}],1750:[,230],1751:[,230],1752:[,230],1753:[,230],1754:[,230],1755:[,230],1756:[,230],1759:[,230],1760:[,230],1761:[,230],1762:[,230],1763:[,220],1764:[,230],1767:[,230],1768:[,230],1770:[,220],1771:[,230],1772:[,230],1773:[,220]},1792:{1809:[,36],1840:[,230],1841:[,220],1842:[,230],1843:[,230],1844:[,220],1845:[,230],1846:[,230],1847:[,220],1848:[,220],1849:[,220],1850:[,230],1851:[,220],1852:[,220],1853:[,230],1854:[,220],1855:[,230],1856:[,230],1857:[,230],1858:[,220],1859:[,230],1860:[,220],1861:[,230],1862:[,220],1863:[,230],1864:[,220],1865:[,230],1866:[,230],2027:[,230],2028:[,230],2029:[,230],2030:[,230],2031:[,230],2032:[,230],2033:[,230],2034:[,220],2035:[,230]},2048:{2070:[,230],2071:[,230],2072:[,230],2073:[,230],2075:[,230],2076:[,230],2077:[,230],2078:[,230],2079:[,230],2080:[,230],2081:[,230],2082:[,230],2083:[,230],2085:[,230],2086:[,230],2087:[,230],2089:[,230],2090:[,230],2091:[,230],2092:[,230],2093:[,230],2137:[,220],2138:[,220],2139:[,220],2276:[,230],2277:[,230],2278:[,220],2279:[,230],2280:[,230],2281:[,220],2282:[,230],2283:[,230],2284:[,230],2285:[,220],2286:[,220],2287:[,220],2288:[,27],2289:[,28],2290:[,29],2291:[,230],2292:[,230],2293:[,230],2294:[,220],2295:[,230],2296:[,230],2297:[,220],2298:[,220],2299:[,230],2300:[,230],2301:[,230],2302:[,230],2303:[,230]},2304:{2344:[,,{2364:2345}],2345:[[2344,2364]],2352:[,,{2364:2353}],2353:[[2352,2364]],2355:[,,{2364:2356}],2356:[[2355,2364]],2364:[,7],2381:[,9],2385:[,230],2386:[,220],2387:[,230],2388:[,230],2392:[[2325,2364],512],2393:[[2326,2364],512],2394:[[2327,2364],512],2395:[[2332,2364],512],2396:[[2337,2364],512],2397:[[2338,2364],512],2398:[[2347,2364],512],2399:[[2351,2364],512],2492:[,7],2503:[,,{2494:2507,2519:2508}],2507:[[2503,2494]],2508:[[2503,2519]],2509:[,9],2524:[[2465,2492],512],2525:[[2466,2492],512],2527:[[2479,2492],512]},2560:{2611:[[2610,2620],512],2614:[[2616,2620],512],2620:[,7],2637:[,9],2649:[[2582,2620],512],2650:[[2583,2620],512],2651:[[2588,2620],512],2654:[[2603,2620],512],2748:[,7],2765:[,9],68109:[,220],68111:[,230],68152:[,230],68153:[,1],68154:[,220],68159:[,9],68325:[,230],68326:[,220]},2816:{2876:[,7],2887:[,,{2878:2891,2902:2888,2903:2892}],2888:[[2887,2902]],2891:[[2887,2878]],2892:[[2887,2903]],2893:[,9],2908:[[2849,2876],512],2909:[[2850,2876],512],2962:[,,{3031:2964}],2964:[[2962,3031]],3014:[,,{3006:3018,3031:3020}],3015:[,,{3006:3019}],3018:[[3014,3006]],3019:[[3015,3006]],3020:[[3014,3031]],3021:[,9]},3072:{3142:[,,{3158:3144}],3144:[[3142,3158]],3149:[,9],3157:[,84],3158:[,91],3260:[,7],3263:[,,{3285:3264}],3264:[[3263,3285]],3270:[,,{3266:3274,3285:3271,3286:3272}],3271:[[3270,3285]],3272:[[3270,3286]],3274:[[3270,3266],,{3285:3275}],3275:[[3274,3285]],3277:[,9]},3328:{3398:[,,{3390:3402,3415:3404}],3399:[,,{3390:3403}],3402:[[3398,3390]],3403:[[3399,3390]],3404:[[3398,3415]],3405:[,9],3530:[,9],3545:[,,{3530:3546,3535:3548,3551:3550}],3546:[[3545,3530]],3548:[[3545,3535],,{3530:3549}],3549:[[3548,3530]],3550:[[3545,3551]]},3584:{3635:[[3661,3634],256],3640:[,103],3641:[,103],3642:[,9],3656:[,107],3657:[,107],3658:[,107],3659:[,107],3763:[[3789,3762],256],3768:[,118],3769:[,118],3784:[,122],3785:[,122],3786:[,122],3787:[,122],3804:[[3755,3737],256],3805:[[3755,3745],256]},3840:{3852:[[3851],256],3864:[,220],3865:[,220],3893:[,220],3895:[,220],3897:[,216],3907:[[3906,4023],512],3917:[[3916,4023],512],3922:[[3921,4023],512],3927:[[3926,4023],512],3932:[[3931,4023],512],3945:[[3904,4021],512],3953:[,129],3954:[,130],3955:[[3953,3954],512],3956:[,132],3957:[[3953,3956],512],3958:[[4018,3968],512],3959:[[4018,3969],256],3960:[[4019,3968],512],3961:[[4019,3969],256],3962:[,130],3963:[,130],3964:[,130],3965:[,130],3968:[,130],3969:[[3953,3968],512],3970:[,230],3971:[,230],3972:[,9],3974:[,230],3975:[,230],3987:[[3986,4023],512],3997:[[3996,4023],512],4002:[[4001,4023],512],4007:[[4006,4023],512],4012:[[4011,4023],512],4025:[[3984,4021],512],4038:[,220]},4096:{4133:[,,{4142:4134}],4134:[[4133,4142]],4151:[,7],4153:[,9],4154:[,9],4237:[,220],4348:[[4316],256],69702:[,9],69759:[,9],69785:[,,{69818:69786}],69786:[[69785,69818]],69787:[,,{69818:69788}],69788:[[69787,69818]],69797:[,,{69818:69803}],69803:[[69797,69818]],69817:[,9],69818:[,7]},4352:{69888:[,230],69889:[,230],69890:[,230],69934:[[69937,69927]],69935:[[69938,69927]],69937:[,,{69927:69934}],69938:[,,{69927:69935}],69939:[,9],69940:[,9],70003:[,7],70080:[,9]},4608:{70197:[,9],70198:[,7],70377:[,7],70378:[,9]},4864:{4957:[,230],4958:[,230],4959:[,230],70460:[,7],70471:[,,{70462:70475,70487:70476}],70475:[[70471,70462]],70476:[[70471,70487]],70477:[,9],70502:[,230],70503:[,230],70504:[,230],70505:[,230],70506:[,230],70507:[,230],70508:[,230],70512:[,230],70513:[,230],70514:[,230],70515:[,230],70516:[,230]},5120:{70841:[,,{70832:70844,70842:70843,70845:70846}],70843:[[70841,70842]],70844:[[70841,70832]],70846:[[70841,70845]],70850:[,9],70851:[,7]},5376:{71096:[,,{71087:71098}],71097:[,,{71087:71099}],71098:[[71096,71087]],71099:[[71097,71087]],71103:[,9],71104:[,7]},5632:{71231:[,9],71350:[,9],71351:[,7]},5888:{5908:[,9],5940:[,9],6098:[,9],6109:[,230]},6144:{6313:[,228]},6400:{6457:[,222],6458:[,230],6459:[,220]},6656:{6679:[,230],6680:[,220],6752:[,9],6773:[,230],6774:[,230],6775:[,230],6776:[,230],6777:[,230],6778:[,230],6779:[,230],6780:[,230],6783:[,220],6832:[,230],6833:[,230],6834:[,230],6835:[,230],6836:[,230],6837:[,220],6838:[,220],6839:[,220],6840:[,220],6841:[,220],6842:[,220],6843:[,230],6844:[,230],6845:[,220]},6912:{6917:[,,{6965:6918}],6918:[[6917,6965]],6919:[,,{6965:6920}],6920:[[6919,6965]],6921:[,,{6965:6922}],6922:[[6921,6965]],6923:[,,{6965:6924}],6924:[[6923,6965]],6925:[,,{6965:6926}],6926:[[6925,6965]],6929:[,,{6965:6930}],6930:[[6929,6965]],6964:[,7],6970:[,,{6965:6971}],6971:[[6970,6965]],6972:[,,{6965:6973}],6973:[[6972,6965]],6974:[,,{6965:6976}],6975:[,,{6965:6977}],6976:[[6974,6965]],6977:[[6975,6965]],6978:[,,{6965:6979}],6979:[[6978,6965]],6980:[,9],7019:[,230],7020:[,220],7021:[,230],7022:[,230],7023:[,230],7024:[,230],7025:[,230],7026:[,230],7027:[,230],7082:[,9],7083:[,9],7142:[,7],7154:[,9],7155:[,9]},7168:{7223:[,7],7376:[,230],7377:[,230],7378:[,230],7380:[,1],7381:[,220],7382:[,220],7383:[,220],7384:[,220],7385:[,220],7386:[,230],7387:[,230],7388:[,220],7389:[,220],7390:[,220],7391:[,220],7392:[,230],7394:[,1],7395:[,1],7396:[,1],7397:[,1],7398:[,1],7399:[,1],7400:[,1],7405:[,220],7412:[,230],7416:[,230],7417:[,230]},7424:{7468:[[65],256],7469:[[198],256],7470:[[66],256],7472:[[68],256],7473:[[69],256],7474:[[398],256],7475:[[71],256],7476:[[72],256],7477:[[73],256],7478:[[74],256],7479:[[75],256],7480:[[76],256],7481:[[77],256],7482:[[78],256],7484:[[79],256],7485:[[546],256],7486:[[80],256],7487:[[82],256],7488:[[84],256],7489:[[85],256],7490:[[87],256],7491:[[97],256],7492:[[592],256],7493:[[593],256],7494:[[7426],256],7495:[[98],256],7496:[[100],256],7497:[[101],256],7498:[[601],256],7499:[[603],256],7500:[[604],256],7501:[[103],256],7503:[[107],256],7504:[[109],256],7505:[[331],256],7506:[[111],256],7507:[[596],256],7508:[[7446],256],7509:[[7447],256],7510:[[112],256],7511:[[116],256],7512:[[117],256],7513:[[7453],256],7514:[[623],256],7515:[[118],256],7516:[[7461],256],7517:[[946],256],7518:[[947],256],7519:[[948],256],7520:[[966],256],7521:[[967],256],7522:[[105],256],7523:[[114],256],7524:[[117],256],7525:[[118],256],7526:[[946],256],7527:[[947],256],7528:[[961],256],7529:[[966],256],7530:[[967],256],7544:[[1085],256],7579:[[594],256],7580:[[99],256],7581:[[597],256],7582:[[240],256],7583:[[604],256],7584:[[102],256],7585:[[607],256],7586:[[609],256],7587:[[613],256],7588:[[616],256],7589:[[617],256],7590:[[618],256],7591:[[7547],256],7592:[[669],256],7593:[[621],256],7594:[[7557],256],7595:[[671],256],7596:[[625],256],7597:[[624],256],7598:[[626],256],7599:[[627],256],7600:[[628],256],7601:[[629],256],7602:[[632],256],7603:[[642],256],7604:[[643],256],7605:[[427],256],7606:[[649],256],7607:[[650],256],7608:[[7452],256],7609:[[651],256],7610:[[652],256],7611:[[122],256],7612:[[656],256],7613:[[657],256],7614:[[658],256],7615:[[952],256],7616:[,230],7617:[,230],7618:[,220],7619:[,230],7620:[,230],7621:[,230],7622:[,230],7623:[,230],7624:[,230],7625:[,230],7626:[,220],7627:[,230],7628:[,230],7629:[,234],7630:[,214],7631:[,220],7632:[,202],7633:[,230],7634:[,230],7635:[,230],7636:[,230],7637:[,230],7638:[,230],7639:[,230],7640:[,230],7641:[,230],7642:[,230],7643:[,230],7644:[,230],7645:[,230],7646:[,230],7647:[,230],7648:[,230],7649:[,230],7650:[,230],7651:[,230],7652:[,230],7653:[,230],7654:[,230],7655:[,230],7656:[,230],7657:[,230],7658:[,230],7659:[,230],7660:[,230],7661:[,230],7662:[,230],7663:[,230],7664:[,230],7665:[,230],7666:[,230],7667:[,230],7668:[,230],7669:[,230],7676:[,233],7677:[,220],7678:[,230],7679:[,220]},7680:{7680:[[65,805]],7681:[[97,805]],7682:[[66,775]],7683:[[98,775]],7684:[[66,803]],7685:[[98,803]],7686:[[66,817]],7687:[[98,817]],7688:[[199,769]],7689:[[231,769]],7690:[[68,775]],7691:[[100,775]],7692:[[68,803]],7693:[[100,803]],7694:[[68,817]],7695:[[100,817]],7696:[[68,807]],7697:[[100,807]],7698:[[68,813]],7699:[[100,813]],7700:[[274,768]],7701:[[275,768]],7702:[[274,769]],7703:[[275,769]],7704:[[69,813]],7705:[[101,813]],7706:[[69,816]],7707:[[101,816]],7708:[[552,774]],7709:[[553,774]],7710:[[70,775]],7711:[[102,775]],7712:[[71,772]],7713:[[103,772]],7714:[[72,775]],7715:[[104,775]],7716:[[72,803]],7717:[[104,803]],7718:[[72,776]],7719:[[104,776]],7720:[[72,807]],7721:[[104,807]],7722:[[72,814]],7723:[[104,814]],7724:[[73,816]],7725:[[105,816]],7726:[[207,769]],7727:[[239,769]],7728:[[75,769]],7729:[[107,769]],7730:[[75,803]],7731:[[107,803]],7732:[[75,817]],7733:[[107,817]],7734:[[76,803],,{772:7736}],7735:[[108,803],,{772:7737}],7736:[[7734,772]],7737:[[7735,772]],7738:[[76,817]],7739:[[108,817]],7740:[[76,813]],7741:[[108,813]],7742:[[77,769]],7743:[[109,769]],7744:[[77,775]],7745:[[109,775]],7746:[[77,803]],7747:[[109,803]],7748:[[78,775]],7749:[[110,775]],7750:[[78,803]],7751:[[110,803]],7752:[[78,817]],7753:[[110,817]],7754:[[78,813]],7755:[[110,813]],7756:[[213,769]],7757:[[245,769]],7758:[[213,776]],7759:[[245,776]],7760:[[332,768]],7761:[[333,768]],7762:[[332,769]],7763:[[333,769]],7764:[[80,769]],7765:[[112,769]],7766:[[80,775]],7767:[[112,775]],7768:[[82,775]],7769:[[114,775]],7770:[[82,803],,{772:7772}],7771:[[114,803],,{772:7773}],7772:[[7770,772]],7773:[[7771,772]],7774:[[82,817]],7775:[[114,817]],7776:[[83,775]],7777:[[115,775]],7778:[[83,803],,{775:7784}],7779:[[115,803],,{775:7785}],7780:[[346,775]],7781:[[347,775]],7782:[[352,775]],7783:[[353,775]],7784:[[7778,775]],7785:[[7779,775]],7786:[[84,775]],7787:[[116,775]],7788:[[84,803]],7789:[[116,803]],7790:[[84,817]],7791:[[116,817]],7792:[[84,813]],7793:[[116,813]],7794:[[85,804]],7795:[[117,804]],7796:[[85,816]],7797:[[117,816]],7798:[[85,813]],7799:[[117,813]],7800:[[360,769]],7801:[[361,769]],7802:[[362,776]],7803:[[363,776]],7804:[[86,771]],7805:[[118,771]],7806:[[86,803]],7807:[[118,803]],7808:[[87,768]],7809:[[119,768]],7810:[[87,769]],7811:[[119,769]],7812:[[87,776]],7813:[[119,776]],7814:[[87,775]],7815:[[119,775]],7816:[[87,803]],7817:[[119,803]],7818:[[88,775]],7819:[[120,775]],7820:[[88,776]],7821:[[120,776]],7822:[[89,775]],7823:[[121,775]],7824:[[90,770]],7825:[[122,770]],7826:[[90,803]],7827:[[122,803]],7828:[[90,817]],7829:[[122,817]],7830:[[104,817]],7831:[[116,776]],7832:[[119,778]],7833:[[121,778]],7834:[[97,702],256],7835:[[383,775]],7840:[[65,803],,{770:7852,774:7862}],7841:[[97,803],,{770:7853,774:7863}],7842:[[65,777]],7843:[[97,777]],7844:[[194,769]],7845:[[226,769]],7846:[[194,768]],7847:[[226,768]],7848:[[194,777]],7849:[[226,777]],7850:[[194,771]],7851:[[226,771]],7852:[[7840,770]],7853:[[7841,770]],7854:[[258,769]],7855:[[259,769]],7856:[[258,768]],7857:[[259,768]],7858:[[258,777]],7859:[[259,777]],7860:[[258,771]],7861:[[259,771]],7862:[[7840,774]],7863:[[7841,774]],7864:[[69,803],,{770:7878}],7865:[[101,803],,{770:7879}],7866:[[69,777]],7867:[[101,777]],7868:[[69,771]],7869:[[101,771]],7870:[[202,769]],7871:[[234,769]],7872:[[202,768]],7873:[[234,768]],7874:[[202,777]],7875:[[234,777]],7876:[[202,771]],7877:[[234,771]],7878:[[7864,770]],7879:[[7865,770]],7880:[[73,777]],7881:[[105,777]],7882:[[73,803]],7883:[[105,803]],7884:[[79,803],,{770:7896}],7885:[[111,803],,{770:7897}],7886:[[79,777]],7887:[[111,777]],7888:[[212,769]],7889:[[244,769]],7890:[[212,768]],7891:[[244,768]],7892:[[212,777]],7893:[[244,777]],7894:[[212,771]],7895:[[244,771]],7896:[[7884,770]],7897:[[7885,770]],7898:[[416,769]],7899:[[417,769]],7900:[[416,768]],7901:[[417,768]],7902:[[416,777]],7903:[[417,777]],7904:[[416,771]],7905:[[417,771]],7906:[[416,803]],7907:[[417,803]],7908:[[85,803]],7909:[[117,803]],7910:[[85,777]],7911:[[117,777]],7912:[[431,769]],7913:[[432,769]],7914:[[431,768]],7915:[[432,768]],7916:[[431,777]],7917:[[432,777]],7918:[[431,771]],7919:[[432,771]],7920:[[431,803]],7921:[[432,803]],7922:[[89,768]],7923:[[121,768]],7924:[[89,803]],7925:[[121,803]],7926:[[89,777]],7927:[[121,777]],7928:[[89,771]],7929:[[121,771]]},7936:{7936:[[945,787],,{768:7938,769:7940,834:7942,837:8064}],7937:[[945,788],,{768:7939,769:7941,834:7943,837:8065}],7938:[[7936,768],,{837:8066}],7939:[[7937,768],,{837:8067}],7940:[[7936,769],,{837:8068}],7941:[[7937,769],,{837:8069}],7942:[[7936,834],,{837:8070}],7943:[[7937,834],,{837:8071}],7944:[[913,787],,{768:7946,769:7948,834:7950,837:8072}],7945:[[913,788],,{768:7947,769:7949,834:7951,837:8073}],7946:[[7944,768],,{837:8074}],7947:[[7945,768],,{837:8075}],7948:[[7944,769],,{837:8076}],7949:[[7945,769],,{837:8077}],7950:[[7944,834],,{837:8078}],7951:[[7945,834],,{837:8079}],7952:[[949,787],,{768:7954,769:7956}],7953:[[949,788],,{768:7955,769:7957}],7954:[[7952,768]],7955:[[7953,768]],7956:[[7952,769]],7957:[[7953,769]],7960:[[917,787],,{768:7962,769:7964}],7961:[[917,788],,{768:7963,769:7965}],7962:[[7960,768]],7963:[[7961,768]],7964:[[7960,769]],7965:[[7961,769]],7968:[[951,787],,{768:7970,769:7972,834:7974,837:8080}],7969:[[951,788],,{768:7971,769:7973,834:7975,837:8081}],7970:[[7968,768],,{837:8082}],7971:[[7969,768],,{837:8083}],7972:[[7968,769],,{837:8084}],7973:[[7969,769],,{837:8085}],7974:[[7968,834],,{837:8086}],7975:[[7969,834],,{837:8087}],7976:[[919,787],,{768:7978,769:7980,834:7982,837:8088}],7977:[[919,788],,{768:7979,769:7981,834:7983,837:8089}],7978:[[7976,768],,{837:8090}],7979:[[7977,768],,{837:8091}],7980:[[7976,769],,{837:8092}],7981:[[7977,769],,{837:8093}],7982:[[7976,834],,{837:8094}],7983:[[7977,834],,{837:8095}],7984:[[953,787],,{768:7986,769:7988,834:7990}],7985:[[953,788],,{768:7987,769:7989,834:7991}],7986:[[7984,768]],7987:[[7985,768]],7988:[[7984,769]],7989:[[7985,769]],7990:[[7984,834]],7991:[[7985,834]],7992:[[921,787],,{768:7994,769:7996,834:7998}],7993:[[921,788],,{768:7995,769:7997,834:7999}],7994:[[7992,768]],7995:[[7993,768]],7996:[[7992,769]],7997:[[7993,769]],7998:[[7992,834]],7999:[[7993,834]],8e3:[[959,787],,{768:8002,769:8004}],8001:[[959,788],,{768:8003,769:8005}],8002:[[8e3,768]],8003:[[8001,768]],8004:[[8e3,769]],8005:[[8001,769]],8008:[[927,787],,{768:8010,769:8012}],8009:[[927,788],,{768:8011,769:8013}],8010:[[8008,768]],8011:[[8009,768]],8012:[[8008,769]],8013:[[8009,769]],8016:[[965,787],,{768:8018,769:8020,834:8022}],8017:[[965,788],,{768:8019,769:8021,834:8023}],8018:[[8016,768]],8019:[[8017,768]],8020:[[8016,769]],8021:[[8017,769]],8022:[[8016,834]],8023:[[8017,834]],8025:[[933,788],,{768:8027,769:8029,834:8031}],8027:[[8025,768]],8029:[[8025,769]],8031:[[8025,834]],8032:[[969,787],,{768:8034,769:8036,834:8038,837:8096}],8033:[[969,788],,{768:8035,769:8037,834:8039,837:8097}],8034:[[8032,768],,{837:8098}],8035:[[8033,768],,{837:8099}],8036:[[8032,769],,{837:8100}],8037:[[8033,769],,{837:8101}],8038:[[8032,834],,{837:8102}],8039:[[8033,834],,{837:8103}],8040:[[937,787],,{768:8042,769:8044,834:8046,837:8104}],8041:[[937,788],,{768:8043,769:8045,834:8047,837:8105}],8042:[[8040,768],,{837:8106}],8043:[[8041,768],,{837:8107}],8044:[[8040,769],,{837:8108}],8045:[[8041,769],,{837:8109}],8046:[[8040,834],,{837:8110}],8047:[[8041,834],,{837:8111}],8048:[[945,768],,{837:8114}],8049:[[940]],8050:[[949,768]],8051:[[941]],8052:[[951,768],,{837:8130}],8053:[[942]],8054:[[953,768]],8055:[[943]],8056:[[959,768]],8057:[[972]],8058:[[965,768]],8059:[[973]],8060:[[969,768],,{837:8178}],8061:[[974]],8064:[[7936,837]],8065:[[7937,837]],8066:[[7938,837]],8067:[[7939,837]],8068:[[7940,837]],8069:[[7941,837]],8070:[[7942,837]],8071:[[7943,837]],8072:[[7944,837]],8073:[[7945,837]],8074:[[7946,837]],8075:[[7947,837]],8076:[[7948,837]],8077:[[7949,837]],8078:[[7950,837]],8079:[[7951,837]],8080:[[7968,837]],8081:[[7969,837]],8082:[[7970,837]],8083:[[7971,837]],8084:[[7972,837]],8085:[[7973,837]],8086:[[7974,837]],8087:[[7975,837]],8088:[[7976,837]],8089:[[7977,837]],8090:[[7978,837]],8091:[[7979,837]],8092:[[7980,837]],8093:[[7981,837]],8094:[[7982,837]],8095:[[7983,837]],8096:[[8032,837]],8097:[[8033,837]],8098:[[8034,837]],8099:[[8035,837]],8100:[[8036,837]],8101:[[8037,837]],8102:[[8038,837]],8103:[[8039,837]],8104:[[8040,837]],8105:[[8041,837]],8106:[[8042,837]],8107:[[8043,837]],8108:[[8044,837]],8109:[[8045,837]],8110:[[8046,837]],8111:[[8047,837]],8112:[[945,774]],8113:[[945,772]],8114:[[8048,837]],8115:[[945,837]],8116:[[940,837]],8118:[[945,834],,{837:8119}],8119:[[8118,837]],8120:[[913,774]],8121:[[913,772]],8122:[[913,768]],8123:[[902]],8124:[[913,837]],8125:[[32,787],256],8126:[[953]],8127:[[32,787],256,{768:8141,769:8142,834:8143}],8128:[[32,834],256],8129:[[168,834]],8130:[[8052,837]],8131:[[951,837]],8132:[[942,837]],8134:[[951,834],,{837:8135}],8135:[[8134,837]],8136:[[917,768]],8137:[[904]],8138:[[919,768]],8139:[[905]],8140:[[919,837]],8141:[[8127,768]],8142:[[8127,769]],8143:[[8127,834]],8144:[[953,774]],8145:[[953,772]],8146:[[970,768]],8147:[[912]],8150:[[953,834]],8151:[[970,834]],8152:[[921,774]],8153:[[921,772]],8154:[[921,768]],8155:[[906]],8157:[[8190,768]],8158:[[8190,769]],8159:[[8190,834]],8160:[[965,774]],8161:[[965,772]],8162:[[971,768]],8163:[[944]],8164:[[961,787]],8165:[[961,788]],8166:[[965,834]],8167:[[971,834]],8168:[[933,774]],8169:[[933,772]],8170:[[933,768]],8171:[[910]],8172:[[929,788]],8173:[[168,768]],8174:[[901]],8175:[[96]],8178:[[8060,837]],8179:[[969,837]],8180:[[974,837]],8182:[[969,834],,{837:8183}],8183:[[8182,837]],8184:[[927,768]],8185:[[908]],8186:[[937,768]],8187:[[911]],8188:[[937,837]],8189:[[180]],8190:[[32,788],256,{768:8157,769:8158,834:8159}]},8192:{8192:[[8194]],8193:[[8195]],8194:[[32],256],8195:[[32],256],8196:[[32],256],8197:[[32],256],8198:[[32],256],8199:[[32],256],8200:[[32],256],8201:[[32],256],8202:[[32],256],8209:[[8208],256],8215:[[32,819],256],8228:[[46],256],8229:[[46,46],256],8230:[[46,46,46],256],8239:[[32],256],8243:[[8242,8242],256],8244:[[8242,8242,8242],256],8246:[[8245,8245],256],8247:[[8245,8245,8245],256],8252:[[33,33],256],8254:[[32,773],256],8263:[[63,63],256],8264:[[63,33],256],8265:[[33,63],256],8279:[[8242,8242,8242,8242],256],8287:[[32],256],8304:[[48],256],8305:[[105],256],8308:[[52],256],8309:[[53],256],8310:[[54],256],8311:[[55],256],8312:[[56],256],8313:[[57],256],8314:[[43],256],8315:[[8722],256],8316:[[61],256],8317:[[40],256],8318:[[41],256],8319:[[110],256],8320:[[48],256],8321:[[49],256],8322:[[50],256],8323:[[51],256],8324:[[52],256],8325:[[53],256],8326:[[54],256],8327:[[55],256],8328:[[56],256],8329:[[57],256],8330:[[43],256],8331:[[8722],256],8332:[[61],256],8333:[[40],256],8334:[[41],256],8336:[[97],256],8337:[[101],256],8338:[[111],256],8339:[[120],256],8340:[[601],256],8341:[[104],256],8342:[[107],256],8343:[[108],256],8344:[[109],256],8345:[[110],256],8346:[[112],256],8347:[[115],256],8348:[[116],256],8360:[[82,115],256],8400:[,230],8401:[,230],8402:[,1],8403:[,1],8404:[,230],8405:[,230],8406:[,230],8407:[,230],8408:[,1],8409:[,1],8410:[,1],8411:[,230],8412:[,230],8417:[,230],8421:[,1],8422:[,1],8423:[,230],8424:[,220],8425:[,230],8426:[,1],8427:[,1],8428:[,220],8429:[,220],8430:[,220],8431:[,220],8432:[,230]},8448:{8448:[[97,47,99],256],8449:[[97,47,115],256],8450:[[67],256],8451:[[176,67],256],8453:[[99,47,111],256],8454:[[99,47,117],256],8455:[[400],256],8457:[[176,70],256],8458:[[103],256],8459:[[72],256],8460:[[72],256],8461:[[72],256],8462:[[104],256],8463:[[295],256],8464:[[73],256],8465:[[73],256],8466:[[76],256],8467:[[108],256],8469:[[78],256],8470:[[78,111],256],8473:[[80],256],8474:[[81],256],8475:[[82],256],8476:[[82],256],8477:[[82],256],8480:[[83,77],256],8481:[[84,69,76],256],8482:[[84,77],256],8484:[[90],256],8486:[[937]],8488:[[90],256],8490:[[75]],8491:[[197]],8492:[[66],256],8493:[[67],256],8495:[[101],256],8496:[[69],256],8497:[[70],256],8499:[[77],256],8500:[[111],256],8501:[[1488],256],8502:[[1489],256],8503:[[1490],256],8504:[[1491],256],8505:[[105],256],8507:[[70,65,88],256],8508:[[960],256],8509:[[947],256],8510:[[915],256],8511:[[928],256],8512:[[8721],256],8517:[[68],256],8518:[[100],256],8519:[[101],256],8520:[[105],256],8521:[[106],256],8528:[[49,8260,55],256],8529:[[49,8260,57],256],8530:[[49,8260,49,48],256],8531:[[49,8260,51],256],8532:[[50,8260,51],256],8533:[[49,8260,53],256],8534:[[50,8260,53],256],8535:[[51,8260,53],256],8536:[[52,8260,53],256],8537:[[49,8260,54],256],8538:[[53,8260,54],256],8539:[[49,8260,56],256],8540:[[51,8260,56],256],8541:[[53,8260,56],256],8542:[[55,8260,56],256],8543:[[49,8260],256],8544:[[73],256],8545:[[73,73],256],8546:[[73,73,73],256],8547:[[73,86],256],8548:[[86],256],8549:[[86,73],256],8550:[[86,73,73],256],8551:[[86,73,73,73],256],8552:[[73,88],256],8553:[[88],256],8554:[[88,73],256],8555:[[88,73,73],256],8556:[[76],256],8557:[[67],256],8558:[[68],256],8559:[[77],256],8560:[[105],256],8561:[[105,105],256],8562:[[105,105,105],256],8563:[[105,118],256],8564:[[118],256],8565:[[118,105],256],8566:[[118,105,105],256],8567:[[118,105,105,105],256],8568:[[105,120],256],8569:[[120],256],8570:[[120,105],256],8571:[[120,105,105],256],8572:[[108],256],8573:[[99],256],8574:[[100],256],8575:[[109],256],8585:[[48,8260,51],256],8592:[,,{824:8602}],8594:[,,{824:8603}],8596:[,,{824:8622}],8602:[[8592,824]],8603:[[8594,824]],8622:[[8596,824]],8653:[[8656,824]],8654:[[8660,824]],8655:[[8658,824]],8656:[,,{824:8653}],8658:[,,{824:8655}],8660:[,,{824:8654}]},8704:{8707:[,,{824:8708}],8708:[[8707,824]],8712:[,,{824:8713}],8713:[[8712,824]],8715:[,,{824:8716}],8716:[[8715,824]],8739:[,,{824:8740}],8740:[[8739,824]],8741:[,,{824:8742}],8742:[[8741,824]],8748:[[8747,8747],256],8749:[[8747,8747,8747],256],8751:[[8750,8750],256],8752:[[8750,8750,8750],256],8764:[,,{824:8769}],8769:[[8764,824]],8771:[,,{824:8772}],8772:[[8771,824]],8773:[,,{824:8775}],8775:[[8773,824]],8776:[,,{824:8777}],8777:[[8776,824]],8781:[,,{824:8813}],8800:[[61,824]],8801:[,,{824:8802}],8802:[[8801,824]],8804:[,,{824:8816}],8805:[,,{824:8817}],8813:[[8781,824]],8814:[[60,824]],8815:[[62,824]],8816:[[8804,824]],8817:[[8805,824]],8818:[,,{824:8820}],8819:[,,{824:8821}],8820:[[8818,824]],8821:[[8819,824]],8822:[,,{824:8824}],8823:[,,{824:8825}],8824:[[8822,824]],8825:[[8823,824]],8826:[,,{824:8832}],8827:[,,{824:8833}],8828:[,,{824:8928}],8829:[,,{824:8929}],8832:[[8826,824]],8833:[[8827,824]],8834:[,,{824:8836}],8835:[,,{824:8837}],8836:[[8834,824]],8837:[[8835,824]],8838:[,,{824:8840}],8839:[,,{824:8841}],8840:[[8838,824]],8841:[[8839,824]],8849:[,,{824:8930}],8850:[,,{824:8931}],8866:[,,{824:8876}],8872:[,,{824:8877}],8873:[,,{824:8878}],8875:[,,{824:8879}],8876:[[8866,824]],8877:[[8872,824]],8878:[[8873,824]],8879:[[8875,824]],8882:[,,{824:8938}],8883:[,,{824:8939}],8884:[,,{824:8940}],8885:[,,{824:8941}],8928:[[8828,824]],8929:[[8829,824]],8930:[[8849,824]],8931:[[8850,824]],8938:[[8882,824]],8939:[[8883,824]],8940:[[8884,824]],8941:[[8885,824]]},8960:{9001:[[12296]],9002:[[12297]]},9216:{9312:[[49],256],9313:[[50],256],9314:[[51],256],9315:[[52],256],9316:[[53],256],9317:[[54],256],9318:[[55],256],9319:[[56],256],9320:[[57],256],9321:[[49,48],256],9322:[[49,49],256],9323:[[49,50],256],9324:[[49,51],256],9325:[[49,52],256],9326:[[49,53],256],9327:[[49,54],256],9328:[[49,55],256],9329:[[49,56],256],9330:[[49,57],256],9331:[[50,48],256],9332:[[40,49,41],256],9333:[[40,50,41],256],9334:[[40,51,41],256],9335:[[40,52,41],256],9336:[[40,53,41],256],9337:[[40,54,41],256],9338:[[40,55,41],256],9339:[[40,56,41],256],9340:[[40,57,41],256],9341:[[40,49,48,41],256],9342:[[40,49,49,41],256],9343:[[40,49,50,41],256],9344:[[40,49,51,41],256],9345:[[40,49,52,41],256],9346:[[40,49,53,41],256],9347:[[40,49,54,41],256],9348:[[40,49,55,41],256],9349:[[40,49,56,41],256],9350:[[40,49,57,41],256],9351:[[40,50,48,41],256],9352:[[49,46],256],9353:[[50,46],256],9354:[[51,46],256],9355:[[52,46],256],9356:[[53,46],256],9357:[[54,46],256],9358:[[55,46],256],9359:[[56,46],256],9360:[[57,46],256],9361:[[49,48,46],256],9362:[[49,49,46],256],9363:[[49,50,46],256],9364:[[49,51,46],256],9365:[[49,52,46],256],9366:[[49,53,46],256],9367:[[49,54,46],256],9368:[[49,55,46],256],9369:[[49,56,46],256],9370:[[49,57,46],256],9371:[[50,48,46],256],9372:[[40,97,41],256],9373:[[40,98,41],256],9374:[[40,99,41],256],9375:[[40,100,41],256],9376:[[40,101,41],256],9377:[[40,102,41],256],9378:[[40,103,41],256],9379:[[40,104,41],256],9380:[[40,105,41],256],9381:[[40,106,41],256],9382:[[40,107,41],256],9383:[[40,108,41],256],9384:[[40,109,41],256],9385:[[40,110,41],256],9386:[[40,111,41],256],9387:[[40,112,41],256],9388:[[40,113,41],256],9389:[[40,114,41],256],9390:[[40,115,41],256],9391:[[40,116,41],256],9392:[[40,117,41],256],9393:[[40,118,41],256],9394:[[40,119,41],256],9395:[[40,120,41],256],9396:[[40,121,41],256],9397:[[40,122,41],256],9398:[[65],256],9399:[[66],256],9400:[[67],256],9401:[[68],256],9402:[[69],256],9403:[[70],256],9404:[[71],256],9405:[[72],256],9406:[[73],256],9407:[[74],256],9408:[[75],256],9409:[[76],256],9410:[[77],256],9411:[[78],256],9412:[[79],256],9413:[[80],256],9414:[[81],256],9415:[[82],256],9416:[[83],256],9417:[[84],256],9418:[[85],256],9419:[[86],256],9420:[[87],256],9421:[[88],256],9422:[[89],256],9423:[[90],256],9424:[[97],256],9425:[[98],256],9426:[[99],256],9427:[[100],256],9428:[[101],256],9429:[[102],256],9430:[[103],256],9431:[[104],256],9432:[[105],256],9433:[[106],256],9434:[[107],256],9435:[[108],256],9436:[[109],256],9437:[[110],256],9438:[[111],256],9439:[[112],256],9440:[[113],256],9441:[[114],256],9442:[[115],256],9443:[[116],256],9444:[[117],256],9445:[[118],256],9446:[[119],256],9447:[[120],256],9448:[[121],256],9449:[[122],256],9450:[[48],256]},10752:{10764:[[8747,8747,8747,8747],256],10868:[[58,58,61],256],10869:[[61,61],256],10870:[[61,61,61],256],10972:[[10973,824],512]},11264:{11388:[[106],256],11389:[[86],256],11503:[,230],11504:[,230],11505:[,230]},11520:{11631:[[11617],256],11647:[,9],11744:[,230],11745:[,230],11746:[,230],11747:[,230],11748:[,230],11749:[,230],11750:[,230],11751:[,230],11752:[,230],11753:[,230],11754:[,230],11755:[,230],11756:[,230],11757:[,230],11758:[,230],11759:[,230],11760:[,230],11761:[,230],11762:[,230],11763:[,230],11764:[,230],11765:[,230],11766:[,230],11767:[,230],11768:[,230],11769:[,230],11770:[,230],11771:[,230],11772:[,230],11773:[,230],11774:[,230],11775:[,230]},11776:{11935:[[27597],256],12019:[[40863],256]},12032:{12032:[[19968],256],12033:[[20008],256],12034:[[20022],256],12035:[[20031],256],12036:[[20057],256],12037:[[20101],256],12038:[[20108],256],12039:[[20128],256],12040:[[20154],256],12041:[[20799],256],12042:[[20837],256],12043:[[20843],256],12044:[[20866],256],12045:[[20886],256],12046:[[20907],256],12047:[[20960],256],12048:[[20981],256],12049:[[20992],256],12050:[[21147],256],12051:[[21241],256],12052:[[21269],256],12053:[[21274],256],12054:[[21304],256],12055:[[21313],256],12056:[[21340],256],12057:[[21353],256],12058:[[21378],256],12059:[[21430],256],12060:[[21448],256],12061:[[21475],256],12062:[[22231],256],12063:[[22303],256],12064:[[22763],256],12065:[[22786],256],12066:[[22794],256],12067:[[22805],256],12068:[[22823],256],12069:[[22899],256],12070:[[23376],256],12071:[[23424],256],12072:[[23544],256],12073:[[23567],256],12074:[[23586],256],12075:[[23608],256],12076:[[23662],256],12077:[[23665],256],12078:[[24027],256],12079:[[24037],256],12080:[[24049],256],12081:[[24062],256],12082:[[24178],256],12083:[[24186],256],12084:[[24191],256],12085:[[24308],256],12086:[[24318],256],12087:[[24331],256],12088:[[24339],256],12089:[[24400],256],12090:[[24417],256],12091:[[24435],256],12092:[[24515],256],12093:[[25096],256],12094:[[25142],256],12095:[[25163],256],12096:[[25903],256],12097:[[25908],256],12098:[[25991],256],12099:[[26007],256],12100:[[26020],256],12101:[[26041],256],12102:[[26080],256],12103:[[26085],256],12104:[[26352],256],12105:[[26376],256],12106:[[26408],256],12107:[[27424],256],12108:[[27490],256],12109:[[27513],256],12110:[[27571],256],12111:[[27595],256],12112:[[27604],256],12113:[[27611],256],12114:[[27663],256],12115:[[27668],256],12116:[[27700],256],12117:[[28779],256],12118:[[29226],256],12119:[[29238],256],12120:[[29243],256],12121:[[29247],256],12122:[[29255],256],12123:[[29273],256],12124:[[29275],256],12125:[[29356],256],12126:[[29572],256],12127:[[29577],256],12128:[[29916],256],12129:[[29926],256],12130:[[29976],256],12131:[[29983],256],12132:[[29992],256],12133:[[3e4],256],12134:[[30091],256],12135:[[30098],256],12136:[[30326],256],12137:[[30333],256],12138:[[30382],256],12139:[[30399],256],12140:[[30446],256],12141:[[30683],256],12142:[[30690],256],12143:[[30707],256],12144:[[31034],256],12145:[[31160],256],12146:[[31166],256],12147:[[31348],256],12148:[[31435],256],12149:[[31481],256],12150:[[31859],256],12151:[[31992],256],12152:[[32566],256],12153:[[32593],256],12154:[[32650],256],12155:[[32701],256],12156:[[32769],256],12157:[[32780],256],12158:[[32786],256],12159:[[32819],256],12160:[[32895],256],12161:[[32905],256],12162:[[33251],256],12163:[[33258],256],12164:[[33267],256],12165:[[33276],256],12166:[[33292],256],12167:[[33307],256],12168:[[33311],256],12169:[[33390],256],12170:[[33394],256],12171:[[33400],256],12172:[[34381],256],12173:[[34411],256],12174:[[34880],256],12175:[[34892],256],12176:[[34915],256],12177:[[35198],256],12178:[[35211],256],12179:[[35282],256],12180:[[35328],256],12181:[[35895],256],12182:[[35910],256],12183:[[35925],256],12184:[[35960],256],12185:[[35997],256],12186:[[36196],256],12187:[[36208],256],12188:[[36275],256],12189:[[36523],256],12190:[[36554],256],12191:[[36763],256],12192:[[36784],256],12193:[[36789],256],12194:[[37009],256],12195:[[37193],256],12196:[[37318],256],12197:[[37324],256],12198:[[37329],256],12199:[[38263],256],12200:[[38272],256],12201:[[38428],256],12202:[[38582],256],12203:[[38585],256],12204:[[38632],256],12205:[[38737],256],12206:[[38750],256],12207:[[38754],256],12208:[[38761],256],12209:[[38859],256],12210:[[38893],256],12211:[[38899],256],12212:[[38913],256],12213:[[39080],256],12214:[[39131],256],12215:[[39135],256],12216:[[39318],256],12217:[[39321],256],12218:[[39340],256],12219:[[39592],256],12220:[[39640],256],12221:[[39647],256],12222:[[39717],256],12223:[[39727],256],12224:[[39730],256],12225:[[39740],256],12226:[[39770],256],12227:[[40165],256],12228:[[40565],256],12229:[[40575],256],12230:[[40613],256],12231:[[40635],256],12232:[[40643],256],12233:[[40653],256],12234:[[40657],256],12235:[[40697],256],12236:[[40701],256],12237:[[40718],256],12238:[[40723],256],12239:[[40736],256],12240:[[40763],256],12241:[[40778],256],12242:[[40786],256],12243:[[40845],256],12244:[[40860],256],12245:[[40864],256]},12288:{12288:[[32],256],12330:[,218],12331:[,228],12332:[,232],12333:[,222],12334:[,224],12335:[,224],12342:[[12306],256],12344:[[21313],256],12345:[[21316],256],12346:[[21317],256],12358:[,,{12441:12436}],12363:[,,{12441:12364}],12364:[[12363,12441]],12365:[,,{12441:12366}],12366:[[12365,12441]],12367:[,,{12441:12368}],12368:[[12367,12441]],12369:[,,{12441:12370}],12370:[[12369,12441]],12371:[,,{12441:12372}],12372:[[12371,12441]],12373:[,,{12441:12374}],12374:[[12373,12441]],12375:[,,{12441:12376}],12376:[[12375,12441]],12377:[,,{12441:12378}],12378:[[12377,12441]],12379:[,,{12441:12380}],12380:[[12379,12441]],12381:[,,{12441:12382}],12382:[[12381,12441]],12383:[,,{12441:12384}],12384:[[12383,12441]],12385:[,,{12441:12386}],12386:[[12385,12441]],12388:[,,{12441:12389}],12389:[[12388,12441]],12390:[,,{12441:12391}],12391:[[12390,12441]],12392:[,,{12441:12393}],12393:[[12392,12441]],12399:[,,{12441:12400,12442:12401}],12400:[[12399,12441]],12401:[[12399,12442]],12402:[,,{12441:12403,12442:12404}],12403:[[12402,12441]],12404:[[12402,12442]],12405:[,,{12441:12406,12442:12407}],12406:[[12405,12441]],12407:[[12405,12442]],12408:[,,{12441:12409,12442:12410}],12409:[[12408,12441]],12410:[[12408,12442]],12411:[,,{12441:12412,12442:12413}],12412:[[12411,12441]],12413:[[12411,12442]],12436:[[12358,12441]],12441:[,8],12442:[,8],12443:[[32,12441],256],12444:[[32,12442],256],12445:[,,{12441:12446}],12446:[[12445,12441]],12447:[[12424,12426],256],12454:[,,{12441:12532}],12459:[,,{12441:12460}],12460:[[12459,12441]],12461:[,,{12441:12462}],12462:[[12461,12441]],12463:[,,{12441:12464}],12464:[[12463,12441]],12465:[,,{12441:12466}],12466:[[12465,12441]],12467:[,,{12441:12468}],12468:[[12467,12441]],12469:[,,{12441:12470}],12470:[[12469,12441]],12471:[,,{12441:12472}],12472:[[12471,12441]],12473:[,,{12441:12474}],12474:[[12473,12441]],12475:[,,{12441:12476}],12476:[[12475,12441]],12477:[,,{12441:12478}],12478:[[12477,12441]],12479:[,,{12441:12480}],12480:[[12479,12441]],12481:[,,{12441:12482}],12482:[[12481,12441]],12484:[,,{12441:12485}],12485:[[12484,12441]],12486:[,,{12441:12487}],12487:[[12486,12441]],12488:[,,{12441:12489}],12489:[[12488,12441]],12495:[,,{12441:12496,12442:12497}],12496:[[12495,12441]],12497:[[12495,12442]],12498:[,,{12441:12499,12442:12500}],12499:[[12498,12441]],12500:[[12498,12442]],12501:[,,{12441:12502,12442:12503}],12502:[[12501,12441]],12503:[[12501,12442]],12504:[,,{12441:12505,12442:12506}],12505:[[12504,12441]],12506:[[12504,12442]],12507:[,,{12441:12508,12442:12509}],12508:[[12507,12441]],12509:[[12507,12442]],12527:[,,{12441:12535}],12528:[,,{12441:12536}],12529:[,,{12441:12537}],12530:[,,{12441:12538}],12532:[[12454,12441]],12535:[[12527,12441]],12536:[[12528,12441]],12537:[[12529,12441]],12538:[[12530,12441]],12541:[,,{12441:12542}],12542:[[12541,12441]],12543:[[12467,12488],256]},12544:{12593:[[4352],256],12594:[[4353],256],12595:[[4522],256],12596:[[4354],256],12597:[[4524],256],12598:[[4525],256],12599:[[4355],256],12600:[[4356],256],12601:[[4357],256],12602:[[4528],256],12603:[[4529],256],12604:[[4530],256],12605:[[4531],256],12606:[[4532],256],12607:[[4533],256],12608:[[4378],256],12609:[[4358],256],12610:[[4359],256],12611:[[4360],256],12612:[[4385],256],12613:[[4361],256],12614:[[4362],256],12615:[[4363],256],12616:[[4364],256],12617:[[4365],256],12618:[[4366],256],12619:[[4367],256],12620:[[4368],256],12621:[[4369],256],12622:[[4370],256],12623:[[4449],256],12624:[[4450],256],12625:[[4451],256],12626:[[4452],256],12627:[[4453],256],12628:[[4454],256],12629:[[4455],256],12630:[[4456],256],12631:[[4457],256],12632:[[4458],256],12633:[[4459],256],12634:[[4460],256],12635:[[4461],256],12636:[[4462],256],12637:[[4463],256],12638:[[4464],256],12639:[[4465],256],12640:[[4466],256],12641:[[4467],256],12642:[[4468],256],12643:[[4469],256],12644:[[4448],256],12645:[[4372],256],12646:[[4373],256],12647:[[4551],256],12648:[[4552],256],12649:[[4556],256],12650:[[4558],256],12651:[[4563],256],12652:[[4567],256],12653:[[4569],256],12654:[[4380],256],12655:[[4573],256],12656:[[4575],256],12657:[[4381],256],12658:[[4382],256],12659:[[4384],256],12660:[[4386],256],12661:[[4387],256],12662:[[4391],256],12663:[[4393],256],12664:[[4395],256],12665:[[4396],256],12666:[[4397],256],12667:[[4398],256],12668:[[4399],256],12669:[[4402],256],12670:[[4406],256],12671:[[4416],256],12672:[[4423],256],12673:[[4428],256],12674:[[4593],256],12675:[[4594],256],12676:[[4439],256],12677:[[4440],256],12678:[[4441],256],12679:[[4484],256],12680:[[4485],256],12681:[[4488],256],12682:[[4497],256],12683:[[4498],256],12684:[[4500],256],12685:[[4510],256],12686:[[4513],256],12690:[[19968],256],12691:[[20108],256],12692:[[19977],256],12693:[[22235],256],12694:[[19978],256],12695:[[20013],256],12696:[[19979],256],12697:[[30002],256],12698:[[20057],256],12699:[[19993],256],12700:[[19969],256],12701:[[22825],256],12702:[[22320],256],12703:[[20154],256]},12800:{12800:[[40,4352,41],256],12801:[[40,4354,41],256],12802:[[40,4355,41],256],12803:[[40,4357,41],256],12804:[[40,4358,41],256],12805:[[40,4359,41],256],12806:[[40,4361,41],256],12807:[[40,4363,41],256],12808:[[40,4364,41],256],12809:[[40,4366,41],256],12810:[[40,4367,41],256],12811:[[40,4368,41],256],12812:[[40,4369,41],256],12813:[[40,4370,41],256],12814:[[40,4352,4449,41],256],12815:[[40,4354,4449,41],256],12816:[[40,4355,4449,41],256],12817:[[40,4357,4449,41],256],12818:[[40,4358,4449,41],256],12819:[[40,4359,4449,41],256],12820:[[40,4361,4449,41],256],12821:[[40,4363,4449,41],256],12822:[[40,4364,4449,41],256],12823:[[40,4366,4449,41],256],12824:[[40,4367,4449,41],256],12825:[[40,4368,4449,41],256],12826:[[40,4369,4449,41],256],12827:[[40,4370,4449,41],256],12828:[[40,4364,4462,41],256],12829:[[40,4363,4457,4364,4453,4523,41],256],12830:[[40,4363,4457,4370,4462,41],256],12832:[[40,19968,41],256],12833:[[40,20108,41],256],12834:[[40,19977,41],256],12835:[[40,22235,41],256],12836:[[40,20116,41],256],12837:[[40,20845,41],256],12838:[[40,19971,41],256],12839:[[40,20843,41],256],12840:[[40,20061,41],256],12841:[[40,21313,41],256],12842:[[40,26376,41],256],12843:[[40,28779,41],256],12844:[[40,27700,41],256],12845:[[40,26408,41],256],12846:[[40,37329,41],256],12847:[[40,22303,41],256],12848:[[40,26085,41],256],12849:[[40,26666,41],256],12850:[[40,26377,41],256],12851:[[40,31038,41],256],12852:[[40,21517,41],256],12853:[[40,29305,41],256],12854:[[40,36001,41],256],12855:[[40,31069,41],256],12856:[[40,21172,41],256],12857:[[40,20195,41],256],12858:[[40,21628,41],256],12859:[[40,23398,41],256],12860:[[40,30435,41],256],12861:[[40,20225,41],256],12862:[[40,36039,41],256],12863:[[40,21332,41],256],12864:[[40,31085,41],256],12865:[[40,20241,41],256],12866:[[40,33258,41],256],12867:[[40,33267,41],256],12868:[[21839],256],12869:[[24188],256],12870:[[25991],256],12871:[[31631],256],12880:[[80,84,69],256],12881:[[50,49],256],12882:[[50,50],256],12883:[[50,51],256],12884:[[50,52],256],12885:[[50,53],256],12886:[[50,54],256],12887:[[50,55],256],12888:[[50,56],256],12889:[[50,57],256],12890:[[51,48],256],12891:[[51,49],256],12892:[[51,50],256],12893:[[51,51],256],12894:[[51,52],256],12895:[[51,53],256],12896:[[4352],256],12897:[[4354],256],12898:[[4355],256],12899:[[4357],256],12900:[[4358],256],12901:[[4359],256],12902:[[4361],256],12903:[[4363],256],12904:[[4364],256],12905:[[4366],256],12906:[[4367],256],12907:[[4368],256],12908:[[4369],256],12909:[[4370],256],12910:[[4352,4449],256],12911:[[4354,4449],256],12912:[[4355,4449],256],12913:[[4357,4449],256],12914:[[4358,4449],256],12915:[[4359,4449],256],12916:[[4361,4449],256],12917:[[4363,4449],256],12918:[[4364,4449],256],12919:[[4366,4449],256],12920:[[4367,4449],256],12921:[[4368,4449],256],12922:[[4369,4449],256],12923:[[4370,4449],256],12924:[[4366,4449,4535,4352,4457],256],12925:[[4364,4462,4363,4468],256],12926:[[4363,4462],256],12928:[[19968],256],12929:[[20108],256],12930:[[19977],256],12931:[[22235],256],12932:[[20116],256],12933:[[20845],256],12934:[[19971],256],12935:[[20843],256],12936:[[20061],256],12937:[[21313],256],12938:[[26376],256],12939:[[28779],256],12940:[[27700],256],12941:[[26408],256],12942:[[37329],256],12943:[[22303],256],12944:[[26085],256],12945:[[26666],256],12946:[[26377],256],12947:[[31038],256],12948:[[21517],256],12949:[[29305],256],12950:[[36001],256],12951:[[31069],256],12952:[[21172],256],12953:[[31192],256],12954:[[30007],256],12955:[[22899],256],12956:[[36969],256],12957:[[20778],256],12958:[[21360],256],12959:[[27880],256],12960:[[38917],256],12961:[[20241],256],12962:[[20889],256],12963:[[27491],256],12964:[[19978],256],12965:[[20013],256],12966:[[19979],256],12967:[[24038],256],12968:[[21491],256],12969:[[21307],256],12970:[[23447],256],12971:[[23398],256],12972:[[30435],256],12973:[[20225],256],12974:[[36039],256],12975:[[21332],256],12976:[[22812],256],12977:[[51,54],256],12978:[[51,55],256],12979:[[51,56],256],12980:[[51,57],256],12981:[[52,48],256],12982:[[52,49],256],12983:[[52,50],256],12984:[[52,51],256],12985:[[52,52],256],12986:[[52,53],256],12987:[[52,54],256],12988:[[52,55],256],12989:[[52,56],256],12990:[[52,57],256],12991:[[53,48],256],12992:[[49,26376],256],12993:[[50,26376],256],12994:[[51,26376],256],12995:[[52,26376],256],12996:[[53,26376],256],12997:[[54,26376],256],12998:[[55,26376],256],12999:[[56,26376],256],13e3:[[57,26376],256],13001:[[49,48,26376],256],13002:[[49,49,26376],256],13003:[[49,50,26376],256],13004:[[72,103],256],13005:[[101,114,103],256],13006:[[101,86],256],13007:[[76,84,68],256],13008:[[12450],256],13009:[[12452],256],13010:[[12454],256],13011:[[12456],256],13012:[[12458],256],13013:[[12459],256],13014:[[12461],256],13015:[[12463],256],13016:[[12465],256],13017:[[12467],256],13018:[[12469],256],13019:[[12471],256],13020:[[12473],256],13021:[[12475],256],13022:[[12477],256],13023:[[12479],256],13024:[[12481],256],13025:[[12484],256],13026:[[12486],256],13027:[[12488],256],13028:[[12490],256],13029:[[12491],256],13030:[[12492],256],13031:[[12493],256],13032:[[12494],256],13033:[[12495],256],13034:[[12498],256],13035:[[12501],256],13036:[[12504],256],13037:[[12507],256],13038:[[12510],256],13039:[[12511],256],13040:[[12512],256],13041:[[12513],256],13042:[[12514],256],13043:[[12516],256],13044:[[12518],256],13045:[[12520],256],13046:[[12521],256],13047:[[12522],256],13048:[[12523],256],13049:[[12524],256],13050:[[12525],256],13051:[[12527],256],13052:[[12528],256],13053:[[12529],256],13054:[[12530],256]},13056:{13056:[[12450,12497,12540,12488],256],13057:[[12450,12523,12501,12449],256],13058:[[12450,12531,12506,12450],256],13059:[[12450,12540,12523],256],13060:[[12452,12491,12531,12464],256],13061:[[12452,12531,12481],256],13062:[[12454,12457,12531],256],13063:[[12456,12473,12463,12540,12489],256],13064:[[12456,12540,12459,12540],256],13065:[[12458,12531,12473],256],13066:[[12458,12540,12512],256],13067:[[12459,12452,12522],256],13068:[[12459,12521,12483,12488],256],13069:[[12459,12525,12522,12540],256],13070:[[12460,12525,12531],256],13071:[[12460,12531,12510],256],13072:[[12462,12460],256],13073:[[12462,12491,12540],256],13074:[[12461,12517,12522,12540],256],13075:[[12462,12523,12480,12540],256],13076:[[12461,12525],256],13077:[[12461,12525,12464,12521,12512],256],13078:[[12461,12525,12513,12540,12488,12523],256],13079:[[12461,12525,12527,12483,12488],256],13080:[[12464,12521,12512],256],13081:[[12464,12521,12512,12488,12531],256],13082:[[12463,12523,12476,12452,12525],256],13083:[[12463,12525,12540,12493],256],13084:[[12465,12540,12473],256],13085:[[12467,12523,12490],256],13086:[[12467,12540,12509],256],13087:[[12469,12452,12463,12523],256],13088:[[12469,12531,12481,12540,12512],256],13089:[[12471,12522,12531,12464],256],13090:[[12475,12531,12481],256],13091:[[12475,12531,12488],256],13092:[[12480,12540,12473],256],13093:[[12487,12471],256],13094:[[12489,12523],256],13095:[[12488,12531],256],13096:[[12490,12494],256],13097:[[12494,12483,12488],256],13098:[[12495,12452,12484],256],13099:[[12497,12540,12475,12531,12488],256],13100:[[12497,12540,12484],256],13101:[[12496,12540,12524,12523],256],13102:[[12500,12450,12473,12488,12523],256],13103:[[12500,12463,12523],256],13104:[[12500,12467],256],13105:[[12499,12523],256],13106:[[12501,12449,12521,12483,12489],256],13107:[[12501,12451,12540,12488],256],13108:[[12502,12483,12471,12455,12523],256],13109:[[12501,12521,12531],256],13110:[[12504,12463,12479,12540,12523],256],13111:[[12506,12477],256],13112:[[12506,12491,12498],256],13113:[[12504,12523,12484],256],13114:[[12506,12531,12473],256],13115:[[12506,12540,12472],256],13116:[[12505,12540,12479],256],13117:[[12509,12452,12531,12488],256],13118:[[12508,12523,12488],256],13119:[[12507,12531],256],13120:[[12509,12531,12489],256],13121:[[12507,12540,12523],256],13122:[[12507,12540,12531],256],13123:[[12510,12452,12463,12525],256],13124:[[12510,12452,12523],256],13125:[[12510,12483,12495],256],13126:[[12510,12523,12463],256],13127:[[12510,12531,12471,12519,12531],256],13128:[[12511,12463,12525,12531],256],13129:[[12511,12522],256],13130:[[12511,12522,12496,12540,12523],256],13131:[[12513,12460],256],13132:[[12513,12460,12488,12531],256],13133:[[12513,12540,12488,12523],256],13134:[[12516,12540,12489],256],13135:[[12516,12540,12523],256],13136:[[12518,12450,12531],256],13137:[[12522,12483,12488,12523],256],13138:[[12522,12521],256],13139:[[12523,12500,12540],256],13140:[[12523,12540,12502,12523],256],13141:[[12524,12512],256],13142:[[12524,12531,12488,12466,12531],256],13143:[[12527,12483,12488],256],13144:[[48,28857],256],13145:[[49,28857],256],13146:[[50,28857],256],13147:[[51,28857],256],13148:[[52,28857],256],13149:[[53,28857],256],13150:[[54,28857],256],13151:[[55,28857],256],13152:[[56,28857],256],13153:[[57,28857],256],13154:[[49,48,28857],256],13155:[[49,49,28857],256],13156:[[49,50,28857],256],13157:[[49,51,28857],256],13158:[[49,52,28857],256],13159:[[49,53,28857],256],13160:[[49,54,28857],256],13161:[[49,55,28857],256],13162:[[49,56,28857],256],13163:[[49,57,28857],256],13164:[[50,48,28857],256],13165:[[50,49,28857],256],13166:[[50,50,28857],256],13167:[[50,51,28857],256],13168:[[50,52,28857],256],13169:[[104,80,97],256],13170:[[100,97],256],13171:[[65,85],256],13172:[[98,97,114],256],13173:[[111,86],256],13174:[[112,99],256],13175:[[100,109],256],13176:[[100,109,178],256],13177:[[100,109,179],256],13178:[[73,85],256],13179:[[24179,25104],256],13180:[[26157,21644],256],13181:[[22823,27491],256],13182:[[26126,27835],256],13183:[[26666,24335,20250,31038],256],13184:[[112,65],256],13185:[[110,65],256],13186:[[956,65],256],13187:[[109,65],256],13188:[[107,65],256],13189:[[75,66],256],13190:[[77,66],256],13191:[[71,66],256],13192:[[99,97,108],256],13193:[[107,99,97,108],256],13194:[[112,70],256],13195:[[110,70],256],13196:[[956,70],256],13197:[[956,103],256],13198:[[109,103],256],13199:[[107,103],256],13200:[[72,122],256],13201:[[107,72,122],256],13202:[[77,72,122],256],13203:[[71,72,122],256],13204:[[84,72,122],256],13205:[[956,8467],256],13206:[[109,8467],256],13207:[[100,8467],256],13208:[[107,8467],256],13209:[[102,109],256],13210:[[110,109],256],13211:[[956,109],256],13212:[[109,109],256],13213:[[99,109],256],13214:[[107,109],256],13215:[[109,109,178],256],13216:[[99,109,178],256],13217:[[109,178],256],13218:[[107,109,178],256],13219:[[109,109,179],256],13220:[[99,109,179],256],13221:[[109,179],256],13222:[[107,109,179],256],13223:[[109,8725,115],256],13224:[[109,8725,115,178],256],13225:[[80,97],256],13226:[[107,80,97],256],13227:[[77,80,97],256],13228:[[71,80,97],256],13229:[[114,97,100],256],13230:[[114,97,100,8725,115],256],13231:[[114,97,100,8725,115,178],256],13232:[[112,115],256],13233:[[110,115],256],13234:[[956,115],256],13235:[[109,115],256],13236:[[112,86],256],13237:[[110,86],256],13238:[[956,86],256],13239:[[109,86],256],13240:[[107,86],256],13241:[[77,86],256],13242:[[112,87],256],13243:[[110,87],256],13244:[[956,87],256],13245:[[109,87],256],13246:[[107,87],256],13247:[[77,87],256],13248:[[107,937],256],13249:[[77,937],256],13250:[[97,46,109,46],256],13251:[[66,113],256],13252:[[99,99],256],13253:[[99,100],256],13254:[[67,8725,107,103],256],13255:[[67,111,46],256],13256:[[100,66],256],13257:[[71,121],256],13258:[[104,97],256],13259:[[72,80],256],13260:[[105,110],256],13261:[[75,75],256],13262:[[75,77],256],13263:[[107,116],256],13264:[[108,109],256],13265:[[108,110],256],13266:[[108,111,103],256],13267:[[108,120],256],13268:[[109,98],256],13269:[[109,105,108],256],13270:[[109,111,108],256],13271:[[80,72],256],13272:[[112,46,109,46],256],13273:[[80,80,77],256],13274:[[80,82],256],13275:[[115,114],256],13276:[[83,118],256],13277:[[87,98],256],13278:[[86,8725,109],256],13279:[[65,8725,109],256],13280:[[49,26085],256],13281:[[50,26085],256],13282:[[51,26085],256],13283:[[52,26085],256],13284:[[53,26085],256],13285:[[54,26085],256],13286:[[55,26085],256],13287:[[56,26085],256],13288:[[57,26085],256],13289:[[49,48,26085],256],13290:[[49,49,26085],256],13291:[[49,50,26085],256],13292:[[49,51,26085],256],13293:[[49,52,26085],256],13294:[[49,53,26085],256],13295:[[49,54,26085],256],13296:[[49,55,26085],256],13297:[[49,56,26085],256],13298:[[49,57,26085],256],13299:[[50,48,26085],256],13300:[[50,49,26085],256],13301:[[50,50,26085],256],13302:[[50,51,26085],256],13303:[[50,52,26085],256],13304:[[50,53,26085],256],13305:[[50,54,26085],256],13306:[[50,55,26085],256],13307:[[50,56,26085],256],13308:[[50,57,26085],256],13309:[[51,48,26085],256],13310:[[51,49,26085],256],13311:[[103,97,108],256]},27136:{92912:[,1],92913:[,1],92914:[,1],92915:[,1],92916:[,1]},27392:{92976:[,230],92977:[,230],92978:[,230],92979:[,230],92980:[,230],92981:[,230],92982:[,230]},42496:{42607:[,230],42612:[,230],42613:[,230],42614:[,230],42615:[,230],42616:[,230],42617:[,230],42618:[,230],42619:[,230],42620:[,230],42621:[,230],42652:[[1098],256],42653:[[1100],256],42655:[,230],42736:[,230],42737:[,230]},42752:{42864:[[42863],256],43e3:[[294],256],43001:[[339],256]},43008:{43014:[,9],43204:[,9],43232:[,230],43233:[,230],43234:[,230],43235:[,230],43236:[,230],43237:[,230],43238:[,230],43239:[,230],43240:[,230],43241:[,230],43242:[,230],43243:[,230],43244:[,230],43245:[,230],43246:[,230],43247:[,230],43248:[,230],43249:[,230]},43264:{43307:[,220],43308:[,220],43309:[,220],43347:[,9],43443:[,7],43456:[,9]},43520:{43696:[,230],43698:[,230],43699:[,230],43700:[,220],43703:[,230],43704:[,230],43710:[,230],43711:[,230],43713:[,230],43766:[,9]},43776:{43868:[[42791],256],43869:[[43831],256],43870:[[619],256],43871:[[43858],256],44013:[,9]},48128:{113822:[,1]},53504:{119134:[[119127,119141],512],119135:[[119128,119141],512],119136:[[119135,119150],512],119137:[[119135,119151],512],119138:[[119135,119152],512],119139:[[119135,119153],512],119140:[[119135,119154],512],119141:[,216],119142:[,216],119143:[,1],119144:[,1],119145:[,1],119149:[,226],119150:[,216],119151:[,216],119152:[,216],119153:[,216],119154:[,216],119163:[,220],119164:[,220],119165:[,220],119166:[,220],119167:[,220],119168:[,220],119169:[,220],119170:[,220],119173:[,230],119174:[,230],119175:[,230],119176:[,230],119177:[,230],119178:[,220],119179:[,220],119210:[,230],119211:[,230],119212:[,230],119213:[,230],119227:[[119225,119141],512],119228:[[119226,119141],512],119229:[[119227,119150],512],119230:[[119228,119150],512],119231:[[119227,119151],512],119232:[[119228,119151],512]},53760:{119362:[,230],119363:[,230],119364:[,230]},54272:{119808:[[65],256],119809:[[66],256],119810:[[67],256],119811:[[68],256],119812:[[69],256],119813:[[70],256],119814:[[71],256],119815:[[72],256],119816:[[73],256],119817:[[74],256],119818:[[75],256],119819:[[76],256],119820:[[77],256],119821:[[78],256],119822:[[79],256],119823:[[80],256],119824:[[81],256],119825:[[82],256],119826:[[83],256],119827:[[84],256],119828:[[85],256],119829:[[86],256],119830:[[87],256],119831:[[88],256],119832:[[89],256],119833:[[90],256],119834:[[97],256],119835:[[98],256],119836:[[99],256],119837:[[100],256],119838:[[101],256],119839:[[102],256],119840:[[103],256],119841:[[104],256],119842:[[105],256],119843:[[106],256],119844:[[107],256],119845:[[108],256],119846:[[109],256],119847:[[110],256],119848:[[111],256],119849:[[112],256],119850:[[113],256],119851:[[114],256],119852:[[115],256],119853:[[116],256],119854:[[117],256],119855:[[118],256],119856:[[119],256],119857:[[120],256],119858:[[121],256],119859:[[122],256],119860:[[65],256],119861:[[66],256],119862:[[67],256],119863:[[68],256],119864:[[69],256],119865:[[70],256],119866:[[71],256],119867:[[72],256],119868:[[73],256],119869:[[74],256],119870:[[75],256],119871:[[76],256],119872:[[77],256],119873:[[78],256],119874:[[79],256],119875:[[80],256],119876:[[81],256],119877:[[82],256],119878:[[83],256],119879:[[84],256],119880:[[85],256],119881:[[86],256],119882:[[87],256],119883:[[88],256],119884:[[89],256],119885:[[90],256],119886:[[97],256],119887:[[98],256],119888:[[99],256],119889:[[100],256],119890:[[101],256],119891:[[102],256],119892:[[103],256],119894:[[105],256],119895:[[106],256],119896:[[107],256],119897:[[108],256],119898:[[109],256],119899:[[110],256],119900:[[111],256],119901:[[112],256],119902:[[113],256],119903:[[114],256],119904:[[115],256],119905:[[116],256],119906:[[117],256],119907:[[118],256],119908:[[119],256],119909:[[120],256],119910:[[121],256],119911:[[122],256],119912:[[65],256],119913:[[66],256],119914:[[67],256],119915:[[68],256],119916:[[69],256],119917:[[70],256],119918:[[71],256],119919:[[72],256],119920:[[73],256],119921:[[74],256],119922:[[75],256],119923:[[76],256],119924:[[77],256],119925:[[78],256],119926:[[79],256],119927:[[80],256],119928:[[81],256],119929:[[82],256],119930:[[83],256],119931:[[84],256],119932:[[85],256],119933:[[86],256],119934:[[87],256],119935:[[88],256],119936:[[89],256],119937:[[90],256],119938:[[97],256],119939:[[98],256],119940:[[99],256],119941:[[100],256],119942:[[101],256],119943:[[102],256],119944:[[103],256],119945:[[104],256],119946:[[105],256],119947:[[106],256],119948:[[107],256],119949:[[108],256],119950:[[109],256],119951:[[110],256],119952:[[111],256],119953:[[112],256],119954:[[113],256],119955:[[114],256],119956:[[115],256],119957:[[116],256],119958:[[117],256],119959:[[118],256],119960:[[119],256],119961:[[120],256],119962:[[121],256],119963:[[122],256],119964:[[65],256],119966:[[67],256],119967:[[68],256],119970:[[71],256],119973:[[74],256],119974:[[75],256],119977:[[78],256],119978:[[79],256],119979:[[80],256],119980:[[81],256],119982:[[83],256],119983:[[84],256],119984:[[85],256],119985:[[86],256],119986:[[87],256],119987:[[88],256],119988:[[89],256],119989:[[90],256],119990:[[97],256],119991:[[98],256],119992:[[99],256],119993:[[100],256],119995:[[102],256],119997:[[104],256],119998:[[105],256],119999:[[106],256],12e4:[[107],256],120001:[[108],256],120002:[[109],256],120003:[[110],256],120005:[[112],256],120006:[[113],256],120007:[[114],256],120008:[[115],256],120009:[[116],256],120010:[[117],256],120011:[[118],256],120012:[[119],256],120013:[[120],256],120014:[[121],256],120015:[[122],256],120016:[[65],256],120017:[[66],256],120018:[[67],256],120019:[[68],256],120020:[[69],256],120021:[[70],256],120022:[[71],256],120023:[[72],256],120024:[[73],256],120025:[[74],256],120026:[[75],256],120027:[[76],256],120028:[[77],256],120029:[[78],256],120030:[[79],256],120031:[[80],256],120032:[[81],256],120033:[[82],256],120034:[[83],256],120035:[[84],256],120036:[[85],256],120037:[[86],256],120038:[[87],256],120039:[[88],256],120040:[[89],256],120041:[[90],256],120042:[[97],256],120043:[[98],256],120044:[[99],256],120045:[[100],256],120046:[[101],256],120047:[[102],256],120048:[[103],256],120049:[[104],256],120050:[[105],256],120051:[[106],256],120052:[[107],256],120053:[[108],256],120054:[[109],256],120055:[[110],256],120056:[[111],256],120057:[[112],256],120058:[[113],256],120059:[[114],256],120060:[[115],256],120061:[[116],256],120062:[[117],256],120063:[[118],256]},54528:{120064:[[119],256],120065:[[120],256],120066:[[121],256],120067:[[122],256],120068:[[65],256],120069:[[66],256],120071:[[68],256],120072:[[69],256],120073:[[70],256],120074:[[71],256],120077:[[74],256],120078:[[75],256],120079:[[76],256],120080:[[77],256],120081:[[78],256],120082:[[79],256],120083:[[80],256],120084:[[81],256],120086:[[83],256],120087:[[84],256],120088:[[85],256],120089:[[86],256],120090:[[87],256],120091:[[88],256],120092:[[89],256],120094:[[97],256],120095:[[98],256],120096:[[99],256],120097:[[100],256],120098:[[101],256],120099:[[102],256],120100:[[103],256],120101:[[104],256],120102:[[105],256],120103:[[106],256],120104:[[107],256],120105:[[108],256],120106:[[109],256],120107:[[110],256],120108:[[111],256],120109:[[112],256],120110:[[113],256],120111:[[114],256],120112:[[115],256],120113:[[116],256],120114:[[117],256],120115:[[118],256],120116:[[119],256],120117:[[120],256],120118:[[121],256],120119:[[122],256],120120:[[65],256],120121:[[66],256],120123:[[68],256],120124:[[69],256],120125:[[70],256],120126:[[71],256],120128:[[73],256],120129:[[74],256],120130:[[75],256],120131:[[76],256],120132:[[77],256],120134:[[79],256],120138:[[83],256],120139:[[84],256],120140:[[85],256],120141:[[86],256],120142:[[87],256],120143:[[88],256],120144:[[89],256],120146:[[97],256],120147:[[98],256],120148:[[99],256],120149:[[100],256],120150:[[101],256],120151:[[102],256],120152:[[103],256],120153:[[104],256],120154:[[105],256],120155:[[106],256],120156:[[107],256],120157:[[108],256],120158:[[109],256],120159:[[110],256],120160:[[111],256],120161:[[112],256],120162:[[113],256],120163:[[114],256],120164:[[115],256],120165:[[116],256],120166:[[117],256],120167:[[118],256],120168:[[119],256],120169:[[120],256],120170:[[121],256],120171:[[122],256],120172:[[65],256],120173:[[66],256],120174:[[67],256],120175:[[68],256],120176:[[69],256],120177:[[70],256],120178:[[71],256],120179:[[72],256],120180:[[73],256],120181:[[74],256],120182:[[75],256],120183:[[76],256],120184:[[77],256],120185:[[78],256],120186:[[79],256],120187:[[80],256],120188:[[81],256],120189:[[82],256],120190:[[83],256],120191:[[84],256],120192:[[85],256],120193:[[86],256],120194:[[87],256],120195:[[88],256],120196:[[89],256],120197:[[90],256],120198:[[97],256],120199:[[98],256],120200:[[99],256],120201:[[100],256],120202:[[101],256],120203:[[102],256],120204:[[103],256],120205:[[104],256],120206:[[105],256],120207:[[106],256],120208:[[107],256],120209:[[108],256],120210:[[109],256],120211:[[110],256],120212:[[111],256],120213:[[112],256],120214:[[113],256],120215:[[114],256],120216:[[115],256],120217:[[116],256],120218:[[117],256],120219:[[118],256],120220:[[119],256],120221:[[120],256],120222:[[121],256],120223:[[122],256],120224:[[65],256],120225:[[66],256],120226:[[67],256],120227:[[68],256],120228:[[69],256],120229:[[70],256],120230:[[71],256],120231:[[72],256],120232:[[73],256],120233:[[74],256],120234:[[75],256],120235:[[76],256],120236:[[77],256],120237:[[78],256],120238:[[79],256],120239:[[80],256],120240:[[81],256],120241:[[82],256],120242:[[83],256],120243:[[84],256],120244:[[85],256],120245:[[86],256],120246:[[87],256],120247:[[88],256],120248:[[89],256],120249:[[90],256],120250:[[97],256],120251:[[98],256],120252:[[99],256],120253:[[100],256],120254:[[101],256],120255:[[102],256],120256:[[103],256],120257:[[104],256],120258:[[105],256],120259:[[106],256],120260:[[107],256],120261:[[108],256],120262:[[109],256],120263:[[110],256],120264:[[111],256],120265:[[112],256],120266:[[113],256],120267:[[114],256],120268:[[115],256],120269:[[116],256],120270:[[117],256],120271:[[118],256],120272:[[119],256],120273:[[120],256],120274:[[121],256],120275:[[122],256],120276:[[65],256],120277:[[66],256],120278:[[67],256],120279:[[68],256],120280:[[69],256],120281:[[70],256],120282:[[71],256],120283:[[72],256],120284:[[73],256],120285:[[74],256],120286:[[75],256],120287:[[76],256],120288:[[77],256],120289:[[78],256],120290:[[79],256],120291:[[80],256],120292:[[81],256],120293:[[82],256],120294:[[83],256],120295:[[84],256],120296:[[85],256],120297:[[86],256],120298:[[87],256],120299:[[88],256],120300:[[89],256],120301:[[90],256],120302:[[97],256],120303:[[98],256],120304:[[99],256],120305:[[100],256],120306:[[101],256],120307:[[102],256],120308:[[103],256],120309:[[104],256],120310:[[105],256],120311:[[106],256],120312:[[107],256],120313:[[108],256],120314:[[109],256],120315:[[110],256],120316:[[111],256],120317:[[112],256],120318:[[113],256],120319:[[114],256]},54784:{120320:[[115],256],120321:[[116],256],120322:[[117],256],120323:[[118],256],120324:[[119],256],120325:[[120],256],120326:[[121],256],120327:[[122],256],120328:[[65],256],120329:[[66],256],120330:[[67],256],120331:[[68],256],120332:[[69],256],120333:[[70],256],120334:[[71],256],120335:[[72],256],120336:[[73],256],120337:[[74],256],120338:[[75],256],120339:[[76],256],120340:[[77],256],120341:[[78],256],120342:[[79],256],120343:[[80],256],120344:[[81],256],120345:[[82],256],120346:[[83],256],120347:[[84],256],120348:[[85],256],120349:[[86],256],120350:[[87],256],120351:[[88],256],120352:[[89],256],120353:[[90],256],120354:[[97],256],120355:[[98],256],120356:[[99],256],120357:[[100],256],120358:[[101],256],120359:[[102],256],120360:[[103],256],120361:[[104],256],120362:[[105],256],120363:[[106],256],120364:[[107],256],120365:[[108],256],120366:[[109],256],120367:[[110],256],120368:[[111],256],120369:[[112],256],120370:[[113],256],120371:[[114],256],120372:[[115],256],120373:[[116],256],120374:[[117],256],120375:[[118],256],120376:[[119],256],120377:[[120],256],120378:[[121],256],120379:[[122],256],120380:[[65],256],120381:[[66],256],120382:[[67],256],120383:[[68],256],120384:[[69],256],120385:[[70],256],120386:[[71],256],120387:[[72],256],120388:[[73],256],120389:[[74],256],120390:[[75],256],120391:[[76],256],120392:[[77],256],120393:[[78],256],120394:[[79],256],120395:[[80],256],120396:[[81],256],120397:[[82],256],120398:[[83],256],120399:[[84],256],120400:[[85],256],120401:[[86],256],120402:[[87],256],120403:[[88],256],120404:[[89],256],120405:[[90],256],120406:[[97],256],120407:[[98],256],120408:[[99],256],120409:[[100],256],120410:[[101],256],120411:[[102],256],120412:[[103],256],120413:[[104],256],120414:[[105],256],120415:[[106],256],120416:[[107],256],120417:[[108],256],120418:[[109],256],120419:[[110],256],120420:[[111],256],120421:[[112],256],120422:[[113],256],120423:[[114],256],120424:[[115],256],120425:[[116],256],120426:[[117],256],120427:[[118],256],120428:[[119],256],120429:[[120],256],120430:[[121],256],120431:[[122],256],120432:[[65],256],120433:[[66],256],120434:[[67],256],120435:[[68],256],120436:[[69],256],120437:[[70],256],120438:[[71],256],120439:[[72],256],120440:[[73],256],120441:[[74],256],120442:[[75],256],120443:[[76],256],120444:[[77],256],120445:[[78],256],120446:[[79],256],120447:[[80],256],120448:[[81],256],120449:[[82],256],120450:[[83],256],120451:[[84],256],120452:[[85],256],120453:[[86],256],120454:[[87],256],120455:[[88],256],120456:[[89],256],120457:[[90],256],120458:[[97],256],120459:[[98],256],120460:[[99],256],120461:[[100],256],120462:[[101],256],120463:[[102],256],120464:[[103],256],120465:[[104],256],120466:[[105],256],120467:[[106],256],120468:[[107],256],120469:[[108],256],120470:[[109],256],120471:[[110],256],120472:[[111],256],120473:[[112],256],120474:[[113],256],120475:[[114],256],120476:[[115],256],120477:[[116],256],120478:[[117],256],120479:[[118],256],120480:[[119],256],120481:[[120],256],120482:[[121],256],120483:[[122],256],120484:[[305],256],120485:[[567],256],120488:[[913],256],120489:[[914],256],120490:[[915],256],120491:[[916],256],120492:[[917],256],120493:[[918],256],120494:[[919],256],120495:[[920],256],120496:[[921],256],120497:[[922],256],120498:[[923],256],120499:[[924],256],120500:[[925],256],120501:[[926],256],120502:[[927],256],120503:[[928],256],120504:[[929],256],120505:[[1012],256],120506:[[931],256],120507:[[932],256],120508:[[933],256],120509:[[934],256],120510:[[935],256],120511:[[936],256],120512:[[937],256],120513:[[8711],256],120514:[[945],256],120515:[[946],256],120516:[[947],256],120517:[[948],256],120518:[[949],256],120519:[[950],256],120520:[[951],256],120521:[[952],256],120522:[[953],256],120523:[[954],256],120524:[[955],256],120525:[[956],256],120526:[[957],256],120527:[[958],256],120528:[[959],256],120529:[[960],256],120530:[[961],256],120531:[[962],256],120532:[[963],256],120533:[[964],256],120534:[[965],256],120535:[[966],256],120536:[[967],256],120537:[[968],256],120538:[[969],256],120539:[[8706],256],120540:[[1013],256],120541:[[977],256],120542:[[1008],256],120543:[[981],256],120544:[[1009],256],120545:[[982],256],120546:[[913],256],120547:[[914],256],120548:[[915],256],120549:[[916],256],120550:[[917],256],120551:[[918],256],120552:[[919],256],120553:[[920],256],120554:[[921],256],120555:[[922],256],120556:[[923],256],120557:[[924],256],120558:[[925],256],120559:[[926],256],120560:[[927],256],120561:[[928],256],120562:[[929],256],120563:[[1012],256],120564:[[931],256],120565:[[932],256],120566:[[933],256],120567:[[934],256],120568:[[935],256],120569:[[936],256],120570:[[937],256],120571:[[8711],256],120572:[[945],256],120573:[[946],256],120574:[[947],256],120575:[[948],256]},55040:{120576:[[949],256],120577:[[950],256],120578:[[951],256],120579:[[952],256],120580:[[953],256],120581:[[954],256],120582:[[955],256],120583:[[956],256],120584:[[957],256],120585:[[958],256],120586:[[959],256],120587:[[960],256],120588:[[961],256],120589:[[962],256],120590:[[963],256],120591:[[964],256],120592:[[965],256],120593:[[966],256],120594:[[967],256],120595:[[968],256],120596:[[969],256],120597:[[8706],256],120598:[[1013],256],120599:[[977],256],120600:[[1008],256],120601:[[981],256],120602:[[1009],256],120603:[[982],256],120604:[[913],256],120605:[[914],256],120606:[[915],256],120607:[[916],256],120608:[[917],256],120609:[[918],256],120610:[[919],256],120611:[[920],256],120612:[[921],256],120613:[[922],256],120614:[[923],256],120615:[[924],256],120616:[[925],256],120617:[[926],256],120618:[[927],256],120619:[[928],256],120620:[[929],256],120621:[[1012],256],120622:[[931],256],120623:[[932],256],120624:[[933],256],120625:[[934],256],120626:[[935],256],120627:[[936],256],120628:[[937],256],120629:[[8711],256],120630:[[945],256],120631:[[946],256],120632:[[947],256],120633:[[948],256],120634:[[949],256],120635:[[950],256],120636:[[951],256],120637:[[952],256],120638:[[953],256],120639:[[954],256],120640:[[955],256],120641:[[956],256],120642:[[957],256],120643:[[958],256],120644:[[959],256],120645:[[960],256],120646:[[961],256],120647:[[962],256],120648:[[963],256],120649:[[964],256],120650:[[965],256],120651:[[966],256],120652:[[967],256],120653:[[968],256],120654:[[969],256],120655:[[8706],256],120656:[[1013],256],120657:[[977],256],120658:[[1008],256],120659:[[981],256],120660:[[1009],256],120661:[[982],256],120662:[[913],256],120663:[[914],256],120664:[[915],256],120665:[[916],256],120666:[[917],256],120667:[[918],256],120668:[[919],256],120669:[[920],256],120670:[[921],256],120671:[[922],256],120672:[[923],256],120673:[[924],256],120674:[[925],256],120675:[[926],256],120676:[[927],256],120677:[[928],256],120678:[[929],256],120679:[[1012],256],120680:[[931],256],120681:[[932],256],120682:[[933],256],120683:[[934],256],120684:[[935],256],120685:[[936],256],120686:[[937],256],120687:[[8711],256],120688:[[945],256],120689:[[946],256],120690:[[947],256],120691:[[948],256],120692:[[949],256],120693:[[950],256],120694:[[951],256],120695:[[952],256],120696:[[953],256],120697:[[954],256],120698:[[955],256],120699:[[956],256],120700:[[957],256],120701:[[958],256],120702:[[959],256],120703:[[960],256],120704:[[961],256],120705:[[962],256],120706:[[963],256],120707:[[964],256],120708:[[965],256],120709:[[966],256],120710:[[967],256],120711:[[968],256],120712:[[969],256],120713:[[8706],256],120714:[[1013],256],120715:[[977],256],120716:[[1008],256],120717:[[981],256],120718:[[1009],256],120719:[[982],256],120720:[[913],256],120721:[[914],256],120722:[[915],256],120723:[[916],256],120724:[[917],256],120725:[[918],256],120726:[[919],256],120727:[[920],256],120728:[[921],256],120729:[[922],256],120730:[[923],256],120731:[[924],256],120732:[[925],256],120733:[[926],256],120734:[[927],256],120735:[[928],256],120736:[[929],256],120737:[[1012],256],120738:[[931],256],120739:[[932],256],120740:[[933],256],120741:[[934],256],120742:[[935],256],120743:[[936],256],120744:[[937],256],120745:[[8711],256],120746:[[945],256],120747:[[946],256],120748:[[947],256],120749:[[948],256],120750:[[949],256],120751:[[950],256],120752:[[951],256],120753:[[952],256],120754:[[953],256],120755:[[954],256],120756:[[955],256],120757:[[956],256],120758:[[957],256],120759:[[958],256],120760:[[959],256],120761:[[960],256],120762:[[961],256],120763:[[962],256],120764:[[963],256],120765:[[964],256],120766:[[965],256],120767:[[966],256],120768:[[967],256],120769:[[968],256],120770:[[969],256],120771:[[8706],256],120772:[[1013],256],120773:[[977],256],120774:[[1008],256],120775:[[981],256],120776:[[1009],256],120777:[[982],256],120778:[[988],256],120779:[[989],256],120782:[[48],256],120783:[[49],256],120784:[[50],256],120785:[[51],256],120786:[[52],256],120787:[[53],256],120788:[[54],256],120789:[[55],256],120790:[[56],256],120791:[[57],256],120792:[[48],256],120793:[[49],256],120794:[[50],256],120795:[[51],256],120796:[[52],256],120797:[[53],256],120798:[[54],256],120799:[[55],256],120800:[[56],256],120801:[[57],256],120802:[[48],256],120803:[[49],256],120804:[[50],256],120805:[[51],256],120806:[[52],256],120807:[[53],256],120808:[[54],256],120809:[[55],256],120810:[[56],256],120811:[[57],256],120812:[[48],256],120813:[[49],256],120814:[[50],256],120815:[[51],256],120816:[[52],256],120817:[[53],256],120818:[[54],256],120819:[[55],256],120820:[[56],256],120821:[[57],256],120822:[[48],256],120823:[[49],256],120824:[[50],256],120825:[[51],256],120826:[[52],256],120827:[[53],256],120828:[[54],256],120829:[[55],256],120830:[[56],256],120831:[[57],256]},59392:{125136:[,220],125137:[,220],125138:[,220],125139:[,220],125140:[,220],125141:[,220],125142:[,220]},60928:{126464:[[1575],256],126465:[[1576],256],126466:[[1580],256],126467:[[1583],256],126469:[[1608],256],126470:[[1586],256],126471:[[1581],256],126472:[[1591],256],126473:[[1610],256],126474:[[1603],256],126475:[[1604],256],126476:[[1605],256],126477:[[1606],256],126478:[[1587],256],126479:[[1593],256],126480:[[1601],256],126481:[[1589],256],126482:[[1602],256],126483:[[1585],256],126484:[[1588],256],126485:[[1578],256],126486:[[1579],256],126487:[[1582],256],126488:[[1584],256],126489:[[1590],256],126490:[[1592],256],126491:[[1594],256],126492:[[1646],256],126493:[[1722],256],126494:[[1697],256],126495:[[1647],256],126497:[[1576],256],126498:[[1580],256],126500:[[1607],256],126503:[[1581],256],126505:[[1610],256],126506:[[1603],256],126507:[[1604],256],126508:[[1605],256],126509:[[1606],256],126510:[[1587],256],126511:[[1593],256],126512:[[1601],256],126513:[[1589],256],126514:[[1602],256],126516:[[1588],256],126517:[[1578],256],126518:[[1579],256],126519:[[1582],256],126521:[[1590],256],126523:[[1594],256],126530:[[1580],256],126535:[[1581],256],126537:[[1610],256],126539:[[1604],256],126541:[[1606],256],126542:[[1587],256],126543:[[1593],256],126545:[[1589],256],126546:[[1602],256],126548:[[1588],256],126551:[[1582],256],126553:[[1590],256],126555:[[1594],256],126557:[[1722],256],126559:[[1647],256],126561:[[1576],256],126562:[[1580],256],126564:[[1607],256],126567:[[1581],256],126568:[[1591],256],126569:[[1610],256],126570:[[1603],256],126572:[[1605],256],126573:[[1606],256],126574:[[1587],256],126575:[[1593],256],126576:[[1601],256],126577:[[1589],256],126578:[[1602],256],126580:[[1588],256],126581:[[1578],256],126582:[[1579],256],126583:[[1582],256],126585:[[1590],256],126586:[[1592],256],126587:[[1594],256],126588:[[1646],256],126590:[[1697],256],126592:[[1575],256],126593:[[1576],256],126594:[[1580],256],126595:[[1583],256],126596:[[1607],256],126597:[[1608],256],126598:[[1586],256],126599:[[1581],256],126600:[[1591],256],126601:[[1610],256],126603:[[1604],256],126604:[[1605],256],126605:[[1606],256],126606:[[1587],256],126607:[[1593],256],126608:[[1601],256],126609:[[1589],256],126610:[[1602],256],126611:[[1585],256],126612:[[1588],256],126613:[[1578],256],126614:[[1579],256],126615:[[1582],256],126616:[[1584],256],126617:[[1590],256],126618:[[1592],256],126619:[[1594],256],126625:[[1576],256],126626:[[1580],256],126627:[[1583],256],126629:[[1608],256],126630:[[1586],256],126631:[[1581],256],126632:[[1591],256],126633:[[1610],256],126635:[[1604],256],126636:[[1605],256],126637:[[1606],256],126638:[[1587],256],126639:[[1593],256],126640:[[1601],256],126641:[[1589],256],126642:[[1602],256],126643:[[1585],256],126644:[[1588],256],126645:[[1578],256],126646:[[1579],256],126647:[[1582],256],126648:[[1584],256],126649:[[1590],256],126650:[[1592],256],126651:[[1594],256]},61696:{127232:[[48,46],256],127233:[[48,44],256],127234:[[49,44],256],127235:[[50,44],256],127236:[[51,44],256],127237:[[52,44],256],127238:[[53,44],256],127239:[[54,44],256],127240:[[55,44],256],127241:[[56,44],256],127242:[[57,44],256],127248:[[40,65,41],256],127249:[[40,66,41],256],127250:[[40,67,41],256],127251:[[40,68,41],256],127252:[[40,69,41],256],127253:[[40,70,41],256],127254:[[40,71,41],256],127255:[[40,72,41],256],127256:[[40,73,41],256],127257:[[40,74,41],256],127258:[[40,75,41],256],127259:[[40,76,41],256],127260:[[40,77,41],256],127261:[[40,78,41],256],127262:[[40,79,41],256],127263:[[40,80,41],256],127264:[[40,81,41],256],127265:[[40,82,41],256],127266:[[40,83,41],256],127267:[[40,84,41],256],127268:[[40,85,41],256],127269:[[40,86,41],256],127270:[[40,87,41],256],127271:[[40,88,41],256],127272:[[40,89,41],256],127273:[[40,90,41],256],127274:[[12308,83,12309],256],127275:[[67],256],127276:[[82],256],127277:[[67,68],256],127278:[[87,90],256],127280:[[65],256],127281:[[66],256],127282:[[67],256],127283:[[68],256],127284:[[69],256],127285:[[70],256],127286:[[71],256],127287:[[72],256],127288:[[73],256],127289:[[74],256],127290:[[75],256],127291:[[76],256],127292:[[77],256],127293:[[78],256],127294:[[79],256],127295:[[80],256],127296:[[81],256],127297:[[82],256],127298:[[83],256],127299:[[84],256],127300:[[85],256],127301:[[86],256],127302:[[87],256],127303:[[88],256],127304:[[89],256],127305:[[90],256],127306:[[72,86],256],127307:[[77,86],256],127308:[[83,68],256],127309:[[83,83],256],127310:[[80,80,86],256],127311:[[87,67],256],127338:[[77,67],256],127339:[[77,68],256],127376:[[68,74],256]},61952:{127488:[[12411,12363],256],127489:[[12467,12467],256],127490:[[12469],256],127504:[[25163],256],127505:[[23383],256],127506:[[21452],256],127507:[[12487],256],127508:[[20108],256],127509:[[22810],256],127510:[[35299],256],127511:[[22825],256],127512:[[20132],256],127513:[[26144],256],127514:[[28961],256],127515:[[26009],256],127516:[[21069],256],127517:[[24460],256],127518:[[20877],256],127519:[[26032],256],127520:[[21021],256],127521:[[32066],256],127522:[[29983],256],127523:[[36009],256],127524:[[22768],256],127525:[[21561],256],127526:[[28436],256],127527:[[25237],256],127528:[[25429],256],127529:[[19968],256],127530:[[19977],256],127531:[[36938],256],127532:[[24038],256],127533:[[20013],256],127534:[[21491],256],127535:[[25351],256],127536:[[36208],256],127537:[[25171],256],127538:[[31105],256],127539:[[31354],256],127540:[[21512],256],127541:[[28288],256],127542:[[26377],256],127543:[[26376],256],127544:[[30003],256],127545:[[21106],256],127546:[[21942],256],127552:[[12308,26412,12309],256],127553:[[12308,19977,12309],256],127554:[[12308,20108,12309],256],127555:[[12308,23433,12309],256],127556:[[12308,28857,12309],256],127557:[[12308,25171,12309],256],127558:[[12308,30423,12309],256],127559:[[12308,21213,12309],256],127560:[[12308,25943,12309],256],127568:[[24471],256],127569:[[21487],256]},63488:{194560:[[20029]],194561:[[20024]],194562:[[20033]],194563:[[131362]],194564:[[20320]],194565:[[20398]],194566:[[20411]],194567:[[20482]],194568:[[20602]],194569:[[20633]],194570:[[20711]],194571:[[20687]],194572:[[13470]],194573:[[132666]],194574:[[20813]],194575:[[20820]],194576:[[20836]],194577:[[20855]],194578:[[132380]],194579:[[13497]],194580:[[20839]],194581:[[20877]],194582:[[132427]],194583:[[20887]],194584:[[20900]],194585:[[20172]],194586:[[20908]],194587:[[20917]],194588:[[168415]],194589:[[20981]],194590:[[20995]],194591:[[13535]],194592:[[21051]],194593:[[21062]],194594:[[21106]],194595:[[21111]],194596:[[13589]],194597:[[21191]],194598:[[21193]],194599:[[21220]],194600:[[21242]],194601:[[21253]],194602:[[21254]],194603:[[21271]],194604:[[21321]],194605:[[21329]],194606:[[21338]],194607:[[21363]],194608:[[21373]],194609:[[21375]],194610:[[21375]],194611:[[21375]],194612:[[133676]],194613:[[28784]],194614:[[21450]],194615:[[21471]],194616:[[133987]],194617:[[21483]],194618:[[21489]],194619:[[21510]],194620:[[21662]],194621:[[21560]],194622:[[21576]],194623:[[21608]],194624:[[21666]],194625:[[21750]],194626:[[21776]],194627:[[21843]],194628:[[21859]],194629:[[21892]],194630:[[21892]],194631:[[21913]],194632:[[21931]],194633:[[21939]],194634:[[21954]],194635:[[22294]],194636:[[22022]],194637:[[22295]],194638:[[22097]],194639:[[22132]],194640:[[20999]],194641:[[22766]],194642:[[22478]],194643:[[22516]],194644:[[22541]],194645:[[22411]],194646:[[22578]],194647:[[22577]],194648:[[22700]],194649:[[136420]],194650:[[22770]],194651:[[22775]],194652:[[22790]],194653:[[22810]],194654:[[22818]],194655:[[22882]],194656:[[136872]],194657:[[136938]],194658:[[23020]],194659:[[23067]],194660:[[23079]],194661:[[23e3]],194662:[[23142]],194663:[[14062]],194664:[[14076]],194665:[[23304]],194666:[[23358]],194667:[[23358]],194668:[[137672]],194669:[[23491]],194670:[[23512]],194671:[[23527]],194672:[[23539]],194673:[[138008]],194674:[[23551]],194675:[[23558]],194676:[[24403]],194677:[[23586]],194678:[[14209]],194679:[[23648]],194680:[[23662]],194681:[[23744]],194682:[[23693]],194683:[[138724]],194684:[[23875]],194685:[[138726]],194686:[[23918]],194687:[[23915]],194688:[[23932]],194689:[[24033]],194690:[[24034]],194691:[[14383]],194692:[[24061]],194693:[[24104]],194694:[[24125]],194695:[[24169]],194696:[[14434]],194697:[[139651]],194698:[[14460]],194699:[[24240]],194700:[[24243]],194701:[[24246]],194702:[[24266]],194703:[[172946]],194704:[[24318]],194705:[[140081]],194706:[[140081]],194707:[[33281]],194708:[[24354]],194709:[[24354]],194710:[[14535]],194711:[[144056]],194712:[[156122]],194713:[[24418]],194714:[[24427]],194715:[[14563]],194716:[[24474]],194717:[[24525]],194718:[[24535]],194719:[[24569]],194720:[[24705]],194721:[[14650]],194722:[[14620]],194723:[[24724]],194724:[[141012]],194725:[[24775]],194726:[[24904]],194727:[[24908]],194728:[[24910]],194729:[[24908]],194730:[[24954]],194731:[[24974]],194732:[[25010]],194733:[[24996]],194734:[[25007]],194735:[[25054]],194736:[[25074]],194737:[[25078]],194738:[[25104]],194739:[[25115]],194740:[[25181]],194741:[[25265]],194742:[[25300]],194743:[[25424]],194744:[[142092]],194745:[[25405]],194746:[[25340]],194747:[[25448]],194748:[[25475]],194749:[[25572]],194750:[[142321]],194751:[[25634]],194752:[[25541]],194753:[[25513]],194754:[[14894]],194755:[[25705]],194756:[[25726]],194757:[[25757]],194758:[[25719]],194759:[[14956]],194760:[[25935]],194761:[[25964]],194762:[[143370]],194763:[[26083]],194764:[[26360]],194765:[[26185]],194766:[[15129]],194767:[[26257]],194768:[[15112]],194769:[[15076]],194770:[[20882]],194771:[[20885]],194772:[[26368]],194773:[[26268]],194774:[[32941]],194775:[[17369]],194776:[[26391]],194777:[[26395]],194778:[[26401]],194779:[[26462]],194780:[[26451]],194781:[[144323]],194782:[[15177]],194783:[[26618]],194784:[[26501]],194785:[[26706]],194786:[[26757]],194787:[[144493]],194788:[[26766]],194789:[[26655]],194790:[[26900]],194791:[[15261]],194792:[[26946]],194793:[[27043]],194794:[[27114]],194795:[[27304]],194796:[[145059]],194797:[[27355]],194798:[[15384]],194799:[[27425]],194800:[[145575]],194801:[[27476]],194802:[[15438]],194803:[[27506]],194804:[[27551]],194805:[[27578]],194806:[[27579]],194807:[[146061]],194808:[[138507]],194809:[[146170]],194810:[[27726]],194811:[[146620]],194812:[[27839]],194813:[[27853]],194814:[[27751]],194815:[[27926]]},63744:{63744:[[35912]],63745:[[26356]],63746:[[36554]],63747:[[36040]],63748:[[28369]],63749:[[20018]],63750:[[21477]],63751:[[40860]],63752:[[40860]],63753:[[22865]],63754:[[37329]],63755:[[21895]],63756:[[22856]],63757:[[25078]],63758:[[30313]],63759:[[32645]],63760:[[34367]],63761:[[34746]],63762:[[35064]],63763:[[37007]],63764:[[27138]],63765:[[27931]],63766:[[28889]],63767:[[29662]],63768:[[33853]],63769:[[37226]],63770:[[39409]],63771:[[20098]],63772:[[21365]],63773:[[27396]],63774:[[29211]],63775:[[34349]],63776:[[40478]],63777:[[23888]],63778:[[28651]],63779:[[34253]],63780:[[35172]],63781:[[25289]],63782:[[33240]],63783:[[34847]],63784:[[24266]],63785:[[26391]],63786:[[28010]],63787:[[29436]],63788:[[37070]],63789:[[20358]],63790:[[20919]],63791:[[21214]],63792:[[25796]],63793:[[27347]],63794:[[29200]],63795:[[30439]],63796:[[32769]],63797:[[34310]],63798:[[34396]],63799:[[36335]],63800:[[38706]],63801:[[39791]],63802:[[40442]],63803:[[30860]],63804:[[31103]],63805:[[32160]],63806:[[33737]],63807:[[37636]],63808:[[40575]],63809:[[35542]],63810:[[22751]],63811:[[24324]],63812:[[31840]],63813:[[32894]],63814:[[29282]],63815:[[30922]],63816:[[36034]],63817:[[38647]],63818:[[22744]],63819:[[23650]],63820:[[27155]],63821:[[28122]],63822:[[28431]],63823:[[32047]],63824:[[32311]],63825:[[38475]],63826:[[21202]],63827:[[32907]],63828:[[20956]],63829:[[20940]],63830:[[31260]],63831:[[32190]],63832:[[33777]],63833:[[38517]],63834:[[35712]],63835:[[25295]],63836:[[27138]],63837:[[35582]],63838:[[20025]],63839:[[23527]],63840:[[24594]],63841:[[29575]],63842:[[30064]],63843:[[21271]],63844:[[30971]],63845:[[20415]],63846:[[24489]],63847:[[19981]],63848:[[27852]],63849:[[25976]],63850:[[32034]],63851:[[21443]],63852:[[22622]],63853:[[30465]],63854:[[33865]],63855:[[35498]],63856:[[27578]],63857:[[36784]],63858:[[27784]],63859:[[25342]],63860:[[33509]],63861:[[25504]],63862:[[30053]],63863:[[20142]],63864:[[20841]],63865:[[20937]],63866:[[26753]],63867:[[31975]],63868:[[33391]],63869:[[35538]],63870:[[37327]],63871:[[21237]],63872:[[21570]],63873:[[22899]],63874:[[24300]],63875:[[26053]],63876:[[28670]],63877:[[31018]],63878:[[38317]],63879:[[39530]],63880:[[40599]],63881:[[40654]],63882:[[21147]],63883:[[26310]],63884:[[27511]],63885:[[36706]],63886:[[24180]],63887:[[24976]],63888:[[25088]],63889:[[25754]],63890:[[28451]],63891:[[29001]],63892:[[29833]],63893:[[31178]],63894:[[32244]],63895:[[32879]],63896:[[36646]],63897:[[34030]],63898:[[36899]],63899:[[37706]],63900:[[21015]],63901:[[21155]],63902:[[21693]],63903:[[28872]],63904:[[35010]],63905:[[35498]],63906:[[24265]],63907:[[24565]],63908:[[25467]],63909:[[27566]],63910:[[31806]],63911:[[29557]],63912:[[20196]],63913:[[22265]],63914:[[23527]],63915:[[23994]],63916:[[24604]],63917:[[29618]],63918:[[29801]],63919:[[32666]],63920:[[32838]],63921:[[37428]],63922:[[38646]],63923:[[38728]],63924:[[38936]],63925:[[20363]],63926:[[31150]],63927:[[37300]],63928:[[38584]],63929:[[24801]],63930:[[20102]],63931:[[20698]],63932:[[23534]],63933:[[23615]],63934:[[26009]],63935:[[27138]],63936:[[29134]],63937:[[30274]],63938:[[34044]],63939:[[36988]],63940:[[40845]],63941:[[26248]],63942:[[38446]],63943:[[21129]],63944:[[26491]],63945:[[26611]],63946:[[27969]],63947:[[28316]],63948:[[29705]],63949:[[30041]],63950:[[30827]],63951:[[32016]],63952:[[39006]],63953:[[20845]],63954:[[25134]],63955:[[38520]],63956:[[20523]],63957:[[23833]],63958:[[28138]],63959:[[36650]],63960:[[24459]],63961:[[24900]],63962:[[26647]],63963:[[29575]],63964:[[38534]],63965:[[21033]],63966:[[21519]],63967:[[23653]],63968:[[26131]],63969:[[26446]],63970:[[26792]],63971:[[27877]],63972:[[29702]],63973:[[30178]],63974:[[32633]],63975:[[35023]],63976:[[35041]],63977:[[37324]],63978:[[38626]],63979:[[21311]],63980:[[28346]],63981:[[21533]],63982:[[29136]],63983:[[29848]],63984:[[34298]],63985:[[38563]],63986:[[40023]],63987:[[40607]],63988:[[26519]],63989:[[28107]],63990:[[33256]],63991:[[31435]],63992:[[31520]],63993:[[31890]],63994:[[29376]],63995:[[28825]],63996:[[35672]],63997:[[20160]],63998:[[33590]],63999:[[21050]],194816:[[27966]],194817:[[28023]],194818:[[27969]],194819:[[28009]],194820:[[28024]],194821:[[28037]],194822:[[146718]],194823:[[27956]],194824:[[28207]],194825:[[28270]],194826:[[15667]],194827:[[28363]],194828:[[28359]],194829:[[147153]],194830:[[28153]],194831:[[28526]],194832:[[147294]],194833:[[147342]],194834:[[28614]],194835:[[28729]],194836:[[28702]],194837:[[28699]],194838:[[15766]],194839:[[28746]],194840:[[28797]],194841:[[28791]],194842:[[28845]],194843:[[132389]],194844:[[28997]],194845:[[148067]],194846:[[29084]],194847:[[148395]],194848:[[29224]],194849:[[29237]],194850:[[29264]],194851:[[149e3]],194852:[[29312]],194853:[[29333]],194854:[[149301]],194855:[[149524]],194856:[[29562]],194857:[[29579]],194858:[[16044]],194859:[[29605]],194860:[[16056]],194861:[[16056]],194862:[[29767]],194863:[[29788]],194864:[[29809]],194865:[[29829]],194866:[[29898]],194867:[[16155]],194868:[[29988]],194869:[[150582]],194870:[[30014]],194871:[[150674]],194872:[[30064]],194873:[[139679]],194874:[[30224]],194875:[[151457]],194876:[[151480]],194877:[[151620]],194878:[[16380]],194879:[[16392]],194880:[[30452]],194881:[[151795]],194882:[[151794]],194883:[[151833]],194884:[[151859]],194885:[[30494]],194886:[[30495]],194887:[[30495]],194888:[[30538]],194889:[[16441]],194890:[[30603]],194891:[[16454]],194892:[[16534]],194893:[[152605]],194894:[[30798]],194895:[[30860]],194896:[[30924]],194897:[[16611]],194898:[[153126]],194899:[[31062]],194900:[[153242]],194901:[[153285]],194902:[[31119]],194903:[[31211]],194904:[[16687]],194905:[[31296]],194906:[[31306]],194907:[[31311]],194908:[[153980]],194909:[[154279]],194910:[[154279]],194911:[[31470]],194912:[[16898]],194913:[[154539]],194914:[[31686]],194915:[[31689]],194916:[[16935]],194917:[[154752]],194918:[[31954]],194919:[[17056]],194920:[[31976]],194921:[[31971]],194922:[[32e3]],194923:[[155526]],194924:[[32099]],194925:[[17153]],194926:[[32199]],194927:[[32258]],194928:[[32325]],194929:[[17204]],194930:[[156200]],194931:[[156231]],194932:[[17241]],194933:[[156377]],194934:[[32634]],194935:[[156478]],194936:[[32661]],194937:[[32762]],194938:[[32773]],194939:[[156890]],194940:[[156963]],194941:[[32864]],194942:[[157096]],194943:[[32880]],194944:[[144223]],194945:[[17365]],194946:[[32946]],194947:[[33027]],194948:[[17419]],194949:[[33086]],194950:[[23221]],194951:[[157607]],194952:[[157621]],194953:[[144275]],194954:[[144284]],194955:[[33281]],194956:[[33284]],194957:[[36766]],194958:[[17515]],194959:[[33425]],194960:[[33419]],194961:[[33437]],194962:[[21171]],194963:[[33457]],194964:[[33459]],194965:[[33469]],194966:[[33510]],194967:[[158524]],194968:[[33509]],194969:[[33565]],194970:[[33635]],194971:[[33709]],194972:[[33571]],194973:[[33725]],194974:[[33767]],194975:[[33879]],194976:[[33619]],194977:[[33738]],194978:[[33740]],194979:[[33756]],194980:[[158774]],194981:[[159083]],194982:[[158933]],194983:[[17707]],194984:[[34033]],194985:[[34035]],194986:[[34070]],194987:[[160714]],194988:[[34148]],194989:[[159532]],194990:[[17757]],194991:[[17761]],194992:[[159665]],194993:[[159954]],194994:[[17771]],194995:[[34384]],194996:[[34396]],194997:[[34407]],194998:[[34409]],194999:[[34473]],195e3:[[34440]],195001:[[34574]],195002:[[34530]],195003:[[34681]],195004:[[34600]],195005:[[34667]],195006:[[34694]],195007:[[17879]],195008:[[34785]],195009:[[34817]],195010:[[17913]],195011:[[34912]],195012:[[34915]],195013:[[161383]],195014:[[35031]],195015:[[35038]],195016:[[17973]],195017:[[35066]],195018:[[13499]],195019:[[161966]],195020:[[162150]],195021:[[18110]],195022:[[18119]],195023:[[35488]],195024:[[35565]],195025:[[35722]],195026:[[35925]],195027:[[162984]],195028:[[36011]],195029:[[36033]],195030:[[36123]],195031:[[36215]],195032:[[163631]],195033:[[133124]],195034:[[36299]],195035:[[36284]],195036:[[36336]],195037:[[133342]],195038:[[36564]],195039:[[36664]],195040:[[165330]],195041:[[165357]],195042:[[37012]],195043:[[37105]],195044:[[37137]],195045:[[165678]],195046:[[37147]],195047:[[37432]],195048:[[37591]],195049:[[37592]],195050:[[37500]],195051:[[37881]],195052:[[37909]],195053:[[166906]],195054:[[38283]],195055:[[18837]],195056:[[38327]],195057:[[167287]],195058:[[18918]],195059:[[38595]],195060:[[23986]],195061:[[38691]],195062:[[168261]],195063:[[168474]],195064:[[19054]],195065:[[19062]],195066:[[38880]],195067:[[168970]],195068:[[19122]],195069:[[169110]],195070:[[38923]],195071:[[38923]]},64e3:{64e3:[[20999]],64001:[[24230]],64002:[[25299]],64003:[[31958]],64004:[[23429]],64005:[[27934]],64006:[[26292]],64007:[[36667]],64008:[[34892]],64009:[[38477]],64010:[[35211]],64011:[[24275]],64012:[[20800]],64013:[[21952]],64016:[[22618]],64018:[[26228]],64021:[[20958]],64022:[[29482]],64023:[[30410]],64024:[[31036]],64025:[[31070]],64026:[[31077]],64027:[[31119]],64028:[[38742]],64029:[[31934]],64030:[[32701]],64032:[[34322]],64034:[[35576]],64037:[[36920]],64038:[[37117]],64042:[[39151]],64043:[[39164]],64044:[[39208]],64045:[[40372]],64046:[[37086]],64047:[[38583]],64048:[[20398]],64049:[[20711]],64050:[[20813]],64051:[[21193]],64052:[[21220]],64053:[[21329]],64054:[[21917]],64055:[[22022]],64056:[[22120]],64057:[[22592]],64058:[[22696]],64059:[[23652]],64060:[[23662]],64061:[[24724]],64062:[[24936]],64063:[[24974]],64064:[[25074]],64065:[[25935]],64066:[[26082]],64067:[[26257]],64068:[[26757]],64069:[[28023]],64070:[[28186]],64071:[[28450]],64072:[[29038]],64073:[[29227]],64074:[[29730]],64075:[[30865]],64076:[[31038]],64077:[[31049]],64078:[[31048]],64079:[[31056]],64080:[[31062]],64081:[[31069]],64082:[[31117]],64083:[[31118]],64084:[[31296]],64085:[[31361]],64086:[[31680]],64087:[[32244]],64088:[[32265]],64089:[[32321]],64090:[[32626]],64091:[[32773]],64092:[[33261]],64093:[[33401]],64094:[[33401]],64095:[[33879]],64096:[[35088]],64097:[[35222]],64098:[[35585]],64099:[[35641]],64100:[[36051]],64101:[[36104]],64102:[[36790]],64103:[[36920]],64104:[[38627]],64105:[[38911]],64106:[[38971]],64107:[[24693]],64108:[[148206]],64109:[[33304]],64112:[[20006]],64113:[[20917]],64114:[[20840]],64115:[[20352]],64116:[[20805]],64117:[[20864]],64118:[[21191]],64119:[[21242]],64120:[[21917]],64121:[[21845]],64122:[[21913]],64123:[[21986]],64124:[[22618]],64125:[[22707]],64126:[[22852]],64127:[[22868]],64128:[[23138]],64129:[[23336]],64130:[[24274]],64131:[[24281]],64132:[[24425]],64133:[[24493]],64134:[[24792]],64135:[[24910]],64136:[[24840]],64137:[[24974]],64138:[[24928]],64139:[[25074]],64140:[[25140]],64141:[[25540]],64142:[[25628]],64143:[[25682]],64144:[[25942]],64145:[[26228]],64146:[[26391]],64147:[[26395]],64148:[[26454]],64149:[[27513]],64150:[[27578]],64151:[[27969]],64152:[[28379]],64153:[[28363]],64154:[[28450]],64155:[[28702]],64156:[[29038]],64157:[[30631]],64158:[[29237]],64159:[[29359]],64160:[[29482]],64161:[[29809]],64162:[[29958]],64163:[[30011]],64164:[[30237]],64165:[[30239]],64166:[[30410]],64167:[[30427]],64168:[[30452]],64169:[[30538]],64170:[[30528]],64171:[[30924]],64172:[[31409]],64173:[[31680]],64174:[[31867]],64175:[[32091]],64176:[[32244]],64177:[[32574]],64178:[[32773]],64179:[[33618]],64180:[[33775]],64181:[[34681]],64182:[[35137]],64183:[[35206]],64184:[[35222]],64185:[[35519]],64186:[[35576]],64187:[[35531]],64188:[[35585]],64189:[[35582]],64190:[[35565]],64191:[[35641]],64192:[[35722]],64193:[[36104]],64194:[[36664]],64195:[[36978]],64196:[[37273]],64197:[[37494]],64198:[[38524]],64199:[[38627]],64200:[[38742]],64201:[[38875]],64202:[[38911]],64203:[[38923]],64204:[[38971]],64205:[[39698]],64206:[[40860]],64207:[[141386]],64208:[[141380]],64209:[[144341]],64210:[[15261]],64211:[[16408]],64212:[[16441]],64213:[[152137]],64214:[[154832]],64215:[[163539]],64216:[[40771]],64217:[[40846]],195072:[[38953]],195073:[[169398]],195074:[[39138]],195075:[[19251]],195076:[[39209]],195077:[[39335]],195078:[[39362]],195079:[[39422]],195080:[[19406]],195081:[[170800]],195082:[[39698]],195083:[[4e4]],195084:[[40189]],195085:[[19662]],195086:[[19693]],195087:[[40295]],195088:[[172238]],195089:[[19704]],195090:[[172293]],195091:[[172558]],195092:[[172689]],195093:[[40635]],195094:[[19798]],195095:[[40697]],195096:[[40702]],195097:[[40709]],195098:[[40719]],195099:[[40726]],195100:[[40763]],195101:[[173568]]},64256:{64256:[[102,102],256],64257:[[102,105],256],64258:[[102,108],256],64259:[[102,102,105],256],64260:[[102,102,108],256],64261:[[383,116],256],64262:[[115,116],256],64275:[[1396,1398],256],64276:[[1396,1381],256],64277:[[1396,1387],256],64278:[[1406,1398],256],64279:[[1396,1389],256],64285:[[1497,1460],512],64286:[,26],64287:[[1522,1463],512],64288:[[1506],256],64289:[[1488],256],64290:[[1491],256],64291:[[1492],256],64292:[[1499],256],64293:[[1500],256],64294:[[1501],256],64295:[[1512],256],64296:[[1514],256],64297:[[43],256],64298:[[1513,1473],512],64299:[[1513,1474],512],64300:[[64329,1473],512],64301:[[64329,1474],512],64302:[[1488,1463],512],64303:[[1488,1464],512],64304:[[1488,1468],512],64305:[[1489,1468],512],64306:[[1490,1468],512],64307:[[1491,1468],512],64308:[[1492,1468],512],64309:[[1493,1468],512],64310:[[1494,1468],512],64312:[[1496,1468],512],64313:[[1497,1468],512],64314:[[1498,1468],512],64315:[[1499,1468],512],64316:[[1500,1468],512],64318:[[1502,1468],512],64320:[[1504,1468],512],64321:[[1505,1468],512],64323:[[1507,1468],512],64324:[[1508,1468],512],64326:[[1510,1468],512],64327:[[1511,1468],512],64328:[[1512,1468],512],64329:[[1513,1468],512],64330:[[1514,1468],512],64331:[[1493,1465],512],64332:[[1489,1471],512],64333:[[1499,1471],512],64334:[[1508,1471],512],64335:[[1488,1500],256],64336:[[1649],256],64337:[[1649],256],64338:[[1659],256],64339:[[1659],256],64340:[[1659],256],64341:[[1659],256],64342:[[1662],256],64343:[[1662],256],64344:[[1662],256],64345:[[1662],256],64346:[[1664],256],64347:[[1664],256],64348:[[1664],256],64349:[[1664],256],64350:[[1658],256],64351:[[1658],256],64352:[[1658],256],64353:[[1658],256],64354:[[1663],256],64355:[[1663],256],64356:[[1663],256],64357:[[1663],256],64358:[[1657],256],64359:[[1657],256],64360:[[1657],256],64361:[[1657],256],64362:[[1700],256],64363:[[1700],256],64364:[[1700],256],64365:[[1700],256],64366:[[1702],256],64367:[[1702],256],64368:[[1702],256],64369:[[1702],256],64370:[[1668],256],64371:[[1668],256],64372:[[1668],256],64373:[[1668],256],64374:[[1667],256],64375:[[1667],256],64376:[[1667],256],64377:[[1667],256],64378:[[1670],256],64379:[[1670],256],64380:[[1670],256],64381:[[1670],256],64382:[[1671],256],64383:[[1671],256],64384:[[1671],256],64385:[[1671],256],64386:[[1677],256],64387:[[1677],256],64388:[[1676],256],64389:[[1676],256],64390:[[1678],256],64391:[[1678],256],64392:[[1672],256],64393:[[1672],256],64394:[[1688],256],64395:[[1688],256],64396:[[1681],256],64397:[[1681],256],64398:[[1705],256],64399:[[1705],256],64400:[[1705],256],64401:[[1705],256],64402:[[1711],256],64403:[[1711],256],64404:[[1711],256],64405:[[1711],256],64406:[[1715],256],64407:[[1715],256],64408:[[1715],256],64409:[[1715],256],64410:[[1713],256],64411:[[1713],256],64412:[[1713],256],64413:[[1713],256],64414:[[1722],256],64415:[[1722],256],64416:[[1723],256],64417:[[1723],256],64418:[[1723],256],64419:[[1723],256],64420:[[1728],256],64421:[[1728],256],64422:[[1729],256],64423:[[1729],256],64424:[[1729],256],64425:[[1729],256],64426:[[1726],256],64427:[[1726],256],64428:[[1726],256],64429:[[1726],256],64430:[[1746],256],64431:[[1746],256],64432:[[1747],256],64433:[[1747],256],64467:[[1709],256],64468:[[1709],256],64469:[[1709],256],64470:[[1709],256],64471:[[1735],256],64472:[[1735],256],64473:[[1734],256],64474:[[1734],256],64475:[[1736],256],64476:[[1736],256],64477:[[1655],256],64478:[[1739],256],64479:[[1739],256],64480:[[1733],256],64481:[[1733],256],64482:[[1737],256],64483:[[1737],256],64484:[[1744],256],64485:[[1744],256],64486:[[1744],256],64487:[[1744],256],64488:[[1609],256],64489:[[1609],256],64490:[[1574,1575],256],64491:[[1574,1575],256],64492:[[1574,1749],256],64493:[[1574,1749],256],64494:[[1574,1608],256],64495:[[1574,1608],256],64496:[[1574,1735],256],64497:[[1574,1735],256],64498:[[1574,1734],256],64499:[[1574,1734],256],64500:[[1574,1736],256],64501:[[1574,1736],256],64502:[[1574,1744],256],64503:[[1574,1744],256],64504:[[1574,1744],256],64505:[[1574,1609],256],64506:[[1574,1609],256],64507:[[1574,1609],256],64508:[[1740],256],64509:[[1740],256],64510:[[1740],256],64511:[[1740],256]},64512:{64512:[[1574,1580],256],64513:[[1574,1581],256],64514:[[1574,1605],256],64515:[[1574,1609],256],64516:[[1574,1610],256],64517:[[1576,1580],256],64518:[[1576,1581],256],64519:[[1576,1582],256],64520:[[1576,1605],256],64521:[[1576,1609],256],64522:[[1576,1610],256],64523:[[1578,1580],256],64524:[[1578,1581],256],64525:[[1578,1582],256],64526:[[1578,1605],256],64527:[[1578,1609],256],64528:[[1578,1610],256],64529:[[1579,1580],256],64530:[[1579,1605],256],64531:[[1579,1609],256],64532:[[1579,1610],256],64533:[[1580,1581],256],64534:[[1580,1605],256],64535:[[1581,1580],256],64536:[[1581,1605],256],64537:[[1582,1580],256],64538:[[1582,1581],256],64539:[[1582,1605],256],64540:[[1587,1580],256],64541:[[1587,1581],256],64542:[[1587,1582],256],64543:[[1587,1605],256],64544:[[1589,1581],256],64545:[[1589,1605],256],64546:[[1590,1580],256],64547:[[1590,1581],256],64548:[[1590,1582],256],64549:[[1590,1605],256],64550:[[1591,1581],256],64551:[[1591,1605],256],64552:[[1592,1605],256],64553:[[1593,1580],256],64554:[[1593,1605],256],64555:[[1594,1580],256],64556:[[1594,1605],256],64557:[[1601,1580],256],64558:[[1601,1581],256],64559:[[1601,1582],256],64560:[[1601,1605],256],64561:[[1601,1609],256],64562:[[1601,1610],256],64563:[[1602,1581],256],64564:[[1602,1605],256],64565:[[1602,1609],256],64566:[[1602,1610],256],64567:[[1603,1575],256],64568:[[1603,1580],256],64569:[[1603,1581],256],64570:[[1603,1582],256],64571:[[1603,1604],256],64572:[[1603,1605],256],64573:[[1603,1609],256],64574:[[1603,1610],256],64575:[[1604,1580],256],64576:[[1604,1581],256],64577:[[1604,1582],256],64578:[[1604,1605],256],64579:[[1604,1609],256],64580:[[1604,1610],256],64581:[[1605,1580],256],64582:[[1605,1581],256],64583:[[1605,1582],256],64584:[[1605,1605],256],64585:[[1605,1609],256],64586:[[1605,1610],256],64587:[[1606,1580],256],64588:[[1606,1581],256],64589:[[1606,1582],256],64590:[[1606,1605],256],64591:[[1606,1609],256],64592:[[1606,1610],256],64593:[[1607,1580],256],64594:[[1607,1605],256],64595:[[1607,1609],256],64596:[[1607,1610],256],64597:[[1610,1580],256],64598:[[1610,1581],256],64599:[[1610,1582],256],64600:[[1610,1605],256],64601:[[1610,1609],256],64602:[[1610,1610],256],64603:[[1584,1648],256],64604:[[1585,1648],256],64605:[[1609,1648],256],64606:[[32,1612,1617],256],64607:[[32,1613,1617],256],64608:[[32,1614,1617],256],64609:[[32,1615,1617],256],64610:[[32,1616,1617],256],64611:[[32,1617,1648],256],64612:[[1574,1585],256],64613:[[1574,1586],256],64614:[[1574,1605],256],64615:[[1574,1606],256],64616:[[1574,1609],256],64617:[[1574,1610],256],64618:[[1576,1585],256],64619:[[1576,1586],256],64620:[[1576,1605],256],64621:[[1576,1606],256],64622:[[1576,1609],256],64623:[[1576,1610],256],64624:[[1578,1585],256],64625:[[1578,1586],256],64626:[[1578,1605],256],64627:[[1578,1606],256],64628:[[1578,1609],256],64629:[[1578,1610],256],64630:[[1579,1585],256],64631:[[1579,1586],256],64632:[[1579,1605],256],64633:[[1579,1606],256],64634:[[1579,1609],256],64635:[[1579,1610],256],64636:[[1601,1609],256],64637:[[1601,1610],256],64638:[[1602,1609],256],64639:[[1602,1610],256],64640:[[1603,1575],256],64641:[[1603,1604],256],64642:[[1603,1605],256],64643:[[1603,1609],256],64644:[[1603,1610],256],64645:[[1604,1605],256],64646:[[1604,1609],256],64647:[[1604,1610],256],64648:[[1605,1575],256],64649:[[1605,1605],256],64650:[[1606,1585],256],64651:[[1606,1586],256],64652:[[1606,1605],256],64653:[[1606,1606],256],64654:[[1606,1609],256],64655:[[1606,1610],256],64656:[[1609,1648],256],64657:[[1610,1585],256],64658:[[1610,1586],256],64659:[[1610,1605],256],64660:[[1610,1606],256],64661:[[1610,1609],256],64662:[[1610,1610],256],64663:[[1574,1580],256],64664:[[1574,1581],256],64665:[[1574,1582],256],64666:[[1574,1605],256],64667:[[1574,1607],256],64668:[[1576,1580],256],64669:[[1576,1581],256],64670:[[1576,1582],256],64671:[[1576,1605],256],64672:[[1576,1607],256],64673:[[1578,1580],256],64674:[[1578,1581],256],64675:[[1578,1582],256],64676:[[1578,1605],256],64677:[[1578,1607],256],64678:[[1579,1605],256],64679:[[1580,1581],256],64680:[[1580,1605],256],64681:[[1581,1580],256],64682:[[1581,1605],256],64683:[[1582,1580],256],64684:[[1582,1605],256],64685:[[1587,1580],256],64686:[[1587,1581],256],64687:[[1587,1582],256],64688:[[1587,1605],256],64689:[[1589,1581],256],64690:[[1589,1582],256],64691:[[1589,1605],256],64692:[[1590,1580],256],64693:[[1590,1581],256],64694:[[1590,1582],256],64695:[[1590,1605],256],64696:[[1591,1581],256],64697:[[1592,1605],256],64698:[[1593,1580],256],64699:[[1593,1605],256],64700:[[1594,1580],256],64701:[[1594,1605],256],64702:[[1601,1580],256],64703:[[1601,1581],256],64704:[[1601,1582],256],64705:[[1601,1605],256],64706:[[1602,1581],256],64707:[[1602,1605],256],64708:[[1603,1580],256],64709:[[1603,1581],256],64710:[[1603,1582],256],64711:[[1603,1604],256],64712:[[1603,1605],256],64713:[[1604,1580],256],64714:[[1604,1581],256],64715:[[1604,1582],256],64716:[[1604,1605],256],64717:[[1604,1607],256],64718:[[1605,1580],256],64719:[[1605,1581],256],64720:[[1605,1582],256],64721:[[1605,1605],256],64722:[[1606,1580],256],64723:[[1606,1581],256],64724:[[1606,1582],256],64725:[[1606,1605],256],64726:[[1606,1607],256],64727:[[1607,1580],256],64728:[[1607,1605],256],64729:[[1607,1648],256],64730:[[1610,1580],256],64731:[[1610,1581],256],64732:[[1610,1582],256],64733:[[1610,1605],256],64734:[[1610,1607],256],64735:[[1574,1605],256],64736:[[1574,1607],256],64737:[[1576,1605],256],64738:[[1576,1607],256],64739:[[1578,1605],256],64740:[[1578,1607],256],64741:[[1579,1605],256],64742:[[1579,1607],256],64743:[[1587,1605],256],64744:[[1587,1607],256],64745:[[1588,1605],256],64746:[[1588,1607],256],64747:[[1603,1604],256],64748:[[1603,1605],256],64749:[[1604,1605],256],64750:[[1606,1605],256],64751:[[1606,1607],256],64752:[[1610,1605],256],64753:[[1610,1607],256],64754:[[1600,1614,1617],256],64755:[[1600,1615,1617],256],64756:[[1600,1616,1617],256],64757:[[1591,1609],256],64758:[[1591,1610],256],64759:[[1593,1609],256],64760:[[1593,1610],256],64761:[[1594,1609],256],64762:[[1594,1610],256],64763:[[1587,1609],256],64764:[[1587,1610],256],64765:[[1588,1609],256],64766:[[1588,1610],256],64767:[[1581,1609],256]},64768:{64768:[[1581,1610],256],64769:[[1580,1609],256],64770:[[1580,1610],256],64771:[[1582,1609],256],64772:[[1582,1610],256],64773:[[1589,1609],256],64774:[[1589,1610],256],64775:[[1590,1609],256],64776:[[1590,1610],256],64777:[[1588,1580],256],64778:[[1588,1581],256],64779:[[1588,1582],256],64780:[[1588,1605],256],64781:[[1588,1585],256],64782:[[1587,1585],256],64783:[[1589,1585],256],64784:[[1590,1585],256],64785:[[1591,1609],256],64786:[[1591,1610],256],64787:[[1593,1609],256],64788:[[1593,1610],256],64789:[[1594,1609],256],64790:[[1594,1610],256],64791:[[1587,1609],256],64792:[[1587,1610],256],64793:[[1588,1609],256],64794:[[1588,1610],256],64795:[[1581,1609],256],64796:[[1581,1610],256],64797:[[1580,1609],256],64798:[[1580,1610],256],64799:[[1582,1609],256],64800:[[1582,1610],256],64801:[[1589,1609],256],64802:[[1589,1610],256],64803:[[1590,1609],256],64804:[[1590,1610],256],64805:[[1588,1580],256],64806:[[1588,1581],256],64807:[[1588,1582],256],64808:[[1588,1605],256],64809:[[1588,1585],256],64810:[[1587,1585],256],64811:[[1589,1585],256],64812:[[1590,1585],256],64813:[[1588,1580],256],64814:[[1588,1581],256],64815:[[1588,1582],256],64816:[[1588,1605],256],64817:[[1587,1607],256],64818:[[1588,1607],256],64819:[[1591,1605],256],64820:[[1587,1580],256],64821:[[1587,1581],256],64822:[[1587,1582],256],64823:[[1588,1580],256],64824:[[1588,1581],256],64825:[[1588,1582],256],64826:[[1591,1605],256],64827:[[1592,1605],256],64828:[[1575,1611],256],64829:[[1575,1611],256],64848:[[1578,1580,1605],256],64849:[[1578,1581,1580],256],64850:[[1578,1581,1580],256],64851:[[1578,1581,1605],256],64852:[[1578,1582,1605],256],64853:[[1578,1605,1580],256],64854:[[1578,1605,1581],256],64855:[[1578,1605,1582],256],64856:[[1580,1605,1581],256],64857:[[1580,1605,1581],256],64858:[[1581,1605,1610],256],64859:[[1581,1605,1609],256],64860:[[1587,1581,1580],256],64861:[[1587,1580,1581],256],64862:[[1587,1580,1609],256],64863:[[1587,1605,1581],256],64864:[[1587,1605,1581],256],64865:[[1587,1605,1580],256],64866:[[1587,1605,1605],256],64867:[[1587,1605,1605],256],64868:[[1589,1581,1581],256],64869:[[1589,1581,1581],256],64870:[[1589,1605,1605],256],64871:[[1588,1581,1605],256],64872:[[1588,1581,1605],256],64873:[[1588,1580,1610],256],64874:[[1588,1605,1582],256],64875:[[1588,1605,1582],256],64876:[[1588,1605,1605],256],64877:[[1588,1605,1605],256],64878:[[1590,1581,1609],256],64879:[[1590,1582,1605],256],64880:[[1590,1582,1605],256],64881:[[1591,1605,1581],256],64882:[[1591,1605,1581],256],64883:[[1591,1605,1605],256],64884:[[1591,1605,1610],256],64885:[[1593,1580,1605],256],64886:[[1593,1605,1605],256],64887:[[1593,1605,1605],256],64888:[[1593,1605,1609],256],64889:[[1594,1605,1605],256],64890:[[1594,1605,1610],256],64891:[[1594,1605,1609],256],64892:[[1601,1582,1605],256],64893:[[1601,1582,1605],256],64894:[[1602,1605,1581],256],64895:[[1602,1605,1605],256],64896:[[1604,1581,1605],256],64897:[[1604,1581,1610],256],64898:[[1604,1581,1609],256],64899:[[1604,1580,1580],256],64900:[[1604,1580,1580],256],64901:[[1604,1582,1605],256],64902:[[1604,1582,1605],256],64903:[[1604,1605,1581],256],64904:[[1604,1605,1581],256],64905:[[1605,1581,1580],256],64906:[[1605,1581,1605],256],64907:[[1605,1581,1610],256],64908:[[1605,1580,1581],256],64909:[[1605,1580,1605],256],64910:[[1605,1582,1580],256],64911:[[1605,1582,1605],256],64914:[[1605,1580,1582],256],64915:[[1607,1605,1580],256],64916:[[1607,1605,1605],256],64917:[[1606,1581,1605],256],64918:[[1606,1581,1609],256],64919:[[1606,1580,1605],256],64920:[[1606,1580,1605],256],64921:[[1606,1580,1609],256],64922:[[1606,1605,1610],256],64923:[[1606,1605,1609],256],64924:[[1610,1605,1605],256],64925:[[1610,1605,1605],256],64926:[[1576,1582,1610],256],64927:[[1578,1580,1610],256],64928:[[1578,1580,1609],256],64929:[[1578,1582,1610],256],64930:[[1578,1582,1609],256],64931:[[1578,1605,1610],256],64932:[[1578,1605,1609],256],64933:[[1580,1605,1610],256],64934:[[1580,1581,1609],256],64935:[[1580,1605,1609],256],64936:[[1587,1582,1609],256],64937:[[1589,1581,1610],256],64938:[[1588,1581,1610],256],64939:[[1590,1581,1610],256],64940:[[1604,1580,1610],256],64941:[[1604,1605,1610],256],64942:[[1610,1581,1610],256],64943:[[1610,1580,1610],256],64944:[[1610,1605,1610],256],64945:[[1605,1605,1610],256],64946:[[1602,1605,1610],256],64947:[[1606,1581,1610],256],64948:[[1602,1605,1581],256],64949:[[1604,1581,1605],256],64950:[[1593,1605,1610],256],64951:[[1603,1605,1610],256],64952:[[1606,1580,1581],256],64953:[[1605,1582,1610],256],64954:[[1604,1580,1605],256],64955:[[1603,1605,1605],256],64956:[[1604,1580,1605],256],64957:[[1606,1580,1581],256],64958:[[1580,1581,1610],256],64959:[[1581,1580,1610],256],64960:[[1605,1580,1610],256],64961:[[1601,1605,1610],256],64962:[[1576,1581,1610],256],64963:[[1603,1605,1605],256],64964:[[1593,1580,1605],256],64965:[[1589,1605,1605],256],64966:[[1587,1582,1610],256],64967:[[1606,1580,1610],256],65008:[[1589,1604,1746],256],65009:[[1602,1604,1746],256],65010:[[1575,1604,1604,1607],256],65011:[[1575,1603,1576,1585],256],65012:[[1605,1581,1605,1583],256],65013:[[1589,1604,1593,1605],256],65014:[[1585,1587,1608,1604],256],65015:[[1593,1604,1610,1607],256],65016:[[1608,1587,1604,1605],256],65017:[[1589,1604,1609],256],65018:[[1589,1604,1609,32,1575,1604,1604,1607,32,1593,1604,1610,1607,32,1608,1587,1604,1605],256],65019:[[1580,1604,32,1580,1604,1575,1604,1607],256],65020:[[1585,1740,1575,1604],256]},65024:{65040:[[44],256],65041:[[12289],256],65042:[[12290],256],65043:[[58],256],65044:[[59],256],65045:[[33],256],65046:[[63],256],65047:[[12310],256],65048:[[12311],256],65049:[[8230],256],65056:[,230],65057:[,230],65058:[,230],65059:[,230],65060:[,230],65061:[,230],65062:[,230],65063:[,220],65064:[,220],65065:[,220],65066:[,220],65067:[,220],65068:[,220],65069:[,220],65072:[[8229],256],65073:[[8212],256],65074:[[8211],256],65075:[[95],256],65076:[[95],256],65077:[[40],256],65078:[[41],256],65079:[[123],256],65080:[[125],256],65081:[[12308],256],65082:[[12309],256],65083:[[12304],256],65084:[[12305],256],65085:[[12298],256],65086:[[12299],256],65087:[[12296],256],65088:[[12297],256],65089:[[12300],256],65090:[[12301],256],65091:[[12302],256],65092:[[12303],256],65095:[[91],256],65096:[[93],256],65097:[[8254],256],65098:[[8254],256],65099:[[8254],256],65100:[[8254],256],65101:[[95],256],65102:[[95],256],65103:[[95],256],65104:[[44],256],65105:[[12289],256],65106:[[46],256],65108:[[59],256],65109:[[58],256],65110:[[63],256],65111:[[33],256],65112:[[8212],256],65113:[[40],256],65114:[[41],256],65115:[[123],256],65116:[[125],256],65117:[[12308],256],65118:[[12309],256],65119:[[35],256],65120:[[38],256],65121:[[42],256],65122:[[43],256],65123:[[45],256],65124:[[60],256],65125:[[62],256],65126:[[61],256],65128:[[92],256],65129:[[36],256],65130:[[37],256],65131:[[64],256],65136:[[32,1611],256],65137:[[1600,1611],256],65138:[[32,1612],256],65140:[[32,1613],256],65142:[[32,1614],256],65143:[[1600,1614],256],65144:[[32,1615],256],65145:[[1600,1615],256],65146:[[32,1616],256],65147:[[1600,1616],256],65148:[[32,1617],256],65149:[[1600,1617],256],65150:[[32,1618],256],65151:[[1600,1618],256],65152:[[1569],256],65153:[[1570],256],65154:[[1570],256],65155:[[1571],256],65156:[[1571],256],65157:[[1572],256],65158:[[1572],256],65159:[[1573],256],65160:[[1573],256],65161:[[1574],256],65162:[[1574],256],65163:[[1574],256],65164:[[1574],256],65165:[[1575],256],65166:[[1575],256],65167:[[1576],256],65168:[[1576],256],65169:[[1576],256],65170:[[1576],256],65171:[[1577],256],65172:[[1577],256],65173:[[1578],256],65174:[[1578],256],65175:[[1578],256],65176:[[1578],256],65177:[[1579],256],65178:[[1579],256],65179:[[1579],256],65180:[[1579],256],65181:[[1580],256],65182:[[1580],256],65183:[[1580],256],65184:[[1580],256],65185:[[1581],256],65186:[[1581],256],65187:[[1581],256],65188:[[1581],256],65189:[[1582],256],65190:[[1582],256],65191:[[1582],256],65192:[[1582],256],65193:[[1583],256],65194:[[1583],256],65195:[[1584],256],65196:[[1584],256],65197:[[1585],256],65198:[[1585],256],65199:[[1586],256],65200:[[1586],256],65201:[[1587],256],65202:[[1587],256],65203:[[1587],256],65204:[[1587],256],65205:[[1588],256],65206:[[1588],256],65207:[[1588],256],65208:[[1588],256],65209:[[1589],256],65210:[[1589],256],65211:[[1589],256],65212:[[1589],256],65213:[[1590],256],65214:[[1590],256],65215:[[1590],256],65216:[[1590],256],65217:[[1591],256],65218:[[1591],256],65219:[[1591],256],65220:[[1591],256],65221:[[1592],256],65222:[[1592],256],65223:[[1592],256],65224:[[1592],256],65225:[[1593],256],65226:[[1593],256],65227:[[1593],256],65228:[[1593],256],65229:[[1594],256],65230:[[1594],256],65231:[[1594],256],65232:[[1594],256],65233:[[1601],256],65234:[[1601],256],65235:[[1601],256],65236:[[1601],256],65237:[[1602],256],65238:[[1602],256],65239:[[1602],256],65240:[[1602],256],65241:[[1603],256],65242:[[1603],256],65243:[[1603],256],65244:[[1603],256],65245:[[1604],256],65246:[[1604],256],65247:[[1604],256],65248:[[1604],256],65249:[[1605],256],65250:[[1605],256],65251:[[1605],256],65252:[[1605],256],65253:[[1606],256],65254:[[1606],256],65255:[[1606],256],65256:[[1606],256],65257:[[1607],256],65258:[[1607],256],65259:[[1607],256],65260:[[1607],256],65261:[[1608],256],65262:[[1608],256],65263:[[1609],256],65264:[[1609],256],65265:[[1610],256],65266:[[1610],256],65267:[[1610],256],65268:[[1610],256],65269:[[1604,1570],256],65270:[[1604,1570],256],65271:[[1604,1571],256],65272:[[1604,1571],256],65273:[[1604,1573],256],65274:[[1604,1573],256],65275:[[1604,1575],256],65276:[[1604,1575],256]},65280:{65281:[[33],256],65282:[[34],256],65283:[[35],256],65284:[[36],256],65285:[[37],256],65286:[[38],256],65287:[[39],256],65288:[[40],256],65289:[[41],256],65290:[[42],256],65291:[[43],256],65292:[[44],256],65293:[[45],256],65294:[[46],256],65295:[[47],256],65296:[[48],256],65297:[[49],256],65298:[[50],256],65299:[[51],256],65300:[[52],256],65301:[[53],256],65302:[[54],256],65303:[[55],256],65304:[[56],256],65305:[[57],256],65306:[[58],256],65307:[[59],256],65308:[[60],256],65309:[[61],256],65310:[[62],256],65311:[[63],256],65312:[[64],256],65313:[[65],256],65314:[[66],256],65315:[[67],256],65316:[[68],256],65317:[[69],256],65318:[[70],256],65319:[[71],256],65320:[[72],256],65321:[[73],256],65322:[[74],256],65323:[[75],256],65324:[[76],256],65325:[[77],256],65326:[[78],256],65327:[[79],256],65328:[[80],256],65329:[[81],256],65330:[[82],256],65331:[[83],256],65332:[[84],256],65333:[[85],256],65334:[[86],256],65335:[[87],256],65336:[[88],256],65337:[[89],256],65338:[[90],256],65339:[[91],256],65340:[[92],256],65341:[[93],256],65342:[[94],256],65343:[[95],256],65344:[[96],256],65345:[[97],256],65346:[[98],256],65347:[[99],256],65348:[[100],256],65349:[[101],256],65350:[[102],256],65351:[[103],256],65352:[[104],256],65353:[[105],256],65354:[[106],256],65355:[[107],256],65356:[[108],256],65357:[[109],256],65358:[[110],256],65359:[[111],256],65360:[[112],256],65361:[[113],256],65362:[[114],256],65363:[[115],256],65364:[[116],256],65365:[[117],256],65366:[[118],256],65367:[[119],256],65368:[[120],256],65369:[[121],256],65370:[[122],256],65371:[[123],256],65372:[[124],256],65373:[[125],256],65374:[[126],256],65375:[[10629],256],65376:[[10630],256],65377:[[12290],256],65378:[[12300],256],65379:[[12301],256],65380:[[12289],256],65381:[[12539],256],65382:[[12530],256],65383:[[12449],256],65384:[[12451],256],65385:[[12453],256],65386:[[12455],256],65387:[[12457],256],65388:[[12515],256],65389:[[12517],256],65390:[[12519],256],65391:[[12483],256],65392:[[12540],256],65393:[[12450],256],65394:[[12452],256],65395:[[12454],256],65396:[[12456],256],65397:[[12458],256],65398:[[12459],256],65399:[[12461],256],65400:[[12463],256],65401:[[12465],256],65402:[[12467],256],65403:[[12469],256],65404:[[12471],256],65405:[[12473],256],65406:[[12475],256],65407:[[12477],256],65408:[[12479],256],65409:[[12481],256],65410:[[12484],256],65411:[[12486],256],65412:[[12488],256],65413:[[12490],256],65414:[[12491],256],65415:[[12492],256],65416:[[12493],256],65417:[[12494],256],65418:[[12495],256],65419:[[12498],256],65420:[[12501],256],65421:[[12504],256],65422:[[12507],256],65423:[[12510],256],65424:[[12511],256],65425:[[12512],256],65426:[[12513],256],65427:[[12514],256],65428:[[12516],256],65429:[[12518],256],65430:[[12520],256],65431:[[12521],256],65432:[[12522],256],65433:[[12523],256],65434:[[12524],256],65435:[[12525],256],65436:[[12527],256],65437:[[12531],256],65438:[[12441],256],65439:[[12442],256],65440:[[12644],256],65441:[[12593],256],65442:[[12594],256],65443:[[12595],256],65444:[[12596],256],65445:[[12597],256],65446:[[12598],256],65447:[[12599],256],65448:[[12600],256],65449:[[12601],256],65450:[[12602],256],65451:[[12603],256],65452:[[12604],256],65453:[[12605],256],65454:[[12606],256],65455:[[12607],256],65456:[[12608],256],65457:[[12609],256],65458:[[12610],256],65459:[[12611],256],65460:[[12612],256],65461:[[12613],256],65462:[[12614],256],65463:[[12615],256],65464:[[12616],256],65465:[[12617],256],65466:[[12618],256],65467:[[12619],256],65468:[[12620],256],65469:[[12621],256],65470:[[12622],256],65474:[[12623],256],65475:[[12624],256],65476:[[12625],256],65477:[[12626],256],65478:[[12627],256],65479:[[12628],256],65482:[[12629],256],65483:[[12630],256],65484:[[12631],256],65485:[[12632],256],65486:[[12633],256],65487:[[12634],256],65490:[[12635],256],65491:[[12636],256],65492:[[12637],256],65493:[[12638],256],65494:[[12639],256],65495:[[12640],256],65498:[[12641],256],65499:[[12642],256],65500:[[12643],256],65504:[[162],256],65505:[[163],256],65506:[[172],256],65507:[[175],256],65508:[[166],256],65509:[[165],256],65510:[[8361],256],65512:[[9474],256],65513:[[8592],256],65514:[[8593],256],65515:[[8594],256],65516:[[8595],256],65517:[[9632],256],65518:[[9675],256]}};var n={nfc:function(t){return e("NFC",t)},nfd:function(t){return e("NFD",t)},nfkc:function(t){return e("NFKC",t)},nfkd:function(t){return e("NFKD",t)}};"object"==typeof module?module.exports=n:"function"==typeof define&&define.amd?define("unorm",function(){return n}):t.unorm=n,n.shimApplied=!1,String.prototype.normalize||(String.prototype.normalize=function(t){var r=""+this;if("NFC"===(t=void 0===t?"NFC":t))return n.nfc(r);if("NFD"===t)return n.nfd(r);if("NFKC"===t)return n.nfkc(r);if("NFKD"===t)return n.nfkd(r);throw new RangeError("Invalid normalization form: "+t)},n.shimApplied=!0)}(this);
!function(e,m){var T=jQuery;!function(e){"use strict";function i(e){this.clientConfiguration=e,this.user=m,this.mediaServicesFactory=m,this.version="4.5.0.16",i.Base.Logger.clearLoggers()}i.prototype={createUser:function(e){return this.user||(this.mediaServicesFactory===m&&(this.mediaServicesFactory=new i.Base.MediaServicesFactory),this.user=new i.User(e,this.mediaServicesFactory,this.version)),this.user},registerLogger:function(e,t){i.Base.Logger.addLogger(e,t)},getMediaServices:function(){return this.mediaServicesFactory===m&&(this.mediaServicesFactory=new i.Base.MediaServicesFactory),this.mediaServicesFactory.getMediaServices()},getVersion:function(){return this.version}},e.AvayaClientServices=i}(window),function(e){"use strict";var t,i,a,r,s,n,o,c,l,d,C;(t=e).Base=t.Base||{},(i=e).Config=i.Config||{},(a=e).Services=a.Services||{},(r=e).Services.Call=r.Services.Call||{},(s=e).Services.Collaboration=s.Services.Collaboration||{},(n=e).Services.Messaging=n.Services.Messaging||{},(o=e).Services.Conference=o.Services.Conference||{},(c=e).Services.Contacts=c.Services.Contacts||{},(l=e).Services.ContentSharing=l.Services.ContentSharing||{},(d=e).Services.Presence=d.Services.Presence||{},(C=e).Services.VoiceMessaging=C.Services.VoiceMessaging||{}}(AvayaClientServices),function(e){"use strict";var t,i,a,r,s,n,o,c,l,d,C,u,v,h,p,_,S,g,f,E,A,P,T,y,b,I,R;(t=e).Base.Validators=t.Base.Validators||{},(i=e).Providers=i.Providers||{},(a=e).Providers.Analytics=a.Providers.Analytics||{},(r=e).Providers.Interfaces=r.Providers.Interfaces||{},(s=e).Providers.AMM=s.Providers.AMM||{},(n=e).Providers.Call=n.Providers.Call||{},(o=e).Providers.CallGateway=o.Providers.CallGateway||{},(c=e).Providers.CallServiceGateway=c.Providers.CallServiceGateway||{},(l=e).Providers.Scopia=l.Providers.Scopia||{},(d=e).Providers.CM=d.Providers.CM||{},(C=e).Providers.Focus=C.Providers.Focus||{},(u=e).Providers.Mpaas=u.Providers.Mpaas||{},(v=e).Providers.RemoteLogger=v.Providers.RemoteLogger||{},(h=e).Providers.RTC=h.Providers.RTC||{},(p=e).Providers.UCCP=p.Providers.UCCP||{},(_=e).Providers.WCS=_.Providers.WCS||{},(S=e).User=S.User||{},(g=e).Services.Call=g.Services.Call||{},(f=e).Services.Call.Capabilities=f.Services.Call.Capabilities||{},(E=e).Services.Call.Modes=E.Services.Call.Modes||{},(A=e).Services.SessionLogs=A.Services.SessionLogs||{},(P=e).Services.Messaging.Common=P.Services.Messaging.Common||{},(T=e).Providers.ACS=T.Providers.ACS||{},(y=e).Services.SessionLogs=y.Services.SessionLogs||{},(b=e).Providers.ContentSharing=b.Providers.ContentSharing||{},(I=e).Services.Analytics=I.Services.Analytics||{},(R=e).Config.Authentication=R.Config.Authentication||{}}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.AbsoluteCategoryRating={EXCELLENT:5,GOOD:4,FAIR:3,POOR:2,BAD:1}}(),function(e){"use strict";function t(e,t){this.pointcutType=e,this.adviceFunction=t}t.prototype={},e.Base.AOPAdvice=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.AOPPointcutType={BEFORE:"BEFORE",AROUND:"AROUND"}}(),function(o){"use strict";var c={addAdvices:function(e,t,i,a){for(var r=0;r<i.length;r++)c.addAdvicesToProperty(e,t,i[r],a)},addAdvicesToProperty:function(e,t,i,a){var r=c._getAdviceFunction(o.Base.AOPPointcutType.BEFORE,a),s=c._getAdviceFunction(o.Base.AOPPointcutType.AROUND,a),n=e.prototype[i];if("function"!=typeof n)throw Error("AOPTools: "+t+"."+i+" is not a function.");e.prototype[i]=function(){return r&&r(e,t,i,arguments),s?s(e,t,i,this,n,arguments):n.apply(this,arguments)}},_getAdviceFunction:function(e,t){for(var i=0;i<t.length;i++)if(t[i].pointcutType===e)return t[i].adviceFunction}};o.Base.AOPTools=c}(AvayaClientServices),function(r){"use strict";function e(e){this._servers=[],this._config=e,this._calls=[],this._currentResolution=r.Base.VideoResolution[this._config.mediaConfiguration.voipConfigurationVideo.videoResolution],this._observationInterval=30,this._historyConsiderationPeriod=6,this._interval=m}e.prototype={registerCall:function(e){this._calls.push(e),this.start()},unregisterCall:function(e){var t=this._calls.indexOf(e);this._calls.splice(t,1)},registerServer:function(e){this._servers.push(e),e._onStop=function(){this._restoreOriginalResolution()}.bind(this),this.start()},start:function(){this._config.mediaConfiguration.voipConfigurationVideo.presentationHigherPriorityThanPeopleVideo&&r.Base.Utils.isUndefined(this._interval)&&(this._interval=setInterval(function(){this.recalculateBandwidth()}.bind(this),1e3*this._observationInterval))},_restoreOriginalResolution:function(){var e=this._calls.filter(function(e){return e.getState()===r.Services.Call.CallStates.ESTABLISHED&&!e.isRemote()})[0];e&&this._currentResolution!==r.Base.VideoResolution[this._config.mediaConfiguration.voipConfigurationVideo.videoResolution]&&(this._currentResolution=r.Base.VideoResolution[this._config.mediaConfiguration.voipConfigurationVideo.videoResolution],r.Base.Logger.info(r.Base.LoggerTags.BANDWIDTH_MANAGER,"Changing resolution back to default: "+this._config.mediaConfiguration.voipConfigurationVideo.videoResolution),e._callService._updateVideoResolution(e,r.Base.VideoResolution[this._config.mediaConfiguration.voipConfigurationVideo.videoResolution]).then(function(e){e?(this._currentResolution=e,r.Base.Logger.info(r.Base.LoggerTags.BANDWIDTH_MANAGER,"Successfully changed video bandwidth to: "+this._currentResolution.getMinBandwidth())):r.Base.Logger.warn(r.Base.LoggerTags.BANDWIDTH_MANAGER,"Successfully set video bandwidth to unknown bandwidth")}.bind(this),function(){try{this._currentResolution=e._callService._callProvider._cpCalls[e._callId].getVideoResolution(),r.Base.Logger.info(r.Base.LoggerTags.BANDWIDTH_MANAGER,"Video bandwidth has been set to: "+this._currentResolution.getMinBandwidth())}catch(e){r.Base.Logger.error(r.Base.LoggerTags.BANDWIDTH_MANAGER,"Could not retrieve current video resolution: "+e)}}.bind(this)))},recalculateBandwidth:function(){var e=8*this.getBufferedBytes()/1e3/this._observationInterval,t=this._calls.filter(function(e){return e.getState()===r.Services.Call.CallStates.ESTABLISHED&&!e.isRemote()})[0];if(0<e&&t){var i=this._currentResolution.getMinBandwidth()-e,a=Object.keys(r.Base.VideoResolution).filter(function(e){return r.Base.VideoResolution[e].getMinBandwidth()<=i})[0];a=r.Base.VideoResolution[a]||r.Base.VideoResolution[r.Config.VideoResolution.RESOLUTION_180p],this._currentResolution!==a&&(this._currentResolution=a,r.Base.Logger.info(r.Base.LoggerTags.BANDWIDTH_MANAGER,"Changing resolution to: "+this._currentResolution.getMinBandwidth()+" due to bandwidth limitation."),t._callService._updateVideoResolution(t,this._currentResolution,!0).then(function(e){e?(this._currentResolution=e,r.Base.Logger.info(r.Base.LoggerTags.BANDWIDTH_MANAGER,"Successfully set video bandwidth to: "+this._currentResolution.getMinBandwidth())):r.Base.Logger.warn(r.Base.LoggerTags.BANDWIDTH_MANAGER,"Successfully set video bandwidth to unknown bandwidth")}.bind(this),function(){try{this._currentResolution=t._callService._callProvider._cpCalls[t._callId].getVideoResolution(),r.Base.Logger.info(r.Base.LoggerTags.BANDWIDTH_MANAGER,"Video bandwidth has been set to: "+this._currentResolution.getMinBandwidth())}catch(e){r.Base.Logger.error(r.Base.LoggerTags.BANDWIDTH_MANAGER,"Could not retrieve current video resolution: "+e)}}.bind(this)))}},getBufferedBytes:function(){return this._servers.map(function(e){return e.getHistory()}).map(function(e){var t=this._historyConsiderationPeriod;return e.length<this._historyConsiderationPeriod&&(t=e.length),e.slice(e.length-t).reduce(function(e,t){return e+Math.max(t.buffered,0)},0)}.bind(this)).reduce(function(e,t){return e+t},0)}},r.Base.BandwidthManager=e}(AvayaClientServices),function(e){"use strict";function t(e,t){Error.call(this,e),this.message=e,this.name="BaseError",this._data=t}(t.prototype=Object.create(Error.prototype)).getMessage=function(){return this.message},t.prototype.getData=function(){return this._data},t.prototype.getName=function(){return this.name},e.Base.BaseError=t}(AvayaClientServices),function(){"use strict";T.ajaxTransport("+binary",function(d){var C;if(window.FormData&&(d.dataType&&"binary"===d.dataType||d.data&&(window.ArrayBuffer&&d.data instanceof ArrayBuffer||window.Blob&&d.data instanceof Blob)))return{send:function(e,t){C=new window.XMLHttpRequest;var i=d.url,a=d.type,r=d.async||!0,s=d.data||null,n=d.username||null,o=d.password||null,c=0;for(var l in C.addEventListener("load",function(){var e={};e[d.dataType]=C.response,t(C.status,C.statusText,e,C.getAllResponseHeaders()),c=0}),C.addEventListener("progress",function(){this.readyState&&this.response&&("function"==typeof d.binaryProgressCallback&&d.binaryProgressCallback(AvayaClientServices.Base.Utils.stringToArrayBuffer(this.response.slice(c))),c=this.responseText.length)},!1),C.addEventListener("readystatechange",function(){this.readyState&&d.keepAliveCallback&&d.keepAliveCallback(this.readyState)}),C.open(a,i,r,n,o),C.overrideMimeType("text/xml; charset=x-user-defined"),e)e.hasOwnProperty(l)&&C.setRequestHeader(l,e[l]);C.responseType="text",C.send(s)},abort:function(){C.abort()}}})}(),function(e){"use strict";AvayaClientServices.Base.BrowserType={CHROME:"chrome",CHROME_EXTENSION:"chrome_extension",FIREFOX:"firefox",FIREFOX_EXTENSION:"moz_extension",IE:"ie",SAFARI:"safari",EDGE:"edge",UNKNOWN:"unknown"}}(),function(e){"use strict";AvayaClientServices.Base.CacheOptions=function(){this.maxElements=m,this.timeToLive=m,this.auditInterval=m}}(),function(e){"use strict";AvayaClientServices.Base.ElementCacheEvents={ELEMENT_ADDED:"ELEMENT_ADDED",ELEMENT_UPDATED:"ELEMENT_UPDATED",ELEMENT_DELETED:"ELEMENT_DELETED"}}(),function(e){"use strict";AvayaClientServices.Base.IMDBSearchOptions={EXACT_MATCH:"EXACT_MATCH",CONTAINS:"CONTAINS",BEGINS_WITH:"BEGINS_WITH"}}(),function(C){"use strict";function e(e,t){this._validateKeyNames(e),this._cache=new C.Base.ElementCache(t),this._cache.on(C.Base.ElementCacheEvents.ELEMENT_DELETED,function(e){this._onCacheElementsDelete(e)}.bind(this)),this._keyToCacheIds={};for(var i=0;i<e.length;i++)this._keyToCacheIds[e[i]]={};this._cacheIdLength=6,this._generateIdFailureCounter=0}e.prototype.addElement=function(e,t){var i=new Date;this._validateKeys(e);var a=this._generateCacheId(),r={keys:e,element:t,cacheId:a};if(!this._cache.addElement(a,r)){var s="SimpleIMDB: Failed to add object to underlying single-key cache. CacheId: "+a;throw C.Base.Logger.error(C.Base.LoggerTags.CACHE,s,r),new Error(s)}this._addCacheIdWithKeys(a,e),C.Base.Logger.info(C.Base.LoggerTags.CACHE,"SimpleIMDB: Successfully added element in "+(new Date-i)+" milliseconds")},e.prototype.addElements=function(e){var t,i=new Date,a=[],r=[],s=this.getCacheMaxSize(),n=e.length,o=(a=s&&s<n?e.slice(-s):e.slice()).length;for(t=0;t<o;t++)try{this._validateKeys(a[t].keys);var c=this._generateCacheId();a[t].elementId=c,r.push({elementId:c,element:a[t]})}catch(e){a.splice(t,1),C.Base.Logger.error(C.Base.LoggerTags.CACHE,"Invalid keys of object",e)}var l=this._cache.addElements(r);for(t=0;t<l.length;t++)this._addCacheIdWithKeys(l[t].elementId,l[t].element.keys);C.Base.Logger.info(C.Base.LoggerTags.CACHE,"SimpleIMDB: Successfully added elements in "+(new Date-i)+" milliseconds")},e.prototype.getCacheMaxSize=function(){return this._cache.getCacheMaxSize()},e.prototype._addCacheIdWithKeys=function(e,t){var i,a;for(i in t)if(t.hasOwnProperty(i)){a=t[i];for(var r=0;r<a.length;r++){this._keyToCacheIds[i][a[r]]===m&&(this._keyToCacheIds[i][a[r]]=[]),this._keyToCacheIds[i][a[r]].push(e)}}},e.prototype.updateElement=function(e,t,i){var a=new Date;this._validateKeys(e),this._validateKeys(t);var r,s=this.searchByKeys(e);if(1<s.length)throw r="SimpleIMDB: Update failed because multiple objects found",C.Base.Logger.error(C.Base.LoggerTags.CACHE,r),new Error(r);if(s.length<1)throw r="SimpleIMDB: Can not find object to update",C.Base.Logger.error(C.Base.LoggerTags.CACHE,r),new Error(r);this.deleteElements(e),this.addElement(t,i),C.Base.Logger.info(C.Base.LoggerTags.CACHE,"Successfully updated element in "+(new Date-a)+" milliseconds")},e.prototype.deleteElements=function(e){for(var t=new Date,i=this._resolveCacheIdsByKeys(e),a=0,r=0;r<i.length;r++){var s=this._cache.getElement(i[r]);s&&(a++,this._cache.deleteElement(i[r])||C.Base.Logger.warn(C.Base.LoggerTags.CACHE,"Failed to delete object with cacheId "+i[r]+" from underlying cache"),s.keys&&this._deleteCacheIdByKeys(i[r],s.keys))}C.Base.Logger.info(C.Base.LoggerTags.CACHE,"Deleted "+a+" element(s) successfully in "+(new Date-t)+" milliseconds")},e.prototype.searchByKeys=function(e,t){for(var i=new Date,a=[],r=this._resolveCacheIdsByKeys(e,t),s=0;s<r.length;s++){var n=this._cache.getElement(r[s]);n&&n.element&&a.push(n.element)}return a=C.Base.Utils.removeDuplicatesFromArray(a),C.Base.Logger.info(C.Base.LoggerTags.CACHE,"Found "+a.length+" results in "+(new Date-i)+" milliseconds"),a},e.prototype.searchBySingleKey=function(e,t,i){var a={};return a[e]=[t],this.searchByKeys(a,i)},e.prototype.searchByAllKeys=function(e,t){var i=new Date,a=[],r=[];for(var s in this._keyToCacheIds)if(this._keyToCacheIds.hasOwnProperty(s)){var n=this._findMatchingValues(s,e,t);if(n)for(var o=0;o<n.length;o++)r=r.concat(this._keyToCacheIds[s][n[o]])}for(var c=0;c<r.length;c++){var l=this._cache.getElement(r[c]);l&&l.element&&a.push(l.element)}return a=C.Base.Utils.removeDuplicatesFromArray(a),C.Base.Logger.info(C.Base.LoggerTags.CACHE,"Found "+a.length+" results in "+(new Date-i)+" milliseconds"),a},e.prototype.getAllElements=function(){return this._cache.getAllElements().map(function(e){return e.element})},e.prototype._deleteCacheIdByKeys=function(e,t){for(var i in t)if(t.hasOwnProperty(i))for(var a=t[i],r=0;r<a.length;r++){var s=this._keyToCacheIds[i][a[r]],n=s.indexOf(e);0<=n&&s.splice(n,1)}},e.prototype._resolveCacheIdsByKeys=function(e,t){this._validateKeys(e);var i,a,r=[];for(var s in e)if(e.hasOwnProperty(s)){a=e[i=s][0];break}var n=this._findMatchingValues(i,a,t),o=[];if(n){for(var c=0;c<n.length;c++)o=o.concat(this._keyToCacheIds[i][n[c]]);for(c=0;c<o.length;c++){var l=o[c],d=this._cache.getElement(l);d?this._areKeys1SubsetOfKeys2(e,d.keys,t)&&r.push(l):C.Base.Logger.warn(C.Base.LoggerTags.CACHE,"Cache object with id "+l+" is not found in underlying single-key cache")}}return r},e.prototype._findMatchingValues=function(e,t,i){return i&&i!==C.Base.IMDBSearchOptions.EXACT_MATCH?Object.keys(this._keyToCacheIds[e]).filter(function(e){return i===C.Base.IMDBSearchOptions.CONTAINS?-1<e.indexOf(t):i===C.Base.IMDBSearchOptions.BEGINS_WITH?0===e.indexOf(t):void 0}):this._keyToCacheIds[e].hasOwnProperty(t)?[t]:void 0},e.prototype._areKeys1SubsetOfKeys2=function(e,t,s){var n=C.Base.IMDBSearchOptions,i=function(e,t){for(var i=0;i<t.length;i++)if(a=e,r=t[i],s&&s!==n.EXACT_MATCH?s===n.CONTAINS?-1<r.indexOf(a):s===n.BEGINS_WITH?0===r.indexOf(a):void 0:r===a)return!0;var a,r;return!1};for(var a in e)if(e.hasOwnProperty(a)){if(!t.hasOwnProperty(a))return!1;for(var r=0;r<e[a].length;r++)if(!i(e[a][r],t[a]))return!1}return!0},e.prototype._validateKeyNames=function(e){if(!e||!(e instanceof Array)||e.length<1)throw new Error('SimpleIMDB: "keyNames" argument is invalid. It should be of Array type and have at least one element. keyNames: '+JSON.stringify(e));for(var t=0;t<e.length;t++)if("string"!=typeof e[t])throw new Error("SimpleIMDB: Cache key name "+JSON.stringify(e[t])+" is not of String type. Type: "+typeof e[t])},e.prototype._validateKeys=function(e){var t,i,a;for(t in e)if(e.hasOwnProperty(t)){if(this._keyToCacheIds[t]===m)throw a="Key name "+t+" is not registered for this IMDB",C.Base.Logger.error(C.Base.LoggerTags.CACHE,a),new Error(a);i=e[t];for(var r=0;r<i.length;r++){var s=i[r];if("string"!=typeof s)throw a="Value "+JSON.stringify(s)+" of key "+t+" is not of string type",C.Base.Logger.error(C.Base.LoggerTags.CACHE,a),new Error(a);if(""===s)throw a="Key "+t+" has empty value",C.Base.Logger.error(C.Base.LoggerTags.CACHE,a),new Error(a)}}},e.prototype._generateCacheId=function(){for(var e,t;!e;)t=C.Base.Utils.makeId(this._cacheIdLength),this._cache.getElement(t)&&++this._generateIdFailureCounter>this._cacheIdLength&&this._cacheIdLength++,e=t;return this._generateIdFailureCounter=0,e},e.prototype._onCacheElementsDelete=function(e){for(var t=0;t<e.length;t++){var i=e[t];i.cacheId&&i.keys?this._deleteCacheIdByKeys(i.cacheId,i.keys):C.Base.Logger.error(C.Base.LoggerTags.CACHE,"Invalid cache object",i)}},C.Base.SimpleIMDB=e}(AvayaClientServices),function(t){"use strict";function e(e){this.isAllowed=e===t.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,this.denialReason=e,this._onChangedCallbacks=T.Callbacks()}e.prototype={addOnChangedCallback:function(e){t.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"function"}]}),this._onChangedCallbacks.add(e)},removeOnChangedCallback:function(e){t.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"function"}]}),this._onChangedCallbacks.remove(e)},_updateIfChanged:function(e,t){this.isAllowed===e&&this.denialReason===t||(this.isAllowed=e,this.denialReason=t,this._onChangedCallbacks.fire(this))}},t.Base.Capability=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.CapabilityDenialReason={CAPABILITY_NOT_DENIED:"CAPABILITY_NOT_DENIED",CAPABILITY_INVALID_STATE:"CAPABILITY_INVALID_STATE",CAPABILITY_NOT_SUPPORTED:"CAPABILITY_NOT_SUPPORTED",CAPABILITY_CALL_IS_REMOTE:"CAPABILITY_CALL_IS_REMOTE",CAPABILITY_CALL_IS_NOT_REMOTE:"CAPABILITY_CALL_IS_NOT_REMOTE",CAPABILITY_CALL_HAS_NO_AUDIO:"CAPABILITY_CALL_HAS_NO_AUDIO",CAPABILITY_CALL_HAS_NO_VIDEO:"CAPABILITY_CALL_HAS_NO_VIDEO",CAPABILITY_NOT_ALLOWED:"CAPABILITY_NOT_ALLOWED",CAPABILITY_NEED_SIGNIN:"CAPABILITY_NEED_SIGNIN",CAPABILITY_NEED_MODERATOR:"CAPABILITY_NEED_MODERATOR",CAPABILITY_NEED_SIGNIN_OR_MODERATOR:"CAPABILITY_NEED_SIGNIN_OR_MODERATOR",CAPABILITY_NOT_INSTALLED:"CAPABILITY_NOT_INSTALLED"}}(),function(t){"use strict";function e(e){this._dataSet=e||new t.Base.DataSet,this._status=t.Base.DataRetrievalStatus.IN_PROGRESS,this.isCancelled=!1,this.isCompleted=!1,this._dataRetrievalProgress=T.Callbacks(),this._dataRetrievalDone=T.Callbacks(),this._dataRetrievalFailed=T.Callbacks(),this._onCancel=m}e.prototype={cancel:function(){this._status===t.Base.DataRetrievalStatus.IN_PROGRESS&&(this._status=t.Base.DataRetrievalStatus.CANCELLED,this.isCancelled=!0,t.Base.Utils.isDefined(this._onCancel)&&this._onCancel())},getDataSet:function(){return this._dataSet},_getStatus:function(){return this._status}},t.Base.DataRetrieval=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Base.DataRetrieval.prototype,{addOnDataRetrievalProgressCallback:function(e){this._dataRetrievalProgress.add(e)},removeOnDataRetrievalProgressCallback:function(e){this._dataRetrievalProgress.remove(e)},addOnDataRetrievalDoneCallback:function(e){this._dataRetrievalDone.add(e)},removeOnDataRetrievalDoneCallback:function(e){this._dataRetrievalDone.remove(e)},addOnDataRetrievalFailedCallback:function(e){this._dataRetrievalFailed.add(e)},removeOnDataRetrievalFailedCallback:function(e){this._dataRetrievalFailed.remove(e)}})}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.DataRetrievalStatus={IN_PROGRESS:"IN_PROGRESS",DONE:"DONE",CANCELLED:"CANCELLED",FAILED:"FAILED"}}(),function(e){"use strict";function t(){Array.apply(this),this.dataSetChangeCallbacks=T.Callbacks(),this.dataSetInvalidatedCallbacks=T.Callbacks()}(t.prototype=Object.create(Array.prototype)).addOnDataSetChangedCallback=function(e){this.dataSetChangeCallbacks.add(e)},t.prototype.removeOnDataSetChangedCallback=function(e){this.dataSetChangeCallbacks.remove(e)},t.prototype.onDataSetChanged=function(e,t){this.dataSetChangeCallbacks.fire(e,t)},t.prototype.addOnDataSetInvalidatedCallback=function(e){this.dataSetInvalidatedCallbacks.add(e)},t.prototype.removeOnDataSetInvalidatedCallback=function(e){this.dataSetInvalidatedCallbacks.remove(e)},t.prototype.onDataSetInvalidated=function(){this.dataSetInvalidatedCallbacks.fire(this)},e.Base.DataSet=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.DataSetChangeTypes={ADDED:"ADDED",REMOVED:"REMOVED",UPDATED:"UPDATED"}}(),function(e){"use strict";AvayaClientServices.Base.DeferredStates={PENDING:"pending",RESOLVED:"resolved",REJECTED:"rejected"}}(),function(e){"use strict";var t={INDETERMINATE:"INDETERMINATE",DETERMINATE:"DETERMINATE"};e.Base.Determinateness=function(e){if(void 0!==t[e])return t[e]}}(AvayaClientServices),function(e){"use strict";function t(){}t.prototype={generateBatteryLogs:function(e){var t=T.Deferred(),i=[];i.push("----------------------------------"),i.push("Version: "+e.applicationBuildNumber);var a="Unknown";return-1!==window.navigator.userAgent.indexOf("Windows NT 10")?a="Windows 10":-1!==window.navigator.userAgent.indexOf("Windows NT 6.2")?a="Windows 8":-1!==window.navigator.userAgent.indexOf("Windows NT 6.1")?a="Windows 7":-1!==window.navigator.userAgent.indexOf("Windows NT 6.0")?a="Windows Vista":-1!==window.navigator.userAgent.indexOf("Windows NT 5.1")?a="Windows XP":-1!==window.navigator.userAgent.indexOf("Windows NT 5.0")?a="Windows 2000":-1!==window.navigator.userAgent.indexOf("Mac")?a="Mac/iOS":-1!==window.navigator.userAgent.indexOf("X11")?a="UNIX":-1!==window.navigator.userAgent.indexOf("Android")?a="Android":-1!==window.navigator.userAgent.indexOf("iPad")?a="iPad":-1!==window.navigator.userAgent.indexOf("iPhone")?a="iPhone":-1!==window.navigator.userAgent.indexOf("Linux")&&(a="Linux"),i.push("Operating system: "+a),navigator.getBattery&&"function"==typeof navigator.getBattery?navigator.getBattery().then(function(e){i.push("Is Battery Charging : "+e.charging),i.push("Battery Level (%) : "+(100*e.level).toFixed(0)+"%"),i.push("----------------------------------"),t.resolve(i)},function(){i.push("Battery Level (%) : Unavailable"),i.push("----------------------------------"),t.resolve(i)}):(i.push("Battery Level (%) : Unavailable"),i.push("----------------------------------"),t.resolve(i)),t.promise()},generateMessagingLogs:function(e){var t=T.Deferred(),i=[];return e?(i.push("Number of active conversations: "+e._messagingService.conversations.length),i.push("Number of active messages: "+e._messagingService.conversations.reduce(function(e,t){return e+t.getTotalMessageCount()},0)),i.push("Number of draft conversations: "+e.getDraftConversations().length),i.push("Number of draft messages: "+e._messagingService.conversations.reduce(function(e,t){return e+t._draftMessages.length},0))):i.push("Messaging module is unavailable."),t.resolve(i),i.push("----------------------------------"),t.promise()},generateContactsLogs:function(e){var t=T.Deferred(),i=[];return e?i.push("Number of contacts in cache: "+e._contactsService._contactsDataSet.length):i.push("Contacts module is unavailable."),i.push("----------------------------------"),t.resolve(i),t.promise()},generateCallLogs:function(e){var t=T.Deferred(),i=[];return e?i.push("Number of calls: "+e.getCallCount()):i.push("Calls module is unavailable."),i.push("----------------------------------"),t.resolve(i),t.promise()},generatePerformanceLogs:function(){var e=T.Deferred(),t=[];return t.push("Request time: "+(window.performance.timing.responseEnd-window.performance.timing.requestStart)+"ms"),t.push("Load time: "+(window.performance.timing.domContentLoadedEventEnd-window.performance.timing.requestStart)+"ms"),t.push("DOM content loaded time: "+(window.performance.timing.domContentLoadedEventEnd-window.performance.timing.domContentLoadedEventStart)+"ms"),t.push("----------------------------------"),window.performance.memory?(t.push("JS Heap Size Limit: "+window.performance.memory.jsHeapSizeLimit),t.push("Total JS Heap Size: "+window.performance.memory.totalJSHeapSize),t.push("Used JS Heap Size: "+window.performance.memory.usedJSHeapSize)):t.push("Memory info is unavailable."),t.push("----------------------------------"),e.resolve(t),e.promise()}},e.Base.DiagnosticDataGenerator=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.ErrorReasons={CAPABILITY_INVALID_STATE:"Service is in invalid state.",CAPABILITY_NOT_SUPPORTED:"Feature is not supported.",CAPABILITY_CALL_IS_REMOTE:"",CAPABILITY_CALL_IS_NOT_REMOTE:"",CAPABILITY_CALL_HAS_NO_AUDIO:"",CAPABILITY_CALL_HAS_NO_VIDEO:"",CAPABILITY_NOT_ALLOWED:"Action is not allowed.",CAPABILITY_NEED_SIGN_IN:"",CAPABILITY_NEED_MODERATOR:"",CAPABILITY_NEED_SIGN_IN_OR_MODERATOR:"",CAPABILITY_NOT_INSTALLED:"Extension is not installed.",NETWORK_ERROR:"Failed to perform operation. Network error occurred.",NETWORK_UNAUTHORIZED:"Failed to perform operation due to authorization failure.",NETWORK_AUTHORIZATION_CANCELED:"Failed to perform operation due to canceled authentication.",NETWORK_CANCELED:"Failed to perform operation. Operation was canceled.",INTERNAL_ERROR:"An internal error occurred.",TIMEOUT:"An operation has timed out",LIBRARY_NOT_SUPPORTED:"Library is not supported.",DEPRECATED:"Use of deprecated API is not recommended as if this function may be removed in the future.",BACKOFF_ALGORITHM_CANCELLED:"Backoff Algorithm canceled."}}(),function(t){"use strict";var e={jQuery:{setHandle:function(e){return t.Base.Library.Service.jQuery.setHandle(e)}}};t.Base.Library=e}(AvayaClientServices),function(a){"use strict";function e(){this._onVersionChangedCallbacks=[]}a.Base.Library.Service={SUPPORT_EXTENT_FULL:0,SUPPORT_EXTENT_COMPATIBLE:1,SUPPORT_EXTENT_NONE:2,jQuery:new e},e.prototype.setHandle=function(e){return!!this._isHandle(e)&&(this._triggerCallbacks(e),!0)},e.prototype.addOnVersionChangedCallback=function(e){e instanceof Function&&this._onVersionChangedCallbacks.push(e)},e.prototype.getSupportExtent=function(){var e=this.getSupportedVersion(),t=this.getCurrentVersion();if(t===e)return a.Base.Library.Service.SUPPORT_EXTENT_FULL;var i=this._parseMajorVersion(e);return this._parseMajorVersion(t)===i?a.Base.Library.Service.SUPPORT_EXTENT_COMPATIBLE:a.Base.Library.Service.SUPPORT_EXTENT_NONE},e.prototype.getSupportedVersion=function(){return"3.3.1"},e.prototype.getCurrentVersion=function(){return T.fn.jquery},e.prototype._isHandle=function(e){return e!==m&&e.fn!==m&&e.fn.jquery!==m&&e.fn.jquery!==this.getCurrentVersion()},e.prototype._triggerCallbacks=function(e){for(var t=0;t<this._onVersionChangedCallbacks.length;++t)this._onVersionChangedCallbacks[t](e)},e.prototype._parseMajorVersion=function(e){return parseInt(e.split(".").shift())}}(AvayaClientServices),function(){"use strict";var i=[];function a(c,e){var l=Array.prototype.slice.call(e,1);l[0]=e[0]+": "+e[1];var d=(new Date).toLocaleString("en");i.forEach(function(e){var t,i,a,r,s,n,o=l.slice();e.disableTimestamps||(o[0]="["+d+"] "+o[0]),"function"==typeof e[c]?(r=e,s=c,n=o,AvayaClientServices.Base.Utils.isDefined(n)&&r[s].apply(r,n)):(t=e,i=c,a=o,AvayaClientServices.Base.Utils.isDefined(a)&&t.log(i,a))})}AvayaClientServices.Base.Logger={info:function(e,t){a("info",arguments)},error:function(e,t){a("error",arguments)},fatal:function(e,t){a("fatal",arguments)},debug:function(e,t){a("debug",arguments)},trace:function(e,t){a("trace",arguments)},warn:function(e,t){a("warn",arguments)},addLogger:function(e,t){if(!e||void 0===e.log)throw new TypeError("Logger should implement log method.");e.disableTimestamps=t,i.push(e)},removeLogger:function(e){var t=i.indexOf(e);if(-1===t)throw new Error("Specified error does not exist.");i.splice(t,1)},clearLoggers:function(){i=[]}}}(),function(){"use strict";function e(){this.disableTimestamps=!1}e.prototype={info:function(e,t){},warn:function(e,t){},error:function(e,t){},fatal:function(e,t){},debug:function(e,t){},trace:function(e,t){}},AvayaClientServices.Base.LoggerInterface=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.LoggerTags={CACHE:"Cache",MEDIA_ENGINE:"MediaEngine",NETWORK_PROVIDER:"NetworkProvider",REST_NETWORK_PROVIDER:"RESTNetworkProvider",WEBSOCKET_NETWORK_PROVIDER:"WebSocketNetworkProvider",RTC_CALL_CONNECTION_PROVIDER:"RTCCallConnectionProvider",BANDWIDTH_MANAGER:"BandwidthManager",FSM:"FSM",SETTINGS_FILE_PARSER:"SettingsFileParser",UTILS:"Utils",ANALYTICS_SERVICE:"AnalyticsService",CALL_SERVICE:"CallService",COLLABORATION_SERVICE:"CollaborationService",CONFERENCE_SERVICE:"ConferenceService",CONTACTS_SERVICE:"ContactsService",MESSAGING_SERVICE:"MessagingService",PRESENCE_SERVICE:"PresenceService",VOICE_MESSAGING_SERVICE:"VoiceMessagingService",USER_SERVICE:"UserService",CHAT_SERVICE:"ChatService",ACS_CONTACTS_PROVIDER:"ACSContactsProvider",AMM_MESSAGING_PROVIDER:"AMMMessagingProvider",ANALYTICS_PROVIDER:"AnalyticsProvider",CALL_PROVIDER:"CallProvider",CALL_GATEWAY_PROVIDER:"CallGatewayProvider",CSG_PRESENCE_AND_CALL_PROVIDER:"CSGPresenceAndCallProvider",CM_CONFERENCE_PROVIDER:"CMConfProvider",CONTENT_SHARING_COLLABORATION_PROVIDER:"ContentSharingCollabProvider",SCOPIA_CONFERENCE_PROVIDER:"ScopiaConfProvider",UCCP_CONFERENCE_PROVIDER:"UCCPConfProvider",WCS_COLLABORATION_PROVIDER:"WCSCollabProvider",WCS_CONTENT_SHARING_HANDLER:"WCSContentSharingHandler",CALL_STATISTICS:"CallStatistics"}}(),function(e){"use strict";function t(e,t,i,a){this._kind=a,this._deviceId=e,this._groupId=t,this._label=i}t.prototype={getDeviceId:function(){return this._deviceId},getGroupId:function(){return this._groupId},getLabel:function(){return this._label},toString:function(){return("audioinput"===this._kind?"Mic":"Speaker")+" [name: "+this._label+"; id: "+this._deviceId+"; groupId: "+this._groupId+"]"}},e.Base.AudioDevice=t}(AvayaClientServices),function(n){"use strict";function e(){this._audioContext=m,this._volume=1,this._mediaStreamContextMap={}}function o(e,t,i){this.gainFilter=e,this.mediaStreamSource=t,this.origAudioTrack=i}e.prototype.stop=function(){this._audioContext&&(this._audioContext.close&&this._audioContext.close(),this._audioContext=m),this._mediaStreamContextMap={}},e.prototype._initAudioContext=function(){var e=window.AudioContext||window.webkitAudioContext;e?n.Base.Utils.isUndefined(this._audioContext)&&(this._audioContext=new e):n.Base.Logger.debug(n.Base.LoggerTags.MEDIA_ENGINE,"Web Audio APIs are unavailable on this browser")},e.prototype.setVolume=function(e){if(1<e||e<0)throw new RangeError("Volume must be a double between 0 and 1");if(this._volume=e,n.Base.Utils.isDefined(this._audioContext))for(var t in this._mediaStreamContextMap)this._mediaStreamContextMap.hasOwnProperty(t)&&(this._mediaStreamContextMap[t].gainFilter.gain.value=this._volume)},e.prototype.getVolume=function(){return this._volume},e.prototype.addMediaStream=function(e){if(n.Base.Logger.debug(n.Base.LoggerTags.MEDIA_ENGINE,"Adding MediaStream to AudioInputVolumeController "+e.id),this._initAudioContext(),n.Base.Utils.isDefined(this._audioContext)){var t=this._audioContext.createGain(),i=this._audioContext.createMediaStreamSource(e);i.connect(t);var a=this._audioContext.createMediaStreamDestination(),r=a.stream;t.connect(a),t.gain.value=this._volume;var s=e.getAudioTracks()[0];e.addTrack(r.getAudioTracks()[0]),s.stop(),e.removeTrack(s),this._mediaStreamContextMap[e.id]=new o(t,i,s)}},e.prototype.removeMediaStream=function(e){if(n.Base.Utils.isDefined(this._audioContext)&&e){n.Base.Logger.debug(n.Base.LoggerTags.MEDIA_ENGINE,"Removing MediaStream from AudioInputVolumeController "+e.id);var t=this._mediaStreamContextMap[e.id];n.Base.Utils.isDefined(t)&&n.Base.Utils.isDefined(t.mediaStreamSource)&&(t.mediaStreamSource.disconnect(),t.gainFilter.disconnect(),n.Base.Logger.debug(n.Base.LoggerTags.MEDIA_ENGINE,"Stopping audio track "+t.origAudioTrack.id),t.origAudioTrack.stop(),delete this._mediaStreamContextMap[e.id])}},n.Base.AudioInputVolumeController=e}(AvayaClientServices),function(s){"use strict";function e(){this._muted=!1,this._volume=1,this._mediaStreamContextMap={},this._selectedDevice=m}e.prototype.stop=function(){this._mediaStreamContextMap={}},e.prototype.playAudioStream=function(e,t){if(e&&0<e.getAudioTracks().length){if(this.isPlaying(e))s.Base.Logger.debug(s.Base.LoggerTags.MEDIA_ENGINE,"Audio track is already playing: "+e.getAudioTracks()[0].id);else{s.Base.Logger.debug(s.Base.LoggerTags.MEDIA_ENGINE,"Playing media stream "+e.id+"  active: "+e.active),e.getAudioTracks().forEach(function(e){s.Base.Logger.debug(s.Base.LoggerTags.MEDIA_ENGINE,"Audio track: id: "+e.id+" enabled: "+e.enabled+" kind: "+e.kind+" label: "+e.label+" muted: "+e.muted+" readyState: "+e.readyState)});var i="audio";s.Base.Utils.getBrowserType()===s.Base.BrowserType.SAFARI&&(i="video");var a=document.createElement(i);a.srcObject=e,a.muted=this._muted||t,a.volume=this._volume,a.autoplay=!0,this._mediaStreamContextMap[e.id]=new s.Base.MediaStreamContext(a),this._selectedDevice&&this._mediaStreamContextMap[e.id].getMediaElement().setSinkId(this._selectedDevice.getDeviceId())}return!0}return!1},e.prototype.stopPlayingAudioStream=function(e,t){if(e){var i=this._mediaStreamContextMap[e.id];if(s.Base.Utils.isDefined(i)){(!s.Base.Utils.isDefined(t)||t)&&this.logStreamChanges(e.getAudioTracks(),"Stopping playing audio for track ");var a=i.getMediaElement(),r=function(){a.pause(),a.srcObject=null};0===a.readyState?a.ondurationchange=r:r(),delete this._mediaStreamContextMap[e.id]}}},e.prototype.isPlaying=function(e){return s.Base.Utils.isDefined(this._mediaStreamContextMap[e.id])},e.prototype.muteStream=function(e){if(e){var t=this._mediaStreamContextMap[e.id];s.Base.Utils.isDefined(t)&&(t.setMediaMuted(!0),t.getMediaElement().muted=!0,this.logStreamChanges(e.getAudioTracks(),"Muted audio output for track "))}},e.prototype.unmuteStream=function(e){if(e){var t=this._mediaStreamContextMap[e.id];s.Base.Utils.isDefined(t)&&(t.setMediaMuted(!1),this._muted||(t.getMediaElement().muted=!1,this.logStreamChanges(e.getAudioTracks(),"Unmuted audio output for track ")))}},e.prototype.logStreamChanges=function(e,t){e&&e[0]&&s.Base.Logger.debug(s.Base.LoggerTags.MEDIA_ENGINE,t+e[0].id)},e.prototype.setVolume=function(e){if(1<e||e<0)throw new RangeError("Volume must be a double between 0 and 1");for(var t in this._mediaStreamContextMap){if(this._mediaStreamContextMap.hasOwnProperty(t))this._mediaStreamContextMap[t].getMediaElement().volume=e}this._volume=e},e.prototype.getVolume=function(){return this._volume},e.prototype.mute=function(){for(var e in this._mediaStreamContextMap){if(this._mediaStreamContextMap.hasOwnProperty(e))this._mediaStreamContextMap[e].getMediaElement().muted=!0}this._muted=!0},e.prototype.unmute=function(){for(var e in this._mediaStreamContextMap)if(this._mediaStreamContextMap.hasOwnProperty(e)){var t=this._mediaStreamContextMap[e];t.isMediaMuted()||(t.getMediaElement().muted=!1)}this._muted=!1},e.prototype.isMuted=function(){return this._muted},e.prototype.onSelectedDeviceChanged=function(e){for(var t in this._selectedDevice=e,this._mediaStreamContextMap){if(this._mediaStreamContextMap.hasOwnProperty(t))this._mediaStreamContextMap[t].getMediaElement().setSinkId(e.getDeviceId())}},s.Base.AudioOutput=e}(AvayaClientServices),function(e){"use strict";function t(e,t){this._audioInterface=e,this._videoInterface=t}t.prototype={getAudioInterface:function(){return this._audioInterface},getVideoInterface:function(){return this._videoInterface}},e.Base.MediaServices=t}(AvayaClientServices),function(i){"use strict";function e(){this._audioInputInterfaceService=m,this._audioOutputInterfaceService=m,this._audioInterface=m,this._videoInterfaceService=m,this._videoInterface=m,this._mediaServices=m,this._mediaServicesService=m}e.prototype={start:function(){return T.when(this.getAudioInterface().start(),this.getVideoInterface().start())},stop:function(){return T.when(this.getAudioInterface().stop(),this.getVideoInterface().stop())},getMediaServices:function(){return this._mediaServices||(this._mediaServices=new i.Base.MediaServices(this.getAudioInterface(),this.getVideoInterface())),this._mediaServices},getMediaServicesService:function(){return this._mediaServicesService||(this._mediaServicesService=new i.Base.MediaServicesService(this.getMediaServices(),this.getAudioInputInterfaceService(),this.getAudioOutputInterfaceService(),this.getVideoInterfaceService(),new i.Base.UserMedia)),this._mediaServicesService},getAudioInputInterfaceService:function(){return this._audioInputInterfaceService||this.getAudioInterface(),this._audioInputInterfaceService},getAudioOutputInterfaceService:function(){return this._audioOutputInterfaceService||this.getAudioInterface(),this._audioOutputInterfaceService},getAudioInterface:function(){if(!this._audioInterface){this._audioInputInterfaceService=new i.Base.AudioInputInterfaceService;var e=new i.Base.AudioInputInterface(this._audioInputInterfaceService);this._audioOutputInterfaceService=new i.Base.AudioOutputInterfaceService;var t=new i.Base.AudioOutputInterface(this._audioOutputInterfaceService);this._audioInterface=new i.Base.AudioInterface(e,t)}return this._audioInterface},getVideoInterfaceService:function(){return this._videoInterfaceService||this.getVideoInterface(),this._videoInterfaceService},getVideoInterface:function(){return this._videoInterface||(this._videoInterfaceService=new i.Base.VideoInterfaceService,this._videoInterface=new i.Base.VideoInterface(this._videoInterfaceService)),this._videoInterface}},i.Base.MediaServicesFactory=e}(AvayaClientServices),function(c){"use strict";function e(e,t,i,a,r){this._userMedia=r,this._audioInputInterfaceService=t,this._audioOutputInterfaceService=i,this._videoInterfaceService=a,this._mediaServices=e}e.prototype={getAudioInputService:function(){return this._audioInputInterfaceService},getAudioOutputService:function(){return this._audioOutputInterfaceService},getVideoInterfaceService:function(){return this._videoInterfaceService},createLocalMediaStream:function(r,s,n,e,t,o,i){return n&&!c.Base.Utils.isDefined(o)?T.Deferred().reject("Undefined videoChannelId"):this._userMedia.getUserMedia(s,n,e,t,!1,i).then(function(e,t,i,a){return this._setDefaultDevices(e),s&&r&&this._audioInputInterfaceService.localMediaStreamCreated(r,e),n&&o&&this._videoInterfaceService.localMediaStreamCreated(o,e),{stream:e,videoResolution:t,cameraAccessDenied:i||!1,cameraDenialReason:a}}.bind(this))},_setDefaultDevices:function(e){var t=e.getAudioTracks()[0];this._setDefaultDevice(t,this._mediaServices.getAudioInterface().getInputInterface());var i=e.getVideoTracks()[0];this._setDefaultDevice(i,this._mediaServices.getVideoInterface()),this._setDefaultOutputDevice(this._mediaServices.getAudioInterface().getOutputInterface())},_setDefaultDevice:function(t,e){if(e.getSelectDeviceCapability().isAllowed&&t&&!e.getSelectedDevice()){var i=e.getAvailableDevices().filter(function(e){return e._label===t.label})[0];i&&e.setSelectedDevice(i)}},_setDefaultOutputDevice:function(e){if(e.getSelectDeviceCapability().isAllowed&&!e.getSelectedDevice()){var t=e.getAvailableDevices().filter(function(e){return"default"===e._deviceId})[0];t&&e.setSelectedDevice(t)}},addVideoTracksToLocalStream:function(e,t,i,a,r){var s=T.Deferred();return c.Base.Utils.isDefined(t)?this._userMedia.addVideoTracksToStream(e,i,a,r).then(function(e){this._videoInterfaceService.localMediaStreamCreated(t,e),s.resolve(e)}.bind(this).bind(t),function(e){s.reject(e)}):s.reject("Undefined videoChannelId"),s},removeLocalVideoTracks:function(e,t){var i=this._videoInterfaceService.getLocalMediaStream(e);if(c.Base.Utils.isDefined(i)){var a=i.getVideoTracks();c.Base.Logger.debug(c.Base.LoggerTags.MEDIA_ENGINE,"removeLocalVideoTracks starting with "+a.length+" tracks.");for(var r=a.length-1;0<=r;r--){var s=a[r],n=a.indexOf(s);-1<n&&(s.stop(),i.removeTrack(s),t&&t.isRTCRtpSenderSupported()&&t.removeIfDoesNotSupportReplaceTrack(s),a.splice(n,1))}a=i.getVideoTracks(),c.Base.Logger.debug(c.Base.LoggerTags.MEDIA_ENGINE,"removeLocalVideoTracks ending with "+a.length+" tracks."),this._videoInterfaceService.removeLocalMediaStream(e)}},getUserMedia:function(){return this._userMedia}},c.Base.MediaServicesService=e}(AvayaClientServices),function(t){"use strict";function e(e){this._selectedDevice=m,this._mediaInterfaceService=e,this._onDevicesAddedCallbacks=T.Callbacks("unique"),this._onDevicesRemovedCallbacks=T.Callbacks("unique"),this._onDevicesUpdatedCallbacks=T.Callbacks("unique"),this._onSelectedDeviceRemovedCallbacks=T.Callbacks("unique"),this._onSelectedDeviceChangedCallbacks=T.Callbacks("unique"),this._notifiedUnavailability=!1,this._onDevicesUnavailable=T.Callbacks("unique"),this._selectDeviceCapability=m,this._mediaAccessCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED)}e.prototype={start:function(){return this._mediaInterfaceService.start(this).then(function(){this._mediaAccessCapability._updateIfChanged(!0,t.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED)}.bind(this),function(e){this._mediaAccessCapability._updateIfChanged(!1,t.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED)}.bind(this))},stop:function(){return this._mediaInterfaceService.stop(this)},setSelectedDevice:function(e){if(!this.getSelectDeviceCapability().isAllowed)throw new Error("Selecting devices is not supported in current browser.");e&&(t.Base.Utils.isUndefined(this._selectedDevice)||e.getDeviceId()!==this._selectedDevice.getDeviceId())&&(t.Base.Logger.info(t.Base.LoggerTags.MEDIA_ENGINE,"New device selected:",e.toString()),this._selectedDevice=e,this._onSelectedDeviceChangedCallbacks.fire(this,this._selectedDevice))},getAvailableDevices:function(){return this._mediaInterfaceService.getAvailableDevices()},hasAvailableDevices:function(){return this._mediaInterfaceService.hasAvailableDevices()},getSelectedDevice:function(){return this._selectedDevice},getSelectDeviceCapability:function(){if(this._selectDeviceCapability===m){var e=t.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED;t.Base.Utils.isWebRTC_SupportedBrowser()&&this._canPickDevices()&&(e=t.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._selectDeviceCapability=new t.Base.Capability(e)}return this._selectDeviceCapability},getMediaAccessCapability:function(){return this._mediaAccessCapability},addOnDevicesAddedCallback:function(e){this._onDevicesAddedCallbacks.add(e)},removeOnDevicesAddedCallback:function(e){this._onDevicesAddedCallbacks.remove(e)},addOnDevicesRemovedCallback:function(e){this._onDevicesRemovedCallbacks.add(e)},removeOnDevicesRemovedCallback:function(e){this._onDevicesRemovedCallbacks.remove(e)},addOnDevicesUpdatedCallback:function(e){this._onDevicesUpdatedCallbacks.add(e)},removeOnDevicesUpdatedCallback:function(e){this._onDevicesUpdatedCallbacks.remove(e)},addOnSelectedDeviceRemovedCallback:function(e){this._onSelectedDeviceRemovedCallbacks.add(e)},removeOnSelectedDeviceRemovedCallback:function(e){this._onSelectedDeviceRemovedCallbacks.remove(e)},addOnDevicesUnavailableCallback:function(e){this._onDevicesUnavailable.add(e)},removeOnDevicesUnavailableCallback:function(e){this._onDevicesUnavailable.remove(e)},addOnSelectedDeviceChangedCallback:function(e){this._onSelectedDeviceChangedCallbacks.add(e)},removeOnSelectedDeviceChangedCallback:function(e){this._onSelectedDeviceChangedCallbacks.remove(e)},_canPickDevices:function(){return!0}},t.Base.MediaInterface=e}(AvayaClientServices),function(n){"use strict";function e(){this._devices=[],this._deviceIdentifier="",this._isStarted=!1,this._observeDevicesInterval=m,this._hasDevices=!1}e.prototype={start:function(e){var t=T.Deferred();return n.Base.Utils.isWebRTC_SupportedBrowser()?(this._isStarted?t.resolve():(this._observeDevicesInterval=setInterval(function(){this._observeDevices(e,t)}.bind(this),1e3),this._observeDevices(e,t)),t.promise()):t.reject(new n.Base.BaseError(n.Base.ErrorReasons.CAPABILITY_NOT_ALLOWED)).promise()},stop:function(e){return this._observeDevicesInterval&&(clearInterval(this._observeDevicesInterval),this._observeDevicesInterval=m),this._isStarted=!1,T.Deferred().resolve().promise()},getAvailableDevices:function(){return this._devices},hasAvailableDevices:function(){return this._hasDevices},_observeDevices:function(t,i){navigator.mediaDevices.enumerateDevices().then(function(e){this._processDevices(t,this._devices,e),this._isStarted||(this._isStarted=!0,i.resolve())}.bind(this))},_processDevices:function(e,t,i){this._scanForAddedDevices(e,t,i),this._scanForRemovedDevices(e,t,i),this._scanForAvailableDevices(e,t,i),this._updateDevicesLabel(e,t,i)},_getAddedDevices:function(r,e){var s=[],t=e.filter(function(e){return e.kind===this._deviceIdentifier}.bind(this));return this._hasDevices=0<t.length,t.forEach(function(t){var e=0<r.filter(function(e){return e.getDeviceId()===t.deviceId}).length,i=0<s.filter(function(e){return e._deviceId===t.deviceId}).length;if(!e&&!i&&t.deviceId){var a=this._buildDevice(t);s.push(a)}}.bind(this)),s},_updateDevicesLabel:function(e,t,i){var a=[];t.filter(function(t){i.forEach(function(e){return t._kind===e.kind&&t.getDeviceId()===e.deviceId&&(t.getLabel()!==e.label&&(t._label=e.label,n.Base.Logger.info(n.Base.LoggerTags.MEDIA_ENGINE,"Device label updated:",t.toString()),a.push(t)),!0)})}),0<a.length&&e._onDevicesUpdatedCallbacks.fire(e,a)},_scanForAddedDevices:function(e,t,i){var a=this._getAddedDevices(t,i);0<a.length&&(a.forEach(function(e){n.Base.Logger.info(n.Base.LoggerTags.MEDIA_ENGINE,"New device added:",e.toString()),t.push(e)}),e._notifiedUnavailability=!1,e._onDevicesAddedCallbacks.fire(e,a))},_scanForAvailableDevices:function(e,t,i){0!==t.length||e._notifiedUnavailability||(n.Base.Logger.info(n.Base.LoggerTags.MEDIA_ENGINE,"Device unavailable:",e.toString()),e._onDevicesUnavailable.fire(e),e._notifiedUnavailability=!0)},_scanForRemovedDevices:function(e,t,i){var a=t.filter(function(t){return 0===i.filter(function(e){return"default"===e.deviceId||"communications"===e.deviceId?t.getDeviceId()===e.deviceId&&t.getLabel()===e.label:t.getDeviceId()===e.deviceId}).length});if(0<a.length){a.forEach(function(e){t.splice(t.indexOf(e),1)});var r=0;if(a.forEach(function(e){e.getDeviceId()&&(r++,n.Base.Logger.info(n.Base.LoggerTags.MEDIA_ENGINE,"Device removed:",e.toString()))}),0<r&&e._onDevicesRemovedCallbacks.fire(e,a),-1<a.indexOf(e.getSelectedDevice())){var s=e._selectedDevice;e._selectedDevice=m,n.Base.Logger.info(n.Base.LoggerTags.MEDIA_ENGINE,"Selected device removed:",s.toString()),e._onSelectedDeviceRemovedCallbacks.fire(e,s)}}},_buildDevice:function(e){throw new Error("Unable to build device")}},n.Base.MediaInterfaceService=e}(AvayaClientServices),function(e){"use strict";function t(e){this.mediaElement=e,this.streamMuted=!1}t.prototype={isMediaMuted:function(){return this.streamMuted},setMediaMuted:function(e){this.streamMuted=e},getMediaElement:function(){return this.mediaElement}},e.Base.MediaStreamContext=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.MediaStreamError={ABORT:"AbortError",NOT_ALLOWED:"NotAllowedError",PERMISSION_DENIED:"PermissionDeniedError",NOT_FOUND:"NotFoundError",NOT_READABLE:"NotReadableError",OVERCONSTRAINED:"OverconstrainedError",SECURITY:"SecurityError",TYPE:"TypeError",DEVICES_NOT_FOUND:"DevicesNotFoundError"}}(),function(e){"use strict";AvayaClientServices.Base.MediaTypes={AUDIO_INPUT:"audioinput",AUDIO_OUTPUT:"audiooutput",VIDEO_INPUT:"videoinput"}}(),function(a){"use strict";function e(){this._audioElement=m,a.Base.AudioOutput.call(this)}(e.prototype=Object.create(a.Base.AudioOutput.prototype)).playAudioStream=function(e,t){if(e&&0<e.getAudioTracks().length){if(this.isPlaying(e))a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"Audio track is already playing: "+e.getAudioTracks()[0].id);else{if(a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"Playing media stream "+e.id+"  active: "+e.active),e.getAudioTracks().forEach(function(e){a.Base.Logger.debug(a.Base.LoggerTags.MEDIA_ENGINE,"Audio track: id: "+e.id+" enabled: "+e.enabled+" kind: "+e.kind+" label: "+e.label+" muted: "+e.muted+" readyState: "+e.readyState)}),a.Base.Utils.isUndefined(this._audioElement)&&(this._audioElement=document.createElement("audio"),this._audioElement.autoplay=!0),0<e.getVideoTracks().length){var i=new MediaStream;e.getAudioTracks().forEach(function(e){i.addTrack(e)}),this._audioElement.srcObject=i}else this._audioElement.srcObject=e;this._audioElement.muted=this._muted||t,this._audioElement.volume=this._volume,this._audioElement.play().then(function(){a.Base.Logger.debug("*** Playing audio stream...")}).catch(function(e){a.Base.Logger.error("Failed to play audio stream",e)}),this._mediaStreamContextMap[e.id]=new a.Base.MediaStreamContext(this._audioElement),this._selectedDevice&&this._mediaStreamContextMap[e.id].getMediaElement().setSinkId(this._selectedDevice.getDeviceId())}return!0}return!1},a.Base.SafariAudioOutput=e}(AvayaClientServices),function(v){"use strict";function e(){this.isAvailable()||v.Base.Logger.info(v.Base.LoggerTags.MEDIA_ENGINE,"UserMedia not available"),this._isChromeBrowser=this._checkIfBrowserIsChrome(),this._supportedConstaints=this.getMediaTrackConstraints()}e.prototype.isAvailable=function(){return!!navigator.mediaDevices&&!!navigator.mediaDevices.getUserMedia},e.prototype.getMediaTrackConstraints=function(){var e={width:!0,height:!0,aspectRatio:!0,frameRate:!0,facingMode:!0,volume:!0,sampleRate:!0,sampleSize:!0,echoCancellation:!0,autoGainControl:!0,noiseSuppression:!0,latency:!0,channelCount:!0,deviceId:!0,groupId:!0};return navigator.mediaDevices&&navigator.mediaDevices.getSupportedConstraints?(e=navigator.mediaDevices.getSupportedConstraints(),v.Base.Logger.debug(v.Base.LoggerTags.MEDIA_ENGINE,"supportedConstraints: ",e)):v.Base.Logger.debug(v.Base.LoggerTags.MEDIA_ENGINE,"navigator.mediaDevices.getSupportedConstraints is not available.  Assuming browser supports all constraints."),e},e.prototype.getUserMedia=function(e,t,i,a,r,s){var n=T.Deferred();if(this.isAvailable()){var o=this._createAudioConstraints(e,i),c=[];t&&(c=this._createVideoConstraintList(s,a)),this._getUserMediaWithConstraints(n,o,c,r)}else n.reject(new v.Services.Call.CallException(v.Services.Call.CallError.WEBRTC_NOT_SUPPORTED));return n.promise()},e.prototype._getUserMediaWithConstraints=function(e,t,i,a,r,s){v.Base.Utils.getBrowserType()===v.Base.BrowserType.SAFARI?this._getSafariUserMediaWithConstraints(e,t,i,a,r,s):this._getGenericUserMediaWithConstraints(e,t,i,a,r)},e.prototype._getGenericUserMediaWithConstraints=function(a,r,s,n,o){var e=s.shift(),c=this._buildMediaConstraints(r,e);n&&(c.fake=!0);var l=e?e.resolution:m;c.video?v.Base.Logger.debug(v.Base.LoggerTags.MEDIA_ENGINE,"Entering getUserMedia for Audio and Video",l):c.audio&&v.Base.Logger.debug(v.Base.LoggerTags.MEDIA_ENGINE,"Entering getUserMedia for Audio only");var d=function(e,t,i){v.Base.Logger.debug(v.Base.LoggerTags.MEDIA_ENGINE,"Resolving getUserMedia dfd"),!c.video||e.getVideoTracks().length?a.resolve(e,l,t,i):c.video?this._getUserMediaErrorHandler(a,r,s,n,o,{name:"NotFoundError",message:"No video tracks",constraintName:"OverConstrainedError"}):a.resolve(e,l,t,i)}.bind(this);v.Base.Logger.debug(v.Base.LoggerTags.MEDIA_ENGINE,"getUserMedia with mediaOptions "+JSON.stringify(c)),navigator.mediaDevices.getUserMedia(c).then(d,function(e){if(e.name===v.Base.MediaStreamError.NOT_ALLOWED||e.name===v.Base.MediaStreamError.PERMISION_DENIED||e.name===v.Base.MediaStreamError.NOT_READABLE){var t=e.name;if(c.audio&&c.video)c.video=!1,v.Base.Logger.warn(v.Base.LoggerTags.MEDIA_ENGINE,"Running audio only constraints fallback: ",e.message),v.Base.Logger.warn(v.Base.LoggerTags.MEDIA_ENGINE,"Running audio only constraints fallback using ",c),navigator.mediaDevices.getUserMedia(c).then(function(e){d(e,!0,t)},function(e){v.Base.Logger.warn(v.Base.LoggerTags.MEDIA_ENGINE,"Failed audio only constraints: ",e),this._getUserMediaErrorHandler(a,r,s,n,o,e)}.bind(this));else{v.Base.Logger.warn(v.Base.LoggerTags.MEDIA_ENGINE,"Failed to add audio or video track due to device permission denied");var i=c.video?v.Services.Call.CallError.CAMERA_PERMISSION_DENIED:v.Services.Call.CallError.MICROPHONE_PERMISSION_DENIED;a.reject(new v.Services.Call.CallException(i))}}else c.video?this._getUserMediaErrorHandler(a,r,s,n,o,e):a.reject(new v.Services.Call.CallException(v.Services.Call.CallError.MEDIA_CREATION_FAILURE))}.bind(this)).catch(function(e){c.video?this._getUserMediaErrorHandler(a,r,s,n,o,e):a.reject(new v.Services.Call.CallException(v.Services.Call.CallError.MEDIA_CREATION_FAILURE))}.bind(this))},e.prototype._getSafariUserMediaWithConstraints=function(a,r,s,n,o,c){var t=s.shift(),l=this._buildMediaConstraints(r,t);n&&(l.fake=!0);var i=function(){var i=t?t.resolution:m,e=function(t){v.Base.Logger.debug(v.Base.LoggerTags.MEDIA_ENGINE,"Resolving getUserMedia dfd"),c&&c.getTracks().forEach(function(e){t.addTrack(e)}),a.resolve(t,i)}.bind(this);if(l.video)v.Base.Logger.debug(v.Base.LoggerTags.MEDIA_ENGINE,"Entering getUserMedia for Audio and Video",i);else if(l.audio)return v.Base.Logger.debug(v.Base.LoggerTags.MEDIA_ENGINE,"Entering getUserMedia for Audio only"),void a.resolve(c,i);v.Base.Logger.debug(v.Base.LoggerTags.MEDIA_ENGINE,"getUserMedia with mediaOptions "+JSON.stringify(l)),l.audio=!1,navigator.mediaDevices.getUserMedia(l).then(e,function(e){if(e.name===v.Base.MediaStreamError.NOT_ALLOWED||e.name===v.Base.MediaStreamError.PERMISION_DENIED)if(v.Base.Logger.info(v.Base.LoggerTags.MEDIA_ENGINE,"Camera permission denied"),c){a.resolve(c,i,!0)}else{var t=l.video?v.Services.Call.CallError.CAMERA_PERMISSION_DENIED:v.Services.Call.CallError.MICROPHONE_PERMISSION_DENIED;a.reject(new v.Services.Call.CallException(t))}else l.video?this._getUserMediaErrorHandler(a,r,s,n,o,e,c):a.reject(new v.Services.Call.CallException(v.Services.Call.CallError.MEDIA_CREATION_FAILURE))}.bind(this))}.bind(this);if(v.Base.Utils.isUndefined(c)&&l.audio){var e={audio:l.audio};navigator.mediaDevices.getUserMedia(e).then(function(e){c=e,i()},function(e){e.name===v.Base.MediaStreamError.NOT_ALLOWED||e.name===v.Base.MediaStreamError.PERMISION_DENIED?(v.Base.Logger.warn(v.Base.LoggerTags.MEDIA_ENGINE,"Failed to allocate audio track due to device permission denied"),a.reject(new v.Services.Call.CallException(v.Services.Call.CallError.MICROPHONE_PERMISSION_DENIED))):(v.Base.Logger.warn(v.Base.LoggerTags.MEDIA_ENGINE,"Failed to allocate audio track: "+e),a.reject(new v.Services.Call.CallException(v.Services.Call.CallError.MEDIA_CREATION_FAILURE)))})}else i()},e.prototype._getUserMediaErrorHandler=function(e,t,i,a,r,s,n){return s.name===v.Base.MediaStreamError.DEVICES_NOT_FOUND?(v.Base.Logger.error(v.Base.LoggerTags.MEDIA_ENGINE,"getUserMedia error: ",s),void e.reject(new v.Services.Call.CallException(v.Services.Call.CallError.DEVICES_NOT_FOUND))):s.message&&s.message.includes("Failed to allocate")?(v.Base.Logger.error(v.Base.LoggerTags.MEDIA_ENGINE,"getUserMedia error: ",s),void((r=r||0)<2?(r++,setTimeout(function(){this._getUserMediaWithConstraints(e,t,i,a,r,n)}.bind(this),1e3)):e.reject(new v.Services.Call.CallException(v.Services.Call.CallError.MEDIA_CREATION_FAILURE)))):(v.Base.Logger.warn(v.Base.LoggerTags.MEDIA_ENGINE,"Running constraints fallback: ",s),void this._getUserMediaWithConstraints(e,t,i,a,r,n))},e.prototype.addVideoTracksToStream=function(e,i,t,a){var r=T.Deferred(),s=i.getVideoTracks();return v.Base.Logger.debug(v.Base.LoggerTags.MEDIA_ENGINE,"addVideoTracksToStream starting with "+s.length+" tracks."),this.getUserMedia(!1,!0,m,e,!1,t).then(function(e){if(e){var t=e.getVideoTracks();v.Base.Logger.debug(v.Base.LoggerTags.MEDIA_ENGINE,"addVideoTracksToStream got new stream with "+t.length+" tracks."),e.getTracks().forEach(function(e){e.kind===v.Providers.Call.CallProvider.Constants.VIDEO_TRACK&&(v.Base.Logger.debug(v.Base.LoggerTags.MEDIA_ENGINE,"addVideoTracksToStream added a track."+e.id),i.addTrack(e),a&&a.isRTCRtpSenderSupported()?a.replaceLocalMediaTrack(e,i).then(function(){r.resolve(i)},function(e){r.reject(new v.Services.Call.CallException(v.Services.Call.CallError.MEDIA_CREATION_FAILURE))}):r.resolve(i))})}else r.reject(new v.Services.Call.CallException(v.Services.Call.CallError.MEDIA_CREATION_FAILURE))},function(e){r.reject(e)}),r},e.prototype.createRTCConstraints=function(e,t,i,a,r,s){var n={};return e&&(r?this._isChromeBrowser?n.audio={optional:[{sourceId:r}]}:n.audio={deviceId:{exact:r}}:n.audio=!0),t&&(180===a.getHeight()?n.video={width:{max:a.getWidth()},height:{max:a.getHeight()}}:n.video={width:a.getWidth(),height:a.getHeight()},i&&(n.video.frameRate={min:a.getFPS()},v.Base.Utils.getBrowserType()===v.Base.BrowserType.FIREFOX&&360<=a.getHeight()&&a.getHeight()<=480&&(n.video.width=640,n.video.height=360)),v.Base.Utils.isDefined(s)&&(n.video.deviceId={exact:s})),n},e.prototype._buildMediaConstraints=function(e,t){var i={};return i.audio=e||!1,i.video=!!t&&t.constraints,i},e.prototype._createAudioConstraints=function(e,t){return!!e&&(!t||(this._isChromeBrowser?{optional:[{sourceId:t}]}:{deviceId:{exact:t}}))},e.prototype._createVideoConstraintList=function(a,r){var s=[],n=[],o=function(e,t){var i={resolution:e,constraints:{width:{exact:e.getWidth()},height:{exact:e.getHeight()}}};return r&&(i.constraints.deviceId={exact:r}),t?i.constraints.frameRate={min:t}:(i.resolution._fps=m,v.Base.Utils.getBrowserType()===v.Base.BrowserType.SAFARI&&(i.constraints.width=e.getWidth(),i.constraints.height=e.getHeight())),i};Object.keys(v.Base.VideoResolution).filter(function(e){var t=v.Base.VideoResolution[e];if(t&&t.getHeight()<=a.getHeight()){var i=30;480===t.getHeight()&&25<=a.getFPS()&&(i=25),s.push(o(t,i)),n.push(o(t))}});var e=s.concat(n);if(v.Base.Utils.getBrowserType()===v.Base.BrowserType.EDGE||v.Base.Utils.getBrowserType()===v.Base.BrowserType.SAFARI){var t={resolution:a,constraints:{width:{ideal:a.getWidth()},height:{ideal:a.getHeight()}}};e.push(t)}else{var i={resolution:a,constraints:{width:{max:a.getWidth()},height:{max:a.getHeight()}}};e.push(i)}return e},e.prototype.createRTCVideoConstraints=function(e,t){var i={};return 180===e.getHeight()?i.video={width:{max:e.getWidth()},height:{max:e.getHeight()}}:v.Base.Utils.getBrowserType()===v.Base.BrowserType.FIREFOX&&360<=e.getHeight()&&e.getHeight()<=480?i.video={width:640,height:360}:i.video={width:e.getWidth(),height:e.getHeight()},t&&(i.deviceId={exact:t}),i},e.prototype._constraintsFallback=function(e,t,i,a,r,s,n,o,c,l){if(t||n||s!==v.Base.VideoResolution.resolution180p){var d,C=T.map(v.Base.VideoResolution,function(e){return e}),u=C.indexOf(s);if(u+1<C.length)d=C[u+1];else if(n)n=!1,d=o;else{if(!e||!t)return void c.reject(l);t=!1}this.getUserMedia(e,t,i,a,r,d,n,o,c)}else c.reject(l)},e.prototype.adjustVideoResolution=function(e,t){if(e&&t&&!(t.getMinBandwidth()<=e)){var i=T.map(v.Base.VideoResolution,function(e){return e}),a=i.indexOf(t);-1===a&&(a=0);for(var r=a;r<i.length;r++)if(i[r].getMinBandwidth()<=e&&i[r].getMaxBandwidth()>e)return i[r];return v.Base.VideoResolution.resolution180p}},e.prototype.adjustVideoResolutionForDimensions=function(e,t,i){var a=T.map(v.Base.VideoResolution,function(e){return e}),r=a.indexOf(i);-1===r&&(r=0);for(var s=r;s<a.length;s++)if((v.Base.Utils.isUndefined(t)||0===t||a[s].getWidth()<=t)&&(v.Base.Utils.isUndefined(e)||0===e||a[s].getHeight()<=e))return a[s];return v.Base.VideoResolution.resolution180p},e.prototype.updateStreamUsingApplyConstraints=function(r,s,n,o,c){c=c||T.Deferred();var e=v.Base.UserMedia.prototype.createRTCVideoConstraints(s,o);return r.applyConstraints(e).then(function(){n._updateVideoResolution(s),c.resolve()},function(e){var t,i=T.map(v.Base.VideoResolution,function(e){return e}),a=i.indexOf(s);a+1<i.length?t=i[a+1]:c.reject(e),this.updateStreamUsingApplyConstraints(r,t,n,o,c)}.bind(this)),c.promise()},e.prototype._checkIfBrowserIsChrome=function(){var e=v.Base.Utils.getBrowserType();return e===v.Base.BrowserType.CHROME||e===v.Base.BrowserType.CHROME_EXTENSION},v.Base.UserMedia=e}(AvayaClientServices),function(a){"use strict";function e(e,t,i){this._kind=a.Base.MediaTypes.VIDEO_INPUT,this._deviceId=e,this._groupId=t,this._label=i}e.prototype={getDeviceId:function(){return this._deviceId},getGroupId:function(){return this._groupId},getLabel:function(){return this._label},toString:function(){return"Camera device [name: "+this._label+"; id: "+this._deviceId+"; groupId: "+this._groupId+"]"}},a.Base.VideoDevice=e}(AvayaClientServices),function(t){"use strict";function e(e){t.Base.MediaInterface.call(this,e),this._videoInterfaceService=e}(e.prototype=Object.create(t.Base.MediaInterface.prototype)).getRemoteMediaStream=function(e){if(this._mediaAccessCapability.isAllowed)return this._videoInterfaceService.getRemoteMediaStream(e);throw new Error("VideoInterface.getRemoteMediaStream(): Capability not allowed")},e.prototype.getLocalMediaStream=function(e){if(this._mediaAccessCapability.isAllowed)return this._videoInterfaceService.getLocalMediaStream(e);throw new Error("VideoInterface.getLocalMediaStream(): Capability not allowed")},e.prototype.toString=function(){return"Camera"},t.Base.VideoInterface=e}(AvayaClientServices),function(t){"use strict";function e(){t.Base.MediaInterfaceService.call(this),this._deviceIdentifier=t.Base.MediaTypes.VIDEO_INPUT,this._localStreamMap={},this._remoteStreamMap={},this._currentChannelId=1}(e.prototype=Object.create(t.Base.MediaInterfaceService.prototype))._buildDevice=function(e){return new t.Base.VideoDevice(e.deviceId,e.groupId,e.label)},e.prototype.createVideoChannel=function(){return this._currentChannelId++},e.prototype.getRemoteMediaStream=function(e){return this._remoteStreamMap[e]},e.prototype.getLocalMediaStream=function(e){return this._localStreamMap[e]},e.prototype.setRemoteMediaStream=function(e,t){this._remoteStreamMap[e]=t},e.prototype.localMediaStreamCreated=function(e,t){0<t.getVideoTracks().length&&(this._localStreamMap[e]=t)},e.prototype.removeMediaStreams=function(e){delete this._localStreamMap[e],delete this._remoteStreamMap[e]},e.prototype.removeLocalMediaStream=function(e){delete this._localStreamMap[e]},e.prototype.removeRemoteMediaStream=function(e){delete this._remoteStreamMap[e]},e.prototype.replaceLocalMediaStream=function(e,t){this._localStreamMap.hasOwnProperty(e)&&(this._localStreamMap[e]=t)},t.Base.VideoInterfaceService=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.NetworkErrorCodes={HTTP_REDIRECTION:300,HTTP_MOVED_PERMANENTLY:301,HTTP_FOUND:302,HTTP_SEE_OTHER:303,HTTP_NOT_MODIFIED:304,HTTP_USE_PROXY:305,HTTP_TEMPORARY_REDIRECT:307,HTTP_PERMANENT_REDIRECT:308,HTTP_BAD_REQUEST:400,HTTP_UNAUTHORIZED:401,HTTP_PAYMENT_REQUIRED:402,HTTP_FORBIDDEN:403,HTTP_NOT_FOUND:404,HTTP_METHOD_NOT_ALLOWED:405,HTTP_NOT_ACCEPTABLE:406,HTTP_PROXY_AUTHENTICATION_REQUIRED:407,HTTP_REQUEST_TIMEOUT:408,HTTP_CONFLICT:409,HTTP_GONE:410,HTTP_LENGTH_REQUIRED:411,HTTP_PRECONDITION_FAILED:412,HTTP_PAYLOAD_TO_LARGE:413,HTTP_URI_TOO_LONG:414,HTTP_UNSUPPORTED_MEDIA_TYPE:415,HTTP_RANGE_NOT_SATISFIABLE:416,HTTP_EXPECTATION_FAILED:417,HTTP_MISDIRECTED_REQUEST:421,HTTP_UNPROCESSABLE_ENTITY:422,HTTP_LOCKED:423,HTTP_FAILED_DEPENDENCY:424,HTTP_UPGRADE_REQUIRED:426,HTTP_PRECONDITION_REQUIRED:428,HTTP_TOO_MANY_REQUESTS:429,HTTP_REQUEST_HEADERS_TOO_LARGE:431,HTTP_NGINX_NO_RESPONSE:444,HTTP_UNAVAILABLE_FOR_LEGAL:451,HTTP_NGINX_SSL_CERTIFICATE_ERROR:495,HTTP_NGINX_SSL_CERTIFICATE_REQUIRED:496,HTTP_NGINX_HTTP_TO_HTTPS:444,HTTP_NGINX_CLIENT_CLOSED_REQUEST:499,HTTP_INTERNAL_SERVER_ERROR:500,HTTP_NOT_IMPLEMENTED:501,HTTP_BAD_GATEWAY:502,HTTP_SERVICE_UNAVAILABLE:503,HTTP_GATEWAY_TIMEOUT:504,HTTP_NETWORK_AUTHENTICATION_REQUIRED:511,HTTP_NETWORK_ERROR:400001,WEBSOCKET_CLOSE_NORMAL:1e3,WEBSOCKET_UNAUTHORIZED:1006}}(),function(i){"use strict";function e(e,t,i,a,r){this._retryHelper=e,this._deferred=t,this._status=i,this._responseText=a,this._retryAfter=this._parseRetryAfter(r)}e.prototype={getRequestRetryHelper:function(){return this._retryHelper},getStatus:function(){return this._status},getResponseText:function(){return this._responseText},getDeferred:function(){return this._deferred},getRetryAfter:function(){return this._retryAfter},_parseRetryAfter:function(e){if(i.Base.Utils.isDefined(e)&&null!==e){var t=parseInt(e);return isNaN(t)?new Date(e)-new Date:1e3*t}}},i.Base.NetworkErrorEvent=e}(AvayaClientServices),function(c){"use strict";function e(e){this._parentLoggerTag=e,this._blackList=[],this._disableOptionsLogging=!1}e.prototype.registerBlackList=function(e){this._blackList=e},e.prototype.logSendMessage=function(e,t,i){var a=["PROVIDER:",i.type],r=t;if(i.type&&i.type!==c.Base.ProviderTypes.WEB_SOCKET_PROVIDER){r=T.extend({},i.defaultOptions,t);var s=i._getServerURL(r);a.push("URL:",s)}if(e instanceof ArrayBuffer)a.push("BYTES SENT:",e.byteLength);else{var n;try{n=this._generateLoggedMessage(e)}catch(e){n="Failed to generate sent message "+e}a.push("\nMESSAGE SENT:",n)}if(!this._disableOptionsLogging){var o;try{o=this._generateLoggedMessage(r)}catch(e){o="Failed to generate sent options "+e}a.push("\nOPTIONS SENT:",o)}this._log(c.Base.Logger.debug,a)},e.prototype.logRecvMessage=function(e,t){if(e.data instanceof ArrayBuffer)this._log(c.Base.Logger.debug,"BYTE LENGTH RECEIVED:",e.data.byteLength);else{var i;try{i=this._generateLoggedMessage(e)}catch(e){i="Failed to generate received message "+e}if(t&&t.getAllResponseHeaders){var a=t.getAllResponseHeaders();this._log(c.Base.Logger.debug,"\nMESSAGE RECEIVED:",i,"\nHEADERS RECEIVED:",a)}else this._log(c.Base.Logger.debug,"\nMESSAGE RECEIVED:",i)}},e.prototype.disableOptionsLogging=function(e){this._disableOptionsLogging=e},e.prototype._generateLoggedMessage=function(e){if(e){var i;if("string"==typeof(e=e.data||e)){var t=this._blackList.join("|");if(this._isXML(e)){var a=new RegExp("("+t+')="(.*?)"',"mig");i=e.replace(a,'$1="REMOVED"'),this._blackList.reduce(function(e,t){return-1<i.indexOf("<"+t)&&e.push(t),e},[]).forEach(function(e){var t=new RegExp("(?:(<"+e+"(?:[\\s\\S]*?))(\\/>))|(?:(<"+e+"(?:[\\s\\S]*?)>)([\\s\\S]*?)(</"+e+">))","mig");i=i.replace(t,"$1$2$3$5")})}else if(this._isJSON(e))i=JSON.parse(e),this._removeFromObject(i),i=JSON.stringify(i,m,2);else{var r=new RegExp("((?:"+t+")=)(.*?)([&]|$)","mig");i=e.replace(r,"$1REMOVED$3")}}else e instanceof Uint8Array?i="Uint8Array["+e.length+"]":"object"==typeof e&&(i=T.extend(!0,{},e),this._removeFromObject(i),i=JSON.stringify(i,m,2));return i}},e.prototype._isXML=function(e){return 0===(e=e.trim()).indexOf("<?xml")},e.prototype._isJSON=function(e){return 0===(e=e.trim()).indexOf("{")||0===e.indexOf("[")},e.prototype._removeFromObject=function(i){Object.keys(i).forEach(function(e){if(this._removeFromLogs(e))i[e]="REMOVED";else if("string"!=typeof i[e]&&null!==i[e]&&Object.keys(i[e]).length)this._removeFromObject(i[e]);else if("string"==typeof i[e]&&this._isJSON(i[e]))try{var t=JSON.parse(i[e]);this._removeFromObject(t),i[e]=JSON.stringify(t)}catch(e){}}.bind(this))},e.prototype._removeFromLogs=function(e){return-1<this._blackList.indexOf(e)},e.prototype._log=function(e){var t=Array.prototype.slice.call(arguments,1);t.unshift(this._parentLoggerTag),e.call(m,c.Base.LoggerTags.NETWORK_PROVIDER,t)},c.Base.NetworkLogger=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.NetworkProviderEvents={UNAUTHORIZED:"UNAUTHORIZED",AUTHORIZED:"AUTHORIZED",RETRYING:"RETRYING"}}(),function(e){"use strict";function t(e){this._retryCallback=e,this._retryCounter=0}t.prototype={getRetryCallback:function(){return this._retryCallback},getRetryCounter:function(){return this._retryCounter},incrementCounter:function(){this._retryCounter++}},e.Base.NetworkRequestRetryHelper=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.ProvidersEventTypes={PING:"Ping"}}(),function(i){"use strict";function e(e,t){i.Base.BaseError.call(this,e,t),this.name="NetworkError"}e.prototype=Object.create(i.Base.BaseError.prototype),i.Base.NetworkError=e}(AvayaClientServices),function(e){"use strict";function t(){this._listeners={}}t.prototype={on:function(e,t){return"function"!=typeof t||(this._listeners[e]=this._listeners[e]||[],this._listeners[e].push(t)),this},off:function(e,t){if("function"!=typeof t)return this;if(this._listeners[e]===m)throw new Error("There is no such handler for event with name: "+e+".");var i=this._listeners[e].indexOf(t);if(-1===i)throw new Error("There is no such handler for event with name: "+e+".");return this._listeners[e].splice(i,1),this},trigger:function(e,i){var t=this._listeners[e];t!==m&&(i=i||[],T.each(t,function(e,t){t.apply(window,i)}))},hasListeners:function(e){var t=this._listeners[e];return t!==m&&t.length},_removeListeners:function(){for(var e in this._listeners)if(this._listeners.hasOwnProperty(e))for(var t=0;t<this._listeners[e].length;t++)this.off(e,this._listeners[e][t])}},e.Base.Observable=t}(AvayaClientServices),function(e){"use strict";function t(){}t.prototype={state:function(){},always:function(e){},done:function(e){},fail:function(e){},progress:function(e){},then:function(e,t,i){}},e.Base.Promise=t}(AvayaClientServices),function(r){"use strict";function e(){this.messagingProviders=[],this.conferenceProviders=[],this.callProviders=[],this.collaborationProviders=[],this._ammProviderFactory={},this._ammProvider={},this._wcsProviderFactory={},this._wcsProvider={},this._contactsProviders=[],this._directorySearchProviders=[],this._acsProviderFactory={},this._acsContactsProvider={},this._acsDirectorySearchProvider={},this._presenceProviders=[],this._csgProviderFactory={},this._csgPresenceProvider={},this._scopiaProvider={},this._sgCallProvider={},this._scopiaConferenceProviderFactory={},this._rtcConnectionProviderFactory={},this._remoteLoggerProvider=m}e.prototype={getMessagingProviders:function(e){if(0<this.messagingProviders.length)return this.messagingProviders;var t=this._getAMMProvider(this._getAMMProviderConfiguration(e));return T.isEmptyObject(t)||this.messagingProviders.push(t),this.messagingProviders},getContactsProviders:function(e){if(0===this._contactsProviders.length){var t=this._getACSContactsProvider();T.isEmptyObject(t)||this._contactsProviders.push(t)}return this._contactsProviders},_getACSContactsProvider:function(){return T.isEmptyObject(this._acsContactsProvider)&&(T.isEmptyObject(this._acsProviderFactory)&&(this._acsProviderFactory=new r.Providers.ACS.ACSProviderFactory),this._acsContactsProvider=this._acsProviderFactory.getACSContactsProvider()),this._acsContactsProvider},getDirectorySearchProviders:function(e){if(0===this._directorySearchProviders.length){var t=this._getACSDirectorySearchProvider();T.isEmptyObject(t)||this._directorySearchProviders.push(t)}return this._directorySearchProviders},_getACSDirectorySearchProvider:function(){return T.isEmptyObject(this._acsDirectorySearchProvider)&&(T.isEmptyObject(this._acsProviderFactory)&&(this._acsProviderFactory=new r.Providers.ACS.ACSProviderFactory),this._acsDirectorySearchProvider=this._acsProviderFactory.getACSDirectorySearchProvider()),this._acsDirectorySearchProvider},getPresenceProviders:function(e){if(0===this._presenceProviders.length){var t=this._getCSGPresenceProvider(e);T.isEmptyObject(t)||this._presenceProviders.push(t)}return this._presenceProviders},_getCSGPresenceProvider:function(e){return T.isEmptyObject(this._csgPresenceProvider)&&(this._csgPresenceProvider=this._getCSGProviderFactory().getCSGPresenceProvider(e)),this._csgPresenceProvider},getConferenceProviders:function(e){if(0<this.conferenceProviders.length)return this.conferenceProviders;var t=this._getScopiaConferenceProvider(e.uccpConfiguration);return T.isEmptyObject(t)||this.conferenceProviders.push(t),this.conferenceProviders},getCallProviders:function(e,t,i){if(0<this.callProviders.length)return this.callProviders;if(e.sgConfiguration===m||r.Base.Utils.isBool(e.sgConfiguration.enabled)){var a=this._getSGCallProvider(e.sgConfiguration,t,i);T.isEmptyObject(a)||this.callProviders.push(a)}return this.callProviders},getVoiceMessagingProvider:function(e){var t,i=e.networkProviderConfiguration.restConfig;t=i.isSecure?r.Base.Utils.isDefined(i.port)?i.port:"443":r.Base.Utils.isDefined(i.port)?i.port:"80";var a=i.hostName+":"+t;return this._getCSGProviderFactory().getCSGCallsProvider(a)},_getAMMProvider:function(e){return T.isEmptyObject(this._ammProvider)&&(T.isEmptyObject(this._ammProviderFactory)&&(this._ammProviderFactory=new r.Providers.AMM.AMMProviderFactory),this._ammProvider=this._ammProviderFactory.getAMMProvider(e)),this._ammProvider},_getWCSProvider:function(e){return T.isEmptyObject(this._wcsProvider)&&(T.isEmptyObject(this._wcsProviderFactory)&&(this._wcsProviderFactory=new r.Providers.WCS.WCSProviderFactory),this._wcsProvider=this._wcsProviderFactory.getWCSProvider(e)),this._wcsProvider},_getWCSProviderConfiguration:function(e){return e.wcsConfiguration},_getScopiaConferenceProvider:function(e){return T.isEmptyObject(this._scopiaProvider)&&(T.isEmptyObject(this._scopiaConferenceProviderFactory)&&(this._scopiaConferenceProviderFactory=new r.Providers.Scopia.ScopiaConferenceProviderFactory),this._scopiaProvider=this._scopiaConferenceProviderFactory.getScopiaConferenceProvider(e)),this._scopiaProvider},_getSGCallProvider:function(e,t,i){return T.isEmptyObject(this._sgCallProvider)&&(this._sgCallProvider=new r.Providers.Call.CallProvider(this._getCSGProviderFactory(),t,i,this._getRTCConnectionProviderFactory())),this._sgCallProvider},_getCSGProviderFactory:function(){return T.isEmptyObject(this._csgProviderFactory)&&(this._csgProviderFactory=new r.Providers.CallServiceGateway.CallServiceGatewayProviderFactory),this._csgProviderFactory},_getRTCConnectionProviderFactory:function(){return T.isEmptyObject(this._rtcConnectionProviderFactory)&&(this._rtcConnectionProviderFactory=new r.Base.RTCConnectionProviderFactory),this._rtcConnectionProviderFactory},_getAMMProviderConfiguration:function(e){return e.ammConfiguration},getCollaborationProviders:function(e){if(0<this.collaborationProviders.length)return this.collaborationProviders;var t=this._getWCSProvider(this._getWCSProviderConfiguration(e));return T.isEmptyObject(t)||this.collaborationProviders.push(t),this.collaborationProviders},createCollaborationProviders:function(e){return[(new r.Providers.WCS.WCSProviderFactory).getWCSProvider(this._getWCSProviderConfiguration(e))]},getRemoteLoggerProvider:function(){return r.Base.Utils.isUndefined(this._remoteLoggerProvider)&&(this._remoteLoggerProvider=new r.Providers.RemoteLogger.RemoteLoggerProvider),this._remoteLoggerProvider}},r.Base.ProviderFactory=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.ProviderTypes={REST_PROVIDER:"RestProvider",WEB_SOCKET_PROVIDER:"WebSocketProvider",SSE_PROVIDER:"SSEProvider",WCS_COMET_PROVIDER:"WCSCometProvider",UCCP_LONG_POLLING_PROVIDER:"UCCPLongPollingProvider"}}(),function(v){"use strict";var t=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.msRTCPeerConnection,h=window.RTCSessionDescription||window.webkitRTCSessionDescription||window.msRTCSessionDescription;function e(e,t,i,a,r){v.Base.Observable.call(this),this.isAvailable()&&(this._rtcConfig=e,this._dtmfSender=m,this._iceNegotiatedCallback=m,this._updateSdpCallback=m,this._sdpErrorCallback=m,this._iceGatheringTimeoutId=m,this._relayCandidatesTimeoutId=m,this._relayIceCandidateCountTimeoutId=m,this._waitForIceGatheringTimeoutId=m,this._localMediaCount=0,this._mediaStreams=[],this._iceCandidates=[],this._iceRelayCandidatesCounter={},this._hasGatheredIceCandidates=!1,this._lookupRelayCandidates=!!e&&!!e.iceTransportPolicy&&"relay"===e.iceTransportPolicy,this._RELAY_CANDIDATES_TIMEOUT=t,this._LAST_RELAY_CANDIDATE_TIMEOUT=i,this._ICE_GATHERING_TIMEOUT=i,this._ICE_RESTART_INTERVAL=a,this._MAX_ICE_RECOVERY_TIME=r,this._statsParser=new v.Base.AbstractRTCStatsReportParser)}(e.prototype=Object.create(v.Base.Observable.prototype)).isAvailable=function(){return t&&h},e.prototype.addStream=function(e){v.Base.Utils.isUndefined(this._pc)&&this.createPeerConnection(this._rtcConfig)},e.prototype.removeStream=function(e){},e.prototype.createPeerConnection=function(e){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Closing the peer connection and re-creating it with new config.",e),this.close(),v.Base.Utils.isDefined(e)&&!T.isEmptyObject(e)||(e=null),this._pc=new t(e)},e.prototype.updatePeerConfiguration=function(e,t){this._lookupRelayCandidates=!!e&&!!e.iceTransportPolicy&&"relay"===e.iceTransportPolicy,this._rtcConfig=e,(this._lookupRelayCandidates||t)&&(this._iceCandidates=[],this._hasGatheredIceCandidates=!1)},e.prototype.updatePeerConnection=function(e){if(this.isRTCRtpSenderSupported()){var t=[];this._pc.getSenders().forEach(function(e){this._haveLiveTrack(e)&&(t.push(e.track),v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Found track to propagate to the new peer connection.",e.track.id,e.track.type))}.bind(this)),this.createPeerConnection(e);for(var i=new MediaStream,a=0;a<t.length;++a)this.addTrack(t[a],i)}else{var r=this._pc.getLocalStreams();this.createPeerConnection(e),r.forEach(function(e){this.addStream(e)}.bind(this))}},e.prototype._haveLiveTrack=function(e){return null!==e.track&&e.track!==m&&e.track.readyState===v.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE},e.prototype.rollbackLocalOfferState=function(){},e.prototype.createOffer=function(s,n,o,c,l,d){var C=0;if(v.Base.Utils.isUndefined(this._pc)&&this.createPeerConnection(this._rtcConfig),this._rtcConfig.iceServers&&0!==this._rtcConfig.iceServers.length&&0!==this._rtcConfig.iceServers[0].urls.length&&(C=this._lookupRelayCandidates?(this._rtcConfig.iceServers[0].urls.length-1)*this._RELAY_CANDIDATES_TIMEOUT+this._LAST_RELAY_CANDIDATE_TIMEOUT:this._LAST_RELAY_CANDIDATE_TIMEOUT),this._lookupRelayCandidates)this.createRelayOffer(s,n,o,c,this._rtcConfig,C,l,d);else if(C&&this._rtcConfig._turnOfferType&&"hostOnly"===this._rtcConfig._turnOfferType)this.createHostOnlyOffer(s,n,o,c,this._rtcConfig,C,l,d);else{!C||this._hasGatheredIceCandidates||this.hasICECandidates()||(this._rtcConfig._turnOfferType&&"relayOnly"===this._rtcConfig._turnOfferType&&(this._rtcConfig.iceTransportPolicy="relay"),this.updatePeerConnection(this._rtcConfig)),this._localMediaCount=this.getLocalMediaCount(),this._pc.onicegatheringstatechange=this._oniceGatheringStateChange.bind(this),this._pc.onicecandidate=this._onIceCandidate.bind(this),this._pc.oniceconnectionstatechange=this._oniceConnectionStateChange.bind(this);var e={};v.Base.Utils.isDefined(c)&&!this.addRecvOnlyTransceiverIfNeeded(c)&&(e=this._createOfferOptions(c)),l&&(e.iceRestart=l),this._pc.createOffer(e).then(function(e){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"after createOffer");var t=e.type,i=e.sdp;"function"==typeof o&&(i=o(i));var a=function(){(function(){this._iceNegotiatedCallback=s,this._updateSdpCallback=o,this._sdpErrorCallback=n;var e=Math.max(C,this._ICE_GATHERING_TIMEOUT);this._iceGatheringTimeoutId=setTimeout(this._iceGatheringTimeoutHandler.bind(this),e)}).call(this),this._pc.iceConnectionState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_COMPLETED&&this._pc.iceConnectionState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_CONNECTED||this._pc.iceGatheringState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_GATHERING_STATE_COMPLETE||(this._waitForIceGatheringTimeoutId=setTimeout(function(){this._sendUpdatedSdp()}.bind(this),1e3))},r={type:t,sdp:i};this._pc.setLocalDescription(new h(r)).then(function(){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"After createOffer.setLocalDescription"),a.call(this)}.bind(this)).catch(function(e){v.Base.Logger.error(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error setting local description for offer: "+e),l&&Date.now()-d<this._MAX_ICE_RECOVERY_TIME?setTimeout(function(){v.Base.Logger.info(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,">>> Retrying create offer for ICE media recovery"),this.createOffer(s,n,o,c,l,d)}.bind(this),this._ICE_RESTART_INTERVAL):n(e)}.bind(this))}.bind(this)).catch(function(e){v.Base.Logger.error(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error creating offer: "+e),l&&Date.now()-d<this._MAX_ICE_RECOVERY_TIME?setTimeout(function(){v.Base.Logger.info(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,">>> Retrying create offer for ICE media recovery"),this.createOffer(s,n,o,c,l,d)}.bind(this),this._ICE_RESTART_INTERVAL):n(e)}.bind(this))}},e.prototype.createRelayOffer=function(r,s,n,o,c,l,d,C){if(0===c.iceServers[0].urls.length||l<1)this._handleIceGatheringTimeoutError();else{if(0!==this._iceCandidates.length||this._hasGatheredIceCandidates)v.Base.Logger.info("Creating Relay Offer using "+c.iceServers[0].urls[0]);else{var e=T.extend(!0,{},c),t=e.iceServers[0].urls.shift();e.iceServers[0].urls=[t],this.updatePeerConnection(e),v.Base.Logger.info("Creating Relay Offer using "+t)}var i,u=function(){(function(){this._iceNegotiatedCallback=r,this._updateSdpCallback=n,this._sdpErrorCallback=s,i=Date.now(),this._iceGatheringTimeoutId=setTimeout(this._iceGatheringTimeoutHandler.bind(this),l);var e=0===c.iceServers[0].urls.length?this._LAST_RELAY_CANDIDATE_TIMEOUT:this._RELAY_CANDIDATES_TIMEOUT;this._relayCandidatesTimeoutId=setTimeout(function(){0===this._iceCandidates.length?(clearTimeout(this._iceGatheringTimeoutId),this._hasGatheredIceCandidates?this._sendUpdatedSdp():(l-=e,c.iceServers[0].urls.shift(),v.Base.Logger.info("No relay candidates found  with "+t+". Remaining turn servers to try: "+c.iceServers[0].urls.length),this.createRelayOffer(r,s,n,o,c,l,d,C))):this._relayCandidatesTimeoutHandler.call(this)}.bind(this),e)}).call(this),this._pc.iceConnectionState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_COMPLETED&&this._pc.iceConnectionState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_CONNECTED||this._pc.iceGatheringState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_GATHERING_STATE_COMPLETE||(this._waitForIceGatheringTimeoutId=setTimeout(function(){this._sendUpdatedSdp()}.bind(this),1e3))};this._pc.onicecandidate=function(e){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"onIceCandidate "+this._pc.iceGatheringState+" Candidate: "+(null===e.candidate?null:e.candidate.candidate)),null!==e.candidate?this._iceCandidates.push(e.candidate.candidate):0<this._iceCandidates.length?(v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"NO more ICE candidate. GatheringState: "+this._pc.iceGatheringState),this._sendUpdatedSdp()):this._hasGatheredIceCandidates||(clearTimeout(this._relayCandidatesTimeoutId),clearTimeout(this._iceGatheringTimeoutId),l-=Date.now()-i,c.iceServers[0].urls.shift(),v.Base.Logger.info("No relay candidates found  with "+t+". Remaining turn servers to try: "+c.iceServers[0].urls.length),this.createRelayOffer(r,s,n,o,c,l,d,C))}.bind(this),this._pc.onicegatheringstatechange=this._oniceGatheringStateChange.bind(this),this._pc.oniceconnectionstatechange=this._oniceConnectionStateChange.bind(this);var a={};v.Base.Utils.isDefined(o)&&!this.addRecvOnlyTransceiverIfNeeded(o)&&(a=this._createOfferOptions(o)),d&&(a.iceRestart=d),this._pc.createOffer(a).then(function(e){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"after createOffer");var t=e.type,i=e.sdp;"function"==typeof n&&(i=n(i));var a={type:t,sdp:i};this._pc.setLocalDescription(new h(a)).then(function(){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"After createOffer.setLocalDescription"),u.call(this)}.bind(this)).catch(function(e){v.Base.Logger.error(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error setting local description for offer: "+e),d&&Date.now()-C<this._MAX_ICE_RECOVERY_TIME?setTimeout(function(){v.Base.Logger.info(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,">>> Retrying create relay offer for ICE media recovery"),this.createRelayOffer(r,s,n,o,c,l,d,C)}.bind(this),this._ICE_RESTART_INTERVAL):s(e)}.bind(this))}.bind(this)).catch(function(e){v.Base.Logger.error(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error creating offer: "+e),d&&Date.now()-C<this._MAX_ICE_RECOVERY_TIME?setTimeout(function(){v.Base.Logger.info(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,">>> Retrying create relay offer for ICE media recovery"),this.createRelayOffer(r,s,n,o,c,l,d,C)}.bind(this),this._ICE_RESTART_INTERVAL):s(e)}.bind(this),a)}},e.prototype.createHostOnlyOffer=function(s,n,o,c,l,d,C,u){v.Base.Logger.info("Creating host only Offer"),this._hasGatheredIceCandidates||this.hasICECandidates()||this.updatePeerConnection({sdpSemantics:l.sdpSemantics}),this._pc.onicegatheringstatechange=this._oniceGatheringStateChange.bind(this),this._pc.onicecandidate=this._onIceCandidate.bind(this),this._pc.oniceconnectionstatechange=this._oniceConnectionStateChange.bind(this);var e=this._createOfferOptions(c);C&&(e.iceRestart=C),this._pc.createOffer(e).then(function(e){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"after createOffer");var t=e.type,i=e.sdp;"function"==typeof o&&(i=o(i));var a=function(){(function(){this._iceNegotiatedCallback=s,this._updateSdpCallback=o,this._sdpErrorCallback=n,this._iceGatheringTimeoutId=setTimeout(this._iceGatheringTimeoutHandler.bind(this),d),this._relayCandidatesTimeoutId=setTimeout(function(){0===this._iceCandidates.length?(clearTimeout(this._iceGatheringTimeoutId),this._hasGatheredIceCandidates?this._sendUpdatedSdp():(v.Base.Logger.info("No host only candidates found. Trying relay only servers: "+l.iceServers[0].urls.length),l._turnOfferType="relayOnly",this.createOffer(s,n,o,c,C,u))):this._relayCandidatesTimeoutHandler.call(this)}.bind(this),2e3)}).call(this),this._pc.iceConnectionState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_COMPLETED&&this._pc.iceConnectionState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_CONNECTED||this._pc.iceGatheringState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_GATHERING_STATE_COMPLETE||(this._waitForIceGatheringTimeoutId=setTimeout(function(){this._sendUpdatedSdp()}.bind(this),1e3))},r={type:t,sdp:i};this._pc.setLocalDescription(new h(r)).then(function(){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"After createOffer.setLocalDescription"),a.call(this)}.bind(this)).catch(function(e){v.Base.Logger.error(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error setting local description for offer: "+e),C&&Date.now()-u<this._MAX_ICE_RECOVERY_TIME?setTimeout(function(){v.Base.Logger.info(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,">>> Retrying create offer for ICE media recovery"),this.createOffer(s,n,o,c,C,u)}.bind(this),this._ICE_RESTART_INTERVAL):n(e)}.bind(this))}.bind(this)).catch(function(e){v.Base.Logger.error(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error creating offer: "+e),C&&Date.now()-u<this._MAX_ICE_RECOVERY_TIME?setTimeout(function(){v.Base.Logger.info(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,">>> Retrying create offer for ICE media recovery"),this.createOffer(s,n,o,c,C,u)}.bind(this),this._ICE_RESTART_INTERVAL):n(e)}.bind(this))},e.prototype.receiveAnswer=function(e,t,i){this._pc.setRemoteDescription(new h({type:"answer",sdp:e})).then(t).catch(i)},e.prototype.createAnswer=function(o,c,l,d){var C=0;v.Base.Utils.isUndefined(this._pc)&&this.createPeerConnection(this._rtcConfig),this._rtcConfig.iceServers&&0!==this._rtcConfig.iceServers.length&&0!==this._rtcConfig.iceServers[0].urls.length&&(C=this._lookupRelayCandidates?(this._rtcConfig.iceServers[0].urls.length-1)*this._RELAY_CANDIDATES_TIMEOUT+this._LAST_RELAY_CANDIDATE_TIMEOUT:this._LAST_RELAY_CANDIDATE_TIMEOUT),this._lookupRelayCandidates?this.createRelayAnswer(o,c,l,d,this._rtcConfig,C):(v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"createAnswer offer SDP:\n"+o),!C||this._hasGatheredIceCandidates||this.hasICECandidates()||this.updatePeerConnection(this._rtcConfig),this._localMediaCount=this.getLocalMediaCount(),this._pc.setRemoteDescription(new h({type:"offer",sdp:o})).then(function(){this._pc.onicegatheringstatechange=this._oniceGatheringStateChange.bind(this),this._pc.onicecandidate=this._onIceCandidate.bind(this),this._pc.oniceconnectionstatechange=this._oniceConnectionStateChange.bind(this),this._pc.createAnswer().then(function(e){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"after createAnswer");var t=e.type,i=e.sdp,a=v.Base.SDPUtil.getProfileLevelId(o),r=v.Base.SDPUtil.getProfileLevelId(i);a&&r&&(a=a.toUpperCase(),r=r.toUpperCase(),v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"offer profile-level-id; ",a),a===r||"424028"!==a&&"42401F"!==a||(i=v.Base.SDPUtil.updateProfileLevelId(i,a))),"function"==typeof d&&(i=d(i));var s=function(){(function(){this._iceNegotiatedCallback=c,this._updateSdpCallback=d,this._sdpErrorCallback=l;var e=Math.max(C,this._ICE_GATHERING_TIMEOUT);this._iceGatheringTimeoutId=setTimeout(this._iceGatheringTimeoutHandler.bind(this),e)}).call(this),this._pc.iceConnectionState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_COMPLETED&&this._pc.iceConnectionState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_CONNECTED||this._pc.iceGatheringState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_GATHERING_STATE_COMPLETE||(this._waitForIceGatheringTimeoutId=setTimeout(function(){this._sendUpdatedSdp()}.bind(this),1e3))},n={type:t,sdp:i};this._pc.setLocalDescription(new h(n)).then(function(){s.call(this)}.bind(this),function(e){this._answerError(e,l)}.bind(this))}.bind(this)).catch(function(e){v.Base.Logger.error(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error while creating answer for offer: "+e),l(e)}.bind(this))}.bind(this)).catch(function(e){v.Base.Logger.error(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error setting remote description while creating answer: "+e),l(e)}.bind(this)))},e.prototype.createRelayAnswer=function(o,i,c,l,a,r){if(v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"createRelayAnswer offer SDP:\n"+o),0===a.iceServers[0].urls.length||r<1)this._handleIceGatheringTimeoutError();else{if(0!==this._iceCandidates.length||this._hasGatheredIceCandidates)v.Base.Logger.info("Creating Relay Answer using "+a.iceServers[0].urls[0]);else{var e=T.extend(!0,{},a),s=e.iceServers[0].urls.shift();e.iceServers[0].urls=[s],this.updatePeerConnection(e),v.Base.Logger.info("Creating Relay Answer using "+s)}this._pc.setRemoteDescription(new h({type:"offer",sdp:o})).then(function(){var t,n=function(){(function(){this._iceNegotiatedCallback=i,this._updateSdpCallback=l,this._sdpErrorCallback=c,t=Date.now(),this._iceGatheringTimeoutId=setTimeout(this._iceGatheringTimeoutHandler.bind(this),r);var e=0===a.iceServers[0].urls.length?this._LAST_RELAY_CANDIDATE_TIMEOUT:this._RELAY_CANDIDATES_TIMEOUT;this._relayCandidatesTimeoutId=setTimeout(function(){0===this._iceCandidates.length?(clearTimeout(this._iceGatheringTimeoutId),this._hasGatheredIceCandidates?this._sendUpdatedSdp():(r-=e,a.iceServers[0].urls.shift(),v.Base.Logger.info("No relay candidates found  with "+s+". Remaining turn servers to try: "+a.iceServers[0].urls.length),this.createRelayAnswer(o,i,c,l,a,r))):this._relayCandidatesTimeoutHandler.call(this)}.bind(this),e)}).call(this),this._pc.iceConnectionState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_COMPLETED&&this._pc.iceConnectionState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_CONNECTED||this._pc.iceGatheringState!==v.Base.AbstractRTCConnectionProvider.Constants.ICE_GATHERING_STATE_COMPLETE||(this._waitForIceGatheringTimeoutId=setTimeout(function(){this._sendUpdatedSdp()}.bind(this),1e3))};this._pc.onicecandidate=function(e){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"onIceCandidate "+this._pc.iceGatheringState+" Candidate: "+(null===e.candidate?null:e.candidate.candidate)),null!==e.candidate?this._iceCandidates.push(e.candidate.candidate):0<this._iceCandidates.length?(v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"NO more ICE candidate. GatheringState: "+this._pc.iceGatheringState),this._sendUpdatedSdp()):this._hasGatheredIceCandidates||(clearTimeout(this._relayCandidatesTimeoutId),clearTimeout(this._iceGatheringTimeoutId),r-=Date.now()-t,a.iceServers[0].urls.shift(),v.Base.Logger.info("No relay candidates found  with "+s+". Remaining turn servers to try: "+a.iceServers[0].urls.length),this.createRelayAnswer(o,i,c,l,a,r))}.bind(this),this._pc.onicegatheringstatechange=this._oniceGatheringStateChange.bind(this),this._pc.oniceconnectionstatechange=this._oniceConnectionStateChange.bind(this,i),this._pc.createAnswer().then(function(e){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"after createAnswer");var t=e.type,i=e.sdp,a=v.Base.SDPUtil.getProfileLevelId(o),r=v.Base.SDPUtil.getProfileLevelId(i);a&&r&&(a=a.toUpperCase(),r=r.toUpperCase(),v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"offer profile-level-id; ",a),a===r||"424028"!==a&&"42401F"!==a||(i=v.Base.SDPUtil.updateProfileLevelId(i,a))),"function"==typeof l&&(i=l(i));var s={type:t,sdp:i};this._pc.setLocalDescription(new h(s)).then(function(){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"After createAnswer.setLocalDescription"),n.call(this)}.bind(this),function(e){this._answerError(e,c)}.bind(this))}.bind(this)).catch(function(e){v.Base.Logger.error(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error while creating answer for offer: "+e),c(e)}.bind(this))}.bind(this)).catch(function(e){v.Base.Logger.error(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error setting remote description while creating answer: "+e),c(e)}.bind(this))}},e.prototype._answerError=function(e,t){v.Base.Logger.error(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error while setting answer as local description: "+e),t(e)},e.prototype._iceGatheringTimeoutHandler=function(){var e,t;(clearTimeout(this._relayCandidatesTimeoutId),clearTimeout(this._relayIceCandidateCountTimeoutId),this._relayCandidatesTimeoutId=m,this._relayIceCandidateCountTimeoutId=m,this._iceGatheringTimeoutId=m,this._pc.onicecandidate=function(e){v.Base.Logger.warn(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Already timed out.  Ignoring Candidate: "+(null===e.candidate?null:e.candidate.candidate))},this._pc.oniceconnectionstatechange=function(){v.Base.Logger.warn(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Already timed out.  Ignoring oniceConnectionStateChange"),v.Base.Utils.isDefined(this._pc)&&(v.Base.Logger.warn(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER," ["+this._pc.iceConnectionState+", "+this._pc.iceGatheringState+"]"),this.trigger(v.Base.AbstractRTCConnectionProvider.ObservableRTCEvents.ICE_CONNECTION_STATE_CHANGED,[this._pc.iceConnectionState]))}.bind(this),0===this._iceCandidates.length)?this._handleIceGatheringTimeoutError():(v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Timed out ice candidate gathering.  Using current SDP"),v.Base.Utils.isDefined(this._iceNegotiatedCallback)&&(t="function"==typeof this._updateSdpCallback?(e=this._updateSdpCallback(this._pc.localDescription.sdp),{type:this._pc.localDescription.type,sdp:e}):{type:this._pc.localDescription.type,sdp:this._pc.localDescription.sdp},v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"local SDP:\n"+t.sdp),this._iceNegotiatedCallback(t),this._iceNegotiatedCallback=m,this._updateSdpCallback=m))},e.prototype._handleIceGatheringTimeoutError=function(){v.Base.Logger.warn(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Timed out ice candidate gathering. No candidates found"),v.Base.Utils.isDefined(this._relayCandidatesTimeoutId)&&(clearTimeout(this._relayCandidatesTimeoutId),this._relayCandidatesTimeoutId=m),v.Base.Utils.isDefined(this._iceGatheringTimeoutId)&&(clearTimeout(this._iceGatheringTimeoutId),this._iceGatheringTimeoutId=m),this._throwSdpError(),this._iceNegotiatedCallback=m,this._updateSdpCallback=m,this._sdpErrorCallback=m},e.prototype._throwSdpError=function(){this._sdpErrorCallback({errorCode:v.Services.Call.CallError.TRANSPORT_ERROR,protocolType:v.Services.Call.CallProtocolType.APPLICATION,errorMsg:"No ice candidates found in allocated time"})},e.prototype._relayCandidatesTimeoutHandler=function(){var e,t;(v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Timed out ice host only or relay candidates gathering: "+this._iceCandidates.length),this._relayCandidatesTimeoutId=m,0<this._iceCandidates.length)&&(clearTimeout(this._iceGatheringTimeoutId),this._iceGatheringTimeoutId=m,this._pc.onicecandidate=function(e){v.Base.Logger.warn(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Already timed out.  Ignoring Candidate: "+(null===e.candidate?null:e.candidate.candidate))},this._pc.oniceconnectionstatechange=function(){v.Base.Logger.warn(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Already timed out.  Ignoring oniceConnectionStateChange"),v.Base.Utils.isDefined(this._pc)&&(v.Base.Logger.warn(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER," ["+this._pc.iceConnectionState+", "+this._pc.iceGatheringState+"]"),this.trigger(v.Base.AbstractRTCConnectionProvider.ObservableRTCEvents.ICE_CONNECTION_STATE_CHANGED,[this._pc.iceConnectionState]))}.bind(this),v.Base.Utils.isDefined(this._iceNegotiatedCallback)&&(t="function"==typeof this._updateSdpCallback?(e=this._updateSdpCallback(this._pc.localDescription.sdp),{type:this._pc.localDescription.type,sdp:e}):{type:this._pc.localDescription.type,sdp:this._pc.localDescription.sdp},v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"local SDP:\n"+t.sdp),this._iceNegotiatedCallback(t),this._iceNegotiatedCallback=m,this._updateSdpCallback=m))},e.prototype.close=function(){this._pc&&((v.Base.Utils.isDefined(this._pc.connectionState)?this._pc.connnectionState:this._pc.signalingState)!==v.Base.AbstractRTCConnectionProvider.Constants.RTC_PEER_CONNECTION_STATE_CLOSED&&this._pc.close(),this._mediaStreams=[],clearTimeout(this._iceGatheringTimeoutId),clearTimeout(this._relayCandidatesTimeoutId),clearTimeout(this._relayIceCandidateCountTimeoutId),clearTimeout(this._waitForIceGatheringTimeoutId))},e.prototype.hasICECandidates=function(){return 0<this._iceCandidates.length},e.prototype.onAddStream=function(e){},e.prototype.onAddRemoteTrack=function(e){},e.prototype.onRemoveRemoteTrack=function(e){},e.prototype.onAddTrackInternal=function(e){var t=e.track;t&&this.onAddRemoteTrack&&this.onAddRemoteTrack(t)},e.prototype.onRemoveTrackInternal=function(e){var t=e.track;t&&this.onRemoveRemoteTrack&&this.onRemoveRemoteTrack(t)},e.prototype.onTrackInternal=function(t){if(this.onAddStream)if(0<t.streams.length){var e=this._mediaStreams.findIndex(function(e){return e.id===t.streams[0].id}),i=t.streams[0];i&&(i.onaddtrack=this.onAddTrackInternal.bind(this),i.onremovetrack=this.onRemoveTrackInternal.bind(this),-1===e?(this._mediaStreams.push(i),this.onAddStream(i)):this._mediaStreams[e].active||(this._mediaStreams[e]=i,this.onAddStream(i)))}else if(t.track&&this.onAddRemoteTrack){var a=this._pc.getRemoteStreams();0<a.length&&(a[0].addTrack(t.track),a[0].onaddtrack=this.onAddTrackInternal.bind(this),a[0].onremovetrack=this.onRemoveTrackInternal.bind(this),this.onAddRemoteTrack(t.track))}},e.prototype._getDTMFSender=function(){},e.prototype._sendUpdatedSdp=function(){var e,t;v.Base.Utils.isDefined(this._iceNegotiatedCallback)&&(t="function"==typeof this._updateSdpCallback?(e=this._updateSdpCallback(this._pc.localDescription.sdp),{type:this._pc.localDescription.type,sdp:e}):{type:this._pc.localDescription.type,sdp:this._pc.localDescription.sdp},v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"local SDP:\n"+t.sdp),this._iceNegotiatedCallback(t),this._iceNegotiatedCallback=m,this._updateSdpCallback=m),v.Base.Utils.isDefined(this._relayCandidatesTimeoutId)&&(clearTimeout(this._relayCandidatesTimeoutId),this._relayCandidatesTimeoutId=m),v.Base.Utils.isDefined(this._relayIceCandidateCountTimeoutId)&&(clearTimeout(this._relayIceCandidateCountTimeoutId),this._relayIceCandidateCountTimeoutId=m),v.Base.Utils.isDefined(this._iceGatheringTimeoutId)&&(clearTimeout(this._iceGatheringTimeoutId),this._iceGatheringTimeoutId=m)},e.prototype._onIceCandidate=function(e){if(v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"onIceCandidate "+this._pc.iceGatheringState+" Candidate: "+(null===e.candidate?null:e.candidate.candidate)),null!==e.candidate){if(this._iceCandidates.push(e.candidate.candidate),!this._lookupRelayCandidates&&-1!==e.candidate.candidate.indexOf("relay")){var t=this.parseIceRelayCandidate(e.candidate.candidate,e.candidate);if(t&&("1"===t.component||"rtp"===t.component)){var i=0,a=t.networkId||"0",r=t.foundation+":"+a;this._iceRelayCandidatesCounter.hasOwnProperty(r)&&(i=this._iceRelayCandidatesCounter[r]),this._iceRelayCandidatesCounter[r]=++i,i===this._localMediaCount&&v.Base.Utils.isUndefined(this._relayIceCandidateCountTimeoutId)&&(v.Base.Logger.info(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Short circuiting relay candidates"),this._relayIceCandidateCountTimeoutId=setTimeout(function(){this._pc.onicecandidate=function(e){v.Base.Logger.warn(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Already timed out.  Ignoring Candidate: "+(null===e.candidate?null:e.candidate.candidate))},this._sendUpdatedSdp()}.bind(this),2e3))}}}else if(0<this._iceCandidates.length)v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"NO more ICE candidate. GatheringState: "+this._pc.iceGatheringState),this._sendUpdatedSdp();else{var s=this._hasGatheredIceCandidates?1e3:0;setTimeout(function(){0===this._iceCandidates.length&&(this._hasGatheredIceCandidates?this._sendUpdatedSdp():this._handleIceGatheringTimeoutError())}.bind(this),s)}},e.prototype._oniceGatheringStateChange=function(e){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,">>> oniceGatheringStateChange ["+this._pc.iceConnectionState+", "+this._pc.iceGatheringState+"]"),this._pc.iceGatheringState===v.Base.AbstractRTCConnectionProvider.Constants.ICE_GATHERING_STATE_GATHERING&&(clearTimeout(this._waitForIceGatheringTimeoutId),this._waitForIceGatheringTimeoutId=m,this._hasGatheredIceCandidates||(this._hasGatheredIceCandidates=0!==this._iceCandidates.length),this._iceCandidates=[])},e.prototype._oniceConnectionStateChange=function(e){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"<<< oniceConnectionStateChange ["+this._pc.iceConnectionState+", "+this._pc.iceGatheringState+"]"),this.trigger(v.Base.AbstractRTCConnectionProvider.ObservableRTCEvents.ICE_CONNECTION_STATE_CHANGED,[this._pc.iceConnectionState]),this._pc.iceConnectionState===v.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_CLOSED&&(this._iceCandidates=[],this.trigger(v.Base.AbstractRTCConnectionProvider.ObservableRTCEvents.ICE_CONNECTION_STATE_CHANGED,[]))},e.prototype.stopAllStreams=function(){},e.prototype.enableAllStreams=function(){this.enableLocalStreams(),this.enableRemoteStreams()},e.prototype.enableRemoteStreams=function(){this._enableDisableRemoteStreams(!0)},e.prototype.disableRemoteStreams=function(){this._enableDisableRemoteStreams(!1)},e.prototype._enableDisableRemoteStreams=function(e){},e.prototype.enableLocalStreams=function(){this._enableDisableLocalStreams(!0)},e.prototype.disableLocalStreams=function(){this._enableDisableLocalStreams(!1)},e.prototype._enableDisableLocalStreams=function(e){},e.prototype.enableLocalAudioStreams=function(){this._enableDisableLocalAudioStreams(!0)},e.prototype.disableLocalAudioStreams=function(){this._enableDisableLocalAudioStreams(!1)},e.prototype._enableDisableLocalAudioStreams=function(e){},e.prototype.enableLocalVideoStreams=function(){this._enableDisableLocalVideoStreams(!0)},e.prototype.disableLocalVideoStreams=function(){this._enableDisableLocalVideoStreams(!1)},e.prototype._enableDisableLocalVideoStreams=function(e){},e.prototype.enableRemoteAudioStream=function(){this._enableDisableRemoteAudioStream(!0)},e.prototype.enableRemoteVideoStreams=function(){this._enableDisableRemoteVideoStreams(!0)},e.prototype.disableRemoteVideoStreams=function(){this._enableDisableRemoteVideoStreams(!1)},e.prototype._enableDisableRemoteAudioStream=function(e){},e.prototype._enableDisableRemoteVideoStreams=function(e){},e.prototype.limitOutgoingVideoBitRate=function(i){this.isRTCRtpSenderSupported()&&this._pc.getSenders().forEach(function(e){if(e.track&&e.track.kind===v.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&e.track.readyState===v.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE){v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Limiting outgoing video bitrate "+e.track.id+" to "+i);var t=e.getParameters();t.encodings.forEach(function(e){e.maxBitRate=1024*i}),e.setParameters(t).catch(function(e){v.Base.Logger.warn("Failed to limit outgoing video bitrate",e)})}})},e.prototype.enableRemoteVideoTrack=function(t,i){t.getVideoTracks().forEach(function(e){e.id===i.id?(v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Enabling video track: "+e.id+" for "+t.id),e.readyState!==v.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE?(t.removeTrack(e),t.addTrack(i)):e.enabled=!0):(v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Disabling old video track: "+e.id+" for "+t.id),e.enabled=!1,e.readyState!==v.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&t.removeTrack(e))}.bind(this))},e.prototype.sendDTMF=function(e){var t=this._getDTMFSender();return!!v.Base.Utils.isDefined(t)&&(t.insertDTMF(e),!0)},e.prototype.isPlaying=function(e){return!!(0<e.currentTime&&!e.paused&&!e.ended&&2<e.readyState)},e.prototype.stopStream=function(e){v.Base.Utils.isDefined(e)&&null!==e&&e.getTracks().forEach(function(e){e.stop()})},e.prototype.hasVideo=function(e){return e&&0<e.getVideoTracks().length},e.prototype._createOfferOptions=function(e){return{offerToReceiveAudio:!0,offerToReceiveVideo:e}},e.prototype.isRTCRtpSenderSupported=function(){return!1},e.prototype.addTrack=function(e,t){v.Base.Utils.isUndefined(this._pc)&&this.createPeerConnection(this._rtcConfig)},e.prototype.removeLocalAudioTrack=function(t){this._pc.getSenders().forEach(function(e){e.track&&e.track.kind===v.Base.AbstractRTCConnectionProvider.Constants.AUDIO_TRACK&&(v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Removing local audio track: "+e.track.id),e.track.stop(),t.removeTrack(e.track))}.bind(this))},e.prototype.removeLocalVideoTrack=function(t){this._pc.getSenders().forEach(function(e){e.track&&e.track.kind===v.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&(v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Removing local video track: "+e.track.id),e.track.stop(),t.removeTrack(e.track))}.bind(this))},e.prototype.removeIfDoesNotSupportReplaceTrack=function(e){},e.prototype.replaceLocalMediaTrack=function(t,i){var a=T.Deferred(),r=0,s=function(){i?(v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Adding local "+t.kind+" track  "+t.id),this._pc.addTrack(t,i),i.addTrack(t),a.resolve()):(v.Base.Logger.warn(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Failed to add local "+t.kind+" track  "+t.id+" due to missing media stream"),a.reject("Missing local media stream"))}.bind(this);return this._pc.getSenders().forEach(function(e){e.track&&e.track.kind===t.kind&&(r++,v.Base.Logger.debug(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Replacing local "+t.kind+" track  "+e.track.id+" with "+t.id),e.track.stop(),e.replaceTrack(t).then(function(){i&&i.addTrack(t),a.resolve()}).catch(function(e){v.Base.Logger.info(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"<<< Adding "+t.kind+" track instead due to "+e),s()}))}),0===r&&s(),a.promise()},e.prototype.setLocalVideoDirection=function(e){},e.prototype.isSetLocalVideoDirectionSupported=function(){return!1},e.prototype.hasVideoTrackStopStreaming=function(t){return this.isRTCRtpSenderSupported()?0!==this._pc.getSenders().filter(function(e){return!!e.track&&e.track.id===t.id&&e.track.readyState===v.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED}.bind(this)).length:!!t&&t.readyState===v.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED},e.prototype.getStats=function(){if(this.isRTCRtpSenderSupported()){var t=T.Deferred(),i=new v.Base.AudioStatistics,a=new v.Base.VideoStatistics,r={},s=[];return this._pc.getSenders().forEach(function(e){e.track&&e.track.readyState===v.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&s.push(e.getStats().then(function(e){this._statsParser.parse(e,i,a,r)}.bind(this)))}.bind(this)),this._pc.getReceivers().forEach(function(e){e.track&&e.track.readyState===v.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&s.push(e.getStats().then(function(e){this._statsParser.parse(e,i,a,r)}.bind(this)))}.bind(this)),T.when.apply(this,s).then(function(){t.resolve({audioStatistics:i,videoStatistics:a,iceCandidateStatistics:r})},function(e){v.Base.Logger.error(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error getting stats report from RTCPeerConnection: "+e),t.reject(e)}),t.promise()}return this._pc.getStats(null).then(function(e){return this._statsParser.parse(e)}.bind(this)).catch(function(e){return v.Base.Logger.error(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error getting stats report from RTCPeerConnection: "+e),Promise.reject(e)})},e.prototype.adjustVideoConstraints=function(e,t,i,a){var r=T.Deferred();if(e&&t){var s=this._createVideoConstraintsList(e,t,i,a);this._applyVideoConstraints(r,s)}else r.reject("Undefined video width or height");return r.promise()},e.prototype._applyVideoConstraints=function(i,a){var r=a.shift();r?this.isRTCRtpSenderSupported()?this._pc.getSenders().forEach(function(t){t.track&&t.track.kind===v.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&t.track.readyState===v.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(v.Base.Logger.info(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Adjusting video constraints: ",r),t.track.applyConstraints(r).then(function(){var e=t.track.getConstraints();v.Base.Logger.info(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Successfully adjusting video constraints: ",e),i.resolve()}).catch(function(e){v.Base.Logger.info(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Failed to adjust video constraints: ",e),this._applyVideoConstraints(i,a)}.bind(this)))}.bind(this)):this._pc.getLocalStreams().forEach(function(e){e.getVideoTracks().forEach(function(e){e.readyState===v.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(v.Base.Logger.info(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Adjusting video constraints: ",r),e.applyConstraints(r).then(function(){v.Base.Logger.info(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Successfully adjusting video constraints"),i.resolve()}).catch(function(e){v.Base.Logger.info(v.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Failed to adjust video constraints: ",e),this._applyVideoConstraints(i,a)}.bind(this)))}.bind(this))}.bind(this)):i.reject("Unsupported constraints")},e.prototype._createVideoConstraintsList=function(e,i,t,a){var r=[],s=[],n=function(e,t){var i={width:{exact:e.getWidth()},height:{exact:e.getHeight()}};return a&&(i.deviceId={exact:a}),t?i.frameRate={min:t}:v.Base.Utils.getBrowserType()===v.Base.BrowserType.SAFARI&&(i.width=e.getWidth(),i.height=e.getHeight()),i},o=t||30;Object.keys(v.Base.VideoResolution).filter(function(e){var t=v.Base.VideoResolution[e];t&&t.getHeight()<=i&&(r.push(n(t,o)),s.push(n(t)))});var c=r.concat(s);if(v.Base.Utils.getBrowserType()===v.Base.BrowserType.SAFARI){var l={width:{ideal:e},height:{ideal:i}};c.push(l)}else{var d={width:{max:e},height:{max:i}};c.push(d)}return c},e.prototype.addRecvOnlyTransceiverIfNeeded=function(e){return!1},e.prototype.getIceConnectionState=function(){return this._pc?this._pc.iceConnectionState:m},e.prototype.parseIceRelayCandidate=function(e,t){return m},e.prototype.getLocalMediaCount=function(){var t=0;return this.isRTCRtpSenderSupported()?this._pc.getSenders().forEach(function(e){!e.track||e.track.kind!==v.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&e.track.kind!==v.Base.AbstractRTCConnectionProvider.Constants.AUDIO_TRACK||e.track.readyState!==v.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE||t++}.bind(this)):this._pc.getLocalStreams().forEach(function(e){e.getTracks().forEach(function(e){e.kind!==v.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&e.kind!==v.Base.AbstractRTCConnectionProvider.Constants.AUDIO_TRACK||e.readyState!==v.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE||t++})}),t},v.Base.AbstractRTCConnectionProvider=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.AbstractRTCConnectionProvider.Constants={ICE_GATHERING_STATE_COMPLETE:"complete",ICE_GATHERING_STATE_GATHERING:"gathering",ICE_CONNECTION_STATE_COMPLETED:"completed",ICE_CONNECTION_STATE_CONNECTED:"connected",ICE_CONNECTION_STATE_FAILED:"failed",ICE_CONNECTION_STATE_DISCONNECTED:"disconnected",ICE_CONNECTION_STATE_NEW:"new",ICE_CONNECTION_STATE_CLOSED:"closed",RTC_PEER_CONNECTION_STATE_CLOSED:"closed",MEDIA_STREAM_TRACK_READY_STATE_LIVE:"live",MEDIA_STREAM_TRACK_READY_STATE_ENDED:"ended",VIDEO_TRACK:"video",AUDIO_TRACK:"audio",RTC_STATS_TYPE:{INBOUND_RTP:"inbound-rtp",REMOTE_OUTBOUND_RTP:"remote-outbound-rtp",OUTBOUND_RTP:"outbound-rtp",REMOTE_INBOUND_RTP:"remote-inbound-rtp",TRACK:"track",CANDIDATE_PAIR:"candidate-pair",LOCAL_CANDIDATE:"local-candidate",REMOTE_CANDIDATE:"remote-candidate",MEDIA_SOURCE:"media-source",CODEC:"codec"},RTC_STATS_MEDIA_TYPE:{AUDIO:"audio",VIDEO:"video"}}}(),function(o){"use strict";function e(){this._inboundStatsType=o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_TYPE.INBOUND_RTP,this._outboundStatsType=o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_TYPE.OUTBOUND_RTP,this._remoteInboundStatsType=o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_TYPE.REMOTE_INBOUND_RTP,this._remoteOutboundStatsType=o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_TYPE.REMOTE_OUTBOUND_RTP,this._trackType=o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_TYPE.TRACK,this._candidatePairType=o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_TYPE.CANDIDATE_PAIR,this._localCandidateType=o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_TYPE.LOCAL_CANDIDATE,this._remoteCandidateType=o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_TYPE.REMOTE_CANDIDATE,this._mediaSourceType=o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_TYPE.MEDIA_SOURCE,this._codec=o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_TYPE.CODEC,this._localCandidates={},this._remoteCandidates={}}e.prototype.processOutboundGenericStats=function(e,t){o.Base.Utils.isDefined(e.packetsSent)&&(t.packetsTransmitted=e.packetsSent),o.Base.Utils.isDefined(e.bytesSent)&&(t.bytesTransmitted=e.bytesSent),o.Base.Utils.isDefined(e.packetsLost)&&(t.packetLossTotalTransmitted=e.packetsLost),o.Base.Utils.isDefined(e.roundTripTime)&&(t.roundTripTimeMilliseconds=e.roundTripTime)},e.prototype.processInboundGenericStats=function(e,t){o.Base.Utils.isDefined(e.packetsReceived)&&(t.packetsReceived=e.packetsReceived),o.Base.Utils.isDefined(e.bytesReceived)&&(t.bytesReceived=e.bytesReceived),o.Base.Utils.isDefined(e.packetsLost)&&(t.packetLossTotalReceived=e.packetsLost),o.Base.Utils.isDefined(e.jitter)&&(t.jitterMillisecondsReceived=1e3*e.jitter),o.Base.Utils.isDefined(e.fractionLost)&&(t.packetsLossFractionReceived=e.fractionLost)},e.prototype.processOutboundVideoStats=function(e,t){o.Base.Utils.isDefined(e.framesEncoded)&&(t.framesEncoded=e.framesEncoded),o.Base.Utils.isDefined(e.firCount)&&(t.firCountTransmitted=e.firCount),o.Base.Utils.isDefined(e.pliCount)&&(t.pliCountTransmitted=e.pliCount),o.Base.Utils.isDefined(e.nackCount)&&(t.nackCountTransmitted=e.nackCount)},e.prototype.processInboundVideoStats=function(e,t){o.Base.Utils.isDefined(e.framesDecoded)&&(t.framesDecoded=e.framesDecoded),o.Base.Utils.isDefined(e.firCount)&&(t.firCountReceived=e.firCount),o.Base.Utils.isDefined(e.pliCount)&&(t.pliCountReceived=e.pliCount),o.Base.Utils.isDefined(e.nackCount)&&(t.nackCountReceived=e.nackCount)},e.prototype.processInboundStats=function(e,t,i,a){switch(this.getMediaType(e,a)){case o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.AUDIO:this.processInboundGenericStats(e,t);break;case o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.VIDEO:this.processInboundGenericStats(e,i),this.processInboundVideoStats(e,i)}},e.prototype.processRemoteOutboundStats=function(e,t,i,a){switch(this.getMediaType(e,a)){case o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.AUDIO:this.processInboundGenericStats(e,t);break;case o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.VIDEO:this.processInboundGenericStats(e,i),this.processInboundVideoStats(e,i)}},e.prototype.processOutboundStats=function(e,t,i,a){switch(this.getMediaType(e,a)){case o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.AUDIO:this.processOutboundGenericStats(e,t);break;case o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.VIDEO:this.processOutboundGenericStats(e,i),this.processOutboundVideoStats(e,i)}},e.prototype.processRemoteInboundStats=function(e,t,i,a){this.processOutboundStats(e,t,i,a)},e.prototype.processVideoTrackStats=function(e,t){o.Base.Utils.isDefined(e.remoteSource)&&(e.remoteSource?(o.Base.Utils.isDefined(e.framesPerSecond)&&(t.actualFrameRateReceived=e.framesPerSecond),o.Base.Utils.isDefined(e.frameHeight)&&(t.heightReceived=e.frameHeight),o.Base.Utils.isDefined(e.frameWidth)&&(t.widthReceived=e.frameWidth),o.Base.Utils.isDefined(e.framesReceived)&&(t.framesReceived=e.framesReceived)):(o.Base.Utils.isDefined(e.framesPerSecond)&&(t.actualFrameRateTransmitted=e.framesPerSecond),o.Base.Utils.isDefined(e.frameHeight)&&(t.heightTransmitted=e.frameHeight),o.Base.Utils.isDefined(e.frameWidth)&&(t.widthTransmitted=e.frameWidth),o.Base.Utils.isDefined(e.framesSent)&&(t.framesTransmitted=e.framesSent)))},e.prototype.processAudioTrackStats=function(e,t){o.Base.Utils.isDefined(e.remoteSource)&&(e.remoteSource?(o.Base.Utils.isDefined(e.totalAudioEnergy)&&(t.totalAudioEnergyReceived=e.totalAudioEnergy),o.Base.Utils.isDefined(e.audioLevel)&&(t.audioLevelReceived=e.audioLevel)):o.Base.Utils.isDefined(e.audioLevel)&&(t.audioLevelTransmitted=e.audioLevel))},e.prototype.processTrackStats=function(e,t,i){switch(e.kind){case o.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK:this.processVideoTrackStats(e,i);break;case o.Base.AbstractRTCConnectionProvider.Constants.AUDIO_TRACK:this.processAudioTrackStats(e,t)}},e.prototype.processAudioMediaSourceStats=function(e,t){o.Base.Utils.isDefined(e.totalAudioEnergy)&&(t.totalAudioEnergyTransmitted=e.totalAudioEnergy),o.Base.Utils.isDefined(e.audioLevel)&&(t.audioLevelTransmitted=e.audioLevel)},e.prototype.processMediaSourceStats=function(e,t,i){switch(e.kind){case o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.AUDIO:this.processAudioMediaSourceStats(e,t)}},e.prototype.processCodecGenericStats=function(e,t){o.Base.Utils.isDefined(e.mimeType)&&(t.codec=e.mimeType)},e.prototype.processCodecStats=function(e,t,i){switch(this.getCodecMediaType(e)){case o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.AUDIO:this.processCodecGenericStats(e,t);break;default:this.processCodecGenericStats(e,i)}},e.prototype.getMediaType=function(e){return e.mediaType},e.prototype.processRTCStats=function(e,t,i,a,r){switch(e.type){case this._inboundStatsType:this.processInboundStats(e,t,i,r);break;case this._outboundStatsType:this.processOutboundStats(e,t,i,r);break;case this._remoteInboundStatsType:this.processRemoteInboundStats(e,t,i,r);break;case this._remoteOutboundStatsType:this.processRemoteOutboundStats(e,t,i,r);break;case this._trackType:this.processTrackStats(e,t,i);break;case this._candidatePairType:this.processCandidatePairStats(e,t,i,a);break;case this._localCandidateType:this.processLocalCandidateStats(e);break;case this._remoteCandidateType:this.processRemoteCandidateStats(e);break;case this._mediaSourceType:this.processMediaSourceStats(e,t,i);break;case this._codec:this.processCodecStats(e,t,i)}},e.prototype.processVideoCandidatePairStats=function(e,t){o.Base.Utils.isDefined(e.currentRoundTripTime)&&(t.roundTripTimeMillis=1e3*e.currentRoundTripTime),o.Base.Utils.isDefined(e.availableOutgoingBitrate)&&(t.availableTransmitBitrate=e.availableOutgoingBitrate),o.Base.Utils.isDefined(e.availableIncomingBitrate)&&(t.availableReceiveBitrate=e.availableIncomingBitrate)},e.prototype.processCandidatePairStats=function(e,t,i,a){if("succeeded"===e.state){var r=this._localCandidates[e.localCandidateId],s=this._remoteCandidates[e.remoteCandidateId],n=e.ID||e.id;switch(r&&s&&(a[n]=new o.Base.CandidatePairStatistics(r,s)),this.getCandidatePairMediaType(e)){case o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.VIDEO:this.processVideoCandidatePairStats(e,i)}}},e.prototype.getCandidatePairMediaType=function(e){if(o.Base.Utils.isDefined(e.transportId)){if(-1!==e.transportId.search("audio"))return"audio";if(-1!==e.transportId.search("video"))return"video"}},e.prototype.getCodecMediaType=function(e){if(o.Base.Utils.isDefined(e.mimeType)){if(-1!==e.mimeType.search("audio"))return"audio";if(-1!==e.mimeType.search("video"))return"video"}},e.prototype.processLocalCandidateStats=function(e){var t=e.address||e.ip||"localhost",i=e.ID||e.id;this._localCandidates[i]=new o.Base.CandidateStatistics(t,e.port,e.protocol,e.candidateType)},e.prototype.processRemoteCandidateStats=function(e){var t=e.address||e.ip,i=e.ID||e.id;this._remoteCandidates[i]=new o.Base.CandidateStatistics(t,e.port,e.protocol,e.candidateType)},e.prototype.calculateStats=function(e,t){o.Base.Utils.isDefined(e.packetsReceived)&&(o.Base.Utils.isUndefined(e.packetLossTotalReceived)?e.fractionLostLocal=m:0===e.packetsReceived?e.fractionLostLocal=0:e.fractionLostLocal=e.packetLossTotalReceived/(e.packetsReceived+e.packetLossTotalReceived)),o.Base.Utils.isUndefined(t.packetsLossFractionTransmitted)&&(o.Base.Utils.isUndefined(t.packetsTransmitted)||o.Base.Utils.isUndefined(t.packetLossTotalTransmitted)?t.packetsLossFractionTransmitted=m:0===t.packetsTransmitted?t.packetsLossFractionTransmitted=0:t.packetsLossFractionTransmitted=t.packetLossTotalTransmitted/(t.packetsTransmitted+t.packetLossTotalTransmitted)),o.Base.Utils.isUndefined(t.packetsLossFractionReceived)&&(o.Base.Utils.isUndefined(t.packetsReceived)||o.Base.Utils.isUndefined(t.packetLossTotalReceived)?t.packetsLossFractionReceived=m:0===t.packetsReceived?t.packetsLossFractionReceived=0:t.packetsLossFractionReceived=t.packetLossTotalReceived/(t.packetsReceived+t.packetLossTotalReceived))},e.prototype.parse=function(t,i,a,r){i=i||new o.Base.AudioStatistics,a=a||new o.Base.VideoStatistics,r=r||{};return o.Base.Utils.forEach(t,function(e){this.processRTCStats(e,i,a,r,t)},this),this.calculateStats(i,a),{audioStatistics:i,videoStatistics:a,iceCandidateStatistics:r}},o.Base.AbstractRTCStatsReportParser=e}(AvayaClientServices),function(e){"use strict";(AvayaClientServices||{}).Base.AudioStatistics=function(e,t,i,a,r,s,n,o,c,l,d,C,u,v){this.bytesTransmitted=t,this.bytesReceived=e,this.packetsTransmitted=a,this.packetsReceived=i,this.roundTripTimeMilliseconds=r,this.packetLossTotalTransmitted=s,this.packetLossTotalReceived=n,this.jitterMillisecondsReceived=o,this.totalAudioEnergyTransmitted=l,this.totalAudioEnergyReceived=c,this.audioLevelTransmitted=C,this.audioLevelReceived=d,this.codec=u,this.fractionLostLocal=v}}(),function(i){"use strict";function e(e){this._previousAudioStatistics=m,this._previousVideoStatistics=m,this._call=e,this.isStarted=!1,this._interval=m,this._statisticsLog=m,this._config=i.Base.CallStatisticsLoggerConfig}e.prototype.start=function(){this.isStarted?i.Base.Logger.warn(i.Base.LoggerTags.CALL_STATISTICS,"CallStatisticLogger has already started"):(this._initialize(),this.isStarted=!0,this._logStatistics(),this._interval=setInterval(this._logStatistics.bind(this),this._config.INTERVAL_IN_MILLIS))},e.prototype._logStatistics=function(){var e,t;i.Base.Utils.isDefined(this._call)?(e=this._call.getAudioDetails(),t=this._call.getVideoDetails(),T.when(e,t).done(function(e,t){this._processStatistics(e,t),this._saveStatistics(e,t),this._logStats()}.bind(this)),T.when(e,t).fail(function(){this.stop(),i.Base.Logger.warn(i.Base.LoggerTags.CALL_STATISTICS,"Statistics of call ("+this._call.getCallId()+") are unavailable, stopping CallStatisticLogger")}.bind(this))):(this.stop(),i.Base.Logger.warn(i.Base.LoggerTags.CALL_STATISTICS,"Statistics cannot be processed because the call is not longer available, stopping CallStatisticLogger"))},e.prototype._processStatistics=function(t,i){var a;this._statisticsLog.forEach(function(e){e.mediaType===this._config.MEDIA_TYPE.AUDIO?a=t[e.key]:e.mediaType===this._config.MEDIA_TYPE.VIDEO&&(a=i[e.key]),this._processStatistic(e,a)},this)},e.prototype._processStatistic=function(e,t){i.Base.Utils.isDefined(t)?e.valueType===this._config.VALUE_TYPE.INSTANT?e.value=t:e.valueType===this._config.VALUE_TYPE.CALCULATED&&(this._statHasPreviousValue(e)?e.value=0===t?0:this._calculateStatValue(e,t):e.value=m):e.value=m},e.prototype._calculateStatValue=function(e,t){var i;return e.mediaType===this._config.MEDIA_TYPE.AUDIO?i=this._previousAudioStatistics[e.key]:e.mediaType===this._config.MEDIA_TYPE.VIDEO&&(i=this._previousVideoStatistics[e.key]),t-i},e.prototype._logStats=function(){var e=(new Date).getTime(),a='{"ID":"'+this._call.getCallId().slice(0,4)+'",';a+='"TS":"'+e+'",';this._statisticsLog.forEach(function(e,t){a+=e.getAlias()+":"+e.getValue();var i=t===this._statisticsLog.length-1;a+=i?"}":","}.bind(this)),i.Base.Logger.debug(i.Base.LoggerTags.CALL_STATISTICS,a)},e.prototype.stop=function(){this.isStarted?(this.isStarted=!1,this._cleanStatistics(),clearInterval(this._interval)):i.Base.Logger.warn(i.Base.LoggerTags.CALL_STATISTICS,"CallStatisticLogger is already stopped")},e.prototype._saveStatistics=function(e,t){this._previousAudioStatistics=e,this._previousVideoStatistics=t},e.prototype._cleanStatistics=function(){this._previousAudioStatistics=m,this._previousVideoStatistics=m,this._statisticsLog.forEach(function(e){e.value=m})},e.prototype._statHasPreviousValue=function(e){return e.mediaType===this._config.MEDIA_TYPE.AUDIO?!!i.Base.Utils.isDefined(this._previousAudioStatistics)&&i.Base.Utils.isDefined(this._previousAudioStatistics[e.key]):e.mediaType===this._config.MEDIA_TYPE.VIDEO?!!i.Base.Utils.isDefined(this._previousVideoStatistics)&&i.Base.Utils.isDefined(this._previousVideoStatistics[e.key]):void 0},e.prototype._initialize=function(){i.Base.Utils.isDefined(this._statisticsLog)||(this._statisticsLog=[],Object.keys(this._config.CALCULATED_AUDIO_STATS).forEach(function(e){this._statisticsLog.push(new i.Base.StatisticLog(e,this._config.CALCULATED_AUDIO_STATS[e],this._config.MEDIA_TYPE.AUDIO,this._config.VALUE_TYPE.CALCULATED))},this),Object.keys(this._config.INSTANT_AUDIO_STATS).forEach(function(e){this._statisticsLog.push(new i.Base.StatisticLog(e,this._config.INSTANT_AUDIO_STATS[e],this._config.MEDIA_TYPE.AUDIO,this._config.VALUE_TYPE.INSTANT))},this),Object.keys(this._config.CALCULATED_VIDEO_STATS).forEach(function(e){this._statisticsLog.push(new i.Base.StatisticLog(e,this._config.CALCULATED_VIDEO_STATS[e],this._config.MEDIA_TYPE.VIDEO,this._config.VALUE_TYPE.CALCULATED))},this),Object.keys(this._config.INSTANT_VIDEO_STATS).forEach(function(e){this._statisticsLog.push(new i.Base.StatisticLog(e,this._config.INSTANT_VIDEO_STATS[e],this._config.MEDIA_TYPE.VIDEO,this._config.VALUE_TYPE.INSTANT))},this))},i.Base.CallStatisticsLogger=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.CallStatisticsLoggerConfig={INTERVAL_IN_MILLIS:1e4,MEDIA_TYPE:{AUDIO:"audio",VIDEO:"video"},VALUE_TYPE:{INSTANT:"instant",CALCULATED:"calculated"},CALCULATED_AUDIO_STATS:{packetsReceived:"AI_PR",bytesReceived:"AI_BR",packetLossTotalReceived:"AI_PL",totalAudioEnergyReceived:"AI_TE",packetsTransmitted:"AO_PT",bytesTransmitted:"AO_BT",totalAudioEnergyTransmitted:"AO_TE"},CALCULATED_VIDEO_STATS:{packetsReceived:"VI_PR",bytesReceived:"VI_BR",packetLossTotalReceived:"VI_PL",framesReceived:"VI_FR",firCountReceived:"VI_FC",pliCountReceived:"VI_PC",nackCountReceived:"VI_NC",packetsTransmitted:"VO_PT",bytesTransmitted:"VO_BT",framesTransmitted:"VO_FT",firCountTransmitted:"VO_FC",pliCountTransmitted:"VO_PC",nackCountTransmitted:"VO_NC"},INSTANT_AUDIO_STATS:{jitterMillisecondsReceived:"AI_JR",audioLevelReceived:"AI_LR",audioLevelTransmitted:"AO_LT",roundTripTimeMilliseconds:"AO_RT"},INSTANT_VIDEO_STATS:{jitterMillisecondsReceived:"VI_JR",widthReceived:"VI_WR",heightReceived:"VI_HR",availableReceiveBitrate:"VI_AB",widthTransmitted:"VO_WT",heightTransmitted:"VO_HT",availableTransmitBitrate:"VO_AB",roundTripTimeMillis:"VO_RT"}}}(),function(e){"use strict";(AvayaClientServices||{}).Base.CandidatePairStatistics=function(e,t){this.local=e,this.remote=t}}(),function(e){"use strict";function t(e,t,i,a){this.address=e,this.port=t,this.protocol=i,this.type=a}t.prototype={toString:function(){return"[address: "+this.address+"; port: "+this.port+"; protocol: "+this.protocol+"; type: "+this.type+"]"}},e.Base.CandidateStatistics=t}(AvayaClientServices||{}),function(a){"use strict";function e(e,t,i){this._tlsOrTcpFound=!1,a.Base.RTCConnectionProvider.call(this,e,t,i),this._statsParser=new a.Base.EdgeRTCStatsReportParser}(e.prototype=Object.create(a.Base.AbstractRTCConnectionProvider.prototype)).addStream=function(e){a.Base.RTCConnectionProvider.prototype.addStream.call(this,e)},e.prototype.removeStream=function(e){a.Base.RTCConnectionProvider.prototype.removeStream.call(this,e)},e.prototype.createPeerConnection=function(e){if(e&&!T.isEmptyObject(e)){if(e.bundlePolicy="max-compat",this._tlsOrTcpFound=!1,0<e.iceServers.length)if(Array.isArray(e.iceServers[0].urls)){var t=e.iceServers[0].urls.length,i=e.iceServers[0].urls.filter(function(e){return e.includes("turn:")&&e.includes("?transport=udp")});t>i.length&&(this._tlsOrTcpFound=!0),e.iceServers[0].urls=i}else e.iceServers[0].urls.includes("stun:")&&(e.iceServers[0].urls=[]);a.Base.RTCConnectionProvider.prototype.createPeerConnection.call(this,e)}else{a.Base.RTCConnectionProvider.prototype.createPeerConnection.call(this,{bundlePolicy:"max-compat",iceTransportPolicy:"all",iceServers:[]})}"ontrack"in this._pc?this._pc.ontrack=this.onTrackInternal.bind(this):this._pc.onaddstream=this.onAddStreamInternal.bind(this)},e.prototype.onAddStreamInternal=function(e){a.Base.RTCConnectionProvider.prototype.onAddStreamInternal.call(this,e)},e.prototype._getDTMFSender=function(){return null},e.prototype.stopStream=function(e){a.Base.RTCConnectionProvider.prototype.stopStream.call(this,e)},e.prototype.stopAllStreams=function(){a.Base.RTCConnectionProvider.prototype.stopAllStreams.call(this)},e.prototype._enableDisableRemoteStreams=function(e){a.Base.RTCConnectionProvider.prototype._enableDisableRemoteStreams.call(this,e)},e.prototype._enableDisableLocalStreams=function(e){a.Base.RTCConnectionProvider.prototype._enableDisableLocalStreams.call(this,e)},e.prototype._enableDisableLocalAudioStreams=function(e){a.Base.RTCConnectionProvider.prototype._enableDisableLocalAudioStreams.call(this,e)},e.prototype._enableDisableLocalVideoStreams=function(e){a.Base.RTCConnectionProvider.prototype._enableDisableLocalVideoStreams.call(this,e)},e.prototype._enableDisableRemoteVideoStreams=function(e){a.Base.RTCConnectionProvider.prototype._enableDisableRemoteVideoStreams.call(this,e)},e.prototype._enableDisableRemoteAudioStream=function(e){a.Base.RTCConnectionProvider.prototype._enableDisableRemoteAudioStream.call(this,e)},e.prototype._throwSdpError=function(){this._tlsOrTcpFound?this._sdpErrorCallback({errorCode:a.Services.Call.CallError.TCP_TLS_TURN_NOT_SUPPORTED,protocolType:a.Services.Call.CallProtocolType.APPLICATION,errorMsg:"No ice candidates found. This browser doesn't support TCP or TLS TURN."}):this._sdpErrorCallback({errorCode:a.Services.Call.CallError.TRANSPORT_ERROR,protocolType:a.Services.Call.CallProtocolType.APPLICATION,errorMsg:"No ice candidates found in allocated time"})},e.prototype._answerError=function(e,t){if(0===this._iceCandidates.length&&this._tlsOrTcpFound){var i={errorCode:a.Services.Call.CallError.TCP_TLS_TURN_NOT_SUPPORTED,protocolType:a.Services.Call.CallProtocolType.APPLICATION,errorMsg:"Error while setting answer as local description: this browser doesn't support TCP or TLS TURN."};a.Base.Logger.error(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error while setting answer as local description: "+i),t(i)}else a.Base.Logger.error(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error while setting answer as local description: "+e),t(e)},e.prototype.addTrack=function(e,t){a.Base.Logger.debug(a.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Adding local track: "+e.kind+" : "+e.id),a.Base.AbstractRTCConnectionProvider.prototype.addTrack.call(this,e,t),t.addTrack(e)},e.prototype.removeLocalAudioTrack=function(){this._pc.getLocalStreams().forEach(function(t){t.getAudioTracks().forEach(function(e){e.stop(),t.removeTrack(e)})})},e.prototype.isRTCRtpSenderSupported=function(){return a.Base.RTCConnectionProvider.prototype.isRTCRtpSenderSupported()},e.prototype.adjustVideoConstraints=function(e,t,i){return T.Deferred().reject("Video constraints is NOT support by Edge").promise()},a.Base.EdgeRTCConnectionProvider=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.EdgeRTCConnectionProvider.Constants={RTC_STATS_TYPE:{INBOUNDRTP:"inboundrtp",OUTBOUNDRTP:"outboundrtp"}}}(),function(r){"use strict";function e(){r.Base.AbstractRTCStatsReportParser.call(this),this._inboundStatsType=r.Base.EdgeRTCConnectionProvider.Constants.RTC_STATS_TYPE.INBOUNDRTP,this._outboundStatsType=r.Base.EdgeRTCConnectionProvider.Constants.RTC_STATS_TYPE.OUTBOUNDRTP}(e.prototype=Object.create(r.Base.AbstractRTCStatsReportParser.prototype)).processTrackStats=function(e,t,i){0<e.frameHeight||-1!==e.trackIdentifier.search("video")?this.processVideoTrackStats(e,i):this.processAudioTrackStats(e,t)},e.prototype.processInboundGenericStats=function(e,t){r.Base.Utils.isDefined(e.packetsReceived)&&(t.packetsReceived=e.packetsReceived),r.Base.Utils.isDefined(e.bytesReceived)&&(t.bytesReceived=e.bytesReceived),r.Base.Utils.isDefined(e.packetsLost)&&(t.packetLossTotalReceived=e.packetsLost),r.Base.Utils.isDefined(e.jitter)&&(t.jitterMillisecondsReceived=1e3*e.jitter),r.Base.Utils.isDefined(e.fractionLost)&&(t.packetsLossFractionReceived=e.fractionLost),r.Base.Utils.isDefined(e.codecId)&&(t.codec=e.codecId)},e.prototype.processInboundStats=function(e,t,i,a){e.isRemote||(r.Base.AbstractRTCStatsReportParser.prototype.processInboundStats.call(this,e,t,i,a),t.bytesReceived=m,i.bytesReceived=m)},e.prototype.processOutboundStats=function(e,t,i,a){e.isRemote||(r.Base.AbstractRTCStatsReportParser.prototype.processOutboundStats.call(this,e,t,i,a),t.bytesTransmitted=m,i.bytesTransmitted=m)},e.prototype.processAudioTrackStats=function(e,t){},e.prototype.getMediaType=function(e,t){return e.codecId?"H264"===e.codecId?r.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.VIDEO:r.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.AUDIO:"H264"===t[e.associateStatsId].codecId?r.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.VIDEO:r.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.AUDIO},r.Base.EdgeRTCStatsReportParser=e}(AvayaClientServices),function(r){"use strict";function e(e,t,i){r.Base.AbstractRTCConnectionProvider.call(this,e,t,i),this._statsParser=new r.Base.FirefoxRTCStatsReportParser}(e.prototype=Object.create(r.Base.AbstractRTCConnectionProvider.prototype)).addStream=function(t){r.Base.AbstractRTCConnectionProvider.prototype.addStream.call(this,t),t.getTracks().forEach(function(e){this.addTrack(e,t)}.bind(this))},e.prototype.removeStream=function(e){this._pc.getSenders().forEach(function(t){e.getTracks().forEach(function(e){t&&t.track&&e.id===t.track.id&&(r.Base.Logger.debug(r.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Stopping and removing track: "+e.kind+" : "+e.id),e.stop(),this._pc.removeTrack(t))}.bind(this))}.bind(this))},e.prototype.createPeerConnection=function(e){r.Base.AbstractRTCConnectionProvider.prototype.createPeerConnection.call(this,e),this._pc.ontrack=this.onTrackInternal.bind(this)},e.prototype._getDTMFSender=function(){return r.Base.Utils.isDefined(this._dtmfSender)||this._pc.getSenders().forEach(function(e){e.track&&e.track.kind===r.Base.AbstractRTCConnectionProvider.Constants.AUDIO_TRACK&&e.track.readyState===r.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(this._dtmfSender=e.dtmf)}.bind(this)),this._dtmfSender},e.prototype.stopAllStreams=function(){if(this._pc){var t=!1;this._pc.getSenders().forEach(function(e){e.track&&(e.track.kind===r.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&(t=!0),e.track.stop(),this._pc.removeTrack(e))}.bind(this)),t||this._pc.getLocalStreams().forEach(function(e){e.getVideoTracks().forEach(function(e){e.stop()})}),this._pc.getReceivers().forEach(function(e){e.track&&e.track.stop()}.bind(this))}},e.prototype._enableDisableRemoteStreams=function(t){this._pc.getReceivers().forEach(function(e){e.track&&e.track.readyState===r.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(r.Base.Logger.debug(r.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling remote ":"Disabling remote ")+e.track.kind+" track: "+e.track.id),e.track.enabled=t)})},e.prototype._enableDisableLocalStreams=function(t){this._pc.getSenders().forEach(function(e){e.track&&e.track.readyState===r.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(r.Base.Logger.debug(r.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling local ":"Disabling local ")+e.track.kind+" track: "+e.track.id),e.track.enabled=t)})},e.prototype._enableDisableLocalAudioStreams=function(t){this._pc.getSenders().forEach(function(e){e.track&&e.track.kind===r.Base.AbstractRTCConnectionProvider.Constants.AUDIO_TRACK&&e.track.readyState===r.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(r.Base.Logger.debug(r.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" local audio track: "+e.track.id),e.track.enabled=t)}.bind(this))},e.prototype._enableDisableLocalVideoStreams=function(t){this._pc.getSenders().forEach(function(e){e.track&&e.track.kind===r.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&(e.track.readyState===r.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE?(e.track.enabled!==t||t)&&(r.Base.Logger.debug(r.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" local video track: "+e.track.id+":"+e.track.readyState),e.track.enabled=t):r.Base.Logger.debug(r.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+' local video track was skipped because the track is no longer "live": '+e.track.id+":"+e.track.readyState))}.bind(this))},e.prototype.setLocalVideoDirection=function(t){this._pc.getTransceivers().forEach(function(e){!e.stopped&&e.sender.track&&e.sender.track.kind===r.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&e.currentDirection!==t&&(e.sender.track.readyState===r.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE?(r.Base.Logger.debug(r.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Setting local video track direction "+t+":"+e.sender.track.id+":"+e.sender.track.readyState),e.direction=t):r.Base.Logger.debug(r.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Skipped setting local video track direction because the track is ended "+e.sender.track.id+":"+e.sender.track.readyState))}.bind(this))},e.prototype.isSetLocalVideoDirectionSupported=function(){return!0},e.prototype.hasVideoTrackStopStreaming=function(t){return 0!==this._pc.getTransceivers().filter(function(e){return!!e.sender.track&&e.sender.track.id===t.id&&(e.stopped||e.sender.track.readyState===r.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED)}.bind(this)).length},e.prototype._enableDisableRemoteVideoStreams=function(t){this._pc.getReceivers().forEach(function(e){e.track&&e.track.kind===r.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&e.track.readyState===r.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(r.Base.Logger.debug(r.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" remote video track: "+e.track.id),e.track.enabled=t)}.bind(this))},e.prototype._enableDisableRemoteAudioStream=function(t){this._pc.getReceivers().forEach(function(e){e.track&&e.track.kind===r.Base.AbstractRTCConnectionProvider.Constants.AUDIO_TRACK&&e.track.readyState===r.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(r.Base.Logger.debug(r.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" remote audio track: "+e.track.id),e.track.enabled=t)}.bind(this))},e.prototype.addTrack=function(e,t){r.Base.Logger.debug(r.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Adding local track: "+e.kind+" : "+e.id+":"+e.readyState),r.Base.AbstractRTCConnectionProvider.prototype.addTrack.call(this,e,t);var i=this._pc.addTrack(e,t);e.kind===r.Base.AbstractRTCConnectionProvider.Constants.AUDIO_TRACK&&r.Base.Utils.isDefined(i.dtmf)&&(this._dtmfSender=i.dtmf)},e.prototype.removeIfDoesNotSupportReplaceTrack=function(t){this._pc.getSenders().forEach(function(e){e.track&&e.track.id===t.id&&(r.Base.Logger.debug(r.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Removing local track: "+e.track.id),e.track.stop())}.bind(this))},e.prototype.enableRemoteVideoTrack=function(e,t){var i=0;this._pc.getReceivers().forEach(function(e){e.track&&e.track.kind===r.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&(i++,e.track.id!==t.id&&e.track.readyState===r.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(e.track.stop(),r.Base.Logger.debug(r.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Replacing remote video track  "+e.track.id+" with "+t.id)))}),0===i?(r.Base.Logger.debug(r.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Adding remote video track  "+t.id),this._pc.addTrack(t,e)):0===e.getVideoTracks().length&&e.addTrack(t)},e.prototype.isRTCRtpSenderSupported=function(){return!0},e.prototype.rollbackLocalOfferState=function(){"stable"!==this._pc.signalingState&&this._pc.setLocalDescription({type:"rollback"})},e.prototype.adjustVideoConstraints=function(e,t,i,a){return 360<=t&&t<=480&&(e=640,t=360),r.Base.AbstractRTCConnectionProvider.prototype.adjustVideoConstraints.call(this,e,t,i,a)},e.prototype.parseIceRelayCandidate=function(e,t){var i=/candidate:(\w{1,32}) (\d{1,5}) (udp|UDP) \d{1,10} (?:(?:(?:\d{1,3}.){3}\d{1,3})|(?:(?:[a-fA-F0-9]{0,4}:){7}[a-fA-F0-9]{0,4})) \d+ typ relay raddr (?:(?:(?:\d{1,3}.){3}\d{1,3})|(?:(?:[a-fA-F0-9]{0,4}:){7}[a-fA-F0-9]{0,4})) rport \d+/.exec(e);return i?{foundation:i[1],component:i[2],networkId:m}:m},r.Base.FirefoxRTCConnectionProvider=e}(AvayaClientServices),function(r){"use strict";function e(){r.Base.AbstractRTCStatsReportParser.call(this)}(e.prototype=Object.create(r.Base.AbstractRTCStatsReportParser.prototype)).processOutboundVideoStats=function(e,t){r.Base.AbstractRTCStatsReportParser.prototype.processOutboundVideoStats.call(this,e,t),r.Base.Utils.isDefined(e.bitrateMean)&&(t.actualBitRateTransmitted=e.bitrateMean),r.Base.Utils.isDefined(e.framerateMean)&&(t.actualFrameRateTransmitted=e.framerateMean),r.Base.Utils.isDefined(e.roundTripTime)&&(t.roundTripTimeMillis=1e3*e.roundTripTime)},e.prototype.processInboundVideoStats=function(e,t){r.Base.AbstractRTCStatsReportParser.prototype.processInboundVideoStats.call(this,e,t),r.Base.Utils.isDefined(e.bitrateMean)&&(t.actualBitRateReceived=e.bitrateMean),r.Base.Utils.isDefined(e.framerateMean)&&(t.actualFrameRateReceived=e.framerateMean)},e.prototype.processOutboundStats=function(e,t,i,a){!0!==e.isRemote&&r.Base.AbstractRTCStatsReportParser.prototype.processOutboundStats.call(this,e,t,i,a)},e.prototype.processInboundStats=function(e,t,i,a){!0===e.isRemote?this.processOutboundStats(e,t,i,a):r.Base.AbstractRTCStatsReportParser.prototype.processInboundStats.call(this,e,t,i,a)},r.Base.FirefoxRTCStatsReportParser=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Base.AbstractRTCConnectionProvider.ObservableRTCEvents={ICE_CONNECTION_STATE_CHANGED:"rtcProvider.iceConnectionStateChanged"}}(),function(o){"use strict";function e(e,t,i){o.Base.AbstractRTCConnectionProvider.call(this,e,t,i),this.isAvailable()&&(this._statsParser=new o.Base.RTCStatsReportParser)}(e.prototype=Object.create(o.Base.AbstractRTCConnectionProvider.prototype)).updatePeerConfiguration=function(e,t){o.Base.AbstractRTCConnectionProvider.prototype.updatePeerConfiguration.call(this,e,t)},e.prototype.addStream=function(t){o.Base.AbstractRTCConnectionProvider.prototype.addStream.call(this,t),this._isRTCRtpSenderSupported?t.getTracks().forEach(function(e){this.addTrack(e,t)}.bind(this)):this._pc.addStream(t)},e.prototype.addTrack=function(e,t){o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Adding local track: "+e.kind+" : "+e.id+":"+e.readyState),o.Base.AbstractRTCConnectionProvider.prototype.addTrack.call(this,e,t);var i=this._pc.addTrack(e,t);e.kind===o.Base.AbstractRTCConnectionProvider.Constants.AUDIO_TRACK&&o.Base.Utils.isDefined(i.dtmf)&&(this._dtmfSender=i.dtmf)},e.prototype.removeStream=function(e){this._isRTCRtpSenderSupported?this._pc.getSenders().forEach(function(t){e.getTracks().forEach(function(e){t&&t.track&&e.id===t.track.id&&(o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Stopping and removing track: "+e.kind+" : "+e.id),e.stop(),this._pc.removeTrack(t))}.bind(this))}.bind(this)):this._pc.removeStream(e)},e.prototype.createPeerConnection=function(e){e.sdpSemantics="plan-b",o.Base.AbstractRTCConnectionProvider.prototype.createPeerConnection.call(this,e),"ontrack"in this._pc?this._pc.ontrack=this.onTrackInternal.bind(this):this._pc.onaddstream=this.onAddStreamInternal.bind(this),this._isRTCRtpSenderSupported="function"==typeof this._pc.getSenders},e.prototype.onAddStreamInternal=function(e){var t=e.stream;t&&(t.onaddtrack=this.onAddTrackInternal.bind(this),t.onremovetrack=this.onRemoveTrackInternal.bind(this),this.onAddStream&&this.onAddStream(e.stream))},e.prototype._getDTMFSender=function(){return o.Base.Utils.isDefined(this._dtmfSender)||(this._isRTCRtpSenderSupported?this._pc.getSenders().forEach(function(e){e.track&&e.track.kind===o.Base.AbstractRTCConnectionProvider.Constants.AUDIO_TRACK&&e.track.readyState===o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(this._dtmfSender=e.dtmf)}.bind(this)):this._pc.getLocalStreams().forEach(function(e){var t=e.getAudioTracks()[0];o.Base.Utils.isDefined(t)&&(this._dtmfSender=this._pc.createDTMFSender(t))}.bind(this))),this._dtmfSender},e.prototype.stopAllStreams=function(){this._pc&&(this._isRTCRtpSenderSupported?this._pc.getSenders().forEach(function(e){e.track&&(e.track.stop(),this._pc.removeTrack(e))}.bind(this)):this._pc.getLocalStreams().forEach(function(e){e.getAudioTracks().forEach(function(e){e.stop()}),e.getVideoTracks().forEach(function(e){e.stop()}),this._pc.removeStream(e)}.bind(this)),this._pc.getRemoteStreams().forEach(function(e){e.getAudioTracks().forEach(function(e){e.stop()}),e.getVideoTracks().forEach(function(e){e.stop()})}))},e.prototype._enableDisableRemoteStreams=function(t){this._pc.getRemoteStreams().forEach(function(e){e.getAudioTracks().forEach(function(e){e.readyState!==o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" remote audio track: "+e.id),e.enabled=t)}),e.getVideoTracks().forEach(function(e){e.readyState!==o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" remote video track: "+e.id),e.enabled=t)})})},e.prototype._enableDisableLocalStreams=function(t){this._isRTCRtpSenderSupported?this._pc.getSenders().forEach(function(e){e.track&&e.track.readyState===o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling local ":"Disabling local ")+e.track.kind+" track: "+e.track.id),e.track.enabled=t)}):this._pc.getLocalStreams().forEach(function(e){e.getAudioTracks().forEach(function(e){e.readyState!==o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" local audio track: "+e.id),e.enabled=t)}),e.getVideoTracks().forEach(function(e){e.readyState!==o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" local video track: "+e.id),e.enabled=t)})})},e.prototype._enableDisableLocalAudioStreams=function(t){this._isRTCRtpSenderSupported?this._pc.getSenders().forEach(function(e){e.track&&e.track.kind===o.Base.AbstractRTCConnectionProvider.Constants.AUDIO_TRACK&&e.track.readyState===o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" local audio track: "+e.track.id),e.track.enabled=t)}.bind(this)):this._pc.getLocalStreams().forEach(function(e){e.getAudioTracks().forEach(function(e){e.readyState!==o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" local audio track: "+e.id),e.enabled=t)})})},e.prototype._enableDisableLocalVideoStreams=function(t){this._isRTCRtpSenderSupported?this._pc.getSenders().forEach(function(e){e.track&&e.track.kind===o.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&(e.track.readyState===o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE?(e.track.enabled=t,o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" local video track: "+e.track.id+":"+e.track.readyState)):(e.track.enabled=t,o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+' local video track was skipped because the track is no longer "live": '+e.track.id+":"+e.track.readyState)))}.bind(this)):this._pc.getLocalStreams().forEach(function(e){e.getVideoTracks().forEach(function(e){e.readyState!==o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" local video track: "+e.id),e.enabled=t)})})},e.prototype._enableDisableRemoteVideoStreams=function(t){this._pc.getRemoteStreams().forEach(function(e){e.getVideoTracks().forEach(function(e){e.readyState!==o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" remote video track: "+e.id),e.enabled=t)})})},e.prototype._enableDisableRemoteAudioStream=function(t){this._pc.getRemoteStreams().forEach(function(e){e.getAudioTracks().forEach(function(e){e.readyState!==o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" remote audio track: "+e.id),e.enabled=t)})})},e.prototype.removeIfDoesNotSupportReplaceTrack=function(t){this._pc.getSenders().forEach(function(e){e.track&&e.track.id===t.id&&(e.track.stop(),"function"!=typeof e.replaceTrack&&(o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Removing local track: "+e.track.id),this._pc.removeTrack(e)))}.bind(this))},e.prototype.replaceLocalMediaTrack=function(i,a){var r=T.Deferred(),e=0,s=function(e){e&&this._pc.removeTrack(e),a?(o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Adding local "+i.kind+" track  "+i.id),this._pc.addTrack(i,a),a.addTrack(i),r.resolve()):(o.Base.Logger.warn(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Failed to add local "+i.kind+" track  "+i.id+" due to missing media stream"),r.reject("Missing local media stream"))}.bind(this);return this._pc.getSenders().forEach(function(t){t.track&&t.track.kind===i.kind&&"function"==typeof t.replaceTrack&&(e++,t.track.readyState!==o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED?(o.Base.Logger.debug(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Replacing local "+i.kind+" track  "+t.track.id+" with "+i.id),t.replaceTrack(i).then(function(){a&&a.addTrack(i),r.resolve()}).catch(function(e){o.Base.Logger.info(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"<<< Adding "+i.kind+" track instead due to "+e),s(t)})):(o.Base.Logger.info(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"<<< Adding "+i.kind+" track instead because previous track was ended"),s(t)))}),0===e&&s(),r.promise()},e.prototype.getStats=function(){if(this.isRTCRtpSenderSupported()){var t=T.Deferred(),i=new o.Base.AudioStatistics,a=new o.Base.VideoStatistics,r={},s=[];return this._pc.getSenders().forEach(function(e){e.track&&e.track.readyState===o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&s.push(e.getStats().then(function(e){this._statsParser.parse(e,i,a,r)}.bind(this)))}.bind(this)),this._pc.getReceivers().forEach(function(e){e.track&&e.track.readyState===o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&s.push(e.getStats().then(function(e){this._statsParser.parse(e,i,a,r)}.bind(this)))}.bind(this)),T.when.apply(this,s).then(function(){t.resolve({audioStatistics:i,videoStatistics:a,iceCandidateStatistics:r})},function(e){o.Base.Logger.error(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error getting stats report from RTCPeerConnection: "+e),t.reject(e)}),t.promise()}if(0===RTCPeerConnection.prototype.getStats.length)return this._pc.getStats().then(function(e){return this._statsParser.parse(e)}.bind(this)).catch(function(e){return o.Base.Logger.error(o.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Error getting stats report from RTCPeerConnection: "+e),Promise.reject(e)});var n=T.Deferred();return this._pc.getStats(function(e){var t=this._statsParser.fallback(e);n.resolve(t)}),n.promise()},e.prototype.isRTCRtpSenderSupported=function(){return this._isRTCRtpSenderSupported},e.prototype.parseIceRelayCandidate=function(e,t){var i=/candidate:(\w{1,32}) (\d{1,5}) udp \d{1,10} (?:(?:(?:\d{1,3}.){3}\d{1,3})|(?:(?:[a-fA-F0-9]{0,4}:){7}[a-fA-F0-9]{0,4})) \d+ typ relay raddr (?:(?:(?:\d{1,3}.){3}\d{1,3})|(?:(?:[a-fA-F0-9]{0,4}:){7}[a-fA-F0-9]{0,4})) rport \d+ .* network-id (\d+)/.exec(e);return i?t?{foundation:t.foundation||i[1],component:t.component||i[2],networkId:i[3]}:{foundation:i[1],component:i[2],networkId:i[3]}:m},o.Base.RTCConnectionProvider=e}(AvayaClientServices),function(r){"use strict";function e(){}e.prototype={create:function(e,t,i){var a=r.Base.Utils.getBrowserType();return a===r.Base.BrowserType.CHROME||a===r.Base.BrowserType.CHROME_EXTENSION?new r.Base.RTCConnectionProvider(e,t,i):a===r.Base.BrowserType.EDGE?new r.Base.EdgeRTCConnectionProvider(e,t,i):a===r.Base.BrowserType.SAFARI?new r.Base.SafariRTCConnectionProvider(e,t,i):a===r.Base.BrowserType.FIREFOX||a===r.Base.BrowserType.FIREFOX_EXTENSION?new r.Base.FirefoxRTCConnectionProvider(e,t,i):m}},r.Base.RTCConnectionProviderFactory=e}(AvayaClientServices),function(C){"use strict";function e(){C.Base.AbstractRTCStatsReportParser.call(this)}(e.prototype=Object.create(C.Base.AbstractRTCStatsReportParser.prototype)).fallback=function(e){var i,a,r,s,t,n,o,c,l,d;return e.result().forEach(function(e){var t=e.stat("mediaType");"ssrc"===e.type&&-1<e.id.indexOf("send")&&"audio"===t&&(i=e),"ssrc"===e.type&&-1<e.id.indexOf("send")&&"video"===t&&(r=e),"ssrc"===e.type&&-1<e.id.indexOf("recv")&&"audio"===t&&(a=e),"ssrc"===e.type&&-1<e.id.indexOf("recv")&&"video"===t&&(s=e)}),a&&i&&(t={bytesReceived:parseInt(a.stat("bytesReceived")),packetsReceived:parseInt(a.stat("packetsReceived")),packetsLost:parseInt(a.stat("packetsLost")),googJitterReceived:parseInt(a.stat("googJitterReceived"))},n={bytesSent:parseInt(i.stat("bytesSent")),packetsSent:parseInt(i.stat("packetsSent")),googRtt:parseInt(i.stat("googRtt")),packetsLost:parseInt(i.stat("packetsLost"))},""===i.stat("packetsLost")&&(n.packetsLost=0),""===i.stat("googRtt")&&(n.googRtt=0),l=new C.Base.AudioStatistics(t.bytesReceived,n.bytesSent,t.packetsReceived,n.packetsSent,n.googRtt,n.packetsLost,t.packetsLost,t.googJitterReceived)),s&&r&&(o={bytesReceived:parseInt(s.stat("bytesReceived")),actualBitRateReceived:m,packetsReceived:parseInt(s.stat("packetsReceived")),packetsLost:parseInt(s.stat("packetsLost")),googFrameRateReceived:parseInt(s.stat("googFrameRateReceived"))},C.Base.Utils.isUndefined(o.packetsLost)&&(o.packetsLost=0),C.Base.Utils.isUndefined(o.packetsReceived)&&(o.packetsReceived=0),0===o.packetsReceived?o.packetsLossFractionReceived=0:o.packetsLossFractionReceived=s.stat("packetsLost")/s.stat("packetsReceived"),c={bytesSent:parseInt(r.stat("bytesSent")),actualBitRateTransmitted:m,packetsSent:parseInt(r.stat("packetsSent")),packetsLost:parseInt(r.stat("packetsLost")),googFrameRateSent:parseInt(r.stat("googFrameRateSent"))},C.Base.Utils.isUndefined(c.packetsLost)&&(c.packetsLost=0),C.Base.Utils.isUndefined(c.packetsSent)&&(c.packetsSent=0),0===c.packetsSent?c.packetsLossFractionTransmitted=0:c.packetsLossFractionTransmitted=r.stat("packetsLost")/r.stat("packetsSent"),d=new C.Base.VideoStatistics(c.bytesSent,o.bytesReceived,c.actualBitRateTransmitted,o.actualBitRateReceived,c.packetsSent,o.packetsReceived,c.packetsLost,o.packetsLost,c.packetsLossFractionTransmitted,o.packetsLossFractionReceived,c.googFrameRateSent,o.googFrameRateReceived)),{audioStatistics:l,videoStatistics:d}},C.Base.RTCStatsReportParser=e}(AvayaClientServices),function(n){"use strict";function e(e,t,i){this._sdkStream=m,this._foundCandidates=!1,n.Base.AbstractRTCConnectionProvider.call(this,e,t,i),this._statsParser=new n.Base.SafariRTCStatsReportParser}(e.prototype=Object.create(n.Base.AbstractRTCConnectionProvider.prototype)).addStream=function(t){n.Base.AbstractRTCConnectionProvider.prototype.addStream.call(this,t),t.getTracks().forEach(function(e){this.addTrack(e,t)}.bind(this))},e.prototype.removeStream=function(e){this._pc.getSenders().forEach(function(t){e.getTracks().forEach(function(e){t&&t.track&&e.id===t.track.id&&(n.Base.Logger.debug(n.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Stopping and removing track: "+e.kind+" : "+e.id),e.stop(),this._pc.removeTrack(t))}.bind(this))}.bind(this))},e.prototype.createPeerConnection=function(e){e.sdpSemantics="plan-b",n.Base.AbstractRTCConnectionProvider.prototype.createPeerConnection.call(this,e),this._pc.ontrack=this.onTrackInternal.bind(this)},e.prototype._getDTMFSender=function(){return this._dtmfSender!==m&&this._pc.getSenders().forEach(function(e){e.track!==m&&e.track.kind===n.Base.AbstractRTCConnectionProvider.Constants.AUDIO_TRACK&&(this._dtmfSender=e.dtmf)}),this._dtmfSender},e.prototype.stopAllStreams=function(){this._pc&&(this._pc.getSenders().forEach(function(e){e.track&&(e.track.stop(),this._pc.removeTrack(e))}.bind(this)),this._pc.getReceivers().forEach(function(e){e.track&&e.track.stop()}.bind(this)))},e.prototype._enableDisableRemoteStreams=function(t){this._pc.getReceivers().forEach(function(e){e.track&&e.track.readyState===n.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(n.Base.Logger.debug(n.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling remote ":"Disabling remote ")+e.track.kind+" track: "+e.track.id),e.track.enabled=t)})},e.prototype._enableDisableLocalStreams=function(t){this._pc.getSenders().forEach(function(e){e.track&&e.track.readyState===n.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(n.Base.Logger.debug(n.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling local ":"Disabling local ")+e.track.kind+" track: "+e.track.id),e.track.enabled=t)})},e.prototype._enableDisableLocalAudioStreams=function(t){this._pc.getSenders().forEach(function(e){e.track&&e.track.kind===n.Base.AbstractRTCConnectionProvider.Constants.AUDIO_TRACK&&e.track.readyState===n.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(n.Base.Logger.debug(n.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" local audio track: "+e.track.id),e.track.enabled=t)}.bind(this))},e.prototype._enableDisableLocalVideoStreams=function(t){this._pc.getSenders().forEach(function(e){e.track&&e.track.kind===n.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&e.track.readyState===n.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(n.Base.Logger.debug(n.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" local video track: "+e.track.id),e.track.enabled=t)}.bind(this))},e.prototype._enableDisableRemoteVideoStreams=function(t){this._pc.getReceivers().forEach(function(e){e.track&&e.track.kind===n.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&e.track.readyState===n.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE&&(n.Base.Logger.debug(n.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,(t?"Enabling":"Disabling")+" remote video track: "+e.track.id),e.track.enabled=t)}.bind(this))},e.prototype.addTrack=function(e,t){n.Base.Logger.debug(n.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Adding local track: "+e.kind+" : "+e.id),n.Base.AbstractRTCConnectionProvider.prototype.addTrack.call(this,e,t);var i=this._pc.addTrack(e,t);e.kind===n.Base.AbstractRTCConnectionProvider.Constants.AUDIO_TRACK&&n.Base.Utils.isDefined(i.dtmf)&&(this._dtmfSender=i.dtmf)},e.prototype.replaceLocalVideoTrack=function(t){this._pc.getSenders().forEach(function(e){e.track&&e.track.kind===n.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&(n.Base.Logger.debug(n.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Replacing local video track "+e.track.id+" with "+t.id),e.track.stop(),e.replaceTrack(t))})},e.prototype.isRTCRtpSenderSupported=function(){return!0},e.prototype.addRecvOnlyTransceiverIfNeeded=function(e){return!!e&&(this._pc.addTransceiver("video"),!0)},e.prototype.parseIceRelayCandidate=function(e,t){var i=/candidate:(\w{1,32}) (\d{1,5}) udp \d{1,10} (?:(?:(?:\d{1,3}.){3}\d{1,3})|(?:(?:[a-fA-F0-9]{0,4}:){7}[a-fA-F0-9]{0,4})) \d+ typ relay raddr (?:(?:(?:\d{1,3}.){3}\d{1,3})|(?:(?:[a-fA-F0-9]{0,4}:){7}[a-fA-F0-9]{0,4})) rport \d+ .*/.exec(e);return i?{foundation:i[1],component:i[2],networkId:m}:m},e.prototype.setLocalVideoDirection=function(t){this._pc.getTransceivers().forEach(function(e){!e.stopped&&e.sender.track&&e.sender.track.kind===n.Base.AbstractRTCConnectionProvider.Constants.VIDEO_TRACK&&e.currentDirection!==t&&(e.sender.track.readyState===n.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE?(n.Base.Logger.debug(n.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Setting local video track direction "+t+":"+e.sender.track.id+":"+e.sender.track.readyState),e.direction=t):n.Base.Logger.debug(n.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Skipped setting local video track direction because the track is ended "+e.sender.track.id+":"+e.sender.track.readyState))}.bind(this))},e.prototype.isSetLocalVideoDirectionSupported=function(){return!0},e.prototype.removeIfDoesNotSupportReplaceTrack=function(t){this._pc.getTransceivers().forEach(function(e){e.sender.track&&e.sender.track.id===t.id&&e.sender.track.stop()})},e.prototype.replaceLocalMediaTrack=function(t,i){var a=T.Deferred(),r=0,s=function(){i?(n.Base.Logger.debug(n.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Adding local "+t.kind+" track  "+t.id),this._pc.addTrack(t,i),i.addTrack(t),a.resolve()):(n.Base.Logger.warn(n.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Failed to add local "+t.kind+" track  "+t.id+" due to missing media stream"),a.reject("Missing local media stream"))}.bind(this);return this._pc.getTransceivers().forEach(function(e){e.sender.track&&e.sender.track.kind===t.kind&&(r++,n.Base.Logger.debug(n.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"Replacing local "+t.kind+" track  "+e.sender.track.id+" with "+t.id),e.sender.track.stop(),e.sender.replaceTrack(t).then(function(){i&&i.addTrack(t),e.direction===n.Services.Call.MediaDirection.INACTIVE&&(e.direction=n.Services.Call.MediaDirection.SEND_RECV),a.resolve()}).catch(function(e){n.Base.Logger.info(n.Base.LoggerTags.RTC_CALL_CONNECTION_PROVIDER,"<<< Adding "+t.kind+" track instead due to "+e),s()}))}),0===r&&s(),a.promise()},n.Base.SafariRTCConnectionProvider=e}(AvayaClientServices),function(o){"use strict";function e(){this._audioTransportId=m,this._videoTransportId=m,o.Base.AbstractRTCStatsReportParser.call(this)}(e.prototype=Object.create(o.Base.AbstractRTCStatsReportParser.prototype)).processInboundStats=function(e,t,i,a){switch(this.getMediaType(e,a)){case o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.AUDIO:this.processInboundGenericStats(e,t),o.Base.Utils.isDefined(e.transportId)&&(this._audioTransportId=e.transportId);break;case o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.VIDEO:this.processInboundGenericStats(e,i),this.processInboundVideoStats(e,i),o.Base.Utils.isDefined(e.transportId)&&(this._videoTransportId=e.transportId)}},e.prototype.processTrackStats=function(e,t,i){e.frameHeight!==m?this.processVideoTrackStats(e,i):this.processAudioTrackStats(e,t)},e.prototype.processCandidatePairStats=function(e,t,i,a){if("succeeded"===e.state){var r=this._localCandidates[e.localCandidateId],s=this._remoteCandidates[e.remoteCandidateId],n=e.ID||e.id;switch(r&&s&&(a[n]=new o.Base.CandidatePairStatistics(r,s)),this.getCandidatePairMediaType(e,t,i)){case o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.VIDEO:this.processVideoCandidatePairStats(e,i)}}},e.prototype.getMediaType=function(e,t){return e.type===o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_TYPE.OUTBOUND_RTP?e.mediaType:-1!==e.id.indexOf("Audio")?o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.AUDIO:o.Base.AbstractRTCConnectionProvider.Constants.RTC_STATS_MEDIA_TYPE.VIDEO},e.prototype.getCandidatePairMediaType=function(e,t,i){if(o.Base.Utils.isDefined(e.transportId)){if(this._audioTransportId===e.transportId)return"audio";if(this._videoTransportId===e.transportId)return"video"}},o.Base.SafariRTCStatsReportParser=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a){this.key=e,this.value=m,this.valueType=a,this.mediaType=i,this.alias=t}t.prototype.getValue=function(){return e.Base.Utils.isDefined(this.value)?'"'+this.value+'"':'"undefined"'},t.prototype.getAlias=function(){return'"'+this.alias+'"'},e.Base.StatisticLog=t}(AvayaClientServices),function(e){"use strict";(AvayaClientServices||{}).Base.VideoStatistics=function(e,t,i,a,r,s,n,o,c,l,d,C,u,v,h,p,_,S,g,f,E,A,P,T,y,b,I,R,m,D,N){this.bytesTransmitted=e,this.bytesReceived=t,this.actualBitRateTransmitted=i,this.actualBitRateReceived=a,this.packetsTransmitted=r,this.packetsReceived=s,this.packetLossTotalTransmitted=n,this.packetLossTotalReceived=o,this.packetsLossFractionTransmitted=c,this.packetsLossFractionReceived=l,this.actualFrameRateTransmitted=d,this.actualFrameRateReceived=C,this.framesEncoded=u,this.framesDecoded=v,this.codec=h,this.roundTripTimeMillis=p,this.heightTransmitted=S,this.heightReceived=_,this.widthTransmitted=f,this.widthReceived=g,this.firCountTransmitted=A,this.firCountReceived=E,this.pliCountTransmitted=T,this.pliCountReceived=P,this.framesTransmitted=y,this.framesReceived=b,this.nackCountTransmitted=R,this.nackCountReceived=I,this.availableTransmitBitrate=m,this.availableReceiveBitrate=D,this.jitterMillisecondsReceived=N}}(),function(r){"use strict";var s="m=audio",n="m=video",t="a=recvonly",i="a=sendonly",a="a=sendrecv",o="a=inactive",c="profile-level-id";r.Base.SDPUtil={updateAudioSdpInactive:function(e){return r.Base.SDPUtil.updateSdp(e,s,o)},updateAudioSdpRecvOnly:function(e){return r.Base.SDPUtil.updateSdp(e,s,t)},updateAudioSdpSendOnly:function(e){return r.Base.SDPUtil.updateSdp(e,s,i)},updateAudioSdpSendRecv:function(e){return r.Base.SDPUtil.updateSdp(e,s,a)},updateVideoSdpInactive:function(e){return r.Base.SDPUtil.updateSdp(e,n,o)},updateVideoSdpRecvOnly:function(e){return r.Base.SDPUtil.updateSdp(e,n,t)},updateVideoSdpSendOnly:function(e){return r.Base.SDPUtil.updateSdp(e,n,i)},updateVideoSdpSendRecv:function(e){return r.Base.SDPUtil.updateSdp(e,n,a)},updateSdp:function(e,t,i){if(-1===e.indexOf(t))return e;var a=e.indexOf(s),r=e.indexOf(n);return t===s?a<r?e.substring(0,a)+e.substring(a,r).replace(/a=inactive|a=sendrecv|a=recvonly|a=sendonly/,i)+e.substring(r):e.substring(0,a)+e.substring(a).replace(/a=inactive|a=sendrecv|a=recvonly|a=sendonly/,i):r<a?e.substring(0,r)+e.substring(r,a).replace(/a=inactive|a=sendrecv|a=recvonly|a=sendonly/,i)+e.substring(a):e.substring(0,r)+e.substring(r).replace(/a=inactive|a=sendrecv|a=recvonly|a=sendonly/,i)},rejectMedia:function(e,t){return-1===e.indexOf(t)?e:t===s?e.replace(/(m=audio)\s+(\d+)\s+(.*)/,"m=audio 0 $3"):t===n?e.replace(/(m=video)\s+(\d+)\s+(.*)/,"m=video 0 $3"):e},updateProfileLevelId:function(e,t){var i=e.indexOf(c);if(-1<i){var a=e.substring(i+c.length+1,i+c.length+1+6);a!==t&&(e=e.replace(a,t),r.Base.Logger.debug(r.Base.LoggerTags.UTILS,"CHANGED the profile-level-id value of the SDP from:",a,"to:",t))}return e},getProfileLevelId:function(e){var t=e.indexOf(c);return-1<t?e.substring(t+c.length+1,t+c.length+1+6):m},hasH264:function(e){var t=e.indexOf(n);if(-1===t)return!1;var i=e.indexOf(s);return null!==(t<i?e.substring(t,i):e.substring(t)).match(/a=rtpmap:\d+ H264\/\d+/)}}}(AvayaClientServices),function(c){"use strict";function e(e,t,i){this._data="",this._currentLineIndex=0,this._getSettingsFileVariable="function"==typeof e?e:m,this._setSettingsFileVariable="function"==typeof t?t:m,this._onAdditionalSettingsFileRequested="function"==typeof i?i:m}e.prototype.parse=function(e){return"string"!=typeof e||0===e.length||(this._data=e,this._currentLineIndex=0,this.proceed())},e.prototype.proceed=function(){for(var e,t,i=this._splitByLines(this._data),a=i.length,r=!0;this._currentLineIndex<a;this._currentLineIndex++)if(0!==(t=i[this._currentLineIndex].trim()).length&&"#"!==t.charAt(0)){var s=this._getLineArr(t);if(s.length){var n=s[0].toUpperCase(),o=s.slice(1);switch(n){case"SET":this._processSET(o);break;case"GOTO":0<=(e=this._processGOTO(o))&&(this._currentLineIndex=e);break;case"IF":0<=(e=this._processIF(o))&&(this._currentLineIndex=e);break;case"GET":this._currentLineIndex++,r=this._processGET(o);break;default:c.Base.Logger.warn(c.Base.LoggerTags.SETTINGS_FILE_PARSER,"SettingsFileParser: Unknown command",n)}}if(!r)return!1}return!0},e.prototype._splitByLines=function(e){return e.split(/\r\n|\r|\n/g)},e.prototype._trimSharp=function(e){return e.trim().replace(/^#+|#+$/g,"").trim()},e.prototype._getLineArr=function(e){var a=e.match(/("([^"]*)"|([^"\s]+))+(?=(\s*|\s*$))/g)||[];return a.length&&a.forEach(function(e,t,i){a[t]=e.replace(/"/g,"")}),a},e.prototype._processSET=function(e){if(this._setSettingsFileVariable){var t=e.length;if(t){var i=e[0],a=1<t?e[1]:"";this._setSettingsFileVariable(i,a)}}},e.prototype._processGET=function(e){return!this._onAdditionalSettingsFileRequested||(!e.length||(this._onAdditionalSettingsFileRequested(e[0]),!1))},e.prototype._processGOTO=function(e){var t=-1;if(e.length)for(var i,a=e[0],r=this._splitByLines(this._data),s=r.length,n=0;n<s;n++)if("#"===(i=r[n].trim()).charAt(0)&&"#"!==i.charAt(1)&&a===this._trimSharp(i)){t=n;break}return t},e.prototype._processIF=function(e){if(!this._getSettingsFileVariable)return-1;if(e.length<5)return-1;var t=e[0],i=e[1],a=e[2],r=e[3],s=e[4];return t.toString().length<=1||"$"!==t.charAt(0)?-1:"SEQ"!==i.toUpperCase()?-1:0===a.toString().length?-1:"GOTO"!==r.toUpperCase()?-1:(t=t.substr(1).toUpperCase(),this._getSettingsFileVariable(t)===a?this._processGOTO([s]):-1)},c.Base.SettingsFileParser=e}(AvayaClientServices),function(i){"use strict";function e(){this._handlers={},this.currentState=null}i.Base.SimpleFsm=function(){},e.prototype={handleEvent:function(e){if(e.stringValue)if(this.currentState&&this._handlers)if(this._handlers[this.currentState.stringValue])if(this._handlers[this.currentState.stringValue][e.stringValue]){i.Base.Logger.debug(i.Base.LoggerTags.FSM,"Executing handler for state "+this.currentState.stringValue+" and event "+e.stringValue+" "+this._handlers[this.currentState.stringValue][e.stringValue].name);var t=this._handlers[this.currentState.stringValue][e.stringValue](e);i.Base.Logger.debug(i.Base.LoggerTags.FSM,"Executed handler "+this._handlers[this.currentState.stringValue][e.stringValue].name),t&&t.nextState&&(i.Base.Logger.debug(i.Base.LoggerTags.FSM,"Next state: "+t.nextState.stringValue),this.currentState=t.nextState),t&&t.nextEvent&&(i.Base.Logger.debug(i.Base.LoggerTags.FSM,"Next event: "+t.nextEvent.stringValue),this.handleEvent(t.nextEvent))}else i.Base.Logger.error(i.Base.LoggerTags.FSM,"No handler bound for state "+this.currentState.stringValue+" and event "+e.stringValue);else i.Base.Logger.error(i.Base.LoggerTags.FSM,"No handler bound for state "+this.currentState.stringValue+" and event "+e.stringValue);else i.Base.Logger.error(i.Base.LoggerTags.FSM,"State machine's state was not initialized");else i.Base.Logger.error(i.Base.LoggerTags.FSM,"Unknown event: "+e)},registerHandler:function(e,t,i){if(this._handlers[e.stringValue]||(this._handlers[e.stringValue]={}),this._handlers[e.stringValue][t.stringValue])throw"Duplicate FSM registration state "+e.stringValue+" event "+t.stringValue;this._handlers[e.stringValue][t.stringValue]=i},registerNoOpHandler:function(e,t){this.registerHandler(e,t,function(){})},start:function(e){this.currentState=e}},i.Base.SimpleFsm.SimpleFsm=e}(AvayaClientServices),function(e){"use strict";function t(e,t){this.stringValue=e,this.data=t}t.prototype={},e.Base.SimpleFsm.SimpleFsmEvent=t}(AvayaClientServices),function(e){"use strict";function t(e){this.stringValue=e}t.prototype={},e.Base.SimpleFsm.SimpleFsmState=t}(AvayaClientServices),function(e){"use strict";var r="AVAYA_JSCSDK_1.0";e.Base.Storage={TYPES:{LOCAL:window.localStorage,SESSION:window.sessionStorage},get:function(e,t){return e?(e[r]||this._initNamespace(e),JSON.parse(e[r])[t]):m},set:function(e,t,i){if(!e)return!1;e[r]||this._initNamespace(e);var a=JSON.parse(e[r]);return a[t]=i,e[r]=JSON.stringify(a),!0},_initNamespace:function(e){return e[r]=JSON.stringify({}),!0}}}(AvayaClientServices),function(e){"use strict";function t(e,t,i){Error.call(this,e),this.message=e,this.validatedObject=t,this.violatedRule=i,this.name="ValidationError"}t.prototype=Object.create(Error.prototype),e.Base.ValidationError=t}(AvayaClientServices),function(r){"use strict";function e(){}e.prototype={validate:function(){throw new Error("Function is not implemented!")},_processCondition:function(e,t,i,a){if(e)return!0;var r=i.message||this.defaultMessage;return this._handleValidationError(r,t,i,a)},_handleValidationError:function(e,t,i,a){if(a)return!1;throw new r.Base.ValidationError(e,t,i)}},r.Base.Validators.BaseValidator=e}(AvayaClientServices),function(e){"use strict";function t(){this.defaultMessage="Provided element is not defined."}(t.prototype=Object.create(e.Base.Validators.BaseValidator.prototype)).validate=function(e,t,i){var a=void 0!==e;return this._processCondition(a,e,t,i)},e.Base.Validators.DefinedValidator=t}(AvayaClientServices),function(e){"use strict";function t(){this.defaultMessage="Provided element is not compatible with required type."}(t.prototype=Object.create(e.Base.Validators.BaseValidator.prototype)).validate=function(e,t,i){var a=typeof e===t.expected||"object"==typeof e&&e instanceof t.expected;return this._processCondition(a,e,t,i)},e.Base.Validators.TypeValidator=t}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r){this._width=e,this._height=t,this._fps=r||30,this._minBandwidth=i,this._maxBandwidth=a}t.prototype={getWidth:function(){return this._width},getHeight:function(){return this._height},getFPS:function(){return this._fps},getMinBandwidth:function(){return this._minBandwidth},getMaxBandwidth:function(){return this._maxBandwidth}},e.Base.VideoResolutionDetails=t}(AvayaClientServices),function(e){"use strict";function t(){this._onInvalidCredentialsProvidedCallbacks=T.Callbacks()}t.prototype={onAuthenticationChallenge:function(e,t){},addOnInvalidCredentialsCallback:function(e){this._onInvalidCredentialsProvidedCallbacks.add(e)},removeOnInvalidCredentialsCallback:function(e){this._onInvalidCredentialsProvidedCallbacks.remove(e)}},e.Config.AbstractCredentialProvider=t}(AvayaClientServices),function(e){"use strict";function t(){this.enabled=!1,this.credentialProvider=new e.Config.AbstractCredentialProvider,this.networkProviderConfiguration=new e.Config.NetworkProviderConfiguration}t.prototype={},e.Config.ACSConfiguration=t}(AvayaClientServices),function(e){"use strict";function t(){this.enabled=!1,this.pollingIntervalInMinutes=0,this.networkProviderConfiguration=new e.Config.NetworkProviderConfiguration,this.credentialProvider=new e.Config.CredentialProvider}t.prototype={},e.Config.AMMConfiguration=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Config.AnalyticsConfiguration=function(){this.enabled=!1}}(),function(e){"use strict";var t={basic:function(e,t){return i("Basic",btoa(e+":"+t))},bearer:i};function i(e,t){return e+" "+t}AvayaClientServices.Config.Authentication.Header=t}(),function(e){"use strict";AvayaClientServices.Config.Authentication.Scheme={BASIC:"Basic",BEARER:"Bearer"}}(),function(e){"use strict";AvayaClientServices.Config.Authentication.TokenType={BEARER:"Bearer",UPTOKEN:"UPToken",ESGTOKEN:"ESGToken"}}(),function(e){"use strict";var t={INCOMING_VIDEO_REQUEST_TIMEOUT:15e3,VIDEO_MAX_BANDWIDTH_ANY_NETWORK:1024,TURN_RELAY_CANDIDATES_GATHERING_TIMEOUT:5e3,ICE_CANDIDATES_GATHERING_TIMEOUT:12e3,ICE_CONNECTION_RETRY_INTERVAL:5e3};e.Config.CallUserConfiguration=function(){this.incomingCall=!1,this.videoEnabled=!1,this.startRingingOnIncomingCall=!0,this.incomingVideoRequestTimeout=t.INCOMING_VIDEO_REQUEST_TIMEOUT,this.videoMaxBandwidthAnyNetwork=t.VIDEO_MAX_BANDWIDTH_ANY_NETWORK,this.iceCandidatesGatheringTimeout=t.ICE_CANDIDATES_GATHERING_TIMEOUT,this.turnRelayCandidatesGatheringTimeout=t.TURN_RELAY_CANDIDATES_GATHERING_TIMEOUT,this.iceConnectionRestartInterval=t.ICE_CONNECTION_RETRY_INTERVAL},e.Config.CallUserConfiguration.DefaultValues=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Config.CollaborationConfiguration=function(){this.contentSharingWorkerPath=m,this.imageQuality=1}}(),function(a){"use strict";function e(e,t,i){a.Config.AbstractCredentialProvider.call(this),this.username=e,this.password=t,this.domain=i,this.displayName="",this.isGuest=!1}(e.prototype=Object.create(a.Config.AbstractCredentialProvider.prototype)).onAuthenticationChallenge=function(e,t){t({username:this.username,password:this.password,domain:this.domain,isGuest:this.isGuest,displayName:this.displayName})},a.Config.CredentialProvider=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Config.AbstractCredentialProvider.call(this),this.token=e,this.bearer="string"==typeof t?t.trim():m}(e.prototype=Object.create(i.Config.AbstractCredentialProvider.prototype)).onAuthenticationChallenge=function(e,t){t({bearer:this.bearer,token:this.token})},i.Config.CredentialTokenProvider=e}(AvayaClientServices),function(t){"use strict";function e(e){t.Config.CredentialProvider.call(this),this.username=this._createGuestUser(),this.password="",this.domain="",this.displayName=e,this.isGuest=!0}(e.prototype=Object.create(t.Config.CredentialProvider.prototype)).getDisplayName=function(){return this.displayName},e.prototype.setDisplayName=function(e){this.displayName=e},e.prototype._generateUUID=function(){var i=window.crypto||window.msCrypto;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=i.getRandomValues(new Uint8Array(1))[0]%16|0;return("x"===e?t:3&t|8).toString(16)})},e.prototype._createGuestUser=function(){return"csaGuest/jsg-"+this._generateUUID()},t.Config.GuestCredentialProvider=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i){this._failureCount=e,this._retryCallback=t,this._cancelCallback=i}t.prototype={getFailureCount:function(){return this._failureCount},retry:function(e){this._retryCallback(e)},cancel:function(){this._cancelCallback()}},e.Config.InvalidCredentialsEvent=t}(AvayaClientServices),function(e){"use strict";function t(){this.voipConfigurationAudio=new e.Config.VoIPConfigurationAudio,this.voipConfigurationVideo=new e.Config.VoIPConfigurationVideo,this.mediaEngineEnabled=!0,this.retrieveDeviceLabelsEnabled=!0}t.prototype={},e.Config.MediaConfiguration=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Config.MediaServiceConfiguration=function(){this.sessionId=m,this.accessToken=m,this.userAgentURL=m}}(),function(e){"use strict";function t(e,t,i,a){this.webSocketConfig=t,this.sseConfig=i,this.restConfig=e,this.maxConnectionErrorCount=a||5}t.prototype={},e.Config.NetworkProviderConfiguration=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Config.PresenceConfiguration=function(){this.enabled=!1}}(),function(e){"use strict";AvayaClientServices.Config.SecurityPolicy={BEST_EFFORT:"BEST_EFFORT",DISABLED:"DISABLED",REQUIRED:"REQUIRED"}}(),function(e){"use strict";function t(e,t,i,a,r,s){this.hostName=e||"",this.port=t,this.isSecure=!!i,this.path=a||"",this.credentials=r||"",this.query=s||""}t.prototype={getUrl:function(e){var t=e?"ws":"http";return this.isSecure&&(t+="s"),t+="://",this.credentials&&(t+=this.credentials+"@"),t+=this.hostName,this.port&&(t+=":"+this.port),t+=this.path,t+=this.query}},e.Config.ServerInfo=t}(AvayaClientServices),function(e){"use strict";function t(){this.enabled=!1,this.networkProviderConfiguration=new e.Config.NetworkProviderConfiguration,this.credentialProvider=new e.Config.CredentialProvider,this.maxCallStartReconnectionAttempts=-1,this._disableWebRTCForTheseBrowsers=[e.Base.BrowserType.SAFARI]}t.prototype={},e.Config.SGConfiguration=t}(AvayaClientServices),function(e){"use strict";function t(){this.enabled=!1,this.networkProviderConfiguration=new e.Config.NetworkProviderConfiguration,this.credentialProvider=new e.Config.CredentialProvider}t.prototype={},e.Config.UCCPConfiguration=t}(AvayaClientServices),function(e){"use strict";function t(){this.applicationBuildNumber="",this.applicationProductName="",this.applicationProductVersion="",this.ammConfiguration=new e.Config.AMMConfiguration,this.acsConfiguration=new e.Config.ACSConfiguration,this.uccpConfiguration=new e.Config.UCCPConfiguration,this.sgConfiguration=new e.Config.SGConfiguration,this.callUserConfiguration=new e.Config.CallUserConfiguration,this.presenceConfiguration=new e.Config.PresenceConfiguration,this.wcsConfiguration=new e.Config.WCSConfiguration,this.mediaConfiguration=new e.Config.MediaConfiguration,this.collaborationConfiguration=new e.Config.CollaborationConfiguration,this.analyticsConfiguration=new e.Config.AnalyticsConfiguration,this.mediaServiceContext="",this._mediaServiceConfiguration=null}t.prototype={},e.Config.UserConfiguration=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Config.VideoResolution={RESOLUTION_1080p:"resolution1080p",RESOLUTION_720p:"resolution720p",RESOLUTION_480p:"resolution480p",RESOLUTION_360p:"resolution360p",RESOLUTION_240p:"resolution240p",RESOLUTION_180p:"resolution180p"}}(),function(e){"use strict";function t(){this.bgnMode=!1,this.codecList=[],this.echoMode=!1,this.mediaMode=!1,this.mobileEchoMode=!1,this.noiseSupMode=!1,this.opusMode=!1,this.receiveGainMode=!1,this.receiveSupMode=!1,this.transmitGainMode=!1,this.vadMode=!1}t.prototype={},e.Config.VoIPConfigurationAudio=t}(AvayaClientServices),function(e){"use strict";function t(){this.anyNetworkBandwidthMode=!1,this.congestionControlAlgorithm=!1,this.videoResolution=e.Config.VideoResolution.RESOLUTION_720p,this.presentationHigherPriorityThanPeopleVideo=!1}t.prototype={},e.Config.VoIPConfigurationVideo=t}(AvayaClientServices),function(e){"use strict";function t(){this.enabled=!1,this.networkProviderConfiguration=new e.Config.NetworkProviderConfiguration,this.credentialProvider=new e.Config.CredentialProvider}t.prototype={},e.Config.WCSConfiguration=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Config.WCSCredentials=function(e,t,i,a,r){this.token=e,this.username=t,this.participantId=i,this.sessionId=a,this.mode=r}}(),function(s){"use strict";function e(e,t,i,a,r){s.Config.AbstractCredentialProvider.call(this),this.token=e,this.username=t,this.attendeeId=i,this.sessionId=a,this.mode=r}(e.prototype=Object.create(s.Config.AbstractCredentialProvider.prototype)).onAuthenticationChallenge=function(e,t){t(new s.Config.WCSCredentials(this.token,this.username,this.attendeeId,this.sessionId,this.mode))},s.Config.WCSCredentialTokenProvider=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.ACS.ACSConstants={SVC_GET_CONTACTS:"getContacts",SVC_SEARCH_CONTACTS:"searchContacts",TERMINAL_TYPE:"TERMINAL",PROVENANCE_TYPE_AVAYA:"Avaya",PROVENANCE_SUBTYPE_ADMINISTERED:"Administered"}}(),function(a){"use strict";function e(){this._quickSerachCache=new a.Base.SimpleIMDB(["searchString","searchScope"],{maxElements:250,timeToLive:1728e5,auditInterval:5e3})}e.prototype.addQuickSearchResultsToCache=function(e){for(var t,i=[],a=this._quickSerachCache.getCacheMaxSize(),r=this._trimToCacheMaxSize(e,a),s=0;s<r.length;s++)t={keys:{searchString:[r[s].searchString],searchScope:[r[s].searchScope]},element:r[s]},i.push(t);this._quickSerachCache.addElements(i)},e.prototype.getQuickSearchResultsFromCache=function(e,t){var i={searchString:[e],searchScope:[t]};return this._quickSerachCache.searchByKeys(i,a.Base.IMDBSearchOptions.EXACT_MATCH)},e.prototype._trimToCacheMaxSize=function(e,t){return t&&e.length>t?e.slice(-t):e.slice()},a.Providers.ACS.ACSContactsCache=e}(AvayaClientServices),function(R){"use strict";function e(){}e.prototype={convertACSContactArraytoContactArray:function(e){var t=[];if(e&&0<e.length)for(var i=0;i<e.length;i++)t.push(this.convertACSContactV1toContact(e[i]));return t},convertACSContactV1toContact:function(e){var n=R.Base.Utils,t=new R.Services.Contacts.Contact;if(n.isDefined(e)){n.isDefined(e.contactUrl)&&n.isDefined(e.contactUrl.value)?t._uniqueAddressForMatching=e.contactUrl.value:n.isDefined(e.loginID)&&e.loginID?t._uniqueAddressForMatching=e.loginID:n.isDefined(e.terminalId)&&e.terminalId&&(t._uniqueAddressForMatching=e.terminalId);var i,a,o=new R.Base.Capability(R.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),c=new R.Base.Capability(R.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),r=function(e,t,i){if(n.isDefined(e)&&e)if(n.isDefined(e.value)){var a;"string"===i?a=e.value:"boolean"===i?a="true"===e.value:"float"===i&&(a=parseFloat(e.value)),t()._value=a;var r=n.isDefined(e)&&n.isDefined(e.editable)&&!e.editable;t()._setWriteCapability(r?o:c)}else if("string"==typeof e||"boolean"==typeof e||"number"==typeof e){var s=e;e={value:s,editable:!1,provenance:[]},t()._value=s,t()._setWriteCapability(o)}};if(r(e.surName||e.lastName,t.getLastName.bind(t),"string"),r(e.givenName||e.firstName||e.name,t.getFirstName.bind(t),"string"),r(e.displayName||e.name,t.getDisplayName.bind(t),"string"),r(e.asciiSurName,t.getASCIILastName.bind(t),"string"),r(e.asciiGivenName,t.getASCIIFirstName.bind(t),"string"),r(e.asciiDisplayName,t.getASCIIDisplayName.bind(t),"string"),r(e.alias,t.getAlias.bind(t),"string"),r(e.location,t.getLocation.bind(t),"string"),r(e.workRoomNo,t.getWorkRoomNumber.bind(t),"string"),r(e.streetAddress,t.getStreetAddress.bind(t),"string"),r(e.city,t.getCity.bind(t),"string"),r(e.state,t.getState.bind(t),"string"),r(e.country,t.getCountry.bind(t),"string"),r(e.postalCode,t.getPostalCode.bind(t),"string"),r(e.company,t.getCompany.bind(t),"string"),r(e.manager,t.getManager.bind(t),"string"),r(e.department,t.getDepartment.bind(t),"string"),r(e.preferredLanguage,t.getLanguage.bind(t),"string"),r(e.notes,t.getNotes.bind(t),"string"),r(e.scopiaUserId||e.userId,t.getScopiaUserId.bind(t),"string"),r(e.scopiaLoginId||e.loginID,t.getScopiaLoginId.bind(t),"string"),r(e.rank,t.getRank.bind(t),"float"),r(e.isBuddy,t.isBuddy.bind(t),"boolean"),r(e.favourite,t.isFavorite.bind(t),"boolean"),r(e.videoCapable,t.isVideoCapable.bind(t),"boolean"),n.isDefined(e.pictureUrl)&&e.pictureUrl)if("string"==typeof e.pictureUrl?i=e.pictureUrl:n.isDefined(e.pictureUrl.value)&&""!==e.pictureUrl.value&&(i=e.pictureUrl.value),i)for(var s in R.Services.Contacts.ContactPictureSize)R.Services.Contacts.ContactPictureSize.hasOwnProperty(s)&&t.addPictureUrl(s,i+"?size="+R.Services.Contacts.ContactPictureSize[s].toLowerCase());if(n.isDefined(e.emailAddresses)){var l=e.emailAddresses.length;for(a=0;a<l;a++){var d=new R.Services.Contacts.ContactEmailAddressField;n.isDefined(e.emailAddresses[a].value)&&(d._address=e.emailAddresses[a].value),n.isDefined(e.emailAddresses[a].type)&&(d._emailAddressType=this._convertACSEmailAddressTypeToContactEmailAddressType(e.emailAddresses[a].type)),e.emailAddresses[a].editable?d._setWriteCapability(c):d._setWriteCapability(o),t.getEmailAddresses().getValues().push(d)}}if(n.isDefined(e.email)&&e.email){var C=new R.Services.Contacts.ContactEmailAddressField;C._address=e.email,C._setWriteCapability(o),t.getEmailAddresses().getValues().push(C)}if(n.isDefined(e.phoneNumberList)){var u=e.phoneNumberList.length;for(a=0;a<u;a++){var v=new R.Services.Contacts.ContactPhoneField;n.isDefined(e.phoneNumberList[a].phoneNumber)&&(v._phoneNumber=e.phoneNumberList[a].phoneNumber),n.isDefined(e.phoneNumberList[a].label1)&&(v._label1=e.phoneNumberList[a].label1),n.isDefined(e.phoneNumberList[a].label2)&&(v._label2=e.phoneNumberList[a].label2),n.isDefined(e.phoneNumberList[a].type)&&(v._phoneNumberType=this._convertACSPhoneNumberTypeToContactPhoneNumberType(e.phoneNumberList[a].type)),n.isDefined(e.phoneNumberList[a].speedDialEnabled)&&(v._speedDialEnabled="true"===e.phoneNumberList[a].speedDialEnabled),n.isDefined(e.phoneNumberList[a].isPrimary)&&(v._default="true"===e.phoneNumberList[a].isPrimary),e.phoneNumberList[a].editable?v._setWriteCapability(c):v._setWriteCapability(o);var h=e.phoneNumberList[a].provenance;if(h)for(var p=0;p<h.length;p++)h[p].type===R.Providers.ACS.ACSConstants.PROVENANCE_TYPE_AVAYA&&h[p].subType===R.Providers.ACS.ACSConstants.PROVENANCE_SUBTYPE_ADMINISTERED&&v.setAvayaAdministered(!0);t.getPhoneNumbers().getValues().push(v)}}var _=[];for(e.telephoneMobile&&_.push(e.telephoneMobile),e.telephoneOffice&&_.push(e.telephoneOffice),a=0;a<_.length;a++){var S=new R.Services.Contacts.ContactPhoneField;S._phoneNumber=_[a],S._setWriteCapability(o),t.getPhoneNumbers().getValues().push(S)}if(n.isDefined(e.type)&&e.type===R.Providers.ACS.ACSConstants.TERMINAL_TYPE){var g=!1,f=new R.Services.Contacts.ContactPhoneField;f._setWriteCapability(o),e.protocol&&(f._phoneNumberType=this._convertACSPhoneNumberTypeToContactPhoneNumberType(e.protocol),g=!0),e.description&&(f._label1=e.description,g=!0),e.number&&(f._phoneNumber=e.number,g=!0),g&&t.getPhoneNumbers().getValues().push(f)}if(n.isDefined(e.imaddresses)){var E=e.imaddresses.length;for(a=0;a<E;a++){var A=new R.Services.Contacts.ContactIMAddressField;n.isDefined(e.imaddresses[a].value)&&(A._address=e.imaddresses[a].value),n.isDefined(e.imaddresses[a].type)&&(A._imAddressType=this._convertACSHandleTypeToContactHandleType(e.imaddresses[a].type)),e.imaddresses[a].editable?A._setWriteCapability(c):A._setWriteCapability(o);var P=e.imaddresses[a].provenance;if(P)for(var T=0;T<P.length;T++)P[T].type===R.Providers.ACS.ACSConstants.PROVENANCE_TYPE_AVAYA&&P[T].subType===R.Providers.ACS.ACSConstants.PROVENANCE_SUBTYPE_ADMINISTERED&&A.setAvayaAdministered(!0);t.getIMAddresses().getValues().push(A)}}if(n.isDefined(e.custom1)&&n.isDefined(e.custom1.value)){var y=new R.Services.Contacts.ContactStringField;y._value=e.custom1.value,y._setWriteCapability(o),t.getCustom1().getValues().push(y)}if(t.getCustom1()._setWriteCapability(o),n.isDefined(e.custom2)&&n.isDefined(e.custom2.value)){var b=new R.Services.Contacts.ContactStringField;b._value=e.custom2.value,b._setWriteCapability(o),t.getCustom2().getValues().push(b)}if(t.getCustom2()._setWriteCapability(o),n.isDefined(e.custom3)&&n.isDefined(e.custom3.value)){var I=new R.Services.Contacts.ContactStringField;I._value=e.custom3.value,I._setWriteCapability(o),t.getCustom3().getValues().push(I)}t.getCustom3()._setWriteCapability(o),n.isDefined(e.type)&&e.type===R.Providers.ACS.ACSConstants.TERMINAL_TYPE&&(e.contactIdentifier?t.getTerminal()._terminalId=e.contactIdentifier.value:t.getTerminal()._terminalId=e.terminalId,e.givenName?t.getTerminal()._terminalName=e.givenName.value:t.getTerminal()._terminalName=e.name)}return t},convertQuickSearchResults:function(e,t,i){for(var a=[],r=0;r<e.length;r++){var s=t[e[r].correlationId],n=this.convertACSContactArraytoContactArray(e[r].contacts),o=new R.Services.Contacts.ResolveContactResult(s,i,n);a.push(o)}return a},convertContactToACSContactV1:function(e){return this.mergeContactWithACSContactV1(e,new R.Providers.ACS.ContactV1)},mergeContactWithACSContactV1:function(e,t){var i;if(e&&t){var a;i=new R.Providers.ACS.ContactV1,e.getUniqueAddressForMatching()&&(i.contactUrl.value=e.getUniqueAddressForMatching()),i.id.value=t.id.value,R.Base.Utils.isDefined(e._terminal)&&""!==e.getTerminal().getTerminalId()?i.contactIdentifier.value=e.getTerminal().getTerminalId():i.contactIdentifier.value=t.contactIdentifier.value,i.pictureUrl.value=t.pictureUrl.value,i.asciiSurName.value=e.getASCIILastName().getValue(),i.asciiGivenName.value=e.getASCIIFirstName().getValue(),i.asciiDisplayName.value=e.getASCIIDisplayName().getValue(),i.surName.value=e.getLastName().getValue(),i.givenName.value=e.getFirstName().getValue(),i.displayName.value=e.getDisplayName().getValue(),i.alias.value=e.getAlias().getValue(),i.location.value=e.getLocation().getValue(),i.workRoomNo.value=e.getWorkRoomNumber().getValue(),i.streetAddress.value=e.getStreetAddress().getValue(),i.city.value=e.getCity().getValue(),i.state.value=e.getState().getValue(),i.country.value=e.getCountry().getValue(),i.postalCode.value=e.getPostalCode().getValue(),i.company.value=e.getCompany().getValue(),i.manager.value=e.getManager().getValue(),i.department.value=e.getDepartment().getValue(),i.preferredLanguage.value=e.getLanguage().getValue(),i.notes.value=e.getNotes().getValue(),R.Base.Utils.isDefined(e._scopiaUserId)&&(i.scopiaUserId.value=e.getScopiaUserId().getValue()),R.Base.Utils.isDefined(e._scopiaLoginId)&&(i.scopiaLoginId.value=e.getScopiaLoginId().getValue()),i.rank.value=e.getRank().getValue().toString(),i.isBuddy.value=e.isBuddy().getValue().toString(),i.favourite.value=e.isFavorite().getValue().toString(),i.videoCapable.value=e.isVideoCapable().getValue().toString();var r=[],s=e.getEmailAddresses().getValues();for(a=0;a<s.length;a++){var n=new R.Providers.ACS.ContactEmailData;n.value=s[a].getAddress(),n.type=this._convertContactEmailAddressTypeToACSEmailAddressType(s[a].getEmailAddressType()),r.push(n)}i.emailAddresses=r;var o=[],c=e.getPhoneNumbers().getValues();for(a=0;a<c.length;a++){var l=new R.Providers.ACS.ContactPhoneData;l.phoneNumber=c[a].getPhoneNumber(),l.label1=c[a].getLabel1(),l.label2=c[a].getLabel2(),l.type=this._convertContactPhoneNumberTypeToACSPhoneType(c[a].getPhoneNumberType()),l.speedDialEnabled=c[a].isSpeedDialEnabled().toString(),l.isPrimary=c[a].isDefault().toString(),o.push(l)}i.phoneNumberList=o;var d=[],C=e.getIMAddresses().getValues();for(a=0;a<C.length;a++){var u=new R.Providers.ACS.ContactHandleData;u.value=C[a].getAddress(),u.type=this._convertContactHandleTypeToACSHandleType(C[a].getIMAddressType()),d.push(u)}i.imaddresses=d}return i},_convertACSPhoneNumberTypeToContactPhoneNumberType:function(e){if(!e)return R.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_WORK;switch(e){case R.Providers.ACS.ACSPhoneNumberType.WORK:return R.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_WORK;case R.Providers.ACS.ACSPhoneNumberType.HOME:return R.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_HOME;case R.Providers.ACS.ACSPhoneNumberType.HANDLE:return R.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_HANDLE;case R.Providers.ACS.ACSPhoneNumberType.MOBILE:return R.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_MOBILE;case R.Providers.ACS.ACSPhoneNumberType.FAX:return R.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_FAX;case R.Providers.ACS.ACSPhoneNumberType.PAGER:return R.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_PAGER;default:return R.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_WORK}},_convertContactPhoneNumberTypeToACSPhoneType:function(e){if(!e)return R.Providers.ACS.ACSPhoneNumberType.PHONE_NUMBER_WORK;switch(e){case R.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_WORK:return R.Providers.ACS.ACSPhoneNumberType.WORK;case R.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_HANDLE:return R.Providers.ACS.ACSPhoneNumberType.HANDLE;case R.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_HOME:return R.Providers.ACS.ACSPhoneNumberType.HOME;case R.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_MOBILE:return R.Providers.ACS.ACSPhoneNumberType.MOBILE;case R.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_FAX:return R.Providers.ACS.ACSPhoneNumberType.FAX;case R.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_PAGER:return R.Providers.ACS.ACSPhoneNumberType.PAGER;default:return R.Providers.ACS.ACSPhoneNumberType.PHONE_NUMBER_WORK}},_convertACSEmailAddressTypeToContactEmailAddressType:function(e){if(!e)return R.Services.Contacts.ContactEmailAddressType.EMAIL_ADDRESS_OTHER;switch(e){case R.Providers.ACS.ACSEmailAddressType.WORK:return R.Services.Contacts.ContactEmailAddressType.EMAIL_ADDRESS_WORK;case R.Providers.ACS.ACSEmailAddressType.OTHER:default:return R.Services.Contacts.ContactEmailAddressType.EMAIL_ADDRESS_OTHER}},_convertContactEmailAddressTypeToACSEmailAddressType:function(e){if(!e)return R.Providers.ACS.ACSEmailAddressType.OTHER;switch(e){case R.Services.Contacts.ContactEmailAddressType.EMAIL_ADDRESS_WORK:return R.Providers.ACS.ACSEmailAddressType.WORK;case R.Services.Contacts.ContactEmailAddressType.EMAIL_ADDRESS_OTHER:default:return R.Providers.ACS.ACSEmailAddressType.OTHER}},_convertACSHandleTypeToContactHandleType:function(e){if(!e)return R.Services.Contacts.ContactIMAddressType.IM_ADDRESS_OTHER;switch(e){case R.Providers.ACS.ACSHandleType.WORK:return R.Services.Contacts.ContactIMAddressType.IM_ADDRESS_WORK;case R.Providers.ACS.ACSHandleType.OTHER:default:return R.Services.Contacts.ContactIMAddressType.IM_ADDRESS_OTHER}},_convertContactHandleTypeToACSHandleType:function(e){if(!e)return R.Providers.ACS.ACSHandleType.OTHER;switch(e){case R.Services.Contacts.ContactIMAddressType.IM_ADDRESS_WORK:return R.Providers.ACS.ACSHandleType.WORK;case R.Services.Contacts.ContactIMAddressType.IM_ADDRESS_OTHER:default:return R.Providers.ACS.ACSHandleType.OTHER}},extendAcsContact:function(e){var t,i=R.Base.Utils.deepMerge;if((e=i(new R.Providers.ACS.ContactV1,e)).emailAddresses){var a=e.emailAddresses.length;for(t=0;t<a;t++)e.emailAddresses[t]=i(new R.Providers.ACS.ContactEmailData,e.emailAddresses[t])}if(e.phoneNumberList){var r=e.phoneNumberList.length;for(t=0;t<r;t++)e.phoneNumberList[t]=i(new R.Providers.ACS.ContactPhoneData,e.phoneNumberList[t])}if(e.imaddresses){var s=e.imaddresses.length;for(t=0;t<s;t++)e.imaddresses[t]=i(new R.Providers.ACS.ContactHandleData,e.imaddresses[t])}return e}},R.Providers.ACS.ACSContactsConverter=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.ACS.ACSContentsActions={ADD:"ADD",UPDATE:"UPDATE",DELETE:"DELETE",REFRESH:"refreshContactList"}}(),function(o){"use strict";function e(){this._acsRequestBuilder=null,this._acsContactsConverter=null,this._acsNetworkProvider=null,this._acsContactsProvider=null,this._acsDirectorySearchProvider=null,this._contactsAnalyticsService=new o.Services.Analytics.ContactsAnalyticsService,this._acsContactsCache=new o.Providers.ACS.ACSContactsCache}e.prototype={getACSContactsProvider:function(){if(!this._acsContactsProvider){var e=this._createACSContactsProviderV1();this._acsContactsProvider=new o.Providers.ACS.ACSContactsProvider,this._acsContactsProvider.registerACSContactsProvider(1,e)}return this._acsContactsProvider},getACSDirectorySearchProvider:function(){if(!this._acsDirectorySearchProvider){var e=this._createACSDirectorySearchProviderV1();this._acsDirectorySearchProvider=new o.Providers.ACS.ACSDirectorySearchProvider,this._acsDirectorySearchProvider.registerACSDirectorySearchProvider(1,e)}return this._acsDirectorySearchProvider},_createACSContactsProviderV1:function(){return new o.Providers.ACS.ACSContactsProviderV1(this._getACSNetworkProvider(),this._getACSContactsConverter(),this._getACSRequestBuilder())},_createACSDirectorySearchProviderV1:function(){return new o.Providers.ACS.ACSDirectorySearchProviderV1(this._getACSNetworkProvider(),this._getACSContactsConverter(),this._getACSRequestBuilder(),this._contactsAnalyticsService,this._acsContactsCache)},_getACSContactsConverter:function(){return this._acsContactsConverter||(this._acsContactsConverter=new o.Providers.ACS.ACSContactsConverter),this._acsContactsConverter},_getACSRequestBuilder:function(){return this._acsRequestBuilder||(this._acsRequestBuilder=new o.Providers.ACS.ACSRequestBuilder),this._acsRequestBuilder},_getACSNetworkProvider:function(){if(!this._acsNetworkProvider){var e=[o.Providers.ACS.ACSEventTypes.CAS_NOTIFICATION,o.Providers.ACS.ACSEventTypes.PING],t=new o.Base.SSEProvider(e),i=new o.Base.RESTProvider,a=new o.Base.SSEIntegrationProvider(i,t),r=new o.Base.WebSocketProvider,s=new o.Base.NetworkProvider(r,a,o.Base.LoggerTags.ACS_CONTACTS_PROVIDER),n=new o.Base.NetworkProvider(new o.Base.RESTProvider,m,o.Base.LoggerTags.ACS_CONTACTS_PROVIDER);this._acsNetworkProvider=new o.Providers.ACS.ACSNetworkProvider(this._getACSRequestBuilder(),n,s,this._contactsAnalyticsService)}return this._acsNetworkProvider}},o.Providers.ACS.ACSProviderFactory=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.ACS.ACSProviderStates={STARTING:"STARTING",STARTED:"STARTED",STOPPING:"STOPPING",STOPPED:"STOPPED"}}(),function(o){"use strict";function e(){this._acsResources={},this._endpoints={},this._contentTypes={resourcesV1:"application/vnd.avaya.acs.resources.v1+json",resourcesV2:"application/vnd.avaya.acs.resources.v2+json",errorV1:"application/vnd.avaya.acs.error.v1+json",contactsV1:"application/vnd.avaya.acs.contacts.v1+json",contactV1:"application/vnd.avaya.acs.contact.v1+json",searchV1:"application/vnd.avaya.acs.search.v1+json",searchresultV1:"application/vnd.avaya.acs.searchresult.v1+json",quicksearchV1:"application/vnd.avaya.acs.quicksearch.v1+json",searchresultiviewV1:"application/vnd.avaya.acs.searchresult-iview.v1+json"},this._usedIds={}}(e.prototype={}).setResources=function(e){this._acsResources=e,this._endpoints.getContacts=this._acsResources.resources.contacts.GET.getContacts.href,this._endpoints.searchContacts=this._endpoints.getContacts+"/searches",this._endpoints.quickSearchContacts=this._endpoints.getContacts+"/quicksearches",this._endpoints.addUpdateContact=this._acsResources.resources.contacts.POST.addUpdateContact.href,this._endpoints.searchContactsIView="",this._acsResources.resources.contacts.GET.searchIViewContacts&&(this._endpoints.searchContactsIView=this._acsResources.resources.contacts.GET.searchIViewContacts.href),this._acsResources&&this._acsResources.sessionManagement&&this._acsResources.sessionManagement.href&&(this._endpoints.refreshRestSession=this._acsResources.sessionManagement.href)},e.prototype.setNotificationResources=function(e){e&&e.sessionManagement&&e.sessionManagement.href&&(this._endpoints.refreshNotificationSession=e.sessionManagement.href)},e.prototype.buildResourcesOptions=function(){return{urlSuffix:"/acs/resources",sendType:"GET",dataType:"JSON",crossDomain:!0,headers:{Accept:[this._contentTypes.resourcesV2,this._contentTypes.resourcesV1,this._contentTypes.errorV1].join(", ")}}},e.prototype.buildInvalidateSessionOptions=function(){return{urlSuffix:"/acs/session",sendType:"DELETE",headers:{Accept:this._contentTypes.errorV1}}},e.prototype.buildRefreshRestSessionOptions=function(){return this._endpoints.refreshRestSession?{url:this._endpoints.refreshRestSession,sendType:"GET",headers:{Accept:this._contentTypes.errorV1}}:{urlSuffix:"/acs/session",sendType:"GET",headers:{Accept:this._contentTypes.errorV1}}},e.prototype.buildRefreshNotificationSessionOptions=function(){return this._endpoints.refreshNotificationSession?{url:this._endpoints.refreshNotificationSession,sendType:"GET",headers:{Accept:this._contentTypes.errorV1}}:{urlSuffix:"/notification/session",sendType:"GET",headers:{Accept:this._contentTypes.errorV1}}},e.prototype.buildGetContactsOptions=function(e){var t={headers:{}},i=this._acsResources.resources.contacts&&this._acsResources.resources.contacts.GET.getContacts&&this._acsResources.resources.contacts.GET.getContacts.limits&&this._acsResources.resources.contacts.GET.getContacts.limits.maxSearchResultsTotal?this._acsResources.resources.contacts.GET.getContacts.limits.maxSearchResultsTotal:250;return t.url=this._endpoints.getContacts+"?count="+i,e&&(t.url+="&after="+e),t.sendType="GET",t.dataType="JSON",t.headers.Accept=[this._contentTypes.contactsV1,this._contentTypes.errorV1].join(", "),t},e.prototype.buildGetContactOptions=function(e){return{url:e,sendType:"GET",dataType:"JSON",headers:{Accept:[this._contentTypes.contactV1,this._contentTypes.errorV1].join(", ")}}},e.prototype.buildAddContactOptions=function(){return{url:this._endpoints.addUpdateContact,sendType:"POST",dataType:"JSON",headers:{Accept:[this._contentTypes.contactV1,this._contentTypes.errorV1].join(", "),"Content-Type":this._contentTypes.contactsV1}}},e.prototype.buildUpdateContactOptions=function(){return{url:this._endpoints.addUpdateContact,sendType:"PUT",dataType:"JSON",headers:{Accept:[this._contentTypes.contactV1,this._contentTypes.errorV1].join(", "),"Content-Type":this._contentTypes.contactsV1}}},e.prototype.buildAddUpdateContactData=function(e){return JSON.stringify({userEmail:this._acsResources.self,contacts:[e]},this._stringifyReplacer)},e.prototype.buildDeleteContactOptions=function(e){return{url:e,sendType:"DELETE",headers:{Accept:this._contentTypes.errorV1}}},e.prototype.buildSearchContactsData=function(e){var t,i=e.getSearchString(),a=e.getSearchField();a===o.Services.Contacts.SearchFieldType.NAME?t=["Displayname,"+i]:a===o.Services.Contacts.SearchFieldType.HANDLE?t=["EmailAddress,"+i]:a===o.Services.Contacts.SearchFieldType.LOGIN_ID?t=["LoginID,"+i]:a===o.Services.Contacts.SearchFieldType.TERMINAL?t=["Terminal,"+i]:a===o.Services.Contacts.SearchFieldType.ALL&&(t=["ALL,"+i]);var r=e.getMaxResults();return 0===r&&(r=m),JSON.stringify({searchCriteria:t,maxResults:r})},e.prototype.buildSearchContactsIViewOnlyData=function(e){var t,i=e.getSearchString(),a=e.getSearchField();a===o.Services.Contacts.SearchFieldType.NAME?t="displayname="+i:a===o.Services.Contacts.SearchFieldType.HANDLE?t="emailAddress="+i:a===o.Services.Contacts.SearchFieldType.LOGIN_ID?t="loginID="+i:a===o.Services.Contacts.SearchFieldType.TERMINAL?t="terminal="+i:a===o.Services.Contacts.SearchFieldType.ALL&&(t="all="+i);var r=[t],s=e.getMaxResults();return 0===s&&(s=m),s&&r.push("maxResults="+s),r.join("&")},e.prototype.buildQuickSearchContactsOptions=function(){return{url:this._endpoints.quickSearchContacts+"?maxResults=100",sendType:"POST",dataType:"text",headers:{Accept:[this._contentTypes.searchresultV1,this._contentTypes.errorV1],"Content-Type":this._contentTypes.quicksearchV1}}},e.prototype.buildQuickSearchContactsData=function(e,t){var i,a=[],r=o.Services.Contacts.ResolveContactsFieldType;switch(t){case r.HANDLE:i="Handle";break;case r.PHONE_NUMBER:i="PhoneNumber";break;default:o.Base.Logger.warn(o.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Invalid field type of resolving contacts",t)}if(i)for(var s=0;s<e.length;s++){var n={correlationId:String(s),criteria:{}};n.criteria[i]=e[s],a.push(n)}return JSON.stringify({filter:["EmailAddress","FirstName","LastName","PhoneNumber","IMHandle"],searchCriteria:a})},e.prototype.buildSearchContactsOptions=function(){return{url:this._endpoints.searchContacts+"?searchDirectory=true",sendType:"POST",dataType:"JSON",headers:{Accept:[this._contentTypes.searchV1,this._contentTypes.errorV1].join(", "),"Content-Type":"application/json"}}},e.prototype.buildSearchContactsIViewOnlyOptions=function(){return{url:this._endpoints.searchContactsIView,sendType:"GET",dataType:"JSON",headers:{Accept:[this._contentTypes.searchresultiviewV1,this._contentTypes.errorV1].join(", "),"Content-Type":"application/json"}}},e.prototype.buildNotificationsOptions=function(){return{dataType:"JSON",headers:{"Content-Type":"application/json"}}},e.prototype.buildSubscribeForACSNotifications=function(e){return{subscribe:{requestId:"subscribe-"+this._generateId(),resources:[{application:"acs",service:e,resource:this._endpoints[e]}],version:"1"}}},e.prototype.buildUnsubscribeFromACSNotifications=function(e){return{unsubscribe:{requestId:"unsubscribe-"+this._generateId(),resources:[{application:"acs",service:e,resource:this._endpoints[e]}],version:"1"}}},e.prototype._stringifyReplacer=function(e,t){return t&&t.hasOwnProperty("value")&&t.value===m?m:t},e.prototype._generateId=function(e,t){for(var i;i=o.Base.Utils.makeId(),this._usedIds[i];);return i},o.Providers.ACS.ACSRequestBuilder=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.ACS.ACSEmailAddressType={WORK:"work",OTHER:"other"}}(),function(e){"use strict";AvayaClientServices.Providers.ACS.ACSEventTypes={CAS_NOTIFICATION:"CASNotification",PING:"Ping"}}(),function(e){"use strict";AvayaClientServices.Providers.ACS.ACSHandleType={WORK:"work",OTHER:"other"}}(),function(e){"use strict";AvayaClientServices.Providers.ACS.ACSPhoneNumberType={WORK:"work",HANDLE:"handle",MOBILE:"mobile",HOME:"home",FAX:"fax",PAGER:"pager"}}(),function(e){"use strict";function t(){this.value=m,this.editable=m}t.prototype={equals:function(e){return this.value===e.value&&this.editable===e.editable}},e.Providers.ACS.ContactAttribute=t}(AvayaClientServices),function(e){"use strict";function t(){this.value=m,this.type=e.Providers.ACS.ACSEmailAddressType.OTHER,this.editable=m}t.prototype={equals:function(e){return this.value===e.value&&this.type===e.type&&this.editable===e.editable}},e.Providers.ACS.ContactEmailData=t}(AvayaClientServices),function(e){"use strict";function t(){this.value=m,this.type=e.Providers.ACS.ACSHandleType.OTHER,this.editable=m,this.provenance=m}t.prototype={equals:function(e){return this.value===e.value&&this.type===e.type&&this.editable===e.editable&&this.provenance===e.provenance}},e.Providers.ACS.ContactHandleData=t}(AvayaClientServices),function(e){"use strict";function t(){this.phoneNumber=m,this.label1=m,this.label2=m,this.type=e.Providers.ACS.ACSPhoneNumberType.WORK,this.speedDialEnabled=!1,this.isPrimary=!1,this.editable=m}t.prototype={equals:function(e){return this.phoneNumber===e.phoneNumber&&this.label1===e.label1&&this.label2===e.label2&&this.type===e.type&&this.speedDialEnabled===e.speedDialEnabled&&this.isPrimary===e.isPrimary&&this.editable===e.editable}},e.Providers.ACS.ContactPhoneData=t}(AvayaClientServices),function(e){"use strict";function t(){this.userEmail="",this.contacts=[],this.hasMoreResults=!1}t.prototype={},e.Providers.ACS.ContactsV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.id=new e.Providers.ACS.ContactAttribute,this.contactIdentifier=new e.Providers.ACS.ContactAttribute,this.contactUrl=new e.Providers.ACS.ContactAttribute,this.surName=new e.Providers.ACS.ContactAttribute,this.givenName=new e.Providers.ACS.ContactAttribute,this.displayName=new e.Providers.ACS.ContactAttribute,this.alias=new e.Providers.ACS.ContactAttribute,this.company=new e.Providers.ACS.ContactAttribute,this.location=new e.Providers.ACS.ContactAttribute,this.workRoomNo=new e.Providers.ACS.ContactAttribute,this.streetAddress=new e.Providers.ACS.ContactAttribute,this.city=new e.Providers.ACS.ContactAttribute,this.state=new e.Providers.ACS.ContactAttribute,this.country=new e.Providers.ACS.ContactAttribute,this.postalCode=new e.Providers.ACS.ContactAttribute,this.manager=new e.Providers.ACS.ContactAttribute,this.department=new e.Providers.ACS.ContactAttribute,this.asciiGivenName=new e.Providers.ACS.ContactAttribute,this.asciiSurName=new e.Providers.ACS.ContactAttribute,this.asciiDisplayName=new e.Providers.ACS.ContactAttribute,this.pictureUrl=new e.Providers.ACS.ContactAttribute,this.isBuddy=new e.Providers.ACS.ContactAttribute,this.favourite=new e.Providers.ACS.ContactAttribute,this.videoCapable=new e.Providers.ACS.ContactAttribute,this.preferredLanguage=new e.Providers.ACS.ContactAttribute,this.notes=new e.Providers.ACS.ContactAttribute,this.rank=new e.Providers.ACS.ContactAttribute,this.custom1=new e.Providers.ACS.ContactAttribute,this.custom2=new e.Providers.ACS.ContactAttribute,this.custom3=new e.Providers.ACS.ContactAttribute,this.scopiaUserId=new e.Providers.ACS.ContactAttribute,this.scopiaLoginId=new e.Providers.ACS.ContactAttribute,this.phoneNumberList=[],this.emailAddresses=[],this.imaddresses=[]}t.prototype={equals:function(e){if(!(this.id.equals(e.id)&&this.contactIdentifier.equals(e.contactIdentifier)&&this.contactUrl.equals(e.contactUrl)&&this.surName.equals(e.surName)&&this.givenName.equals(e.givenName)&&this.displayName.equals(e.displayName)&&this.alias.equals(e.alias)&&this.company.equals(e.company)&&this.location.equals(e.location)&&this.workRoomNo.equals(e.workRoomNo)&&this.streetAddress.equals(e.streetAddress)&&this.city.equals(e.city)&&this.state.equals(e.state)&&this.country.equals(e.country)&&this.postalCode.equals(e.postalCode)&&this.manager.equals(e.manager)&&this.department.equals(e.department)&&this.asciiGivenName.equals(e.asciiGivenName)&&this.asciiSurName.equals(e.asciiSurName)&&this.asciiDisplayName.equals(e.asciiDisplayName)&&this.pictureUrl.equals(e.pictureUrl)&&this.isBuddy.equals(e.isBuddy)&&this.favourite.equals(e.favourite)&&this.videoCapable.equals(e.videoCapable)&&this.preferredLanguage.equals(e.preferredLanguage)&&this.notes.equals(e.notes)&&this.rank.equals(e.rank)&&this.custom1.equals(e.custom1)&&this.custom2.equals(e.custom2)&&this.custom3.equals(e.custom3)&&this.scopiaUserId.equals(e.scopiaUserId)&&this.scopiaLoginId.equals(e.scopiaLoginId))||this.phoneNumberList.length!==e.phoneNumberList.length||this.emailAddresses.length!==e.emailAddresses.length||this.imaddresses.length!==e.imaddresses.length)return!1;for(var t=0;t<this.phoneNumberList.length;t++)if(!this.phoneNumberList[t].equals(e.phoneNumberList[t]))return!1;for(t=0;t<this.emailAddresses.length;t++)if(!this.emailAddresses[t].equals(e.emailAddresses[t]))return!1;for(t=0;t<this.imaddresses.length;t++)if(!this.imaddresses[t].equals(e.imaddresses[t]))return!1;return!0}},e.Providers.ACS.ContactV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.displayMsg="",this.errorMsg=""}t.prototype={},e.Providers.ACS.ErrorV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.version=1,this.applications=[],this.capabilities=[],this.commandURL="",this.sessionManagement={}}t.prototype={},e.Providers.ACS.NotificationResourcesV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.version=1,this.resources={avayaRequestTimeout:{maximum:m,minimum:m,recommended:m},capabilities:[],contactSearchCapabilities:[],resources:{notification:{websocket:{href:m},sse:{href:m}},contacts:{POST:{addUpdateContact:{href:m}},GET:{getContacts:{href:m,limits:{maxSearchResultsPerPage:m,maxSearchResultsTotal:m}},searchIViewContacts:{href:m,limits:{maxSearchResultsTotal:m}}}},pictures:{GET:{getUserPicture:{href:m}}}},self:m,sessionManagement:{href:m,timeout:m}}}t.prototype={},e.Providers.ACS.ResourcesV1=t}(AvayaClientServices),function(e){"use strict";function t(){e.Providers.ACS.ResourcesV1.call(this),this.version=2,this.v2MediaType=!0}t.prototype={},e.Providers.ACS.ResourcesV2=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.ACS.ObservableEvents={NETWORK_PROVIDER_IS_UNAVAILABLE:"NETWORK_PROVIDER_IS_UNAVAILABLE",NETWORK_PROVIDER_IS_AVAILABLE:"NETWORK_PROVIDER_IS_AVAILABLE"}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.AMM3EventTypes={CAS_NOTIFICATION:"CASNotification",PING:"Ping"}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.ChatStateActions={TYPING:"typing",RECORDING_AUDIO:"recordingAudio",RECORDING_VIDEO:"recordingVideo",ATTACHING_FILE:"attachingFile",TAKING_PICTURE:"takingPicture",OTHER:"other"}}(),function(s){"use strict";s.Providers.AMM.AMMChatStateNotification=function(e,t,i,a,r){this.action=e.action,this.state=e.state,this.self=t,this.timeout=setTimeout(function(){t?r(e):(e.action="",e.state=s.Providers.AMM.ChatStates.PAUSED,i.fire(e))},a)}}(AvayaClientServices),function(s){"use strict";function e(){this._chatStateNotifications=[],this._conversationId="",this._localComposingInactivityTimeout=15e3,this._remoteComposingInactivityTimeout=6e4,this._composingRefreshTimeout=5e3,this._chatStateRefresh=!1,this._chatStateRefreshTimeout={}}e.prototype={setConversationId:function(e){this._conversationId=e},getConversationId:function(){return this._conversationId},setChatStateNotification:function(e,t,i){e.state===s.Providers.AMM.ChatStates.COMPOSING?this._setTypingNotification(e,t,i):this._chatStateNotifications[e.address]&&e.state===s.Providers.AMM.ChatStates.PAUSED&&(clearTimeout(this._chatStateNotifications[e.address].timeout),delete this._chatStateNotifications[e.address])},setChatStateRefreshTimeout:function(){this._chatStateRefresh=!0,this._chatStateRefreshTimeout=setTimeout(function(){this._chatStateRefresh=!1}.bind(this),this._composingRefreshTimeout)},getChatNotification:function(e){return this._chatStateNotifications[e]},clearChatStateRefreshTimeout:function(){this._chatStateRefresh=!1,clearTimeout(this._chatStateRefreshTimeout)},clearChatStateNotifications:function(){this._chatStateNotifications=[]},isChatStateAdded:function(){return this._chatStateRefresh},onPauseChatState:function(e,t){return T.Deferred().reject().promise()},_setTypingNotification:function(e,t,i){var a=t?this._localComposingInactivityTimeout:this._remoteComposingInactivityTimeout,r=function(e){this._localTimeoutEvent(e,i)}.bind(this);this._chatStateNotifications[e.address]?(clearTimeout(this._chatStateNotifications[e.address].timeout),this._chatStateNotifications[e.address].timeout=setTimeout(function(){t?this._localTimeoutEvent(e,i):this._remoteTimeoutEvent(e,i)}.bind(this),a)):this._chatStateNotifications[e.address]=new s.Providers.AMM.AMMChatStateNotification(e,t,i,a,r)},_localTimeoutEvent:function(t,i){this.onPauseChatState(t.action,this._conversationId).fail(function(e){s.Base.Logger.error(s.Base.LoggerTags.AMM_MESSAGING_PROVIDER,"An attempt to update typing status was failed.",e),this._remoteTimeoutEvent(t,i)}.bind(this))},_remoteTimeoutEvent:function(e,t){e.action="",e.state=s.Providers.AMM.ChatStates.PAUSED,t.fire(e)}},s.Providers.AMM.AMMChatStateNotifications=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.AMM.ChatStates={COMPOSING:"composing",PAUSED:"paused"}}(),function(i){"use strict";function e(){this._parsers=[]}e.prototype={register:function(e,t){this._parsers[e]=t},unregister:function(e){this._parsers[e]=m},parse:function(e,t){return this._parsers[e]?this._delegateParser(e,t):t},_delegateParser:function(e,t){if(this._parsers[e]!==m)return this._parsers[e].parse(t);i.Base.Logger.error(i.Base.LoggerTags.AMM_MESSAGING_PROVIDER,"No parser specified!",e)}},i.Providers.AMM.AMMMessagesParser=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.AMM.MessagesService={CONVERSATION:"conversation",CHAT_STATE:"chatState"}}(),function(C){"use strict";function e(){this._ammProvider={}}e.prototype={getAMMProvider:function(e){if(C.Base.Utils.isDefined(e)&&e.enabled)return T.isEmptyObject(this._ammProvider)&&(this._ammProvider=new C.Providers.AMM.AMMProvider,this._ammProvider.registerAMMProvider(2.1,this._createAMM2_1Provider()),this._ammProvider.registerAMMProvider(3,this._createAMM3_XProvider("AMM3Provider")),this._ammProvider.registerAMMProvider(3.2,this._createAMM3_XProvider("AMM3_2Provider"))),this._ammProvider},_createAMM2_1Provider:function(){var e=new C.Base.RESTProvider,t=new C.Base.NetworkProvider(e,m,C.Base.LoggerTags.AMM_MESSAGING_PROVIDER),i=this._createEventsV2Parser();return new C.Providers.AMM.AMM2_1Provider(t,i)},_createEventsV2Parser:function(){var e=new C.Providers.AMM.AMMMessagesParser;return e.register(C.Providers.AMM.AMMResponsesTypes.GET_CONVERSATIONS,new C.Providers.AMM.GetConversationsParser),e.register(C.Providers.AMM.AMMResponsesTypes.VALIDATE_USERS,new C.Providers.AMM.ValidateUsersParser),e.register(C.Providers.AMM.AMMResponsesTypes.SEND,new C.Providers.AMM.SendParser),e.register(C.Providers.AMM.AMMResponsesTypes.GET_MESSAGES,new C.Providers.AMM.GetMessagesParser),e.register(C.Providers.AMM.AMMResponsesTypes.ADD_PARTICIPANTS,new C.Providers.AMM.AddParticipantsParser),e.register(C.Providers.AMM.AMMResponsesTypes.CLOSE,new C.Providers.AMM.CloseParser),e.register(C.Providers.AMM.AMMResponsesTypes.NOTIFICATION,new C.Providers.AMM.NotificationParser),e.register(C.Providers.AMM.AMMResponsesTypes.NOTIFIED,new C.Providers.AMM.NotifiedParser),e.register(C.Providers.AMM.AMMResponsesTypes.DISCOVERY,new C.Providers.AMM.DiscoveryV2Parser),e.register(C.Providers.AMM.AMMResponsesTypes.SUBSCRIBED,new C.Providers.AMM.SubscribedParser),e.register(C.Providers.AMM.AMMResponsesTypes.UNSUBSCRIBED,new C.Providers.AMM.UnsubscribedParser),e},_createAMM3_XProvider:function(e){var t=[C.Providers.AMM.AMM3EventTypes.CAS_NOTIFICATION,C.Providers.AMM.AMM3EventTypes.PING],i=new C.Base.SSEProvider(t),a=new C.Base.RESTProvider,r=new C.Base.SSEIntegrationProvider(a,i),s=new C.Base.WebSocketProvider,n=new C.Base.NetworkProvider(s,r,C.Base.LoggerTags.AMM_MESSAGING_PROVIDER),o=new C.Base.RESTProvider,c=new C.Base.NetworkProvider(o,m,C.Base.LoggerTags.AMM_MESSAGING_PROVIDER),l=this._createEventsV3Parser(),d=new C.Providers.AMM.AMMChatStateNotifications;return new C.Providers.AMM[e](c,n,d,l)},_createEventsV3Parser:function(){var e=new C.Providers.AMM.AMMMessagesParser;return e.register(C.Providers.AMM.AMMResponsesTypes.GET_CONVERSATIONS,new C.Providers.AMM.GetConversationsParser),e.register(C.Providers.AMM.AMMResponsesTypes.VALIDATE_USERS,new C.Providers.AMM.ValidateUsersParser),e.register(C.Providers.AMM.AMMResponsesTypes.SEND,new C.Providers.AMM.SendParser),e.register(C.Providers.AMM.AMMResponsesTypes.GET_MESSAGES,new C.Providers.AMM.GetMessagesParser),e.register(C.Providers.AMM.AMMResponsesTypes.ADD_PARTICIPANTS,new C.Providers.AMM.AddParticipantsParser),e.register(C.Providers.AMM.AMMResponsesTypes.CLOSE,new C.Providers.AMM.CloseParser),e.register(C.Providers.AMM.AMMResponsesTypes.NOTIFICATION,new C.Providers.AMM.NotificationParser),e.register(C.Providers.AMM.AMMResponsesTypes.NOTIFIED,new C.Providers.AMM.NotifiedParser),e.register(C.Providers.AMM.AMMResponsesTypes.DISCOVERY,new C.Providers.AMM.DiscoveryV3Parser),e.register(C.Providers.AMM.AMMResponsesTypes.DISCOVERY_NOTIFICATION,new C.Providers.AMM.DiscoveryNotificationParser),e.register(C.Providers.AMM.AMMResponsesTypes.SUBSCRIBED,new C.Providers.AMM.SubscribedParser),e.register(C.Providers.AMM.AMMResponsesTypes.UNSUBSCRIBED,new C.Providers.AMM.UnsubscribedParser),e.register(C.Providers.AMM.AMMResponsesTypes.RESOURCE_STATE,new C.Providers.AMM.ResourceStateParser),e}},C.Providers.AMM.AMMProviderFactory=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.AMM.ProviderStates={AVAILABLE:"available",UNAVAILABLE:"unavailable"}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.AMMResponsesTypes={ADD_PARTICIPANTS:"AddParticipants",GET_CONVERSATIONS:"GetConversations",VALIDATE_USERS:"ValidateUsers",SEND:"Send",GET_MESSAGES:"GetMessages",CLOSE:"Close",NOTIFICATION:"Notification",NOTIFIED:"Notified",DISCOVERY:"Discovery",DISCOVERY_NOTIFICATION:"DiscoveryNotification",SUBSCRIBED:"Subscribed",UNSUBSCRIBED:"Unsubscribed",RESOURCE_STATE:"ResourceState"}}(),function(e){"use strict";function t(){}t.prototype={parse:function(e){throw new Error("Method not implemented!")}},e.Providers.AMM.AbstractParser=t}(AvayaClientServices),function(r){"use strict";function e(){}(e.prototype=Object.create(r.Providers.AMM.AbstractParser.prototype)).parse=function(e){for(var t={participants:[]},i=0;i<e.participants.length;i++){var a=new r.Providers.AMM.AddParticipantsResponse(e.participants[i].address,e.participants[i].givenName,e.participants[i].language,e.participants[i].modalities,e.participants[i].nativeGivenName,e.participants[i].nativeSurname,e.participants[i].surname,e.participants[i].type);t.participants.push(a)}return t},r.Providers.AMM.AddParticipantsParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.AMM.AbstractParser.prototype)).parse=function(e){return new t.Providers.AMM.CloseResponse(e.closed,e.href,e.sensitivity)},t.Providers.AMM.CloseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.AMM.AbstractParser.prototype)).parse=function(e){return new t.Providers.AMM.DiscoveryNotificationResponse(e.applications,e.capabilities,e.sessionManagement,e.version,e.commandURL)},t.Providers.AMM.DiscoveryNotificationParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.AMM.AbstractParser.prototype)).parse=function(e){return new t.Providers.AMM.DiscoveryV2Response(e.addresses,e.avayaRequestTimeout,e.capabilities,e.conversationsResource,e.domains,e.limits,e.messages,e.outbox,e.self,e.services)},t.Providers.AMM.DiscoveryV2Parser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.AMM.AbstractParser.prototype)).parse=function(e){return new t.Providers.AMM.DiscoveryV3Response(e.avayaRequestTimeout,e.contacts,e.conversationsResource,e.domains,e.messages,e.notificationService,e.notifications,e.outbox,e.picture,e.self,e.services,e.sessionManagement,e.users)},t.Providers.AMM.DiscoveryV3Parser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.AMM.AbstractParser.prototype)).parse=function(e){return new t.Providers.AMM.GetConversationsResponse(e.conversations,e.href,e.lastUpdated,e.moreSearchResults)},t.Providers.AMM.GetConversationsParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.AMM.AbstractParser.prototype)).parse=function(e){return new t.Providers.AMM.GetMessagesResponse(e.attachmentCount,e.counts,e.flags,e.href,e.id,e.lastAccessedTime,e.lastUpdated,e.latestEntryTimestamp,e.messages,e.participants,e.subject,e.totalCount,e.type,e.unreadAttachmentCount,e.unreadCount)},t.Providers.AMM.GetMessagesParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.AMM.AbstractParser.prototype)).parse=function(e){return new t.Providers.AMM.NotificationResponse(e.application,e.contents,e.resource,e.service,e.version)},t.Providers.AMM.NotificationParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.AMM.AbstractParser.prototype)).parse=function(e){return new t.Providers.AMM.NotifiedResponse(e.requestId,e.results,e.version)},t.Providers.AMM.NotifiedParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.AMM.AbstractParser.prototype)).parse=function(e){return new t.Providers.AMM.ResourceStateResponse(e.results,e.version)},t.Providers.AMM.ResourceStateParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.AMM.AbstractParser.prototype)).parse=function(e){return new t.Providers.AMM.SendResponse(e.body,e.event,e.flags,e.from,e.href,e.id,e.lastModifiedDate,e.parts,e.receivedDate,e.subject,e.threadId,e.to,e.inReplyTo)},t.Providers.AMM.SendParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.AMM.AbstractParser.prototype)).parse=function(e){return new t.Providers.AMM.SubscribedResponse(e.results,e.version)},t.Providers.AMM.SubscribedParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.AMM.AbstractParser.prototype)).parse=function(e){return new t.Providers.AMM.UnsubscribedResponse(e.results,e.version)},t.Providers.AMM.UnsubscribedParser=e}(AvayaClientServices),function(r){"use strict";function e(){}(e.prototype=Object.create(r.Providers.AMM.AbstractParser.prototype)).parse=function(e){for(var t={validatedAddresses:[]},i=0;i<e.validatedAddresses.length;i++){var a=new r.Providers.AMM.ValidateUsersResponse(e.validatedAddresses[i].addresses,e.validatedAddresses[i].query);t.validatedAddresses.push(a)}return t},r.Providers.AMM.ValidateUsersParser=e}(AvayaClientServices),function(e){"use strict";function t(){this.active=!1,this.closed=!1,this.href="",this.sensitivity=""}t.prototype={},e.Providers.AMM.ConversationFlagsV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.conversationIds=[],this.href="",this.lastUpdated=""}t.prototype={},e.Providers.AMM.ConversationIdsV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.href="",this.id="",this.lastAccessedTime="",this.lastUpdated=""}t.prototype={},e.Providers.AMM.ConversationIdV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.conversations=[],this.href="",this.lastUpdated="",this.moreSearchResults=!1}t.prototype={},e.Providers.AMM.ConversationsV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.attachmentCount=0,this.href="",this.id="",this.flags=new e.Providers.AMM.ConversationFlagsV1,this.lastAccessedTime="",this.lastUpdated="",this.latestEntryTimestamp="",this.messages=[],this.name="",this.owner="",this.participants={href:""},this.totalCount=0,this.type="",this.unreadAttachmentCount=0,this.unreadCount=0,this.counts={eventCount:0,eventUnreadMessage:0,messageAttachment:0,messageCount:0,messageUnreadAttachment:0,messageUnreadMessage:0}}t.prototype={},e.Providers.AMM.ConversationV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.address="",this.givenName="",this.language="",this.modalities=[],this.nativeGivenName="",this.nativeSurname="",this.picture="",this.surname="",this.subType="",this.type=""}t.prototype={},e.Providers.AMM.EntityV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.displayMsg="",this.errorMsg="",this.errorCode=0}t.prototype={},e.Providers.AMM.ErrorV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.participants=[],this.reason="",this.type="",this.units="",this.value=0}t.prototype={},e.Providers.AMM.EventV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.doNotForward=!1,this.href="",this.importance="",this.read=!1,this.sensitivity=""}t.prototype={},e.Providers.AMM.MessageFlagsV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.body="",this.event=new e.Providers.AMM.EventV1,this.flags=new e.Providers.AMM.MessageFlagsV1,this.from=new e.Providers.AMM.EntityV1,this.href="",this.id="",this.inReplyTo="",this.lastModifiedDate="",this.parts=[],this.receivedDate="",this.subject="",this.threadId="",this.to=[]}t.prototype={},e.Providers.AMM.MessageV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.version=1,this.applications=[],this.capabilities=[],this.commandURL="",this.sessionManagement={}}t.prototype={},e.Providers.AMM.NotificationResourcesV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.action="",this.address="",this.state="",this.timestamp=""}t.prototype={},e.Providers.AMM.NotificationContentsV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.participants=[]}t.prototype={},e.Providers.AMM.ParticipantsV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.disposition="",this.duration=0,this.media="",this.mimeType="",this.partId="",this.size=0}t.prototype={},e.Providers.AMM.PartV1=t}(AvayaClientServices),function(e){"use strict";function t(){this.version=2,this.addresses="",this.avayaRequestTimeout={recommended:0,maximum:0,minimum:0},this.capabilities={richContent:!1},this.conversationsResource={href:"",maxIdsLimit:0,maxMessageCount:0},this.domains=[],this.limits={maxAudioSize:0,maxGenericAttachmentSize:0,maxImageSize:0,maxTextLength:0,maxVideoSize:0},this.messages="",this.outbox="",this.self="",this.services={markAsReadIf:"",validateAddress:""}}t.prototype={},e.Providers.AMM.ResourcesV2=t}(AvayaClientServices),function(e){"use strict";function t(){this.version=3,this.avayaRequestTimeout={recommended:0,maximum:0,minimum:0},this.capabilities={richContent:!1},this.conversationsResource={href:"",maxIdsLimit:0,maxMessageCount:0},this.domains=[],this.limits={maxAudioSize:0,maxGenericAttachmentSize:0,maxImageSize:0,maxTextLength:0,maxVideoSize:0},this.messages="",this.outbox="",this.self="",this.picture="",this.contacts="",this.services={markAsReadIf:{href:""},validateAddresses:{href:""},markAsReadBatch:{href:"",limits:{maxBatchSize:0}}}}t.prototype={},e.Providers.AMM.ResourcesV3=t}(AvayaClientServices),function(e){"use strict";function t(){this.version=4,this.avayaRequestTimeout={recommended:0,maximum:0,minimum:0},this.capabilities={richContent:!1},this.contacts={href:""},this.conversationsResource={href:"",capabilities:{automaticLastAccessedDate:!1,postSessionEvent:!1,subjectChange:!1},limits:{maxMessageCount:0,maxIdsLimit:0}},this.domains=[],this.messages={href:"",capabilities:{html:!1}},this.notifications={href:""},this.outbox={href:"",capabilities:{richContent:!1},limits:{maxAudioSize:0,maxGenericAttachmentSize:0,maxImageSize:0,maxTextLength:0,maxVideoSize:0}},this.picture={href:""},this.self="",this.services={markAsReadIf:{href:""},validateAddresses:{href:""},markAsReadBatch:{href:"",limits:{maxBatchSize:0}}},this.notificationService={sse:{href:""},websocket:{href:""}},this.users={href:""},this.sessionManagement={href:"",timeout:0,username:""}}t.prototype={},e.Providers.AMM.ResourcesV4=t}(AvayaClientServices),function(e){"use strict";function t(){this.query="",this.addresses=[]}t.prototype={},e.Providers.AMM.ValidatedAddressesV1=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.AMM.AddParticipantsResponse=function(e,t,i,a,r,s,n,o){this._address=e,this.givenName=t,this.language=i,this.modalities=a,this.nativeGivenName=r,this.nativeSurname=s,this.surname=n,this.type=o}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.CloseResponse=function(e,t,i){this.closed=e,this.href=t,this.sensitivity=i}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.DiscoveryNotificationResponse=function(e,t,i,a,r){this.applications=e,this.capabilities=t,this.sessionManagement=i,this.version=a,this.commandURL=r}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.DiscoveryV2Response=function(e,t,i,a,r,s,n,o,c,l){this.addresses=e,this.avayaRequestTimeout=t,this.capabilities=i,this.conversationsResource=a,this.domains=r,this.limits=s,this.messages=n,this.outbox=o,this.self=c,this.services=l}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.DiscoveryV3Response=function(e,t,i,a,r,s,n,o,c,l,d,C,u){this.avayaRequestTimeout=e,this.contacts=t,this.conversationsResource=i,this.domains=a,this.messages=r,this.notificationService=s,this.notifications=n,this.outbox=o,this.picture=c,this.self=l,this.services=d,this.sessionManagement=C,this.users=u}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.GetConversationsResponse=function(e,t,i,a){this.conversations=e,this.href=t,this.lastUpdated=i,this.moreSearchResults=a;for(var r=0;r<this.conversations.length;r++)for(var s=0;s<this.conversations[r].messages.length;s++){this.conversations[r].messages[s].from._address=this.conversations[r].messages[s].from.address,delete this.conversations[r].messages[s].from.address;for(var n=0;n<this.conversations[r].messages[s].to.length;n++)this.conversations[r].messages[s].to[n]._address=this.conversations[r].messages[s].to[n].address,delete this.conversations[r].messages[s].to[n].address}}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.GetMessagesResponse=function(e,t,i,a,r,s,n,o,c,l,d,C,u,v,h){this.attachmentCount=e,this.counts=t,this.flags=i,this.href=a,this.id=r,this.lastAccessedTime=s,this.lastUpdated=n,this.latestEntryTimestamp=o,this.messages=c,this.participants=l,this.subject=d,this.totalCount=C,this.type=u,this.unreadAttachmentCount=v,this.unreadCount=h}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.NotificationResponse=function(e,t,i,a,r){this.application=e,this.contents=t,this.resource=i,this.service=a,this.version=r}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.NotifiedResponse=function(e,t,i){this.requestId=e,this.results=t,this.version=i}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.ResourceStateResponse=function(e,t){this.results=e,this.version=t}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.SendResponse=function(e,t,i,a,r,s,n,o,c,l,d,C,u){this.body=e,this.event=t,this.flags=i,this.from=a,this.href=r,this.id=s,this.lastModifiedDate=n,this.parts=o,this.receivedDate=c,this.subject=l,this.threadId=d,this.to=C,this.inReplyTo=u}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.SubscribedResponse=function(e,t){this.results=e,this.version=t}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.UnsubscribedResponse=function(e,t){this.results=e,this.version=t}}(),function(e){"use strict";AvayaClientServices.Providers.AMM.ValidateUsersResponse=function(e,t){this.addresses=[],this.query=t;for(var i=0;i<e.length;i++){var a={_address:e[i].address,givenName:e[i].givenName,language:e[i].language,modalities:e[i].modalities,nativeGivenName:e[i].nativeGivenName,nativeSurname:e[i].nativeSurname,surname:e[i].surname,type:e[i].type};this.addresses.push(a)}}}(),function(e){"use strict";AvayaClientServices.Providers.Analytics.AnalyticsCategories={CLIENT:"Client",USER:"User",SERVICES:"Services",PROVIDERS:"Providers",ANALYTICS:"Analytics",MESSAGING:"Messaging",CONTACTS:"Contacts",CALLS:"Calls",COLLABORATIONS:"Collaborations",CALL_FEATURES:"Call Features"}}(),function(e){"use strict";AvayaClientServices.Providers.Analytics.AnalyticsCustomDimensions={PRODUCT_VENDOR:1,PRODUCT_NAME:2,PRODUCT_VERSION:3,PROVIDER_TYPE:4,MIME_TYPE:5}}(),function(e){"use strict";AvayaClientServices.Providers.Analytics.AnalyticsProvidersTypes={CONTACTS:"AADS",MESSAGING:"AMM",CALLS:"AAWG",PRESENCE:"AAWG",VOICE_MESSAGING:"AAWG",COLLABORATION:"WCS",CONFERENCE:"UCCP"}}(),function(e){"use strict";AvayaClientServices.Providers.Analytics.AnalyticsServicesNames={CALL:"CALL",COLLABORATION:"COLLAB",CONTACT:"CONTACT",MESSAGING:"MSG",PRESENCE:"PRES",VOICE_MESSAGING:"VM"}}(),function(E){"use strict";function e(e,t,i,a){E.Base.Logger.debug(E.Base.LoggerTags.CALL_PROVIDER,"Initializing"),E.Base.Observable.call(this),this._config=m,this._csgwProviderFactory=e,this._configCallGwProvider=m,this._mediaServiceFactory=t,this._cpCalls={},this._sdpMediaOfferNotifications={},this._callFailureNotificationsQueue={},this._callEstablishedNotificationsQueue={},this._rtcConfiguration={},this._videoResolution={},this._consultConferencePromises={},this._callsAnalyticsService=i,this._rtcConnectionProviderFactory=a,this._isVideoAllowed=!0,this._browserType=E.Base.Utils.getBrowserType(),this._isServerSupportsNailedUpVideoConnection=m,this._activeCallVideoTrack=m,this._pendingVideoMuteState=m,E.Base.Logger.debug(E.Base.LoggerTags.CALL_PROVIDER,"Initialized")}(e.prototype=Object.create(E.Base.Observable.prototype)).start=function(e,t){if(this._config=e,this._updateVideoLicense(),!this._isBrowserSupported()&&!this._isConfiguredForMPaaSCollabCall())return T.Deferred().resolve().promise();if(this._config.sgConfiguration===m||!1===this._config.sgConfiguration.enabled)return E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Call gateway provider started without config"),this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_AVAILABLE,[]),T.Deferred().resolve().promise();this._videoResolution=t;var i=this._getHost();this._configCallGwProvider=this._csgwProviderFactory.getCSGCallsProvider(i);var a=!1;if(this._config.sgConfiguration&&this._config.sgConfiguration.credentialProvider&&this._config.sgConfiguration.credentialProvider.isGuest){if(!this._config.mediaServiceContext||!this._config._mediaServiceConfiguration)return E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Created default call gateway provider for Guest user"),this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_AVAILABLE,[]),T.Deferred().resolve().promise();var r="csaGuest/sessionId-"+this._getMediaServiceSessionId();this._config.sgConfiguration.credentialProvider.username=r,a=!0}else if(this._configCallGwProvider._isExternalGateway){if(this._configCallGwProvider._started)return E.Base.Logger.error(E.Base.LoggerTags.CALL_PROVIDER,"Registered user CANNOT be assigned to an external call gateway provider."),this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_UNAVAILABLE,[]),T.Deferred().reject("CANNOT be assigned to an external call gateway provider").promise();this._configCallGwProvider._isExternalGateway=!1}var s=!this._config.callUserConfiguration.presentationOnly&&!this._config.mediaServiceContext&&this._config.callUserConfiguration.incomingCall;return this._startCallGwProvider(this._configCallGwProvider,this._config.sgConfiguration,s,t,a)},e.prototype._isConfiguredForMPaaSCollabCall=function(){var e=!!this._config.sgConfiguration&&!!this._config.sgConfiguration.credentialProvider&&this._config.sgConfiguration.credentialProvider.isGuest,t=!!this._config.wcsConfiguration&&this._config.wcsConfiguration.enabled;return e&&!!this._config.mediaServiceContext&&t},e.prototype.supportsMPaaSCollabCall=function(){var e=!!this._config._mediaServiceConfiguration&&this._config._mediaServiceConfiguration.sessionId;return this._isConfiguredForMPaaSCollabCall()&&e},e.prototype.detectIPv6OnlySupport=function(){var s=T.Deferred(),n=this._rtcConnectionProviderFactory.create();return n._pc.onicecandidate=function(e){if(e.candidate){var t=e.candidate.candidate,i="candidate:",a=t.indexOf(i)+i.length,r=t.substr(a).split(" ")[4].match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/);null!==r&&5===r.length&&r[1]<=255&&r[2]<=255&&r[3]<=255&&r[4]<=255&&(n.close(),s.reject())}else n.close(),s.resolve()},n._pc.onicegatheringstatechange=function(){"complete"===n._pc.iceGatheringState&&(n.close(),s.resolve())},n._pc.createOffer({offerToReceiveAudio:1}).then(function(e){n._pc.setLocalDescription(e)},function(e){n.close(),s.reject()}),s.promise()},e.prototype._startCallGwProvider=function(e,t,i,a,r){if(e._removeListeners(),e.on(E.Providers.CallServiceGateway.ObservableEvents.ANSWER_CALL_REQUEST,this._answerCallRequestedHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.CALL_RINGING,this._callRingingHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.CALL_ESTABLISHED,this._callEstablishedHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.CREATE_MEDIA_REQUEST,this._createMediaRequestHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.CALL_ENDED,this._remoteCallEndedHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.CALL_INCOMING,this._incomingCallHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.CALL_FAILURE,this._callFailureHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.CALL_STATE_FAILURE,this._callStateFailureHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.MAKE_CALL_REQUEST,this._makeCallRequestedHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.CALLS_SERVICE_ACTIVATED,this._callsServiceActivatedHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.CALLS_SERVICE_DEACTIVATED,this._callsServiceDeactivatedHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,this._networkFailureHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,this._networkAvailabilityHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.MAX_NETWORK_RECONNECTION_ATTEMPTED,this._maxNetworkRecoveryAttemptedHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.UPDATE_TRANSFER_STATUS,this._updateTransferStatusHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.UPDATE_CONSULT_CONFERENCE_STATUS,this._updateConsultConferenceStatusHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.UPDATE_CALL_DATA,this._updateCallDataHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.UPDATE_CALL_REQUEST,this._updateCallRequestedHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.ICE_CONFIG_UPDATES,this._iceConfigUpdatesHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.VIDEO_LICENSE_UPDATED,this._videoLicenseUpdatedHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.RINGBACK_TONE_URLS_CHANGED,this._ringbackToneURLsChangedHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.TERMINATE_CALL_REQUEST,this._terminateCallRequestedHandler.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.SUPPORTED_CALL_ENHANCEMENTS,function(e){e&&e.includes("mediaChannelGuidelines")?(this._isServerSupportsNailedUpVideoConnection=!0,this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.MEDIA_CHANNEL_GUIDELINES_AVAILABLE,[])):(this._isServerSupportsNailedUpVideoConnection=!1,this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.MEDIA_CHANNEL_GUIDELINES_UNAVAILABLE,[]))}.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.UPLOAD_LOGS_UPDATE,function(e,t,i){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.UPLOAD_LOGS_UPDATE,[e,t,i])}.bind(this)),e.on(E.Providers.CallServiceGateway.ObservableEvents.IVIEW_TOKEN_UPDATE,function(e){this.trigger(E.Providers.CallServiceGateway.ObservableEvents.IVIEW_TOKEN_UPDATE,[e])}.bind(this)),e.on(E.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(E.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),e.on(E.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(E.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),this.isNailedUpVideoConnectionRequired()){var s={};return this.isVideoAllowed()?s.requiredDirection=E.Services.Call.MediaDirection.RECV_ONLY:s.permittedDirection=E.Services.Call.MediaDirection.INACTIVE,e.start(this,t,i,a,s,r)}return e.start(this,t,i,a,m,r)},e.prototype._stopCallGwProvider=function(i,t){var a=[],e=this._csgwProviderFactory.getCSGCallsProviderAsArray(),r=[];if(t){var s=e.filter(function(e){return e._host===t});0<s.length&&(r.push(s[0]),a.push(s[0].stop()))}else e.forEach(function(e){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Stopping call gateway provider for "+e._host),r.push(e),a.push(e.stop())});T.when.apply(T,a).then(function(){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Stopped call gateway provider(s)");for(var e=0;e<r.length;e++)r[e]._removeListeners(),r[e]._cpCalls={};i.resolve()}.bind(this),function(e){E.Base.Logger.error(E.Base.LoggerTags.CALL_PROVIDER,"Error encountered while stopping call gateway provider(s)",e);for(var t=0;t<r.length;t++)r[t]._removeListeners(),r[t]._cpCalls={};i.reject(e)}.bind(this)).always(function(){for(var e=0;e<r.length;e++)delete this._csgwProviderFactory._csgCallsProviderMap[r[e]._host]}.bind(this))},e.prototype.stop=function(e){if(!this._isBrowserSupported())return T.Deferred().resolve().promise();this._triggerEndCalls(e);var t=T.Deferred();return this._stopCallGwProvider(t,e),t.promise()},e.prototype.stopImmediately=function(){var t=T.Deferred(),i=[];return this._csgwProviderFactory.getCSGCallsProviderAsArray().forEach(function(e){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Force stopping call gateway provider for "+e._host),i.push(e.stopImmediately())}),T.when.apply(T,i).then(function(){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Force stopped call gateway provider(s)"),t.resolve()}.bind(this),function(e){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Failed to force stop call gateway provider(s)"),t.reject()}.bind(this)),t.promise()},e.prototype.startCall=function(e,t,i,a,r,s,n,o){var c,l,d,C,u,v,h=T.Deferred();if(e._isGuestUser){var p=this._config.sgConfiguration.networkProviderConfiguration.restConfig;l=this._configCallGwProvider._host,c=this._csgwProviderFactory.getCSGCallsProvider(l),C=new E.Config.ServerInfo(p.hostName,p.port,p.isSecure,p.path),u=this._config.sgConfiguration.credentialProvider.getDisplayName()}else if(E.Base.Utils.isDefined(e._callCreationInfo)&&E.Base.Utils.isDefined(e._callCreationInfo.getServiceGatewayURL())){var _=e._callCreationInfo.getServiceGatewayURL(),S=E.Base.Utils.parseUrl(_);l=E.Base.Utils.getHost(S),c=this._csgwProviderFactory.getCSGCallsProvider(l),d=l.split(":"),C=new E.Config.ServerInfo(d[0],d[1],S.isSecure,S.path),v=e._callCreationInfo.getAuthorizationToken(),u=e._callCreationInfo.getMeetMeUserName()}c?c._started&&!c._isExternalGateway?(E.Base.Logger.error(E.Base.LoggerTags.CALL_PROVIDER,"Guest user cannot be assigned non external gateway provider"),h.reject("CANNOT assign guest to non external gateway provider")):this._getGatewayCalls(e,l).length||c._isExternalGateway?this._startNewCall(e,t,i,a,r,s,n,h,c,o):this._startExternalGwCall(c,C,u,v,e,t,i,a,r,s,n,h,o):this._startNewCall(e,t,i,a,r,s,n,h,m,o);return h.promise()},e.prototype._startExternalGwCall=function(e,t,i,a,r,s,n,o,c,l,d,C,u){var v=new E.Config.SGConfiguration;a!==m?v.credentialProvider=new E.Config.CredentialTokenProvider(a,E.Config.Authentication.TokenType.ESGTOKEN):(v.credentialProvider=new E.Config.GuestCredentialProvider(i),v.credentialProvider.username=this._config.sgConfiguration.credentialProvider.username),v.enabled=!0,v.networkProviderConfiguration=new E.Config.NetworkProviderConfiguration,v.networkProviderConfiguration.restConfig=t,v.maxCallStartReconnectionAttempts=this._config.sgConfiguration.maxCallStartReconnectionAttempts,this._startCallGwProvider(e,v,!1,d,!0).then(function(){this.isNailedUpVideoConnectionRequired()&&!this.isServerSupportsNailedUpVideoConnection()?C.reject():(this._startNewCall(r,s,n,o,c,l,d,C,e,u),C.resolve())}.bind(this),function(e){C.reject(e)})},e.prototype._startNewCall=function(e,t,i,a,r,s,n,o,c,l){this._createCPCall(e,m,m,n,c).startCall(r,s,t,i,a,l),o.resolve()},e.prototype._createCPCall=function(e,t,i,a,r){var s=E.Base.Utils.isDefined(r)?r:this._configCallGwProvider,n=new E.Providers.Call.CPCall(e,this,s,a);return n.callId=t,n.incomingCallInfo=i,n},e.prototype.updateVideoResolution=function(e,t){var i=this._cpCalls[e.getCallId()];if(i){var a=this.getMediaServiceFactory().getMediaServices().getVideoInterface().getSelectedDevice(),r=this.getMediaServiceFactory().getMediaServices().getAudioInterface().getInputInterface().getSelectedDevice();return i.updateVideoResolution(r,a,t)}return T.Deferred().reject().promise()},e.prototype.updateDevices=function(e,t){var i=this._cpCalls[e.getCallId()];if(i){if(i.isMPaaSCollabCall())return T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise();var a=this.getMediaServiceFactory().getMediaServices().getVideoInterface().getSelectedDevice(),r=this.getMediaServiceFactory().getMediaServices().getAudioInterface().getInputInterface().getSelectedDevice();return i.updateDevice(r,a,t)}return T.Deferred().reject().promise()},e.prototype.stopCall=function(e,t){var i=T.Deferred(),a=this._cpCalls[e.getCallId()];return a?(a.end(t),this.stopExternalGatewayProvider(e).always(function(){i.resolve()})):i.reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND)),i.promise()},e.prototype.stopExternalGatewayProvider=function(e){var t,i=T.Deferred();if(e._isGuestUser&&E.Base.Utils.isUndefined(e._sessionId))t=this._configCallGwProvider._host;else if(e._callCreationInfo!==m&&e._callCreationInfo.getServiceGatewayURL()!==m&&e._callCreationInfo.getAuthorizationToken()!==m){var a=e._callCreationInfo.getServiceGatewayURL(),r=E.Base.Utils.parseUrl(a);t=E.Base.Utils.getHost(r)}t?0===this._getGatewayCalls(e,t).length?this._stopCallGwProvider(i,t):i.reject():i.reject();return i.promise()},e.prototype.isExternalGatewayCall=function(e,t){var i;if(e._isGuestUser)i=this._configCallGwProvider._host;else if(e._callCreationInfo&&E.Base.Utils.isDefined(e._callCreationInfo.getServiceGatewayURL())&&E.Base.Utils.isDefined(e._callCreationInfo.getAuthorizationToken())){var a=e._callCreationInfo.getServiceGatewayURL(),r=E.Base.Utils.parseUrl(a);i=E.Base.Utils.getHost(r)}return t===i},e.prototype.accept=function(e,t,i){var a=T.Deferred(),r=this._cpCalls[e.getCallId()];return r?(r.acceptCall(t,i),a.resolve()):a.reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND)),a.promise()},e.prototype.acceptSendVideo=function(e,t,i){var a=this._cpCalls[e.getCallId()];if(a){if(a.isMPaaSCollabCall())return T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise();var r,s=a.call.getVideoChannels();return 0<s.length?(s[0]._setRequestedDirection(E.Providers.Call.Utils.getVideoDirection(i)),r=s[0]):(r=this._createVideoChannel_VideoMode(i),a.call.getVideoChannels().push(r)),this.triggerVideoChannelUpdate(a.call),a.acceptSendVideo(t,r)}return T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND)).promise()},e.prototype.denySendVideo=function(e){var t=T.Deferred(),i=this._cpCalls[e.getCallId()];if(i){if(i.isMPaaSCollabCall())return t.reject(new E.Services.Call.CallException(E.Services.Call.CallError.CAPABILITY_NOT_ALLOWED));i.denySendVideo(),t.resolve()}else t.reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND));return t.promise()},e.prototype.registerIncomingOrRemoteCall=function(e){var t=this._cpCalls[e.getCallId()];if(t){if(E.Base.Utils.isUndefined(e.getAudioChannel())){var i=this._createAudioChannel_AudioMode(E.Services.Call.AudioMode.SEND_RECEIVE);e._audioChannel=i}t.call=e,this.registerCall(e.getCallId(),e,t)}},e.prototype.getCalls=function(e){return E.Base.Utils.isDefined(e)?this._csgwProviderFactory.getCSGCallsProvider(e).getCalls():T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.NOT_FOUND)).promise()},e.prototype.getClients=function(e){return E.Base.Utils.isDefined(e)?this._csgwProviderFactory.getCSGCallsProvider(e).getClients():T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.NOT_FOUND)).promise()},e.prototype.getCall=function(e,t){return E.Base.Utils.isDefined(t)?this._csgwProviderFactory.getCSGCallsProvider(t).getCall(e):T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.NOT_FOUND)).promise()},e.prototype.getClient=function(e,t){return E.Base.Utils.isDefined(t)?this._csgwProviderFactory.getCSGCallsProvider(t).getClient(e):T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.NOT_FOUND)).promise()},e.prototype.lookupCall=function(e){return this._cpCalls.hasOwnProperty(e)?this._cpCalls[e].call:m},e.prototype.muteAudio=function(e){var t=T.Deferred(),i=this._cpCalls[e.getCallId()];if(i){if(i.muteAudio(),e.isConference()&&e.getConference()._isAvailable){var a=e.getConference();a._sendLocalMuteEvent(a._selfParticipantId,!0)}t.resolve()}else t.reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND));return t.promise()},e.prototype.unmuteAudio=function(e){var t=T.Deferred(),i=this._cpCalls[e.getCallId()];if(i){if(i.unmuteAudio(),e.isConference()&&e.getConference()._isAvailable){var a=e.getConference();a._sendLocalMuteEvent(a._selfParticipantId,!1)}t.resolve()}else t.reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND));return t.promise()},e.prototype.muteVideo=function(e){var t=this._cpCalls[e.getCallId()];return t?t.muteVideo():(this._pendingVideoMuteState=e._videoMuteState,T.Deferred().resolve("Queued").promise())},e.prototype.unmuteVideo=function(e){var t=this._cpCalls[e.getCallId()];return t?t.unmuteVideo():(this._pendingVideoMuteState=e._videoMuteState,T.Deferred().resolve("Queued").promised())},e.prototype.muteSpeaker=function(e){var t=T.Deferred(),i=this._cpCalls[e.getCallId()];return i?(i.muteSpeaker(),t.resolve()):t.reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND)),t.promise()},e.prototype.unmuteSpeaker=function(e){var t=T.Deferred(),i=this._cpCalls[e.getCallId()];return i?(i.unmuteSpeaker(),t.resolve()):t.reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND)),t.promise()},e.prototype.hold=function(e){var t=this._cpCalls[e.getCallId()];if(t)return t.hold();T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND))},e.prototype.unhold=function(e){var t=this._cpCalls[e.getCallId()];return t?t.unhold():T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND))},e.prototype.transfer=function(e,t){var i=this._cpCalls[e.getCallId()];return i?i.transfer(t):T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND))},e.prototype.attendedTransfer=function(e,t){var i=this._cpCalls[e.getCallId()];return i?i.attendedTransfer(t.getCallId()):T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND))},e.prototype.join=function(e,t){var i=this._cpCalls[e.getCallId()];return i?i.join(t):T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND))},e.prototype.sendDTMF=function(e,t){var i=T.Deferred(),a=this._cpCalls[e.getCallId()];return E.Base.Utils.isDefined(a)?(a.sendDTMF(t),i.resolve()):i.reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND)),i.promise()},e.prototype.setVideoMode=function(e,t,i){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"setVideoMode direction: "+t);var a=this._cpCalls[e.getCallId()];if(0===e.getVideoChannels().length){var r=this._createVideoChannel_VideoMode(e,t);e._videoChannels.push(r)}return E.Base.Utils.isDefined(a)&&e.getState()!==E.Services.Call.CallStates.IDLE&&e.getState()!==E.Services.Call.CallStates.ALERTING&&e.getState()!==E.Services.Call.CallStates.IGNORED?a.updateVideoMode(t,i):(this.triggerVideoChannelUpdate(e),T.Deferred().resolve())},e.prototype.setAudioMode=function(e,t){var i,a=this._cpCalls[e.getCallId()];if(!E.Base.Utils.isDefined(e.getAudioChannel())){var r=this._createAudioChannel_AudioMode(t);e._audioChannel=r}return E.Base.Utils.isDefined(a)?(i=T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.FAILED)),E.Base.Logger.error(E.Base.LoggerTags.CALL_PROVIDER,"set audio is not supported")):(E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"audio is set: "+t),i=T.Deferred().resolve()),i},e.prototype.setWebCollaboration=function(e,t){var i,a=this._cpCalls[e.getCallId()];return E.Base.Utils.isDefined(a)?(i=T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.FAILED)),E.Base.Logger.error(E.Base.LoggerTags.CALL_PROVIDER,"set web collaboration is not supported")):(E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"web collaboration is set: "+t),i=T.Deferred().resolve()),i},e.prototype.addParticipantFromCall=function(e,t){var i=this._cpCalls[e];if(E.Base.Utils.isDefined(i)){if(i.call.getConference().getAddParticipantFromCallCapability(t).isAllowed){var a=t.getCallId();return this._consultConferencePromises[a]=T.Deferred(),i.addParticipantFromCall(t),this._consultConferencePromises[a]}return T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.CAPABILITY_NOT_ALLOWED))}return T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND))},e.prototype.getCallStatistics=function(e){var t,i=this._cpCalls[e.getCallId()];if(E.Base.Utils.isDefined(i)){var a=e.getAudioChannel(),r=e.getVideoChannels(),s=!!a&&a.getRequestedDirection()!==E.Services.Call.MediaDirection.DISABLE&&a._getNegotiatedDirection()!==E.Services.Call.MediaDirection.DISABLE,n=!!r&&0!==r.length&&r[0].getRequestedDirection()!==E.Services.Call.MediaDirection.DISABLE&&r[0].getNegotiatedDirection()!==E.Services.Call.MediaDirection.DISABLE;t=s||n?i.getCallStatistics():T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.STATISTICS_UNAVAILABLE)).promise()}else t=T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND)).promise();return t},e.prototype._triggerEndCalls=function(e){for(var t in this._cpCalls)if(this._cpCalls.hasOwnProperty(t)&&(this._cpCalls[t]._callGatewayProvider._host===e||!e)){var i=this._cpCalls[t];i.stopAllStreams(),this._triggerAsyncEndCall(i.call)}},e.prototype._triggerAsyncEndCall=function(e){setTimeout(function(){this.triggerCallEnded(e)}.bind(this),0)},e.prototype.getMediaServiceFactory=function(){return this._mediaServiceFactory},e.prototype.startRinging=function(e){var t=T.Deferred(),i=this._cpCalls[e.getCallId()];return E.Base.Utils.isDefined(i)?(i.startRinging(),t.resolve()):t.reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND)),t.promise()},e.prototype.acceptAnswerCallRequest=function(e){return this._acceptCallRequest(e,E.Providers.Call.CallProvider.Constants.ANSWER_CALL_REQUESTED)},e.prototype.acceptUpdateCallRequest=function(e,t){return this._acceptCallRequest(e,E.Providers.Call.CallProvider.Constants.UPDATE_CALL_REQUESTED,t)},e.prototype.acceptTerminateCallRequest=function(e){return this._acceptCallRequest(e,E.Providers.Call.CallProvider.Constants.TERMINATE_CALL_REQUESTED)},e.prototype.acceptMakeCallRequest=function(e){return this._acceptCallRequest(e,E.Providers.Call.CallProvider.Constants.MAKE_CALL_REQUESTED)},e.prototype._acceptCallRequest=function(e,t,i){var a=T.Deferred(),r=this._cpCalls[e.getCallId()];return E.Base.Utils.isDefined(r)?r.acceptCallRequest(a,t,i):a.reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND)),a.promise()},e.prototype.rejectAnswerCallRequest=function(e){return this._rejectCallRequest(e,E.Providers.Call.CallProvider.Constants.ANSWER_CALL_REQUESTED)},e.prototype.rejectUpdateCallRequest=function(e,t){return this._rejectCallRequest(e,E.Providers.Call.CallProvider.Constants.UPDATE_CALL_REQUESTED)},e.prototype.rejectTerminateCallRequest=function(e){return this._rejectCallRequest(e,E.Providers.Call.CallProvider.Constants.TERMINATE_CALL_REQUESTED)},e.prototype.rejectMakeCallRequest=function(e){return this._rejectCallRequest(e,E.Providers.Call.CallProvider.Constants.MAKE_CALL_REQUESTED)},e.prototype._rejectCallRequest=function(e,t){var i=T.Deferred(),a=this._cpCalls[e.getCallId()];return E.Base.Utils.isDefined(a)?a.rejectCallRequest(i,t):i.reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND)),i.promise()},e.prototype.getOfferSDP=function(e,t,i,a,r,s,n){var o=this._cpCalls[e];o&&o.isReadyToReceiveMediaRequest()?o.getOfferSDP(t,i,a,r,m,m,s,n):this._sdpMediaOfferNotifications[e]={action:t,audioStream:i,videoStreams:a,videoBandwidth:r,turnData:s}},e.prototype.getQueuedMediaOfferNotification=function(e){var t=this._sdpMediaOfferNotifications[e];return t&&delete this._sdpMediaOfferNotifications[e],t},e.prototype.getQueuedCallFailure=function(e){var t=this._callFailureNotificationsQueue[e];return t&&delete this._callFailureNotificationsQueue[e],t},e.prototype.getQueuedVideoMuteState=function(){var e=this._pendingVideoMuteState;return this._pendingVideoMuteState=m,e},e.prototype.queueCallEstablishedNotification=function(e,t,i,a,r,s,n,o,c,l,d,C){this._callEstablishedNotificationsQueue[e]={address:t,displayName:i,audioStream:a,videoStreams:r,isConference:s,uccpUrl:n,webCollabUrl:o,ucid:l,parentUcid:d,contextId:C}},e.prototype.getQueuedCallEstablishedNotification=function(e){var t=this._callEstablishedNotificationsQueue[e];return t&&delete this._callEstablishedNotificationsQueue[e],t},e.prototype.offerSDP=function(e,t,i,a,r,s,n){var o=this._cpCalls[e];o&&o.isReadyToReceiveMediaRequest()?o.offerSDP(i,t,a,r,s,n):this._sdpMediaOfferNotifications[e]={action:t,audioStream:a,videoStreams:r,offer:i,bandwidth:s,turnData:n}},e.prototype.callRinging=function(e,t,i,a,r,s,n,o,c){var l=this._cpCalls[e];l?(l.call._isEarlyMedia&&!n&&this.stopEarlyMedia(l.call),l.callRinging(t,i,a,r,s,n,o,c)):E.Base.Logger.warn(E.Base.LoggerTags.CALL_PROVIDER,"Call not found: "+e)},e.prototype.answerSDP=function(e,t,i,a,r,s){var n=this._cpCalls[e];n?n.answerSDP(i,t,a,r,s):E.Base.Logger.warn(E.Base.LoggerTags.CALL_PROVIDER,"Call not found: "+e)},e.prototype.answerSdpAck=function(e,t,i,a){var r=this._cpCalls[e];r?r.answerSdpAck(t,i,a):E.Base.Logger.warn(E.Base.LoggerTags.CALL_PROVIDER,"Call not found: "+e)},e.prototype.callEstablished=function(e,t,i,a,r,s,n,o,c,l,d,C,u,v,h,p,_){var S=this._cpCalls[e];if(S)E.Base.Utils.isDefined(h)?S.callEstablished(t,i,c,l,d,C,u,r,h,p,_):S.callEstablished(t,i,c,l,d,C,u,r);else{if(!r)return E.Base.Logger.warn(E.Base.LoggerTags.CALL_PROVIDER,"Queue established because call is not found: ",e),void this.queueCallEstablishedNotification(e,t,i,c,l,d,C,u,v,h,p,_);if(!this._isWebRTCSupportedBrowser())return void E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Remote call is not supported: ",e);var g=this._mediaServiceFactory.getMediaServicesService().getUserMedia().adjustVideoResolution(v,this._videoResolution)||this._videoResolution,f={remoteAddress:t,remoteDisplayName:i,isAuraAsserted:o,isPrivate:s,alertType:n,audioStream:c,videoStreams:l,videoResolution:g};S=this._createCPCall(null,e,f,g),this.isSolutionSupportsNailedUpConnection()&&S.setNailedUpVideoConnectionSupported(!0),this._cpCalls[e]=S,this.triggerRemoteCallCreated(e,t,i,o,s,this._isVideoCall(l),n,a)}},e.prototype.callEndedRemotely=function(e,t){var i=this._cpCalls[e];i?i.callEndedRemotely(t):E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Call not found: "+e)},e.prototype.callStateFailure=function(e,t){var i=this._cpCalls[e];i&&i.callStateFailure(t)},e.prototype.callFailure=function(e,t,i,a,r){var s=this._cpCalls[e];s?s.callFailure(t,i,a,r):this._callFailureNotificationsQueue[e]={errorCode:t,protocolType:i,protocolErrorCode:a,failureReason:r}},e.prototype.stopEarlyMedia=function(e){var t=this._cpCalls[e];if(t){var i=this.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput();t.stopEarlyMedia(i)}else E.Base.Logger.warn(E.Base.LoggerTags.CALL_PROVIDER,"Call not found: "+e)},e.prototype.triggerCallStarted=function(e){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CALL_STARTED,[e])},e.prototype.triggerCallRinging=function(e,t){var i=!!E.Base.Utils.isDefined(t)&&t;this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CALL_RINGING,[e,i])},e.prototype.triggerCallEstablished=function(e,t,i,a,r,s,n,o){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CALL_ESTABLISHED,[e,t,r,s,n,o]),this.triggerConferenceEscalation(e,i,a,t)},e.prototype.triggerCallEstablishing=function(e){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CALL_ESTABLISHING,[e])},e.prototype.triggerRemoteStreamAdded=function(e,t){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.REMOTE_STREAM_ADDED,[e,t])},e.prototype.triggerCallEnded=function(e,t,i){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CALL_ENDED,[e,t,i])},e.prototype.triggerRemoteCallCreated=function(e,t,i,a,r,s,n,o){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.REMOTE_CALL_CREATED,[e,t,i,a,r,s,n,o])},e.prototype.triggerIncomingCall=function(e,t,i,a,r,s,n,o,c,l,d){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.INCOMING_CALL,[e,t,i,a,r,s,n,o,c,l,d])},e.prototype.triggerIncomingAddVideoRequest=function(e,t){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_REQUEST,[e,t])},e.prototype.triggerIncomingAddVideoAccepted=function(e){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_ACCEPTED,[e])},e.prototype.triggerIncomingAddVideoDenied=function(e){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_DENIED,[e])},e.prototype.triggerIncomingAddVideoTimedout=function(e){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_TIMEDOUT,[e])},e.prototype.triggerVideoChannelUpdate=function(e){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.VIDEO_CHANNEL_UPDATE,[e])},e.prototype.triggerConferenceEscalation=function(e,t,i,a){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CONFERENCE_ESCALATION,[e,t,i,a])},e.prototype.triggerVideoEscalationRejected=function(e){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.VIDEO_ESCALATION_REJECTED,[e])},e.prototype.triggerCallFailure=function(e,t,i,a,r){var s=this._cpCalls[e];s&&this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[s.call,t,i,a,r])},e.prototype.triggerCallServiceUnavailable=function(e){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_UNAVAILABLE,[e])},e.prototype.triggerRemoteHold=function(e){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.INCOMING_HOLD,[e])},e.prototype.triggerRemoteUnhold=function(e){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.INCOMING_UNHOLD,[e])},e.prototype.triggerRemoteAddressChanged=function(e,t,i,a,r,s){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.REMOTE_ADDRESS_CHANGED,[e,t,i,a,r,s])},e.prototype.triggerAllowedNailedUpVideoModes=function(e,t){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.ALLOWED_NAILEDUP_VIDEO_MODES,[e,t])},e.prototype.triggerMediaConnectionUpdate=function(e,t){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.ICE_CONNECTION_UPDATE,[e,t])},e.prototype.triggerCallMediaFailed=function(e){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CALL_MEDIA_FAILED,[e])},e.prototype.registerCall=function(e,t,i){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"register call: "+e),t._setCallId(e),this._cpCalls[e]=i},e.prototype.unRegisterCall=function(e){e&&(E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"unregister call: "+e.getCallId()),delete this._cpCalls[e.getCallId()])},e.prototype.isVideoConfigurationEnabled=function(){return this._config.callUserConfiguration.videoEnabled},e.prototype._callRingingHandler=function(e,t,i,a,r,s,n,o,c){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Received Call Ringing"),this.callRinging(e,t,i,a,r,s,n,o,c)},e.prototype._callEstablishedHandler=function(e,t,i,a,r,s,n,o,c,l,d,C,u,v,h,p,_){E.Base.Logger.debug(E.Base.LoggerTags.CALL_PROVIDER,"Received Call Established"),this.callEstablished(e,t,i,a,r,s,n,o,c,l,d,C,u,v,h,p,_)},e.prototype._createMediaRequestHandler=function(e,t,i,a,r,s){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Received Create Media Request"),this.getOfferSDP(e,t,i,a,r,s)},e.prototype._remoteCallEndedHandler=function(e,t){var i="Received Remote Call Ended";t&&(i=i+": ["+t.getProtocol()+","+t.getCause()+","+t.getText()+"]"),E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,i),this.callEndedRemotely(e,t)},e.prototype._incomingCallHandler=function(e,t,i,a,r,s,n,o,c,l,d,C,u,v,h,p){var _=this._mediaServiceFactory.getMediaServicesService().getUserMedia().adjustVideoResolution(C,this._videoResolution)||this._videoResolution;E.Base.Logger.debug(E.Base.LoggerTags.CALL_PROVIDER,"Received Incoming Call");var S={remoteAddress:t,remoteDisplayName:i,isAuraAsserted:a,isPrivate:r,alertType:s,sdp:o,audioStream:c,videoStreams:l,turnData:p},g=this._createCPCall(null,e,S,_);g.determineIfNailedUpVideoConnectionSupported(l),g._isReadyToReceiveMediaRequest=!0,this._cpCalls[e]=g,this.triggerIncomingCall(e,t,i,a,r,this._isVideoCall(l),s,d,u,v,h)},e.prototype._callFailureHandler=function(e,t,i,a,r){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Received Call Failure: ["+t+":"+i+":"+a+":"+r+"]"),this.callFailure(e,t,i,a,r)},e.prototype._callStateFailureHandler=function(e,t,i,a,r){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Received Call State Failure: ["+t+":"+i+":"+a+":"+r+"]"),this.callStateFailure(e,t)},e.prototype._networkFailureHandler=function(e,t,i){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Received Network Failure: ["+e+":"+t+":"+i+"]");var a=!1;for(var r in this._cpCalls)if(this._cpCalls.hasOwnProperty(r)){var s=this._cpCalls[r];s&&s.call&&s._callGatewayProvider&&s._callGatewayProvider._host===e&&(s.setCallServiceAvailable(!1),this.triggerCallServiceUnavailable(s.call),this._callsAnalyticsService.sendUnavailableEvent(E.Services.Analytics.AnalyticsErrorCode.NETWORK_ERROR),a=!0)}a||(this.triggerCallServiceUnavailable(),this._callsAnalyticsService.sendUnavailableEvent(E.Services.Analytics.AnalyticsErrorCode.NO_CALL_WAS_CREATED_ERROR))},e.prototype._maxNetworkRecoveryAttemptedHandler=function(e){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Received Maximum Network Recover Attempted: "+e),this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.MAX_NETWORK_RECOVERY_ATTEMPTED,[e])},e.prototype._callsServiceDeactivatedHandler=function(e,t){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Calls Service Deactivated: "+e+":"+t),this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_DEACTIVATED,[e,t])},e.prototype._networkAvailabilityHandler=function(s){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Received Network Availability: "+s),this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_AVAILABLE,[]),this.getCalls(s).then(function(e){for(var t in this._cpCalls)if(this._cpCalls.hasOwnProperty(t)){var i=this._cpCalls[t];if(i._callGatewayProvider&&i._callGatewayProvider._host===s){for(var a=!1,r=0;r<e.length;r++)e[r].callId===t&&(a=!0,i.setCallServiceAvailable(!0),this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_AVAILABLE,[i.call]));a||i.triggerCallMediaFailed()}}}.bind(this),function(e){E.Base.Logger.error(E.Base.LoggerTags.CALL_PROVIDER,"Failed to get list of active calls from server",e)}.bind(this))},e.prototype._callsServiceActivatedHandler=function(e){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Calls Service Activated: "+e)},e.prototype._updateTransferStatusHandler=function(e,t){if(E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Received Transfer Status Update: "+t),this._cpCalls.hasOwnProperty(e)){var i=this._cpCalls[e];i._transferPromise.notify(t),t===E.Providers.Call.CallProvider.Constants.TRANSFER_STATUS_DONE?i.transferCompleted():t===E.Providers.Call.CallProvider.Constants.TRANSFER_STATUS_FAILED&&i.transferFailed()}},e.prototype._updateConsultConferenceStatusHandler=function(e,t){E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Received Consult Conference Status Update: "+t),this._consultConferencePromises.hasOwnProperty(e)&&(this._consultConferencePromises[e].notify(t),t===E.Providers.Call.CallProvider.Constants.CONSULT_CONFERENCE_STATUS_DONE?(this._consultConferencePromises[e].resolve(),delete this._consultConferencePromises[e]):(t===E.Providers.Call.CallProvider.CONSULT_CONFERENCE_STATUS_FAILED||-1<t.indexOf(E.Providers.Call.CallProvider.Constants.ERROR))&&(E.Base.Logger.warn(E.Base.LoggerTags.CALL_PROVIDER,"Failed to add "+e+" to Consult Conference: "+t),this._consultConferencePromises[e].reject(t),delete this._consultConferencePromises[e]))},e.prototype._updateCallDataHandler=function(e,t,i,a,r,s,n,o,c){if(E.Base.Logger.info(E.Base.LoggerTags.CALL_PROVIDER,"Received Call Data Update: ["+e+":"+t+":"+i+":"+r+":"+s+":"+n+"]"),this._cpCalls.hasOwnProperty(e)){var l=this._cpCalls[e],d=l.call,C=d.isConference(),u=C&&d.getConference(),v=C&&u._isConferenceStarted(),h=C&&u._isStarting,p=C?u._getType():"unknown";E.Base.Logger.debug(E.Base.LoggerTags.CALL_PROVIDER,(C?"Conference":"Non-Conference")+" Data Update: [Existing conference call? "+C+"; Is conference started? "+v+"; Is conference starting? "+h+"; Conference type="+p+"; uucpUrl="+r+"; webCollabUrl="+s+"]"),E.Providers.Call.Utils.updateAndTriggerRemoteAddressChangedIfNeeded(this,d,t,i,n,o,c),a&&(!C||C&&!v&&!h||r||s)&&l.hasReceivedCallEstablishedEvent()&&this.triggerConferenceEscalation(l.call,r,s,a)}},e.prototype._iceConfigUpdatesHandler=function(e){if(e&&0<e.length){this._rtcConfiguration={iceServers:[{urls:""}]};if(1===e.length)this._rtcConfiguration.iceServers[0].urls="stun:"+e[0];else{for(var t=[],i=0;i<e.length;i++)t.push("stun:"+e[i]);this._rtcConfiguration.iceServers[0].urls=t}}},e.prototype._videoLicenseUpdatedHandler=function(e){this._updateVideoLicense(e),this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.VIDEO_LICENSE_UPDATED,[e])},e.prototype._createVideoChannel_VideoMode=function(e,t){var i=new E.Services.Call.VideoChannel(e);return i._setChannelId(this._mediaServiceFactory.getVideoInterfaceService().createVideoChannel()),i._setRequestedDirection(E.Providers.Call.Utils.getVideoDirection(t)),i},e.prototype._createAudioChannel_AudioMode=function(e){var t=new E.Services.Call.AudioChannel;return t._setRequestedDirection(E.Providers.Call.Utils.getAudioDirection(e)),t},e.prototype.createVideoChannel_MediaDirection=function(e,t){var i=new E.Services.Call.VideoChannel(e);return i._setChannelId(this._mediaServiceFactory.getVideoInterfaceService().createVideoChannel()),i._setRequestedDirection(t),i},e.prototype.hasVideoDevices=function(){return this._mediaServiceFactory.getVideoInterface().hasAvailableDevices()},e.prototype.isNailedUpVideoConnectionRequired=function(){return this._browserType===E.Base.BrowserType.EDGE},e.prototype.isServerSupportsNailedUpVideoConnection=function(){return!E.Base.Utils.isDefined(this._isServerSupportsNailedUpVideoConnection)||this._isServerSupportsNailedUpVideoConnection},e.prototype.isSolutionSupportsNailedUpConnection=function(){return this.isNailedUpVideoConnectionRequired()&&this.isServerSupportsNailedUpVideoConnection()},e.prototype.isVideoAllowed=function(){return this._isVideoAllowed},e.prototype._isVideoCall=function(e){if(E.Base.Utils.isDefined(e)&&0<e.length&&e[0].enabled){var t=e[0].direction;return this.isSolutionSupportsNailedUpConnection()?!E.Services.Call.MediaDirection._isDisabled(t)&&e[0]._logicalDirection!==E.Services.Call.MediaDirection.INACTIVE:!E.Services.Call.MediaDirection._isDisabled(t)&&t!==E.Services.Call.MediaDirection.INACTIVE}return!1},e.prototype._ringbackToneURLsChangedHandler=function(e){this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.RINGBACK_TONE_URLS_CHANGED,[e])},e.prototype._isBrowserSupported=function(){var e=E.Base.Utils.queryJSONObject(this._config,"sgConfiguration._disableWebRTCForTheseBrowsers");return E.Base.Utils.isWebRTC_SupportedBrowser(e)},e.prototype._isTurnTlsHasHighestPriority=function(){return E.Base.Utils.queryJSONObject(this._config,"sgConfiguration._setTurnTlsToHighestPriority")},e.prototype._answerCallRequestedHandler=function(e,t){if(this._cpCalls.hasOwnProperty(e)){var i=this._cpCalls[e];i.setCallRequestedTransactionalId(E.Providers.Call.CallProvider.Constants.ANSWER_CALL_REQUESTED,t),this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.ANSWER_CALL_REQUESTED,[i.call])}},e.prototype._terminateCallRequestedHandler=function(e,t){if(this._cpCalls.hasOwnProperty(e)){var i=this._cpCalls[e];i.setCallRequestedTransactionalId(E.Providers.Call.CallProvider.Constants.TERMINATE_CALL_REQUESTED,t),this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.TERMINATE_CALL_REQUESTED,[i.call])}},e.prototype._updateCallRequestedHandler=function(e,t,i){if(this._cpCalls.hasOwnProperty(e)){var a=this._cpCalls[e];a.setCallRequestedTransactionalId(E.Providers.Call.CallProvider.Constants.UPDATE_CALL_REQUESTED,t),this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.UPDATE_CALL_REQUESTED,[a.call,i])}},e.prototype._makeCallRequestedHandler=function(e,t,i,a,r,s){var n=this._createCPCall(null,e,m,this._videoResolution);(this._cpCalls[e]=n).setCallRequestedTransactionalId(E.Providers.Call.CallProvider.Constants.MAKE_CALL_REQUESTED,i),this.trigger(E.Providers.Interfaces.CallProviderCallbackIds.MAKE_CALL_REQUESTED,[e,t,a,r,s])},e.prototype._updateVideoLicense=function(e){var t=E.Base.Utils.queryJSONObject(this._config,"callUserConfiguration.videoEnabled");E.Base.Utils.isDefined(t)&&(this._isVideoAllowed=this._isVideoAllowed&&t),e&&(this._isVideoAllowed=this._isVideoAllowed&&e)},e.prototype._isWebRTCSupportedBrowser=function(){var e=E.Base.Utils.queryJSONObject(this._config,"sgConfiguration._disableWebRTCForTheseBrowsers"),t=E.Base.Utils.isWebRTC_SupportedBrowser(e);return this.isNailedUpVideoConnectionRequired()?t&&this.isServerSupportsNailedUpVideoConnection():t},e.prototype.setActiveCallVideoTrack=function(e){if(this._activeCallVideoTrack=m,this.isNailedUpVideoConnectionRequired()&&this.isServerSupportsNailedUpVideoConnection()&&this._cpCalls.hasOwnProperty(e)){var t=this._cpCalls[e];0<t.getVideoStreams().length&&t.localStream.getVideoTracks().forEach(function(e){e.readyState!==E.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_ENDED&&(this._activeCallVideoTrack=e)}.bind(this))}},e.prototype.getActiveCallVideoTrack=function(){return this._activeCallVideoTrack},e.prototype._getGatewayCalls=function(t,i){return t._callService._callManager.getAllCalls().filter(function(e){return!!e.getCallId()&&(!!this._cpCalls[e.getCallId()]&&(e.getCallId()!==t.getCallId()&&this._cpCalls[e.getCallId()]._callGatewayProvider._host===i))}.bind(this))},e.prototype._getHost=function(){var e,t=this._config.sgConfiguration.networkProviderConfiguration.restConfig;return e=t.isSecure?E.Base.Utils.isDefined(t.port)?t.port:"443":E.Base.Utils.isDefined(t.port)?t.port:"80",t.hostName+":"+e},e.prototype._getCsgCallsProvider=function(){var e=this._getHost();return this._csgwProviderFactory.getCSGCallsProvider(e)},e.prototype.setOnNetworkEvents=function(e,t){var i=this._getMediaServiceSessionId();if(!i){var a=new E.Services.Call.CallException(E.Services.Call.CallError.MEDIA_SERVICE_UNAVAILABLE);return E.Base.Logger.error(E.Base.LoggerTags.CALL_PROVIDER,a),T.Deferred().reject(a).promise()}var r={sessionId:i,acceptedEvents:e};return this._csgCallsProvider=this._getCsgCallsProvider(),this._csgCallsProvider.setOnNetworkEvents(r,t)},e.prototype.isNetworkEventsUrlDefined=function(){var e=!1;return this._config&&(this._csgCallsProvider=this._getCsgCallsProvider(),e=this._csgCallsProvider.isNetworkEventsUrlDefined()),e},e.prototype.removeOnNetworkEvents=function(){var e=this._getMediaServiceSessionId();if(e)return this._csgCallsProvider=this._getCsgCallsProvider(),this._csgCallsProvider.removeOnNetworkEvents(e);var t=new E.Services.Call.CallException(E.Services.Call.CallError.MEDIA_SERVICE_UNAVAILABLE);return E.Base.Logger.error(E.Base.LoggerTags.CALL_PROVIDER,t),T.Deferred().reject(t).promise()},e.prototype._getMediaServiceSessionId=function(){var e;return this._config._mediaServiceConfiguration&&(e=this._config._mediaServiceConfiguration.sessionId),e},e.prototype.isMediaConnected=function(e){var t=this._cpCalls[e.getCallId()];return!!t&&t.isMediaConnected()},e.prototype.setPreferredReceiveResolution=function(e,t,i){var a=this._cpCalls[e.getCallId()];return a?a.setPreferredReceiveResolution(t,i):T.Deferred().reject(new E.Services.Call.CallException(E.Services.Call.CallError.CALL_NOT_FOUND))},E.Providers.Call.CallProvider=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Call.CallProvider.Constants={DISABLE_STATE:"DISABLE",ENABLE_STATE:"ENABLE",ERROR:"ERROR",ADD_VIDEO:"ADD_VIDEO",UPDATE_VIDEO:"UPDATE_VIDEO",REMOVE_VIDEO:"REMOVE_VIDEO",HOLD:"HOLD",INCOMING_UNHOLD:"INCOMING_UNHOLD",UNHOLD:"UNHOLD",VIDEO_TRACK:"video",AUDIO_TRACK:"audio",ADD_PARTICIPANT_ACTION:"ADD_PARTICIPANT",ADD_VIDEO_ACTION:"ADD_VIDEO",HOLD_ACTION:"HOLD",UNHOLD_ACTION:"UNHOLD",INCOMING_ADD_VIDEO_ACTION:"INCOMING_ADD_VIDEO",INCOMING_REMOVE_VIDEO_ACTION:"INCOMING_REMOVE_VIDEO",INCOMING_UPDATE_VIDEO_ACTION:"INCOMING_UPDATE_VIDEO",INCOMING_HOLD_ACTION:"INCOMING_HOLD",INCOMING_UNHOLD_ACTION:"INCOMING_UNHOLD",TRANSFER_ACTION:"TRANSFER",TRANSFER_STATUS_DONE:"DONE",TRANSFER_STATUS_FAILED:"FAILED",CONSULT_CONFERENCE_STATUS_DONE:"DONE",CONSULT_CONFERENCE_STATUS_FAILED:"FAILED",END_CALL_BY_REMOTE:"remote",END_CALL_NORMAL:"normal",END_CALL_DENY_WITH_REASON:"denyWithReason",INITIAL_MEDIA:"INITIAL_MEDIA",DEFAULT_CALL_GW_PROVIDER:"DefaultCallGWProvider",ANSWER_CALL_REQUESTED:"AnswerCallRequested",MAKE_CALL_REQUESTED:"MakeCallRequested",TERMINATE_CALL_REQUESTED:"TerminateCallRequested",UPDATE_CALL_REQUESTED:"UpdateCallRequested",ICE_CANDIDATE_TYPE_RELAY_ONLY:"relayOnly",ICE_CANDIDATE_TYPE_HOST_ONLY:"hostOnly"}}(),function(e){"use strict";var t=e.Providers.Call.States={};t.INITIAL=new e.Base.SimpleFsm.SimpleFsmState("INITIAL"),t.STARTING=new e.Base.SimpleFsm.SimpleFsmState("STARTING"),t.ALERTING=new e.Base.SimpleFsm.SimpleFsmState("ALERTING"),t.ACTIVE=new e.Base.SimpleFsm.SimpleFsmState("ACTIVE"),t.ACTIVE_RENEGOTIATE=new e.Base.SimpleFsm.SimpleFsmState("ACTIVE_RENEGOTIATE"),t.FAILED=new e.Base.SimpleFsm.SimpleFsmState("FAILED"),t.ENDING=new e.Base.SimpleFsm.SimpleFsmState("ENDING"),t.ENDED=new e.Base.SimpleFsm.SimpleFsmState("ENDED")}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r){this._username=e,this._credential=t,this._address=i,this._transportTypes=a,this._iceTransportPolicy=r||"relay"}t.prototype={getUsername:function(){return this._username},getCredential:function(){return this._credential},getAddress:function(){return this._address},getTransportTypes:function(){return this._transportTypes},getIceTransportPolicy:function(){return this._iceTransportPolicy}},e.Providers.Call.TurnData=t}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a){this._address=e,this._protocol=t,this._transport=i,this._port=a,this._transportPrecedence=0,this._tlsHasHighestPriority=!1}t.prototype={getProtocol:function(){return this._protocol},getTransport:function(){return this._transport},getPort:function(){return this._port},getUrl:function(){return this._protocol+":"+this._address+":"+this._port+"?transport="+this._transport},_setTlsToHighestPriority:function(e){this._tlsHasHighestPriority=e},getTransportPrecedence:function(){if("udp"===this._transport)return 3;if("tcp"!==this._transport)return 0;var e=this._tlsHasHighestPriority?100:1;return"turn"===this._protocol?2:e}},e.Providers.Call.TurnTransportType=t}(AvayaClientServices),function(C){"use strict";C.Providers.Call.Utils={updateVideoSdp:function(e,t){switch(e.direction){case C.Services.Call.MediaDirection.SEND_ONLY:return C.Base.SDPUtil.updateVideoSdpSendOnly(t);case C.Services.Call.MediaDirection.SEND_RECV:return C.Base.SDPUtil.updateVideoSdpSendRecv(t);case C.Services.Call.MediaDirection.RECV_ONLY:return C.Base.SDPUtil.updateVideoSdpRecvOnly(t);default:return C.Base.SDPUtil.updateVideoSdpInactive(t)}},updateAudioSdp:function(e,t){switch(e.direction){case C.Services.Call.MediaDirection.SEND_ONLY:return C.Base.SDPUtil.updateAudioSdpSendOnly(t);case C.Services.Call.MediaDirection.SEND_RECV:return C.Base.SDPUtil.updateAudioSdpSendRecv(t);case C.Services.Call.MediaDirection.RECV_ONLY:return C.Base.SDPUtil.updateAudioSdpRecvOnly(t);default:return C.Base.SDPUtil.updateAudioSdpInactive(t)}},updateAndTriggerRemoteAddressChangedIfNeeded:function(e,t,i,a,r,s,n){var o=C.Base.Utils.isDefined(a)&&t.getRemoteDisplayName()!==a,c=C.Base.Utils.isDefined(i)&&t.getRemoteAddress()!==i,l=t.getUserToUserInfo(),d=C.Base.Utils.isDefined(r)&&(C.Base.Utils.isUndefined(l)||l.getUCID()!==r);(c||o||d)&&e.triggerRemoteAddressChanged(t,i,a,r,s,n)},getVideoDirection:function(e){switch(e){case C.Services.Call.VideoMode.SEND_RECEIVE:return C.Services.Call.MediaDirection.SEND_RECV;case C.Services.Call.VideoMode.SEND_ONLY:return C.Services.Call.MediaDirection.SEND_ONLY;case C.Services.Call.VideoMode.RECEIVE_ONLY:return C.Services.Call.MediaDirection.RECV_ONLY;case C.Services.Call.VideoMode.INACTIVE:return C.Services.Call.MediaDirection.INACTIVE;case C.Services.Call.VideoMode.DISABLE:return C.Services.Call.MediaDirection.DISABLE;default:return C.Services.Call.MediaDirection.UNDEFINED}},getAudioDirection:function(e){switch(e){case C.Services.Call.AudioMode.SEND_RECEIVE:case C.Services.Call.AudioMode.ENABLE:return C.Services.Call.MediaDirection.SEND_RECV;case C.Services.Call.AudioMode.DISABLE:return C.Services.Call.MediaDirection.DISABLE;default:return C.Services.Call.MediaDirection.UNDEFINED}},getVideoMode:function(e){switch(e){case C.Services.Call.MediaDirection.SEND_RECV:return C.Services.Call.VideoMode.SEND_RECEIVE;case C.Services.Call.MediaDirection.SEND_ONLY:return C.Services.Call.VideoMode.SEND_ONLY;case C.Services.Call.MediaDirection.RECV_ONLY:return C.Services.Call.VideoMode.RECEIVE_ONLY;case C.Services.Call.MediaDirection.INACTIVE:return C.Services.Call.VideoMode.INACTIVE;default:return C.Services.Call.VideoMode.DISABLE}}}}(AvayaClientServices),function(e){"use strict";function t(e,t,i){this._protocol=e,this._cause=t,this._text=i}t.prototype={getProtocol:function(){return this._protocol},getCause:function(){return this._cause},getText:function(){return this._text},_setCause:function(e){this._cause=e},_setProtocol:function(e){this._protocol=e}},e.Providers.Call.CallReason=t}(AvayaClientServices),function(u){"use strict";function e(e,t,i,a){this._callGatewayProvider=i,this._callProvider=t,this.call=e,this.localStream=null,this.remoteStream=null,this.remote=!1,this.callId=null,this.incomingCallInfo={},this.incomingVideoRequestTimer=m,this.mediaTransactionDfd=m,this.noMediaTransactionDfd=m,this._mediaTransactionInitialEvent=m,this.audioStream=null,this.videoStreams=[],this._videoChannelId=m,this._audioDevice=m,this._videoDevice=m;var r=t._config?t._config.callUserConfiguration.turnRelayCandidatesGatheringTimeout:5e3,s=t._config?t._config.callUserConfiguration.iceCandidatesGatheringTimeout:15e3,n=t._config?t._config.callUserConfiguration.iceConnectionRestartInterval:5e3;this._rtConnection=t._rtcConnectionProviderFactory.create(t._rtcConfiguration,r,s,n,3e5),this._rtcConfiguration=t._rtcConfiguration,this._transferPromise=m,this._joinRemotePromise=m,this._isEarlyMedia=!1,this._videoResolution=a,this._maxVideoResolution=a,this._activeRenegotiateEventQueue=[],this._queuedRemoteCallEstablishedEvent=m,this._isReadyToReceiveMediaRequest=!1,this._3pccRequestTransactionMap={},this._mediaAction=m,this._prevMediaAction=m,this._latestVideoModeDirection=m,this._latestNonHoldingVideoDirection=m,this._isNailedUpVideoConnectionSupported=!1,this._isRingingStarted=!1,this._isCallServiceAvailable=!0,this._iceConnectionRestartTimestamp=m,this._iceRestartTransactionDfd=m,this._iceRestartRelayType="",this._iceRestartAttempts=0,this._pendingVideoMuteUnmuteFunctor=m,this._hasReceivedCallEstablishedEvent=!1,this._hasLoggedRelayICECandidates=!1,this._isMPaaSCollabCall=!1,this._isMediaConnected=!1,this._hadMediaConnected=!1,this._iceRestartInProgress=!1,this._hasTriggeredMediaFailed=!1,this._browserType=u.Base.Utils.getBrowserType(),this._getOfferSDPEventInMultipleHandler=new u.Providers.Call.GetOfferSDPEventInMultipleHandler,this._offerSDPEventInMultipleHandler=new u.Providers.Call.OfferSDPEventInMultipleHandler,this._escalateVideoGetOfferEventInActiveRenegotiateHandler=new u.Providers.Call.EscalateVideoGetOfferEventInActiveRenegotiateHandler,this._escalateVideoOfferEventInActiveRenegotiateHandler=new u.Providers.Call.EscalateVideoOfferEventInActiveRenegotiateHandler,this._fsm=new u.Base.SimpleFsm.SimpleFsm,this._fsm.registerHandler(u.Providers.Call.States.INITIAL,u.Providers.Call.StartCallEvent,u.Providers.Call.StartCallEventInInitialHandler),this._fsm.registerHandler(u.Providers.Call.States.INITIAL,u.Providers.Call.AcceptCallEvent,u.Providers.Call.AcceptCallEventInInitialHandler),this._fsm.registerHandler(u.Providers.Call.States.INITIAL,u.Providers.Call.EndCallEvent,u.Providers.Call.EndCallEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.INITIAL,u.Providers.Call.JoinRemoteCallEvent,u.Providers.Call.JoinRemoteCallEventInInitialHandler),this._fsm.registerHandler(u.Providers.Call.States.INITIAL,u.Providers.Call.RevertStateEvent,u.Providers.Call.RevertStateEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.INITIAL,u.Providers.Call.CallFailureEvent,u.Providers.Call.CallFailureEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.INITIAL,u.Providers.Call.AcceptCallRequestEvent,u.Providers.Call.AcceptCallRequestEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.INITIAL,u.Providers.Call.RejectCallRequestEvent,u.Providers.Call.RejectCallRequestEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.INITIAL,u.Providers.Call.StartRingingEvent,u.Providers.Call.StartRingingEventInInitialHandler),this._fsm.registerHandler(u.Providers.Call.States.INITIAL,u.Providers.Call.DeviceRetrievalFailedEvent,u.Providers.Call.DevicesFailureHandler),this._fsm.registerHandler(u.Providers.Call.States.INITIAL,u.Providers.Call.MuteVideoEvent,u.Providers.Call.MuteVideoEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.INITIAL,u.Providers.Call.UnmuteVideoEvent,u.Providers.Call.UnmuteVideoEventInMultipleHandler),this._fsm.registerNoOpHandler(u.Providers.Call.States.INITIAL,u.Providers.Call.ServiceAvailableEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.INITIAL,u.Providers.Call.UpdatePreferredReceiveResolutionEvent),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.StartCallResponseEvent,u.Providers.Call.StartCallResponseEventInStartingHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.GetOfferSDPEvent,u.Providers.Call.GetOfferSDPEventInStartingHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.OfferSDPEvent,u.Providers.Call.OfferSDPEventInStartingHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.CallRingingEvent,u.Providers.Call.CallRingingEventInStartingHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.AnswerSDPEvent,u.Providers.Call.AnswerSDPEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.MuteAudioEvent,u.Providers.Call.MuteAudioEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.UnmuteAudioEvent,u.Providers.Call.UnmuteAudioEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.OnAddStreamEvent,u.Providers.Call.OnAddStreamEventPreActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.CallEstablishedEvent,u.Providers.Call.CallEstablishedEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.EndCallEvent,u.Providers.Call.EndCallEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.DeviceRetrievalFailedEvent,u.Providers.Call.DevicesFailureHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.UpdateLocalStreamEvent,u.Providers.Call.UpdateLocalStreamHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.CallFailureEvent,u.Providers.Call.CallFailureEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.MuteVideoEvent,u.Providers.Call.MuteVideoEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.UnmuteVideoEvent,u.Providers.Call.UnmuteVideoEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.STARTING,u.Providers.Call.UpdateIceRestartMediaEvent,u.Providers.Call.UpdateIceRestartMediaEventInActiveHandler),this._fsm.registerNoOpHandler(u.Providers.Call.States.STARTING,u.Providers.Call.OnAddRemoteTrackEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.STARTING,u.Providers.Call.CallStateFailureEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.STARTING,u.Providers.Call.ServiceAvailableEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.STARTING,u.Providers.Call.UpdatePreferredReceiveResolutionEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.CallRingingEvent),this._fsm.registerHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.AnswerSDPEvent,u.Providers.Call.AnswerSDPEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.MuteAudioEvent,u.Providers.Call.MuteAudioEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.UnmuteAudioEvent,u.Providers.Call.UnmuteAudioEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.MuteSpeakerEvent,u.Providers.Call.MuteSpeakerEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.UnmuteSpeakerEvent,u.Providers.Call.UnmuteSpeakerEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.OnAddStreamEvent,u.Providers.Call.OnAddStreamEventPreActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.CallEstablishedEvent,u.Providers.Call.CallEstablishedEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.EndCallEvent,u.Providers.Call.EndCallEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.SendDTMFEvent,u.Providers.Call.SendDTMFEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.GetOfferSDPEvent,u.Providers.Call.GetOfferSDPEventInStartingHandler),this._fsm.registerHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.OfferSDPEvent,u.Providers.Call.OfferSDPEventInStartingHandler),this._fsm.registerHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.CallFailureEvent,u.Providers.Call.CallFailureEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.MuteVideoEvent,u.Providers.Call.MuteVideoEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.UnmuteVideoEvent,u.Providers.Call.UnmuteVideoEventInMultipleHandler),this._fsm.registerNoOpHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.OnAddRemoteTrackEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.OnRemoveRemoteTrackEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.CallStateFailureEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.UpdateIceRestartMediaEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.ServiceAvailableEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ALERTING,u.Providers.Call.UpdatePreferredReceiveResolutionEvent),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.CallEstablishedEvent,u.Providers.Call.CallEstablishedEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.IncomingAddVideoEvent,u.Providers.Call.IncomingAddVideoEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.IncomingRemoveVideoEvent,u.Providers.Call.IncomingRemoveVideoEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.IncomingAddVideoTimedoutEvent,u.Providers.Call.IncomingAddVideoTimedoutEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.AcceptSendVideoEvent,u.Providers.Call.AcceptSendVideoEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.DenySendVideoEvent,u.Providers.Call.DenySendVideoEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.MuteAudioEvent,u.Providers.Call.MuteAudioEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.UnmuteAudioEvent,u.Providers.Call.UnmuteAudioEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.MuteVideoEvent,u.Providers.Call.MuteVideoEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.UnmuteVideoEvent,u.Providers.Call.UnmuteVideoEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.MuteSpeakerEvent,u.Providers.Call.MuteSpeakerEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.UnmuteSpeakerEvent,u.Providers.Call.UnmuteSpeakerEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.BlockCameraEvent,u.Providers.Call.BlockCameraEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.UnBlockCameraEvent,u.Providers.Call.UnBlockCameraEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.EscalateVideoEvent,u.Providers.Call.EscalateVideoEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.EscalateNailedUpVideoEvent,u.Providers.Call.EscalateNailedUpVideoEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.DeEscalateVideoEvent,u.Providers.Call.DeEscalateVideoEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.GetOfferSDPEvent,this._getOfferSDPEventInMultipleHandler.handleEvent.bind(this._getOfferSDPEventInMultipleHandler)),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.OfferSDPEvent,this._offerSDPEventInMultipleHandler.handleEvent.bind(this._offerSDPEventInMultipleHandler)),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.RejectOfferSDPEvent,u.Providers.Call.RejectOfferSDPEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.SendDTMFEvent,u.Providers.Call.SendDTMFEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.OnAddStreamEvent,u.Providers.Call.OnAddStreamEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.OnAddRemoteTrackEvent,u.Providers.Call.OnAddRemoteTrackEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.OnRemoveRemoteTrackEvent,u.Providers.Call.OnRemoveRemoteTrackEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.EndCallEvent,u.Providers.Call.EndCallEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.DeviceRetrievalFailedEvent,u.Providers.Call.DevicesFailureHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.UpdateRemoteVideoEvent,u.Providers.Call.UpdateRemoteVideoEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.HoldEvent,u.Providers.Call.HoldEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.UnHoldEvent,u.Providers.Call.UnHoldEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.UpdateLocalStreamEvent,u.Providers.Call.UpdateLocalStreamHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.AttendedTransferEvent,u.Providers.Call.AttendedTransferEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.TransferEvent,u.Providers.Call.TransferEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.CallRingingEvent,u.Providers.Call.CallRingingEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.EscalateVideoRejectedEvent,this._offerSDPEventInMultipleHandler.handleEvent.bind(this._offerSDPEventInMultipleHandler)),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.AddParticipantFromExistingCallEvent,u.Providers.Call.AddParticipantFromExistingCallEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.IncomingGenericOfferSDPEvent,u.Providers.Call.IncomingGenericOfferSDPEventInActive),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.CallFailureEvent,u.Providers.Call.CallFailureEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.EscalateVideoOfferEvent,this._escalateVideoOfferEventInActiveRenegotiateHandler.handleEvent.bind(this._escalateVideoOfferEventInActiveRenegotiateHandler)),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.AcceptCallRequestEvent,u.Providers.Call.AcceptCallRequestEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.RejectCallRequestEvent,u.Providers.Call.RejectCallRequestEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.RevertStateEvent,u.Providers.Call.RevertStateEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.UpdateIceRestartMediaEvent,u.Providers.Call.UpdateIceRestartMediaEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.ServiceAvailableEvent,u.Providers.Call.ServiceAvailableEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.UpdatePreferredReceiveResolutionEvent,u.Providers.Call.UpdatePreferredReceiveResolutionEventInMultipleHandler),this._fsm.registerNoOpHandler(u.Providers.Call.States.ACTIVE,u.Providers.Call.CallStateFailureEvent),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.CallEstablishedEvent,u.Providers.Call.CallEstablishedEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.GetOfferSDPEvent,this._getOfferSDPEventInMultipleHandler.handleEvent.bind(this._getOfferSDPEventInMultipleHandler)),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.OfferSDPEvent,this._offerSDPEventInMultipleHandler.handleEvent.bind(this._offerSDPEventInMultipleHandler)),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.RejectOfferSDPEvent,u.Providers.Call.RejectOfferSDPEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.AnswerSDPEvent,u.Providers.Call.AnswerSDPEventInActiveRenegotiateHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.AnswerSdpAckEvent,u.Providers.Call.AnswerSdpAckEventInActiveRenegotiateHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.MuteAudioEvent,u.Providers.Call.MuteAudioEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.UnmuteAudioEvent,u.Providers.Call.UnmuteAudioEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.MuteVideoEvent,u.Providers.Call.MuteVideoEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.UnmuteVideoEvent,u.Providers.Call.UnmuteVideoEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.MuteSpeakerEvent,u.Providers.Call.MuteSpeakerEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.UnmuteSpeakerEvent,u.Providers.Call.UnmuteSpeakerEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.EscalateVideoGetOfferEvent,this._escalateVideoGetOfferEventInActiveRenegotiateHandler.handleEvent.bind(this._escalateVideoGetOfferEventInActiveRenegotiateHandler)),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.EscalateVideoOfferEvent,this._escalateVideoOfferEventInActiveRenegotiateHandler.handleEvent.bind(this._escalateVideoOfferEventInActiveRenegotiateHandler)),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.EscalateVideoAnswerEvent,u.Providers.Call.EscalateVideoAnswerEventInActiveRenegotiateHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.EscalateVideoRejectedEvent,u.Providers.Call.EscalateVideoRejectedEventInActiveRenegotiateHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.RevertStateEvent,u.Providers.Call.RevertStateEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.OnAddStreamEvent,u.Providers.Call.OnAddStreamEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.EndCallEvent,u.Providers.Call.EndCallEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.DeviceRetrievalFailedEvent,u.Providers.Call.DevicesFailureHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.OnAddRemoteTrackEvent,u.Providers.Call.OnAddRemoteTrackEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.OnRemoveRemoteTrackEvent,u.Providers.Call.OnRemoveRemoteTrackEventInActiveHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.CallStateFailureEvent,u.Providers.Call.CallFailureEventInActiveRenegotiateHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.CallFailureEvent,u.Providers.Call.CallFailureEventInActiveRenegotiateHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.IncomingGenericOfferSDPEvent,u.Providers.Call.IncomingGenericOfferSDPEventInActiveRenegotiate),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.AcceptCallRequestEvent,u.Providers.Call.AcceptCallRequestEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.RejectCallRequestEvent,u.Providers.Call.RejectCallRequestEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.UpdateLocalStreamEvent,this._queueUpdateLocalStreamEvent.bind(this)),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.ServiceAvailableEvent,u.Providers.Call.ServiceAvailableEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.UpdateIceRestartMediaEvent,u.Providers.Call.UpdateIceRestartMediaEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ACTIVE_RENEGOTIATE,u.Providers.Call.UpdatePreferredReceiveResolutionEvent,u.Providers.Call.UpdatePreferredReceiveResolutionEventInMultipleHandler),this._fsm.registerHandler(u.Providers.Call.States.ENDING,u.Providers.Call.EndCallEvent,u.Providers.Call.EndCallResponseEventInEndingHandler),this._fsm.registerHandler(u.Providers.Call.States.ENDING,u.Providers.Call.EndCallResponseEvent,u.Providers.Call.EndCallResponseEventInEndingHandler),this._fsm.registerHandler(u.Providers.Call.States.ENDING,u.Providers.Call.CallEstablishedEvent,u.Providers.Call.IncomingCallEstablishedEventInEndingHandler),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.StartCallResponseEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.GetOfferSDPEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.OfferSDPEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.RejectOfferSDPEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.CallRingingEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.AnswerSDPEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.MuteAudioEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.UnmuteAudioEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.MuteVideoEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.UnmuteVideoEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.MuteSpeakerEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.UnmuteSpeakerEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.BlockCameraEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.UnBlockCameraEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.EscalateVideoEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.EscalateNailedUpVideoEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.DeEscalateVideoEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.RevertStateEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.OnAddStreamEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.HoldEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.UnHoldEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.IncomingGenericOfferSDPEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.CallFailureEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.AcceptCallRequestEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.RejectCallRequestEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.CallStateFailureEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.UpdateIceRestartMediaEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.ServiceAvailableEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDING,u.Providers.Call.UpdatePreferredReceiveResolutionEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.EndCallResponseEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.EndCallEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.StartCallResponseEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.GetOfferSDPEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.OfferSDPEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.CallRingingEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.AnswerSDPEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.MuteAudioEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.UnmuteAudioEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.MuteVideoEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.UnmuteVideoEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.MuteSpeakerEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.UnmuteSpeakerEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.UpdateIceRestartMediaEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.ServiceAvailableEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.CallEstablishedEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.BlockCameraEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.UnBlockCameraEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.EscalateVideoEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.EscalateNailedUpVideoEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.DeEscalateVideoEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.RevertStateEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.OnAddStreamEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.HoldEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.UnHoldEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.IncomingGenericOfferSDPEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.CallStateFailureEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.CallFailureEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.AcceptCallRequestEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.RejectCallRequestEvent),this._fsm.registerNoOpHandler(u.Providers.Call.States.ENDED,u.Providers.Call.UpdatePreferredReceiveResolutionEvent),this._fsm.start(u.Providers.Call.States.INITIAL),this._rtConnection&&this._rtConnection.on(u.Base.AbstractRTCConnectionProvider.ObservableRTCEvents.ICE_CONNECTION_STATE_CHANGED,function(e){this._processIceConnectionStateChange(e)}.bind(this)),u.Base.Logger.debug(u.Base.LoggerTags.CALL_PROVIDER,"Initialized CPCall")}(e.prototype={}).prepareEvent=function(e){return e.data||(e.data={}),e.data.cpCall=this,e.data.callProvider=this._callProvider,e},e.prototype.handleEvent=function(e){this.prepareEvent(e),this._fsm.handleEvent(e)},e.prototype.revertFsmState=function(e){var t=new u.Providers.Call.RevertStateEvent;t.data={state:e},this.handleEvent(t)},e.prototype.startCall=function(e,t,i,a,r,s){this._audioDevice=e,this._videoDevice=t,a=a||!1,r=r||!1;var n=new u.Providers.Call.StartCallEvent;n.data={remoteAddress:this.call.getRemoteAddress(),audioDevice:e,videoDevice:t,video:i,videoResolution:this._videoResolution,webCollab:a,uccp:r,nailedUpVideoConnection:s},this.handleEvent(n)},e.prototype.getOfferSDP=function(e,t,i,a,r,s,n,o){var c,l=this.updateIceServers(n);switch(l&&(this._hasLoggedRelayICECandidates=!1),this._prevMediaAction=this._mediaAction,this._mediaAction=e){case u.Providers.Call.CallProvider.Constants.ADD_VIDEO_ACTION:c=new u.Providers.Call.EscalateVideoGetOfferEvent;break;default:c=new u.Providers.Call.GetOfferSDPEvent}var d=this.adjustVideoResolution(e,i,a);r=r||this._audioDevice,s=s||this._videoDevice,c.data={action:e,audioStream:t,videoStreams:i,audioDevice:r,videoDevice:s,videoResolution:d,iceServerChanged:l,restartTurnGathering:o},this.handleEvent(c)},e.prototype.offerSDP=function(e,t,i,a,r,s){var n,o=this.updateIceServers(s);o&&(this._hasLoggedRelayICECandidates=!1);var c={offer:e,action:t,audioStream:i,videoStreams:a,audioDevice:this._callProvider.getMediaServiceFactory().getAudioInterface().getInputInterface().getSelectedDevice(),videoDevice:this._callProvider.getMediaServiceFactory().getVideoInterface().getSelectedDevice(),iceServerChanged:o};switch(this._prevMediaAction=this._mediaAction,this._mediaAction=t,u.Base.Utils.isDefined(this.mediaTransactionDfd)&&this.mediaTransactionDfd.state()!==u.Base.DeferredStates.PENDING&&this.call.getState()===u.Services.Call.CallStates.ESTABLISHED&&this.call._setState(u.Services.Call.CallStates.FAR_END_RENEGOTIATING),t){case u.Providers.Call.CallProvider.Constants.ADD_VIDEO_ACTION:n=0===a.length||!1===a[0].enabled?new u.Providers.Call.OfferSDPEvent(c):new u.Providers.Call.EscalateVideoOfferEvent(c);break;case u.Providers.Call.CallProvider.Constants.INCOMING_ADD_VIDEO_ACTION:case u.Providers.Call.CallProvider.Constants.INCOMING_REMOVE_VIDEO_ACTION:case u.Providers.Call.CallProvider.Constants.INCOMING_HOLD_ACTION:case u.Providers.Call.CallProvider.Constants.INCOMING_UNHOLD_ACTION:case u.Providers.Call.CallProvider.Constants.INCOMING_UPDATE_VIDEO_ACTION:n=new u.Providers.Call.IncomingGenericOfferSDPEvent(c);break;default:n=new u.Providers.Call.OfferSDPEvent(c)}if(0<this.videoStreams.length&&0<a.length){var l=this.getStreamDirection(this.videoStreams[0]),d=this.getStreamDirection(a[0]);l!==u.Services.Call.MediaDirection.INACTIVE&&d===u.Services.Call.MediaDirection.INACTIVE&&this._browserType===u.Base.BrowserType.EDGE?(this.determineIfNailedUpVideoConnectionSupported(a),this.isNailedUpVideoConnectionSupported()?n.data.videoResolution=this.adjustVideoResolution(t,a,r):t===u.Providers.Call.CallProvider.Constants.INCOMING_REMOVE_VIDEO_ACTION?this.callFailure(u.Services.Call.CallError.VIDEO_DEESCALATION_NOT_SUPPORTED,u.Services.Call.CallProtocolType.APPLICATION,501,"Not supported by browser"):this.callFailure(u.Services.Call.CallError.VIDEO_REJECTION_NOT_SUPPORTED,u.Services.Call.CallProtocolType.APPLICATION,501,"Not supported by browser")):n.data.videoResolution=this.adjustVideoResolution(t,a,r)}else if(this.isNailedUpVideoConnectionSupported()&&t===u.Providers.Call.CallProvider.Constants.INCOMING_ADD_VIDEO_ACTION)return u.Base.Logger.info(u.Base.LoggerTags.CALL_PROVIDER,"Reject SDP Offer: "+t),void this.rejectOfferSDP(4880001,"Video escalation prohibited","Add video is not supported");this.handleEvent(n)},e.prototype.callRinging=function(e,t,i,a,r,s,n,o){var c=new u.Providers.Call.CallRingingEvent;c.data={address:e,displayName:t,isAuraAsserted:i,isPrivate:a,alertType:r,earlyMedia:s,audioStream:n,videoStreams:o},this.handleEvent(c)},e.prototype.answerSDP=function(e,t,i,a,r){var s;switch(t){case u.Providers.Call.CallProvider.Constants.ADD_VIDEO_ACTION:s=new u.Providers.Call.EscalateVideoAnswerEvent;break;default:s=new u.Providers.Call.AnswerSDPEvent}s.data={answer:e,action:t,audioStream:i,videoStreams:a,videoBandwidth:r},this.handleEvent(s)},e.prototype.answerSdpAck=function(e,t,i){var a;switch(e){case u.Providers.Call.CallProvider.Constants.ADD_VIDEO_ACTION:a=0===i.length||!1===i[0].enabled?new u.Providers.Call.EscalateVideoRejectedEvent:new u.Providers.Call.AnswerSdpAckEvent;break;default:a=new u.Providers.Call.AnswerSdpAckEvent}a.data={action:e,audioStream:t,videoStreams:i},this.handleEvent(a)},e.prototype.buildCallEstablishedEvent=function(e,t,i,a,r,s,n,o,c,l,d){this._hasReceivedCallEstablishedEvent=!0;var C=new u.Providers.Call.CallEstablishedEvent;return C.data={address:e,displayName:t,audioStream:i,videoStreams:a,isConf:r,isRemote:o},r&&(C.data.uccpUrl=s,C.data.webCollabUrl=n),c&&(C.data.ucid=c,C.data.parentUcid=l,C.data.contextId=d),C},e.prototype.callEstablished=function(e,t,i,a,r,s,n,o,c,l,d){var C=this.buildCallEstablishedEvent(e,t,i,a,r,s,n,o,c,l,d);this.handleEvent(C)},e.prototype.muteAudio=function(){var e=new u.Providers.Call.MuteAudioEvent;this.handleEvent(e)},e.prototype.unmuteAudio=function(){var e=new u.Providers.Call.UnmuteAudioEvent;this.handleEvent(e)},e.prototype.sendMuteUnmuteVideo=function(){switch(this.call._videoMuteState){case u.Services.Call.MediaMuteStates.MUTED:this.muteVideo();break;case u.Services.Call.MediaMuteStates.UNMUTED:this.unmuteVideo()}},e.prototype.muteVideo=function(){if(this.noMediaTransactionDfd=T.Deferred(),this.videoStreams.length){var e=new u.Providers.Call.MuteVideoEvent;this.handleEvent(e)}else this.noMediaTransactionDfd.resolve("Queued").promise();return this.noMediaTransactionDfd.promise()},e.prototype.unmuteVideo=function(){if(this.noMediaTransactionDfd=T.Deferred(),this.videoStreams.length){var e=new u.Providers.Call.UnmuteVideoEvent;this.handleEvent(e)}else this.noMediaTransactionDfd.resolve("Queued").promise();return this.noMediaTransactionDfd.promise()},e.prototype.muteSpeaker=function(){var e=new u.Providers.Call.MuteSpeakerEvent;this.handleEvent(e)},e.prototype.unmuteSpeaker=function(){var e=new u.Providers.Call.UnmuteSpeakerEvent;this.handleEvent(e)},e.prototype.end=function(e){u.Base.Logger.debug(u.Base.LoggerTags.CALL_PROVIDER,"Local call ending: "+e);var t=new u.Providers.Call.EndCallEvent;t.data={remote:!1,denialReason:e},this.handleEvent(t)},e.prototype.callEndedRemotely=function(e){var t=new u.Providers.Call.EndCallEvent;t.data={remote:!0,callReason:e},this.handleEvent(t)},e.prototype.incomingCall=function(){var e=new u.Providers.Call.IncomingCallEvent;this.handleEvent(e)},e.prototype.acceptCall=function(e,t){this._audioDevice=e,this._videoDevice=t;var i=new u.Providers.Call.AcceptCallEvent;i.data={audioDevice:e};var a=this.call.getVideoChannels();0<a.length&&(i.data.videoDevice=t,i.data.videoChannel=a[0],i.data.videoResolution=this.getVideoResolution()),this.handleEvent(i)},e.prototype.acceptSendVideo=function(e,t){this.mediaTransactionDfd=T.Deferred(),this._videoDevice=e;var i=new u.Providers.Call.AcceptSendVideoEvent;i.data={videoChannel:t,videoDevice:e,videoResolution:this.getVideoResolution()},this._mediaTransactionInitialEvent=i;var a=this.mediaTransactionDfd.promise();return this.handleEvent(i),a},e.prototype.denySendVideo=function(){var e=new u.Providers.Call.DenySendVideoEvent;this.handleEvent(e)},e.prototype.callFailed=function(e,t,i){var a=new u.Providers.Call.EndCallEvent;a.data={remote:!1,reason:i},this.handleEvent(a)},e.prototype.callStateFailure=function(e){if(!e||e!==u.Services.Call.CallError.CALL_STATE_MISMATCH||!this.isIceRestartInProgress()&&this.hasIceRecoveryElapsed()){var t=new u.Providers.Call.CallStateFailureEvent;this.handleEvent(t)}else this.triggerCallMediaFailed()},e.prototype.callFailure=function(e,t,i,a){var r={errorCode:e,protocolType:t,protocolErrorCode:i,failureReason:a},s=new u.Providers.Call.CallFailureEvent(r);this.handleEvent(s)},e.prototype.rejectOfferSDP=function(e,t,i){var a={errorCode:e,errorMsg:t,displayMsg:i},r=new u.Providers.Call.RejectOfferSDPEvent(a);this.handleEvent(r)},e.prototype.blockCamera=function(){this.mediaTransactionDfd=T.Deferred();var e=new u.Providers.Call.BlockCameraEvent;return this._mediaTransactionInitialEvent=e,this.handleEvent(e),this.mediaTransactionDfd.promise()},e.prototype.unBlockCamera=function(e){this.mediaTransactionDfd=T.Deferred();var t=new u.Providers.Call.UnBlockCameraEvent;return t.data={videoDevice:e,videoResolution:this.getVideoResolution()},this._mediaTransactionInitialEvent=t,this.handleEvent(t),this.mediaTransactionDfd.promise()},e.prototype.updateRemoteVideo=function(){this.mediaTransactionDfd=T.Deferred();var e=new u.Providers.Call.UpdateRemoteVideoEvent;return this._mediaTransactionInitialEvent=e,this.handleEvent(e),this.mediaTransactionDfd.promise()},e.prototype.setPreferredReceiveResolution=function(t,e){if(this.noMediaTransactionDfd=T.Deferred(),0<this.call.getVideoChannels().filter(function(e){return t===e.getChannelId()}).length){var i,a=new u.Providers.Call.UpdatePreferredReceiveResolutionEvent;i=u.Base.VideoResolution[e].getHeight()>this._videoResolution.getHeight()?this.convertToConfigVideoResolution(this._videoResolution):e,a.data={videoResolution:i},this.handleEvent(a)}else this.noMediaTransactionDfd.reject(new u.Services.Call.CallException(u.Services.Call.CallError.NOT_FOUND));return this.noMediaTransactionDfd.promise()},e.prototype.convertToConfigVideoResolution=function(e){var t;for(var i in u.Base.VideoResolution)u.Base.VideoResolution.hasOwnProperty(i)&&u.Base.VideoResolution[i].getHeight()===e.getHeight()&&(t=i);return t},e.prototype.updateVideoResolution=function(e,t,i){u.Base.Logger.info(u.Base.LoggerTags.CALL_PROVIDER,"Update video resolution: ",i),this.mediaTransactionDfd=T.Deferred();var a=new u.Providers.Call.UpdateLocalStreamEvent,r=!(a.data={audioDevice:e,videoDevice:t,videoResolutionChanged:!0});return i?i.getMinBandwidth()<this._videoResolution.getMinBandwidth()||i.getMinBandwidth()>this._videoResolution.getMinBandwidth()&&i.getMinBandwidth()<this._maxVideoResolution.getMinBandwidth()?(this._updateVideoResolution(i),a.data.videoResolution=i):i.getMinBandwidth()>this._maxVideoResolution.getMinBandwidth()&&this._videoResolution.getMinBandwidth()!==this._maxVideoResolution.getMinBandwidth()?(this._updateVideoResolution(this._maxVideoResolution),a.data.videoResolution=this._maxVideoResolution):r=!0:a.data.videoResolution=this._videoResolution,r?(u.Base.Logger.warn(u.Base.LoggerTags.CALL_PROVIDER,"Failed to update local stream to: "+i.getMinBandwidth()),this.mediaTransactionDfd.reject(new u.Services.Call.CallException(u.Services.Call.CallError.FAILED)).promise()):(this._mediaTransactionInitialEvent=a,this.handleEvent(a),this.mediaTransactionDfd.promise().then(function(){return this._videoResolution}.bind(this)))},e.prototype.updateDevice=function(e,t,i){u.Base.Logger.info(u.Base.LoggerTags.CALL_PROVIDER,"Update to new device: ",i),i._kind===u.Base.MediaTypes.VIDEO_INPUT?this._videoDevice=i:this._audioDevice=i;var a=new u.Providers.Call.UpdateLocalStreamEvent;return a.data={audioDevice:e,videoDevice:t,selectedDevice:i,videoResolution:this._videoResolution,videoResolutionChanged:!1},u.Base.Utils.isDefined(i)?(u.Base.Utils.isUndefined(this.mediaTransactionDfd)&&(this.mediaTransactionDfd=T.Deferred()),this._mediaTransactionInitialEvent=a,this.handleEvent(a),this.mediaTransactionDfd.promise()):(u.Base.Logger.error(u.Base.LoggerTags.CALL_PROVIDER,"No device selected"),T.Deferred().reject(new u.Services.Call.CallException(u.Services.Call.CallError.FAILED)).promise())},e.prototype.escalateVideo=function(e){this.mediaTransactionDfd=T.Deferred();var t=new u.Providers.Call.EscalateVideoEvent;return t.data={videoDevice:e,videoResolution:this.getVideoResolution()},this._mediaTransactionInitialEvent=t,this.handleEvent(t),this.mediaTransactionDfd.promise()},e.prototype.escalateNailedUpVideo=function(){this.mediaTransactionDfd=T.Deferred();var e=new u.Providers.Call.EscalateNailedUpVideoEvent;return this._mediaTransactionInitialEvent=e,this.handleEvent(e),this.mediaTransactionDfd.promise()},e.prototype.deEscalateVideo=function(){this.mediaTransactionDfd=T.Deferred();var e=new u.Providers.Call.DeEscalateVideoEvent;return this._mediaTransactionInitialEvent=e,this.handleEvent(e),this.mediaTransactionDfd.promise()},e.prototype.resolveMediaTransaction=function(e){setTimeout(function(){u.Base.Utils.isDefined(this.mediaTransactionDfd)&&(this.mediaTransactionDfd.resolve(e),this.mediaTransactionDfd=m)}.bind(this),0)},e.prototype.rejectMediaTransaction=function(e){u.Base.Utils.isDefined(this.mediaTransactionDfd)&&(this.mediaTransactionDfd.reject(e),this.mediaTransactionDfd=m)},e.prototype.sendDTMF=function(e){var t=new u.Providers.Call.SendDTMFEvent;t.data={dtmf:e},this.handleEvent(t)},e.prototype.incomingVideoRequestTimedout=function(){var e=new u.Providers.Call.IncomingAddVideoTimedoutEvent;this.handleEvent(e)},e.prototype.deviceRetrievalFailure=function(e){var t=new u.Providers.Call.DeviceRetrievalFailedEvent,i=u.Base.Utils.isDefined(e)?e:u.Services.Call.CallStates.FAILED;t.data={nextState:i},this.handleEvent(t)},e.prototype.hold=function(){this.mediaTransactionDfd=T.Deferred();var e=new u.Providers.Call.HoldEvent;return this._mediaTransactionInitialEvent=e,this.handleEvent(e),this.mediaTransactionDfd.promise()},e.prototype.unhold=function(){this.mediaTransactionDfd=T.Deferred();var e=new u.Providers.Call.UnHoldEvent;return e.data={videoResolution:this.getVideoResolution()},this._mediaTransactionInitialEvent=e,this.handleEvent(e),this.mediaTransactionDfd.promise()},e.prototype.transfer=function(e){this._transferPromise=T.Deferred();var t=new u.Providers.Call.TransferEvent;return t.data={targetRemoteAddress:e},this.handleEvent(t),this._transferPromise.promise()},e.prototype.attendedTransfer=function(e){this._transferPromise=T.Deferred();var t=new u.Providers.Call.AttendedTransferEvent;return t.data={targetCallId:e},this.handleEvent(t),this._transferPromise.promise()},e.prototype.addParticipantFromCall=function(e){var t=new u.Providers.Call.AddParticipantFromExistingCallEvent;t.data={participantCallId:e.getCallId()},this.handleEvent(t)},e.prototype.join=function(e){this._joinRemotePromise=T.Deferred();var t=new u.Providers.Call.JoinRemoteCallEvent;return t.data={audioDevice:e,videoResolution:this._videoResolution},this.handleEvent(t),this._joinRemotePromise.promise()},e.prototype.startRinging=function(){if(this.isRingingStarted())u.Base.Logger.warn("StartRinging request ignored: already started");else{var e=new u.Providers.Call.StartRingingEvent;this.handleEvent(e)}},e.prototype.acceptCallRequest=function(e,t){var i=new u.Providers.Call.AcceptCallRequestEvent;i.data={deferred:e,requestedType:t},this.handleEvent(i)},e.prototype.rejectCallRequest=function(e,t){var i=new u.Providers.Call.RejectAnswerCallRequestEvent;i.data={deferred:e,requestedType:t},this.handleEvent(i)},e.prototype.updateAudioVideoStreamsDirection=function(e,t,i){this.updateAudioStreamDirection(e,i),this.updateVideoStreamsDirection(t,i)},e.prototype.updateAudioStreamDirection=function(e,t){if(e&&this.audioStream){switch(e.direction){case u.Services.Call.MediaDirection.SEND_ONLY:this.audioStream.direction=u.Services.Call.MediaDirection.RECV_ONLY;break;case u.Services.Call.MediaDirection.RECV_ONLY:this.audioStream.direction=u.Services.Call.MediaDirection.SEND_ONLY;break;case u.Services.Call.MediaDirection.SEND_RECV:(this.call.getState()!==u.Services.Call.CallStates.HELD&&this.call.getState()!==u.Services.Call.CallStates.HOLDING||t===u.Providers.Call.CallProvider.Constants.UNHOLD_ACTION)&&(this.audioStream.direction=e.direction);break;default:this.audioStream.direction=e.direction}this.isNailedUpVideoConnectionSupported()&&this._updateAudioStreamLogicalDirection(e,t)}},e.prototype._updateAudioStreamLogicalDirection=function(e,t){if(e)switch(e._logicalDirection){case u.Services.Call.MediaDirection.SEND_ONLY:this.audioStream._logicalDirection=u.Services.Call.MediaDirection.RECV_ONLY;break;case u.Services.Call.MediaDirection.RECV_ONLY:this.audioStream._logicalDirection=u.Services.Call.MediaDirection.SEND_ONLY;break;case u.Services.Call.MediaDirection.SEND_RECV:(this.call.getState()!==u.Services.Call.CallStates.HELD&&this.call.getState()!==u.Services.Call.CallStates.HOLDING||t===u.Providers.Call.CallProvider.Constants.UNHOLD_ACTION)&&(this.audioStream._logicalDirection=e._logicalDirection);break;default:this.audioStream._logicalDirection=e._logicalDirection}},e.prototype.updateVideoStreamsDirection=function(e,t){this._updateVideoStreamsDirection(e,t,this._calculateDirectVideoUpdateDirection.bind(this))},e.prototype.updateVideoStreamsDirectionBasedOnVideoMode=function(e,t){this._latestVideoModeDirection?this._updateVideoStreamsDirection(e,t,this._calculateVideoModeUpdateVideoDirection.bind(this)):this.updateVideoStreamsDirection(e,t)},e.prototype._updateVideoStreamsDirection=function(e,t,i){if(e){for(var a=0;a<this.videoStreams.length;a++)e[a]&&(e[a].enabled?this.isNailedUpVideoConnectionSupported()||this.call.getState()!==u.Services.Call.CallStates.HELD&&this.call.getState()!==u.Services.Call.CallStates.HOLDING||t===u.Providers.Call.CallProvider.Constants.UNHOLD_ACTION?this.videoStreams[a].direction=i.call(this,e[a].direction,this.videoStreams[a].direction,!0,t):this.videoStreams[a].direction=u.Services.Call.MediaDirection.INACTIVE:(this.videoStreams[a].enabled=!1,this.videoStreams[a].direction=u.Services.Call.MediaDirection.INACTIVE));this.isNailedUpVideoConnectionSupported()&&this._updateVideoStreamsLogicalDirection(e,t,i),0<this.videoStreams.length&&this.call.getState()!==u.Services.Call.CallStates.HELD&&this.call.getState()!==u.Services.Call.CallStates.HOLDING&&t!==u.Providers.Call.CallProvider.Constants.HOLD_ACTION&&t!==u.Providers.Call.CallProvider.Constants.UNHOLD_ACTION&&t!==u.Providers.Call.CallProvider.Constants.INCOMING_HOLD_ACTION&&t!==u.Providers.Call.CallProvider.Constants.INCOMING_UNHOLD_ACTION&&(this._latestNonHoldingVideoDirection=this.getStreamDirection(this.videoStreams[0]))}},e.prototype._calculateDirectVideoUpdateDirection=function(e,t,i,a){if(!i)return u.Services.Call.MediaDirection.INACTIVE;switch(e){case u.Services.Call.MediaDirection.SEND_ONLY:return t===u.Services.Call.MediaDirection.SEND_ONLY?u.Services.Call.MediaDirection.INACTIVE:u.Services.Call.MediaDirection.RECV_ONLY;case u.Services.Call.MediaDirection.RECV_ONLY:return t===u.Services.Call.MediaDirection.RECV_ONLY?u.Services.Call.MediaDirection.INACTIVE:u.Services.Call.MediaDirection.SEND_ONLY;case u.Services.Call.MediaDirection.SEND_RECV:return u.Base.Utils.isDefined(a)&&a===u.Providers.Call.CallProvider.Constants.INCOMING_UNHOLD_ACTION?this.call._videoChannels[0]._getInternalRequestedDirection():e;default:return e}},e.prototype._calculateVideoModeUpdateVideoDirection=function(e){switch(e){case u.Services.Call.MediaDirection.SEND_RECV:switch(this._latestVideoModeDirection){case u.Services.Call.MediaDirection.SEND_RECV:return u.Services.Call.MediaDirection.SEND_RECV;case u.Services.Call.MediaDirection.RECV_ONLY:return u.Services.Call.MediaDirection.RECV_ONLY;case u.Services.Call.MediaDirection.SEND_ONLY:return u.Services.Call.MediaDirection.SEND_ONLY;default:return m}break;case u.Services.Call.MediaDirection.RECV_ONLY:switch(this._latestVideoModeDirection){case u.Services.Call.MediaDirection.SEND_RECV:return u.Services.Call.MediaDirection.SEND_ONLY;case u.Services.Call.MediaDirection.RECV_ONLY:return u.Services.Call.MediaDirection.INACTIVE;case u.Services.Call.MediaDirection.SEND_ONLY:return u.Services.Call.MediaDirection.SEND_ONLY;default:return m}break;case u.Services.Call.MediaDirection.SEND_ONLY:switch(this._latestVideoModeDirection){case u.Services.Call.MediaDirection.SEND_RECV:case u.Services.Call.MediaDirection.RECV_ONLY:return u.Services.Call.MediaDirection.RECV_ONLY;case u.Services.Call.MediaDirection.SEND_ONLY:return u.Services.Call.MediaDirection.INACTIVE;default:return m}break;default:return m}},e.prototype._updateVideoStreamsLogicalDirection=function(e,t,i){if(e)for(var a=0;a<this.videoStreams.length;a++)e[a]&&(e[a].enabled?this.call.getState()!==u.Services.Call.CallStates.HELD&&this.call.getState()!==u.Services.Call.CallStates.HOLDING||t===u.Providers.Call.CallProvider.Constants.UNHOLD_ACTION?this.videoStreams[a]._logicalDirection=this.videoStreams[a]._logicalDirection=i.call(this,e[a]._logicalDirection,this.videoStreams[a]._logicalDirection,this.videoStreams[a].enabled,t):this.videoStreams[a]._logicalDirection=u.Services.Call.MediaDirection.INACTIVE:(this.videoStreams[a].enabled=!1,this.videoStreams[a]._logicalDirection=u.Services.Call.MediaDirection.INACTIVE))},e.prototype.getStreamDirection=function(e){var t;return e&&(t=this.isNailedUpVideoConnectionSupported()&&e._logicalDirection||e.direction),t},e.prototype.updateVideoChannelDirection=function(e){this.isNailedUpVideoConnectionSupported()?this._updateVideoChannelLogicalDirection(e,this.getReversedVideoChannelDirection.bind(this)):this._updateVideoChannelDirection(e,this.getReversedVideoChannelDirection.bind(this))},e.prototype.updateVideoChannelDirectionBasedOnVideoMode=function(e){this._latestVideoModeDirection?this.isNailedUpVideoConnectionSupported()?this._updateVideoChannelLogicalDirection(e,this._calculateVideoModeUpdateVideoDirection.bind(this)):this._updateVideoChannelDirection(e,this._calculateVideoModeUpdateVideoDirection.bind(this)):this.updateVideoChannelDirection(e)},e.prototype._updateVideoChannelDirection=function(e,t){if(e)for(var i=this.call.getVideoChannels(),a=0;a<i.length;a++)e[a]&&(e[a].enabled?i[a]._setNegotiatedDirection(t.call(this,e[a].direction)):i[a]._setNegotiatedDirection(u.Services.Call.MediaDirection.DISABLE))},e.prototype._updateVideoChannelLogicalDirection=function(e,t){if(e)for(var i=this.call.getVideoChannels(),a=0;a<i.length;a++)if(e[a])if(e[a].enabled){var r=e[a]._logicalDirection||e[a].direction;i[a]._setNegotiatedDirection(t.call(this,r))}else i[a]._setNegotiatedDirection(u.Services.Call.MediaDirection.DISABLE)},e.prototype.calculateUpdateVideoDirection=function(e){if(e&&0<this.videoStreams.length){var t=this.getStreamDirection(e);return this._calculateVideoModeUpdateVideoDirection(t)}return m},e.prototype.getReversedVideoChannelDirection=function(e){switch(e){case u.Services.Call.MediaDirection.SEND_ONLY:return u.Services.Call.MediaDirection.RECV_ONLY;case u.Services.Call.MediaDirection.RECV_ONLY:return u.Services.Call.MediaDirection.SEND_ONLY;default:return e}},e.prototype.updateAudioChannelDirection=function(e){var t=this.call.getAudioChannel();t&&e&&(e.enabled?t._setNegotiatedDirection(e.direction):t._setNegotiatedDirection(u.Services.Call.MediaDirection.DISABLE))},e.prototype.setAVStreams=function(e,t){this.audioStream=e,this.videoStreams=t},e.prototype.removeLocalVideoTracks=function(){var e=this.call.getVideoChannels();this.localStream&&0<e.length&&(this._callProvider.getMediaServiceFactory().getMediaServicesService().removeLocalVideoTracks(e[0].getChannelId(),this._rtConnection),this.setAVStreams(this.getAudioStream(),[]))},e.prototype.getAudioStream=function(){return this.audioStream},e.prototype.getVideoStreams=function(){return this.videoStreams},e.prototype.stopAllStreams=function(){this._callProvider.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput().stopPlayingAudioStream(this.remoteStream),this._rtConnection&&this._rtConnection.stopAllStreams(),this._callProvider.getMediaServiceFactory().getVideoInterfaceService().removeMediaStreams(this._videoChannelId),this._callProvider.getMediaServiceFactory().getAudioInputInterfaceService().removeLocalMediaStream(this.call.getCallId()),this._callProvider.getMediaServiceFactory().getAudioOutputInterfaceService().removeRemoteMediaStream(this.call.getCallId())},e.prototype.getVideoChannelId=function(){return this._videoChannelId},e.prototype.setVideoChannelId=function(e){this._videoChannelId!==e&&u.Base.Utils.isDefined(this._videoChannelId)&&this._callProvider.getMediaServiceFactory().getVideoInterfaceService().removeMediaStreams(this._videoChannelId),this._videoChannelId=e},e.prototype.updateVideoMode=function(e,t){var i;if(!this._callProvider.hasVideoDevices()&&e!==u.Services.Call.VideoMode.DISABLE)return u.Base.Logger.info(u.Base.LoggerTags.CALL_PROVIDER,"Camera not found"),T.Deferred().reject(new u.Services.Call.CallException(u.Services.Call.CallError.CAMERA_NOT_FOUND));if(0===this.videoStreams.length){var a=u.Providers.Call.Utils.getVideoDirection(e);this.call._videoChannels[0]._setRequestedDirection(a),this._latestVideoModeDirection=a,i=this.escalateVideo(t)}else{if(e===u.Services.Call.VideoMode.INACTIVE)return u.Base.Logger.info(u.Base.LoggerTags.CALL_PROVIDER,"Inactive video mode is not supported"),T.Deferred().reject(new u.Services.Call.CallException(u.Services.Call.CallError.UNHANDLED_VIDEO_DIRECTION)).promise();var r=this._getPreviousVideoDirection(),s=this._setNewVideoDirection(e);switch(this._latestVideoModeDirection=s,this.call._videoChannels[0]._setRequestedDirection(s),e){case u.Services.Call.VideoMode.SEND_RECEIVE:i=r===u.Services.Call.MediaDirection.SEND_ONLY?this.updateRemoteVideo():r===u.Services.Call.MediaDirection.INACTIVE?this.videoStreams[0].enabled||this.isNailedUpVideoConnectionSupported()?(this.videoStreams[0].enabled=!0,this.call.getVideoChannels()[0].isCameraAccessDenied()?this.escalateVideo():this.escalateNailedUpVideo()):(this.removeLocalVideoTracks(),this.escalateVideo()):this.unBlockCamera(t);break;case u.Services.Call.VideoMode.SEND_ONLY:i=r===u.Services.Call.MediaDirection.SEND_RECV?this.updateRemoteVideo():r===u.Services.Call.MediaDirection.RECV_ONLY?(this.videoStreams[0].direction=u.Services.Call.MediaDirection.INACTIVE,this.videoStreams[0]._logicalDirection=u.Services.Call.MediaDirection.INACTIVE,this.updateRemoteVideo()):this.unBlockCamera(t);break;case u.Services.Call.VideoMode.RECEIVE_ONLY:i=r===u.Services.Call.MediaDirection.SEND_ONLY?this.deEscalateVideo():r!==u.Services.Call.MediaDirection.INACTIVE||this._rtConnection.hasVideo(this.localStream)?this.blockCamera():this.escalateVideo(t);break;case u.Services.Call.VideoMode.DISABLE:i=this.deEscalateVideo();break;default:return u.Base.Logger.info(u.Base.LoggerTags.CALL_PROVIDER,"Unsupported video mode: "+e),T.Deferred().reject()}}return i},e.prototype._setNewVideoDirection=function(e){var t=u.Providers.Call.Utils.getVideoDirection(e);return this.videoStreams[0].direction=t,this.isNailedUpVideoConnectionSupported()&&(this.videoStreams[0]._logicalDirection=t),t},e.prototype._getPreviousVideoDirection=function(){return this.isNailedUpVideoConnectionSupported()&&this.videoStreams[0]._logicalDirection||this.videoStreams[0].direction},e.prototype.notifyCallServiceOfMediaChanges=function(){this.isNailedUpVideoConnectionSupported()?this._notifyCallServiceOfLogicalMediaChanges():this._notifyCallServiceOfMediaChanges()},e.prototype._notifyCallServiceOfMediaChanges=function(){for(var e=this.call.getVideoChannels(),t=0;t<this.videoStreams.length;t++){var i=this.videoStreams[t].direction;if(i!==u.Services.Call.MediaDirection.INACTIVE&&i!==u.Services.Call.MediaDirection.DISABLE){if(this.setVideoChannelId(e[t].getChannelId()),this._callProvider.getMediaServiceFactory().getVideoInterfaceService().setRemoteMediaStream(this.call.getVideoChannels()[0].getChannelId(),this.remoteStream),(i===u.Services.Call.MediaDirection.SEND_RECV||i===u.Services.Call.MediaDirection.SEND_ONLY)&&!this.isLocalVideoMuted()){this.enableLocalVideoStreams(i,!0)}e[t]._setNegotiatedDirection(i),this._callProvider.triggerVideoChannelUpdate(this.call,e[t])}else e[t]._setNegotiatedDirection(u.Services.Call.MediaDirection.INACTIVE),e[t]._setVideoDisabledReason(u.Services.Call.VideoChannelDisabledReason.DISABLED_BY_REMOTE_USER),this.disableLocalVideoStreams(),this._callProvider.triggerVideoChannelUpdate(this.call)}},e.prototype._notifyCallServiceOfLogicalMediaChanges=function(){for(var e=this.call.getVideoChannels(),t=0;t<this.videoStreams.length;t++){var i=this.videoStreams[t]._logicalDirection||this.videoStreams[t].direction;i!==u.Services.Call.MediaDirection.INACTIVE&&i!==u.Services.Call.MediaDirection.DISABLE?(this.setVideoChannelId(e[t].getChannelId()),this._callProvider.getMediaServiceFactory().getVideoInterfaceService().setRemoteMediaStream(this.call.getVideoChannels()[0].getChannelId(),this.remoteStream),i!==u.Services.Call.MediaDirection.SEND_RECV&&i!==u.Services.Call.MediaDirection.SEND_ONLY||this.isLocalVideoMuted()||this.enableLocalVideoStreams(i),e[t]._setNegotiatedDirection(i),this._callProvider.triggerVideoChannelUpdate(this.call,e[t])):(e[t]._setNegotiatedDirection(u.Services.Call.MediaDirection.INACTIVE),e[t]._setVideoDisabledReason(u.Services.Call.VideoChannelDisabledReason.DISABLED_BY_REMOTE_USER),this._callProvider.triggerVideoChannelUpdate(this.call))}},e.prototype.transferCompleted=function(){u.Base.Utils.isDefined(this._transferPromise)&&this._transferPromise.resolve()},e.prototype.transferFailed=function(){u.Base.Utils.isDefined(this._transferPromise)&&this._transferPromise.reject()},e.prototype.isFirefoxBrowser=function(){return this._browserType===u.Base.BrowserType.FIREFOX||this._browserType===u.Base.BrowserType.FIREFOX_EXTENSION},e.prototype.getCallStatistics=function(){var t=T.Deferred(),e=!!this.audioStream&&this.audioStream.enabled,i=0!==this.videoStreams.length&&this.videoStreams[0].enabled;return(e||i)&&u.Base.Utils.isDefined(this._rtConnection)&&null!==this._rtConnection&&u.Base.Utils.isDefined(this._rtConnection._pc)?this._rtConnection.getStats().then(function(e){this._logSelectedCandidates(e),this._checkCallStatisticReport(e,t)}.bind(this),function(){t.reject(new u.Services.Call.CallException(u.Services.Call.CallError.STATISTICS_UNAVAILABLE))}):t.reject(new u.Services.Call.CallException(u.Services.Call.CallError.STATISTICS_UNAVAILABLE)),t.promise()},e.prototype._checkCallStatisticReport=function(e,t){e?t.resolve(e):t.reject(new u.Services.Call.CallException(u.Services.Call.CallError.STATISTICS_UNAVAILABLE))},e.prototype._logSelectedCandidates=function(e){if(!this._hasLoggedRelayICECandidates&&e.iceCandidateStatistics)for(var t in e.iceCandidateStatistics)if(e.iceCandidateStatistics.hasOwnProperty(t)){var i=e.iceCandidateStatistics[t].local,a=e.iceCandidateStatistics[t].remote;i&&a&&(this._hasLoggedRelayICECandidates=!0,u.Base.Logger.info(u.Base.LoggerTags.CALL_PROVIDER,"*** Selected local ICE  candidate",i.toString()),u.Base.Logger.info(u.Base.LoggerTags.CALL_PROVIDER,"*** Selected remote ICE candidate",a.toString()))}},e.prototype.stopEarlyMedia=function(e){this._isEarlyMedia&&this.remoteStream&&e.isPlaying(this.remoteStream)&&(this._rtConnection.disableRemoteStreams(),e.stopPlayingAudioStream(this.remoteStream))},e.prototype.getVideoResolution=function(){return this._videoResolution},e.prototype._updateVideoResolution=function(e){this._videoResolution=e,this._callProvider._videoResolution=e},e.prototype.popQueuedActiveRenegotiateEvent=function(){return this._activeRenegotiateEventQueue.shift()},e.prototype.setQueuedActiveRenegotiateEvent=function(e){this._activeRenegotiateEventQueue.push(e)},e.prototype.isReadyToReceiveMediaRequest=function(){return this._isReadyToReceiveMediaRequest},e.prototype.popQueuedRemoteCallEstablishedEvent=function(){var e=this._queuedRemoteCallEstablishedEvent;return this._queuedRemoteCallEstablishedEvent=m,e},e.prototype.setQueuedRemoteCallEstablishedEvent=function(e){this._queuedRemoteCallEstablishedEvent=e},e.prototype.getMediaTransactionInitialEvent=function(){return this._mediaTransactionInitialEvent},e.prototype.setMediaTransactionInitialEvent=function(e){this._mediaTransactionInitialEvent=e},e.prototype.adjustVideoResolution=function(e,t,i){var a=this._callProvider.getMediaServiceFactory().getMediaServicesService().getUserMedia().adjustVideoResolution(i,this._videoResolution)||this._videoResolution;if(t&&t[0]){var r=t[0].maxHeight,s=t[0].maxWidth;s&&r&&(a=this._callProvider.getMediaServiceFactory().getMediaServicesService().getUserMedia().adjustVideoResolutionForDimensions(r,s,a))}return a.getMinBandwidth()<this._maxVideoResolution.getMinBandwidth()&&e!==u.Providers.Call.CallProvider.Constants.UPDATE_VIDEO&&(this._maxVideoResolution=a),a},e.prototype.setCallRequestedTransactionalId=function(e,t){this._3pccRequestTransactionMap[e]=t},e.prototype.getCallRequestedTransactionalId=function(e){return this._3pccRequestTransactionMap[e]},e.prototype.updateIceServers=function(e){var t=!1;if(e){var i=[];e.getTransportTypes().sort(function(e,t){return e.getTransportPrecedence()>t.getTransportPrecedence()?-1:e.getTransportPrecedence()<t.getTransportPrecedence()?1:0}),e.getTransportTypes().forEach(function(e){i.push(e.getUrl())}),t=this._addTurnServers(e.getUsername(),e.getCredential(),i,e.getIceTransportPolicy())}return t},e.prototype.isNailedUpVideoConnectionSupported=function(){return this._isNailedUpVideoConnectionSupported},e.prototype.setNailedUpVideoConnectionSupported=function(e){this._isNailedUpVideoConnectionSupported=e},e.prototype.determineIfNailedUpVideoConnectionSupported=function(e){var t=!!e&&0<e.length&&!!e[0]._logicalDirection;this._isNailedUpVideoConnectionSupported=this._callProvider.isSolutionSupportsNailedUpConnection()&&t},e.prototype.setRingingStarted=function(e){this._isRingingStarted=e},e.prototype.isRingingStarted=function(){return this._isRingingStarted},e.prototype.disableVideoStreamsAndChannels=function(e){0<this.videoStreams.length&&(this.videoStreams[0].enabled=!1,this.isNailedUpVideoConnectionSupported()?this.videoStreams[0]._logicalDirection=u.Services.Call.MediaDirection.INACTIVE:this.videoStreams[0].direction=u.Services.Call.MediaDirection.INACTIVE);var t=this.call.getVideoChannels();0<t.length&&(t[0]._setNegotiatedDirection(u.Services.Call.MediaDirection.DISABLE),t[0]._setVideoDisabledReason(e))},e.prototype._addTurnServers=function(e,t,i,a){return!!(e&&t&&i)&&(this._rtcConfiguration={iceServers:[{username:e,credential:t,credentialType:"password",urls:i}],iceTransportPolicy:a},"relay"!==a&&this.isIceRecoverySupportedConference()&&(this._rtcConfiguration._turnOfferType=this.getIceRestartRelayType()||u.Providers.Call.CallProvider.Constants.ICE_CANDIDATE_TYPE_HOST_ONLY),!0)},e.prototype.resetAudioOnlyNailedUpConnection=function(){return!(!this._callProvider.isSolutionSupportsNailedUpConnection()||!this.hasNailedUpConnectionVideoChannel())&&(this.disableVideoStreamsAndChannels(u.Services.Call.VideoChannelDisabledReason.DISABLED_BY_LOCAL_USER),this.disableLocalVideoStreams(),!0)},e.prototype.hasNailedUpConnectionVideoChannel=function(){return 0<this.call.getVideoChannels().filter(function(e){return e.getChannelId().toString().includes("NailedUp_")}).length},e.prototype._queueUpdateLocalStreamEvent=function(e){this.setQueuedActiveRenegotiateEvent(e)},e.prototype.hasVideoTrackStopStreaming=function(e){return this._rtConnection.hasVideoTrackStopStreaming(e)},e.prototype.disableLocalVideoStreams=function(e){if(this._rtConnection.isSetLocalVideoDirectionSupported()&&this.hasReceivedCallEstablishedEvent()){var t=e||u.Services.Call.MediaDirection.INACTIVE;this._rtConnection.setLocalVideoDirection(t)}else this._rtConnection.disableLocalVideoStreams()},e.prototype.enableLocalVideoStreams=function(e,t){if(0<this.videoStreams.length){if(this._rtConnection.isSetLocalVideoDirectionSupported()&&this.hasReceivedCallEstablishedEvent()){var i=e||u.Services.Call.MediaDirection.SEND_RECV;this._rtConnection.setLocalVideoDirection(i),t&&this.call._videoMuteState===u.Services.Call.MediaMuteStates.UNMUTED&&this.isSendingVideoDirection()&&(this._mediaAction===u.Providers.Call.CallProvider.Constants.UNHOLD_ACTION||this._mediaAction===u.Providers.Call.CallProvider.Constants.UPDATE_VIDEO||this._mediaAction===u.Providers.Call.CallProvider.Constants.ADD_VIDEO_ACTION)&&(this.call._videoMuteState=u.Services.Call.MediaMuteStates.UNDEFINED,this._rtConnection.disableLocalVideoStreams())}this.isLocalVideoMuted()||this._rtConnection.enableLocalVideoStreams()}},e.prototype.isSendingVideoDirection=function(){if(0<this.videoStreams.length){var e=this.getStreamDirection(this.videoStreams[0]);return e===u.Services.Call.MediaDirection.SEND_RECV||e===u.Services.Call.MediaDirection.SEND_ONLY}return!1},e.prototype.muteLocalVideo=function(){this._rtConnection.disableLocalVideoStreams()},e.prototype.unmuteLocalVideo=function(){this._rtConnection.enableLocalVideoStreams()},e.prototype.isLocalVideoMuted=function(){return this.call._videoMuteState===u.Services.Call.MediaMuteStates.MUTED},e.prototype.enableLocalStreams=function(){this.call.isAudioMuted()||this._rtConnection.enableLocalAudioStreams(),this.enableLocalVideoStreams()},e.prototype.disableLocalStreams=function(){this._rtConnection.disableLocalAudioStreams(),this.disableLocalVideoStreams()},e.prototype.queueMuteUnumteFunctor=function(e){this._pendingVideoMuteUnmuteFunctor=e},e.prototype.execQueuedVideoMuteUnmuteFunctor=function(){this._pendingVideoMuteUnmuteFunctor&&this._pendingVideoMuteUnmuteFunctor(this.callId,this.call._sessionId,this.getVideoStreams()),this._pendingVideoMuteUnmuteFunctor=m},e.prototype.hasReceivedCallEstablishedEvent=function(){return this._hasReceivedCallEstablishedEvent},e.prototype.isMPaaSCall=function(){return this.call._isGuestUser&&!!this.call._sessionId},e.prototype.isMPaaSCollabCall=function(){return this._isMPaaSCollabCall},e.prototype.isMPaaSCall=function(){return this.call._isGuestUser&&!!this.call._sessionId},e.prototype.isIceRecoverySupportedBrowser=function(){return this._browserType!==u.Base.BrowserType.EDGE},e.prototype.isIceRecoverySupportedConference=function(){return this.isMPaaSCall()&&this.isIceRecoverySupportedBrowser()},e.prototype.iceConnectionFailedHandler=function(){if(this.isIceRecoverySupportedConference()){var e=!0;if(this._iceRestartAttempts++,u.Base.Utils.isUndefined(this.getIceConnectionRestartTimestamp())?(u.Base.Logger.info(u.Base.LoggerTags.CALL_PROVIDER,">>> Starting ICE media recovery"),this.setIceConnectionRestartTimestamp(Date.now())):this.hasIceRecoveryElapsed()?(e=!1,u.Base.Logger.info(u.Base.LoggerTags.CALL_PROVIDER,">>> ICE recovery has elapsed"),this.triggerCallMediaFailed()):u.Base.Logger.info(u.Base.LoggerTags.CALL_PROVIDER,">>> Continuing ICE media recovery"),e){var t=new u.Providers.Call.UpdateIceRestartMediaEvent;this.handleEvent(t)}}},e.prototype.iceRecoveryCleanup=function(){this.isIceRecoverySupportedConference()&&(u.Base.Logger.info(u.Base.LoggerTags.CALL_PROVIDER,">>> Cleanup ICE media recovery"),this._iceRestartAttempts=0,this.setIceRestartInProgress(!1),this.setIceConnectionRestartTimestamp(m))},e.prototype.hasIceRecoveryElapsed=function(){return!this._iceConnectionRestartTimestamp||3e5<Date.now()-this._iceConnectionRestartTimestamp},e.prototype.setIceConnectionRestartTimestamp=function(e){this.isIceRecoverySupportedConference()&&(this._iceConnectionRestartTimestamp=e)},e.prototype.getIceConnectionRestartTimestamp=function(){return this._iceConnectionRestartTimestamp},e.prototype.setIceRestartRelayType=function(e){this._iceRestartRelayType=e},e.prototype.getIceRestartRelayType=function(){return this._iceRestartRelayType},e.prototype.getIceRestartAttemtps=function(){return this._iceRestartAttempts},e.prototype.setCallServiceAvailable=function(e){if(this._isCallServiceAvailable=e,this._isCallServiceAvailable){var t=new u.Providers.Call.ServiceAvailableEvent;this.handleEvent(t)}},e.prototype.isCallServiceAvailable=function(){return this._isCallServiceAvailable},e.prototype.triggerCallMediaFailed=function(){u.Base.Logger.warn(u.Base.LoggerTags.CALL_PROVIDER,">>> Failed to recovery media"),this.iceRecoveryCleanup(),!this._hasTriggeredMediaFailed&&this.isIceConnectionStateFailed()&&(this._hasTriggeredMediaFailed=!0,this._callProvider.triggerCallMediaFailed(this.call))},e.prototype.isIceConnectionStateFailed=function(){return!!this._rtConnection&&this._rtConnection.getIceConnectionState()===u.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_FAILED},e.prototype.getIceConnectionState=function(){var e;return this._rtConnection&&(e=this._rtConnection.getIceConnectionState()),e},e.prototype.isMediaConnected=function(){return this._isMediaConnected},e.prototype.setIceRestartInProgress=function(e){this._iceRestartInProgress=e},e.prototype.isIceRestartInProgress=function(){return this._iceRestartInProgress},e.prototype._recalculateMediaConnection=function(e){var t=this._isMediaConnected;this._isMediaConnected=e===u.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_COMPLETED||e===u.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_CONNECTED,this._isMediaConnected&&(this._hadMediaConnected=!0),this._isMediaConnected!==t&&this._callProvider.triggerMediaConnectionUpdate(this.call,this._isMediaConnected)},e.prototype._processIceConnectionStateChange=function(e){this._recalculateMediaConnection(e),this._isMediaConnected?this.iceRecoveryCleanup():e===u.Base.AbstractRTCConnectionProvider.Constants.ICE_CONNECTION_STATE_FAILED&&this.iceConnectionFailedHandler()},u.Providers.Call.CPCall=e}(AvayaClientServices),function(u){"use strict";u.Providers.Call.CPUtils={createLocalMediaStream:function(e,t,s,i,a,n,r,o){u.Base.Logger.debug(u.Base.LoggerTags.CALL_PROVIDER,"The video resolution of the localStream has to be changed due to bandwidth management.");var c=T.Deferred(),l=e?e.getDeviceId():m,d=this.getVideoOptions(s.call.getVideoChannels(),t),C=function(){s._rtConnection.stopStream(s.localStream),s._rtConnection.removeStream(s.localStream);var e=function(){i.getMediaServicesService().createLocalMediaStream(s.call.getCallId(),!0,d.enable,l,d.videoDeviceId,d.videoChannelId,a).then(function(e){var t=e.stream;e.videoResolution&&s._updateVideoResolution(e.videoResolution);var i=s.getAudioStream(),r=[];t.getTracks().forEach(function(e){if(e.kind===u.Providers.Call.CallProvider.Constants.VIDEO_TRACK){var t=s.getVideoStreams()[0],i=t?t.direction:u.Services.Call.MediaDirection.INACTIVE,a=new u.Providers.Interfaces.VideoStream(e.id,i);s.isNailedUpVideoConnectionSupported()&&(a._logicalDirection=t._logicalDirection),r.push(a)}}),s.setAVStreams(i,r),s.localStream=t,s._rtConnection.addStream(s.localStream),s.call.isAudioMuted()&&s._rtConnection.disableLocalAudioStreams(),0!==r.length&&s.isLocalVideoMuted()&&s.muteLocalVideo(),n.call(m,s,o),c.resolve(e.videoResolution)},function(e){r.call(m,s,e),c.reject(e)})}.bind(this);u.Base.Utils.getBrowserType()===u.Base.BrowserType.EDGE?setTimeout(function(){e()}.bind(this),500):e()};return d.enable?s._rtConnection.adjustVideoConstraints(a.getWidth(),a.getHeight(),a.getFPS()).then(function(){s._updateVideoResolution(a),n.call(m,s,o),c.resolve(a)},function(){C()}):C(),c.promise()},updateVideoResolutionFirefox:function(e,t,i,a,r,s){u.Base.Logger.debug("The video resolution of the localStream has to be changed due to bandwidth management.");var n=a.localStream.getVideoTracks()[0];n?t.getMediaServicesService().getUserMedia().updateStreamUsingApplyConstraints(n,i,a,e.getDeviceId()).always(function(){r.call(m,a)}):s.call(m,a,"Missing video track")},updateDevices:function(i,a,r,s,e,n,t){var o,c=!1,l=!1,d={videoDeviceId:m,videoChannelId:m};return a&&(c=!0,o=m,d=this.getVideoOptions(r.call.getVideoChannels(),a),r._rtConnection.removeLocalVideoTrack(r.localStream),u.Base.Logger.debug("Changing to new video device: "+a.getLabel())),i&&(l=!0,o=i.getDeviceId(),r._rtConnection.removeLocalAudioTrack(r.localStream),u.Base.Logger.debug("Changing to new audio device: "+i.getLabel())),s.getMediaServicesService().createLocalMediaStream(r.call.getCallId(),l,c,o,d.videoDeviceId,d.videoChannelId,e).then(function(e){var t=e.stream;e.videoResolution&&r._updateVideoResolution(e.videoResolution),t.getTracks().forEach(function(e){r._rtConnection.replaceLocalMediaTrack(e,r.localStream)}),c&&(r._videoDevice=a,s.getVideoInterfaceService().replaceLocalMediaStream(d.videoChannelId,r.localStream),r.isLocalVideoMuted()&&r.muteLocalVideo()),l&&(r._audioDevice=i,s.getAudioInputInterfaceService().replaceLocalMediaStream(r.call.getCallId(),r.localStream),r.call.isAudioMuted()&&r._rtConnection.disableLocalAudioStreams()),n.call(m,r)},function(e){t.call(m,r,e)})},updateVideoResolution:function(a,r,e,s,n,o){var c=this.getVideoOptions(a.call.getVideoChannels(),a._videoDevice);return a._rtConnection.removeLocalVideoTrack(a.localStream),u.Base.Logger.debug("Updating video resolution: "+e.getWidth()+"x"+e.getHeight()),r.getMediaServicesService().createLocalMediaStream(a.call.getCallId(),!1,!0,m,c.videoDeviceId,c.videoChannelId,e).then(function(e){var t=e.stream;e.videoResolution&&a._updateVideoResolution(e.videoResolution);var i=[];t.getTracks().forEach(function(e){i.push(a._rtConnection.replaceLocalMediaTrack(e,a.localStream)),r.getVideoInterfaceService().replaceLocalMediaStream(c.videoChannelId,a.localStream)}),T.when.apply(this,i).then(function(){a.isLocalVideoMuted()&&a.muteLocalVideo(),s.call(m,a,o)},function(e){n.call(m,a,e)})}.bind(this),function(e){n.call(m,a,e)})},getVideoOptions:function(e,t){var i,a,r=!1;if(u.Base.Utils.isDefined(e))for(var s=0;s<e.length;s++)e[s]._getInternalRequestedDirection()!==u.Services.Call.MediaDirection.INACTIVE&&e[s].getNegotiatedDirection()!==u.Services.Call.MediaDirection.DISABLE&&(r=!0,i=e[s].getChannelId(),t&&(a=t.getDeviceId()));return{enable:r,videoChannelId:i,videoDeviceId:a}}}}(AvayaClientServices),function(i){"use strict";i.Providers.Call.CallFsmEvent=function(e,t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e,t),this.data=t}}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Call.CallFsmEventData=function(){this.cpCall=m,this.callProvider=m}}(),function(e){"use strict";function t(){e.Providers.Call.CallFsmEvent.call(this),this.audioDevice=m,this.videoDevice=m}t.prototype={},e.Providers.Call.UpdateLocalStreamEventData=t}(AvayaClientServices),function(e){"use strict";function t(){this.event=m}t.prototype={handleEvent:function(e){throw new Error("Cannot call abstract method")}},e.Providers.Call.AbstractEventHandler=t}(AvayaClientServices),function(h){"use strict";h.Providers.Call.AcceptCallEventInInitialHandler=function(e){var t,i,c=e.data.cpCall,l=e.data.callProvider,d=c._callGatewayProvider,C=e.data.videoChannel,u=!1,v=!1,a=e.data.audioDevice?e.data.audioDevice.getDeviceId():m,r=e.data.videoResolution||c.getVideoResolution();l.hasVideoDevices()&&h.Base.Utils.isDefined(C)&&C._getInternalRequestedDirection()!==h.Services.Call.MediaDirection.INACTIVE&&(u=!0,i=C.getChannelId(),e.data.videoDevice&&(t=e.data.videoDevice.getDeviceId())),c.isNailedUpVideoConnectionSupported()&&!h.Base.Utils.isDefined(C)&&(v=u=!0,t=e.data.videoDevice?e.data.videoDevice.getDeviceId():m,(C=l._createVideoChannel_VideoMode(h.Services.Call.VideoMode.DISABLE))._setChannelId("NailedUp_"+C.getChannelId()),i=C.getChannelId(),c.call._videoChannels.push(C)),l.triggerCallEstablishing(c.call);var s=e.data.audioDevice?e.data.audioDevice.toString():"Default Audio",n=e.data.videoDevice?e.data.videoDevice.toString():"Default Camera";return h.Base.Logger.info(h.Base.LoggerTags.CALL_PROVIDER,"Accepting call using",s,n),l.getMediaServiceFactory().getMediaServicesService().createLocalMediaStream(c.call.getCallId(),!0,u,a,t,i,r).then(function(e){var t=e.stream;e.videoResolution&&c._updateVideoResolution(e.videoResolution),h.Base.Logger.debug(h.Base.LoggerTags.CALL_PROVIDER,"getUserMedia success");var i=null,a=null,r=[],s=h.Services.Call.MediaDirection.SEND_RECV;if(t.getTracks().forEach(function(e){if("audio"===e.kind)i=new h.Providers.Interfaces.AudioStream(e.id,h.Services.Call.MediaDirection.SEND_RECV);else if("video"===e.kind){var t;if(v)s=h.Services.Call.MediaDirection.RECV_ONLY,t=h.Services.Call.MediaDirection.INACTIVE;else if(c.incomingCallInfo.videoStreams&&0<c.incomingCallInfo.videoStreams.length){switch(c.incomingCallInfo.videoStreams[0].direction){case h.Services.Call.MediaDirection.SEND_ONLY:s=h.Services.Call.MediaDirection.RECV_ONLY;break;case h.Services.Call.MediaDirection.RECV_ONLY:s=h.Services.Call.MediaDirection.SEND_ONLY;break;default:s=c.incomingCallInfo.videoStreams[0].direction}t=s}a=new h.Providers.Interfaces.VideoStream(e.id,s),c.isNailedUpVideoConnectionSupported()&&(a._logicalDirection=t),r.push(a)}}),null===i)return h.Base.Logger.error(h.Base.LoggerTags.CALL_PROVIDER,"No microphone is available"),void l.trigger(h.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[c.call,h.Services.Call.CallError.MICROPHONE_NOT_FOUND]);if(u&&0===r.length&&c.isNailedUpVideoConnectionSupported()){var n=l.getActiveCallVideoTrack();h.Base.Utils.isDefined(n)&&(t.addTrack(n.clone()),(a=new h.Providers.Interfaces.VideoStream(n.id,s))._logicalDirection=c.getReversedVideoChannelDirection(c.incomingCallInfo.videoStreams[0]._logicalDirection),r.push(a))}(!u||0===r.length)&&C&&c.incomingCallInfo.videoStreams&&0<c.incomingCallInfo.videoStreams.length&&c.incomingCallInfo.videoStreams[0].enabled&&(e.cameraAccessDenied&&c.call.getVideoChannels()[0]._setCameraAccessIsDenied(e.cameraDenialReason),s=c.incomingCallInfo.videoStreams[0].direction===h.Services.Call.MediaDirection.INACTIVE||c.incomingCallInfo.videoStreams[0].direction===h.Services.Call.MediaDirection.RECV_ONLY?h.Services.Call.MediaDirection.INACTIVE:h.Services.Call.MediaDirection.RECV_ONLY,a=new h.Providers.Interfaces.VideoStream(1,s),c.isNailedUpVideoConnectionSupported()&&(a._logicalDirection=v?h.Services.Call.MediaDirection.INACTIVE:s),r.push(a)),c.setAVStreams(i,r),c.localStream=t;var o=c._rtConnection;o&&(c.updateIceServers(c.incomingCallInfo.turnData)&&o.updatePeerConfiguration(c._rtcConfiguration),o.addStream(c.localStream),o.disableLocalStreams(),o.onAddStream=function(e){c.handleEvent(new h.Providers.Call.OnAddStreamEvent({newStream:e}))},o.createAnswer(c.incomingCallInfo.sdp,function(e){0<r.length&&!h.Base.SDPUtil.hasH264(e.sdp)&&c.isFirefoxBrowser()&&(h.Base.Logger.warn(">>> H.264 video codec plugin must be installed to get video. <<<"),c.disableVideoStreamsAndChannels(h.Services.Call.VideoChannelDisabledReason.DISABLED_DUE_TO_MISSING_H264_PLUGIN)),d.acceptCall(c.callId,e.type,e.sdp,c.getAudioStream(),c.getVideoStreams()).fail(function(e){h.Base.Logger.error(h.Base.LoggerTags.CALL_PROVIDER,"Failed to send accept call",e),l.trigger(h.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[c.call,h.Services.Call.CallError.SEND_ERROR])})},function(e){h.Base.Utils.isDefined(e.errorCode)?(h.Base.Logger.error(h.Base.LoggerTags.CALL_PROVIDER,"Error while creating answer",e.errorMsg),l.trigger(h.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[c.call,e.errorCode,e.protocolType,e.protocolErrorCode,e.errorMsg])):(h.Base.Logger.error(h.Base.LoggerTags.CALL_PROVIDER,"Error while creating answer",e),l.trigger(h.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[c.call,h.Services.Call.CallError.INTERNAL_ERROR]))},function(e){return e=0<r.length&&r[0].enabled?h.Providers.Call.Utils.updateVideoSdp(r[0],e):h.Base.SDPUtil.rejectMedia(e,"m=video")}))},function(e){var t="Error while retrieving local stream: "+JSON.stringify(e);h.Base.Logger.error(h.Base.LoggerTags.CALL_PROVIDER,t),e.getError&&e.getError()?c.callFailure(e.getError()):l.trigger(h.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[c.call,h.Services.Call.CallError.MEDIA_CREATION_FAILURE])}),{nextState:h.Providers.Call.States.ALERTING}}}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Call.AcceptCallRequestEventInMultipleHandler=function(e){var t=e.data.cpCall,i=t._callGatewayProvider,a=e.data.deferred;i.acceptCallRequest(t.callId,t.getCallRequestedTransactionalId(e.data.requestedType),e.data.action).done(function(){a.resolve()},function(e){a.reject(e)})}}(),function(d){"use strict";d.Providers.Call.AcceptSendVideoEventInActiveHandler=function(e){var i=e.data.cpCall,t=e.data.callProvider,a=i._callGatewayProvider,r=i.call.getVideoChannels(),s=i.getVideoStreams();if(clearTimeout(i.incomingVideoRequestTimer),t.isVideoConfigurationEnabled()&&t.hasVideoDevices()){var n,o=r[0].getChannelId();d.Base.Utils.isDefined(e.data.videoDevice)&&(n=e.data.videoDevice.getDeviceId()),0===(s=i.getVideoStreams()).length&&(s.push(new d.Providers.Interfaces.VideoStream(0,d.Services.Call.MediaDirection.RECV_ONLY)),0!==r.length&&r[0]._setNegotiatedDirection(d.Services.Call.MediaDirection.RECV_ONLY));var c=function(){var e=i.incomingCallInfo;s=i.getVideoStreams(),i.updateIceServers(e.turnData)&&i._rtConnection.updatePeerConfiguration(i._rtcConfiguration),s[0].direction!==d.Services.Call.MediaDirection.SEND_ONLY&&s[0].direction!==d.Services.Call.MediaDirection.DISABLE&&(s[0].direction=d.Services.Call.MediaDirection.SEND_RECV,i.isNailedUpVideoConnectionSupported()&&(s[0]._logicalDirection=d.Services.Call.MediaDirection.SEND_RECV)),i._latestVideoModeDirection=s[0].direction,i.isLocalVideoMuted()&&i.muteLocalVideo(),a.updateVideo(i.callId,i.getAudioStream(),i.getVideoStreams()).then(function(){i.notifyCallServiceOfMediaChanges()},function(e){d.Base.Logger.error(d.Base.LoggerTags.CALL_PROVIDER,"Failed to update remote video: "+e),i.rejectMediaTransaction(new d.Services.Call.CallException(d.Services.Call.CallError.SEND_ERROR)),i.revertFsmState(d.Providers.Call.States.ACTIVE)})}.bind(this);if(i.isNailedUpVideoConnectionSupported())c();else{var l=i.localStream.getVideoTracks();0<l.length&&(l[0].stop(),i.localStream.removeTrack(l[0])),t.getMediaServiceFactory().getMediaServicesService().addVideoTracksToLocalStream(n,o,i.localStream,e.data.videoResolution,i._rtConnection).then(function(){d.Base.Logger.debug(d.Base.LoggerTags.CALL_PROVIDER,"getUserMedia success"),c()},function(e){d.Base.Logger.error(d.Base.LoggerTags.CALL_PROVIDER,"Failed to add video to local media stream: ",e);var t=d.Services.Call.CallError.MEDIA_CREATION_FAILURE;e.getError()===d.Services.Call.CallError.CAMERA_PERMISSION_DENIED&&(t=d.Services.Call.CallError.CAMERA_PERMISSION_DENIED),i.rejectMediaTransaction(new d.Services.Call.CallException(t)),i.revertFsmState(d.Providers.Call.States.ACTIVE)})}return{nextState:d.Providers.Call.States.ACTIVE_RENEGOTIATE}}d.Base.Logger.error(d.Base.LoggerTags.CALL_PROVIDER,"Failed to accept send video - no video configured"),i.rejectMediaTransaction(new d.Services.Call.CallException(d.Services.Call.CallError.VIDEO_DENIED))}}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Call.AddParticipantFromExistingCallEventInActiveHandler=function(t){var i=t.data.cpCall,a=t.data.callProvider;i._callGatewayProvider.addParticipantFromCall(i.callId,t.data.participantCallId,i.getAudioStream(),i.getVideoStreams()).then(function(){},function(e){a._updateConsultConferenceStatusHandler(t.data.participantCallId,"ERROR: "+e.errorMsg,i.callId)})}}(),function(u){"use strict";u.Providers.Call.AnswerSdpAckEventInActiveRenegotiateHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider,a=t.getVideoStreams(),r=e.data.videoStreams,s=e.data.audioStream,n=t.call.getVideoChannels(),o=r&&0<r.length?t.getStreamDirection(r[0]):m,c=t.getStreamDirection(s);if(o!==u.Services.Call.MediaDirection.INACTIVE&&t._rtConnection.enableRemoteVideoStreams(),c!==u.Services.Call.MediaDirection.INACTIVE&&t._rtConnection.enableRemoteAudioStream(),t.call.isAudioMuted()||e.data.action===u.Providers.Call.CallProvider.Constants.HOLD||t._rtConnection.enableLocalAudioStreams(),e.data.action===u.Providers.Call.CallProvider.Constants.REMOVE_VIDEO)t.isNailedUpVideoConnectionSupported()||t.removeLocalVideoTracks(),(o===u.Services.Call.MediaDirection.INACTIVE||r&&0<r.length&&r[0].state===u.Providers.Call.CallProvider.Constants.DISABLE_STATE)&&(0<n.length&&(n[0]._setNegotiatedDirection(u.Services.Call.MediaDirection.INACTIVE),n[0]._setVideoDisabledReason(u.Services.Call.VideoChannelDisabledReason.DISABLED_BY_LOCAL_USER)),i.triggerVideoChannelUpdate(t.call));else{t.updateVideoStreamsDirection(r,e.data.action),t.updateVideoChannelDirection(r);for(var l=0;l<a.length;l++){var d=t.getStreamDirection(a[l]);if(d===u.Services.Call.MediaDirection.INACTIVE||d===u.Services.Call.MediaDirection.DISABLE)n[l]._setNegotiatedDirection(d),n[l]._setVideoDisabledReason(u.Services.Call.VideoChannelDisabledReason.DISABLED_BY_LOCAL_USER),i.triggerVideoChannelUpdate(t.call);else{t.setVideoChannelId(n[l].getChannelId());var C=n[l].getNegotiatedDirection();e.data.action===u.Providers.Call.CallProvider.Constants.ADD_VIDEO_ACTION&&C!==u.Services.Call.MediaDirection.SEND_RECV&&C!==u.Services.Call.MediaDirection.SEND_ONLY?t.isNailedUpVideoConnectionSupported()||t.removeLocalVideoTracks():C!==u.Services.Call.MediaDirection.SEND_RECV&&C!==u.Services.Call.MediaDirection.SEND_ONLY||e.data.action===u.Providers.Call.CallProvider.Constants.HOLD?C!==u.Services.Call.MediaDirection.RECV_ONLY&&C!==u.Services.Call.MediaDirection.INACTIVE||t.disableLocalVideoStreams(C):t.enableLocalVideoStreams(C),t._rtConnection.hasVideo(t.remoteStream)?i.getMediaServiceFactory().getVideoInterfaceService().setRemoteMediaStream(n[l].getChannelId(),t.remoteStream):i.getMediaServiceFactory().getVideoInterfaceService().removeRemoteMediaStream(n[l].getChannelId()),i.triggerVideoChannelUpdate(t.call)}break}}return t.resolveMediaTransaction(),{nextState:u.Providers.Call.States.ACTIVE,nextEvent:t.popQueuedActiveRenegotiateEvent()}}}(AvayaClientServices),function(n){"use strict";n.Providers.Call.AnswerSDPEventInActiveRenegotiateHandler=function(i){var a=i.data.cpCall,r=i.data.callProvider,s=a._rtConnection;return a.updateAudioVideoStreamsDirection(i.data.audioStream,i.data.videoStreams,i.data.action),n.Base.Logger.debug(n.Base.LoggerTags.CALL_PROVIDER,"Answer SDP received =>\n "+i.data.answer),s.receiveAnswer(i.data.answer,function(){if(a.notifyCallServiceOfMediaChanges(),i.data.action===n.Providers.Call.CallProvider.Constants.REMOVE_VIDEO)a.removeLocalVideoTracks(),r.triggerVideoChannelUpdate(a.call);else if(0<i.data.videoStreams.length&&i.data.videoStreams[0].maxHeight!==a._videoResolution._height){var e,t=r.getMediaServiceFactory().getVideoInterface().getSelectedDevice();t&&(e=t.getDeviceId()),s.adjustVideoConstraints(i.data.videoStreams[0].maxWidth,i.data.videoStreams[0].maxHeight,i.data.videoStreams[0].maxFrames,e).then(function(){var e=Object.keys(n.Base.VideoResolution).filter(function(e){return n.Base.VideoResolution[e].getHeight()===i.data.videoStreams[0].maxHeight})[0];e&&a._updateVideoResolution(n.Base.VideoResolution[e])})}a.resolveMediaTransaction()},function(e){n.Base.Logger.error(n.Base.LoggerTags.CALL_PROVIDER,"Error receiving answer SDP: "+e),a.rejectMediaTransaction(new n.Services.Call.CallException(n.Services.Call.CallError.INTERNAL_ERROR))}),{nextState:n.Providers.Call.States.ACTIVE,nextEvent:a.popQueuedActiveRenegotiateEvent()}}}(AvayaClientServices),function(c){"use strict";c.Providers.Call.AnswerSDPEventInMultipleHandler=function(i){var a=i.data.cpCall,r=i.data.callProvider,s=a._callGatewayProvider,n=a._rtConnection;c.Base.Logger.debug(c.Base.LoggerTags.CALL_PROVIDER,"Answer SDP received =>\n "+i.data.answer);var e=a.getVideoStreams();if(0<e.length){var t=a.getStreamDirection(e[0]),o=a.getStreamDirection(i.data.videoStreams[0]);if(t!==c.Services.Call.MediaDirection.INACTIVE&&o===c.Services.Call.MediaDirection.INACTIVE&&c.Base.Utils.getBrowserType()===c.Base.BrowserType.EDGE)return void(i.data.action===c.Providers.Call.CallProvider.Constants.INCOMING_REMOVE_VIDEO_ACTION?a.callFailure(c.Services.Call.CallError.VIDEO_DEESCALATION_NOT_SUPPORTED,c.Services.Call.CallProtocolType.APPLICATION,501,"Not supported by browser"):a.callFailure(c.Services.Call.CallError.VIDEO_REJECTION_NOT_SUPPORTED,c.Services.Call.CallProtocolType.APPLICATION,501,"Not supported by browser"))}i.data.audioStream&&!i.data.audioStream.enabled&&n.removeLocalAudioTrack(a.localStream),n.receiveAnswer(i.data.answer,function(){if(s.answerSDPResponse(a.callId,a.getAudioStream(),a.getVideoStreams()),0<i.data.videoStreams.length&&a._videoResolution._height!==i.data.videoStreams[0].maxHeight){var e,t=r.getMediaServiceFactory().getVideoInterface().getSelectedDevice();t&&(e=t.getDeviceId()),n.adjustVideoConstraints(i.data.videoStreams[0].maxWidth,i.data.videoStreams[0].maxHeight,i.data.videoStreams[0].maxFrames,e).then(function(){var e=Object.keys(c.Base.VideoResolution).filter(function(e){return c.Base.VideoResolution[e].getHeight()===i.data.videoStreams[0].maxHeight})[0];e&&a._updateVideoResolution(c.Base.VideoResolution[e])})}},function(e){c.Base.Logger.error(c.Base.LoggerTags.CALL_PROVIDER,"Error receiving answer SDP: "+e)})}}(AvayaClientServices),function(i){"use strict";i.Providers.Call.AttendedTransferEventInActiveHandler=function(e){var t=e.data.cpCall;t._callGatewayProvider.attendedTransfer(t.callId,e.data.targetCallId,t.getAudioStream(),t.getVideoStreams()).then(function(){},function(e){t._transferPromise.reject(new i.Services.Call.CallException(e.errorCode,e.protocolType,e.protocolErrorCode,e.errorMsg))})}}(AvayaClientServices),function(a){"use strict";a.Providers.Call.BlockCameraEventInActiveHandler=function(e){var t=e.data.cpCall,i=t._callGatewayProvider;return t.disableLocalVideoStreams(a.Services.Call.MediaDirection.RECV_ONLY),i.blockUnBlockCamera(t.callId,t.getAudioStream(),t.getVideoStreams()).then(function(){},function(e){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to block camera: "+e),t.rejectMediaTransaction(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR)),t.revertFsmState(a.Providers.Call.States.ACTIVE)}),{nextState:a.Providers.Call.States.ACTIVE_RENEGOTIATE}}}(AvayaClientServices),function(d){"use strict";d.Providers.Call.CallEstablishedEventInMultipleHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider;t.remoteStream&&t._rtConnection.enableRemoteStreams(),t.updateAudioStreamDirection(e.data.audioStream),t.updateAudioChannelDirection(t.getAudioStream()),t.execQueuedVideoMuteUnmuteFunctor(),t.call.isAudioMuted()||t.call.getAudioChannel().getRequestedDirection()===d.Services.Call.MediaDirection.DISABLE||t.call.getState()===d.Services.Call.CallStates.HELD||t._rtConnection.enableLocalAudioStreams();var a=t.getVideoStreams(),r=e.data.videoStreams,s=t.call.getVideoChannels();if(r&&0<r.length){t.updateVideoChannelDirectionBasedOnVideoMode(r),t.updateVideoStreamsDirectionBasedOnVideoMode(r);for(var n=0;n<s.length&&n<a.length;n++){var o=t.getStreamDirection(a[n]);if(!d.Services.Call.MediaDirection._isDisabled(o)){t.setVideoChannelId(s[n].getChannelId());var c=t.getStreamDirection(r[n]);d.Services.Call.MediaDirection._isDisabled(c)||!r[n].enabled?d.Base.Utils.getBrowserType()!==d.Base.BrowserType.EDGE&&t.removeLocalVideoTracks():(o!==d.Services.Call.MediaDirection.SEND_RECV&&o!==d.Services.Call.MediaDirection.SEND_ONLY||t.call.getState()===d.Services.Call.CallStates.HELD||t.enableLocalVideoStreams(),t._rtConnection.hasVideo(t.remoteStream)&&i.getMediaServiceFactory().getVideoInterfaceService().setRemoteMediaStream(s[n].getChannelId(),t.remoteStream)),i.triggerVideoChannelUpdate(t.call,s[n]);break}}}var l=i.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput();return t.remoteStream&&!l.playAudioStream(t.remoteStream,t.call.isSpeakerMuted())&&d.Base.Logger.info(d.Base.LoggerTags.CALL_PROVIDER,"No Audio Tracks Found. Could not play remote audio."),d.Providers.Call.Utils.updateAndTriggerRemoteAddressChangedIfNeeded(i,t.call,e.data.address,e.data.displayName),i.triggerCallEstablished(t.call,e.data.isConf,e.data.uccpUrl,e.data.webCollabUrl,e.data.isRemote,e.data.ucid,e.data.parentUcid,e.data.contextId),{nextState:d.Providers.Call.States.ACTIVE}}}(AvayaClientServices),function(o){"use strict";o.Providers.Call.CallFailureEventInActiveRenegotiateHandler=function(e){var t=e.data.cpCall,i=t.getAudioStream(),a=t.getVideoStreams();if(t.getMediaTransactionInitialEvent())switch(t.getMediaTransactionInitialEvent().stringValue){case o.Providers.Call.EscalateVideoEvent.stringValue:t.removeLocalVideoTracks();break;case o.Providers.Call.DeEscalateVideoEvent.stringValue:case o.Providers.Call.BlockCameraEvent.stringValue:t.enableLocalVideoStreams();break;case o.Providers.Call.UnBlockCameraEvent.stringValue:t.disableLocalVideoStreams();break;case o.Providers.Call.HoldEvent.stringValue:t.enableLocalStreams(),i.direction=o.Services.Call.MediaDirection.SEND_RECV;for(var r=0;r<a.length;r++)t.call.getVideoChannels()[r]&&(a[r].direction=t.call.getVideoChannels()[r].getNegotiatedDirection());t.setAVStreams(i,a);break;case o.Providers.Call.UnHoldEvent.stringValue:t.disableLocalStreams(),i.direction=o.Services.Call.MediaDirection.SEND_ONLY;for(var s=0;s<a.length;s++)a[s].direction=o.Services.Call.MediaDirection.INACTIVE}if(e.data.errorCode===o.Services.Call.CallError.MEDIA_PRESERVED&&t&&t.call&&(e.data.callProvider.triggerCallServiceUnavailable(t.call),e.data.callProvider._callsAnalyticsService.sendUnavailableEvent(o.Services.Analytics.AnalyticsErrorCode.MEDIA_PRESERVED_ERROR)),t.mediaTransactionDfd){var n=e.data.errorCode===o.Services.Call.CallError.VIDEO_DENIED?e.data.errorCode:o.Services.Call.CallError.CALL_STATE_MISMATCH;t.rejectMediaTransaction(new o.Services.Call.CallException(n))}return{nextState:o.Providers.Call.States.ACTIVE,nextEvent:t.popQueuedActiveRenegotiateEvent()}}}(AvayaClientServices),function(s){"use strict";s.Providers.Call.CallFailureEventInMultipleHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider;if(5e6===e.data.protocolErrorCode&&-1!==e.data.failureReason.indexOf("415 Media Failed"))if(t._hadMediaConnected)s.Base.Logger.error("Media negotiation failed"),t._processIceConnectionStateChange(t.getIceConnectionState());else{var a="all"===t._rtcConfiguration.iceTransportPolicy,r=0<t._rtcConfiguration.iceServers.length&&0<t._rtcConfiguration.iceServers[0].urls.length;a&&r&&t.getIceRestartRelayType()!==s.Providers.Call.CallProvider.Constants.ICE_CANDIDATE_TYPE_RELAY_ONLY?(s.Base.Logger.info("Initiating ICE restart with relay only"),t.setIceRestartRelayType(s.Providers.Call.CallProvider.Constants.ICE_CANDIDATE_TYPE_RELAY_ONLY),t.iceConnectionFailedHandler()):i.triggerCallFailure(t.callId,e.data.errorCode,e.data.protocolType,e.data.protocolErrorCode,e.data.failureReason)}else i.triggerCallFailure(t.callId,e.data.errorCode,e.data.protocolType,e.data.protocolErrorCode,e.data.failureReason)}}(AvayaClientServices),function(a){"use strict";a.Providers.Call.CallRingingEventInActiveHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider;a.Providers.Call.Utils.updateAndTriggerRemoteAddressChangedIfNeeded(i,t.call,e.data.address,e.data.displayName),t.call._isPrivateCallerID=!!a.Base.Utils.isDefined(e.data.isPrivate)&&e.data.isPrivate,t.call._isAuraAsserted=!!a.Base.Utils.isDefined(e.data.isAuraAsserted)&&e.data.isAuraAsserted,i.triggerCallRinging(t.call,e.data.earlyMedia)}}(AvayaClientServices),function(s){"use strict";s.Providers.Call.CallRingingEventInStartingHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider,a=t._rtConnection,r=i.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput();return s.Providers.Call.Utils.updateAndTriggerRemoteAddressChangedIfNeeded(i,t.call,e.data.address,e.data.displayName),t.call._isPrivateCallerID=!!s.Base.Utils.isDefined(e.data.isPrivate)&&e.data.isPrivate,t.call._isAuraAsserted=!!s.Base.Utils.isDefined(e.data.isAuraAsserted)&&e.data.isAuraAsserted,i.triggerCallRinging(t.call,e.data.earlyMedia),s.Base.Utils.isDefined(e.data.earlyMedia)&&(t._isEarlyMedia=e.data.earlyMedia,t._isEarlyMedia&&t.remoteStream&&!r.isPlaying(t.remoteStream)&&(a.enableRemoteStreams(),t.call.isAudioMuted()||a.enableLocalAudioStreams(),r.playAudioStream(t.remoteStream,t.call.isSpeakerMuted())||s.Base.Logger.info(s.Base.LoggerTags.CALL_PROVIDER,"No Audio Tracks Found. Could not play remote audio."))),{nextState:s.Providers.Call.States.ALERTING}}}(AvayaClientServices),function(o){"use strict";o.Providers.Call.DeEscalateVideoEventInActiveHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider,a=t._callGatewayProvider,r=t.call.getVideoChannels();t.disableLocalVideoStreams();for(var s=t.getVideoStreams(),n=0;n<s.length;n++)t.isNailedUpVideoConnectionSupported()?(s[n].direction=o.Services.Call.MediaDirection.RECV_ONLY,s[n]._logicalDirection=o.Services.Call.MediaDirection.INACTIVE):s[n].direction=o.Services.Call.MediaDirection.INACTIVE,s[n].enabled=!1,i.triggerVideoChannelUpdate(t.call,r[n]);return a.deEscalateVideo(t.callId,t.getAudioStream(),s).then(function(){},function(e){o.Base.Logger.error(o.Base.LoggerTags.CALL_PROVIDER,"Failed to deescalate video: "+e),t.rejectMediaTransaction(new o.Services.Call.CallException(o.Services.Call.CallError.SEND_ERROR)),t.revertFsmState(o.Providers.Call.States.ACTIVE)}),{nextState:o.Providers.Call.States.ACTIVE_RENEGOTIATE}}}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Call.DenySendVideoEventInActiveHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider,a=t.getVideoStreams();0<a.length&&(t._latestVideoModeDirection=a[0].direction,t._latestNonHoldingVideoDirection=a[0].direction),clearTimeout(t.incomingVideoRequestTimer),i.triggerIncomingAddVideoDenied(t.call)}}(),function(r){"use strict";r.Providers.Call.DevicesFailureHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider,a=e.data.callError||r.Services.Call.CallError.DEVICES_NOT_FOUND;return i.trigger(r.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[t.call,a]),{nextState:e.data.nextState}}}(AvayaClientServices),function(r){"use strict";r.Providers.Call.EndCallEventInMultipleHandler=function(e){var t=e.data.cpCall,i=t._callGatewayProvider,a=new r.Providers.Call.EndCallResponseEvent;return a.data={},t.stopAllStreams(),t.setVideoChannelId(m),a.data.remote=e.data.remote,a.data.host=e.data.cpCall._callGatewayProvider._host,e.data.remote?(a.data.callReason=e.data.callReason,{nextState:r.Providers.Call.States.ENDING,nextEvent:t.prepareEvent(a)}):(i.endCall(t.callId,e.data.denialReason).then(function(){t.handleEvent(a)},function(e){t.handleEvent(a)}),{nextState:r.Providers.Call.States.ENDING})}}(AvayaClientServices),function(c){"use strict";c.Providers.Call.EndCallResponseEventInEndingHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider,a=t.popQueuedRemoteCallEstablishedEvent();if(t.localStream=null,t.remoteStream=null,t._rtConnection&&(t._rtConnection.close(),t._rtConnection=null),c.Base.Utils.isDefined(t.mediaTransactionDfd)&&"pending"===t.mediaTransactionDfd.state()&&t.mediaTransactionDfd.reject(new c.Services.Call.CallException(c.Services.Call.CallError.ENDED)),i.triggerCallEnded(t.call,e.data.remote,e.data.callReason),i.unRegisterCall(t.call),a){var r=a.data.cpCall,s=r.call;i.callEstablished(s.getCallId(),s.getRemoteAddress(),s.getRemoteDisplayName(),s.getSubject(),a.data.isRemote,s.isCallerIdentityPrivate(),s.getAlertType(),s._isAuraAsserted,r.getAudioStream(),r.getVideoStreams())}var n=t._callGatewayProvider._host,o=t.call._callService._callManager.getAllCalls().filter(function(e){return!!e.getCallId()&&!!i._cpCalls[e.getCallId()]&&i._cpCalls[e.getCallId()]._callGatewayProvider._host===n});return t.call._callCreationInfo&&t.call._callCreationInfo.getAuthorizationToken()!==m&&!o.length&&i.stop(e.data.host),{nextState:c.Providers.Call.States.ENDED}}}(AvayaClientServices),function(a){"use strict";a.Providers.Call.EscalateNailedUpVideoEventInActiveHandler=function(e){var t=e.data.cpCall,i=t._callGatewayProvider;return t.enableLocalVideoStreams(),i.escalateVideo(t.callId,t.getAudioStream(),t.getVideoStreams()).then(function(){},function(e){t.disableLocalVideoStreams(),a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to escalate nailedup video: "+e),t.rejectMediaTransaction(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR)),t.revertFsmState(a.Providers.Call.States.ACTIVE)}),{nextState:a.Providers.Call.States.ACTIVE_RENEGOTIATE}}}(AvayaClientServices),function(a){"use strict";a.Providers.Call.EscalateVideoAnswerEventInActiveRenegotiateHandler=function(e){var i=e.data.cpCall,t=i._rtConnection;return i.updateVideoStreamsDirection(e.data.videoStreams,e.data.action),a.Base.Logger.debug(a.Base.LoggerTags.CALL_PROVIDER,"Answer SDP received =>\n "+e.data.answer),t.receiveAnswer(e.data.answer,function(){var e=i.getVideoStreams();if(0<e.length){var t=i.getStreamDirection(e[0]);t!==a.Services.Call.MediaDirection.SEND_RECV&&t!==a.Services.Call.MediaDirection.SEND_ONLY&&i.removeLocalVideoTracks()}i.notifyCallServiceOfMediaChanges(),i.resolveMediaTransaction(),i.sendMuteUnmuteVideo()},function(e){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Video escalation failed while receiving answer SDP: "+e),i.rejectMediaTransaction(new a.Services.Call.CallException(a.Services.Call.CallError.INTERNAL_ERROR))}),{nextState:a.Providers.Call.States.ACTIVE,nextEvent:i.popQueuedActiveRenegotiateEvent()}}}(AvayaClientServices),function(o){"use strict";o.Providers.Call.EscalateVideoEventInActiveHandler=function(e){var t,a=e.data.cpCall,i=e.data.callProvider,r=a._callGatewayProvider,s=a.call.getVideoChannels(),n=s[0].getChannelId();return o.Base.Utils.isDefined(e.data.videoDevice)&&(t=e.data.videoDevice.getDeviceId()),a.setVideoChannelId(s[0].getChannelId()),i.getMediaServiceFactory().getMediaServicesService().addVideoTracksToLocalStream(t,n,a.localStream,e.data.videoResolution,a._rtConnection).then(function(e){o.Base.Logger.debug(o.Base.LoggerTags.CALL_PROVIDER,"getUserMedia success");var t=a.getAudioStream(),i=[];e.getTracks().forEach(function(e){if(e.kind===o.Providers.Call.CallProvider.Constants.VIDEO_TRACK&&e.readyState===o.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE){var t=s[0]._getInternalRequestedDirection();i.push(new o.Providers.Interfaces.VideoStream(e.id,t))}}),a.setAVStreams(t,i),a.isLocalVideoMuted()&&a.muteLocalVideo(),r.escalateVideo(a.callId,a.getAudioStream(),a.getVideoStreams()).then(function(){},function(e){o.Base.Logger.error(o.Base.LoggerTags.CALL_PROVIDER,"Failed to escalate video: "+e),a.rejectMediaTransaction(new o.Services.Call.CallException(o.Services.Call.CallError.SEND_ERROR)),a.removeLocalVideoTracks(),a.revertFsmState(o.Providers.Call.States.ACTIVE)})},function(e){o.Base.Logger.error(o.Base.LoggerTags.CALL_PROVIDER,"Failed to get local media streams for call. "+e),e.getError()===o.Services.Call.CallError.CAMERA_PERMISSION_DENIED?(a.rejectMediaTransaction(e),a.revertFsmState(o.Providers.Call.States.ACTIVE)):(s[0]._negotiatedDirection=o.Services.Call.MediaDirection.INACTIVE,a.rejectMediaTransaction(new o.Services.Call.CallException(o.Services.Call.CallError.MEDIA_CREATION_FAILURE)),a.deviceRetrievalFailure(o.Providers.Call.States.ACTIVE))}),{nextState:o.Providers.Call.States.ACTIVE_RENEGOTIATE}}}(AvayaClientServices),function(r){"use strict";function e(){r.Providers.Call.GetOfferSDPEventInMultipleHandler.call(this)}(e.prototype=Object.create(r.Providers.Call.AbstractEventHandler.prototype)).handleEvent=function(e){r.Providers.Call.GetOfferSDPEventInMultipleHandler.prototype.handleEvent.apply(this,[e])},e.prototype.handleError=function(e){var t=this.event.data.cpCall,i=this.event.data.callProvider,a=t.call.getVideoChannels();t.removeLocalVideoTracks(),a[0]._setNegotiatedDirection(r.Services.Call.MediaDirection.DISABLE),a[0]._setVideoDisabledReason(r.Services.Call.VideoChannelDisabledReason.DISABLED_BY_LOCAL_USER),i.triggerVideoChannelUpdate(t.call),t.rejectMediaTransaction(e),t.revertFsmState(r.Providers.Call.States.ACTIVE)},r.Providers.Call.EscalateVideoGetOfferEventInActiveRenegotiateHandler=e}(AvayaClientServices),function(a){"use strict";function e(){a.Providers.Call.OfferSDPEventInMultipleHandler.call(this)}(e.prototype=Object.create(a.Providers.Call.AbstractEventHandler.prototype)).handleEvent=function(e){a.Providers.Call.OfferSDPEventInMultipleHandler.prototype.handleEvent.apply(this,[e])},e.prototype.handleError=function(e){var t=this.event.data.cpCall,i=t.call.getVideoChannels();t.removeLocalVideoTracks(),i[0]._setNegotiatedDirection(a.Services.Call.MediaDirection.DISABLE),i[0]._setVideoDisabledReason(a.Services.Call.VideoChannelDisabledReason.DISABLED_BY_LOCAL_USER),t.rejectMediaTransaction(e),t.revertFsmState(a.Providers.Call.States.ACTIVE)},a.Providers.Call.EscalateVideoOfferEventInActiveRenegotiateHandler=e}(AvayaClientServices),function(r){"use strict";r.Providers.Call.EscalateVideoRejectedEventInActiveRenegotiateHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider,a=t.call.getVideoChannels();return t.removeLocalVideoTracks(),a[0]._setNegotiatedDirection(r.Services.Call.MediaDirection.DISABLE),a[0]._setVideoDisabledReason(r.Services.Call.VideoChannelDisabledReason.DISABLED_BY_REMOTE_USER),i.triggerVideoChannelUpdate(t.call),t._rtConnection.rollbackLocalOfferState(),t.rejectMediaTransaction(new r.Services.Call.CallException(r.Services.Call.CallError.VIDEO_DENIED)),{nextState:r.Providers.Call.States.ACTIVE,nextEvent:t.popQueuedActiveRenegotiateEvent()}}}(AvayaClientServices),function(l){"use strict";function d(){l.Providers.Call.AbstractEventHandler.call(this)}(d.prototype=Object.create(l.Providers.Call.AbstractEventHandler.prototype)).handleEvent=function(e){var t=e.data.cpCall;null!==t.localStream&&t._rtConnection.hasVideo(t.localStream)&&0<t.videoStreams.length&&t.videoStreams[0].enabled&&e.data.videoResolution&&(t._videoResolution.getWidth()>e.data.videoResolution.getWidth()||t._videoResolution.getHeight()>e.data.videoResolution.getHeight())?t._rtConnection.isRTCRtpSenderSupported()?l.Providers.Call.CPUtils.updateVideoResolution(t,e.data.callProvider.getMediaServiceFactory(),e.data.videoResolution,d.prototype.getOffer.bind(this),d.prototype.errorHandler.bind(this),e):l.Providers.Call.CPUtils.createLocalMediaStream(e.data.audioDevice,e.data.videoDevice,t,e.data.callProvider.getMediaServiceFactory(),e.data.videoResolution,d.prototype.getOffer.bind(this),d.prototype.errorHandler.bind(this),e):d.prototype.getOffer.call(this,t,e)},d.prototype.getOffer=function(t,i){var a=i.data.callProvider,r=t._callGatewayProvider,e=t._rtConnection;i.data.iceServerChanged&&t._rtConnection.updatePeerConfiguration(t._rtcConfiguration,i.data.restartTurnGathering),e.onAddStream=function(e){t.handleEvent(new l.Providers.Call.OnAddStreamEvent({newStream:e,action:i.data.action}))};var s,n=t.getVideoStreams(),o=!1;switch(i.data.action){case l.Providers.Call.CallProvider.Constants.INCOMING_HOLD_ACTION:a.triggerRemoteHold(t.call);break;case l.Providers.Call.CallProvider.Constants.INCOMING_UNHOLD_ACTION:a.triggerRemoteUnhold(t.call);break;case l.Providers.Call.CallProvider.Constants.INCOMING_UPDATE_VIDEO_ACTION:if(0<i.data.videoStreams.length)if(i.data.videoStreams[0].direction===l.Services.Call.MediaDirection.SEND_RECV&&t._prevMediaAction===l.Providers.Call.CallProvider.Constants.INCOMING_ADD_VIDEO_ACTION)n[0].direction=l.Services.Call.MediaDirection.RECV_ONLY;else{var c=t.calculateUpdateVideoDirection(i.data.videoStreams[0]);l.Base.Utils.isDefined(c)&&(n[0].direction=c,t._latestNonHoldingVideoDirection=c)}break;case l.Providers.Call.CallProvider.Constants.UPDATE_VIDEO:s=t.getIceConnectionRestartTimestamp(),o=t.isCallServiceAvailable()&&!!s}e.createOffer(function(e){r.offerSDPResponse(t.callId,e,i.data.action,t.getAudioStream(),t.getVideoStreams()).then(function(){t.isIceRestartInProgress()&&t.setIceRestartInProgress(!1),d.prototype.resetFarEndRenegotiateStateIfNeeded.call(this,t)},function(e){l.Base.Logger.error(l.Base.LoggerTags.CALL_PROVIDER,"GetOfferSDPEventInMultipleHandler error while sending offer: "+e),this.handleError(new l.Services.Call.CallException(l.Services.Call.CallError.SEND_ERROR)),d.prototype.resetFarEndRenegotiateStateIfNeeded.call(this,t)}.bind(this))}.bind(this),function(e){l.Base.Utils.isDefined(e.errorCode)?(l.Base.Logger.error(l.Base.LoggerTags.CALL_PROVIDER,"GetOfferSDPEventInMultipleHandler error while creating offer",e.errorMsg),a.trigger(l.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[t.call,e.errorCode,e.protocolType,e.protocolErrorCode,e.errorMsg])):(l.Base.Logger.error(l.Base.LoggerTags.CALL_PROVIDER,"GetOfferSDPEventInMultipleHandler error while creating offer: "+e),this.handleError(new l.Services.Call.CallException(l.Services.Call.CallError.INTERNAL_ERROR))),d.prototype.resetFarEndRenegotiateStateIfNeeded.call(this,t),o&&t.iceConnectionFailedHandler()}.bind(this),function(e){return e=0<n.length?l.Providers.Call.Utils.updateVideoSdp(n[0],e):l.Base.SDPUtil.rejectMedia(e,"m=video"),t.call.getState()===l.Services.Call.CallStates.HOLDING||t.call.getState()===l.Services.Call.CallStates.HELD||t.call.isHeldRemotely()?t.call.getState()!==l.Services.Call.CallStates.HELD&&t.call.getState()!==l.Services.Call.CallStates.HOLDING||(e=l.Providers.Call.Utils.updateAudioSdp(t.getAudioStream(),e)):e=l.Base.SDPUtil.updateAudioSdpSendRecv(e),e},!1,o,s)},d.prototype.handleError=function(e){this.event.data.cpCall.rejectMediaTransaction(e)},d.prototype.errorHandler=function(e){this.handleError(new l.Services.Call.CallException(l.Services.Call.CallError.MEDIA_CREATION_FAILURE)),d.prototype.resetFarEndRenegotiateStateIfNeeded.call(this,e)},d.prototype.resetFarEndRenegotiateStateIfNeeded=function(e){e.call.getState()===l.Services.Call.CallStates.FAR_END_RENEGOTIATING&&e.call._setState(l.Services.Call.CallStates.ESTABLISHED)},l.Providers.Call.GetOfferSDPEventInMultipleHandler=d}(AvayaClientServices),function(n){"use strict";n.Providers.Call.GetOfferSDPEventInStartingHandler=function(e){var t=e.data.cpCall,s=e.data.callProvider;t.setNailedUpVideoConnectionSupported(!1);var i=t.resetAudioOnlyNailedUpConnection();e.data.iceServerChanged&&t._rtConnection.updatePeerConfiguration(t._rtcConfiguration);var a=function(t){var i=t._callGatewayProvider,e=t._rtConnection;e.onAddStream=function(e){t.handleEvent(new n.Providers.Call.OnAddStreamEvent({newStream:e}))};var a=t.getVideoStreams(),r=0<a.length&&t.getStreamDirection(a[0])===n.Services.Call.MediaDirection.RECV_ONLY;e.createOffer(function(e){0<a.length&&!n.Base.SDPUtil.hasH264(e.sdp)&&t.isFirefoxBrowser()&&n.Base.Logger.warn(">>> H.264 video codec plugin is NOT installed <<<"),i.getOfferSDPResponse(t.callId,e,t.getAudioStream(),t.getVideoStreams()).fail(function(e){n.Base.Logger.error(n.Base.LoggerTags.CALL_PROVIDER,"Failed to send get offer response",e),s.trigger(n.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[t.call,n.Services.Call.CallError.SEND_ERROR])})},function(e){n.Base.Utils.isDefined(e.errorCode)?(n.Base.Logger.error(n.Base.LoggerTags.CALL_PROVIDER,"Error while creating offer",e.errorMsg),s.trigger(n.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[t.call,e.errorCode,e.protocolType,e.protocolErrorCode,e.errorMsg])):(n.Base.Logger.error(n.Base.LoggerTags.CALL_PROVIDER,"Error while creating offer",e),s.trigger(n.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[t.call,n.Services.Call.CallError.INTERNAL_ERROR]))},function(e){return 0<a.length&&(e=n.Providers.Call.Utils.updateVideoSdp(a[0],e),a[0].enabled||(e=n.Base.SDPUtil.rejectMedia(e,"m=video"))),e},r)},r=function(e){e.deviceRetrievalFailure(n.Providers.Call.States.ACTIVE)};null!==t.localStream&&t._rtConnection.hasVideo(t.localStream)&&(i||e.data.videoResolution&&e.data.videoResolution.getWidth()!==t._videoResolution.getWidth()&&e.data.videoResolution.getHeight()!==t._videoResolution.getHeight())?t._rtConnection.isRTCRtpSenderSupported()?n.Providers.Call.CPUtils.updateVideoResolution(t,e.data.callProvider.getMediaServiceFactory(),e.data.videoResolution,a,r,e):n.Providers.Call.CPUtils.createLocalMediaStream(e.data.audioDevice,e.data.videoDevice,t,e.data.callProvider.getMediaServiceFactory(),e.data.videoResolution,a,r,e):a(t)}}(AvayaClientServices),function(n){"use strict";n.Providers.Call.HoldEventInActiveHandler=function(e){var t=e.data.cpCall,i=t._callGatewayProvider;t._rtConnection.disableLocalAudioStreams(),t.disableLocalVideoStreams();var a=t.getAudioStream(),r=t.getVideoStreams();t.isNailedUpVideoConnectionSupported()?a._logicalDirection=n.Services.Call.MediaDirection.SEND_ONLY:a.direction=n.Services.Call.MediaDirection.SEND_ONLY;for(var s=0;s<r.length;s++)t.isNailedUpVideoConnectionSupported()?(r[s].direction=n.Services.Call.MediaDirection.RECV_ONLY,r[s]._logicalDirection=n.Services.Call.MediaDirection.INACTIVE):r[s].direction=n.Services.Call.MediaDirection.INACTIVE;return t.setAVStreams(a,r),i.holdCall(t.callId,t.getAudioStream(),t.getVideoStreams()).then(function(){},function(e){n.Base.Logger.error(n.Base.LoggerTags.CALL_PROVIDER,"Failed to hold: "+e),t.rejectMediaTransaction(new n.Services.Call.CallException(n.Services.Call.CallError.SEND_ERROR)),t.revertFsmState(n.Providers.Call.States.ACTIVE)}),{nextState:n.Providers.Call.States.ACTIVE_RENEGOTIATE}}}(AvayaClientServices),function(l){"use strict";l.Providers.Call.IncomingAddVideoEventInActiveHandler=function(i){var a=i.data.cpCall,r=i.data.callProvider,t=a._callGatewayProvider,e=a._rtConnection,s=r._config.callUserConfiguration.incomingVideoRequestTimeout,n=r.isVideoConfigurationEnabled();l.Base.Utils.isDefined(s)||(s=l.Config.CallUserConfiguration.DefaultValues.INCOMING_VIDEO_REQUEST_TIMEOUT);var o=a.getAudioStream(),c=a.getVideoStreams();n&&(0===c.length?c.push(new l.Providers.Interfaces.VideoStream(0,l.Services.Call.MediaDirection.RECV_ONLY)):(c[0].enabled=i.data.videoStreams[0].enabled,c[0].direction=l.Services.Call.MediaDirection.RECV_ONLY),i.data.videoStreams[0].direction!==l.Services.Call.MediaDirection.SEND_RECV&&i.data.videoStreams[0].direction!==l.Services.Call.MediaDirection.SEND_ONLY&&a.updateVideoStreamsDirection(i.data.videoStreams,i.data.action),a._latestVideoModeDirection=c[0].direction,a._latestNonHoldingVideoDirection=c[0].direction,a.isNailedUpVideoConnectionSupported()&&(c[0]._logicalDirection=c[0].direction,e.enableRemoteVideoStreams()),function(){var e=a.call.getVideoChannels();if(0===e.length){var t=r.createVideoChannel_MediaDirection(a.call,i.data.videoStreams[0].direction);t._setNegotiatedDirection(l.Services.Call.MediaDirection.RECV_ONLY),e.push(t)}else e[0]._setNegotiatedDirection(l.Services.Call.MediaDirection.RECV_ONLY);i.data.videoStreams[0].direction!==l.Services.Call.MediaDirection.SEND_RECV&&i.data.videoStreams[0].direction!==l.Services.Call.MediaDirection.SEND_ONLY&&a.updateVideoChannelDirection(i.data.videoStreams),r.getMediaServiceFactory().getVideoInterfaceService().setRemoteMediaStream(e[0].getChannelId(),a.remoteStream),r.triggerVideoChannelUpdate(a.call)}()),e.createAnswer(i.data.offer,function(e){t.offerSDPResponse(a.callId,e,i.data.action,o,c).then(function(){n&&(a.incomingCallInfo={offer:i.data.offer,audioStream:i.data.audioStream,videoStreams:i.data.videoStreams,action:i.data.action},a.incomingVideoRequestTimer=setTimeout(function(){a.incomingVideoRequestTimedout()},s),r.triggerIncomingAddVideoRequest(a.call))})},function(e){l.Base.Logger.error(l.Base.LoggerTags.CALL_PROVIDER,"IncomingAddVideo error while creating answer: "+e)},function(e){return 0<c.length?l.Providers.Call.Utils.updateVideoSdp(c[0],e):l.Base.SDPUtil.rejectMedia(e,"m=video")})}}(AvayaClientServices),function(a){"use strict";a.Providers.Call.IncomingAddVideoTimedoutEventInActiveHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider;a.Base.Logger.info(a.Base.LoggerTags.CALL_PROVIDER,"Timed out waiting for incoming add video request to be accepted"),i.triggerIncomingAddVideoTimedout(t.call)}}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Call.IncomingCallEstablishedEventInEndingHandler=function(e){var t=e.data.cpCall;e.data.isRemote&&t.setQueuedRemoteCallEstablishedEvent(e)}}(),function(o){"use strict";o.Providers.Call.IncomingGenericOfferSDPEventInActive=function(e){var t,i=e.data.cpCall,a=i.getVideoStreams(),r=i.call.getVideoChannels();switch(e.data.action){case o.Providers.Call.CallProvider.Constants.INCOMING_ADD_VIDEO_ACTION:var s=0===a.length||!1===a[0].enabled||i.isNailedUpVideoConnectionSupported()&&a[0]._logicalDirection===o.Services.Call.MediaDirection.INACTIVE,n=0<r.length&&r[0].getNegotiatedDirection()===o.Services.Call.MediaDirection.DISABLE;t=s||n?new o.Providers.Call.IncomingAddVideoEvent(e.data):(a[0].enabled=!0,i._mediaAction=o.Providers.Call.CallProvider.Constants.INCOMING_UPDATE_VIDEO_ACTION,new o.Providers.Call.OfferSDPEvent(e.data));break;case o.Providers.Call.CallProvider.Constants.INCOMING_REMOVE_VIDEO_ACTION:t=e.data.videoStreams&&e.data.videoStreams[0].enabled?(a[0].enabled=!0,i._mediaAction=o.Providers.Call.CallProvider.Constants.INCOMING_UPDATE_VIDEO_ACTION,new o.Providers.Call.OfferSDPEvent(e.data)):new o.Providers.Call.IncomingRemoveVideoEvent(e.data);break;case o.Providers.Call.CallProvider.Constants.INCOMING_UPDATE_VIDEO_ACTION:s=0===a.length||!1===a[0].enabled||i.isNailedUpVideoConnectionSupported()&&a[0]._logicalDirection===o.Services.Call.MediaDirection.INACTIVE,n=0<r.length&&r[0].getNegotiatedDirection()===o.Services.Call.MediaDirection.DISABLE,t=s||n?(i._mediaAction=o.Providers.Call.CallProvider.Constants.INCOMING_ADD_VIDEO_ACTION,new o.Providers.Call.IncomingAddVideoEvent(e.data)):new o.Providers.Call.OfferSDPEvent(e.data);break;default:t=new o.Providers.Call.OfferSDPEvent(e.data)}return{nextState:m,nextEvent:t}}}(AvayaClientServices),function(i){"use strict";i.Providers.Call.IncomingGenericOfferSDPEventInActiveRenegotiate=function(e){var t=e.data.cpCall;return i.Base.Logger.debug(i.Base.LoggerTags.CALL_PROVIDER,"Received incoming offer event while in ACTIVE_RENEGOTIATE. Queuing for later processing."),t.setQueuedActiveRenegotiateEvent(e),{nextState:m,nextEvent:m}}}(AvayaClientServices),function(o){"use strict";o.Providers.Call.IncomingRemoveVideoEventInActiveHandler=function(t){var i=t.data.cpCall,a=t.data.callProvider,r=i._callGatewayProvider,e=i._rtConnection,s=i.call.getVideoChannels();i.disableLocalVideoStreams(),e.disableRemoteVideoStreams(),i.updateVideoStreamsDirection(t.data.videoStreams,t.data.action),0<s.length&&(i.isNailedUpVideoConnectionSupported()||i.removeLocalVideoTracks(),s[0]._setNegotiatedDirection(o.Services.Call.MediaDirection.DISABLE),s[0]._setVideoDisabledReason(o.Services.Call.VideoChannelDisabledReason.DISABLED_BY_REMOTE_USER)),a.triggerVideoChannelUpdate(i.call);var n=function(){i.call.getState()===o.Services.Call.CallStates.FAR_END_RENEGOTIATING&&i.call._setState(o.Services.Call.CallStates.ESTABLISHED)};e.createAnswer(t.data.offer,function(e){r.offerSDPResponse(i.callId,e,t.data.action,i.getAudioStream(),i.getVideoStreams()).then(function(){n()}.bind(this),function(e){o.Base.Logger.error(o.Base.LoggerTags.CALL_PROVIDER,"Failed to send offer response",e),a.trigger(o.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[i.call,o.Services.Call.CallError.SEND_ERROR]),n()}.bind(this))},function(e){o.Base.Utils.isDefined(e.errorCode)?(o.Base.Logger.error(o.Base.LoggerTags.CALL_PROVIDER,"Error while creating answer",e.errorMsg),a.trigger(o.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[i.call,e.errorCode,e.protocolType,e.protocolErrorCode,e.errorMsg])):(o.Base.Logger.error(o.Base.LoggerTags.CALL_PROVIDER,"Error while creating answer",e),a.trigger(o.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[i.call,o.Services.Call.CallError.INTERNAL_ERROR])),n()})}}(AvayaClientServices),function(l){"use strict";l.Providers.Call.JoinRemoteCallEventInInitialHandler=function(e){var t,s=e.data.cpCall,i=e.data.callProvider,n=s._callGatewayProvider,a=e.data.audioDevice?e.data.audioDevice.getDeviceId():m,r=s._videoDevice?s._videoDevice.getDeviceId():m,o=s.isNailedUpVideoConnectionSupported()&&i.hasVideoDevices()&&i.isVideoAllowed();if(o){var c=i._createVideoChannel_VideoMode(l.Services.Call.VideoMode.DISABLE);c._setInternalRequestedDirection(l.Services.Call.MediaDirection.RECV_ONLY),t="NailedUp_"+c.getChannelId(),c._setChannelId(t),s.call._videoChannels.push(c)}return s._isReadyToReceiveMediaRequest=!0,i.getMediaServiceFactory().getMediaServicesService().createLocalMediaStream(s.call.getCallId(),!0,o,a,r,t,s._videoResolution).then(function(e){var t=e.stream;s.localStream=t,s._rtConnection.addStream(s.localStream),s._rtConnection.disableLocalStreams();var i,a=null,r=[];t.getTracks().forEach(function(e){if("audio"===e.kind)a=new l.Providers.Interfaces.AudioStream(e.id,l.Services.Call.MediaDirection.SEND_RECV);else if("video"===e.kind&&s.isNailedUpVideoConnectionSupported()){var t=new l.Providers.Interfaces.VideoStream(e.id,l.Services.Call.MediaDirection.RECV_ONLY);t._logicalDirection=l.Services.Call.MediaDirection.INACTIVE,r.push(t),i=new l.Providers.Call.NailedUpVideoConnectionInfo(l.Services.Call.MediaDirection.INACTIVE,l.Services.Call.MediaDirection.RECV_ONLY)}}),s.setAVStreams(a,r),n.joinRemoteCall(s.callId,s.getAudioStream(),s.getVideoStreams(),i).then(function(){s._joinRemotePromise.resolve()},function(e){l.Base.Logger.info(l.Base.LoggerTags.CALL_PROVIDER,"Failed to join to remote call: "+s.callId),s._joinRemotePromise.reject(new l.Services.Call.CallException(e.errorCode,e.protocolType,e.protocolErrorCode,e.errorMsg)),s.revertFsmState(l.Providers.Call.States.INITIAL)})},function(e){l.Base.Logger.error(l.Base.LoggerTags.CALL_PROVIDER,"Failed to get local media streams to join remote call. "+e),s._joinRemotePromise.reject(new l.Services.Call.CallException(l.Services.Call.CallError.MEDIA_CREATION_FAILURE)),s.revertFsmState(l.Providers.Call.States.INITIAL),s.handleEvent(new l.Providers.Call.DeviceRetrievalFailedEvent)}),{nextState:l.Providers.Call.States.ACTIVE}}}(AvayaClientServices),function(i){"use strict";i.Providers.Call.MuteAudioEventInMultipleHandler=function(e){var t=e.data.cpCall;t.localStream&&(t._rtConnection.disableLocalAudioStreams(),e.data.callProvider.trigger(i.Providers.Interfaces.CallProviderCallbackIds.AUDIO_STREAM_UPDATED,[t.call,t.localStream]))}}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Call.MuteSpeakerEventInMultipleHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider;t.remoteStream&&i.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput().muteStream(t.remoteStream)}}(),function(a){"use strict";a.Providers.Call.MuteVideoEventInMultipleHandler=function(e){var t=e.data.cpCall,i=t._callGatewayProvider;t.muteLocalVideo(),t.isMPaaSCall()?t.hasReceivedCallEstablishedEvent()?i.muteVideo(t.callId,t.call._sessionId,t.getVideoStreams()).then(function(){t.noMediaTransactionDfd.resolve()},function(e){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to notify server of local video mute state: "+e),t.noMediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR))}):(t.queueMuteUnumteFunctor(function(){i.muteVideo(t.callId,t.call._sessionId,t.getVideoStreams()).fail(function(e){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to notify server of local video mute state: "+e)})}),t.noMediaTransactionDfd.resolve()):t.noMediaTransactionDfd.resolve()}}(AvayaClientServices),function(d){"use strict";function C(){d.Providers.Call.AbstractEventHandler.call(this)}(C.prototype=Object.create(d.Providers.Call.AbstractEventHandler.prototype)).handleEvent=function(e){var t=(this.event=e).data.cpCall,i=e.data.callProvider,a=null!==t.localStream&&t._rtConnection.hasVideo(t.localStream)&&0<t.videoStreams.length&&t.videoStreams[0].enabled;e.data.iceServerChanged&&t._rtConnection.updatePeerConfiguration(t._rtcConfiguration),a&&e.data.videoResolution&&(t._videoResolution.getWidth()>e.data.videoResolution.getWidth()||t._videoResolution.getHeight()>e.data.videoResolution.getHeight())?d.Providers.Call.CPUtils.createLocalMediaStream(e.data.audioDevice,e.data.videoDevice,t,i.getMediaServiceFactory(),e.data.videoResolution,C.prototype.offerSDP.bind(this),C.prototype.errorHandler.bind(this),e):C.prototype.offerSDP.call(this,t,e)},C.prototype.handleError=function(e){d.Base.Utils.isDefined(this.event.data.cpCall.mediaTransactionDfd)&&this.event.data.cpCall.rejectMediaTransaction(e)},C.prototype.errorHandler=function(e){this.handleError(new d.Services.Call.CallException(d.Services.Call.CallError.MEDIA_CREATION_FAILURE)),C.prototype.resetFarEndRenegotiateStateIfNeeded.call(this,e)},C.prototype.resetFarEndRenegotiateStateIfNeeded=function(e){e.call.getState()===d.Services.Call.CallStates.FAR_END_RENEGOTIATING&&e.call._setState(d.Services.Call.CallStates.ESTABLISHED)},C.prototype.offerSDP=function(i,a){var r=a.data.callProvider,s=i._callGatewayProvider,n=i._rtConnection;i.call.getVideoChannels();n.onAddStream=function(e){i.handleEvent(new d.Providers.Call.OnAddStreamEvent({newStream:e,action:a.data.action}))},i.updateAudioVideoStreamsDirection(a.data.audioStream,a.data.videoStreams,a.data.action);var e,t,o=i.getVideoStreams();if(0<o.length&&(a.data.action===d.Providers.Call.CallProvider.Constants.INCOMING_UPDATE_VIDEO_ACTION||(e=i._mediaAction,t=a.data.action,e===d.Providers.Call.CallProvider.Constants.INCOMING_UPDATE_VIDEO_ACTION&&(t===d.Providers.Call.CallProvider.Constants.INCOMING_ADD_VIDEO_ACTION||t===d.Providers.Call.CallProvider.Constants.INCOMING_REMOVE_VIDEO_ACTION)))){var c=i.getStreamDirection(o[0]);if(c===d.Services.Call.MediaDirection.SEND_RECV&&i._prevMediaAction===d.Providers.Call.CallProvider.Constants.INCOMING_ADD_VIDEO_ACTION)c=d.Services.Call.MediaDirection.RECV_ONLY;else if(0<a.data.videoStreams.length){var l=i.calculateUpdateVideoDirection(a.data.videoStreams[0]);d.Base.Utils.isDefined(l)&&(c=l,i._latestNonHoldingVideoDirection=l)}i.isNailedUpVideoConnectionSupported()?o[0]._logicalDirection=c:o[0].direction=c}n.createAnswer(a.data.offer,function(e){switch(a.data.action){case d.Providers.Call.CallProvider.Constants.INCOMING_HOLD_ACTION:i.call.isAudioMuted()||i.audioStream.direction!==d.Services.Call.MediaDirection.RECV_ONLY&&i.audioStream.direction!==d.Services.Call.MediaDirection.INACTIVE||n.disableLocalAudioStreams(),r.triggerRemoteHold(i.call);break;case d.Providers.Call.CallProvider.Constants.INCOMING_UNHOLD_ACTION:i.call.isAudioMuted()||i.audioStream.direction!==d.Services.Call.MediaDirection.SEND_RECV&&i.audioStream.direction!==d.Services.Call.MediaDirection.SEND_ONLY||n.enableLocalAudioStreams(),r.triggerRemoteUnhold(i.call)}if(0<o.length){var t=i.getStreamDirection(o[0]);t!==d.Services.Call.MediaDirection.RECV_ONLY&&t!==d.Services.Call.MediaDirection.INACTIVE||i.disableLocalVideoStreams(t)}i.notifyCallServiceOfMediaChanges(a.data.action),s.offerSDPResponse(i.callId,e,a.data.action,i.getAudioStream(),i.getVideoStreams()).then(function(){C.prototype.resetFarEndRenegotiateStateIfNeeded.call(this,i)}.bind(this),function(e){d.Base.Logger.error(d.Base.LoggerTags.CALL_PROVIDER,"OfferSDPEventInMultipleHandler error while sending answer: "+e),this.handleError(new d.Services.Call.CallException(d.Services.Call.CallError.SEND_ERROR)),C.prototype.resetFarEndRenegotiateStateIfNeeded.call(this,i)}.bind(this))}.bind(this),function(e){d.Base.Utils.isDefined(e.errorCode)?(d.Base.Logger.error(d.Base.LoggerTags.CALL_PROVIDER,"OfferSDPEventInMultipleHandler error while creating answer",e.errorMsg),r.trigger(d.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[i.call,e.errorCode,e.protocolType,e.protocolErrorCode,e.errorMsg])):(d.Base.Logger.error(d.Base.LoggerTags.CALL_PROVIDER,"OfferSDPEventInMultipleHandler error while creating answer: "+e),this.handleError(new d.Services.Call.CallException(d.Services.Call.CallError.INTERNAL_ERROR))),C.prototype.resetFarEndRenegotiateStateIfNeeded.call(this,i)}.bind(this),function(e){return e=0<o.length&&(o[0].enabled||i.isNailedUpVideoConnectionSupported())?d.Providers.Call.Utils.updateVideoSdp(o[0],e):d.Base.SDPUtil.rejectMedia(e,"m=video"),i.call.getState()===d.Services.Call.CallStates.HOLDING||i.call.getState()===d.Services.Call.CallStates.HELD||i.call.isHeldRemotely()||a.data.action===d.Providers.Call.CallProvider.Constants.INCOMING_HOLD_ACTION?i.call.getState()!==d.Services.Call.CallStates.HELD&&i.call.getState()!==d.Services.Call.CallStates.HOLDING||(e=d.Providers.Call.Utils.updateAudioSdp(i.getAudioStream(),e)):e=a.data.audioStream.direction!==d.Services.Call.MediaDirection.SEND_ONLY?d.Base.SDPUtil.updateAudioSdpSendRecv(e):d.Providers.Call.Utils.updateAudioSdp(i.getAudioStream(),e),e})},d.Providers.Call.OfferSDPEventInMultipleHandler=C}(AvayaClientServices),function(n){"use strict";function a(t,i){var a=t._callGatewayProvider,r=i.data.callProvider,e=t._rtConnection;e.onAddStream=function(e){t.handleEvent(new n.Providers.Call.OnAddStreamEvent({newStream:e}))};var s=t.getVideoStreams();e.createAnswer(i.data.offer,function(e){0<s.length&&0<i.data.videoStreams.length&&!n.Base.SDPUtil.hasH264(e.sdp)&&t.isFirefoxBrowser()&&(n.Base.Logger.warn(">>> H.264 video codec plugin must be installed to get video. <<<"),t.disableVideoStreamsAndChannels(n.Services.Call.VideoChannelDisabledReason.DISABLED_DUE_TO_MISSING_H264_PLUGIN)),a.offerSDPResponse(t.callId,e,i.data.action,t.getAudioStream(),s).fail(function(e){n.Base.Logger.error(n.Base.LoggerTags.CALL_PROVIDER,"Failed to send offer response",e),r.trigger(n.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[t.call,n.Services.Call.CallError.SEND_ERROR])})},function(e){n.Base.Utils.isDefined(e.errorCode)?(n.Base.Logger.error(n.Base.LoggerTags.CALL_PROVIDER,"Error while creating answer",e.errorMsg),r.trigger(n.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[t.call,e.errorCode,e.protocolType,e.protocolErrorCode,e.errorMsg])):(n.Base.Logger.error(n.Base.LoggerTags.CALL_PROVIDER,"Error while creating offer",e),r.trigger(n.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[t.call,n.Services.Call.CallError.INTERNAL_ERROR]))})}function r(e){e.revertFsmState(n.Providers.Call.States.ACTIVE)}n.Providers.Call.OfferSDPEventInStartingHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider;t.determineIfNailedUpVideoConnectionSupported(e.data.videoStreams),e.data.iceServerChanged&&t._rtConnection.updatePeerConfiguration(t._rtcConfiguration),null!==t.localStream&&t._rtConnection.hasVideo(t.localStream)&&e.data.videoResolution&&e.data.videoResolution.getWidth()!==t._videoResolution.getWidth()&&e.data.videoResolution.getHeight()!==t._videoResolution.getHeight()?n.Providers.Call.CPUtils.createLocalMediaStream(e.data.audioDevice,e.data.videoDevice,t,i.getMediaServiceFactory(),e.data.videoResolution,a,r,e):a(t,e)}}(AvayaClientServices),function(s){"use strict";s.Providers.Call.OnAddRemoteTrackEventInActiveHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider;if(s.Base.Logger.debug(s.Base.LoggerTags.CALL_PROVIDER,">>> Add new remote track: "+e.data.newTrack.kind+" id: "+e.data.newTrack.id),e.data.newTrack.kind===s.Providers.Call.CallProvider.Constants.VIDEO_TRACK){var a=t.call.getVideoChannels();0<a.length&&(t._rtConnection.enableRemoteVideoTrack(t.remoteStream,e.data.newTrack),i.getMediaServiceFactory().getVideoInterfaceService().setRemoteMediaStream(a[0].getChannelId(),t.remoteStream),i.triggerVideoChannelUpdate(t.call))}else{var r=i.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput();t.remoteStream&&!r.playAudioStream(t.remoteStream,t.call.isSpeakerMuted())&&s.Base.Logger.info(s.Base.LoggerTags.CALL_PROVIDER,"No Audio Tracks Found. Could not replay remote audio."),i.trigger(s.Providers.Interfaces.CallProviderCallbackIds.AUDIO_STREAM_UPDATED,[t.call,t.remoteStream])}}}(AvayaClientServices),function(s){"use strict";s.Providers.Call.OnAddStreamEventInActiveHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider,a=null===t.remoteStream;if(0<e.data.newStream.getAudioTracks().length){var r=i.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput();r.stopPlayingAudioStream(t.remoteStream),t.remoteStream=e.data.newStream,r.playAudioStream(t.remoteStream,t.call.isSpeakerMuted()),i.getMediaServiceFactory().getAudioOutputInterfaceService().setRemoteMediaStream(t.call.getCallId(),t.remoteStream),i.trigger(s.Providers.Interfaces.CallProviderCallbackIds.AUDIO_STREAM_UPDATED,[t.call,t.remoteStream])}(a||null===t.remoteStream.onaddtrack)&&(s.Base.Logger.info(s.Base.LoggerTags.CALL_PROVIDER,"Registering for add/remove track events from "+t.remoteStream.id),t._rtConnection.onAddRemoteTrack=function(e){t.handleEvent(new s.Providers.Call.OnAddRemoteTrackEvent({newTrack:e}))},t._rtConnection.onRemoveRemoteTrack=function(e){t.handleEvent(new s.Providers.Call.OnRemoveRemoteTrackEvent({newTrack:e}))}),t._rtConnection.enableRemoteStreams(),s.Base.Utils.isDefined(e.data.action)&&e.data.action===s.Providers.Call.CallProvider.Constants.UNHOLD&&(t.call.isAudioMuted()?t.enableLocalVideoStreams():t.enableLocalStreams()),t.notifyCallServiceOfMediaChanges(e.data.action)}}(AvayaClientServices),function(n){"use strict";n.Providers.Call.OnAddStreamEventPreActiveHandler=function(e){var t=e.data.cpCall,i=t._rtConnection,a=e.data.callProvider,r=a.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput(),s=null===t.remoteStream;t.remoteStream=e.data.newStream,a.getMediaServiceFactory().getAudioOutputInterfaceService().setRemoteMediaStream(t.call.getCallId(),t.remoteStream),a.trigger(n.Providers.Interfaces.CallProviderCallbackIds.AUDIO_STREAM_UPDATED,[t.call,t.remoteStream]),t._isEarlyMedia&&!r.isPlaying(t.remoteStream)?(i.enableRemoteStreams(),t.call.isAudioMuted()||i.enableLocalAudioStreams(),r.playAudioStream(t.remoteStream,t.call.isSpeakerMuted())||n.Base.Logger.info(n.Base.LoggerTags.CALL_PROVIDER,"No Audio Tracks Found.  Could not play remote audio.")):i.disableRemoteStreams(),s&&(n.Base.Logger.info(n.Base.LoggerTags.CALL_PROVIDER,"Registering for add/remove track events from "+t.remoteStream.id),t._rtConnection.onAddRemoteTrack=function(e){t.handleEvent(new n.Providers.Call.OnAddRemoteTrackEvent({newTrack:e}))},t._rtConnection.onRemoveRemoteTrack=function(e){t.handleEvent(new n.Providers.Call.OnRemoveRemoteTrackEvent({newTrack:e}))})}}(AvayaClientServices),function(e){"use strict";e.Providers.Call.OnRemoveRemoteTrackEventInActiveHandler=function(t){var i=t.data.cpCall,a=t.data.callProvider;e.Base.Logger.debug(e.Base.LoggerTags.CALL_PROVIDER,">>> Removed remote track: "+t.data.newTrack.kind+" id: "+t.data.newTrack.id),t.data.newTrack.kind===e.Providers.Call.CallProvider.Constants.AUDIO_TRACK&&(i.remoteStream.getAudioTracks().forEach(function(e){e.id===t.data.newTrack.id&&a.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput().stopPlayingAudioStream(i.remoteStream,!1)}),a.trigger(e.Providers.Interfaces.CallProviderCallbackIds.AUDIO_STREAM_UPDATED,[i.call,i.remoteStream]))}}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Call.RejectCallRequestEventInMultipleHandler=function(e){var t=e.data.cpCall,i=t._callGatewayProvider,a=e.data.deferred;i.rejectCallRequest(t.callId,t.getCallRequestedTransactionalId(e.data.requestedType),e.data.action).then(function(){a.resolve()},function(e){a.reject(e)})}}(),function(e){"use strict";AvayaClientServices.Providers.Call.RejectOfferSDPEventInMultipleHandler=function(e){var t=e.data.cpCall;t._callGatewayProvider.rejectOfferSDPResponse(t.callId,e.data)}}(),function(e){"use strict";AvayaClientServices.Providers.Call.RevertStateEventInMultipleHandler=function(e){return{nextState:e.data.state}}}(),function(e){"use strict";AvayaClientServices.Providers.Call.SendDTMFEventInMultipleHandler=function(e){e.data.cpCall._rtConnection.sendDTMF(e.data.dtmf)}}(),function(e){"use strict";AvayaClientServices.Providers.Call.ServiceAvailableEventInActiveHandler=function(e){var t=e.data.cpCall;t.isIceConnectionStateFailed()&&!t.isIceRestartInProgress()&&t.iceConnectionFailedHandler()}}(),function(e){"use strict";AvayaClientServices.Providers.Call.ServiceAvailableEventInMultipleHandler=function(e){var t=e.data.cpCall;t.isIceConnectionStateFailed()&&t.iceConnectionFailedHandler()}}(),function(S){"use strict";S.Providers.Call.StartCallEventInInitialHandler=function(d){var e,t,C=d.data.cpCall,u=d.data.callProvider,v=C._callGatewayProvider,h=C.call.getVideoChannels(),i=C.call.getAudioChannel(),a=!0,p=!1,_=!1,r=d.data.audioDevice?d.data.audioDevice.getDeviceId():m;if(S.Base.Utils.isDefined(h))for(var s=0;s<h.length;s++){var n=h[s]._getInternalRequestedDirection();n===S.Services.Call.MediaDirection.SEND_ONLY||n===S.Services.Call.MediaDirection.SEND_RECV?(p=!0,d.data.videoDevice&&(e=d.data.videoDevice.getDeviceId())):n===S.Services.Call.MediaDirection.RECV_ONLY&&(_=!0,u.hasVideoDevices()&&(p=!0)),n!==S.Services.Call.MediaDirection.INACTIVE&&(t=h[s].getChannelId())}if(S.Base.Utils.isDefined(i)&&i.getRequestedDirection()===S.Services.Call.MediaDirection.DISABLE&&(a=!1),a||p||!d.data.webCollab)if(a){var o=d.data.audioDevice?d.data.audioDevice.toString():"Default Audio",c=d.data.videoDevice?d.data.videoDevice.toString():"Default Camera";S.Base.Logger.info(S.Base.LoggerTags.CALL_PROVIDER,"Starting call using",o,c),u.getMediaServiceFactory().getMediaServicesService().createLocalMediaStream(C.call.getCallId(),!0,p,r,e,t,d.data.videoResolution).then(function(e){if(C.call.getState()===S.Services.Call.CallStates.ENDING||C.call.getState()===S.Services.Call.CallStates.ENDED)return S.Base.Logger.info(S.Base.LoggerTags.CALL_PROVIDER,"Start call rejected for inactive call"),void e.stream.getTracks().forEach(function(e){e.stop()});var t=e.stream;e.videoResolution&&C._updateVideoResolution(e.videoResolution),S.Base.Logger.debug(S.Base.LoggerTags.CALL_PROVIDER,"getUserMedia success");var i=0,a=null,r=[];if(t.getTracks().forEach(function(e){if("audio"===e.kind)a=new S.Providers.Interfaces.AudioStream(e.id,S.Services.Call.MediaDirection.SEND_RECV);else if("video"===e.kind){var t=S.Services.Call.MediaDirection.SEND_RECV;i<h.length&&(t=h[i]._getInternalRequestedDirection(),i++),r.push(new S.Providers.Interfaces.VideoStream(e.id,t))}}),null===a)return S.Base.Logger.error(S.Base.LoggerTags.CALL_PROVIDER,"No microphone is available"),void u.trigger(S.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[C.call,S.Services.Call.CallError.MICROPHONE_NOT_FOUND]);var s=d.data.nailedUpVideoConnection;if(p&&0===r.length&&s){var n=u.getActiveCallVideoTrack();S.Base.Utils.isDefined(n)&&(t.addTrack(n.clone()),r.push(new S.Providers.Interfaces.VideoStream(n.id,h[0]._getInternalRequestedDirection())))}if(0===r.length)if(p){e.cameraAccessDenied&&h[0]._setCameraAccessIsDenied(e.cameraDenialReason);var o=h[0]._getInternalRequestedDirection();if(o===S.Services.Call.MediaDirection.SEND_RECV)h[0]._setRequestedDirection(S.Services.Call.MediaDirection.RECV_ONLY),S.Base.Logger.warn(S.Base.LoggerTags.CALL_PROVIDER,"Camera is blocked - update SEND_RECV video direction to RECV_ONLY"),r.push(new S.Providers.Interfaces.VideoStream("recvOnlyVideoStreamId",S.Services.Call.MediaDirection.RECV_ONLY));else if(o===S.Services.Call.MediaDirection.SEND_ONLY)h[0]._setRequestedDirection(S.Services.Call.MediaDirection.INACTIVE),S.Base.Logger.warn(S.Base.LoggerTags.CALL_PROVIDER,"Camera is blocked - update SEND_ONLY video direction to INACTIVE");else{if(!s){S.Base.Logger.error(S.Base.LoggerTags.CALL_PROVIDER,"Failed to get video media streams for call."),C._rtConnection.stopStream(t);var c=new S.Providers.Call.DeviceRetrievalFailedEvent;return void C.handleEvent(c)}u.triggerAllowedNailedUpVideoModes(C.call,[S.Services.Call.VideoMode.RECEIVE_ONLY,S.Services.Call.VideoMode.DISABLE]),C.hasNailedUpConnectionVideoChannel()?(h[0]._setRequestedDirection(S.Services.Call.MediaDirection.DISABLE),h[0]._setInternalRequestedDirection(S.Services.Call.MediaDirection.RECV_ONLY)):h[0]._setRequestedDirection(S.Services.Call.MediaDirection.RECV_ONLY),s._setLogicalDirection(S.Services.Call.MediaDirection.INACTIVE);var l=new S.Providers.Interfaces.VideoStream("nailedUpVideo",S.Services.Call.MediaDirection.RECV_ONLY);r.push(l)}s&&s._setRequiredDirection(h[0]._getInternalRequestedDirection())}else _&&r.push(new S.Providers.Interfaces.VideoStream("recvOnlyVideoStreamId",S.Services.Call.MediaDirection.RECV_ONLY));s&&0<r.length&&(r[0]._logicalDirection=s.getLogicalDirection()),C.setAVStreams(a,r),C.localStream=t,C._rtConnection.addStream(C.localStream),C._rtConnection.disableLocalStreams(),v.startCall(d.data.remoteAddress,C.call.getSubject(),C.call._callCreationInfo,d.data.video,d.data.webCollab,C.getAudioStream(),C.getVideoStreams(),d.data.uccp,C.call.getCallId(),C.call._sessionId,s).then(function(e){S.Base.Logger.debug(S.Base.LoggerTags.CALL_PROVIDER,"callGateway startCallResponse: "+JSON.stringify(e));var t=new S.Providers.Call.StartCallResponseEvent;t.data={},t.data.callId=e.callId,t.data.videoResolution=d.data.videoResolution,t.data.audioDevice=d.data.audioDevice,t.data.videoDevice=d.data.videoDevice,C.handleEvent(t)},function(e){C._rtConnection.stopAllStreams(),u.trigger(S.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[C.call,e.errorCode,e.protocolType,e.protocolErrorCode,e.errorMsg])})},function(e){S.Base.Logger.error(S.Base.LoggerTags.CALL_PROVIDER,"Failed to get local media streams for call. ",e);var t=new S.Providers.Call.DeviceRetrievalFailedEvent;e.getError&&e.getError()&&(t.data={callError:e.getError()}),C.handleEvent(t)})}else S.Base.Logger.error(S.Base.LoggerTags.CALL_PROVIDER,"Video only call is not supported"),u.trigger(S.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[C.call,S.Services.Call.CallError.VIDEO_ONLY_CALL_NOT_SUPPORTED]);else C.call._dataOnly=!0,C._isMPaaSCollabCall=C.isMPaaSCall(),S.Base.Logger.info(S.Base.LoggerTags.CALL_PROVIDER,"Starting Collaboration only call"),v.startCall(d.data.remoteAddress,C.call.getSubject(),C.call._callCreationInfo,!1,d.data.webCollab,null,null,d.data.uccp,C.call.getCallId(),C.call._sessionId).then(function(e){S.Base.Logger.debug(S.Base.LoggerTags.CALL_PROVIDER,"callGateway startCallResponse: "+JSON.stringify(e));var t=new S.Providers.Call.StartCallResponseEvent;t.data={},t.data.callId=e.callId,C.handleEvent(t)},function(e){u.trigger(S.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,[C.call,e.errorCode,e.protocolType,e.protocolErrorCode,e.errorMsg])});return{nextState:S.Providers.Call.States.STARTING}}}(AvayaClientServices),function(d){"use strict";d.Providers.Call.StartCallResponseEventInStartingHandler=function(t){var i=t.data.cpCall,a=t.data.callProvider,r=t.data.callId;if(i.callId=r,i._isReadyToReceiveMediaRequest=!0,a.registerCall(r,i.call,i),i.call.getState()===d.Services.Call.CallStates.ENDING)a.stopCall(i.call);else{a.triggerCallStarted(i.call),a.getMediaServiceFactory().getAudioInputInterfaceService().replaceLocalMediaStream(r,i.localStream);var e=a.getQueuedCallFailure(r);if(e)i.callFailure(e.errorCode,e.protocolType,e.protocolErrorCode,e.failureReason);else{var s=a.getQueuedCallEstablishedNotification(r);if(s){var n=i.buildCallEstablishedEvent(s.remoteAddress,s.remoteDisplayName,s.audioStream,s.videoStreams,s.isConference,s.uccpUrl,s.webCollabUrl,!1,s.ucid,s.parentUcid,s.contextId);return i.prepareEvent(n),{nextEvent:n}}var o,c=function(){var e=a.getQueuedMediaOfferNotification(r);e&&(d.Base.Utils.isDefined(e.offer)?i.offerSDP(e.offer,e.action,e.audioStream,e.videoStreams,e.videoBandwidth,e.turnData):i.getOfferSDP(e.action,e.audioStream,e.videoStreams,e.videoBandwidth,t.data.audioDevice,t.data.videoDevice,e.turnData))},l=a.getQueuedVideoMuteState();l&&(l===d.Services.Call.MediaMuteStates.MUTED?o=i.muteVideo():l===d.Services.Call.MediaMuteStates.UNMUTED&&(o=i.unmuteVideo())),o?o.always(function(){c()}):c()}}}}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Call.StartRingingEventInInitialHandler=function(e){var t=e.data.cpCall;t._callGatewayProvider.startRinging(t.callId).then(function(){t.setRingingStarted(!0)})}}(),function(i){"use strict";i.Providers.Call.TransferEventInActiveHandler=function(e){var t=e.data.cpCall;t._callGatewayProvider.transfer(t.callId,e.data.targetRemoteAddress,t.getAudioStream(),t.getVideoStreams()).then(function(){},function(e){t._transferPromise.reject(new i.Services.Call.CallException(e.errorCode,e.protocolType,e.protocolErrorCode,e.errorMsg))})}}(AvayaClientServices),function(c){"use strict";c.Providers.Call.UnBlockCameraEventInActiveHandler=function(e){var a=e.data.cpCall,r=a._callGatewayProvider,t=a.localStream.getVideoTracks();if(0<t.length&&!a.hasVideoTrackStopStreaming(t[0]))a.enableLocalVideoStreams(),r.blockUnBlockCamera(a.callId,a.getAudioStream(),a.getVideoStreams()).then(function(){},function(e){c.Base.Logger.error(c.Base.LoggerTags.CALL_PROVIDER,"Failed to unblock camera: "+e),a.rejectMediaTransaction(new c.Services.Call.CallException(c.Services.Call.CallError.SEND_ERROR)),a.revertFsmState(c.Providers.Call.States.ACTIVE)});else{0<t.length&&a.localStream.removeTrack(t[0]);var i=e.data.callProvider,s=a.call.getVideoChannels(),n=c.Base.Utils.isDefined(e.data.videoDevice)?e.data.videoDevice.getDeviceId():m,o=s[0].getChannelId();a.setVideoChannelId(s[0].getChannelId()),i.getMediaServiceFactory().getMediaServicesService().addVideoTracksToLocalStream(n,o,a.localStream,e.data.videoResolution,a._rtConnection).then(function(e){c.Base.Logger.debug(c.Base.LoggerTags.CALL_PROVIDER,"getUserMedia success");var t=a.getAudioStream(),i=[];e.getTracks().forEach(function(e){if(e.kind===c.Providers.Call.CallProvider.Constants.VIDEO_TRACK&&e.readyState===c.Base.AbstractRTCConnectionProvider.Constants.MEDIA_STREAM_TRACK_READY_STATE_LIVE){var t=c.Services.Call.MediaDirection.SEND_RECV;i.push(new c.Providers.Interfaces.VideoStream(e.id,t))}}),a.setAVStreams(t,i),a.isLocalVideoMuted()&&a.muteLocalVideo(),r.blockUnBlockCamera(a.callId,a.getAudioStream(),a.getVideoStreams()).then(function(){},function(e){c.Base.Logger.error(c.Base.LoggerTags.CALL_PROVIDER,"Failed to unblock camera: "+e),a.rejectMediaTransaction(new c.Services.Call.CallException(c.Services.Call.CallError.SEND_ERROR)),a.revertFsmState(c.Providers.Call.States.ACTIVE)})},function(e){c.Base.Logger.error(c.Base.LoggerTags.CALL_PROVIDER,"Failed to get local media streams for call. ",e),e.getError()===c.Services.Call.CallError.CAMERA_PERMISSION_DENIED?(a.rejectMediaTransaction(e),a.revertFsmState(c.Providers.Call.States.ACTIVE)):(a.rejectMediaTransaction(new c.Services.Call.CallException(c.Services.Call.CallError.MEDIA_CREATION_FAILURE)),a.deviceRetrievalFailure(c.Providers.Call.States.ACTIVE))})}return{nextState:c.Providers.Call.States.ACTIVE_RENEGOTIATE}}}(AvayaClientServices),function(o){"use strict";o.Providers.Call.UnHoldEventInActiveHandler=function(e){var t=e.data.cpCall,i=t._callGatewayProvider,a=t.call.getVideoChannels();0===a.length||a[0]._getInternalRequestedDirection()!==o.Services.Call.MediaDirection.SEND_RECV&&a[0]._getInternalRequestedDirection()!==o.Services.Call.MediaDirection.SEND_ONLY?t.call.isAudioMuted()||t._rtConnection.enableLocalAudioStreams():(t.call.isAudioMuted()||t._rtConnection.enableLocalAudioStreams(),t.enableLocalVideoStreams());var r=t.getAudioStream(),s=t.getVideoStreams();r.direction=o.Services.Call.MediaDirection.SEND_RECV,t.isNailedUpVideoConnectionSupported()&&(r._logicalDirection=o.Services.Call.MediaDirection.SEND_RECV);for(var n=0;n<s.length;n++)t.isNailedUpVideoConnectionSupported()?(s[n].direction=o.Services.Call.MediaDirection.SEND_RECV,s[n]._logicalDirection=t._latestNonHoldingVideoDirection):s[n].direction=t._latestNonHoldingVideoDirection;return t.setAVStreams(r,s),i.unholdCall(t.callId,t.getAudioStream(),t.getVideoStreams()).then(function(){},function(e){o.Base.Logger.error(o.Base.LoggerTags.CALL_PROVIDER,"Failed to unhold: "+e),t.rejectMediaTransaction(new o.Services.Call.CallException(o.Services.Call.CallError.SEND_ERROR)),t.revertFsmState(o.Providers.Call.States.ACTIVE)}),{nextState:o.Providers.Call.States.ACTIVE_RENEGOTIATE}}}(AvayaClientServices),function(i){"use strict";i.Providers.Call.UnmuteAudioEventInMultipleHandler=function(e){var t=e.data.cpCall;t.localStream&&(t._rtConnection.enableLocalAudioStreams(),e.data.callProvider.trigger(i.Providers.Interfaces.CallProviderCallbackIds.AUDIO_STREAM_UPDATED,[t.call,t.localStream]))}}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Call.UnmuteSpeakerEventInMultipleHandler=function(e){var t=e.data.cpCall,i=e.data.callProvider;t.remoteStream&&i.getMediaServiceFactory().getAudioOutputInterfaceService().getAudioOutput().unmuteStream(t.remoteStream)}}(),function(a){"use strict";a.Providers.Call.UnmuteVideoEventInMultipleHandler=function(e){var t=e.data.cpCall,i=t._callGatewayProvider;t.unmuteLocalVideo(),t.isMPaaSCall()?t.hasReceivedCallEstablishedEvent()?i.unmuteVideo(t.callId,t.call._sessionId,t.getVideoStreams()).then(function(){t.noMediaTransactionDfd.resolve()},function(e){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to notify server of local video unmute state: "+e),t.noMediaTransactionDfd.reject(new a.Services.Call.CallException(a.Services.Call.CallError.SEND_ERROR))}):(t.queueMuteUnumteFunctor(function(){i.unmuteVideo(t.callId,t.call._sessionId,t.getVideoStreams()).fail(function(e){a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to notify server of local video unmute state: "+e)})}),t.noMediaTransactionDfd.resolve()):t.noMediaTransactionDfd.resolve()}}(AvayaClientServices),function(n){"use strict";n.Providers.Call.UpdateIceRestartMediaEventInActiveHandler=function(e){var t=e.data.cpCall,i=t._callGatewayProvider;if(t.isCallServiceAvailable()){t.setIceRestartInProgress(!0);var a="all"===t._rtcConfiguration.iceTransportPolicy,r=0<t._rtcConfiguration.iceServers.length&&0<t._rtcConfiguration.iceServers[0].urls.length,s=t._rtcConfiguration._turnOfferType===n.Providers.Call.CallProvider.Constants.ICE_CANDIDATE_TYPE_HOST_ONLY;return a&&r&&s&&(!t._hadMediaConnected||1<t.getIceRestartAttemtps())&&(n.Base.Logger.info("Initiating ICE restart with relay only"),t.setIceRestartRelayType(n.Providers.Call.CallProvider.Constants.ICE_CANDIDATE_TYPE_RELAY_ONLY)),i.updateVideo(t.callId,t.getAudioStream(),t.getVideoStreams(),!0).then(function(){},function(e){t.setIceRestartInProgress(!1),t.revertFsmState(n.Providers.Call.States.ACTIVE),n.Base.Logger.error(n.Base.LoggerTags.CALL_PROVIDER,"Failed to update ice media: "+e)}),{nextState:n.Providers.Call.States.ACTIVE_RENEGOTIATE}}t.setIceRestartInProgress(!1),n.Base.Logger.error(n.Base.LoggerTags.CALL_PROVIDER,"Will initiate ICE restart request once call service is available")}}(AvayaClientServices),function(a){"use strict";a.Providers.Call.UpdateIceRestartMediaEventInMultipleHandler=function(e){var t=e.data.cpCall,i=t._callGatewayProvider;if(t.isCallServiceAvailable())return t.setIceRestartInProgress(!0),i.updateVideo(t.callId,t.getAudioStream(),t.getVideoStreams(),!0).then(function(){},function(e){t.setIceRestartInProgress(!1),a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Failed to update ice media: "+e)}),{nextState:a.Providers.Call.States.ACTIVE_RENEGOTIATE};t.setIceRestartInProgress(!1),a.Base.Logger.error(a.Base.LoggerTags.CALL_PROVIDER,"Will initiate ICE restart request once call service is available")}}(AvayaClientServices),function(n){"use strict";n.Providers.Call.UpdateLocalStreamHandler=function(e){var t,i,a=e.data.cpCall,r=function(){n.Base.Logger.debug("Sending UPDATE_VIDEO request for new local stream"),a._callGatewayProvider.updateVideo(a.callId,a.getAudioStream(),a.getVideoStreams()).then(function(){a.resolveMediaTransaction(a.getVideoResolution()),n.Base.Utils.isDefined(e.data.videoResolutionChanged)||a.revertFsmState(n.Providers.Call.States.ACTIVE),e.data.selectedDevice&&e.data.selectedDevice._kind===n.Base.MediaTypes.AUDIO_INPUT&&e.data.callProvider.trigger(n.Providers.Interfaces.CallProviderCallbackIds.AUDIO_STREAM_UPDATED,[a.call,a.localStream])},function(e){n.Base.Logger.error("Failed to update local stream: "+a.getVideoResolution()),a.rejectMediaTransaction(new n.Services.Call.CallException(n.Services.Call.CallError.SEND_ERROR)),a.revertFsmState(n.Providers.Call.States.ACTIVE)})},s=function(){n.Base.Logger.error("Create local media error: "+a.getVideoResolution()),a.rejectMediaTransaction(new n.Services.Call.CallException(n.Services.Call.CallError.MEDIA_CREATION_FAILURE)),a.revertFsmState(n.Providers.Call.States.ACTIVE)};if(null!==a.localStream)return a._rtConnection.isRTCRtpSenderSupported()?e.data.videoResolutionChanged?n.Providers.Call.CPUtils.updateVideoResolution(a,e.data.callProvider.getMediaServiceFactory(),e.data.videoResolution,r,s):(e.data.selectedDevice._kind===n.Base.MediaTypes.VIDEO_INPUT?i=e.data.selectedDevice:t=e.data.selectedDevice,n.Providers.Call.CPUtils.updateDevices(t,i,a,e.data.callProvider.getMediaServiceFactory(),e.data.videoResolution,r,s)):n.Providers.Call.CPUtils.createLocalMediaStream(e.data.audioDevice,e.data.videoDevice,a,e.data.callProvider.getMediaServiceFactory(),e.data.videoResolution,r,s),{nextState:n.Providers.Call.States.ACTIVE_RENEGOTIATE};r()}}(AvayaClientServices),function(s){"use strict";s.Providers.Call.UpdatePreferredReceiveResolutionEventInMultipleHandler=function(e){var t=e.data.cpCall,i=t._callGatewayProvider;if(t.hasReceivedCallEstablishedEvent()){var a=s.Base.VideoResolution[e.data.videoResolution],r=a.getWidth()+"x"+a.getHeight();i.updatePreferredReceiveResolution(t.callId,t.call._sessionId,t.getVideoStreams(),r).then(function(){t.call.getVideoChannels()[0]._preferredVideoResolution=e.data.videoResolution,t.noMediaTransactionDfd.resolve()},function(e){s.Base.Logger.error(s.Base.LoggerTags.CALL_PROVIDER,"Failed to update preferred resolution: "+e),t.noMediaTransactionDfd.reject(new s.Services.Call.CallException(s.Services.Call.CallError.SEND_ERROR))})}else s.Base.Logger.error(s.Base.LoggerTags.CALL_PROVIDER,"Failed to update preferred resolution due to invalid state ",t.call.getState()),t.noMediaTransactionDfd.reject(new s.Services.Call.CallException(s.Services.Call.CallError.CAPABILITY_NOT_ALLOWED))}}(AvayaClientServices),function(r){"use strict";r.Providers.Call.UpdateRemoteVideoEventInActiveHandler=function(e){var t=e.data.cpCall,i=t._callGatewayProvider,a=t.getVideoStreams();return 0!==a.length&&a[0].enabled&&t._rtConnection.setLocalVideoDirection(a[0].direction),i.updateVideo(t.callId,t.getAudioStream(),t.getVideoStreams()).then(function(){},function(e){r.Base.Logger.error(r.Base.LoggerTags.CALL_PROVIDER,"Failed to update remote video: "+e),t.rejectMediaTransaction(new r.Services.Call.CallException(r.Services.Call.CallError.SEND_ERROR)),t.revertFsmState(r.Providers.Call.States.ACTIVE)}),{nextState:r.Providers.Call.States.ACTIVE_RENEGOTIATE}}}(AvayaClientServices),function(t){"use strict";function e(e,t,i){this._verifySupportedLogicalDirection(e),this._verifySupportedGuidelinesDirection(t),this._verifySupportedGuidelinesDirection(i),this._logicalDirection=e,this._requiredDirection=t,this._permittedDirection=i}e.prototype={getLogicalDirection:function(){return this._logicalDirection},getRequiredDirection:function(){return this._requiredDirection},getPermittedDirection:function(){return this._permittedDirection},_setLogicalDirection:function(e){this._verifySupportedLogicalDirection(e),this._logicalDirection=e},_setRequiredDirection:function(e){this._verifySupportedGuidelinesDirection(e),this._requiredDirection=e},_setPermittedDirection:function(e){this._verifySupportedGuidelinesDirection(e),this._permittedDirection=e},_verifySupportedLogicalDirection:function(e){if(e===t.Services.Call.MediaDirection.DISABLE)throw new Error("Unsupported logical video direction: "+e)},_verifySupportedGuidelinesDirection:function(e){if(e&&e===t.Services.Call.MediaDirection.SEND_ONLY||e===t.Services.Call.MediaDirection.DISABLE)throw new Error("Unsupported video guidelines direction: "+e)}},t.Providers.Call.NailedUpVideoConnectionInfo=e}(AvayaClientServices),function(r){"use strict";function e(e,t,i){r.Base.Observable.call(this),this._networkProvider=e,this._config={},this._notificationProvider=t,this._notificationParser=i}(e.prototype=Object.create(r.Base.Observable.prototype)).init=function(e){return this._config=e,this._networkProvider.onMessage=function(e){},this._networkProvider.onError=function(e){r.Base.Logger.error(r.Base.LoggerTags.CALL_GATEWAY_PROVIDER,e)},this._networkProvider.init(this._config),this._notificationProvider.onMessage=function(e){var t,i,a;t=e.data&&e.type!==r.Base.ProvidersEventTypes.PING?JSON.parse(e.data):e;try{i=JSON.parse(t.message),a=(a=this._notificationParser.parse(i))||i}catch(e){a=t}a.type?this.trigger("call."+a.type,[a]):this.trigger("call.message",[a])}.bind(this),this._notificationProvider.onError=function(e){r.Base.Logger.error(r.Base.LoggerTags.CALL_GATEWAY_PROVIDER,e)},this._notificationProvider.init(this._config),this},e.prototype.startCall=function(e){var t=JSON.stringify({remoteAddress:e});return this._networkProvider.send(t,{sendType:"POST",urlSuffix:"/restgateway/calls",dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return new r.Providers.CallGateway.StartCallData(e.callHref,e.callId)})},e.prototype.endCall=function(e){var t={sendType:"DELETE",urlSuffix:"/restgateway/calls/"+e,dataType:"text",headers:{Accept:"application/json","Content-Type":"application/json"}};return this._networkProvider.send(null,t)},e.prototype.acceptCall=function(e,t){var i={sendType:"POST",urlSuffix:"/restgateway/calls/"+e+"/connections/"+t,dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json;"}};return this._networkProvider.send(null,i)},e.prototype.holdCall=function(e,t){var i={sendType:"POST",urlSuffix:"/restgateway/calls/"+e+"/connections/"+t+"/hold",dataType:"text",headers:{Accept:"application/json","Content-Type":"application/json;"}};return this._networkProvider.send(null,i)},e.prototype.unholdCall=function(e,t){var i={sendType:"POST",urlSuffix:"/restgateway/calls/"+e+"/connections/"+t+"/unhold",dataType:"text",headers:{Accept:"application/json","Content-Type":"application/json;"}};return this._networkProvider.send(null,i)},r.Providers.CallGateway.CallGatewayProvider=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.CallGateway.ActiveCallMessage=function(e,t,i,a,r,s,n,o,c,l){this.type="active",this.callEvent="ACTIVE",this.originalCallingParticipant=e,this.originalCalledParticipant=t,this.participants=i,this.callId=a,this.ucId=r,this.callHref=s,this.connectionId=n,this.connectionHref=o,this.address=c,this.operations=l}}(),function(e){"use strict";AvayaClientServices.Providers.CallGateway.AlertingCallMessage=function(e,t,i,a,r,s,n,o,c,l,d){this.type="alerting",this.callEvent="ALERTING",this.originalCallingParticipant=e,this.originalCalledParticipant=t,this.participants=i,this.callId=a,this.ucId=r,this.callHref=s,this.connectionId=n,this.connectionHref=o,this.address=c,this.operations=l,this.alertingParticipant=d}}(),function(e){"use strict";AvayaClientServices.Providers.CallGateway.AnsweredCallMessage=function(e,t,i,a,r,s,n,o,c,l,d){this.type="answered",this.callEvent="ANSWERED",this.originalCallingParticipant=e,this.originalCalledParticipant=t,this.participants=i,this.callId=a,this.ucId=r,this.callHref=s,this.connectionId=n,this.connectionHref=o,this.address=c,this.operations=l,this.answeringParticipant=d}}(),function(e){"use strict";AvayaClientServices.Providers.CallGateway.FailedCallMessage=function(e,t,i,a,r,s,n,o){this.type="failed",this.callEvent="FAILED",this.originalCallingParticipant=e,this.originalCalledParticipant=t,this.participants=i,this.callId=a,this.ucId=r,this.callHref=s,this.address=n,this.reason=o}}(),function(e){"use strict";AvayaClientServices.Providers.CallGateway.HeldCallMessage=function(e,t,i,a,r,s,n,o,c,l){this.type="held",this.callEvent="HELD",this.originalCallingParticipant=e,this.originalCalledParticipant=t,this.participants=i,this.callId=a,this.ucId=r,this.callHref=s,this.connectionId=n,this.connectionHref=o,this.address=c,this.operations=l}}(),function(e){"use strict";AvayaClientServices.Providers.CallGateway.ParticipantDroppedCallMessage=function(e,t,i,a,r){this.type="participantDropped",this.callEvent="PARTICIPANTDROPPED",this.participants=e,this.callId=t,this.callHref=i,this.address=a,this.droppingParticipant=r}}(),function(e){"use strict";AvayaClientServices.Providers.CallGateway.StartCallData=function(e,t){this.callId=t,this.callHref=e}}(),function(e){"use strict";AvayaClientServices.Providers.CallGateway.SubscriptionCallMessage=function(e,t,i){this.type="subscription",this.callEvent="SUBSCRIPTION",this.status=e,this.subscriptionId=t,this.additionalProperties=i}}(),function(e){"use strict";AvayaClientServices.Providers.CallGateway.UnheldCallMessage=function(e,t,i,a,r,s,n,o,c,l){this.type="unheld",this.callEvent="UNHELD",this.originalCallingParticipant=e,this.originalCalledParticipant=t,this.participants=i,this.callId=a,this.ucId=r,this.callHref=s,this.connectionId=n,this.connectionHref=o,this.address=c,this.operations=l}}(),function(e){"use strict";function t(){}t.prototype={parse:function(e){throw new Error("Method not implemented!")}},e.Providers.CallGateway.AbstractParser=t}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.CallGateway.AbstractParser.prototype)).parse=function(e){return new t.Providers.CallGateway.ActiveCallMessage(e.originalCallingParticipant,e.originalCalledParticipant,e.participants,e.callId,e.ucId,e.callHref,e.connectionId,e.connectionHref,e.address,e.operations)},t.Providers.CallGateway.ActiveCallMessageParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.CallGateway.AbstractParser.prototype)).parse=function(e){return new t.Providers.CallGateway.AlertingCallMessage(e.originalCallingParticipant,e.originalCalledParticipant,e.participants,e.callId,e.ucId,e.callHref,e.connectionId,e.connectionHref,e.address,e.operations,e.alertingParticipant)},t.Providers.CallGateway.AlertingCallMessageParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.CallGateway.AbstractParser.prototype)).parse=function(e){return new t.Providers.CallGateway.AnsweredCallMessage(e.originalCallingParticipant,e.originalCalledParticipant,e.participants,e.callId,e.ucId,e.callHref,e.connectionId,e.connectionHref,e.address,e.operations,e.answeringParticipant)},t.Providers.CallGateway.AnsweredCallMessageParser=e}(AvayaClientServices),function(i){"use strict";function e(){this._parsers=[]}e.prototype={register:function(e,t){this._parsers[e]=t},unregister:function(e){this._parsers[e]=m},parse:function(e){return e.callEvent?this._delegateParser(e.callEvent,e):e.subscriptionId?this._delegateParser("subscription",e):e},_delegateParser:function(e,t){if(this._parsers[e]!==m)return this._parsers[e].parse(t);i.Base.Logger.error(i.Base.LoggerTags.CALL_GATEWAY_PROVIDER,"No parser specified!",e)}},i.Providers.CallGateway.CallNotificationParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.CallGateway.AbstractParser.prototype)).parse=function(e){return new t.Providers.CallGateway.FailedCallMessage(e.originalCallingParticipant,e.originalCalledParticipant,e.participants,e.callId,e.ucId,e.callHref,e.address,e.reason)},t.Providers.CallGateway.FailedCallMessageParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.CallGateway.AbstractParser.prototype)).parse=function(e){return new t.Providers.CallGateway.HeldCallMessage(e.originalCallingParticipant,e.originalCalledParticipant,e.participants,e.callId,e.ucId,e.callHref,e.connectionId,e.connectionHref,e.address,e.operations)},t.Providers.CallGateway.HeldCallMessageParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.CallGateway.AbstractParser.prototype)).parse=function(e){return new t.Providers.CallGateway.ParticipantDroppedCallMessage(e.participants,e.callId,e.callHref,e.address,e.droppingParticipant)},t.Providers.CallGateway.ParticipantDroppedCallMessageParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.CallGateway.AbstractParser.prototype)).parse=function(e){return new t.Providers.CallGateway.SubscriptionCallMessage(e.status,e.subscriptionId,e.additionalProperties)},t.Providers.CallGateway.SubscriptionCallMessageParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.CallGateway.AbstractParser.prototype)).parse=function(e){return new t.Providers.CallGateway.UnheldCallMessage(e.originalCallingParticipant,e.originalCalledParticipant,e.participants,e.callId,e.ucId,e.callHref,e.connectionId,e.connectionHref,e.address,e.operations)},t.Providers.CallGateway.UnheldCallMessageParser=e}(AvayaClientServices),function(d){"use strict";function e(){this._csgCallsProviderMap={},this._csgProviderMap={},this._csgPresenceProvider=m,this._messageBuilder=new d.Providers.CallServiceGateway.CallServiceGatewayProviderMessageBuilder}e.prototype={getCSGCallsProvider:function(e){return this._csgCallsProviderMap.hasOwnProperty(e)||(this._csgCallsProviderMap[e]=new d.Providers.CallServiceGateway.CSGCallsProvider(this._getCSGProvider(e),this._messageBuilder,e)),this._csgCallsProviderMap[e]},getCSGCallsProviderAsArray:function(){var e=[];for(var t in this._csgCallsProviderMap)this._csgCallsProviderMap.hasOwnProperty(t)&&e.push(this._csgCallsProviderMap[t]);return e},getCSGPresenceProvider:function(e){return this._csgPresenceProvider||(this._csgPresenceProvider=new d.Providers.CallServiceGateway.CSGPresenceProvider(this._getCSGProvider(e),this._messageBuilder)),this._csgPresenceProvider},_getCSGProvider:function(e){if(!this._csgProviderMap.hasOwnProperty(e)){var t=[d.Providers.CallServiceGateway.CSGNotificationEventType.CAS_NOTIFICATION,d.Providers.CallServiceGateway.CSGNotificationEventType.PING],i=new d.Base.SSEProvider(t),a=new d.Base.RESTProvider,r=new d.Base.SSEIntegrationProvider(a,i),s=new d.Base.WebSocketProvider,n=new d.Base.NetworkProvider(s,r,d.Base.LoggerTags.CALL_GATEWAY_PROVIDER),o=new d.Base.NetworkProvider(new d.Base.RESTProvider,m,d.Base.LoggerTags.CALL_GATEWAY_PROVIDER),c=new d.Base.PollingRESTProvider,l=new d.Base.PollingRESTProvider;this._csgProviderMap[e]=new d.Providers.CallServiceGateway.CSGProvider(this._messageBuilder,o,n,c,l)}return this._csgProviderMap[e]}},d.Providers.CallServiceGateway.CallServiceGatewayProviderFactory=e}(AvayaClientServices),function(l){"use strict";var c={CSA_RESOURCE:"application/vnd.avaya.csa.resources.v1+json",CSA_SERVICES:"application/vnd.avaya.csa.services.v1+json",CSA_ERROR:"application/vnd.avaya.csa.error.v1+json",CSA_CONFIGURATION:"application/vnd.avaya.csa.configuration.v1+json",CSA_CALL:"application/vnd.avaya.csa.call.v1+json",CSA_CALLS:"application/vnd.avaya.csa.calls.v1+json",CSA_CLIENT:"application/vnd.avaya.csa.client.v1+json",CSA_CLIENTS:"application/vnd.avaya.csa.clients.v1+json",CSA_CALL_ACTION:"application/vnd.avaya.csa.callaction.v1+json",CSA_CALL_PREFERENCE:"application/vnd.avaya.csa.callpreferences.v1+json",CSA_PRESENCE_CONTAINER:"application/vnd.avaya.presence-im.container.v1+json",CSA_PRESENCE_PUBLICATION:"application/vnd.avaya.presence.presence-pub.v1+json",CSA_PRESENCE_RESOURCE_LIST:"application/vnd.avaya.csa.resourcelist.v1+json",MPAAS_CALL_PROPERTIES:"application/vnd.avaya.mpaas.callproperties.v1+json"},s="://";function e(){this._requestCounter=0}e.prototype={buildStartCallOptions:function(e){var t=l.Base.Utils.parseUrl(e),i=t.protocol+s+t.host;return{urlSuffix:t.path?t.path:"",url:i,sendType:l.Providers.CallServiceGateway.Constants.HTTP_POST,dataType:l.Providers.CallServiceGateway.Constants.JSON_DATA_TYPE,crossDomain:!0,headers:{Accept:c.CSA_CALL,"Content-Type":c.CSA_CALL_PREFERENCE}}},buildActivateServiceOptions:function(e){var t=l.Base.Utils.parseUrl(e),i=t.protocol+s+t.host;return{urlSuffix:t.path?t.path:"",url:i,sendType:l.Providers.CallServiceGateway.Constants.HTTP_POST,crossDomain:!0,headers:{Accept:c.CSA_SERVICES,"Content-Type":c.CSA_SERVICES}}},buildActivateServiceData:function(e,t){var i={action:l.Providers.CallServiceGateway.CallActionType.ACTIVATE,service:e,extendedData:{mode:l.Providers.CallServiceGateway.Constants.COMPUTER,mediaServiceType:l.Providers.CallServiceGateway.Constants.WEBRTC,register:t.isRegisterUser()}};if(t.getMinBandwidth()&&(i.extendedData.videoBandwidth=t.getMinBandwidth()),t.getVideoChannelGuidelines()){var a=t.getVideoChannelGuidelines();i.extendedData.videoChannelGuidelines={},a.requiredDirection&&(i.extendedData.videoChannelGuidelines.requiredClientLegDirections=l.Providers.CallServiceGateway.Utils.convertToChannelGuideLine(a.requiredDirection)),a.permittedDirection&&(i.extendedData.videoChannelGuidelines.permittedLogicalDirections=l.Providers.CallServiceGateway.Utils.convertToChannelGuideLine(a.permittedDirection)),i.extendedData.audioChannelGuidelines={requiredClientLegDirections:l.Providers.CallServiceGateway.Utils.convertToChannelGuideLine(l.Services.Call.MediaDirection.SEND_RECV)}}return i},buildDeactivateServiceOptions:function(e){var t=l.Base.Utils.parseUrl(e),i=t.protocol+s+t.host;return{urlSuffix:t.path?t.path:"",url:i,sendType:l.Providers.CallServiceGateway.Constants.HTTP_POST,crossDomain:!0,headers:{Accept:c.CSA_SERVICES,"Content-Type":c.CSA_SERVICES}}},buildDeactivateServiceData:function(e){return{action:l.Providers.CallServiceGateway.CallActionType.DEACTIVATE,service:e,extendedData:{mode:l.Providers.CallServiceGateway.Constants.COMPUTER,mediaServiceType:l.Providers.CallServiceGateway.Constants.WEBRTC,recoveryToken:null,register:!1}}},buildResourceDiscoveryOptions:function(e){return{urlSuffix:e||l.Providers.CallServiceGateway.Constants.CSA_RESOURCE_PATH,sendType:l.Providers.CallServiceGateway.Constants.HTTP_GET,dataType:l.Providers.CallServiceGateway.Constants.JSON_DATA_TYPE,crossDomain:!0,headers:{Accept:[c.CSA_RESOURCE,c.CSA_ERROR].join(", ")}}},buildResourceDiscoveryData:function(e){var t={};return e&&(t.existingclientid=e),t},buildUpdateCallOptions:function(e,t){var i,a=l.Base.Utils.parseUrl(e);if(a){var r=a.protocol+s+a.host;i={urlSuffix:(a.path?a.path:"")+"/"+t,url:r,sendType:l.Providers.CallServiceGateway.Constants.HTTP_POST,dataType:l.Providers.CallServiceGateway.Constants.TEXT_DATA_TYPE,crossDomain:!0,headers:{"Content-Type":c.CSA_CALL_ACTION}}}return i},buildGetCallsOptions:function(e){var t=l.Base.Utils.parseUrl(e),i=t.protocol+s+t.host;return{urlSuffix:t.path?t.path:"",url:i,sendType:l.Providers.CallServiceGateway.Constants.HTTP_GET,dataType:l.Providers.CallServiceGateway.Constants.JSON_DATA_TYPE,crossDomain:!0,headers:{Accept:[c.CSA_CALLS,c.CSA_ERROR].join(", ")}}},buildGetCallOptions:function(e,t){var i=l.Base.Utils.parseUrl(e),a=i.protocol+s+i.host;return{urlSuffix:i.path?i.path:"",url:a+"/"+t,sendType:l.Providers.CallServiceGateway.Constants.HTTP_GET,dataType:l.Providers.CallServiceGateway.Constants.JSON_DATA_TYPE,crossDomain:!0,headers:{Accept:[c.CSA_CALL,c.CSA_ERROR].join(", ")}}},buildGetClientsOptions:function(e){var t=l.Base.Utils.parseUrl(e),i=t.protocol+s+t.host;return{urlSuffix:t.path?t.path:"",url:i,sendType:l.Providers.CallServiceGateway.Constants.HTTP_GET,dataType:l.Providers.CallServiceGateway.Constants.JSON_DATA_TYPE,crossDomain:!0,headers:{Accept:[c.CSA_CLIENTS,c.CSA_ERROR].join(", ")}}},buildGetClientOptions:function(e,t){var i=l.Base.Utils.parseUrl(e),a=i.protocol+s+i.host;return{urlSuffix:i.path?i.path:"",url:a+"/"+t,sendType:l.Providers.CallServiceGateway.Constants.HTTP_GET,dataType:l.Providers.CallServiceGateway.Constants.JSON_DATA_TYPE,crossDomain:!0,headers:{Accept:[c.CSA_CLIENT,c.CSA_ERROR].join(", ")}}},buildKeepAliveOptions:function(e){var t={crossDomain:!0};return l.Base.Utils.isUndefined(e)||l.Base.Utils.isDefined(e.credentialProvider)&&"string"==typeof e.credentialProvider.username&&"string"==typeof e.credentialProvider.password&&(t.authentication={type:l.Config.Authentication.Scheme.BASIC,username:e.credentialProvider.username,password:e.credentialProvider.password}),t},buildDeleteSessionOptions:function(e){var t=l.Base.Utils.parseUrl(e),i=t.protocol+s+t.host;return{urlSuffix:t.path?t.path:"",url:i,sendType:l.Providers.CallServiceGateway.Constants.HTTP_DELETE,crossDomain:!0}},buildSubscribeRequest:function(e,t){return{subscribe:{requestId:this._generateRequestId(),resources:[{application:l.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:e,resource:t}],version:l.Providers.CallServiceGateway.Constants.CSA_VERSION_1}}},buildUnsubscribeRequest:function(e,t){return{unsubscribe:{requestId:this._generateRequestId(),resources:[{application:l.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:e,resource:t}],version:l.Providers.CallServiceGateway.Constants.CSA_VERSION_1}}},buildSubscribeGenericEventsOptions:function(e){return this._generateGenericEventsOptions(e,l.Providers.CallServiceGateway.Constants.HTTP_POST,l.Providers.CallServiceGateway.Constants.CONTENT_TYPE_SUBSCRIBE_GENERIC_EVENTS,l.Providers.CallServiceGateway.Constants.JSON_DATA_TYPE)},buildUnsubscribeGenericEventsOptions:function(e,t){var i=this._generateGenericEventsOptions(e,l.Providers.CallServiceGateway.Constants.HTTP_DELETE,l.Providers.CallServiceGateway.Constants.CONTENT_TYPE_UNSUBSCRIBE_GENERIC_EVENTS,l.Providers.CallServiceGateway.Constants.TEXT_DATA_TYPE);return i.urlSuffix=i.urlSuffix+"?sessionId="+t,i},buildUpdateGenericEventsOptions:function(e){return this._generateGenericEventsOptions(e,l.Providers.CallServiceGateway.Constants.HTTP_PUT,l.Providers.CallServiceGateway.Constants.CONTENT_TYPE_SUBSCRIBE_GENERIC_EVENTS,l.Providers.CallServiceGateway.Constants.JSON_DATA_TYPE)},buildNotificationsOptions:function(){return{dataType:"JSON",headers:{"Content-Type":"application/json"}}},buildProcessMediaOfferResponseNotification:function(e,t,i,a,r,s,n){var o={action:i,actionDetails:{targetCallId:null,participants:null,sdpType:a.toUpperCase(),sdp:r,audioChannel:l.Base.Utils.isDefined(s)?s:null,videoChannels:l.Base.Utils.isDefined(n)?n:null,conferenceData:null}};return{notify:{requestId:this._generateRequestId(),notifications:[{application:l.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:l.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,version:l.Providers.CallServiceGateway.Constants.CSA_VERSION_1,resource:e,contents:{callId:t,messageType:l.Providers.CallServiceGateway.Constants.PROCESS_MEDIA_RESPONSE,messageDataType:c.CSA_CALL_ACTION,messageData:JSON.stringify(o)}}]}}},buildRejectOfferResponseNotification:function(e,t,i,a,r){var s={error:[{errorCode:i,errorMsg:a,displayMsg:r}]};return{notify:{requestId:this._generateRequestId(),notifications:[{application:l.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:l.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,version:l.Providers.CallServiceGateway.Constants.CSA_VERSION_1,resource:e,contents:{callId:t,messageType:l.Providers.CallServiceGateway.Constants.PROCESS_MEDIA_RESPONSE,messageDataType:c.CSA_ERROR,messageData:JSON.stringify(s)}}]}}},buildProcessMediaAnswerResponseNotification:function(e,t,i,a){return{notify:{requestId:this._generateRequestId(),notifications:[{application:l.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:l.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,version:l.Providers.CallServiceGateway.Constants.CSA_VERSION_1,resource:e,contents:{callId:t,messageType:l.Providers.CallServiceGateway.Constants.PROCESS_MEDIA_RESPONSE,messageDataType:null,messageData:null}}]}}},buildCreateMediaResponseNotification:function(e,t,i,a,r,s){var n={action:null,actionDetails:{targetCallId:null,participants:null,sdpType:i.toUpperCase(),sdp:a,audioChannel:l.Base.Utils.isDefined(r)?r:null,videoChannels:l.Base.Utils.isDefined(s)?s:null,conferenceData:null}};return{notify:{requestId:this._generateRequestId(),notifications:[{application:l.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:l.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,version:l.Providers.CallServiceGateway.Constants.CSA_VERSION_1,resource:e,contents:{callId:t,messageType:l.Providers.CallServiceGateway.Constants.CREATE_MEDIA_RESPONSE,messageDataType:c.CSA_CALL_ACTION,messageData:JSON.stringify(n)}}]}}},buildUpdateMediaRequestNotification:function(e,t,i,a,r,s){var n=!!s,o={action:i,actionDetails:{targetCallId:null,participants:null,sdpType:null,sdp:null,audioChannel:l.Base.Utils.isDefined(a)?a:null,videoChannels:l.Base.Utils.isDefined(r)?r:null,conferenceData:null,forceIceRestart:n}};return{notify:{requestId:this._generateRequestId(),notifications:[{application:l.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:l.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,version:l.Providers.CallServiceGateway.Constants.CSA_VERSION_1,resource:e,contents:{callId:t,messageType:l.Providers.CallServiceGateway.Constants.PROCESS_MEDIA_REQUEST,messageDataType:c.CSA_CALL_ACTION,messageData:JSON.stringify(o)}}]}}},buildGetConfigurationOptions:function(e){return{url:e,sendType:"GET",dataType:"JSON",headers:{Accept:[c.CSA_CONFIGURATION,c.CSA_ERROR].join(", ")}}},buildAcceptCallResponse:function(e,t,i){return{notify:{requestId:l.Base.Utils.isDefined(i)&&null!==i?i:this._generateRequestId(),notifications:[{application:l.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:l.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,version:l.Providers.CallServiceGateway.Constants.CSA_VERSION_1,resource:e,contents:{callId:t,messageType:l.Providers.CallServiceGateway.Constants.ACCEPT_CALL_RESPONSE,messageDataType:null,messageData:null}}]}}},buildRejectCallResponse:function(e,t,i){return{notify:{requestId:l.Base.Utils.isDefined(i)&&null!==i?i:this._generateRequestId(),notifications:[{application:l.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:l.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,version:l.Providers.CallServiceGateway.Constants.CSA_VERSION_1,resource:e,contents:{callId:t,messageType:l.Providers.CallServiceGateway.Constants.REJECT_CALL_RESPONSE,messageDataType:null,messageData:null}}]}}},buildCreatePubSubContainerOptions:function(e){return{url:e,sendType:l.Providers.CallServiceGateway.Constants.HTTP_POST,dataType:l.Providers.CallServiceGateway.Constants.TEXT_DATA_TYPE,headers:{Accept:[c.CSA_PRESENCE_CONTAINER,c.CSA_ERROR].join(", "),"Content-Type":c.CSA_PRESENCE_CONTAINER}}},buildDeletePubSubContainerOptions:function(e){return{url:e,sendType:l.Providers.CallServiceGateway.Constants.HTTP_DELETE,headers:{Accept:c.CSA_ERROR}}},buildCreateOrExtendPubSubContainerData:function(e,t,i){if(!e||t||i)return JSON.stringify({pubSubContainer:{additionalResources:{presencePublication:t?{}:m,presenceSubscriptions:i?[{}]:m}}})},buildPublishPresenceOptions:function(e){return{url:e,sendType:"PUT",headers:{Accept:[c.CSA_ERROR,c.CSA_PRESENCE_PUBLICATION].join(", "),"Content-Type":c.CSA_PRESENCE_PUBLICATION}}},buildDeleteManualPresenceOptions:function(e){return{url:e,sendType:"DELETE",headers:{Accept:c.CSA_ERROR}}},buildPublishManualPresenceData:function(e,t){var i={presencePublication:{}};return e===l.Providers.CallServiceGateway.Constants.MANUAL_STATE?i.presencePublication.manualState={stateEnum:l.Providers.CallServiceGateway.Utils.convertPresenceStateToCSGPresenceState(t)}:e===l.Providers.CallServiceGateway.Constants.MODE?i.presencePublication.mode={modeEnum:l.Providers.CallServiceGateway.Utils.convertPresenceModeToCSGPresenceMode(t)}:e===l.Providers.CallServiceGateway.Constants.NOTE&&(i.presencePublication.note={content:t}),JSON.stringify(i)},buildPublishAutoPresenceData:function(e){var t=[],i=e.getEnterpriseIMState(),a=e.getEnterpriseIMContact(),r=e.getVideoState(),s=e.getVideoContact(),n=e.getPhoneState(),o=e.getPhoneContact(),c=l.Services.Presence.PresenceState;return r&&r!==c.PRESENCE_STATE_UNSPECIFIED&&t.push({channel:"video",contact:s,stateEnum:l.Providers.CallServiceGateway.Utils.convertPresenceStateToCSGPresenceState(r),subType:l.Providers.CallServiceGateway.Constants.AVAYA_COMMUNICATOR}),i&&i!==c.PRESENCE_STATE_UNSPECIFIED&&t.push({channel:"im",contact:a,stateEnum:l.Providers.CallServiceGateway.Utils.convertPresenceStateToCSGPresenceState(i),subType:l.Providers.CallServiceGateway.Constants.AVAYA_COMMUNICATOR}),n&&n!==c.PRESENCE_STATE_UNSPECIFIED&&t.push({channel:"phone",contact:o,stateEnum:l.Providers.CallServiceGateway.Utils.convertPresenceStateToCSGPresenceState(n),subType:l.Providers.CallServiceGateway.Constants.AVAYA_COMMUNICATOR}),JSON.stringify({presencePublication:{channelPresence:t}})},buildPresenceSubscriptionData:function(e,t){var i=[];return t.forEach(function(e){i.push({userIdentity:{userId:e}})}),JSON.stringify({resourceList:{listDefaults:{action:e,aclConfirmHandling:"prompt",docType:"full"},presentities:i}})},buildPresenceSubscriptionOptions:function(e){return{url:e,sendType:"POST",dataType:"JSON",headers:{Accept:[c.CSA_ERROR,c.CSA_PRESENCE_RESOURCE_LIST].join(", "),"Content-Type":c.CSA_PRESENCE_RESOURCE_LIST}}},buildUpdateCallPropertiesNotification:function(e,t,i,a,r){var s={sessionId:i,videoChannels:l.Base.Utils.isDefined(a)?a:null};return a&&0!==a.length&&(r.localVideoMute?s.videoChannels[0].localVideoMute=r.localVideoMute:s.videoChannels[0].localVideoMute=null,r.preferredReceiveResolution?s.videoChannels[0].preferredReceiveResolution=r.preferredReceiveResolution:s.videoChannels[0].preferredReceiveResolution=null,s.videoChannels[0].maxFrames=null,s.videoChannels[0].bandwidth=null),{notify:{requestId:this._generateRequestId(),notifications:[{application:l.Providers.CallServiceGateway.Constants.CSA_APPLICATION,service:l.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,version:l.Providers.CallServiceGateway.Constants.CSA_VERSION_1,resource:e,contents:{callId:t,messageType:l.Providers.CallServiceGateway.Constants.UPDATE_CALL_PROPERTIES,messageDataType:c.MPAAS_CALL_PROPERTIES,messageData:JSON.stringify(s)}}]}}},_generateRequestId:function(){return"jscsdk.csg.req-"+this._requestCounter++},_isFirefoxBrowser:function(){var e=l.Base.Utils.getBrowserType();return e===l.Base.BrowserType.FIREFOX||e===l.Base.BrowserType.FIREFOX_EXTENSION},_generateCommonGenericEventsOptions:function(e){var t=l.Base.Utils.parseUrl(e),i=t.protocol+s+t.host;return{urlSuffix:t.path?t.path:"",url:i,sendType:m,dataType:m,headers:m,crossDomain:!0}},_generateGenericEventsOptions:function(e,t,i,a){var r=this._generateCommonGenericEventsOptions(e);return r.dataType=a,r.sendType=t,r.headers={"Content-type":i},r}},l.Providers.CallServiceGateway.CallServiceGatewayProviderMessageBuilder=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.CallServiceGateway.CSGNotificationEventType={CAS_NOTIFICATION:"CASNotification",PING:"Ping"}}(),function(e){"use strict";AvayaClientServices.Providers.CallServiceGateway.CSGToneType={RINGBACK:"ringback",INTERCEPT:"intercept",REORDER:"reorder",FASTBUSY:"fastBusy"}}(),function(e){"use strict";AvayaClientServices.Providers.CallServiceGateway.CallActionType={ACCEPT_AUDIO:"ACCEPT_AUDIO",ACCEPT_VIDEO:"ACCEPT_VIDEO",ACTIVATE:"ACTIVATE",ADD_PARTICIPANT:"ADD_PARTICIPANT",ADD_VIDEO:"ADD_VIDEO",ANSWER:"ANSWER",DEACTIVATE:"DEACTIVATE",DENY_AUDIO:"DENY_AUDIO",DENY_VIDEO:"DENY_VIDEO",END:"END",HOLD:"HOLD",INCOMING_ADD_VIDEO:"INCOMING_ADD_VIDEO",JOIN:"JOIN",MUTE_VIDEO:"MUTE_VIDEO",UNMUTE_VIDEO:"UNMUTE_VIDEO",REMOVE_VIDEO:"REMOVE_VIDEO",REMOTE_VIDEO_REMOVED_ACK:"REMOTE_VIDEO_REMOVED_ACK",RINGING:"RINGING",TRANSFER:"TRANSFER",UNHOLD:"UNHOLD",UPDATE_VIDEO:"UPDATE_VIDEO"}}(),function(e){"use strict";AvayaClientServices.Providers.CallServiceGateway.Constants={TELEPHONY_SERVICE:"telephony",CSA_APPLICATION:"CSA",CREATE_MEDIA_RESPONSE:"createMediaResponse",PROCESS_MEDIA_REQUEST:"processMediaRequest",PROCESS_MEDIA_RESPONSE:"processMediaResponse",ACCEPT_CALL_RESPONSE:"acceptCallResponse",REJECT_CALL_RESPONSE:"rejectCallResponse",UPDATE_CALL_PROPERTIES:"updatecallproperties",MUTE_VIDEO:"muteVideo",UNMUTE_VIDEO:"unmuteVideo",HTTP:"HTTP",HTTP_POST:"POST",HTTP_GET:"GET",HTTP_DELETE:"DELETE",HTTP_PUT:"PUT",HTTP_BAD_REQUEST:400,JSON_DATA_TYPE:"json",TEXT_DATA_TYPE:"text",CSA_RESOURCE_PATH:"/csa/resources/tenants/default",CSA_VERSION_1:"1",COMPUTER:"COMPUTER",CALLS:"CALLS",PRESENCE:"PRESENCE",WEBRTC:"WEBRTC",STANDARD:"STANDARD",SEND:"SEND",RECEIVE:"RECEIVE",SEND_ONLY:"SEND_ONLY",RECV_ONLY:"RECEIVE_ONLY",SEND_RECV:"SEND_RECEIVE",INACTIVE:"INACTIVE",ENABLE:"ENABLE",DISABLE:"DISABLE",SDP_TYPE_ANSWER:"answer",SDP_TYPE_OFFER:"offer",ACTIVATED:"activated",CALL_STATE_FAILURE_ERROR_CODE:4220072,CALL_DOES_NOT_EXISTS:4040009,SVC_PRESENCE:"presence",MANUAL_STATE:"manualState",STATE:"state",MODE:"mode",NOTE:"note",SUBSCRIPTION_ADD:"add",SUBSCRIPTION_REMOVE:"remove",STATUS_ACTIVE:"active",AVAYA_COMMUNICATOR:"AVAYA_COMMUNICATOR",RESOURCE_DISCOVERY_USERNAME_MISMATCH:"Mismatch username",MWI_ON:"ON",MWI_OFF:"OFF",CLIENT_SESSION_EXPIRED:"CLIENT_SESSION_EXPIRED",DEACTIVATED_BY_CLIENT:"DEACTIVATED_BY_CLIENT",GUEST_SESSION_EXPIRED:"GUEST_SESSION_EXPIRED",PERMANENT_REGISTRATION_FAILURE:"PERMANENT_REGISTRATION_FAILURE",REGISTRATION_TERMINATED:"REGISTRATION_TERMINATED",USER_DOES_NOT_MATCH:"USER_DOES_NOT_MATCH",TEMPORARY_REGISTRATION_FAILURE:"TEMPORARY_REGISTRATION_FAILURE",CONTENT_TYPE_SUBSCRIBE_GENERIC_EVENTS:"application/vnd.avaya.mpaas.eventsubscription+json",CONTENT_TYPE_UNSUBSCRIBE_GENERIC_EVENTS:"application/json"}}(),function(e){"use strict";AvayaClientServices.Providers.CallServiceGateway.ResourceType={Users:"users",Clients:"clients",Calls:"calls",Services:"services",KeepAlive:"keepalive",SessionManagement:"sessionManagement",Websocket:"websocket",SSE:"sse",iViewToken:"iviewtoken",RestSessionMgmt:"RestSessionMgmt",ClientKeepAlive:"ClientKeepAlive",ClientTerminate:"ClientTerminate",Configuration:"configuration",FastDelete:"fastDelete",UploadLogs:"upload-logs",PresenceSubscriptions:"presence-subscriptions",PresencePublications:"presence-publications",CreatePresenceContainer:"CreatePresenceContainer",PublishPresenceState:"PublishPresenceState",PublishPresenceMode:"PublishPresenceMode",PublishPresenceNote:"PublishPresenceNote",DeletePresenceState:"DeletePresenceState",DeletePresenceMode:"DeletePresenceMode",DeletePresenceNote:"DeletePresenceNote"}}(),function(t){"use strict";var r=t.Providers.CallServiceGateway.Constants;t.Providers.CallServiceGateway.Utils={convertToAudioChannel:function(e,t){var i=null;return e&&((i={channelId:e.id}).state=e.enabled?r.ENABLE:r.DISABLE,i.direction=this.convertToChannelDirection(e.direction),t?i.logicalDirection=this.convertToChannelDirection(t.getLogicalDirection()):e._logicalDirection&&(i.logicalDirection=this.convertToChannelDirection(e._logicalDirection))),i},convertToVideoChannels:function(e,i){var a=[];return e&&e.forEach(function(e){if(e){var t={channelId:e.id};t.state=e.enabled?r.ENABLE:r.DISABLE,t.direction=this.convertToChannelDirection(e.direction),i?t.logicalDirection=this.convertToChannelDirection(i.getLogicalDirection()):e._logicalDirection&&(t.logicalDirection=this.convertToChannelDirection(e._logicalDirection)),a.push(t)}}.bind(this)),a},convertToVideoChannelGuidelines:function(e){var t={};return e&&(e.getRequiredDirection()&&(t.requiredClientLegDirections=this.convertToChannelGuideLine(e.getRequiredDirection())),e.getPermittedDirection()&&(t.permittedLogicalDirections=this.convertToChannelGuideLine(e.getPermittedDirection()))),t},convertToChannelDirection:function(e){switch(e){case t.Services.Call.MediaDirection.SEND_ONLY:return r.SEND_ONLY;case t.Services.Call.MediaDirection.RECV_ONLY:return r.RECV_ONLY;case t.Services.Call.MediaDirection.SEND_RECV:return r.SEND_RECV;default:return r.INACTIVE}},convertToChannelGuideLine:function(e){switch(e){case t.Services.Call.MediaDirection.SEND_ONLY:return[r.SEND];case t.Services.Call.MediaDirection.RECV_ONLY:return[r.RECEIVE];case t.Services.Call.MediaDirection.SEND_RECV:return[r.SEND,r.RECEIVE];default:return[]}},convertToAudioStream:function(e,t){var i=null;return e&&((i={id:e.channelId}).enabled=e.state===r.ENABLE,i.direction=this.convertToMediaDirection(e.direction),t&&e.logicalDirection&&(i._logicalDirection=this.convertToMediaDirection(e.logicalDirection))),i},convertToVideoStreams:function(e,i){var a=[];return e&&e.forEach(function(e){if(e){var t={id:e.channelId};t.enabled=e.state===r.ENABLE,t.direction=this.convertToMediaDirection(e.direction),t.maxHeight=e.maxHeight,t.maxWidth=e.maxWidth,t.maxFrames=e.maxFrames,i&&e.logicalDirection&&(t._logicalDirection=this.convertToMediaDirection(e.logicalDirection)),a.push(t)}}.bind(this)),a},convertToMediaDirection:function(e){switch(e){case r.SEND_ONLY:return t.Services.Call.MediaDirection.SEND_ONLY;case r.RECV_ONLY:return t.Services.Call.MediaDirection.RECV_ONLY;case r.SEND_RECV:return t.Services.Call.MediaDirection.SEND_RECV;default:return t.Services.Call.MediaDirection.INACTIVE}},convertAlertType:function(e){switch(e){case"ALERT_TYPE_UNSPECIFIED":return t.Services.Call.AlertType.UNSPECIFIED;case"ALERT_TYPE_NONE":return t.Services.Call.AlertType.NONE;case"ALERT_TYPE_INTERNAL":return t.Services.Call.AlertType.INTERNAL;case"ALERT_TYPE_EXTERNAL":return t.Services.Call.AlertType.EXTERNAL;case"ALERT_TYPE_PRIORITY":return t.Services.Call.AlertType.PRIORITY;case"ALERT_TYPE_INTERCOM":return t.Services.Call.AlertType.INTERCOM;case"ALERT_TYPE_AUTO_CALLBACK":return t.Services.Call.AlertType.AUTO_CALLBACK;case"ALERT_TYPE_HOLD_RECALL":return t.Services.Call.AlertType.HOLD_RECALL;case"ALERT_TYPE_DIRECT_AGENT_CALL_INTERNAL":return t.Services.Call.AlertType.DIRECT_AGENT_CALL_INTERNAL;case"ALERT_TYPE_DIRECT_AGENT_CALL_EXTERNAL":return t.Services.Call.AlertType.DIRECT_AGENT_CALL_EXTERNAL;case"ALERT_TYPE_DIRECT_AGENT_CALL_PRIORITY":return t.Services.Call.AlertType.DIRECT_AGENT_CALL_PRIORITY;case"ALERT_TYPE_AUTOMATIC_CALL_DISTRIBUTION_INTERNAL":return t.Services.Call.AlertType.AUTOMATIC_CALL_DISTRIBUTION_INTERNAL;case"ALERT_TYPE_AUTOMATIC_CALL_DISTRIBUTION_EXTERNAL":return t.Services.Call.AlertType.AUTOMATIC_CALL_DISTRIBUTION_EXTERNAL;default:return t.Base.Logger.info(t.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Unhandled alert type: "+e),t.Services.Call.AlertType.UNSPECIFIED}},convertErrorCode:function(e){switch(e){case 4010001:return t.Services.Call.CallError.NOT_AUTHORIZED;case 4010003:return t.Services.Call.CallError.UNAUTHORIZED;case 4040009:return t.Services.Call.CallError.NOT_FOUND;case 4040011:return t.Services.Call.CallError.SESSION_ID_NOT_FOUND;case 4040013:return t.Services.Call.CallError.SESSION_ID_ALREADY_CONNECTED;case 4220072:return t.Services.Call.CallError.CALL_STATE_MISMATCH;case 4220078:return t.Services.Call.CallError.MEDIA_PRESERVED;case 5000010:return t.Services.Call.CallError.USER_NOT_FOUND;case 5000022:return t.Services.Call.CallError.BUSY;case 5000036:return t.Services.Call.CallError.VIDEO_DENIED;default:return t.Services.Call.CallError.INTERNAL_ERROR}},convertPresenceStateToCSGPresenceState:function(e){switch(e){case t.Services.Presence.PresenceState.PRESENCE_STATE_AVAILABLE:return t.Providers.CallServiceGateway.CSGPresenceState.AVAILABLE;case t.Services.Presence.PresenceState.PRESENCE_STATE_AWAY:return t.Providers.CallServiceGateway.CSGPresenceState.AWAY;case t.Services.Presence.PresenceState.PRESENCE_STATE_BUSY:return t.Providers.CallServiceGateway.CSGPresenceState.BUSY;case t.Services.Presence.PresenceState.PRESENCE_STATE_DO_NOT_DISTURB:return t.Providers.CallServiceGateway.CSGPresenceState.DO_NOT_DISTURB;case t.Services.Presence.PresenceState.PRESENCE_STATE_OFFLINE:return t.Providers.CallServiceGateway.CSGPresenceState.OFFLINE;case t.Services.Presence.PresenceState.PRESENCE_STATE_ON_A_CALL:return t.Providers.CallServiceGateway.CSGPresenceState.ON_A_CALL;case t.Services.Presence.PresenceState.PRESENCE_STATE_OUT_OF_OFFICE:return t.Providers.CallServiceGateway.CSGPresenceState.OUT_OF_OFFICE;default:return m}},convertCSGPresenceStateToPresenceState:function(e){switch(e){case t.Providers.CallServiceGateway.CSGPresenceState.AVAILABLE:return t.Services.Presence.PresenceState.PRESENCE_STATE_AVAILABLE;case t.Providers.CallServiceGateway.CSGPresenceState.AWAY:return t.Services.Presence.PresenceState.PRESENCE_STATE_AWAY;case t.Providers.CallServiceGateway.CSGPresenceState.BUSY:return t.Services.Presence.PresenceState.PRESENCE_STATE_BUSY;case t.Providers.CallServiceGateway.CSGPresenceState.DO_NOT_DISTURB:return t.Services.Presence.PresenceState.PRESENCE_STATE_DO_NOT_DISTURB;case t.Providers.CallServiceGateway.CSGPresenceState.OFFLINE:return t.Services.Presence.PresenceState.PRESENCE_STATE_OFFLINE;case t.Providers.CallServiceGateway.CSGPresenceState.ON_A_CALL:return t.Services.Presence.PresenceState.PRESENCE_STATE_ON_A_CALL;case t.Providers.CallServiceGateway.CSGPresenceState.OUT_OF_OFFICE:return t.Services.Presence.PresenceState.PRESENCE_STATE_OUT_OF_OFFICE;default:return t.Services.Presence.PresenceState.PRESENCE_STATE_UNSPECIFIED}},convertPresenceModeToCSGPresenceMode:function(e){switch(e){case t.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_HOME:return t.Providers.CallServiceGateway.CSGPresenceMode.HOME;case t.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_MOBILE:return t.Providers.CallServiceGateway.CSGPresenceMode.MOBILE;case t.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_OFFICE:return t.Providers.CallServiceGateway.CSGPresenceMode.OFFICE;case t.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_TRAVELING:return t.Providers.CallServiceGateway.CSGPresenceMode.TRAVELING;default:return m}},convertCSGPresenceModeToPresenceMode:function(e){switch(e){case t.Providers.CallServiceGateway.CSGPresenceMode.HOME:return t.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_HOME;case t.Providers.CallServiceGateway.CSGPresenceMode.MOBILE:return t.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_MOBILE;case t.Providers.CallServiceGateway.CSGPresenceMode.OFFICE:return t.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_OFFICE;case t.Providers.CallServiceGateway.CSGPresenceMode.TRAVELING:return t.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_TRAVELING;default:return t.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_UNSPECIFIED}}}}(AvayaClientServices),function(e){"use strict";function t(e,t,i){this._registerUser=e||!1,this._minBandwidth=t||null,this._videoChannelGuidelines=i}t.prototype={isRegisterUser:function(){return this._registerUser},getMinBandwidth:function(){return this._minBandwidth},getVideoChannelGuidelines:function(){return this._videoChannelGuidelines}},e.Providers.CallServiceGateway.ServiceActivationParameters=t}(AvayaClientServices),function(e){"use strict";e.Providers.CallServiceGateway.AbstractCallMessage=function(){this.type=e.Providers.CallServiceGateway.CallMessageTypes.UNDEFINED}}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.CallServiceGateway.CallMessageTypes={UNDEFINED:"Undefined",SUBSCRIPTION:"Subscription",USER_CLIENTS:"UserClients",PROCESS_MEDIA_REQUEST:"ProcessMediaRequest"}}(),function(e){"use strict";function t(){this.vmnumber=m}t.prototype={},e.Providers.CallServiceGateway.ConfigurationMessage=t}(AvayaClientServices),function(e){"use strict";function t(){this.expires=m,this.containerResources={container:{get:{method:m,href:m},updateOrExtend:{method:m,href:m},delete:{method:m,href:m}}},this.additionalResources={presencePublication:{replace:{method:m,href:m}},presenceSubscriptions:[{update:{method:m,href:m},replace:{method:m,href:m}}]}}t.prototype={},e.Providers.CallServiceGateway.CSGPresenceContainer=t}(AvayaClientServices),function(e){"use strict";function t(){this.presenceDoc={userIdentity:{userId:m}},this.presenceSummary={stateEnum:m},this.manualState={stateEnum:m},this.mode={modeEnum:m},this.note={content:m},this.channelPresence=[]}t.prototype={},e.Providers.CallServiceGateway.CSGPresenceDocument=t}(AvayaClientServices),function(e){"use strict";e.Providers.CallServiceGateway.CSGPresenceState={AVAILABLE:"AVAILABLE",BUSY:"BUSY",DO_NOT_DISTURB:"DO_NOT_DISTURB",ON_A_CALL:"ON_A_CALL",AWAY:"AWAY",OUT_OF_OFFICE:"OUT_OF_OFFICE",OFFLINE:"OFFLINE"};e.Providers.CallServiceGateway.CSGPresenceMode={OFFICE:"OFFICE",HOME:"HOME",MOBILE:"MOBILE",TRAVELING:"TRAVELING"}}(AvayaClientServices),function(e){"use strict";function t(){this.applications=[],this.capabilities=[],this.commandURL=m,this.sessionManagement={href:m,timeout:m}}t.prototype={},e.Providers.CallServiceGateway.NotificationResources=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.CallServiceGateway.AbstractCallMessage.call(this),this.type=i.Providers.CallServiceGateway.CallMessageTypes.PROCESS_MEDIA_REQUEST,this.callId=e,this.sdp=t}e.prototype=Object.create(i.Providers.CallServiceGateway.AbstractCallMessage.prototype),i.Providers.CallServiceGateway.ProcessMediaRequestMessage=e}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.CallServiceGateway.AbstractCallMessage.call(this),this.type=t.Providers.CallServiceGateway.CallMessageTypes.CALLINFO,this.registrationId=e,this.href=m,this.mode="Computer"}e.prototype=Object.create(t.Providers.CallServiceGateway.AbstractCallMessage.prototype),t.Providers.CallServiceGateway.RegistrationInfoMessage=e}(AvayaClientServices),function(e){"use strict";function t(){this.resources={avayaRequestTimeout:{maximum:m,minimum:m,recommended:m},capabilities:[],clientId:m,notificationService:{websocket:{href:m},sse:{href:m}},resources:[],sessionManagement:{href:m,timeout:m,username:m},clientManagement:{timeout:m}}}t.prototype={},e.Providers.CallServiceGateway.RestResources=t}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.CallServiceGateway.AbstractCallMessage.call(this),this.type=t.Providers.CallServiceGateway.CallMessageTypes.SUBSCRIPTION,this.isSubscribed=!1,this.subscriptionId=e,this.application=m,this.service=m,this.resource=m}e.prototype=Object.create(t.Providers.CallServiceGateway.AbstractCallMessage.prototype),t.Providers.CallServiceGateway.SubscriptionCallMessage=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.CallServiceGateway.UserClient=function(e){this.clientId=e,this.version=m,this.endpointLabel=m,this.productName=m}}(),function(e){"use strict";function t(){e.Providers.CallServiceGateway.AbstractCallMessage.call(this),this.type=e.Providers.CallServiceGateway.CallMessageTypes.USER_CLIENTS,this._clients=[]}(t.prototype=Object.create(e.Providers.CallServiceGateway.AbstractCallMessage.prototype)).add=function(e){this._clients.push(e)},t.prototype.getClients=function(){return this._clients},e.Providers.CallServiceGateway.UserClientsMessage=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.CallServiceGateway.ObservableEvents={ANSWER_CALL_REQUEST:"csgwprovider.answerCallRequest",CREATE_MEDIA_REQUEST:"csgwprovider.createMediaRequest",CALL_ENDED:"csgwprovider.call.ended",CALL_ESTABLISHED:"csgwprovider.call.established",CALL_FAILURE:"csgwprovider.call.failure",CALL_HELD:"csgwprovider.call.held",CALL_INCOMING:"csgwprovider.call.incoming",CALL_RINGING:"csgwprovider.call.ringing",CALL_STATE_FAILURE:"csgwprovider.call.stateFailure",CALL_UNHELD:"csgwprovider.call.unheld",CALLS_SERVICE_ACTIVATED:"csgwprovider.callsActivated",CALLS_SERVICE_DEACTIVATED:"csgwprovider.callsDeactivated",ICE_CONFIG_UPDATES:"csgwprovider.ice.config.updates",IVIEW_TOKEN_UPDATE:"csgwprovider.iviewTokenUpdate",MAKE_CALL_REQUEST:"csgwprovider.makeCallRequeset",MAX_NETWORK_RECONNECTION_ATTEMPTED:"csgwprovider.maxReconnectionAttempted",NETWORK_PROVIDER_IS_AVAILABLE:"csgwprovider.network.available",NETWORK_PROVIDER_IS_UNAVAILABLE:"csgwprovider.network.unavailable",PROCESS_ANSWER_REQUEST:"csgwprovider.processAnswerRequest",RINGBACK_TONE_URLS_CHANGED:"csgwprovider.ringbackToneUrlsChanged",SUPPORTED_CALL_ENHANCEMENTS:"csgwprovider.supportedCallEnhancements",TERMINATE_CALL_REQUEST:"csgwprovider.terminateCallRequest",UPDATE_TRANSFER_STATUS:"csgwprovider.update.transferStatus",UPDATE_CALL_DATA:"csgwprovider.update.callData",UPDATE_CALL_REQUEST:"csgwprovider.update.callRequest",UPDATE_CONSULT_CONFERENCE_STATUS:"csgwprovider.update.consultConferenceStatus",UPLOAD_LOGS_UPDATE:"csgwprovider.uploadlogs",VIDEO_LICENSE_UPDATED:"csgwprovider.videoLicenceUpdated"}}(),function(i){"use strict";function e(){}e.prototype={parse:function(e){var t=new i.Providers.Interfaces.Call;return t.callId=e.callId,t.capabilities=e.capabilities,t}},i.Providers.CallServiceGateway.CallInfoParser=e}(AvayaClientServices),function(e){"use strict";function t(e){this._callInfoParser=e}t.prototype={parse:function(e){for(var t=[],i=0;i<e.calls.length;i++)t.push(this._callInfoParser.parse(e.calls[i]));return t}},e.Providers.CallServiceGateway.ClientCallsParser=t}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return T.extend(new t.Providers.CallServiceGateway.ConfigurationMessage,e)}},t.Providers.CallServiceGateway.ConfigurationParser=e}(AvayaClientServices),function(T){"use strict";function e(e){this._provider=e}e.prototype={parse:function(t){var e,i,a,r=T.Base.Utils.isDefined(t.messageData)?JSON.parse(t.messageData):m;switch(t.messageType){case T.Providers.CallServiceGateway.NotificationType.CallFailure:var s=T.Base.Utils.queryJSONObject(r,"error[0].errorCode"),n=T.Providers.CallServiceGateway.Utils.convertErrorCode(s),o=T.Base.Utils.queryJSONObject(r,"error[0].displayMsg");s===T.Providers.CallServiceGateway.Constants.CALL_STATE_FAILURE_ERROR_CODE?this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.CALL_STATE_FAILURE,[t.callId,n,T.Services.Call.CallProtocolType.APPLICATION,s,o]):this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.CALL_FAILURE,[t.callId,n,T.Services.Call.CallProtocolType.APPLICATION,s,o]);break;case T.Providers.CallServiceGateway.NotificationType.IncomingCall:e=T.Base.Utils.queryJSONObject(r,"actionDetails.userToUserData.UCID"),i=T.Base.Utils.queryJSONObject(r,"actionDetails.userToUserData.parentUCID"),a=T.Base.Utils.queryJSONObject(r,"actionDetails.userToUserData.contextId"),this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.CALL_INCOMING,[t.callId,r.actionDetails.participants[0].remoteAddress,r.actionDetails.participants[0].remoteDisplayName,r.actionDetails.avayaAsserted,r.actionDetails.private,T.Providers.CallServiceGateway.Utils.convertAlertType(r.actionDetails.alertType),r.actionDetails.sdpType,r.actionDetails.sdp,T.Providers.CallServiceGateway.Utils.convertToAudioStream(r.actionDetails.audioChannel,this._provider.getCallProvider().isSolutionSupportsNailedUpConnection()),T.Providers.CallServiceGateway.Utils.convertToVideoStreams(r.actionDetails.videoChannels,this._provider.getCallProvider().isSolutionSupportsNailedUpConnection()),r.actionDetails.subject,r.actionDetails.videoBandwidth,e,i,a,this.processTurnData(r.actionDetails.turnData)]);break;case T.Providers.CallServiceGateway.NotificationType.CallRinging:var c=!1,l=T.Base.Utils.queryJSONObject(t,"alertingTypeEarlyMedia");T.Base.Utils.isDefined(l)&&("boolean"==typeof l?c=l:"string"==typeof l&&(c="true"===l.toLowerCase())),this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.CALL_RINGING,[t.callId,r.actionDetails.participants[0].remoteAddress,r.actionDetails.participants[0].remoteDisplayName,r.actionDetails.avayaAsserted,r.actionDetails.private,T.Providers.CallServiceGateway.Utils.convertAlertType(r.actionDetails.alertType),c,T.Providers.CallServiceGateway.Utils.convertToAudioStream(r.actionDetails.audioChannel,this._provider.getCallProvider().isSolutionSupportsNailedUpConnection()),T.Providers.CallServiceGateway.Utils.convertToVideoStreams(r.actionDetails.videoChannels,this._provider.getCallProvider().isSolutionSupportsNailedUpConnection())]);break;case T.Providers.CallServiceGateway.NotificationType.CallEstablished:var d,C,u=T.Base.Utils.queryJSONObject(r,"actionDetails.conferenceData.conference");u&&(d=r.actionDetails.conferenceData.uccpUrl),C=T.Base.Utils.queryJSONObject(r,"actionDetails.conferenceData.webCollaborationUrl"),e=T.Base.Utils.queryJSONObject(r,"actionDetails.userToUserData.UCID"),i=T.Base.Utils.queryJSONObject(r,"actionDetails.userToUserData.parentUCID"),a=T.Base.Utils.queryJSONObject(r,"actionDetails.userToUserData.contextId");var v=[t.callId,r.actionDetails.participants[0].remoteAddress,r.actionDetails.participants[0].remoteDisplayName,r.actionDetails.subject,r.actionDetails.remote,r.actionDetails.private,r.actionDetails.alertType,r.actionDetails.avayaAsserted,T.Providers.CallServiceGateway.Utils.convertToAudioStream(r.actionDetails.audioChannel,this._provider.getCallProvider().isSolutionSupportsNailedUpConnection()),T.Providers.CallServiceGateway.Utils.convertToVideoStreams(r.actionDetails.videoChannels,this._provider.getCallProvider().isSolutionSupportsNailedUpConnection()),u,d,C,r.actionDetails.videoBandwidth,e,i,a];this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.CALL_ESTABLISHED,v);break;case T.Providers.CallServiceGateway.NotificationType.CallHeld:this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.CALL_HELD,[t.callId]);break;case T.Providers.CallServiceGateway.NotificationType.CallUnheld:this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.CALL_UNHELD,[t.callId]);break;case T.Providers.CallServiceGateway.NotificationType.CallEnded:var h=!1;if(t.endCallReason)try{var p=JSON.parse(t.endCallReason);if(p){var _=new T.Providers.Call.CallReason(p.reasonProtocol,p.reasonCode,p.reasonText);this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.CALL_ENDED,[t.callId,_]),h=!0}}catch(e){T.Base.Logger.error(T.Base.LoggerTags.CALL_PROVIDER,"Failed to parse end call reason: "+t.endCallReason)}h||this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.CALL_ENDED,[t.callId]);break;case T.Providers.CallServiceGateway.NotificationType.CreateMediaRequest:this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.CREATE_MEDIA_REQUEST,[t.callId,r.action,T.Providers.CallServiceGateway.Utils.convertToAudioStream(r.actionDetails.audioChannel,this._provider.getCallProvider().isSolutionSupportsNailedUpConnection()),T.Providers.CallServiceGateway.Utils.convertToVideoStreams(r.actionDetails.videoChannels,this._provider.getCallProvider().isSolutionSupportsNailedUpConnection()),r.actionDetails.videoBandwidth,this.processTurnData(r.actionDetails.turnData)]);break;case T.Providers.CallServiceGateway.NotificationType.ProcessMediaRequest:this.processMediaRequestHandler(t.callId,r.action,r.actionDetails.sdpType,r.actionDetails.sdp,T.Providers.CallServiceGateway.Utils.convertToAudioStream(r.actionDetails.audioChannel,this._provider.getCallProvider().isSolutionSupportsNailedUpConnection()),T.Providers.CallServiceGateway.Utils.convertToVideoStreams(r.actionDetails.videoChannels,this._provider.getCallProvider().isSolutionSupportsNailedUpConnection()),r.actionDetails.videoBandwidth,this.processTurnData(r.actionDetails.turnData),r.actionDetails.forceIceRestart);break;case T.Providers.CallServiceGateway.NotificationType.ProcessMediaResponse:this.processMediaResponseHandler(t.callId,r.action,r.actionDetails.sdpType,r.actionDetails.sdp,T.Providers.CallServiceGateway.Utils.convertToAudioStream(r.actionDetails.audioChannel,this._provider.getCallProvider().isSolutionSupportsNailedUpConnection()),T.Providers.CallServiceGateway.Utils.convertToVideoStreams(r.actionDetails.videoChannels,this._provider.getCallProvider().isSolutionSupportsNailedUpConnection()));break;case T.Providers.CallServiceGateway.NotificationType.UpdateTransferStatus:this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.UPDATE_TRANSFER_STATUS,[t.callId,t.transferStatus]);break;case T.Providers.CallServiceGateway.NotificationType.UpdateCallData:var S,g,f=r.actionDetails.participants[0],E=T.Base.Utils.queryJSONObject(r,"actionDetails.conferenceData.conference"),A=!1;T.Base.Utils.isDefined(E)&&("boolean"==typeof E?A=E:"string"==typeof E&&(A="true"===E.toLowerCase()),S=r.actionDetails.conferenceData.uccpUrl,g=r.actionDetails.conferenceData.webCollaborationUrl),e=T.Base.Utils.queryJSONObject(r,"actionDetails.userToUserData.UCID"),i=T.Base.Utils.queryJSONObject(r,"actionDetails.userToUserData.parentUCID"),a=T.Base.Utils.queryJSONObject(r,"actionDetails.userToUserData.contextId"),this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.UPDATE_CALL_DATA,[t.callId,f.remoteAddress,f.remoteDisplayName,A,S,g,e,i,a]);break;case T.Providers.CallServiceGateway.NotificationType.MWIStatusChanged:var P=t.status;P===T.Providers.CallServiceGateway.Constants.MWI_OFF||P===T.Providers.CallServiceGateway.Constants.MWI_ON?this._provider.setVoicemailMWI(P):T.Base.Logger.warn(T.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received MWIStatusChanged notification in invalid format");break;case T.Providers.CallServiceGateway.NotificationType.EndpointConfigurationUpdate:this._provider.setVoicemailNumber(t.voiceMailNumber),this._provider.trigger(T.Providers.Interfaces.VoiceMessagingProviderCallbackIds.VOICEMAIL_NUMBER_CHANGED,[t.voiceMailNumber]),t.IPVideoEnable&&this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.VIDEO_LICENSE_UPDATED,["true"===t.IPVideoEnable]);break;case T.Providers.CallServiceGateway.NotificationType.AddParticipantStatus:this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.UPDATE_CONSULT_CONFERENCE_STATUS,[t.callId,t.status]);break;case T.Providers.CallServiceGateway.NotificationType.AnswerCallRequest:this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.ANSWER_CALL_REQUEST,[t.callId,t.requestId]);break;case T.Providers.CallServiceGateway.NotificationType.TerminateCallRequest:this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.TERMINATE_CALL_REQUEST,[t.callId,t.requestId]);break;case T.Providers.CallServiceGateway.NotificationType.UpdateCallRequest:this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.UPDATE_CALL_REQUEST,[t.callId,t.requestId,t.callactiontype]);break;case T.Providers.CallServiceGateway.NotificationType.MakeCallRequest:e=T.Base.Utils.queryJSONObject(r,"actionDetails.userToUserData.UCID"),i=T.Base.Utils.queryJSONObject(r,"actionDetails.userToUserData.parentUCID"),a=T.Base.Utils.queryJSONObject(r,"actionDetails.userToUserData.contextId"),this._provider.trigger(T.Providers.CallServiceGateway.ObservableEvents.MAKE_CALL_REQUEST,[t.callId,t.dialToAddress,t.requestId,e,i,a]);break;case T.Providers.CallServiceGateway.NotificationType.ServiceStatusChanged:this._provider.activateService(t.service,t.status,t.deactivationReason);break;case T.Providers.CallServiceGateway.NotificationType.NetworkEvents:this._provider.networkEventNotification(r);break;default:T.Base.Logger.info(T.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Ignoring telephony notification: [Id:"+t.callId+",Type:"+t.messageType+"]")}},processMediaRequestHandler:function(e,t,i,a,r,s,n,o,c){if(T.Base.Logger.debug(T.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received Process Media Request: ["+t+","+i+"]"),i&&i.toLowerCase()===T.Providers.CallServiceGateway.Constants.SDP_TYPE_ANSWER)this._provider.getCallProvider().answerSDP(e,t,a,r,s,n);else if(a)this._provider.getCallProvider().offerSDP(e,t,a,r,s,n,o);else{var l=!1;T.Base.Utils.isDefined(c)&&(l=c),this._provider.getCallProvider().getOfferSDP(e,t,r,s,n,o,l)}},processMediaResponseHandler:function(e,t,i,a,r,s){T.Base.Logger.debug(T.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received Process Media Response: "+i),T.Base.Utils.isDefined(a)&&null!==a?i&&i.toLowerCase()===T.Providers.CallServiceGateway.Constants.SDP_TYPE_ANSWER?this._provider.getCallProvider().answerSDP(e,t,a,r,s):T.Base.Logger.info(T.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Unhandled SDP from process media response for ["+t+","+i+"]"):this._provider.getCallProvider().answerSdpAck(e,t,r,s)},processTurnData:function(e){if(e){var t=e.turnAddressDetails.turnAddress,i=e.sessionId,a=e.accessToken,r="relay";T.Base.Utils.isDefined(e.forceTurn)&&!1===e.forceTurn&&(r="all");for(var s=[],n=0;n<e.turnAddressDetails.turnTypesPriorities.length;n++){var o=e.turnAddressDetails.turnTypesPriorities[n],c=o.turnAddress||t,l="turn",d=o.port,C=o.transportType;"tls"===o.transportType&&(l="turns",C="tcp");var u=new T.Providers.Call.TurnTransportType(c,l,C,d);this._provider.getCallProvider()._isTurnTlsHasHighestPriority()&&u._setTlsToHighestPriority(!0),s.push(u)}return new T.Providers.Call.TurnData(i,a,t,s,r)}return m}},T.Providers.CallServiceGateway.NotificationParser=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.CallServiceGateway.NotificationType={CreateMediaRequest:"createMediaRequest",ProcessMediaRequest:"processMediaRequest",ProcessMediaResponse:"processMediaResponse",IncomingCall:"callIncoming",CallRinging:"callRinging",CallEstablished:"callEstablished",CallEnded:"callEnded",CallFailure:"callFailure",CallHeld:"onCallRemoteHeld",CallUnheld:"onCallRemoteUnheld",UpdateTransferStatus:"updateTransferStatus",UpdateCallData:"updateCallData",MWIStatusChanged:"MWIStatusChanged",EndpointConfigurationUpdate:"EndpointConfigurationUpdate",AddParticipantStatus:"addParticipantStatus",AnswerCallRequest:"answerCallRequest",AnswerCallResponse:"answerCallResponse",TerminateCallRequest:"terminateCallRequest",UpdateCallRequest:"updateCallRequest",MakeCallRequest:"makeCallRequest",ServiceStatusChanged:"serviceStatusChanged",NetworkEvents:"mpaasevents"}}(),function(r){"use strict";function e(){}e.prototype={parse:function(e){for(var t=new r.Providers.CallServiceGateway.UserClientsMessage,i=0;i<e.clients.length;i++){var a=this.parseClient(e.clients[i]);t.add(a)}return t},parseClient:function(e){var t=new r.Providers.CallServiceGateway.UserClient(e.clientId);return t.version=e.version,t.endpointLabel=e.endpointLabel,t.productName=e.productName,t}},r.Providers.CallServiceGateway.UserClientsParser=e}(AvayaClientServices),function(t){"use strict";t.Providers.ContentSharing.BandwidthManager=function(e){this._serverManager=e,this._queue=[],this._intervals=[],this._run=!1,this._minimalInterval=100,this._lastIntervalsToConsiderCount=10,this._maxBytesPerSecond=37500,this._bytesSentLastSecond=0,this._queueSize=0,this._sendTimeout=m},t.Providers.ContentSharing.BandwidthManager.prototype={start:function(e){this._interval=e.captureInterval,this._maxBytesPerSecond=e.maxBytesPerSecond;for(var t=0;t<this._lastIntervalsToConsiderCount;t++)this._intervals.push(e.captureInterval);this._serverManager.onBandwidthAvailable=function(){this._process()}.bind(this),this._serverManager.start(e)},stop:function(){var e=T.Deferred();return this._queue=[],this._queueSize=0,this._serverManager.stop(),clearTimeout(this._sendTimeout),e.resolve(),e.promise()},addToQueue:function(e){if(e._keyFrame){this._lostSize=0,this._queue.forEach(function(e){this._lostSize+=e.byteLength}.bind(this));var t=(this._bytesSentLastSecond+this._lostSize)/this._maxBytesPerSecond;this._intervals.push(Math.floor(this._interval*t)),this._determineInterval(),this._queue=[],this._queue.push(e)}else this._queue.push(e);this._queueSize=this._queue.reduce(function(e,t){return e+t.byteLength},0),this._run||(this._run=!0,this._process())},getQueueDelay:function(){var e=this._queueSize/this._maxBytesPerSecond;return 1.25<e&&(e*=.95),e},getQueueMaxDelay:function(){return 1.25},onIntervalChanged:function(e){},setMaxUploadSpeed:function(e){this._maxBytesPerSecond=e/8*1e3},_determineInterval:function(){for(var e=0,t=this._intervals.length-this._lastIntervalsToConsiderCount;t<this._intervals.length;t++)e+=this._intervals[t];var i=e/this._lastIntervalsToConsiderCount;i<this._minimalInterval&&(i=this._minimalInterval),this._interval=Math.floor(i),this.onIntervalChanged(this._interval)},_process:function(){t.Base.Logger.debug(t.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Current screen sharing queue size: "+this._queueSize+" bytes.");var e=this._queue.shift();e?this._serverManager.canSend(e.byteLength)?(t.Base.Logger.debug(t.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Sending "+e.byteLength+" bytes from screen sharing queue."),this._send(e),this._process()):this._queue.unshift(e):this._run=!1},_send:function(e){this._serverManager.send(e),this._bytesSentLastSecond+=e.getByteLength(),this._sendTimeout=setTimeout(function(){this._bytesSentLastSecond-=e.getByteLength()}.bind(this),1e3)}}}(AvayaClientServices),function(n){"use strict";function e(){this._jpegImageQuality=.35}e.prototype={createStartTag:function(e,t,i){var a=new n.Providers.WCS.ScreenSharingStartTag;return a.isKeyFrame=e,a.width=t,a.height=i,a.creationTime=Date.now(),a},createBlockTag:function(e){var t=new n.Providers.WCS.ScreenSharingBlockTag;t.x=e._x,t.y=e._y,t.width=e._width,t.height=e._height;var i=this._jpegImageQuality;e._type?(e._type===n.Providers.WCS.ScreenSharingImageTypes.JPEG_RED_WITH_BLACK&&(e._type=n.Providers.WCS.ScreenSharingImageTypes.JPEG,i=Math.max(.8,i)),t.imageType=e._type):t.imageType=n.Providers.WCS.ScreenSharingImageTypes.JPEG;var a=this._getImageData(e,e._type,i);return t.length=a.length,t.data=a,t},createEndTag:function(){return new n.Providers.WCS.ScreenSharingEndTag},_getImageData:function(e,t,i){var a=document.createElement("canvas");a.width=e._width,a.height=e._height,a.getContext("2d").putImageData(e._imgData,0,0);var r=t===n.Providers.WCS.ScreenSharingImageTypes.JPEG?"jpeg":"png",s=a.toDataURL("image/"+r,i);return this._getImageBuffer(s)},_getImageBuffer:function(e){for(var t=e.split(","),i=atob(t[1]),a=i.length,r=new Uint8Array(a);a--;)r[a]=i.charCodeAt(a);return r},setJpegImageQuality:function(e){e&&(this._jpegImageQuality=e)}},n.Providers.ContentSharing.ContentSharingTagBuilder=e}(AvayaClientServices),function(i,a){"use strict";var r="SCREEN_SHARING",s="PONG",n="START",o="Chrome",c="Firefox",e="message",l="CANCELED";i.Providers.ContentSharing.ExtensionNetworkProvider=function(e){this._pingTimer=m,this._pingTime=0,this._pongTime=0,this._pingInterval=500,this._requestBuilder=e,this._installedExtensionType=i.Providers.ContentSharing.InstalledExtensionType.INVALID,this._onMediaAvailableCallbacks=T.Callbacks(),this._onCapabilityChangeCallbacks=T.Callbacks(),this._onMediaCancelledCallbacks=T.Callbacks(),this._listenerFunction=m,this._isExtensionAvailable=!1},i.Providers.ContentSharing.ExtensionNetworkProvider.prototype={setExtensionAvailable:function(e){this._isExtensionAvailable=e,this._onCapabilityChangeCallbacks.fire(i.Providers.ContentSharing.InstalledExtensionType.CHROME,this._isExtensionAvailable)},start:function(){this._startWindowEventListener(),this._startPingTask()},send:function(e){a.postMessage(e,"*")},stop:function(){this._stopPingTimer(),this._removeWindowEventListener()},addOnMediaAvailableCallback:function(e){this._onMediaAvailableCallbacks.add(e)},removeOnMediaAvailableCallback:function(e){this._onMediaAvailableCallbacks.remove(e)},addOnMediaCancelledCallback:function(e){this._onMediaCancelledCallbacks.add(e)},removeOnMediaCancelledCallback:function(e){this._onMediaCancelledCallbacks.remove(e)},addOnCapabilityChange:function(e){this._onCapabilityChangeCallbacks.add(e)},removeOnCapabilityChange:function(e){this._onCapabilityChangeCallbacks.remove(e)},getInstalledExtensionType:function(){return this._installedExtensionType},_stopPingTimer:function(){this._pingTimer&&a.clearTimeout(this._pingTimer)},_startWindowEventListener:function(){this._listenerFunction=function(e){if(e.source===a&&e.data.type)if(e.data.type===n)this._onMediaAvailableCallbacks.fire(e);else if(e.data.type===l)this._onMediaCancelledCallbacks.fire(e);else if(e.data.type===s&&e.data.app===r){this._pongTime=Date.now();var t=this._installedExtensionType;e.data.extension===o?this._installedExtensionType=i.Providers.ContentSharing.InstalledExtensionType.CHROME:e.data.extension===c&&(this._installedExtensionType=i.Providers.ContentSharing.InstalledExtensionType.FIREFOX),t!==i.Providers.ContentSharing.InstalledExtensionType.CHROME&&t!==i.Providers.ContentSharing.InstalledExtensionType.FIREFOX&&(this._onCapabilityChangeCallbacks.fire(this._installedExtensionType,!0),this._pingInterval=2e3)}}.bind(this),a.addEventListener(e,this._listenerFunction,!1),this._pingTime=Date.now(),this.send(this._requestBuilder.createPingRequest()),i.Base.Logger.debug(i.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Started receiving pings from extension")},_removeWindowEventListener:function(){a.removeEventListener(e,this._listenerFunction,!1),i.Base.Logger.debug(i.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Stopped receiving pings from extension")},_startPingTask:function(){this._pingTimer&&a.clearTimeout(this._pingTimer),this._pingTimer=a.setTimeout(function(){if(0===this._pongTime&&this._installedExtensionType===i.Providers.ContentSharing.InstalledExtensionType.INVALID)this._installedExtensionType=i.Providers.ContentSharing.InstalledExtensionType.NOT_INSTALLED,this._onCapabilityChangeCallbacks.fire(this._installedExtensionType,!1),this._pingInterval=2e3<=this._pingInterval?2e3:Math.max(2e3,2*this._pingInterval);else if(this._pingTime-this._pongTime>this._pingInterval&&(this._installedExtensionType===i.Providers.ContentSharing.InstalledExtensionType.CHROME||this._installedExtensionType===i.Providers.ContentSharing.InstalledExtensionType.FIREFOX)){var e=this._installedExtensionType;this._installedExtensionType=i.Providers.ContentSharing.InstalledExtensionType.NOT_INSTALLED,this._onCapabilityChangeCallbacks.fire(e,!1)}this._pingTime=Date.now(),!0===this._isExtensionAvailable?this._pongTime=Date.now():this.send(this._requestBuilder.createPingRequest()),this._startPingTask()}.bind(this),this._pingInterval)}}}(AvayaClientServices,window),function(e){"use strict";var t="SCREEN_SHARING_PAGE",i="STOP",a="START",r="PING";function s(){}s.prototype={createStartSharingRequest:function(e){return{type:t,text:a,capture:e}},createStopSharingRequest:function(e){return{type:t,text:i,mediaSourceId:e}},createPingRequest:function(){return{type:t,text:r}}},e.Providers.ContentSharing.ExtensionRequestBuilder=s}(AvayaClientServices),function(i){"use strict";i.Providers.ContentSharing.FeatureSupported={isSharingApplicationWindowAvailable:function(){var e=i.Base.Utils.getBrowserType();return e===i.Base.BrowserType.CHROME||e===i.Base.BrowserType.CHROME_EXTENSION||e===i.Base.BrowserType.FIREFOX||e===i.Base.BrowserType.FIREFOX_EXTENSION},isSharingFullScreenAvailable:function(){var e=i.Base.Utils.getBrowserType();return e===i.Base.BrowserType.CHROME||e===i.Base.BrowserType.CHROME_EXTENSION||e===i.Base.BrowserType.FIREFOX||e===i.Base.BrowserType.FIREFOX_EXTENSION},isSharingAnyTypeAvailable:function(){var e=navigator.mediaDevices&&"getDisplayMedia"in navigator.mediaDevices||"getDisplayMedia"in navigator,t=i.Base.Utils.getBrowserType()===i.Base.BrowserType.SAFARI;return!0===e&&!1===t}}}(AvayaClientServices),function(e){"use strict";function t(e){this._blocks=[],this.byteLength=0,this._keyFrame=e}t.prototype={addBlock:function(e){this._blocks.push(e),this.byteLength+=e.byteLength},getBlocks:function(){return this._blocks},getByteLength:function(){return this.byteLength}},e.Providers.ContentSharing.FrameBlocks=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.ContentSharing.InstalledExtensionType={CHROME:"Chrome",FIREFOX:"Firefox",NOT_INSTALLED:"Not Installed",INVALID:"Invalid"}}(),function(c){"use strict";c.Providers.ContentSharing.ScreenBlock=function(e,t,i,a,r,s,n,o){this._x=e,this._y=t,this._row=i,this._column=a,this._height=s,this._width=r,this._imgData=n,this._previousBase64=m,this._blocks=o||[],this._type=c.Providers.WCS.ScreenSharingImageTypes.JPEG}}(AvayaClientServices),function(n){"use strict";function e(e){n.Base.Observable.call(this),this._config=m,this._video=m,this._videoTrack=m,this._screenScraper=e,this._capturingTimeout=m,this._delayInterval=m,this._doNotCapture=!1,this._processTimes=[],this._scale=1,this._oldScale=m}e.prototype=Object.create(n.Base.Observable.prototype),(n.Providers.ContentSharing.ScreenCapturer=e).prototype.start=function(t,e,i){var a=T.Deferred();return this._manuallyStopped=!1,this._doNotCapture=!1,this._config=e,this._doNotCapture=!1,this._delayInterval=m,this._worker=new Worker(this._config.contentSharingWorkerPath),this._worker.postMessage({type:n.Providers.ContentSharing.ScreenCapturerWorkerEvents.INITIALIZE,browser:i,config:e}),this._worker.onerror=function(e){t.getVideoTracks()[0].stop(),a.reject(e)},this._worker.onmessage=function(e){this._handleWorkerMessage(e,a,t)}.bind(this),a.promise()},e.prototype._handleWorkerMessage=function(e,t,i){switch(e.data.type){case n.Providers.ContentSharing.ScreenCapturerWorkerEvents.CHANGED_BLOCKS:this._handleChangedBlocksMessage(e.data);break;case n.Providers.ContentSharing.ScreenCapturerWorkerEvents.WORKER_STARTED:this._handleWorkerStartedMessage(e.data,t,i);break;default:n.Base.Logger.warn(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Unknown message data type received: {0}",e.data.type)}},e.prototype._calculateScale=function(e,t,i,a){var r=1,s=1;return i<e&&(r=i/e),a<t&&(s=a/t),Math.min(r,s)},e.prototype._handleChangedBlocksMessage=function(e){!this._doNotCapture&&0<e.data.length&&(this._processTimes.unshift(e.meta.processingTime),this.trigger(n.Providers.ContentSharing.ScreenCapturerEvents.BLOCKS_CHANGED,[e.data,e.meta.keyFrame])),this._capturingTimeout=setTimeout(function(){this._capture()}.bind(this),this._config.captureInterval)},e.prototype._handleWorkerStartedMessage=function(e,t,i){this._videoTrack=i.getVideoTracks()[0],this._videoTrack.onended=function(){this._manuallyStopped||this.trigger(n.Providers.ContentSharing.ScreenCapturerEvents.WINDOW_CLOSED,[])}.bind(this),this._video=window.document.createElement("video"),this._video.setAttribute("hidden","true"),this._video.srcObject=i,this._video.play(),this._capture(),t.resolve()},e.prototype._getAverageProcessingTime=function(){return 100===this._processTimes.length&&this._processTimes.pop(),this._processTimes.reduce(function(e,t){return e+t/this._processTimes.length}.bind(this),0)},e.prototype.stop=function(){var e=T.Deferred();return this._removeListeners(),this._videoTrack&&(this._manuallyStopped=!0,this._videoTrack.stop(),this._videoTrack=m),this._video&&(this._video.srcObject=null,this._video=m),this._processTimes=[],this._worker&&this._worker.terminate(),clearTimeout(this._capturingTimeout),clearTimeout(this._delayInterval),this._delayInterval=m,e.resolve(),e.promise()},e.prototype.pause=function(){var e=T.Deferred(),t=!0;return this._video&&!this._video.paused&&(t=!1,this._video.pause()),clearTimeout(this._capturingTimeout),clearTimeout(this._delayInterval),this._delayInterval=m,e.resolve(t),e.promise()},e.prototype.getWidth=function(){return this._scale*this._video.videoWidth},e.prototype.getHeight=function(){return this._scale*this._video.videoHeight},e.prototype.resume=function(){var e=T.Deferred(),t=!1;return this._video&&this._video.paused&&(t=!0,this._doNotCapture=!1,this._video.play(),this._capture(!0)),e.resolve(t),e.promise()},e.prototype.delayCapturing=function(e){var t=e-this._getAverageProcessingTime();this._delayInterval||t<=0||(n.Base.Logger.debug(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Delay screen capturing: "+e+"ms"),clearTimeout(this._capturingTimeout),this._doNotCapture=!0,this._delayInterval=setTimeout(function(){n.Base.Logger.debug(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Resuming screen capturing after delay: "+t),this._doNotCapture=!1,this._capture(),this._delayInterval=m}.bind(this),t))},e.prototype._capture=function(e){if(!this._doNotCapture&&this._videoTrack&&"ended"!==this._videoTrack.readyState&&!this._video.paused)if(8<=this._video.videoWidth&&8<=this._video.videoHeight){var t=window.document.createElement("canvas");this._scale=this._calculateScale(this._video.videoHeight,this._video.videoWidth,this._config.maxHeight,this._config.maxWidth);var i=+(this._scale*this._video.videoWidth).toFixed(0),a=+(this._scale*this._video.videoHeight).toFixed(0);t.width=i,t.height=a;var r=t.getContext("2d");1!==this._scale&&(r.scale(this._scale,this._scale),this._scale!==this._oldScale&&(this._oldScale=this._scale,n.Base.Logger.info(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Resolution of shared content is too high. Scaling down from  "+this._video.videoWidth+"x"+this._video.videoHeight+" to "+i+"x"+a))),r.drawImage(this._video,0,0);var s=r.getImageData(0,0,i,a).data;this._worker.postMessage({type:n.Providers.ContentSharing.ScreenCapturerWorkerEvents.SEND_IMAGE_DATA,imgData:s,config:this._config,width:i,height:a,forceKeyFrame:e},[s.buffer])}else this._capturingTimeout=setTimeout(function(){this._capturingTimeout=m,this._capture()}.bind(this),this._config.captureInterval)},e.prototype.setServerCapabilities=function(e){this._config=T.extend({},this._config,e)}}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.ContentSharing.ScreenCapturerConfig=function(){this.captureInterval=100,this.losslessColorLimit=32,this.blockSize=64,this.framesPerKeyFrame=100,this.maxBytesPerSecond=37500,this.maxWidth=1920,this.maxHeight=1080}}(),function(e){"use strict";AvayaClientServices.Providers.ContentSharing.ScreenCapturerEvents={BLOCKS_CHANGED:"blocks_changed",KEY_FRAME:"key_frame",WINDOW_CLOSED:"window_changed"}}(),function(e){"use strict";AvayaClientServices.Providers.ContentSharing.ScreenCapturerWorkerEvents={INITIALIZE:"initialize",CHANGED_BLOCKS:"changedBlocksMessage",SEND_IMAGE_DATA:"wholeImgData",WORKER_STARTED:"workerStarted"}}(),function(h){"use strict";h.Providers.ContentSharing.ScreenScraper=function(){this._previousBlocks=[],this._blockWidth=64,this._blockHeight=64,this._previousBase64=m,this._captureKeyFrame=!1},h.Providers.ContentSharing.ScreenScraper.prototype={getChangedBlocks:function(e,t,i){if(!e.videoWidth)return[];this._blockWidth=t,this._blockHeight=t;var a=window.document.createElement("canvas");a.width=e.videoWidth,a.height=e.videoHeight;var r=a.getContext("2d");r.drawImage(e,0,0);var s=this._determineChangedBlocks(e,r);return 0<s.length&&(s=this._mergeBlocks(s),s=this._determineTypes(s,i)),s},_determineTypes:function(e,i){return e.forEach(function(e){var t=this._getColorsCount(e._imgData);e._type=i<t?h.Providers.WCS.ScreenSharingImageTypes.JPEG:h.Providers.WCS.ScreenSharingImageTypes.PNG}.bind(this)),e},_mergeBlocks:function(e){return e=this._sortByColumn(e),e=this._mergeByColumn(e),e=this._sortByRow(e),(e=this._mergeByRow(e)).map(this._createMergedBlock)},_createMergedBlock:function(t){var e=document.createElement("canvas");e.width=t._width,e.height=t._height;var i=e.getContext("2d");t._blocks.forEach(function(e){i.putImageData(e._imgData,e._x-t._x,e._y-t._y)});var a=i.getImageData(0,0,t._width,t._height);return new h.Providers.ContentSharing.ScreenBlock(t._x,t._y,t._row,t._column,t._width,t._height,a)},_determineChangedBlocks:function(e,t){var i=[],a=[],r=Math.ceil(e.videoHeight/this._blockHeight);if(!this._imageChanged(e,t))return i;for(var s=0;s<e.videoWidth;s+=this._blockWidth)for(var n=s/this._blockWidth,o=s+this._blockWidth>e.videoWidth?e.videoWidth-s:this._blockWidth,c=0;c<e.videoHeight;c+=this._blockHeight){var l=c+this._blockHeight>e.videoHeight?e.videoHeight-c:this._blockHeight,d=t.getImageData(s,c,o,l),C=new h.Providers.ContentSharing.ScreenBlock(s,c,c/this._blockHeight,n,o,l,d);if(C._previousBase64=this._getBase64Image(C._imgData),0<this._previousBlocks.length&&!this._captureKeyFrame){var u=C._column*r+C._row,v=this._previousBlocks[u];v&&v._previousBase64===C._previousBase64||(v._previousBase64=m,a.push(C))}else a.push(C);i.push(C)}return this._captureKeyFrame&&(this._captureKeyFrame=!1),this._previousBlocks=i,a},_imageChanged:function(e,t){var i=!0,a=t.getImageData(0,0,e.videoWidth,e.videoHeight),r=this._getBase64Image(a);return r!==this._previousBase64||this._captureKeyFrame?this._previousBase64=r:i=!1,i},_getColorsCount:function(e){var t,i={},a=new Uint32Array(e.data.buffer),r=0,s=a.length;for(t=0;t<s;t++){var n=""+(16777215&a[t]);i[n]||(i[n]=0,r++),i[n]++}return r},_getBase64Image:function(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").putImageData(e,0,0),t.toDataURL("image/png").replace(/^data:image\/(png|jpg);base64,/,"")},_mergeByColumn:function(e){return this._merge(e,this._compareBlocksByColumn,function(e,t){e._height+=t._height})},_mergeByRow:function(e){return this._merge(e,this._compareBlocksByRow,function(e,t){e._width+=t._width})},_merge:function(e,t,i){for(var a=[],r=this._copyBlock(e[0]),s=1;s<e.length;s++)t(r,e[s])?(0<e[s]._blocks.length?this._copyBlocks(e,s,r):r._blocks.push(e[s]),i(r,e[s])):(a.push(r),r=this._copyBlock(e[s]));return a.push(r),a},_copyBlocks:function(e,t,i){e[t]._blocks.forEach(function(e){i._blocks.push(e)})},_copyBlock:function(e){var t;return 0===e._blocks.length?(t=new h.Providers.ContentSharing.ScreenBlock(e._x,e._y,e._row,e._column,e._width,e._height))._blocks.push(e):t=e,t},_sortByColumn:function(e){return e.sort(function(e,t){return e._column===t._column?e._row-t._row:e._column-t._column})},_sortByRow:function(e){return e.sort(function(e,t){return e._row===t._row?e._column-t._column:e._row-t._row})},_compareBlocksByColumn:function(e,t){return e._x===t._x&&e._width===t._width&&(e._y+e._height===t._y||t._y+t._height===e._y)},_compareBlocksByRow:function(e,t){return e._y===t._y&&e._height===t._height&&(e._x+e._width===t._x||t._x+t._width===e._x)}}}(AvayaClientServices),function(a){"use strict";function e(e,t){this._collaborationProvider=e,this._extensionNetworkProvider=new a.Providers.ContentSharing.ExtensionNetworkProvider(new a.Providers.ContentSharing.ExtensionRequestBuilder),this._screenCapturer=new a.Providers.ContentSharing.ScreenCapturer(new a.Providers.ContentSharing.ScreenScraper),this._extensionRequestBuilder=new a.Providers.ContentSharing.ExtensionRequestBuilder,this._contentSharingTagBuilder=new a.Providers.ContentSharing.ContentSharingTagBuilder;var i=new a.Providers.ContentSharing.ServerManager(e.sendBlocks.bind(e),e.getBufferedAmount.bind(e));t.registerServer(i),this._bandwidthManager=new a.Providers.ContentSharing.BandwidthManager(i),this._screenSharingTagEncoder=new a.Providers.WCS.ScreenSharingTagEncoder}e.prototype={getScreenSharingProvider:function(e){var t=a.Base.Utils.getBrowserType();return t===a.Base.BrowserType.CHROME||t===a.Base.BrowserType.CHROME_EXTENSION?new a.Providers.ContentSharing.ChromeScreenSharingProvider(this._collaborationProvider,this._screenCapturer,this._contentSharingTagBuilder,this._bandwidthManager,this._screenSharingTagEncoder,e,this._extensionNetworkProvider,this._extensionRequestBuilder):t===a.Base.BrowserType.FIREFOX||t===a.Base.BrowserType.FIREFOX_EXTENSION?new a.Providers.ContentSharing.FirefoxScreenSharingProvider(this._collaborationProvider,this._screenCapturer,this._contentSharingTagBuilder,this._bandwidthManager,this._screenSharingTagEncoder,e):t===a.Base.BrowserType.EDGE?new a.Providers.ContentSharing.EdgeScreenSharingProvider(this._collaborationProvider,this._screenCapturer,this._contentSharingTagBuilder,this._bandwidthManager,this._screenSharingTagEncoder,e):new a.Providers.ContentSharing.AbstractScreenSharingProvider(this._collaborationProvider,this._screenCapturer,this._contentSharingTagBuilder,this._bandwidthManager,this._screenSharingTagEncoder,e)}},a.Providers.ContentSharing.ScreenSharingProviderFactory=e}(AvayaClientServices),function(e){"use strict";function t(e,t){this._sentData=0,this._sentDataSum=0,this._maxBytesPerSecond=5e4,this._sendingFunction=e,this._monitoringFunction=t,this._history=[{buffered:0,bufferedSum:0,sent:0,sentSum:0}],this._observationInterval=5,this._onStop=function(){}}t.prototype={start:function(e){this._maxBytesPerSecond=e.maxBytesPerSecond,this._interval=setInterval(function(){var e=this._history[this._history.length-1],t={buffered:this._monitoringFunction()-e.bufferedSum,bufferedSum:this._monitoringFunction(),sent:this._sentDataSum-e.sentSum,sentSum:this._sentDataSum};this._history.push(t)}.bind(this),1e3*this._observationInterval)},getHistory:function(){return this._history},stop:function(){this._onStop(),clearInterval(this._interval)},send:function(e){this._sentDataSum+=e.getByteLength(),this._sentData+=e.getByteLength();var t=e.getByteLength()/this._maxBytesPerSecond*1e3;e.getBlocks().forEach(function(e){this._sendingFunction(e)}.bind(this)),setTimeout(function(){this._sentData-=e.getByteLength(),this.onBandwidthAvailable()}.bind(this),t)},canSend:function(e){return 0===this._sentData||e+this._sentData<=this._maxBytesPerSecond},onBandwidthAvailable:function(){}},e.Providers.ContentSharing.ServerManager=t}(AvayaClientServices),function(t){"use strict";function e(e){t.Base.Observable.call(this),this._networkProvider=e}(e.prototype=Object.create(t.Base.Observable.prototype)).init=function(e){this._networkProvider.init(e)},e.prototype.login=function(e){return this._networkProvider.send({loginId:e.username,password:e.password},{sendType:"GET"}).then(function(e){return this.trigger("focus.login.success",[e]),e}.bind(this),function(e){this.trigger("focus.login.error",[e])}.bind(this))},t.Providers.Focus.FocusProvider=e}(AvayaClientServices),function(e){"use strict";function t(){e.Base.Observable.call(this)}(t.prototype=Object.create(e.Base.Observable.prototype)).start=function(){},t.prototype.stop=function(){},e.Providers.Interfaces.AbstractProvider=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Interfaces.AbstractStream=function(e,t,i){this.type=e,this.id=t,this.enabled=!0,this.direction=i}}(),function(i){"use strict";function e(e,t){i.Providers.Interfaces.AbstractStream.call(this,"audio",e,t)}e.prototype=Object.create(i.Providers.Interfaces.AbstractStream.prototype),i.Providers.Interfaces.AudioStream=e}(AvayaClientServices),function(e){"use strict";function t(){this.callId=m}t.prototype={},e.Providers.Interfaces.Call=t}(AvayaClientServices),function(e){"use strict";function t(){e.Providers.Interfaces.AbstractProvider.call(this)}(t.prototype=Object.create(e.Providers.Interfaces.AbstractProvider.prototype)).accept=function(e,t,i,a){},t.prototype.setVideoMode=function(e,t,i){},t.prototype.ignore=function(){},t.prototype.deny=function(){},t.prototype.hold=function(e){},t.prototype.unhold=function(e){},t.prototype.sendDigits=function(){},t.prototype.getRemoteAddress=function(){},t.prototype.getAccessCode=function(){},t.prototype.getSessionDetails=function(){},t.prototype.isConference=function(){},t.prototype.isIncoming=function(){},t.prototype.canAutoAnswer=function(){},t.prototype.isRemote=function(){},t.prototype.isServiceAvailable=function(){},t.prototype.isCallerIdentityPrivate=function(){},t.prototype.getAlertType=function(){},t.prototype.getSubject=function(){},t.prototype.getState=function(){},t.prototype.join=function(){},t.prototype.addCall=function(e){},t.prototype.addParticipant=function(e){},t.prototype.muteAudio=function(e){},t.prototype.unmuteAudio=function(e){},t.prototype.muteVideo=function(e){},t.prototype.unmuteVideo=function(e){},t.prototype.muteSpeaker=function(e){},t.prototype.unmuteSpeaker=function(e){},t.prototype.updateDevices=function(e,t,i){},e.Providers.Interfaces.CallProvider=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Interfaces.CallProviderCallbackIds={ALLOWED_NAILEDUP_VIDEO_MODES:"allowedNailedUpVideoModes",ANSWER_CALL_REQUESTED:"answerCallRequested",AUDIO_STREAM_UPDATED:"audioStreamUpdated",CALL_STARTED:"callStarted",CALL_RINGING:"callRinging",CALL_ESTABLISHED:"callEstablished",CALL_ESTABLISHING:"callEstablishing",CALL_ENDED:"callEnded",CALL_FAILURE:"callFailure",CALL_SERVICE_AVAILABLE:"callServiceAvailable",CALL_SERVICE_DEACTIVATED:"callServiceDeactivated",CALL_SERVICE_UNAVAILABLE:"callServiceUnavailable",CALL_SERVICE_UNSUPPORTED:"callServiceUnsupported",CALL_MEDIA_FAILED:"callMediaFailed",CONFERENCE_ESCALATION:"conferenceEscalation",ICE_CONNECTION_UPDATE:"iceConnectionUpdate",INCOMING_CALL:"incomingCall",INCOMING_ADD_VIDEO_REQUEST:"incomingAddVideoRequest",INCOMING_ADD_VIDEO_ACCEPTED:"incomingAddVideoAccepted",INCOMING_ADD_VIDEO_DENIED:"incomingAddVideoDenied",INCOMING_ADD_VIDEO_TIMEDOUT:"incomingAddVideoTimedout",INCOMING_HOLD:"incomingHold",INCOMING_UNHOLD:"incomingUnhold",MAKE_CALL_REQUESTED:"makeCallRequested",MAX_NETWORK_RECOVERY_ATTEMPTED:"maxNetworkRecoveryAttempted",MEDIA_CHANNEL_GUIDELINES_AVAILABLE:"mediaChannelGuidelinesAvailable",MEDIA_CHANNEL_GUIDELINES_UNAVAILABLE:"mediaChannelGuidelinesUnavailable",REMOTE_ADDRESS_CHANGED:"remoteAddressChanged",REMOTE_CALL_CREATED:"remoteCallCreated",TERMINATE_CALL_REQUESTED:"terminateCallRequested",UPDATE_CALL_REQUESTED:"updateCallRequested",UPLOAD_LOGS_UPDATE:"uploadLogUpdate",VIDEO_CHANNEL_UPDATE:"videoChannelUpdate",VIDEO_ESCALATION_REJECTED:"videoEscalationRejected",VIDEO_LICENSE_UPDATED:"VIDEO_LICENSE_UPDATED",RINGBACK_TONE_URLS_CHANGED:"RINGBACK_TONE_URLS_CHANGED"}}(),function(e){"use strict";AvayaClientServices.Providers.Interfaces.CallServiceCallbackIds={INCOMING_CALL:"incomingCall",MAKE_CALL_REQUESTED:"makeCallRequested"}}(),function(r){"use strict";function e(e,t,i,a){r.Providers.Interfaces.AbstractStream.call(this,"video",e,t),this.maxHeight=i,this.maxWidth=a,this._logicalDirection=m}e.prototype=Object.create(r.Providers.Interfaces.AbstractStream.prototype),r.Providers.Interfaces.VideoStream=e}(AvayaClientServices),function(e){"use strict";function t(){e.Base.Observable.call(this)}(t.prototype=Object.create(e.Base.Observable.prototype)).start=function(){},t.prototype.stop=function(){},t.prototype.startWhiteboard=function(e){},t.prototype.endWhiteboard=function(e){},t.prototype.addWhiteboardSurface=function(){},t.prototype.removeWhiteboardSurface=function(e){},t.prototype.observeCollaboration=function(){},t.prototype.addCircle=function(){},t.prototype.addShape=function(){},t.prototype.startDrawShape=function(){},t.prototype.discoverResources=function(e){},t.prototype.liveDrawShape=function(){},t.prototype.endDrawShape=function(){},t.prototype.addText=function(){},t.prototype.getReceivingBitrate=function(){},t.prototype.startScreenSharing=function(){},t.prototype.stopScreenSharing=function(){},t.prototype.pauseScreenSharing=function(){},t.prototype.sendBlocks=function(e){},t.prototype.sendLiveEvent=function(e){},t.prototype.removeShape=function(e,t){},t.prototype.clearContent=function(e){},t.prototype.getParticipants=function(){},t.prototype.pause=function(){},t.prototype.resume=function(){},t.prototype.isOpened=function(){},t.prototype.isFeatureAvailable=function(e){},t.prototype.getServerCapabilities=function(){},e.Providers.Interfaces.CollaborationProvider=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Interfaces.CollaborationProviderCallbackIds={SERVER_CAPABILITIES:"server_capabilities"}}(),function(e){"use strict";AvayaClientServices.Providers.Interfaces.ConferenceCallbackIds={NETWORK_PROVIDER_IS_UNAVAILABLE:"NETWORK_PROVIDER_IS_UNAVAILABLE",NETWORK_PROVIDER_IS_AVAILABLE:"NETWORK_PROVIDER_IS_AVAILABLE"}}(),function(e){"use strict";function t(){e.Providers.Interfaces.AbstractProvider.call(this)}(t.prototype=Object.create(e.Providers.Interfaces.AbstractProvider.prototype)).sendHandshake=function(e){},t.prototype.subscribeMeetingInfo=function(e){},t.prototype.subscribeRoster=function(e){},t.prototype.subscribeActiveTalker=function(e){},t.prototype.subscribePermissions=function(e){},t.prototype.subscribeSlider=function(e){},t.prototype.subscribeMeetingNote=function(e){},t.prototype.subscribeWebCollab=function(e){},t.prototype.subscribeAvailableLayouts=function(e){},t.prototype.getCurrentVideoLayout=function(e){},t.prototype.setAsLecturer=function(e,t){},t.prototype.disconnectParticipant=function(e,t){},t.prototype.terminateConference=function(e){},t.prototype.requestToBecomeModerator=function(e,t){},t.prototype.signIn=function(e,t){},t.prototype.videoPin=function(e,t,i,a,r,s){},t.prototype.extendMeeting=function(e,t){},t.prototype.addParticipant=function(e,t){},t.prototype.cancelDialoutParticipant=function(e,t){},t.prototype.unsetAsLecturer=function(e){},t.prototype.controlRemoteCamera=function(e,t,i){},t.prototype.muteUnmute=function(e,t,i,a){},t.prototype.sendChatMessage=function(e,t,i){},t.prototype.muteUnmuteAll=function(e,t){},t.prototype.raiseLowerHand=function(e,t){},t.prototype.moderatorLowerHand=function(e,t,i){},t.prototype.sendModeratorAdmissionRequest=function(e){},t.prototype.sendAdmissionRequest=function(e,t){},e.Providers.Interfaces.ConferenceDataProvider=t}(AvayaClientServices),function(e){"use strict";function t(){e.Providers.Interfaces.AbstractProvider.call(this)}(t.prototype=Object.create(e.Providers.Interfaces.AbstractProvider.prototype)).start=function(e){},t.prototype.observeConference=function(e){},t.prototype.disconnectParticipant=function(e){},t.prototype.setAsLecturer=function(e){},t.prototype.setLocked=function(e){},t.prototype.setVideoLayoutTextOverlay=function(e){},t.prototype.setVideoLayoutSelfSee=function(e){},t.prototype.setVideoLayout=function(e){},t.prototype.terminateConference=function(){},t.prototype.removeLastParticipant=function(){},t.prototype.requestToBecomeModerator=function(e){},t.prototype.signIn=function(e){},t.prototype.videoPin=function(e,t,i,a,r){},t.prototype.extendMeeting=function(e){},t.prototype.addParticipant=function(e){},t.prototype.addParticipantFromCall=function(e){},t.prototype.cancelDialoutParticipant=function(e){},t.prototype.startRecording=function(e,t,i){},t.prototype.stopRecording=function(e){},t.prototype.pauseRecording=function(e){},t.prototype.resumeRecording=function(e){},t.prototype.unsetAsLecturer=function(){},t.prototype.controlRemoteCamera=function(e,t){},t.prototype.muteUnmute=function(e,t,i){},t.prototype.sendChatMessage=function(e,t){},t.prototype.muteUnmuteAll=function(e){},t.prototype.raiseLowerHand=function(e){},t.prototype.moderatorLowerHand=function(e,t){},t.prototype.getDialInInfo=function(){},e.Providers.Interfaces.ConferenceProvider=t}(AvayaClientServices),function(e){"use strict";function t(){e.Providers.Interfaces.AbstractProvider.call(this)}(t.prototype=Object.create(e.Providers.Interfaces.AbstractProvider.prototype)).start=function(e,t){},t.prototype.stop=function(){},t.prototype.getProviderType=function(){},t.prototype.createContactForAdd=function(){},t.prototype.addContact=function(e){},t.prototype.updateContact=function(e){},t.prototype.deleteContact=function(e){},t.prototype.retrieveAllContacts=function(){},t.prototype.getContactsChanges=function(){},t.prototype.getAddContactCapability=function(){},t.prototype.getUpdateContactCapability=function(){},t.prototype.getDeleteContactCapability=function(){},t.prototype.getExtendedContactDetailsCapability=function(){},e.Providers.Interfaces.ContactsProvider=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Interfaces.ContactsProviderCallbackIds={CONTACT_ADDED:"contact_added",CONTACT_UPDATED:"contact_updated",CONTACT_DELETED:"contact_deleted",CAPABILITIES_CHANGED:"capabilities_changed"}}(),function(e){"use strict";function t(){e.Providers.Interfaces.AbstractProvider.call(this)}(t.prototype=Object.create(e.Providers.Interfaces.AbstractProvider.prototype)).start=function(e){},t.prototype.stop=function(){},t.prototype.getProviderType=function(){},t.prototype.startDirectorySearch=function(e){},t.prototype.startResolvingContacts=function(e,t){},t.prototype.stopDirectorySearch=function(e){},t.prototype.getNetworkSearchContactCapability=function(){},t.prototype.getNetworkResolveContactsCapability=function(){},t.prototype.getNetworkSearchTerminalCapability=function(){},t.prototype.getSelfContact=function(){},e.Providers.Interfaces.DirectorySearchProvider=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Interfaces.DirectorySearchProviderCallbackIds={CAPABILITIES_CHANGED:"capabilities_changed"}}(),function(e){"use strict";function t(){e.Providers.Interfaces.AbstractProvider.call(this)}(t.prototype=Object.create(e.Providers.Interfaces.AbstractProvider.prototype)).start=function(e){},t.prototype.logout=function(){},t.prototype.getRoutableDomains=function(){},t.prototype.getConversations=function(e){},t.prototype.getConversationIds=function(e){},t.prototype.getConversationsByQuery=function(e){},t.prototype.discoverResources=function(){},t.prototype.getResources=function(){},t.prototype.validateUsers=function(e){},t.prototype.getParticipants=function(e,t){},t.prototype.sendMessage=function(e,t){},t.prototype.sendMessageWithAttachments=function(e,t,i){},t.prototype.leaveConversation=function(e){},t.prototype.markAllAsRead=function(e){},t.prototype.changeSubject=function(e){},t.prototype.markAsReadBatch=function(e){},t.prototype.getMessages=function(e,t,i,a,r){},t.prototype.reportTyping=function(){},t.prototype.observeConversations=function(){},t.prototype.callEscalationEvent=function(e,t){},t.prototype.setLastAccessTime=function(e,t){},t.prototype.addParticipantsToConversation=function(e,t){},t.prototype.close=function(e){},t.prototype.isStarted=function(){},t.prototype.getMaxImageSize=function(){},t.prototype.getMaxVideoSize=function(){},t.prototype.getMaxAudioSize=function(){},t.prototype.getMaxTextLength=function(){},t.prototype.getMaxGenericAttachmentSize=function(){},e.Providers.Interfaces.MessagingProvider=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Interfaces.MessagingProviderHandlers={CONVERSATIONS_UPDATE:"conversations.update"}}(),function(e){"use strict";function t(){e.Providers.Interfaces.AbstractProvider.call(this)}(t.prototype=Object.create(e.Providers.Interfaces.AbstractProvider.prototype)).start=function(e){},t.prototype.stop=function(){},t.prototype.subscribeForPresence=function(e){},t.prototype.unsubscribeFromPresence=function(e){},t.prototype.unsubscribeFromAllAddressesPresence=function(){},t.prototype.publishManualState=function(e){},t.prototype.publishLocationMode=function(e){},t.prototype.publishNote=function(e){},t.prototype.publishAutomaticPresence=function(e){},e.Providers.Interfaces.PresenceProvider=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Interfaces.PresenceProviderCallbackIds={PRESENCE_NOTIFICATION:"PRESENCE_NOTIFICATION"}}(),function(e){"use strict";function t(){e.Providers.Interfaces.AbstractProvider.call(this)}(t.prototype=Object.create(e.Providers.Interfaces.AbstractProvider.prototype)).getVoicemailNumber=function(){},t.prototype.getVoicemailMWI=function(){},t.prototype.isServiceAvailable=function(){},e.Providers.Interfaces.VoiceMessagingProvider=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.Interfaces.VoiceMessagingProviderCallbackIds={VOICEMAIL_NUMBER_CHANGED:"VOICEMAIL_NUMBER_CHANGED",MWI_STATUS_CHANGED:"MWI_STATUS_CHANGED"}}(),function(i){"use strict";var t="text/plain",a="POST";function e(e,t,i,a,r){this._href=e,this._bucketName=t,this._sessionId=i,this._clientId=a,this._displayName=r}e.prototype={buildMultipartOptions:function(){var e=i.Base.Utils.parseUrl(this._href),t=e.protocol+"://"+e.host;return{urlSuffix:e.path?e.path:"",url:t,contentType:!1,processData:!1,sendType:a,method:a,crossDomain:!0}},buildMultipartData:function(e){var t=new FormData;t.append("metadata",this._buildMetadata());var i=this._buildLogfile(e);return t.append("logfile",i,this._logFilename(".log")),t},buildMultipartDataAsZip:function(e){var t=T.Deferred(),i=new FormData;return i.append("metadata",this._buildMetadata()),this._buildLogfileAsZip(e).then(function(e){i.append("logfile",e,this._logFilename(".zip")),t.resolve(i)}.bind(this),function(e){t.reject(e)}),t.promise()},_buildMetadata:function(){var e={bucketName:this._bucketName,contentType:t,sessionID:this._sessionId};return this._displayName&&(e.displayName=this._displayName),this._clientId&&(e.clientID=this._clientId),JSON.stringify(e)},_buildLogfile:function(e){return new Blob([e],{type:"text/plain; charset=UTF-8"})},_buildLogfileAsZip:function(e){var t=T.Deferred(),i=new JSZip;return i.file("jscsdk_upload.log",e),i.generateAsync({type:"blob",compression:"DEFLATE"}).then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise()},_logFilename:function(e){var t=this._sessionId+"_"+this._clientId;return this._displayName&&(t+="_"+this._trimDisplayName()),t+=e},_trimDisplayName:function(){return this._displayName.replace(/\s/g,"")}},i.Providers.Mpaas.GoogleCloudMessageBuilder=e}(AvayaClientServices),function(o){"use strict";function e(){this.MAX_RETRIES=3,this.RETRY_WAIT_TIME=1e3,this._serverInfo=m,this._href=m,this._messageBuilder=m,this._credentialProvider=m,this._isStarted=!1,this._startPromise=m,this._uploadTimer=m,this._hasPendingUpload=!1,this._restProvider=new o.Base.NetworkProvider(new o.Base.RESTProvider)}(e.prototype={}).start=function(e,t,i,a,r,s){if(this._isStarted){if(this._href===t)return T.Deferred().resolve().promise();var n=T.Deferred();return this._stop().always(function(){this._startProvider().then(function(){n.resolve()},function(e){n.reject(e)})}.bind(this)),n.promise()}return this._serverInfo=e,this._href=t,this._credentialProvider=s,this._messageBuilder=new o.Providers.Mpaas.GoogleCloudMessageBuilder(t,i,a,r,s.getDisplayName()),this._startProvider()},e.prototype.stop=function(){return this._stopProvider()},e.prototype._startProvider=function(){return o.Base.Utils.isUndefined(this._serverInfo)?T.Deferred().reject("Uninitialized remote server").promise():(this._isStarted||(this._isStarted=!0,this._startPromise=T.Deferred(),this._restProvider._onCredentialsRequired=this._onCredentialsRequired.bind(this),this._restProvider.onConnectionUnavailable=function(e){o.Base.Logger.error("Error communicating with upload log server:",e),this._stopProvider()}.bind(this),this._restProvider.onOpen=function(){this._startPromise.resolve()}.bind(this),this._restProvider.onError=function(e){o.Base.Logger.error("Error encountered with upload log server:",e),this._stopProvider()}.bind(this),this._restProvider.on(o.Base.NetworkProviderEvents.UNAUTHORIZED,function(e){o.Base.Logger.error("Unauthorized connection to upload log server:",e),this._stopProvider(),this._startPromise.reject(o.Base.NetworkProviderEvents.UNAUTHORIZED)}.bind(this)),this._restProvider.disableNetworkLogging(),this._restProvider.start(new o.Config.NetworkProviderConfiguration(this._serverInfo),this._credentialProvider)),this._startPromise.promise())},e.prototype._onCredentialsRequired=function(t,e){e&&e!==this._credentialProvider&&o.Base.Utils.deepMerge(this._credentialProvider,e),this._credentialProvider.onAuthenticationChallenge(void 0,function(e){this._onCredentialsRetrieved(e,t)}.bind(this))},e.prototype._onCredentialsRetrieved=function(e,t){o.Base.Utils.isDefined(t.options)&&(t.options.authentication=t.options.authentication||{},e.token?(e.bearer=e.bearer||o.Config.Authentication.TokenType.BEARER,this._credentialProvider.token!==e.token&&(this._credentialProvider.token=e.token),t.options.authentication.type=o.Config.Authentication.Scheme.BEARER,t.options.authentication.token=e.token,t.options.authentication.bearer=e.bearer):(t.options.authentication.type=o.Config.Authentication.Scheme.BASIC,t.options.authentication.username=e.username,t.options.authentication.password=e.password))},e.prototype._stopProvider=function(){return this._uploadTimer&&(clearTimeout(this._uploadTimer),this._uploadTimer=m),this._isStarted?this._restProvider.close().always(function(){this._isStarted=!1}.bind(this)):T.Deferred().reject("LoggerProvider: Provider is not started").promise()},e.prototype.upload=function(e){return this._hasPendingUpload?T.Deferred().reject("There is pending upload").promise():e?this._upload(e,this._sendLogs.bind(this)):T.Deferred().reject("Invalid logs").promise()},e.prototype.uploadZip=function(e){return this._hasPendingUpload?T.Deferred().reject("There is pending upload").promise():e?this._isZipLibraryInstalled()?this._upload(e,this._sendLogsAsZip.bind(this)):(o.Base.Logger.warn("Missing required JSZip library. Will upload as uncompressed file"),this._upload(e,this._sendLogs.bind(this))):T.Deferred().reject("Invalid logs").promise()},e.prototype._isZipLibraryInstalled=function(){return"undefined"!=typeof JSZip},e.prototype._upload=function(e,a){var r=T.Deferred();this._hasPendingUpload=!0;var s=function(t){if(t++>=this.MAX_RETRIES)this._hasPendingUpload=!1,r.reject("Max attempts reached");else{var i=this.RETRY_WAIT_TIME*Math.pow(2,t);this._isStarted?a(e).then(function(){this._hasPendingUpload=!1,r.resolve()}.bind(this),function(e){this._uploadTimer=setTimeout(function(){s(t)},i)}.bind(this)):this._startProvider().then(function(){a(e).then(function(){this._hasPendingUpload=!1,r.resolve()}.bind(this),function(e){this._uploadTimer=setTimeout(function(){s(t)},i)}.bind(this))}.bind(this),function(e){this._uploadTimer=setTimeout(function(){s(t)},i)}.bind(this))}}.bind(this);return s(0),r.promise()},e.prototype._sendLogs=function(e){var t=this._messageBuilder.buildMultipartOptions(),i=this._messageBuilder.buildMultipartData(e);return this._restProvider.send(i,t)},e.prototype._sendLogsAsZip=function(e){var t=T.Deferred(),i=this._messageBuilder.buildMultipartOptions();return this._messageBuilder.buildMultipartDataAsZip(e).then(function(e){this._restProvider.send(e,i).then(function(){t.resolve()},function(e){t.reject(e)})}.bind(this),function(e){t.reject(e)}),t.promise()},o.Providers.Mpaas.LoggerProvider=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.RemoteLogger.CallbackIds={MAX_SIZE_REACHED:"maxSizeReached"}}(),function(s){"use strict";function e(){s.Base.Observable.call(this),this._output="",this._loggingLevel=s.Providers.RemoteLogger.LOGGING_LEVELS.DEBUG,this._loggingEnabled=!0,this.MAX_LOG_SIZE=2097152,this._maxSizeReachedCount=0}(e.prototype=Object.create(s.Base.Observable.prototype)).log=function(e,t){if(this._loggingEnabled)switch(e){case"debug":this._debug(t);break;case"info":this._info(t);break;case"trace":this._trace(t);break;case"warn":this._warn(t);break;case"error":this._error(t);break;case"fatal":this._fatal(t);break;default:this._info(t)}},e.prototype.getOutput=function(){return this._output.substring(0)},e.prototype.getOutputAndClear=function(){var e=this._output.substring(0);return this._output="",e},e.prototype.clear=function(e){this._output=e?this._output.replace(e,""):""},e.prototype.enableLogging=function(e){this._loggingEnabled=e},e.prototype.setLoggingLevel=function(e){this._loggingLevel=e},e.prototype._info=function(e){this._loggingLevel<=s.Providers.RemoteLogger.LOGGING_LEVELS.INFO&&this._prettyPrint("[I]",e)},e.prototype._error=function(e){this._loggingLevel<=s.Providers.RemoteLogger.LOGGING_LEVELS.ERROR&&this._prettyPrint("[E]",e)},e.prototype._fatal=function(e){this._loggingLevel<=s.Providers.RemoteLogger.LOGGING_LEVELS.FATAL&&this._prettyPrint("[F]",e)},e.prototype._debug=function(e){this._loggingLevel<=s.Providers.RemoteLogger.LOGGING_LEVELS.DEBUG&&this._prettyPrint("[D]",e)},e.prototype._trace=function(e){this._loggingLevel<=s.Providers.RemoteLogger.LOGGING_LEVELS.TRACE&&this._prettyPrint("[T]",e)},e.prototype._warn=function(e){this._loggingLevel<=s.Providers.RemoteLogger.LOGGING_LEVELS.WARN&&this._prettyPrint("[W]",e)},e.prototype._prettyPrint=function(e,t){var i=t.shift();this._output+=e+" "+i,0<t.length&&(this._output+=" "+this._format(t)),this._output+="\n";var a=s.Base.Utils.getBytesCount(this._output);if(a>=this.MAX_LOG_SIZE){var r=Math.floor(a/this.MAX_LOG_SIZE);r>this._maxSizeReachedCount&&(this._maxSizeReachedCount=r,this._triggerMaxSizeReached())}else this._maxSizeReachedCount=0},e.prototype._format=function(e){var t="",i=0;return e.forEach(function(e){switch(0!==i&&(t+=" "),typeof e){case"boolean":t+=e?"true":"false";break;case"object":t+=JSON.stringify(e);break;default:t+=e}i++}),t},e.prototype.trim=function(e){e=e||10;var t=this._output.split("\n");this._output=t.slice(e).join("\n")},e.prototype._triggerMaxSizeReached=function(){this.trigger(s.Providers.RemoteLogger.CallbackIds.MAX_SIZE_REACHED,[])},s.Providers.RemoteLogger.Logger=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.RemoteLogger.LOGGING_LEVELS={DEBUG:0,TRACE:1,INFO:2,WARN:3,ERROR:4,FATAL:5}}(),function(e){"use strict";AvayaClientServices.Providers.RemoteLogger.Names={MPAAS:"MPaaS"}}(),function(i){"use strict";function e(){this._logger=new i.Providers.RemoteLogger.Logger,this._uploadProviders={},this._logger.on(i.Providers.RemoteLogger.CallbackIds.MAX_SIZE_REACHED,function(){this.uploadLogs()}.bind(this))}(e.prototype={}).getLogger=function(){return this._logger},e.prototype.getProvider=function(e){var t;if(this._uploadProviders.hasOwnProperty(e))t=this._uploadProviders[e];else switch(e){case i.Providers.RemoteLogger.Names.MPAAS:t=new i.Providers.Mpaas.LoggerProvider,this._uploadProviders[i.Providers.RemoteLogger.Names.MPAAS]=t}return t},e.prototype.uploadLogs=function(e){var t=this._logger.getOutput();if(0===t.length)return T.Deferred().resolve().promise();var i=T.Deferred(),a=[];if(e?this._upload(e,t,a):this._multipleUploads(t,a),0===a.length)i.reject("No upload logger provider found.");else{var r=0,s=0;a.forEach(function(e){e.then(function(){++r+s===a.length&&(this._logger.clear(t),i.resolve())}.bind(this),function(e){r+ ++s===a.length&&(0<r?(this._logger.clear(t),i.resolve()):i.reject(e))}.bind(this))}.bind(this))}return i.promise()},e.prototype._upload=function(e,t,i){if(this._uploadProviders.hasOwnProperty(e)){var a=this._uploadProviders[e];a&&i.push(a.uploadZip(t))}},e.prototype._multipleUploads=function(e,t){for(var i in this._uploadProviders)if(this._uploadProviders.hasOwnProperty(i)){var a=this._uploadProviders[i];a&&t.push(a.uploadZip(e))}},i.Providers.RemoteLogger.RemoteLoggerProvider=e}(AvayaClientServices),function(n){"use strict";function e(){}e.prototype.updateMeetingInfo=function(t,e){var i,a=0<t._activeParticipants.length;if(n.Base.Utils.isDefined(e.eventConference)&&t._eventConference!==e.eventConference&&(t._eventConference=e.eventConference,t._onEventConferenceStatusChangedCallbacks.fire(t,t._eventConference)),e.meetingName&&e.meetingName!==t._subject&&(t._subject=e.meetingName,t._onConferenceSubjectChangedCallbacks.fire(t,e.meetingName)),e.lecturerId&&"none"!==e.lecturerId!==t._isLectureModeActive&&(t._isLectureModeActive="none"!==e.lecturerId,t._onConferenceLectureModeStatusChangedCallbacks.fire(t,t._isLectureModeActive)),e.lecturerId&&e.lecturerId!==t._lecturerId)if(a){var r=t._activeParticipants.filter(function(e){return e._participantId===t._lecturerId})[0];r&&(r._lecturer=!1,r._onParticipantUnsetAsLecturerCallbacks.fire(r)),t._lecturerId=e.lecturerId,(i=t._activeParticipants.filter(function(e){return e._participantId===t._lecturerId})[0])&&(i._lecturer=!0,i._onParticipantSetAsLecturerCallbacks.fire(i))}else t._lecturerId=e.lecturerId;if(e.virtualRoomOwnerId&&e.virtualRoomOwnerId!==t._conferenceOwnerAddress&&(t._conferenceOwnerAddress=e.virtualRoomOwnerId,t._onConferenceOwnerAddressChangedCallbacks.fire(t,e.virtualRoomOwnerId)),e.recorderAvailable&&e.recorderAvailable!==t._recorderStatus&&(t._recorderStatus=e.recorderAvailable),e.recording&&e.recording!==t._recordingStatus&&(t._recordingStatus=e.recording,t._onConferenceRecordingStatusChangedCallbacks.fire(t,t._recordingStatus)),!e.locked&&!1!==e.locked||e.locked===t._isLocked||(t._isLocked=e.locked,t._onConferenceLockStatusChangedCallbacks.fire(t,t._isLocked)),e.media&&"video"===e.media!==t._isVideoAllowed&&(t._isVideoAllowed="video"===e.media,t._onConferenceVideoStatusChangedCallbacks.fire(t,t._isVideoAllowed)),e.presenterId&&"none"!==e.presenterId!==t._isApplicationSharingActive&&(t._isApplicationSharingActive="none"!==e.presenterId,t._onConferencePresentationModeStatusChangedCallbacks.fire(t,t._isApplicationSharingActive)),e.presenterId&&e.presenterId!==t._presenterId)if(a){var s=t._activeParticipants.filter(function(e){return e._participantId===t._presenterId})[0];s&&(s._presenter=!1,s._onParticipantUnsetAsPresenterCallbacks.fire(s)),t._presenterId=e.presenterId,(i=t._activeParticipants.filter(function(e){return e._participantId===t._presenterId})[0])&&(i._presenter=!0,i._onParticipantSetAsPresenterCallbacks.fire(i))}else t._presenterId=e.presenterId;e.encrypted&&e.encrypted!==t._encryptionStatus&&(t._encryptionStatus=e.encrypted,t._onConferenceEncryptionStatusChangedCallbacks.fire(t,t._encryptionStatus)),e.streaming!==m&&e.streaming!==t._isStreamingActive&&(t._isStreamingActive=e.streaming,t._onConferenceStreamingStatusChangedCallbacks.fire(t,t._isStreamingActive)),e.terminationTime&&e.terminationTime!==t._terminationTime&&(t._terminationTime=e.terminationTime,t._onConferenceMeetingTerminationTimeChangedCallbacks.fire(t,t._terminationTime)),e.moderatorPinNeeded!==m&&e.moderatorPinNeeded!==t._isPasscodeRequiredToBecomeModerator&&(t._isPasscodeRequiredToBecomeModerator=e.moderatorPinNeeded),e.mediaStatus&&e.mediaStatus!==t._mediaStatus&&(t._mediaStatus?e.mediaStatus===n.Services.Conference.MediaStatus.MUTE_ALL_AUDIO?(t._mediaStatus=e.mediaStatus,t._onConferenceAllParticipantsMutedCallbacks.fire(t)):e.mediaStatus===n.Services.Conference.MediaStatus.ACTIVE&&t._mediaStatus===n.Services.Conference.MediaStatus.MUTE_ALL_AUDIO?(t._mediaStatus=e.mediaStatus,t._onConferenceAllParticipantsUnmutedCallbacks.fire(t)):e.mediaStatus===n.Services.Conference.MediaStatus.ACTIVE&&t._mediaStatus===n.Services.Conference.MediaStatus.WAITING_ROOM?(t._mediaStatus=e.mediaStatus,t._onConferenceStartingCallbacks.fire(t,t._mediaStatus)):t._mediaStatus=e.mediaStatus:(t._mediaStatus=e.mediaStatus,t._mediaStatus===n.Services.Conference.MediaStatus.WAITING_ROOM?t._onConferenceWaitingToStartCallbacks.fire(t,t._mediaStatus):t._mediaStatus===n.Services.Conference.MediaStatus.MUTE_ALL_AUDIO&&t._onConferenceAllParticipantsMutedCallbacks.fire(t)))},e.prototype.updateRoster=function(i,e){var t=[],a=[],r={};e.participants.forEach(function(e){r=this._buildActiveParticipant(e,i),a.push(r),0<i._activeParticipants.filter(function(e){return e._participantId===r._participantId}).length||(r._participantId===i._selfParticipantId&&(r._localUser=!0,i._selfParticipant=r,i.getInConferenceChat()._setSelfParticipant(r),r._isSelfParticipant=!0),t.push(r),i._activeParticipants.push(r))}.bind(this));var s=i.getActiveParticipants().filter(function(t){return 0===a.filter(function(e){return e._participantId===t._participantId}).length});s.concat(i.getPendingParticipants().filter(function(t){return 0===a.filter(function(e){return e._participantId===t._participantId}).length})),s.forEach(function(e){var t=new n.Providers.UCCP.UCCPParticipantLeftEvent(e._participantId);n.Base.Logger.info("Dropping participant that is no longer in roster list: ",e._participantId),this.dropParticipant(i,t)}.bind(this)),i._activeParticipants.forEach(function(e){e._recalculateAllCapabilities()}),i._conferenceService._updateMatchedContactsForConference(i),0<t.length&&i._onConferenceParticipantsAddedCallbacks.fire(i,t),i._isLectureModeActive&&(r=i._activeParticipants.filter(function(e){return e._participantId===i._lecturerId})[0])&&(r._lecturer=!0,r._onParticipantSetAsLecturerCallbacks.fire(r)),i._isApplicationSharingActive&&(r=i._activeParticipants.filter(function(e){return e._participantId===i._presenterId})[0])&&(r._presenter=!0,r._onParticipantSetAsPresenterCallbacks.fire(r))},e.prototype.updateSlider=function(e,t){},e.prototype.addActiveParticipant=function(e,t){if(0<e._activeParticipants.filter(function(e){return e._participantId===t.participantId}).length)this._buildActiveExistingParticipant(t,e);else{var i=this._buildActiveParticipant(t,e);i._participantId===e._selfParticipantId&&(i._localUser=!0,e._selfParticipant=i,e.getInConferenceChat()._setSelfParticipant(i),i._isSelfParticipant=!0,e._recalculateAllCapabilities()),e._activeParticipants.push(i),e._onConferenceParticipantsAddedCallbacks.fire(e,[i]),e._conferenceService._updateMatchedContactsForParticipant(i),i._recalculateAllCapabilities()}},e.prototype.addDialoutParticipant=function(e,t,i){if(0<e._activeParticipants.filter(function(e){return e._participantId===t.participantId}).length)return!1;var a=new n.Services.Conference.ActiveParticipant(e._participantService,e);return a._participantId=t.participantId,a._displayName=i,e._activeParticipants.push(a),a._connectionStatus=n.Services.Conference.ParticipantConnectionStatus.CONNECTION_STATUS_CONNECTING,!0},e.prototype.updateDialoutParticipant=function(e,t,i){t._connectionStatus=n.Services.Conference.ParticipantConnectionStatus.CONNECTION_STATUS_CONNECTED,t._onParticipantConnectionStatusChangedCallbacks.fire(t,t._connectionStatus)},e.prototype.removeDialoutParticipant=function(e,t,i){var a=e._activeParticipants.filter(function(e){return e._participantId===t})[0];n.Base.Utils.isDefined(a)&&e._activeParticipants.splice(e._activeParticipants.indexOf(a),1)},e.prototype.addPendingParticipant=function(e,t){if(!(0<e._pendingParticipants.filter(function(e){return e._participantId===t.participantId}).length)){var i=this._buildPendingParticipant(t,e);e._pendingParticipants.push(i),e._conferenceService._updateMatchedContactsForParticipant(i),e._onConferencePendingParticipantCallbacks.fire(e,i)}},e.prototype.removePendingParticipant=function(e,t){var i=e._pendingParticipants.filter(function(e){return e._participantId===t.participantId||e._participantId===t._participantId})[0];if(n.Base.Utils.isDefined(i)){var a=e._pendingParticipants.indexOf(i);e._pendingParticipants.splice(a,1),e._onConferencePendingParticipantRemovedCallbacks.fire(e,i)}},e.prototype.pendingParticipantAccepted=function(e,t){e._onPendingParticipantAcceptedCallbacks.fire(e,t.anotherModerator),this.removePendingParticipant(e._conference,e)},e.prototype.pendingParticipantCancelled=function(e,t){var i=e._pendingParticipants.filter(function(e){return e._participantId===t.participantId})[0];n.Base.Utils.isDefined(i)&&(i._onPendingParticipantCancelledCallbacks.fire(i,t.reason,t.anotherModerator),this.removePendingParticipant(i._conference,i))},e.prototype.pendingParticipantDenied=function(e,t){e._onPendingParticipantDeniedCallbacks.fire(e,t.anotherModerator),this.removePendingParticipant(e._conference,e)},e.prototype.dropParticipant=function(e,t){var i=e._activeParticipants.filter(function(e){return e._participantId===t.participantId})[0],a=e._pendingParticipants.filter(function(e){return e._participantId===t.participantId})[0];if(n.Base.Utils.isDefined(i)){e._activeParticipants.splice(e._activeParticipants.indexOf(i),1);var r=this._buildDroppedParticipant(i,e);e._droppedParticipants.push(r),e._conferenceService._updateMatchedContactsForParticipant(r),e._onConferenceParticipantsRemovedCallbacks.fire(e,[i]),e._onConferenceDroppedParticipantAddedCallbacks.fire(e,r)}n.Base.Utils.isDefined(a)&&(e._pendingParticipants.splice(e._pendingParticipants.indexOf(a),1),e._onConferencePendingParticipantRemovedCallbacks.fire(e,a))},e.prototype.updateMeetingNote=function(e,t){},e.prototype.updateActiveTalker=function(t,i){var e;if(i.participantId!==t._activeTalkerId){var a=t._activeParticipants.filter(function(e){return e._participantId===t._activeTalkerId})[0];n.Base.Utils.isDefined(a)&&a._onParticipantActiveTalkerStatusChangedCallbacks.fire(a,!1),e=t._activeParticipants.filter(function(e){return e._participantId===i.participantId})[0],n.Base.Utils.isDefined(e)&&(t._activeTalkerId=i.participantId,t._onConferenceActiveTalkersChangedCallbacks.fire(t,e),e._lastSpokenTime=new Date,e._onParticipantActiveTalkerStatusChangedCallbacks.fire(e,!0))}t._activeTalkerId&&e&&(t._recentTalkersList=t.getRecentTalkers().filter(function(e){return e._participantId!==t._activeTalkerId}),t.getRecentTalkers().push(e),t.getRecentTalkers().length>n.Services.Conference.RecentTalkersConfiguration.SIZE&&(t._recentTalkersList=t.getRecentTalkers().slice(-n.Services.Conference.RecentTalkersConfiguration.SIZE)))},e.prototype.updateWebCollab=function(e,t){n.Base.Utils.isDefined(t)&&n.Base.Utils.isDefined(t.webCollabUrl)&&0<t.webCollabUrl.length?e._collaborationURI=t.webCollabUrl+"/viewer.php?token="+t.token+"&participantId="+t.participantId+"&meeting_id="+t.meeting_id+"&mode="+t.mode+"&login="+t.login:e._collaborationURI="",e._onConferenceCollaborationURIChangedCallbacks.fire(e,e._collaborationURI)},e.prototype.updatePermissions=function(e,t){n.Base.Utils.isDefined(t.dialout)&&t.dialout!==e._dialoutPermissions&&(e._dialoutPermissions=t.dialout),n.Base.Utils.isDefined(t.recording)&&t.recording!==e._recordingPermissions&&(e._recordingPermissions=t.recording),n.Base.Utils.isDefined(t.lock)&&t.lock!==e._lockPermissions&&(e._lockPermissions=t.lock),n.Base.Utils.isDefined(t.unmuteSelf)&&t.unmuteSelf!==e._unmuteSelfPermissions&&(e._unmuteSelfPermissions=t.unmuteSelf),n.Base.Utils.isDefined(t.unmuteAll)&&t.unmuteAll!==e._unmuteAllPermissions&&(e._unmuteAllPermissions=t.unmuteAll),n.Base.Utils.isDefined(t.sendFecc)&&t.sendFecc!==e._sendFeccPermissions&&(e._sendFeccPermissions=t.sendFecc),n.Base.Utils.isDefined(t.allowVideo)&&t.allowVideo!==e._allowVideoDirection&&(e._allowVideoDirection=t.allowVideo,e._isAvailable&&n.Base.Utils.isDefined(e._selfParticipant)&&e._onConferenceAllowVideoDirectionChangedCallbacks.fire(e)),e._recalculateAllCapabilities()},e.prototype.updateAvailableLayouts=function(e,t){if(n.Base.Utils.isDefined(t.textOverlay)&&t.textOverlay!==e._isVideoParticipantNameDisplayChangeAllowed&&(e._isVideoParticipantNameDisplayChangeAllowed=t.textOverlay,e._recalculateAllCapabilities(),e._onConferenceDisplayParticipantNameOnVideoAllowedCallbacks.fire(e,e._isVideoParticipantNameDisplayChangeAllowed)),n.Base.Utils.isDefined(t.LPPOn)&&t.LPPOn!==e._isVideoPersonalLayoutActive&&(e._isVideoPersonalLayoutActive=t.LPPOn,e._recalculateAllCapabilities()),n.Base.Utils.isDefined(t.noSelfSee)&&t.noSelfSee!==e._isVideoSelfSeeChangeAllowed&&(e._isVideoSelfSeeChangeAllowed=t.noSelfSee,e._recalculateAllCapabilities(),e._onConferenceVideoSelfSeeAllowedCallbacks.fire(e,e._isVideoSelfSeeChangeAllowed)),n.Base.Utils.isDefined(t.videoPin)&&t.videoPin!==e._isVideoPinAllowed&&(e._isVideoPinAllowed=t.videoPin,e._recalculateAllCapabilities(),e._onConferenceVideoPinAllowedCallbacks.fire(e,e._isVideoPinAllowed)),n.Base.Utils.isDefined(t.geometries)){var i=e._supportedVideoLayouts.slice(0);e._supportedVideoLayouts=t.geometries.slice(0);var a=!1;if(i.length===e._supportedVideoLayouts.length){for(var r=0;r<i.length;r++)if(i[r]!==e._supportedVideoLayouts[r]){a=!0;break}}else a=!0;a&&(e._recalculateAllCapabilities(),e._onConferenceAvailableVideoLayoutsChangedCallbacks.fire(e,e._supportedVideoLayouts))}},e.prototype.updateCurrentLayout=function(e,t){if(n.Base.Utils.isDefined(t.textOverlay)&&t.textOverlay!==e._isVideoParticipantNameDisplayActive&&(e._isVideoParticipantNameDisplayActive=t.textOverlay,e._onConferenceDisplayVideoParticipantNameChangedCallbacks.fire(e,e._isVideoParticipantNameDisplayActive)),n.Base.Utils.isDefined(t.LPPOn)&&t.LPPOn!==e._isVideoPersonalLayoutActive&&(e._isVideoPersonalLayoutActive=t.LPPOn),n.Base.Utils.isDefined(t.noSelfSee)){var i=e._isVideoSelfSeeActive;e._isVideoSelfSeeActive=!t.noSelfSee,e._isVideoSelfSeeActive!==i&&e._onConferenceVideoSelfSeeChangedCallbacks.fire(e,e._isVideoSelfSeeActive)}n.Base.Utils.isDefined(t.geometry)&&t.geometry!==e._currentVideoLayout&&(e._currentVideoLayout=t.geometry,e._onConferenceVideoLayoutChangedCallbacks.fire(e,e._currentVideoLayout))},e.prototype.addChatMessage=function(e,t){var i=e.getInConferenceChat(),a=e._activeParticipants.filter(function(e){return e._participantId===t.participantId})[0];if(t.participantId!==e._selfParticipantId){var r=new n.Services.Conference.ChatMessage(t.text,a,i._selfParticipant,t.type===n.Services.Conference.ChatType.PRIVATE);i._addMessage(r)}},e.prototype._buildActiveParticipant=function(e,t){var i=new n.Services.Conference.ActiveParticipant(t._participantService,t);return i._participantId=e.participantId,i._displayName=e.participantName,i._address=e.userId,i._userId=e.userId,i._joinTime=e.joinTime,i._sourceID=e.sourceID,i._status=e.status,i._handRaised=e.handRaised,i._role=e.role,i._feccRecvSupport=e.feccRecvSupport,i._audioFromParticipant=e.audioFromParticipant,i._audioToParticipant=e.audioToParticipant,i._videoFromParticipant=e.videoFromParticipant,i._videoToParticipant=e.videoToParticipant,i._contentFromParticipant=e.contentFromParticipant,i._contentToParticipant=e.contentToParticipant,i._canLecture=e.canLecture,i._wasPreviouslyNotVisibleInParticipantList=e.wasHidden,i},e.prototype._buildDroppedParticipant=function(e,t){var i=new n.Services.Conference.DroppedParticipant(t._participantService,t);return i._participantId=e._participantId,i._userId=e._userId,i._displayName=e._displayName,i._address=e._address,i._localUser=!1,i._conference=e._conference,i._recalculateAllCapabilities(),i},e.prototype._buildPendingParticipant=function(e,t){var i=new n.Services.Conference.PendingParticipant(t._participantService,t);return i._participantId=e.participantId,i._userId=e.userId,i._displayName=e.participantName,i._address=e.userId,i._status=e.status,i._localUser=!1,i._conference=t,i._recalculateAllCapabilities(),i},e.prototype._buildActiveExistingParticipant=function(t,e){var i=e._activeParticipants.filter(function(e){return e._participantId===t.participantId})[0];return i._connectionStatus===n.Services.Conference.ParticipantConnectionStatus.CONNECTION_STATUS_CONNECTED?(i._displayName=t.participantName,i._userId=t.userId,i._address=t.userId,i._joinTime=t.joinTime,i._sourceID=t.sourceID,i._status=t.status,i._handRaised=t.handRaised,i._role=t.role,i._feccRecvSupport=t.feccRecvSupport,i._audioFromParticipant=t.audioFromParticipant,i._audioToParticipant=t.audioToParticipant,i._videoFromParticipant=t.videoFromParticipant,i._videoToParticipant=t.videoToParticipant,i._contentFromParticipant=t.contentFromParticipant,i._contentToParticipant=t.contentToParticipant,i._canLecture=t.canLecture,i._wasPreviouslyNotVisibleInParticipantList=t.wasHidden,e._onConferenceParticipantsAddedCallbacks.fire(e,[i]),i._recalculateAllCapabilities()):this._updateParticipantsData(e,i,t),i},e.prototype.updateParticipant=function(e,t,i){var a=e._activeParticipants.filter(function(e){return e._participantId===t.participantId});n.Base.Utils.isDefined(a[0])?(this._updateParticipantsData(e,a[0],t),e._conferenceService._updateMatchedContactsForParticipant(a[0])):(i=n.Base.Utils.isDefined(i)?i:0,n.Base.Logger.info(n.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"updateParticipant: Participant is not found."),i<2&&setTimeout(function(){this.updateParticipant(e,t,++i)}.bind(this),500))},e.prototype._updateParticipantsData=function(e,t,i){if(n.Base.Utils.isDefined(i.audioFromParticipant)&&t._audioFromParticipant!==i.audioFromParticipant&&(t._audioFromParticipant=i.audioFromParticipant,t._isAudioMuted=i.audioFromParticipant!==n.Services.Conference.MediaFromParticipantStatus.ACTIVE,t._onParticipantAudioStatusChangedCallbacks.fire(t,t._audioFromParticipant),t._recalculateAllCapabilities()),n.Base.Utils.isDefined(i.videoFromParticipant)&&t._videoFromParticipant!==i.videoFromParticipant&&(t._videoFromParticipant=i.videoFromParticipant,t._isVideoBlocked=i.videoFromParticipant!==n.Services.Conference.MediaFromParticipantStatus.ACTIVE,t._onParticipantVideoStatusChangedCallbacks.fire(t,t._videoFromParticipant),t._recalculateAllCapabilities()),n.Base.Utils.isDefined(i.status)&&t._status!==i.status&&(t._status=i.status,t._onParticipantStatusChangedCallbacks.fire(t,t._status)),n.Base.Utils.isDefined(i.handRaised)&&t._handRaised!==i.handRaised&&(t._handRaised=i.handRaised,t.isLocalUser()&&(e._isHandRaised=i.handRaised),t._handRaised?t._onParticipantHandRaisedCallbacks.fire(t):t._onParticipantHandLoweredCallbacks.fire(t)),n.Base.Utils.isDefined(i.role)&&t._role!==i.role){var a=t._role;t._role=i.role,t._role===n.Services.Conference.ParticipantRole.MODERATOR?t._onParticipantSetAsModeratorCallbacks.fire(t):a===n.Services.Conference.ParticipantRole.MODERATOR&&t._role!==n.Services.Conference.ParticipantRole.MODERATOR&&t._onParticipantUnsetAsModeratorCallbacks.fire(t),e._recalculate()}n.Base.Utils.isDefined(i.canLecture)&&t._canLecture!==i.canLecture&&(t._canLecture=i.canLecture,t._recalculateAllCapabilities()),n.Base.Utils.isDefined(i.participantName)&&t._displayName!==i.participantName&&(t._displayName=i.participantName,t._onParticipantDisplayNameChangedCallbacks.fire(t)),n.Base.Utils.isDefined(i.feccRecvSupport)&&t._feccRecvSupport!==i.feccRecvSupport&&(t._feccRecvSupport=i.feccRecvSupport),n.Base.Utils.isDefined(i.audioToParticipant)&&t._audioToParticipant!==i.audioToParticipant&&(t._audioToParticipant=i.audioToParticipant),n.Base.Utils.isDefined(i.videoToParticipant)&&t._videoToParticipant!==i.videoToParticipant&&(t._videoToParticipant=i.videoToParticipant),n.Base.Utils.isDefined(i.contentFromParticipant)&&t._contentFromParticipant!==i.contentFromParticipant&&(t._contentFromParticipant=i.contentFromParticipant,t._onParticipantCollaborationStatusChangedCallbacks.fire(t)),n.Base.Utils.isDefined(i.contentToParticipant)&&t._contentToParticipant!==i.contentToParticipant&&(t._contentToParticipant=i.contentToParticipant),n.Base.Utils.isDefined(i.userId)&&t._userId!==i.userId&&(t._userId=i.userId)},e.prototype.updateDialInInfo=function(e,t){e._joinMeetingURI=t.webLink,e._streamingURI=t.streamingLink,e._dialInInformation=t.dialInInformation,e._dialInInformationHtml=t.dialInInformationHtml,e._onConferenceStreamingURIUpdatedCallbacks.fire(e),e._onConferenceJoinMeetingURIUpdatedCallbacks.fire(e),e._onConferenceDialInInfoUpdatedCallbacks.fire(e)},e.prototype.recordingFailed=function(e,t){e._onConferenceRecordingFailedCallbacks.fire(e)},e.prototype.meetingTerminationInProgress=function(e,t){e._onConferenceMeetingTerminationInProgressCallbacks.fire(e,t.reason,t.userName)},e.prototype.handleDisconnectEvent=function(e,t){n.Base.Logger.info(n.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"Conference received disconnect event. Reason: "+t.reason),e._conferenceService._isDisconnecting=!0,e._onConferenceConnectionEndedCallbacks.fire(e,t.reason),e.stop()},e.prototype.networkFailureHandler=function(e){e._isAvailable&&(e._isAvailable=!1,e._onConferenceServiceUnavailableCallbacks.fire(e,new n.Services.Conference.ConferenceException(n.Services.Conference.ConferenceError.NETWORK_UNAVAILABLE))),e._recalculate()},e.prototype.networkAvailabilityHandler=function(e){e._isAvailable||(e._isAvailable=!0,e._onConferenceServiceAvailableCallbacks.fire(e)),e._recalculate()},e.prototype.connectionRecoveryFailureHandler=function(e){e._isAvailable&&(e._isAvailable=!1),e._onConferenceServiceUnavailableCallbacks.fire(e,new n.Services.Conference.ConferenceException(n.Services.Conference.ConferenceError.CONFERENCE_CONNECTION_FAILED_TO_RECOVER)),e._recalculate()},n.Providers.Scopia.ScopiaConferenceBuilder=e}(AvayaClientServices),function(r){"use strict";function e(e,t){r.Providers.Interfaces.ConferenceProvider.call(this),this._dataProvider=e,this._conferenceBuilder=t,this._transaction={id:1},this._isAvailable=!1,this._networkFailureTimer=m}(e.prototype=Object.create(r.Providers.Interfaces.ConferenceProvider.prototype)).start=function(a,e){if(this._isAvailable)return T.Deferred().resolve();var t=r.Base.Utils.queryJSONObject(e,"networkProviderConfiguration.webSocketConfig");return!1!==e.enabled&&r.Base.Utils.isDefined(t)?(this._startNetworkFailureTimer(a),this._dataProvider.start(e,a).then(function(){return this._dataProvider.sendHandshake(this._transaction.id++)}.bind(this)).then(function(e){var t=T.Deferred();this._isLongPollingUccpProvider(this._dataProvider.getSelectedProvider())&&this._conferenceBuilder.networkAvailabilityHandler(a),a._selfParticipantId=e.participantId,a._admissionPermissionNeeded=e.admissionPermissionNeeded,a._admissionPasscodeNeeded=e.admissionPasscodeNeeded,a._knockDoorTimeout=e.knockDoorTimeout;var i=a._getPreEnteredPasscode();return e.admissionPermissionNeeded?(this._stopNetworkFailureTimer(),e.admissionPasscodeNeeded?t.reject({name:r.Services.Conference.ConferenceStartStatus.ADMISSION_NEEDED,admissionPasscodeNeeded:e.admissionPasscodeNeeded,admissionPermissionNeeded:e.admissionPermissionNeeded,message:"Conference admission and passcode are needed"}):t.reject({name:r.Services.Conference.ConferenceStartStatus.ADMISSION_NEEDED,admissionPasscodeNeeded:e.admissionPasscodeNeeded,admissionPermissionNeeded:e.admissionPermissionNeeded,message:"Conference admission is needed"})):e.admissionPasscodeNeeded?(this._stopNetworkFailureTimer(),i?a.sendPasscode(i).then(function(){t.resolve()},function(){t.reject({name:r.Services.Conference.ConferenceStartStatus.ADMISSION_NEEDED,admissionPasscodeNeeded:e.admissionPasscodeNeeded,admissionPermissionNeeded:e.admissionPermissionNeeded,message:"Conference passcode is wrong"})}):t.reject({name:r.Services.Conference.ConferenceStartStatus.ADMISSION_NEEDED,admissionPasscodeNeeded:e.admissionPasscodeNeeded,admissionPermissionNeeded:e.admissionPermissionNeeded,message:"Conference passcode is needed"})):"fail"===e.responseCode?(r.Base.Logger.warn(r.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"Handshake Rejected"),this._stopNetworkFailureTimer(),this._conferenceBuilder.connectionRecoveryFailureHandler(a),t.reject({name:r.Services.Conference.ConferenceStartStatus.HANDSHAKE_REJECTED})):(this._stopNetworkFailureTimer(),a._isAvailable=!0,a._onConferenceServiceAvailableCallbacks.fire(a),this._startListenersAndSubscribes(a),this._isAvailable=!0,t.resolve()),t.promise()}.bind(this),function(e){(e._data&&(502===e._data._status||403===e._data._status)||e.code&&"fail"===e.code)&&(r.Base.Logger.warn(r.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"Possible iView failover detected"),this._stopNetworkFailureTimer(),this._conferenceBuilder.connectionRecoveryFailureHandler(a))}.bind(this))):T.Deferred().reject({name:r.Services.Conference.ConferenceStartStatus.CONFERENCE_CONFIG_NOT_ENABLED,message:"Conference config is not enabled"})},e.prototype._startListenersAndSubscribes=function(e,t){return this.addConferenceEventListeners(e,t),this.observeConference(e),r.Base.Logger.info(r.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"Conference service is started."),e},e.prototype.observeConference=function(t){this._dataProvider.getDialInInfo(this._transaction.id++).then(function(e){return this._conferenceBuilder.updateDialInInfo(t,e),e}.bind(this)),this._dataProvider.subscribeMeetingInfo(this._transaction.id++).then(function(e){return this._conferenceBuilder.updateMeetingInfo(t,e),t._recalculateAllCapabilities(),e}.bind(this)),this._dataProvider.subscribeRoster(this._transaction.id++).then(function(e){return this._conferenceBuilder.updateRoster(t,e),t._recalculateAllCapabilities(),e}.bind(this)),this._dataProvider.subscribeActiveTalker(this._transaction.id++).then(function(e){return this._conferenceBuilder.updateActiveTalker(t,e),e}.bind(this)),this._dataProvider.subscribeMeetingNote(this._transaction.id++).then(function(e){return this._conferenceBuilder.updateMeetingNote(t,e),e}.bind(this)),this._dataProvider.subscribeWebCollab(this._transaction.id++).then(function(e){return this._conferenceBuilder.updateWebCollab(t,e),e}.bind(this)),this._dataProvider.subscribeAvailableLayouts(this._transaction.id++).then(function(e){return this._conferenceBuilder.updateAvailableLayouts(t,e),e}.bind(this)),this._dataProvider.subscribePermissions(this._transaction.id++).then(function(e){return this._conferenceBuilder.updatePermissions(t,e),e}.bind(this)),this._dataProvider.getCurrentVideoLayout(this._transaction.id++).then(function(e){return this._conferenceBuilder.updateCurrentLayout(t,e),t._recalculateAllCapabilities(),e}.bind(this))},e.prototype.sendAdmissionRequest=function(t,e){return this._dataProvider.sendAdmissionRequest(this._transaction.id++,e).then(function(e){if(e.responseCode===r.Services.Conference.AdmissionResponseCode.SUCCESS)return t._isAvailable=!0,t._setConferenceStarted(!0),t._onConferenceServiceAvailableCallbacks.fire(t),this._isAvailable=!0,t.addOnConferenceRecordingStatusChangedCallback(t._conferenceService._recalculateConferenceRecordingStatuses),this._startListenersAndSubscribes(t)}.bind(this))},e.prototype.addConferenceEventListeners=function(t,e){if(!e){var i=this._dataProvider.getSelectedProvider();i.on(r.Providers.UCCP.UCCPMessageTypes.PARTICIPANT_JOINED_EVENT,function(e){this._conferenceBuilder.addActiveParticipant(t,e)}.bind(this)),i.on(r.Providers.UCCP.UCCPMessageTypes.PARTICIPANT_LEFT_EVENT,function(e){this._conferenceBuilder.dropParticipant(t,e)}.bind(this)),i.on(r.Providers.UCCP.UCCPMessageTypes.ACTIVE_TALKER_CHANGED_EVENT,function(e){this._conferenceBuilder.updateActiveTalker(t,e)}.bind(this)),i.on(r.Providers.UCCP.UCCPMessageTypes.DISCONNECT_EVENT,function(e){this._conferenceBuilder.handleDisconnectEvent(t,e)}.bind(this)),i.on(r.Providers.UCCP.UCCPMessageTypes.PERMISSIONS_CHANGED_EVENT,function(e){this._conferenceBuilder.updatePermissions(t,e)}.bind(this)),i.on(r.Providers.UCCP.UCCPMessageTypes.PARTICIPANT_INFO_CHANGED_EVENT,function(e){this._conferenceBuilder.updateParticipant(t,e)}.bind(this)),i.on(r.Providers.UCCP.UCCPMessageTypes.MEETING_INFO_CHANGED_EVENT,function(e){this._conferenceBuilder.updateMeetingInfo(t,e),t._recalculateInConferenceChatCapability()}.bind(this)),i.on(r.Providers.UCCP.UCCPMessageTypes.AVAILABLE_LAYOUTS_CHANGED_EVENT,function(e){this._conferenceBuilder.updateAvailableLayouts(t,e),e.geometries&&0<e.geometries.length&&i.getCurrentVideoLayout(this._transaction.id++).then(function(e){this._conferenceBuilder.updateCurrentLayout(t,e)}.bind(this),function(e){r.Base.Logger.error(r.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"Failed to retrieve current layout",e)})}.bind(this)),i.on(r.Providers.UCCP.UCCPMessageTypes.CURRENT_LAYOUT_CHANGED_EVENT,function(e){this._conferenceBuilder.updateCurrentLayout(t,e)}.bind(this)),i.on(r.Providers.UCCP.UCCPMessageTypes.MEETING_TERMINATION_IN_PROGRESS_EVENT,function(e){this._conferenceBuilder.meetingTerminationInProgress(t,e)}.bind(this)),i.on(r.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_EVENT,function(e){this._conferenceBuilder.addPendingParticipant(t,e)}.bind(this)),i.on(r.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_CANCELED_EVENT,function(e){this._conferenceBuilder.pendingParticipantCancelled(t,e),this._conferenceBuilder.removePendingParticipant(t,e)}.bind(this)),i.on(r.Providers.UCCP.UCCPMessageTypes.RECORDING_FAILED_EVENT,function(e){this._conferenceBuilder.recordingFailed(t,e)}.bind(this)),i.on(r.Providers.UCCP.UCCPMessageTypes.WEB_COLLAB_CHANGED_EVENT,function(e){this._conferenceBuilder.updateWebCollab(t,e)}.bind(this)),i.on(r.Providers.UCCP.UCCPMessageTypes.CHAT_EVENT,function(e){this._conferenceBuilder.addChatMessage(t,e)}.bind(this)),i.on(r.Providers.Interfaces.ConferenceCallbackIds.NETWORK_PROVIDER_IS_UNAVAILABLE,function(){this._startNetworkFailureTimer(t),this._conferenceBuilder.networkFailureHandler(t)}.bind(this)),i.on(r.Providers.Interfaces.ConferenceCallbackIds.NETWORK_PROVIDER_IS_AVAILABLE,function(){this._resubscribe(t)}.bind(this))}},e.prototype.stop=function(){return this._isAvailable=!1,this._stopNetworkFailureTimer(),this._dataProvider.stop().then(function(){return T.Deferred().resolve().promise()},function(e){return r.Base.Logger.error(r.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"failed to stop data provider: "+e),T.Deferred().reject().promise()})},e.prototype._startNetworkFailureTimer=function(e){r.Base.Utils.isUndefined(this._networkFailureTimer)&&(this._networkFailureTimer=setTimeout(function(){this._conferenceBuilder.connectionRecoveryFailureHandler(e)}.bind(this),2e4))},e.prototype._stopNetworkFailureTimer=function(){this._networkFailureTimer&&(clearTimeout(this._networkFailureTimer),this._networkFailureTimer=m)},e.prototype._startLongPollHandshakeResponseTimer=function(){this._stopLongPollHandshakeResponseTimer(),this._longPollHandshakeResponseTimer=setTimeout(function(){this._isLongPollingUccpProvider(this._dataProvider.getSelectedProvider())&&(r.Base.Logger.warn("UCCP long polling handshake timeout"),this._abortLongPollProvider(this._dataProvider.getSelectedProvider()),this._longPollHandshakeResponseTimer=m)}.bind(this),2e4)},e.prototype._abortLongPollProvider=function(e){this._isLongPollingUccpProvider(e)&&e._networkProvider._communicationAdapter.abort()},e.prototype._stopLongPollHandshakeResponseTimer=function(){this._longPollHandshakeResponseTimer&&(clearTimeout(this._longPollHandshakeResponseTimer),this._longPollHandshakeResponseTimer=m)},e.prototype._resubscribe=function(a){return this._isLongPollingUccpProvider(this._dataProvider.getSelectedProvider())&&this._startLongPollHandshakeResponseTimer(),this._dataProvider.sendHandshake(this._transaction.id++).then(function(e){var t=T.Deferred();if(this._stopLongPollHandshakeResponseTimer(),a._selfParticipantId=e.participantId,a._admissionPermissionNeeded=e.admissionPermissionNeeded,a._admissionPasscodeNeeded=e.admissionPasscodeNeeded,a._knockDoorTimeout=e.knockDoorTimeout,e.admissionPermissionNeeded||e.admissionPasscodeNeeded){var i=a._getPreEnteredPasscode();this._stopNetworkFailureTimer(),e.admissionPermissionNeeded?e.admissionPasscodeNeeded?t.reject({name:r.Services.Conference.ConferenceStartStatus.ADMISSION_NEEDED,admissionPasscodeNeeded:e.admissionPasscodeNeeded,admissionPermissionNeeded:e.admissionPermissionNeeded,message:"Conference admission and passcode are needed"}):t.reject({name:r.Services.Conference.ConferenceStartStatus.ADMISSION_NEEDED,admissionPasscodeNeeded:e.admissionPasscodeNeeded,admissionPermissionNeeded:e.admissionPermissionNeeded,message:"Conference admission is needed"}):e.admissionPasscodeNeeded&&(i?a.sendPasscode(i).then(function(){t.resolve()},function(){t.reject({name:r.Services.Conference.ConferenceStartStatus.ADMISSION_NEEDED,admissionPasscodeNeeded:e.admissionPasscodeNeeded,admissionPermissionNeeded:e.admissionPermissionNeeded,message:"Conference passcode is wrong"})}):t.reject({name:r.Services.Conference.ConferenceStartStatus.ADMISSION_NEEDED,admissionPasscodeNeeded:e.admissionPasscodeNeeded,admissionPermissionNeeded:e.admissionPermissionNeeded,message:"Conference passcode is needed"}))}else"fail"===e.responseCode?(r.Base.Logger.warn(r.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"Handshake Rejected"),this._stopNetworkFailureTimer(),this._conferenceBuilder.connectionRecoveryFailureHandler(a),t.reject({name:r.Services.Conference.ConferenceStartStatus.HANDSHAKE_REJECTED})):(this._stopNetworkFailureTimer(),this._conferenceBuilder.networkAvailabilityHandler(a),this._startListenersAndSubscribes(a,!0),t.resolve());return t.promise()}.bind(this),function(e){this._stopLongPollHandshakeResponseTimer(),(e._data&&(502===e._data._status||403===e._data._status)||e.code&&"fail"===e.code)&&(r.Base.Logger.warn(r.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"Possible iView failover detected"),this._stopNetworkFailureTimer(),this._conferenceBuilder.connectionRecoveryFailureHandler(a))}.bind(this))},e.prototype.setAsLecturer=function(e){return this._dataProvider.setAsLecturer(this._transaction.id++,e)},e.prototype.setLocked=function(e){return this._dataProvider.setLocked(this._transaction.id++,e)},e.prototype.unsetAsLecturer=function(){return this._dataProvider.unsetAsLecturer(this._transaction.id++)},e.prototype.disconnectParticipant=function(e){return this._dataProvider.disconnectParticipant(this._transaction.id++,e)},e.prototype.startRecording=function(e,t,i){return this._dataProvider.startRecording(this._transaction.id++,t,i)},e.prototype.stopRecording=function(e){return this._dataProvider.stopRecording(this._transaction.id++)},e.prototype.pauseRecording=function(e){return this._dataProvider.pauseRecording(this._transaction.id++)},e.prototype.resumeRecording=function(e){return this._dataProvider.resumeRecording(this._transaction.id++)},e.prototype.muteUnmute=function(e,t,i){return this._dataProvider.muteUnmute(this._transaction.id++,e,t,i)},e.prototype.controlRemoteCamera=function(e,t){return this._dataProvider.controlRemoteCamera(this._transaction.id++,e,t)},e.prototype.muteUnmuteAll=function(e){return this._dataProvider.muteUnmuteAll(this._transaction.id++,e)},e.prototype.sendLocalMuteEvent=function(e,t){return this._dataProvider.sendLocalMuteEvent(this._transaction.id++,e,t)},e.prototype.sendDisconnectEvent=function(e){return this._isAvailable?this._dataProvider.sendDisconnectEvent(this._transaction.id++,e):T.Deferred().reject("Service unavailable")},e.prototype.setVideoLayout=function(e){return this._dataProvider.setVideoLayout(this._transaction.id++,e)},e.prototype.setVideoLayoutSelfSee=function(e){return this._dataProvider.setVideoLayoutSelfSee(this._transaction.id++,e)},e.prototype.setVideoLayoutTextOverlay=function(e){return this._dataProvider.setVideoLayoutTextOverlay(this._transaction.id++,e)},e.prototype.getCurrentVideoLayout=function(){return this._dataProvider.getCurrentVideoLayout(this._transaction.id++)},e.prototype.terminateConference=function(){return this._dataProvider.terminateConference(this._transaction.id++)},e.prototype.removeLastParticipant=function(){var e=T.Deferred();return r.Base.Logger.info(r.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"removeLastParticipant method is not implemented"),e.reject(new r.Services.Conference.ConferenceException(r.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"removeLastParticipant method is not implemented")),e.promise()},e.prototype.requestToBecomeModerator=function(e){return this._dataProvider.requestToBecomeModerator(this._transaction.id++,e)},e.prototype.signIn=function(e){return this._dataProvider.signIn(this._transaction.id++,e)},e.prototype.videoPin=function(e,t,i,a,r){return this._dataProvider.videoPin(this._transaction.id++,e,t,i,a,r)},e.prototype.extendMeeting=function(e){return this._dataProvider.extendMeeting(this._transaction.id++,e)},e.prototype.addParticipantFromCall=function(e){var t=T.Deferred();return r.Base.Logger.info(r.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"addParticipantFromCall method is not implemented"),t.reject(new r.Services.Conference.ConferenceException(r.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"addParticipantFromCall method is not implemented")),t.promise()},e.prototype.addParticipant=function(i,t){var a=T.Deferred();return this._dataProvider.addParticipant(this._transaction.id++,t).then(function(e){this._conferenceBuilder.addDialoutParticipant(i,e,t)&&a.notify(e),this._dataProvider.getSelectedProvider().on(r.Providers.UCCP.UCCPMessageTypes.DIALOUT_COMPLETED_EVENT,function(t){var e=i._activeParticipants.filter(function(e){return e._participantId===t.participantId})[0];r.Base.Utils.isDefined(e)?t.result===r.Services.Conference.DialoutStatus.CONNECT?(this._conferenceBuilder.updateDialoutParticipant(i,e,t),a.resolve(t)):(i._activeParticipants.splice(i._activeParticipants.indexOf(e),1),a.reject({name:"UCCPServerError",code:t.result,message:"UCCP server responded with "+t.result,type:r.Providers.UCCP.UCCPMessageTypes.DIALOUT_COMPLETED_EVENT})):r.Base.Logger.info(r.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"Update dialout participant: unknown or canceled participant with participantId",t.participantId),this._dataProvider.getSelectedProvider().off(r.Providers.UCCP.UCCPMessageTypes.DIALOUT_COMPLETED_EVENT,this._dataProvider.getSelectedProvider()._listeners[r.Providers.UCCP.UCCPMessageTypes.DIALOUT_COMPLETED_EVENT][0])}.bind(this))}.bind(this),function(e){a.reject(e)}.bind(this)),a.promise()},e.prototype.cancelDialoutParticipant=function(t,i){var a=T.Deferred();return this._dataProvider.cancelDialoutParticipant(this._transaction.id++,i).then(function(e){this._conferenceBuilder.removeDialoutParticipant(t,i,e),a.resolve(e)}.bind(this),function(e){a.reject(e)}.bind(this)),a.promise()},e.prototype.sendChatMessage=function(e,t){return this._dataProvider.sendChatMessage(this._transaction.id++,e,t)},e.prototype.moderatorAdmission=function(t,i){return this._dataProvider.moderatorAdmission(this._transaction.id++,t.getParticipantId(),i).then(function(e){switch(i){case r.Services.Conference.ModeratorAdmissionActions.ADMIT:this._conferenceBuilder.pendingParticipantAccepted(t,e);break;case r.Services.Conference.ModeratorAdmissionActions.REJECT:this._conferenceBuilder.pendingParticipantDenied(t,e);break;default:r.Base.Logger.warn(r.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER,"Unknown action value received: {0}",i)}return e}.bind(this))},e.prototype.raiseLowerHand=function(e){return this._dataProvider.raiseLowerHand(this._transaction.id++,e)},e.prototype.moderatorLowerHand=function(e,t){return this._dataProvider.moderatorLowerHand(this._transaction.id++,e,t)},e.prototype.getDialInInfo=function(){return this._dataProvider.getDialInInfo(this._transaction.id++)},e.prototype.recalculateAddParticipantFromCallCapability=function(e,t){},e.prototype.recalculateAddParticipantFromCallCapabilityByCallId=function(e,t){},e.prototype._isLongPollingUccpProvider=function(e){return!(!e||!e._networkProvider)&&e._networkProvider._communicationAdapter instanceof r.Providers.UCCP.UCCPLongPollingProvider},r.Providers.Scopia.ScopiaConferenceProvider=e}(AvayaClientServices),function(n){"use strict";function e(){}e.prototype={getScopiaConferenceProvider:function(e){if(n.Base.Utils.isDefined(e)&&e.enabled){var t=new n.Providers.UCCP.UCCPMessageBuilder,i=new n.Providers.UCCP.UCCPMessageParser;i.register(n.Providers.UCCP.UCCPMessageTypes.HANDSHAKE_RESPONSE,new n.Providers.UCCP.UCCPHandshakeResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_ROSTER_RESPONSE,new n.Providers.UCCP.UCCPSubscribeRosterResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_ACTIVE_TALKER_RESPONSE,new n.Providers.UCCP.UCCPSubscribeActiveTalkerResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_PERMISSIONS_RESPONSE,new n.Providers.UCCP.UCCPSubscribePermissionsResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_MEETING_NOTE_RESPONSE,new n.Providers.UCCP.UCCPSubscribeMeetingNoteResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_MEETING_INFO_RESPONSE,new n.Providers.UCCP.UCCPSubscribeMeetingInfoResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_WEB_COLLAB_RESPONSE,new n.Providers.UCCP.UCCPSubscribeWebCollabResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_AVAILABLE_LAYOUTS_RESPONSE,new n.Providers.UCCP.UCCPSubscribeAvailableLayoutsResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.PARTICIPANT_JOINED_EVENT,new n.Providers.UCCP.UCCPParticipantJoinedEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.PARTICIPANT_LEFT_EVENT,new n.Providers.UCCP.UCCPParticipantLeftEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.ACTIVE_TALKER_CHANGED_EVENT,new n.Providers.UCCP.UCCPActiveTalkerChangedEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.PERMISSIONS_CHANGED_EVENT,new n.Providers.UCCP.UCCPPermissionsChangedEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.MEETING_INFO_CHANGED_EVENT,new n.Providers.UCCP.UCCPMeetingInfoChangedEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.PARTICIPANT_INFO_CHANGED_EVENT,new n.Providers.UCCP.UCCPParticipantInfoChangedEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.LECTURE_MODE_START_RESPONSE,new n.Providers.UCCP.UCCPLectureModeStartResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.LECTURE_MODE_STOP_RESPONSE,new n.Providers.UCCP.UCCPLectureModeStopResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.MODERATOR_MUTE_RESPONSE,new n.Providers.UCCP.UCCPModeratorMuteResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.FECC_RESPONSE,new n.Providers.UCCP.UCCPFeccResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.MUTE_ALL_RESPONSE,new n.Providers.UCCP.UCCPMuteAllResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.DISCONNECT_PARTICIPANT_RESPONSE,new n.Providers.UCCP.UCCPDisconnectParticipantResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.DISCONNECT_EVENT,new n.Providers.UCCP.UCCPDisconnectEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.MODERATOR_MUTE_RESPONSE,new n.Providers.UCCP.UCCPModeratorMuteResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.MEETING_TERMINATION_IN_PROGRESS_EVENT,new n.Providers.UCCP.UCCPMeetingTerminationInProgressEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.TERMINATE_MEETING_RESPONSE,new n.Providers.UCCP.UCCPTerminateMeetingResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.DIAL_IN_INFO_RESPONSE,new n.Providers.UCCP.UCCPDialInInfoResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.DIALOUT_RESPONSE,new n.Providers.UCCP.UCCPDialoutResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.DIALOUT_COMPLETED_EVENT,new n.Providers.UCCP.UCCPDialoutCompletedEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.DIALOUT_CANCEL_RESPONSE,new n.Providers.UCCP.UCCPDialoutCancelResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.START_MODERATION_RESPONSE,new n.Providers.UCCP.UCCPStartModerationResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.UPDATE_CREDENTIALS_TOKEN_RESPONSE,new n.Providers.UCCP.UCCPUpdateCredentialsTokenResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.CHAT_RESPONSE,new n.Providers.UCCP.UCCPChatResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.CHAT_EVENT,new n.Providers.UCCP.UCCPChatEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.LOCK_MEETING_RESPONSE,new n.Providers.UCCP.UCCPLockMeetingResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.RECORDING_RESPONSE,new n.Providers.UCCP.UCCPRecordingResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.EXTEND_MEETING_RESPONSE,new n.Providers.UCCP.UCCPExtendMeetingResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.RECORDING_REQUEST,new n.Providers.UCCP.UCCPRecordingResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.CURRENT_LAYOUT_RESPONSE,new n.Providers.UCCP.UCCPCurrentLayoutResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_GEOMETRY_RESPONSE,new n.Providers.UCCP.UCCPChangeLayoutGeometryResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_OVERLAY_RESPONSE,new n.Providers.UCCP.UCCPChangeLayoutTextOverlayResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_NO_SELF_SEE_RESPONSE,new n.Providers.UCCP.UCCPChangeLayoutNoSelfSeeResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.AVAILABLE_LAYOUTS_CHANGED_EVENT,new n.Providers.UCCP.UCCPAvailableLayoutsChangedEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.CURRENT_LAYOUT_CHANGED_EVENT,new n.Providers.UCCP.UCCPCurrentLayoutChangedEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.VIDEO_PIN_RESPONSE,new n.Providers.UCCP.UCCPVideoPinResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.RAISE_HAND_RESPONSE,new n.Providers.UCCP.UCCPRaiseHandResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.MODERATOR_LOWER_HAND_RESPONSE,new n.Providers.UCCP.UCCPModeratorLowerHandResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.ADMISSION_RESPONSE,new n.Providers.UCCP.UCCPAdmissionResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_RESPONSE,new n.Providers.UCCP.UCCPModeratorAdmissionResponseParser),i.register(n.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_EVENT,new n.Providers.UCCP.UCCPModeratorAdmissionEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_CANCELED_EVENT,new n.Providers.UCCP.UCCPModeratorAdmissionCanceledEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.RECORDING_FAILED_EVENT,new n.Providers.UCCP.UCCPRecordingFailedEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.WEB_COLLAB_CHANGED_EVENT,new n.Providers.UCCP.UCCPWebCollabChangedEventParser),i.register(n.Providers.UCCP.UCCPMessageTypes.KEEPALIVE_REQUEST,new n.Providers.UCCP.UCCPKeepAliveRequestEventParser);var a=this._createUccpNetworkProvider(i),r=new n.Providers.UCCP.UCCPProviderFactory(a,t,i).getUCCPProvider(),s=new n.Providers.Scopia.ScopiaConferenceBuilder;return new n.Providers.Scopia.ScopiaConferenceProvider(r,s)}},_createUccpNetworkProvider:function(e){var t=new n.Base.TransactionalWebSocketProvider(n.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER),i=new n.Providers.UCCP.UCCPLongPollingProvider(e);return new n.Base.NetworkProvider(t,i,n.Base.LoggerTags.SCOPIA_CONFERENCE_PROVIDER)}},n.Providers.Scopia.ScopiaConferenceProviderFactory=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.UCCP.UCCPMessage=function(e){this.protocolType="UCCP",this.name=e}}(),function(a){"use strict";function e(e,t,i){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_CANCELED_EVENT),this.participantId=e,this.reason=t,this.anotherModerator=i}e.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPModeratorAdmissionCanceledEvent=e}(AvayaClientServices),function(a){"use strict";function e(e,t,i){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_EVENT),this.participantId=e,this.participantName=t,this.userId=i}e.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPModeratorAdmissionEvent=e}(AvayaClientServices),function(a){"use strict";function e(e,t,i){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_RESPONSE),this.transId=e,this.responseCode=t,this.anotherModerator=i}e.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPModeratorAdmissionResponse=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.MODERATOR_LOWER_HAND_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPModeratorLowerHandResponse=e}(AvayaClientServices),function(r){"use strict";function e(e,t,i,a){r.Providers.UCCP.UCCPMessage.call(this,r.Providers.UCCP.UCCPMessageTypes.MODERATOR_MUTE_RESPONSE),this.transId=e,this.responseCode=t,this.audioMute=i,this.videoMute=a}e.prototype=Object.create(r.Providers.UCCP.UCCPMessage.prototype),r.Providers.UCCP.UCCPModeratorMuteResponse=e}(AvayaClientServices),function(i){"use strict";i.Providers.UCCP.UCCPMuteAllResponse=function(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.MUTE_ALL_RESPONSE),this.transId=e,this.responseCode=t}}(AvayaClientServices),function(h){"use strict";function e(e,t,i,a,r,s,n,o,c,l,d,C,u,v){h.Providers.UCCP.UCCPMessage.call(this,"participantInfoChangedEvent"),this.participantId=t,this.participantName=e,this.status=i,this.handRaised=a,this.role=r,this.feccRecvSupport=s,this.audioFromParticipant=n,this.audioToParticipant=o,this.videoFromParticipant=c,this.videoToParticipant=l,this.contentFromParticipant=d,this.contentToParticipant=C,this.userId=u,this.canLecture=v}e.prototype=Object.create(h.Providers.UCCP.UCCPMessage.prototype),h.Providers.UCCP.UCCPParticipantInfoChangedEvent=e}(AvayaClientServices),function(S){"use strict";function e(e,t,i,a,r,s,n,o,c,l,d,C,u,v,h,p,_){S.Providers.UCCP.UCCPMessage.call(this,"participantJoinedEvent"),this.participantId=e,this.participantName=t,this.userId=i,this.sourceID=a,this.status=r,this.handRaised=s,this.role=n,this.feccRecvSupport=o,this.audioFromParticipant=c,this.audioToParticipant=l,this.videoFromParticipant=d,this.videoToParticipant=C,this.contentFromParticipant=u,this.contentToParticipant=v,this.joinTime=h,this.canLecture=p,this.wasHidden=_}e.prototype=Object.create(S.Providers.UCCP.UCCPMessage.prototype),S.Providers.UCCP.UCCPParticipantJoinedEvent=e}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.UCCP.UCCPMessage.call(this,"participantLeftEvent"),this.participantId=e}e.prototype=Object.create(t.Providers.UCCP.UCCPMessage.prototype),t.Providers.UCCP.UCCPParticipantLeftEvent=e}(AvayaClientServices),function(o){"use strict";function e(e,t,i,a,r,s,n){o.Providers.UCCP.UCCPMessage.call(this,o.Providers.UCCP.UCCPMessageTypes.PERMISSIONS_CHANGED_EVENT),this.dialout=e,this.recording=t,this.lock=i,this.unmuteSelf=a,this.unmuteAll=r,this.sendFecc=s,this.allowVideo=n}e.prototype=Object.create(o.Providers.UCCP.UCCPMessage.prototype),o.Providers.UCCP.UCCPPermissionsChangedEvent=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.RAISE_HAND_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPRaiseHandResponse=e}(AvayaClientServices),function(e){"use strict";function t(){e.Providers.UCCP.UCCPMessage.call(this,"recordingFailedEvent")}t.prototype=Object.create(e.Providers.UCCP.UCCPMessage.prototype),e.Providers.UCCP.UCCPRecordingFailedEvent=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,"recordingResponse"),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPRecordingResponse=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.START_MODERATION_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPStartModerationResponse=e}(AvayaClientServices),function(a){"use strict";function e(e,t,i){a.Providers.UCCP.UCCPMessage.call(this,"subscribeActiveTalkerResponse"),this.transId=e,this.responseCode=t,this.participantId=i}e.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPSubscribeActiveTalkerResponse=e}(AvayaClientServices),function(o){"use strict";function e(e,t,i,a,r,s,n){o.Providers.UCCP.UCCPMessage.call(this,o.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_AVAILABLE_LAYOUTS_RESPONSE),this.transId=e,this.responseCode=t,this.textOverlay=i,this.noSelfSee=a,this.videoPin=r,this.geometries=s,this.LPPOn=n}e.prototype=Object.create(o.Providers.UCCP.UCCPMessage.prototype),o.Providers.UCCP.UCCPSubscribeAvailableLayoutsResponse=e}(AvayaClientServices),function(A){"use strict";function e(e,t,i,a,r,s,n,o,c,l,d,C,u,v,h,p,_,S,g,f,E){A.Providers.UCCP.UCCPMessage.call(this,"subscribeMeetingInfoResponse"),this.transId=e,this.responseCode=t,this.meetingId=i,this.meetingName=a,this.virtualRoomName=r,this.virtualRoomOwnerId=s,this.media=n,this.eventConference=o,this.locked=c,this.mediaStatus=l,this.lecturerId=d,this.lecturerName=C,this.presenterId=u,this.presenterName=v,this.recording=h,this.streaming=p,this.encrypted=_,this.moderatorPinNeeded=S,this.slidesAvailable=g,this.recorderAvailable=f,this.terminationTime=E}e.prototype=Object.create(A.Providers.UCCP.UCCPMessage.prototype),A.Providers.UCCP.UCCPSubscribeMeetingInfoResponse=e}(AvayaClientServices),function(a){"use strict";function e(e,t,i){a.Providers.UCCP.UCCPMessage.call(this,"subscribeMeetingNoteResponse"),this.transId=e,this.responseCode=t,this.notes=i}e.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPSubscribeMeetingNoteResponse=e}(AvayaClientServices),function(l){"use strict";function e(e,t,i,a,r,s,n,o,c){l.Providers.UCCP.UCCPMessage.call(this,l.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_PERMISSIONS_RESPONSE),this.transId=e,this.responseCode=t,this.dialout=i,this.recording=a,this.lock=r,this.unmuteSelf=s,this.unmuteAll=n,this.sendFecc=o,this.allowVideo=c}e.prototype=Object.create(l.Providers.UCCP.UCCPMessage.prototype),l.Providers.UCCP.UCCPSubscribePermissionsResponse=e}(AvayaClientServices),function(r){"use strict";function e(e,t,i,a){r.Providers.UCCP.UCCPMessage.call(this,"subscribeRosterResponse"),this.transId=e,this.responseCode=t,this.fragmentation=i,this.participants=a}e.prototype=Object.create(r.Providers.UCCP.UCCPMessage.prototype),r.Providers.UCCP.UCCPSubscribeRosterResponse=e}(AvayaClientServices),function(a){"use strict";function e(e,t,i){a.Providers.UCCP.UCCPMessage.call(this,"subscribeSliderResponse"),this.transId=e,this.responseCode=t,this.slides=i}e.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPSubscribeSliderResponse=e}(AvayaClientServices),function(l){"use strict";function e(e,t,i,a,r,s,n,o,c){l.Providers.UCCP.UCCPMessage.call(this,"subscribeWebCollabResponse"),this.transId=e,this.responseCode=t,this.webCollabUrl=i,this.token=o,this.participantId=n,this.meeting_id=r,this.mode=s,this.login=a,this.gsid=c}e.prototype=Object.create(l.Providers.UCCP.UCCPMessage.prototype),l.Providers.UCCP.UCCPSubscribeWebCollabResponse=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,"terminateMeetingResponse"),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPTerminateMeetingResponse=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.UPDATE_CREDENTIALS_TOKEN_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPUpdateCredentialsTokenResponse=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.VIDEO_PIN_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPVideoPinResponse=e}(AvayaClientServices),function(r){"use strict";function e(e,t,i,a){r.Providers.UCCP.UCCPMessage.call(this,r.Providers.UCCP.UCCPMessageTypes.WEB_COLLAB_CHANGED_EVENT),this.webCollabUrl=e,this.token=t,this.participantId=i,this.meeting_id=a}e.prototype=Object.create(r.Providers.UCCP.UCCPMessage.prototype),r.Providers.UCCP.UCCPWebCollabChangedEvent=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPActiveTalkerChangedEvent(e.params.participantId)}},t.Providers.UCCP.UCCPActiveTalkerChangedEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPAdmissionResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPAdmissionResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPAvailableLayoutsChangedEvent(e.params.textOverlay?"true"===e.params.textOverlay:m,e.params.noSelfSee?"true"===e.params.noSelfSee:m,e.params.videoPin?"true"===e.params.videoPin:m,e.params.geometries,e.params.LPPOn?"true"===e.params.LPPOn:m)}},t.Providers.UCCP.UCCPAvailableLayoutsChangedEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPChangeLayoutGeometryResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPChangeLayoutGeometryResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPChangeLayoutNoSelfSeeResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPChangeLayoutNoSelfSeeResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPChangeLayoutTextOverlayResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPChangeLayoutTextOverlayResponseParser=e}(AvayaClientServices),function(i){"use strict";function e(){}e.prototype={parse:function(e){var t="";return i.Base.Utils.isDefined(e.params.time)&&(t=e.params.time),new i.Providers.UCCP.UCCPChatEvent(e.params.participantId,e.params.type,t,e.params.text)}},i.Providers.UCCP.UCCPChatEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPChatResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPChatResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPCurrentLayoutChangedEvent(e.params.textOverlay?"true"===e.params.textOverlay:m,e.params.noSelfSee?"true"===e.params.noSelfSee:m,e.params.geometry,e.params.LPPOn?"true"===e.params.LPPOn:m)}},t.Providers.UCCP.UCCPCurrentLayoutChangedEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPCurrentLayoutResponse(e.params.transId,e.params.responseCode,"true"===e.params.textOverlay,"true"===e.params.noSelfSee,e.params.geometry,e.params.LPPOn?"true"===e.params.LPPOn:m)}},t.Providers.UCCP.UCCPCurrentLayoutResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPDialInInfoResponse(e.params.transId,e.params.responseCode,e.params.webLink,e.params.streamingLink,e.params.dialInInformation,e.params.dialInInformationHtml)}},t.Providers.UCCP.UCCPDialInInfoResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPDialoutCancelResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPDialoutCancelResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPDialoutCompletedEvent(e.params.participantId,e.params.result)}},t.Providers.UCCP.UCCPDialoutCompletedEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPDialoutResponse(e.params.transId,e.params.responseCode,e.params.participantId)}},t.Providers.UCCP.UCCPDialoutResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPDisconnectEvent(e.params.reason)}},t.Providers.UCCP.UCCPDisconnectEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPDisconnectParticipantResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPDisconnectParticipantResponseParser=e}(AvayaClientServices),function(e){"use strict";function t(){}t.prototype={parse:function(e){return new AvayaClientServices.Providers.UCCP.UCCPExtendMeetingResponse(e.params.transId,e.params.responseCode)}},e.Providers.UCCP.UCCPExtendMeetingResponseParser=t}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPFeccResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPFeccResponseParser=e}(AvayaClientServices),function(i){"use strict";function e(){}e.prototype={parse:function(e){var t=e.params.currentTime?new Date(Date.parse(e.params.currentTime)):m;return new i.Providers.UCCP.UCCPHandshakeResponse(e.params.transId,e.params.responseCode,e.params.version,e.params.participantId,"true"===e.params.externalAdmissionNeeded,"true"===e.params.admissionPasscodeNeeded,"true"===e.params.admissionPermissionNeeded,e.params.commands,t,e.params.longPollEmptyResponseTimeout,isNaN(parseInt(e.params.knockDoorTimeout))?m:parseInt(e.params.knockDoorTimeout))}},i.Providers.UCCP.UCCPHandshakeResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPKeepAliveRequestEvent(e.params.transId)}},t.Providers.UCCP.UCCPKeepAliveRequestEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPLectureModeStartResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPLectureModeStartResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPLectureModeStopResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPLectureModeStopResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPLockMeetingResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPLockMeetingResponseParser=e}(AvayaClientServices),function(a){"use strict";function e(){}e.prototype={parse:function(e){var t=e.params.terminationTime?new Date(Date.parse(e.params.terminationTime)):m,i=e.params.locked?"true"===e.params.locked:m;return new a.Providers.UCCP.UCCPMeetingInfoChangedEvent(e.params.media,i,e.params.mediaStatus,e.params.lecturerId,e.params.lecturerName,e.params.presenterId,e.params.presenterName,e.params.recording,e.params.streaming?"enabled"===e.params.streaming:m,e.params.encrypted,"true"===e.params.slidesAvailable,t)}},a.Providers.UCCP.UCCPMeetingInfoChangedEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPMeetingTerminationInProgressEvent(e.params.reason,e.params.userName)}},t.Providers.UCCP.UCCPMeetingTerminationInProgressEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPModeratorAdmissionCanceledEvent(e.params.participantId,e.params.reason,e.params.anotherModerator)}},t.Providers.UCCP.UCCPModeratorAdmissionCanceledEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPModeratorAdmissionEvent(e.params.participantId,e.params.name,e.params.userId)}},t.Providers.UCCP.UCCPModeratorAdmissionEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPModeratorAdmissionResponse(e.params.transId,e.params.responseCode,e.params.anotherModerator)}},t.Providers.UCCP.UCCPModeratorAdmissionResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPModeratorLowerHandResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPModeratorLowerHandResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPModeratorMuteResponse(e.params.transId,e.params.responseCode,"true"===e.params.audioMute,"true"===e.params.videoMute)}},t.Providers.UCCP.UCCPModeratorMuteResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPMuteAllResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPMuteAllResponseParser=e}(AvayaClientServices),function(r){"use strict";function e(){}e.prototype={parse:function(e){var t,i,a;return r.Base.Utils.isDefined(e.params.handRaised)&&(t="true"===e.params.handRaised),r.Base.Utils.isDefined(e.params.feccRecvSupport)&&(i="true"===e.params.feccRecvSupport),r.Base.Utils.isDefined(e.params.canLecture)&&(a="true"===e.params.canLecture),new r.Providers.UCCP.UCCPParticipantInfoChangedEvent(e.params.name,e.params.participantId,e.params.status,t,e.params.role,i,e.params.audioFromParticipant,e.params.audioToParticipant,e.params.videoFromParticipant,e.params.videoToParticipant,e.params.contentFromParticipant,e.params.contentToParticipant,e.params.userId,a)}},r.Providers.UCCP.UCCPParticipantInfoChangedEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPParticipantJoinedEvent(e.params.participantId,e.params.name,e.params.userId,e.params.sourceID,e.params.status,"true"===e.params.handRaised,e.params.role,"true"===e.params.feccRecvSupport,e.params.audioFromParticipant,e.params.audioToParticipant,e.params.videoFromParticipant,e.params.videoToParticipant,e.params.contentFromParticipant,e.params.contentToParticipant,new Date(Date.parse(e.params.joinTime)),e.params.canLecture?"true"===e.params.canLecture:m,e.params.wasHidden)}},t.Providers.UCCP.UCCPParticipantJoinedEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPParticipantLeftEvent(e.params.participantId)}},t.Providers.UCCP.UCCPParticipantLeftEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPPermissionsChangedEvent(e.params.dialout,e.params.recording,e.params.lock,e.params.unmuteSelf,e.params.unmuteAll,e.params.sendFecc,e.params.allowVideo)}},t.Providers.UCCP.UCCPPermissionsChangedEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPRaiseHandResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPRaiseHandResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPRecordingFailedEvent}},t.Providers.UCCP.UCCPRecordingFailedEventParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPRecordingResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPRecordingResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPStartModerationResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPStartModerationResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPSubscribeActiveTalkerResponse(e.params.transId,e.params.responseCode,e.params.participantId)}},t.Providers.UCCP.UCCPSubscribeActiveTalkerResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPSubscribeAvailableLayoutsResponse(e.params.transId,e.params.responseCode,"true"===e.params.textOverlay,"true"===e.params.noSelfSee,"true"===e.params.videoPin,e.params.geometries,e.params.LPPOn?"true"===e.params.LPPOn:m)}},t.Providers.UCCP.UCCPSubscribeAvailableLayoutsResponseParser=e}(AvayaClientServices),function(i){"use strict";function e(){}e.prototype={parse:function(e){var t=new Date(Date.parse(e.params.terminationTime));return new i.Providers.UCCP.UCCPSubscribeMeetingInfoResponse(e.params.transId,e.params.responseCode,e.params.meetingId,e.params.meetingName,e.params.virtualRoomName,e.params.virtualRoomOwnerId,e.params.media,"true"===e.params.eventConference,"true"===e.params.locked,e.params.mediaStatus,e.params.lecturerId,e.params.lecturerName,e.params.presenterId,e.params.presenterName,e.params.recording,"enabled"===e.params.streaming,e.params.encrypted,"true"===e.params.moderatorPinNeeded,"true"===e.params.slidesAvailable,e.params.recorderAvailable,t)}},i.Providers.UCCP.UCCPSubscribeMeetingInfoResponseParser=e}(AvayaClientServices),function(i){"use strict";function e(){}e.prototype={parse:function(e){var t=e.params.notes.map(function(e){return{participantId:e.participantId,participantDisplayName:e.participantDisplayName,noteId:e.noteId,text:e.text,time:new Date(Date.parse(e.time))}});return new i.Providers.UCCP.UCCPSubscribeMeetingNoteResponse(e.params.transId,e.params.responseCode,t)}},i.Providers.UCCP.UCCPSubscribeMeetingNoteResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPSubscribePermissionsResponse(e.params.transId,e.params.responseCode,e.params.dialout,e.params.recording,e.params.lock,e.params.unmuteSelf,e.params.unmuteAll,e.params.sendFecc,e.params.allowVideo)}},t.Providers.UCCP.UCCPSubscribePermissionsResponseParser=e}(AvayaClientServices),function(i){"use strict";function e(){}e.prototype={parse:function(e){var t=e.params.participants.map(function(e){return this._buildActiveParticipant(e)}.bind(this));return new i.Providers.UCCP.UCCPSubscribeRosterResponse(e.params.transId,e.params.responseCode,e.params.fragmentation,t)},_buildActiveParticipant:function(e){var t,i,a={},r=[],s="";return a.participantId=e.participantId,a.participantName=e.name,a.userId=e.userId,e.joinTime&&(t=new RegExp(/(\d{2}:\d{2}:\d{2})\s(\d{2})-(\d{2})-(\d{4})\s(-?\+?\d{4})/),i=new RegExp(/(\d{4}-\d{2}-\d{2})[a-zA-Z](\d{2}:\d{2}:\d{2})(-?\+?\d{2}:\d{2})/),t.test(e.joinTime)?s=(r=t.exec(e.joinTime))[4]+"-"+r[3]+"-"+r[2]+" "+r[1]+" GMT"+r[5]:i.test(e.joinTime)&&(s=e.joinTime),s&&(a.joinTime=new Date(Date.parse(s)))),a.sourceID=e.sourceID,a.status=e.status,a.handRaised="true"===e.handRaised,a.role=e.role,a.feccRecvSupport="true"===e.feccRecvSupport,a.audioFromParticipant=e.audioFromParticipant,a.audioToParticipant=e.audioToParticipant,a.videoFromParticipant=e.videoFromParticipant,a.videoToParticipant=e.videoToParticipant,a.contentFromParticipant=e.contentFromParticipant,a.contentToParticipant=e.contentToParticipant,a.canLecture=e.canLecture?"true"===e.canLecture:m,a}},i.Providers.UCCP.UCCPSubscribeRosterResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPSubscribeSliderResponse(e.params.transId,e.params.responseCode,e.params.slides)}},t.Providers.UCCP.UCCPSubscribeSliderResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPSubscribeWebCollabResponse(e.params.transId,e.params.responseCode,e.params.webCollabUrl,e.params.login,e.params.meeting_id,e.params.mode,e.params.participantId,e.params.token,e.params.gsid)}},t.Providers.UCCP.UCCPSubscribeWebCollabResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPTerminateMeetingResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPTerminateMeetingResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPUpdateCredentialsTokenResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPUpdateCredentialsTokenResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPVideoPinResponse(e.params.transId,e.params.responseCode)}},t.Providers.UCCP.UCCPVideoPinResponseParser=e}(AvayaClientServices),function(t){"use strict";function e(){}e.prototype={parse:function(e){return new t.Providers.UCCP.UCCPWebCollabChangedEvent(e.params.webCollabUrl,e.params.token,e.params.participantId,e.params.meeting_id)}},t.Providers.UCCP.UCCPWebCollabChangedEventParser=e}(AvayaClientServices),function(o){"use strict";var t=o.Base.Storage,i="JSCSDK_UCCP_ClientId";function e(){}e.prototype={buildHandshakeRequest:function(e){var t=new Date,i=-t.getTimezoneOffset(),a=0<=i?"+":"-",r=t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)+"T"+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2)+a+("0"+parseInt(Math.abs(i/60))).slice(-2)+":"+("0"+Math.abs(i%60)).slice(-2),s={clientId:this._getClientID(),transId:e.toString(),clientType:"Web Client",clientUserAgent:navigator.userAgent,version:"1.0",features:[{featureName:"passcode",version:"1.0"},{featureName:"knockOnTheDoorParticipant",version:"1.0"},{featureName:"knockOnTheDoorModerator",version:"1.0"}],currentTime:r};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.HANDSHAKE_REQUEST,s)},buildSubscribeMeetingInfoRequest:function(e){var t={transId:e.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_MEETING_INFO_REQUEST,t)},buildSubscribeSliderRequest:function(e){var t={transId:e.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_SLIDER_REQUEST,t)},buildSubscribeActiveTalkerRequest:function(e){var t={transId:e.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_ACTIVE_TALKER_REQUEST,t)},buildSubscribePermissionsRequest:function(e){var t={transId:e.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_PERMISSIONS_REQUEST,t)},buildSubscribeMeetingNoteRequest:function(e){var t={transId:e.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_MEETING_NOTE_REQUEST,t)},buildSubscribeRosterRequest:function(e){var t={transId:e.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_ROSTER_REQUEST,t)},buildSubscribeWebCollabRequest:function(e){var t={transId:e.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_WEB_COLLAB_REQUEST,t)},buildSubscribeAvailableLayoutsRequest:function(e){var t={transId:e.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.SUBSCRIBE_AVAILABLE_LAYOUTS_REQUEST,t)},buildSetAsLecturerRequest:function(e,t){var i={transId:e.toString(),participantId:t};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.LECTURE_MODE_START_REQUEST,i)},buildUnsetAsLecturerRequest:function(e){var t={transId:e.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.LECTURE_MODE_STOP_REQUEST,t)},buildMuteAllRequest:function(e,t){var i={transId:e.toString(),audioMute:t.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.MUTE_ALL_REQUEST,i)},buildModeratorMuteRequest:function(e,t,i,a){var r={transId:e.toString(),participantId:t,mediaType:i,mute:a.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.MODERATOR_MUTE_REQUEST,r)},buildFeccRequest:function(e,t,i){var a={transId:e.toString(),participantId:t,action:i.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.FECC_REQUEST,a)},buildDisconnectParticipantRequest:function(e,t){var i={transId:e.toString(),participantId:t};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.DISCONNECT_PARTICIPANT_REQUEST,i)},buildLocalMuteEvent:function(e,t,i){var a={transId:e.toString(),participantId:t,audioMute:i.toString(),videoMute:"false"};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.LOCAL_MUTE_EVENT,a)},buildDisconnectEvent:function(e,t){var i={transId:e.toString(),reason:t};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.DISCONNECT_EVENT,i)},buildTerminateMeetingRequest:function(e){var t={transId:e.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.TERMINATE_MEETING_REQUEST,t)},buildStartModerationRequest:function(e,t){var i={transId:e.toString()};return o.Base.Utils.isDefined(t)&&(i.pin=t),this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.START_MODERATION_REQUEST,i)},buildUpdateCredentialsTokenRequest:function(e,t){var i={transId:e.toString(),token:t};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.UPDATE_CREDENTIALS_TOKEN_REQUEST,i)},buildDialoutRequest:function(e,t){var i={transId:e.toString(),dialTo:t};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.DIALOUT_REQUEST,i)},buildCancelDialoutRequest:function(e,t){var i={transId:e.toString(),participantId:t};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.DIALOUT_CANCEL_REQUEST,i)},buildSendChatMessage:function(e,t,i){var a={transId:e.toString(),text:t.toString(),participantId:i||"public"};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.CHAT_REQUEST,a)},buildExtendMeetingRequest:function(e,t){var i={transId:e.toString(),additionalTimeInMinutes:t.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.EXTEND_MEETING_REQUEST,i)},buildLockMeetingRequest:function(e,t){var i={transId:e.toString(),lock:t.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.LOCK_MEETING_REQUEST,i)},buildCurrentLayoutRequest:function(e){var t={transId:e.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.CURRENT_LAYOUT_REQUEST,t)},buildChangeLayoutGeometryRequest:function(e,t){var i={transId:e.toString(),geometry:t};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_GEOMETRY_REQUEST,i)},buildChangeLayoutTextOverlayRequest:function(e,t){var i={transId:e.toString(),textOverlay:t.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_OVERLAY_REQUEST,i)},buildChangeLayoutNoSelfSeeRequest:function(e,t){var i={transId:e.toString(),enableNoSelfSee:t.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_NO_SELF_SEE_REQUEST,i)},buildSetRecordingRequest:function(e,t,i,a){var r={transId:e.toString(),recording:t};return o.Base.Utils.isDefined(i)&&(r.name=i),o.Base.Utils.isDefined(a)&&(r.description=a),this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.RECORDING_REQUEST,r)},buildVideoPinRequest:function(e,t,i,a,r,s){var n={transId:e.toString(),destXCord:r.toString(),destYCord:s.toString()};return o.Base.Utils.isDefined(t)?n.sourceParticipantId=t:o.Base.Utils.isDefined(i)&&o.Base.Utils.isDefined(a)&&(n.sourceXCord=i.toString(),n.sourceYCord=a.toString()),this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.VIDEO_PIN_REQUEST,n)},buildRaiseHandRequest:function(e,t){var i={transId:e.toString(),action:t};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.RAISE_HAND_REQUEST,i)},buildModeratorLowerHandRequest:function(e,t,i){var a={transId:e.toString(),participantId:t.toString(),unmuteAudio:i.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.MODERATOR_LOWER_HAND_REQUEST,a)},buildAdmissionRequest:function(e,t){var i={transId:e.toString()};return o.Base.Utils.isDefined(t)&&(i.passcode=t),this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.ADMISSION_REQUEST,i)},buildModeratorAdmissionRequest:function(e,t,i){var a={transId:e.toString(),participantId:t,action:i};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.MODERATOR_ADMISSION_REQUEST,a)},buildDialInInfoRequest:function(e){var t={transId:e.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.DIAL_IN_INFO_REQUEST,t)},buildKeepaliveRequest:function(e){var t={transId:e.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.KEEPALIVE_REQUEST,t)},buildKeepAliveResponse:function(e){var t={transId:e.toString()};return this._wrapParams(o.Providers.UCCP.UCCPMessageTypes.KEEPALIVE_RESPONSE,t)},_getClientID:function(){var e=t.get(t.TYPES.LOCAL,i);return o.Base.Utils.isUndefined(e)&&(e=o.Base.Utils.generateUUID(),t.set(t.TYPES.LOCAL,i,e)),e},_wrapParams:function(e,t){return{protocolType:"UCCP",name:e,params:t}}},o.Providers.UCCP.UCCPMessageBuilder=e}(AvayaClientServices),function(e){"use strict";function t(){this._parsers={}}t.prototype={parse:function(e){return this._parsers[e.name]?this._parsers[e.name].parse(e):e},register:function(e,t){this._parsers[e]=t}},e.Providers.UCCP.UCCPMessageParser=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.UCCP.UCCPMessageTypes={HANDSHAKE_REQUEST:"handshakeRequest",HANDSHAKE_RESPONSE:"handshakeResponse",SUBSCRIBE_MEETING_INFO_REQUEST:"subscribeMeetingInfoRequest",SUBSCRIBE_MEETING_INFO_RESPONSE:"subscribeMeetingInfoResponse",SUBSCRIBE_ROSTER_REQUEST:"subscribeRosterRequest",SUBSCRIBE_ROSTER_RESPONSE:"subscribeRosterResponse",SUBSCRIBE_ACTIVE_TALKER_REQUEST:"subscribeActiveTalkerRequest",SUBSCRIBE_ACTIVE_TALKER_RESPONSE:"subscribeActiveTalkerResponse",SUBSCRIBE_PERMISSIONS_REQUEST:"subscribePermissionsRequest",SUBSCRIBE_PERMISSIONS_RESPONSE:"subscribePermissionsResponse",SUBSCRIBE_SLIDER_REQUEST:"subscribeSliderInfoRequest",SUBSCRIBE_SLIDER_RESPONSE:"subscribeSliderInfoResponse",SUBSCRIBE_MEETING_NOTE_REQUEST:"subscribeMeetingNoteRequest",SUBSCRIBE_MEETING_NOTE_RESPONSE:"subscribeMeetingNoteResponse",SUBSCRIBE_WEB_COLLAB_REQUEST:"subscribeWebCollabRequest",SUBSCRIBE_WEB_COLLAB_RESPONSE:"subscribeWebCollabResponse",SUBSCRIBE_AVAILABLE_LAYOUTS_REQUEST:"subscribeAvailableLayoutsRequest",SUBSCRIBE_AVAILABLE_LAYOUTS_RESPONSE:"subscribeAvailableLayoutsResponse",START_MODERATION_REQUEST:"startModerationRequest",START_MODERATION_RESPONSE:"startModerationResponse",TERMINATE_MEETING_REQUEST:"terminateMeetingRequest",TERMINATE_MEETING_RESPONSE:"terminateMeetingResponse",DIRECTORY_LOOKUP_REQUEST:"directoryLookupRequest",DIRECTORY_LOOKUP_NOTE_RESPONSE:"directoryLookupResponse",DIAL_IN_INFO_REQUEST:"dialInInfoRequest",DIAL_IN_INFO_RESPONSE:"dialInInfoResponse",DIALOUT_REQUEST:"dialoutRequest",DIALOUT_RESPONSE:"dialoutResponse",DIALOUT_CANCEL_REQUEST:"dialoutCancelRequest",DIALOUT_CANCEL_RESPONSE:"dialoutCancelResponse",DISCONNECT_PARTICIPANT_REQUEST:"disconnectParticipantRequest",DISCONNECT_PARTICIPANT_RESPONSE:"disconnectParticipantResponse",LECTURE_MODE_START_REQUEST:"lectureModeStartRequest",LECTURE_MODE_START_RESPONSE:"lectureModeStartResponse",LECTURE_MODE_STOP_REQUEST:"lectureModeStopRequest",LECTURE_MODE_STOP_RESPONSE:"lectureModeStopResponse",RECORDING_REQUEST:"recordingRequest",RECORDING_RESPONSE:"recordingResponse",LOCK_MEETING_REQUEST:"lockMeetingRequest",LOCK_MEETING_RESPONSE:"lockMeetingResponse",EXTEND_MEETING_REQUEST:"extendMeetingRequest",EXTEND_MEETING_RESPONSE:"extendMeetingResponse",MUTE_ALL_REQUEST:"muteAllRequest",MUTE_ALL_RESPONSE:"muteAllResponse",MODERATOR_MUTE_REQUEST:"moderatorMuteRequest",MODERATOR_MUTE_RESPONSE:"moderatorMuteResponse",RAISE_HAND_REQUEST:"raiseHandRequest",RAISE_HAND_RESPONSE:"raiseHandResponse",MODERATOR_LOWER_HAND_REQUEST:"moderatorLowerHandRequest",MODERATOR_LOWER_HAND_RESPONSE:"moderatorLowerHandResponse",CURRENT_LAYOUT_REQUEST:"currentLayoutRequest",CURRENT_LAYOUT_RESPONSE:"currentLayoutResponse",CHANGE_LAYOUT_GEOMETRY_REQUEST:"changeLayoutGeometryRequest",CHANGE_LAYOUT_GEOMETRY_RESPONSE:"changeLayoutGeometryResponse",CHANGE_LAYOUT_NO_SELF_SEE_REQUEST:"changeLayoutNoSelfSeeRequest",CHANGE_LAYOUT_NO_SELF_SEE_RESPONSE:"changeLayoutNoSelfSeeResponse",VIDEO_PIN_REQUEST:"videoPinRequest",VIDEO_PIN_RESPONSE:"videoPinResponse",FECC_REQUEST:"feccRequest",FECC_RESPONSE:"feccResponse",CHANGE_LAYOUT_OVERLAY_REQUEST:"changeLayoutTextOverlayRequest",CHANGE_LAYOUT_OVERLAY_RESPONSE:"changeLayoutTextOverlayResponse",CHAT_REQUEST:"chatRequest",CHAT_RESPONSE:"chatResponse",ADD_MEETING_NOTE_REQUEST:"addMeetingNoteRequest",ADD_MEETING_NOTE_RESPONSE:"addMeetingNoteResponse",UPDATE_MEETING_NOTE_REQUEST:"updateMeetingNoteRequest",UPDATE_MEETING_NOTE_RESPONSE:"updateMeetingNoteResponse",DELETE_MEETING_NOTE_REQUEST:"deleteMeetingNoteRequest",DELETE_MEETING_NOTE_RESPONSE:"deleteMeetingNoteResponse",LOGGING_REQUEST:"loggingRequest",LOGGING_RESPONSE:"loggingResponse",ADMISSION_REQUEST:"admissionRequest",ADMISSION_RESPONSE:"admissionResponse",MODERATOR_ADMISSION_REQUEST:"moderatorAdmissionRequest",MODERATOR_ADMISSION_RESPONSE:"moderatorAdmissionResponse",MOBILE_LINK_ID_REQUEST:"mobileLinkIdRequest",MOBILE_LINK_ID_RESPONSE:"mobileLinkIdResponse",MOBILE_LINK_ROOM_SYSTEM_LIST_REQUEST:"mobileLinkRoomSystemListRequest",MOBILE_LINK_ROOM_SYSTEM_LIST_RESPONSE:"mobileLinkRoomSystemListResponse",MOBILE_LINK_CHOOSE_ROOM_SYSTEM_REQUEST:"mobileLinkChooseRoomSystemRequest",MOBILE_LINK_CHOOSE_ROOM_SYSTEM_RESPONSE:"mobileLinkChooseRoomSystemResponse",MOBILE_LINK_MANUAL_CHOOSE_ROOM_SYSTEM_REQUEST:"mobileLinkManualChooseRoomSystemRequest",MOBILE_LINK_MANUAL_CHOOSE_ROOM_SYSTEM_RESPONSE:"mobileLinkManualChooseRoomSystemResponse",MOBILE_LINK_DISCONNECT_REQUEST:"mobileLinkDisconnectRequest",MOBILE_LINK_DISCONNECT_RESPONSE:"mobileLinkDisconnectResponse",UPDATE_CREDENTIALS_TOKEN_REQUEST:"updateCredentialsTokenRequest",UPDATE_CREDENTIALS_TOKEN_RESPONSE:"updateCredentialsTokenResponse",UNSUBSCRIBE_MEETING_INFO_REQUEST:"unsubscribeMeetingInfoRequest",UNSUBSCRIBE_MEETING_INFO_RESPONSE:"unsubscribeMeetingInfoResponse",UNSUBSCRIBE_ROSTER_REQUEST:"unsubscribeRosterRequest",UNSUBSCRIBE_ROSTER_RESPONSE:"unsubscribeRosterResponse",UNSUBSCRIBE_SLIDER_REQUEST:"unsubscribeSliderInfoRequest",UNSUBSCRIBE_SLIDER_RESPONSE:"unsubscribeSliderInfoResponse",UNSUBSCRIBE_ACTIVE_TALKER_REQUEST:"unsubscribeActiveTalkerRequest",UNSUBSCRIBE_ACTIVE_TALKER_RESPONSE:"unsubscribeActiveTalkerResponse",UNSUBSCRIBE_PERMISSIONS_REQUEST:"unsubscribePermissionsRequest",UNSUBSCRIBE_PERMISSIONS_RESPONSE:"unsubscribePermissionsResponse",UNSUBSCRIBE_MEETING_NOTE_REQUEST:"unsubscribeMeetingNoteRequest",UNSUBSCRIBE_MEETING_NOTE_RESPONSE:"unsubscribeMeetingNoteResponse",UNSUBSCRIBE_WEB_COLLAB_REQUEST:"unsubscribeWebCollabRequest",UNSUBSCRIBE_WEB_COLLAB_RESPONSE:"unsubscribeWebCollabResponse",UNSUBSCRIBE_AVAILABLE_LAYOUTS_REQUEST:"unsubscribeAvailableLayoutsRequest",UNSUBSCRIBE_AVAILABLE_LAYOUTS_RESPONSE:"unsubscribeAvailableLayoutsResponse",KEEPALIVE_REQUEST:"keepaliveRequest",KEEPALIVE_RESPONSE:"keepaliveResponse",PARTICIPANT_JOINED_EVENT:"participantJoinedEvent",PARTICIPANT_LEFT_EVENT:"participantLeftEvent",ACTIVE_TALKER_CHANGED_EVENT:"activeTalkerChangedEvent",PERMISSIONS_CHANGED_EVENT:"permissionsChangedEvent",CHAT_EVENT:"chatEvent",MEETING_NOTE_ADDED_EVENT:"meetingNoteAddedEvent",MEETING_NOTE_UPDATED_EVENT:"meetingNoteUpdatedEvent",MEETING_NOTE_DELETED_EVENT:"meetingNoteDeletedEvent",LOGGING_EVENT:"loggingEvent",MEETING_INFO_CHANGED_EVENT:"meetingInfoChangedEvent",MEETING_TERMINATION_IN_PROGRESS_EVENT:"meetingTerminationInProgressEvent",NEW_SLIDE_EVENT:"newSlideEvent",PARTICIPANT_INFO_CHANGED_EVENT:"participantInfoChangedEvent",USER_MOVED_EVENT:"userMovedEvent",DIALOUT_COMPLETED_EVENT:"dialoutCompletedEvent",LOCAL_MUTE_EVENT:"localMuteEvent",AVAILABLE_LAYOUTS_CHANGED_EVENT:"availableLayoutsChangedEvent",CURRENT_LAYOUT_CHANGED_EVENT:"currentLayoutChangedEvent",RECORDING_FAILED_EVENT:"recordingFailedEvent",MODERATOR_ADMISSION_EVENT:"moderatorAdmissionEvent",MODERATOR_ADMISSION_CANCELED_EVENT:"moderatorAdmissionCanceledEvent",WEB_COLLAB_CHANGED_EVENT:"webCollabChangedEvent",DISCONNECT_EVENT:"disconnectEvent"}}(),function(t){"use strict";function e(e,t,i){this._networkProvider=e,this._messageBuilder=t,this._messageParser=i,this._uccpProvider={}}e.prototype={getUCCPProvider:function(){if(T.isEmptyObject(this._uccpProvider)){var e=this._createUCCP1Provider();this._uccpProvider=new t.Providers.UCCP.UCCPProvider,this._uccpProvider.registerUCCPProvider(1,e)}return this._uccpProvider},_createUCCP1Provider:function(){return new t.Providers.UCCP.UCCP1Provider(this._networkProvider,this._messageBuilder,this._messageParser)}},t.Providers.UCCP.UCCPProviderFactory=e}(AvayaClientServices),function(a){"use strict";function e(){}e.prototype={_validateTagLength:function(e,t){var i=0;switch(t){case a.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG:case a.Providers.WCS.WCSScreenSharingTagTypes.START_TAG:i=14;break;case a.Providers.WCS.WCSScreenSharingTagTypes.CURSOR_TAG:i=13;break;case a.Providers.WCS.WCSScreenSharingTagTypes.END_TAG:i=1}return i<=e||(a.Base.Logger.warn(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Byte array size: {0} < Min Tag length: {1} Tag type: {2}",e,i,t),!1)},_get64bitNumber:function(e){var t=e.readBytes(8);return 4294967296*t.readUnsignedInt()+t.readUnsignedInt()}},a.Providers.WCS.AbstractBinaryParser=e}(AvayaClientServices),function(i){"use strict";function e(){}(e.prototype=Object.create(i.Providers.WCS.AbstractBinaryParser.prototype)).parse=function(e){if(!this._validateTagLength(e.length,i.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG))return m;var t=new i.Providers.WCS.ScreenSharingBlockTag;if(t.width=e.readShort(),t.height=e.readShort(),t.x=e.readShort(),t.y=e.readShort(),t.imageType=e.readByte(),t.length=e.readInt(),t.length===e.getBytesAvailable())t.data=e.readBytes(t.length);else{if(t.length+4!==e.getBytesAvailable())return i.Base.Logger.error(i.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Invalid type "+i.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG+". Tried to read: "+t.length+". BytesAvailable "+e.getBytesAvailable()),m;e.readInt(),t.data=e.readBytes(t.length)}return t},i.Providers.WCS.BlockTagBinaryParser=e}(AvayaClientServices),function(i){"use strict";function e(){}(e.prototype=Object.create(i.Providers.WCS.AbstractBinaryParser.prototype)).parse=function(e){if(!this._validateTagLength(e.length,i.Providers.WCS.WCSScreenSharingTagTypes.CURSOR_TAG))return m;var t=new i.Providers.WCS.ScreenSharingCursorTag;return t.x=e.readShort(),t.y=e.readShort(),t.creationTime=this._get64bitNumber(e),t},i.Providers.WCS.CursorTagBinaryParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.WCS.AbstractBinaryParser.prototype)).parse=function(e){return this._validateTagLength(e.length,t.Providers.WCS.WCSScreenSharingTagTypes.END_TAG)?new t.Providers.WCS.ScreenSharingEndTag:m},t.Providers.WCS.EndTagBinaryParser=e}(AvayaClientServices),function(i){"use strict";function e(){}(e.prototype=Object.create(i.Providers.WCS.AbstractBinaryParser.prototype)).parse=function(e){if(!this._validateTagLength(e.length,i.Providers.WCS.WCSScreenSharingTagTypes.START_TAG))return m;var t=new i.Providers.WCS.ScreenSharingStartTag;return t.isKeyFrame=Boolean(e.readByte()),t.width=e.readShort(),t.height=e.readShort(),t.creationTime=this._get64bitNumber(e),i.Base.Logger.debug(i.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Start Tag [keyframe={0}]: {1}x{2}",t.isKeyFrame,t.width,t.height),t},i.Providers.WCS.StartTagBinaryParser=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.WCS.AbstractEvent=function(e){this.type=e}}(),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractEvent.call(this,e),t&&(this.from=t.from,this.fromname=t.fromname,this.eventId=t.eventId,this.senderId=t.senderId,this.senderName=t.senderName,this.time=t.time,this.useragent=t.useragent,this.wsConnectionId=t.wsConnectionId,this.data={})}e.prototype=Object.create(i.Providers.WCS.AbstractEvent),i.Providers.WCS.AbstractLiveEvent=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.ADD_NOTE),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.AddNoteEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r){this.noteType=e,this.text=t,this.meetingOwner=i,this.isPersonal=a,r&&(this.targetId=r)}t.prototype={},e.Providers.WCS.AddNoteEventData=t}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.WCS.AbstractLiveEvent.call(this,t.Providers.WCS.WCSEventTypes.ADD_WHITEBOARD),this.liveEventCommonData=e}e.prototype=Object.create(t.Providers.WCS.AbstractLiveEvent.prototype),t.Providers.WCS.AddWhiteboardEvent=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.ALLOW_PRESENTING),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.AllowPresentingEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t){this.targetId=e,this.targetName=t}t.prototype={},e.Providers.WCS.AllowPresentingEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.CLEAR_DRAWING),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.ClearDrawingEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t){this.groupId=e,this.layerType=t}t.prototype={},e.Providers.WCS.ClearDrawingEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.DELETE_NOTE),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.DeleteNoteEvent=e}(AvayaClientServices),function(e){"use strict";function t(e){this.noteId=e}t.prototype={},e.Providers.WCS.DeleteNoteEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.DELETE_SELECTION),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.DeleteSelectionEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r){this.groupId=e,this.layerType=t,this.shapeId=i,this.selectionX=a,this.selectionY=r}t.prototype={},e.Providers.WCS.DeleteSelectionEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.DELETE_WHITEBOARD),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.DeleteWhiteboardEvent=e}(AvayaClientServices),function(e){"use strict";function t(e){this.id=e}t.prototype={},e.Providers.WCS.DeleteWhiteboardEventData=t}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.WCS.AbstractLiveEvent.call(this,t.Providers.WCS.WCSEventTypes.REQUEST_CONTROL),this.liveEventCommonData=e}e.prototype=Object.create(t.Providers.WCS.AbstractLiveEvent.prototype),t.Providers.WCS.DenyControlEvent=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.DENY_PRESENTING),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.DenyPresentingEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t){this.targetId=e,this.targetName=t}t.prototype={},e.Providers.WCS.DenyPresentingEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.DRAW_CIRCLE),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.DrawCircleEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r,s,n,o,c,l,d,C){this.alpha=e,t&&(this.fillColor=t),i&&(this.color=i),d&&(this.filled=d),C&&(this.contour=C),this.groupId=a,this.layerType=r,this.width=s,this.x0=n,this.x1=o,this.y0=c,this.y1=l}t.prototype={},e.Providers.WCS.DrawCircleEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.DRAW_SHAPE),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.DrawShapeEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r,s,n,o,c,l){e&&(this.alpha=e),t&&(this.fillColor=t),i&&(this.color=i),a&&(this.groupId=a),r&&(this.layerType=r),(s||0===s)&&(this.width=s),(n||0!==n.length)&&(this.l=n),(o||0!==o.length)&&(this.m=o),l&&(this.contour=l),c&&(this.filled=c)}t.prototype={},e.Providers.WCS.DrawShapeEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.DRAW_TEXT),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.DrawTextEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r,s,n){this.fillColor=e,this.fontSize=t,this.groupId=i,this.layerType=a,this.text=r||"",this.x=s,this.y=n}t.prototype={},e.Providers.WCS.DrawTextEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.EJECT_PARTICIPANT),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.EjectParticipantEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a){this.targetId=e,this.targetName=t,this.targetParticipantId=i,this.time=a}t.prototype={},e.Providers.WCS.EjectParticipantEventData=t}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.WCS.AbstractLiveEvent.call(this,t.Providers.WCS.WCSEventTypes.END_CONTROL),this.liveEventCommonData=e}e.prototype=Object.create(t.Providers.WCS.AbstractLiveEvent.prototype),t.Providers.WCS.EndControlEvent=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.END_DRAW_SHAPE),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.EndDrawShapeEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t){this.groupId=e,this.layerType=t}t.prototype={},e.Providers.WCS.EndDrawShapeEventData=t}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.WCS.AbstractLiveEvent.call(this,t.Providers.WCS.WCSEventTypes.END_MEETING),this.liveEventCommonData=e}e.prototype=Object.create(t.Providers.WCS.AbstractLiveEvent.prototype),t.Providers.WCS.EndMeetingEvent=e}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.WCS.AbstractLiveEvent.call(this,t.Providers.WCS.WCSEventTypes.END_SCREEN_SHARING,e)}e.prototype=Object.create(t.Providers.WCS.AbstractLiveEvent.prototype),t.Providers.WCS.EndScreenSharingEvent=e}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.WCS.AbstractLiveEvent.call(this,t.Providers.WCS.WCSEventTypes.END_WHITEBOARD),this.liveEventCommonData=e}e.prototype=Object.create(t.Providers.WCS.AbstractLiveEvent.prototype),t.Providers.WCS.EndWhiteboardEvent=e}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.WCS.AbstractLiveEvent.call(this,t.Providers.WCS.WCSEventTypes.ERROR),this.data=e}e.prototype=Object.create(t.Providers.WCS.AbstractLiveEvent.prototype),t.Providers.WCS.ErrorEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a){this.code=e,this.message=t,this.requestId=i,this.wsConnectionId=a}t.prototype={},e.Providers.WCS.ErrorEventData=t}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.WCS.AbstractEvent.call(this,t.Providers.WCS.WCSEventTypes.FRAME_REPORT),this.data=e}e.prototype=Object.create(t.Providers.WCS.AbstractEvent.prototype),t.Providers.WCS.FrameReportEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r,s){this.droppedFrames=e,this.droppedFramesPercentageRounded=t,this.period=i,this.successfulFrames=a,this.timeEnd=r,this.timeStart=s}t.prototype={},e.Providers.WCS.FrameReportEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.GRANT_CONTROL),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.GrantControlEvent=e}(AvayaClientServices),function(e){"use strict";function t(e){this.osType=e}t.prototype={},e.Providers.WCS.GrantControlEventData=t}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r,s,n,o){this.attendeeId=e,this.clientVersion=t,this.privateChatSupported=i,this.startTime=a,this.userAgent=r,this.userIp=s,this.userName=n,this.wsConnectionId=o}t.prototype={},e.Providers.WCS.LiveAttendeeEventData=t}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.WCS.AbstractEvent.call(this,t.Providers.WCS.WCSEventTypes.LIVE_ATTENDEES),this.data=e}e.prototype=Object.create(t.Providers.WCS.AbstractEvent.prototype),t.Providers.WCS.LiveAttendeesEvent=e}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.WCS.AbstractEvent.call(this,t.Providers.WCS.WCSEventTypes.LIVE_CAPABILITIES),this.data=e}e.prototype=Object.create(t.Providers.WCS.AbstractEvent.prototype),t.Providers.WCS.LiveCapabilitiesEvent=e}(AvayaClientServices),function(e){"use strict";function t(){}t.prototype={},e.Providers.WCS.LiveCapabilitiesEventData=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.WCS.LiveEventCommonData=function(e,t,i,a,r,s,n,o,c){this.from=e,this.fromname=t,this.eventId=i,this.senderId=a,this.senderName=r,this.time=s,this.type=n,this.useragent=o,this.wsConnectionId=c}}(),function(t){"use strict";function e(e){t.Providers.WCS.AbstractEvent.call(this,t.Providers.WCS.WCSEventTypes.LIVE_SESSION),this.data=e}e.prototype=Object.create(t.Providers.WCS.AbstractEvent.prototype),t.Providers.WCS.LiveSessionEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r,s,n){this.requestId=e,this.idleTimeout=t,this.serverTimeDiff=i,this.wsConnectionId=a,this.meeting=r,this.liveAttendee=s,this.features=n}t.prototype={},e.Providers.WCS.LiveSessionEventData=t}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.WCS.AbstractEvent.call(this,t.Providers.WCS.WCSEventTypes.LIVE_VIEWER),this.data=e}e.prototype=Object.create(t.Providers.WCS.AbstractEvent.prototype),t.Providers.WCS.LiveViewerEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r,s,n,o,c,l,d,C,u){this.brandId=e,this.wcsVersion=t,this.websocketPath=i,this.websocketCacheSize=a,this.uploadSize=r,this.uploadMaxImageSize=s,this.uploadMaxImageResolution=n,this.uploadTypes=o,this.maxDuration=c,this.eventWaitTime=l,this.uploadMaxFile=d,this.themesLocation=C,this.internalUiControls=u}t.prototype={},e.Providers.WCS.LiveViewerEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.MOVE_SELECTION),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.MoveSelectionEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r,s,n){this.groupId=e,this.layerType=t,this.shapeId=i,this.moveToX=a,this.moveToY=r,this.selectionX=s,this.selectionY=n}t.prototype={},e.Providers.WCS.MoveSelectionEventData=t}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.WCS.AbstractLiveEvent.call(this,t.Providers.WCS.WCSEventTypes.PAUSE_SCREEN_SHARING,e)}e.prototype=Object.create(t.Providers.WCS.AbstractLiveEvent.prototype),t.Providers.WCS.PauseScreenSharingEvent=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.SEND_DOCUMENT),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.SendDocumentEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i){this.filename=e,this.filesize=t,this.fileurl=i}t.prototype={},e.Providers.WCS.SendDocumentEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.SEND_MESSAGE),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.SendMessageEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a){this.message=e,this.targetName=t,this.isPrivate=i,a&&(this.targetId=a)}t.prototype={},e.Providers.WCS.SendMessageEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.SEND_SLIDE),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.SendSlideEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r,s,n,o){this.count=e,this.index=t,this.title=i,this.presentationId=a,this.slideUrl=r,this.slideBaseUrl=s,this.tocUrl=n,this.includeToc=o}t.prototype={},e.Providers.WCS.SendSlideEventData=t}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.WCS.AbstractEvent.call(this,t.Providers.WCS.WCSEventTypes.SERVER_CAPABILITIES),this.data=e}e.prototype=Object.create(t.Providers.WCS.AbstractEvent.prototype),t.Providers.WCS.ServerCapabilitiesEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t){this.maxHeight=e,this.maxWidth=t}t.prototype={},e.Providers.WCS.ServerCapabilitiesEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.SET_NOTE),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.SetNoteEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r,s){this.noteId=e,this.noteType=t,this.text=i,this.attendeeId=a,this.isPersonal=r,s&&(this.targetId=s)}t.prototype={},e.Providers.WCS.SetNoteEventData=t}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.WCS.AbstractLiveEvent.call(this,t.Providers.WCS.WCSEventTypes.SLIDER_EMPTY),this.liveEventCommonData=e}e.prototype=Object.create(t.Providers.WCS.AbstractLiveEvent.prototype),t.Providers.WCS.SliderEmptyEvent=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.SLIDER_SLIDE),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.SliderSlideEvent=e}(AvayaClientServices),function(e){"use strict";function t(e,t){this.slideURL=e,this.thumbUrl=t}t.prototype={},e.Providers.WCS.SliderSlideEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.START_DRAW_SHAPE),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.StartDrawShapeEvent=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.WCS.StartDrawShapeEventData=function(e,t,i,a,r){this.alpha=e,this.color=t,this.groupId=i,this.layerType=a,this.width=r}}(),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.START_MEETING),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.StartMeetingEvent=e}(AvayaClientServices),function(e){"use strict";function t(e){this.userkey=e}t.prototype={},e.Providers.WCS.StartMeetingEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.START_SCREEN_SHARING,e),this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.StartScreenSharingEvent=e}(AvayaClientServices),function(e){"use strict";function t(e){this.transportVersion=e}t.prototype={},e.Providers.WCS.StartScreenSharingEventData=t}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.WCS.AbstractLiveEvent.call(this,i.Providers.WCS.WCSEventTypes.START_WHITEBOARD),this.liveEventCommonData=e,this.data=t}e.prototype=Object.create(i.Providers.WCS.AbstractLiveEvent.prototype),i.Providers.WCS.StartWhiteboardEvent=e}(AvayaClientServices),function(e){"use strict";function t(e){this.id=e}t.prototype={},e.Providers.WCS.StartWhiteboardEventData=t}(AvayaClientServices),function(a){"use strict";function e(e){this.liveEvents=e,this.latestKeyEvents={sharing:m,slider:m}}e.prototype={getOptimizedQueue:function(){var e=[];if(this.liveEvents.length<=1)e=this.liveEvents;else{for(var t=this.liveEvents.length-1;0<=t;t--){var i=this.liveEvents[t];this.isEventValid(i)?e.push(i):a.Base.Logger.debug(a.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Event is invalid: ",i.type)}e.reverse()}return e},isEventValid:function(e){return this.isStartContentSharingEvent(e)?this.isStartSharingEventValid(e):this.isEndContentSharingEvent(e)?this.isEndSharingEventValid(e):this.isMidSharingEvent(e)?this.isMidSharingEventValid():this.isSliderEvent(e)?this.isSliderEventValid():!this.isEmptySliderEvent(e)||this.isEmptySliderEventValid(e)},isStartContentSharingEvent:function(e){return e.type===a.Providers.WCS.WCSEventTypes.START_SCREEN_SHARING},isEndContentSharingEvent:function(e){return e.type===a.Providers.WCS.WCSEventTypes.END_SCREEN_SHARING||e.type===a.Providers.WCS.WCSEventTypes.END_PRESENTATION},isMidSharingEvent:function(e){switch(e.type){case a.Providers.WCS.WCSEventTypes.REQUEST_CONTROL:case a.Providers.WCS.WCSEventTypes.GRANT_CONTROL:case a.Providers.WCS.WCSEventTypes.DECLINE_CONTROL:case a.Providers.WCS.WCSEventTypes.DENY_CONTROL:case a.Providers.WCS.WCSEventTypes.START_CONTROL:case a.Providers.WCS.WCSEventTypes.END_CONTROL:case a.Providers.WCS.WCSEventTypes.ALLOW_PRESENTING:case a.Providers.WCS.WCSEventTypes.DENY_PRESENTING:case a.Providers.WCS.WCSEventTypes.PAUSE_SCREEN_SHARING:case a.Providers.WCS.WCSEventTypes.SEND_SLIDE:return!0;default:return!1}},isSliderEvent:function(e){return e.type===a.Providers.WCS.WCSEventTypes.SLIDER_SLIDE},isEmptySliderEvent:function(e){return e.type===a.Providers.WCS.WCSEventTypes.SLIDER_EMPTY},isStartSharingEventValid:function(e){return!this.latestKeyEvents.sharing&&(this.latestKeyEvents.sharing=e,!0)},isEndSharingEventValid:function(e){return this.latestKeyEvents.sharing||(this.latestKeyEvents.sharing=e),!1},isMidSharingEventValid:function(){return!this.latestKeyEvents.sharing},isEmptySliderEventValid:function(e){return this.latestKeyEvents.slider||(this.latestKeyEvents.slider=e),!1},isSliderEventValid:function(){return!this.latestKeyEvents.slider}},a.Providers.WCS.LiveEventQueueOptimizer=e}(AvayaClientServices),function(e){"use strict";function t(){}t.prototype={parse:function(e){throw new Error("Method not implemented!")},colorHexToInt:function(e){return parseInt("0x".concat(e.slice(1))).toString()},stringToCamel:function(e){return e.replace(/(_[a-z])/g,function(e){return e.toUpperCase().replace("_","")})}},e.Providers.WCS.AbstractParser=t}(AvayaClientServices),function(e){"use strict";function t(){this._onMessageParsedCallbacks=T.Callbacks(),this.msgHeaderDetails={headerSize:8,msgSize:3,flagSize:1,lengthIndicatorSize:4,msgTxt:"msg",textFlagValue:128},this._activeMsg=m}t.prototype.parse=function(e){if(e instanceof ArrayBuffer){var t=e.byteLength;0<t&&this._extractDataFromMsg(0,e,t)}},t.prototype.addOnMessageParsedCallback=function(e){this._onMessageParsedCallbacks.add(e)},t.prototype.removeOnMessageParsedCallback=function(e){this._onMessageParsedCallbacks.remove(e)},t.prototype._parseToString=function(e){for(var t=new Uint8Array(e),i="",a=0;a<t.length;a++)i+=String.fromCharCode(t[a]);return i},t.prototype._extractDataFromMsg=function(e,t,i){if(e<i)if(i-this.msgHeaderDetails.headerSize>=this.msgHeaderDetails.headerSize+1)if(this._parseToString(t.slice(e,e+this.msgHeaderDetails.msgSize))===this.msgHeaderDetails.msgTxt){var a=this._getMessageLength(t.slice(e+this.msgHeaderDetails.msgSize+this.msgHeaderDetails.flagSize,e+this.msgHeaderDetails.headerSize)),r=t.slice(e+this.msgHeaderDetails.headerSize,e+this.msgHeaderDetails.headerSize+a);this._isMsgBinary(t.slice(e+this.msgHeaderDetails.msgSize,e+this.msgHeaderDetails.msgSize+this.msgHeaderDetails.flagSize))||(r=this._parseToString(r)),a+this.msgHeaderDetails.headerSize+e<=i?(this._onMessageParsedCallbacks.fire({data:r}),this._extractDataFromMsg(a+this.msgHeaderDetails.headerSize+e,t,i)):this._activeMsg=t.slice(e,i)}else{var s=this._concatBuffers(this._activeMsg,t);this._extractDataFromMsg(0,s,s.byteLength)}else this._activeMsg=t.slice(e,i)},t.prototype._isMsgBinary=function(e){return 0===new Uint8Array(e)[0]},t.prototype._getMessageLength=function(e){for(var t=new Uint8Array(e),i=0,a=0;a<this.msgHeaderDetails.lengthIndicatorSize;++a)i+=t[a],a<this.msgHeaderDetails.lengthIndicatorSize-1&&(i<<=8);return i},t.prototype._concatBuffers=function(e,t){var i=new Uint8Array(e.byteLength+t.byteLength);return i.set(new Uint8Array(e),0),i.set(new Uint8Array(t),e.byteLength),i.buffer},e.Providers.WCS.CometParser=t}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.AbstractParser.prototype)).parse=function(e){var t={};t.droppedFrames=a.Base.Utils.queryJSONObject(e,"dropped_frames[0]._text"),t.droppedFramesPercentageRounded=a.Base.Utils.queryJSONObject(e,"dropped_frames_percentage_rounded[0]._text"),t.period=a.Base.Utils.queryJSONObject(e,"period[0]._text"),t.successfulFrames=a.Base.Utils.queryJSONObject(e,"successful_frames[0]._text"),t.timeEnd=a.Base.Utils.queryJSONObject(e,"time_end[0]._text"),t.timeStart=a.Base.Utils.queryJSONObject(e,"time_start[0]._text");var i=new a.Providers.WCS.FrameReportEventData(t.droppedFrames,t.droppedFramesPercentageRounded,t.period,t.successfulFrames,t.timeEnd,t.timeStart);return new a.Providers.WCS.FrameReportEvent(i)},a.Providers.WCS.FrameReportParser=e}(AvayaClientServices),function(C){"use strict";function e(){}(e.prototype=Object.create(C.Providers.WCS.AbstractParser.prototype)).parse=function(e){for(var t={liveAttendees:[]},i=0;i<e.live_attendee.length;i++){var a=C.Base.Utils.queryJSONObject(e.live_attendee[i],"attendee_id[0]._text"),r=C.Base.Utils.queryJSONObject(e.live_attendee[i],"client_version[0]._text"),s=C.Base.Utils.queryJSONObject(e.live_attendee[i],"private_chat_supported[0]._text"),n=C.Base.Utils.queryJSONObject(e.live_attendee[i],"start_time[0]._text"),o=C.Base.Utils.queryJSONObject(e.live_attendee[i],"user_agent[0]._text"),c=C.Base.Utils.queryJSONObject(e.live_attendee[i],"user_ip[0]._text"),l=C.Base.Utils.queryJSONObject(e.live_attendee[i],"user_name[0]._text"),d=C.Base.Utils.queryJSONObject(e.live_attendee[i],"ws_connection_id[0]._text");t.liveAttendees.push(new C.Providers.WCS.LiveAttendeeEventData(a,r,s,n,o,c,l,d))}return new C.Providers.WCS.LiveAttendeesEvent(t)},C.Providers.WCS.LiveAttendeesParser=e}(AvayaClientServices),function(i){"use strict";function e(){}(e.prototype=Object.create(i.Providers.WCS.AbstractParser.prototype)).parse=function(e){var t=new i.Providers.WCS.LiveCapabilitiesEventData;return new i.Providers.WCS.LiveCapabilitiesEvent(t)},i.Providers.WCS.LiveCapabilitiesParser=e}(AvayaClientServices),function(t){"use strict";function e(){}var r={whiteboard:"whiteboard_",slide:"slide_"};(e.prototype=Object.create(t.Providers.WCS.AbstractParser.prototype)).stripCommonData=function(e){var i={};return T.each(e._attr,function(e,t){i[this.stringToCamel(e)]=t._value}.bind(this)),new t.Providers.WCS.LiveEventCommonData(i.from,i.fromname,i.id,i.senderId,i.senderName,i.time,i.type,i.useragent,i.wsConnectionId)},e.prototype.convertGroup=function(i){var a;if(T.each(r,function(e,t){if(0===i.indexOf(t))return!(a={groupId:parseInt(i.split(t)[1]),layerType:e})}.bind(this)),a)return a;t.Base.Logger.error(t.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Unknown group prefix type!")},t.Providers.WCS.LiveEventParser=e}(AvayaClientServices),function(r){"use strict";function e(){}(e.prototype=Object.create(r.Providers.WCS.AbstractParser.prototype)).parse=function(e){var t={request_id:r.Base.Utils.queryJSONObject(e,"request_id[0]._text"),idle_timeout:r.Base.Utils.queryJSONObject(e,"idle_timeout[0]._text"),ws_connection_id:r.Base.Utils.queryJSONObject(e,"ws_connection_id[0]._text"),server_time_diff:r.Base.Utils.queryJSONObject(e,"server_time_diff[0]._text")},i={attendeeId:r.Base.Utils.queryJSONObject(e,"attendee_id[0]._text"),userName:r.Base.Utils.queryJSONObject(e,"username[0]._text")},a=new r.Providers.WCS.LiveSessionEventData(t.request_id,t.idle_timeout,t.ws_connection_id,t.server_time_diff,{},i,{});return new r.Providers.WCS.LiveSessionEvent(a)},r.Providers.WCS.LiveSessionParser=e}(AvayaClientServices),function(i){"use strict";function e(){}(e.prototype=Object.create(i.Providers.WCS.AbstractParser.prototype)).parse=function(e){var t=new i.Providers.WCS.LiveViewerEventData(i.Base.Utils.queryJSONObject(e,"brand_id[0]._text"),i.Base.Utils.queryJSONObject(e,"wcs_version[0]._text"),i.Base.Utils.queryJSONObject(e,"websocket_path[0]._text"),+i.Base.Utils.queryJSONObject(e,"websocket_cache_size[0]._text"),+i.Base.Utils.queryJSONObject(e,"upload_size[0]._text"),+i.Base.Utils.queryJSONObject(e,"upload_max_image_size[0]._text"),+i.Base.Utils.queryJSONObject(e,"upload_max_image_resolution[0]._text"),i.Base.Utils.queryJSONObject(e,"upload_types[0]._text"),+i.Base.Utils.queryJSONObject(e,"max_duration[0]._text"),+i.Base.Utils.queryJSONObject(e,"event_wait_time[0]._text"),+i.Base.Utils.queryJSONObject(e,"upload_max_file[0]._text"),i.Base.Utils.queryJSONObject(e,"themes_location[0]._text"),"true"===i.Base.Utils.queryJSONObject(e,"internal_ui_controls[0]._text"));return new i.Providers.WCS.LiveViewerEvent(t)},i.Providers.WCS.LiveViewerParser=e}(AvayaClientServices),function(r){"use strict";function e(){}(e.prototype=Object.create(r.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var i={};if(e.selection[0]._attr&&T.each(e.selection[0]._attr,function(e,t){i[this.stringToCamel(e)]=t._value}.bind(this)),i.group){var t=this.convertGroup(i.group);i.layerType=t.layerType,i.groupId=t.groupId,delete i.group}var a=new r.Providers.WCS.MoveSelectionEventData(i.groupId,i.layerType,i.id,i.moveToX,i.moveToY,i.selectionX,i.selectionY);return new r.Providers.WCS.MoveSelectionEvent(this.stripCommonData(e),a)},r.Providers.WCS.MoveSelectionParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.WCS.LiveEventParser.prototype)).parse=function(e){return new t.Providers.WCS.PauseScreenSharingEvent(this.stripCommonData(e))},t.Providers.WCS.PauseScreenSharingParser=e}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t={};t.filename=a.Base.Utils.queryJSONObject(e,"documentinfo[0]._attr.filename._value"),t.filesize=a.Base.Utils.queryJSONObject(e,"documentinfo[0]._attr.filesize._value"),t.fileurl=a.Base.Utils.queryJSONObject(e,"documentinfo[0]._attr.fileurl._value");var i=new a.Providers.WCS.SendDocumentEventData(t.filename,t.filesize,t.fileurl);return new a.Providers.WCS.SendDocumentEvent(this.stripCommonData(e),i)},a.Providers.WCS.SendDocumentParser=e}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t={};e.message&&(t.message=a.Base.Utils.queryJSONObject(e,"message[0]._text")),t.targetName=a.Base.Utils.queryJSONObject(e,"_attr.target_name._value"),e._attr.target_id?(t.targetId=a.Base.Utils.queryJSONObject(e,"_attr.target_id._value"),t.private=!0):t.private=!1;var i=new a.Providers.WCS.SendMessageEventData(t.message,t.targetName,t.private,t.targetId);return new a.Providers.WCS.SendMessageEvent(this.stripCommonData(e),i)},a.Providers.WCS.SendMessageParser=e}(AvayaClientServices),function(r){"use strict";function e(){}(e.prototype=Object.create(r.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t={},i=r.Base.Utils.queryJSONObject(e,"slide[0]._attr");t.count=i.count._value,t.index=i.index._value,t.title=i.title._value,t.presentationId=i.presentationid._value,t.slideUrl=i.slideurl._value,t.slideBaseUrl=i.slideurl._value,t.tocUrl=i.toc._value,t.includeToc="true"===i.includetoc._value;var a=new r.Providers.WCS.SendSlideEventData(t.count,t.index,t.title,t.presentationId,t.slideUrl,t.slideBaseUrl,t.tocUrl,t.includeToc);return new r.Providers.WCS.SendSlideEvent(this.stripCommonData(e),a)},r.Providers.WCS.SendSlideParser=e}(AvayaClientServices),function(r){"use strict";function e(){}(e.prototype=Object.create(r.Providers.WCS.AbstractParser.prototype)).parse=function(e){var t=r.Base.Utils.queryJSONObject(e,"server_capabilities[0].max_frame_height[0]._text"),i=r.Base.Utils.queryJSONObject(e,"server_capabilities[0].max_frame_width[0]._text"),a=new r.Providers.WCS.ServerCapabilitiesEventData(t,i);return new r.Providers.WCS.ServerCapabilitiesEvent(a)},r.Providers.WCS.ServerCapabilitiesParser=e}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t={};e.note&&(t.type=a.Base.Utils.queryJSONObject(e,"note[0]._attr.type._value"),t.text=a.Base.Utils.queryJSONObject(e,"note[0]._text"),t.noteId=a.Base.Utils.queryJSONObject(e,"note[0]._attr.event_id._value"),t.attendeeId=a.Base.Utils.queryJSONObject(e,"note[0]._attr.attende_id._value")),e._attr.target_id?(t.targetId=a.Base.Utils.queryJSONObject(e,"_attr.target_id._value"),t.personal=!0):t.personal=!1;var i=new a.Providers.WCS.SetNoteEventData(t.noteId,t.type,t.text,t.attendeeId,t.personal,t.targetId);return new a.Providers.WCS.SetNoteEvent(this.stripCommonData(e),i)},a.Providers.WCS.SetNoteParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.WCS.LiveEventParser.prototype)).parse=function(e){return new t.Providers.WCS.SliderEmptyEvent(this.stripCommonData(e))},t.Providers.WCS.SliderEmptyParser=e}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t={};a.Base.Utils.queryJSONObject(e,"data[0].slide_url[0]")?(t.slideURL=a.Base.Utils.queryJSONObject(e,"data[0].slide_url[0]._text"),t.thumbUrl=a.Base.Utils.queryJSONObject(e,"data[0].thumbnail_url[0]._text")):(t.slideURL=a.Base.Utils.queryJSONObject(e,"data[0].sliderUrl[0]._text"),t.thumbUrl=a.Base.Utils.queryJSONObject(e,"data[0].thumbUrl[0]._text"));var i=new a.Providers.WCS.SliderSlideEventData(t.slideURL,t.thumbUrl);return new a.Providers.WCS.SliderSlideEvent(this.stripCommonData(e),i)},a.Providers.WCS.SliderSlideParser=e}(AvayaClientServices),function(r){"use strict";function e(){}(e.prototype=Object.create(r.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var i={};if(e.lines[0]._attr&&T.each(e.lines[0]._attr,function(e,t){i[this.stringToCamel(e)]=t._value}.bind(this)),r.Base.Utils.isDefined(i.color)&&(i.color=r.Base.Utils.colorIntToHex(i.color)),i.group){var t=this.convertGroup(i.group);i.layerType=t.layerType,i.groupId=t.groupId,delete i.group}var a=new r.Providers.WCS.StartDrawShapeEventData(i.alpha,i.color,i.groupId,i.layerType,i.width);return new r.Providers.WCS.StartDrawShapeEvent(this.stripCommonData(e),a)},r.Providers.WCS.StartDrawShapeParser=e}(AvayaClientServices),function(i){"use strict";function e(){}(e.prototype=Object.create(i.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t=new i.Providers.WCS.StartMeetingEventData("173621");return new i.Providers.WCS.StartMeetingEvent(this.stripCommonData(e),t)},i.Providers.WCS.StartMeetingParser=e}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t=a.Base.Utils.queryJSONObject(e,"transport_version[0]._text"),i=new a.Providers.WCS.StartScreenSharingEventData(t);return new a.Providers.WCS.StartScreenSharingEvent(this.stripCommonData(e),i)},a.Providers.WCS.StartScreenSharingParser=e}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t=a.Base.Utils.queryJSONObject(e,"whiteboard[0]._attr.index._value"),i=new a.Providers.WCS.StartWhiteboardEventData(t);return new a.Providers.WCS.StartWhiteboardEvent(this.stripCommonData(e),i)},a.Providers.WCS.StartWhiteboardParser=e}(AvayaClientServices),function(i){"use strict";function e(e){this._position=0,this._buffer=e,this.length=this._buffer.byteLength}e.prototype={getBuffer:function(){return this._buffer},setPosition:function(e){this._position=e},getPosition:function(){return this._position},getBytesAvailable:function(){return this._buffer.byteLength-this._position},readBytes:function(e){var t=new i.Providers.WCS.ByteArray(this._buffer.slice(this._position,this._position+e));return this._position+=e,t},readByte:function(){var e=new Int8Array(this._buffer.slice(this._position,this._position+1));return this._position++,e[0]},readUnsignedInt:function(){var e=new DataView(this._buffer.slice(this._position,this._position+4));return this._position+=4,e.getUint32(0)},readShort:function(){var e=new DataView(this._buffer.slice(this._position,this._position+2));return this._position+=2,e.getInt16(0)},readInt:function(){var e=new DataView(this._buffer.slice(this._position,this._position+4));return this._position+=4,e.getInt32(0)}},i.Providers.WCS.ByteArray=e}(AvayaClientServices),function(e){"use strict";function t(){this._bitmapElements=[],this.width=0,this.height=0,this.isKeyFrame=!1}t.prototype={setStartTag:function(e){return this.width=e.width,this.height=e.height,this.isKeyFrame=e.isKeyFrame,this},addBitmapElement:function(e){return this._bitmapElements.push(e),this}},e.Providers.WCS.Frame=t}(AvayaClientServices),function(e){"use strict";function t(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.bitmapData=e.data.getBuffer(),this.imageType=e.imageType}t.prototype={},e.Providers.WCS.FrameBitmapLoader=t}(AvayaClientServices),function(i){"use strict";function e(){this._frame=m}e.prototype={processTag:function(e,t){switch(e.type){case i.Providers.WCS.WCSScreenSharingTagTypes.START_TAG:this._startFrame(e);break;case i.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG:this._addBinaryBlock(e);break;case i.Providers.WCS.WCSScreenSharingTagTypes.END_TAG:this._endFrame(t);break;default:i.Base.Logger.warn(i.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Unknown tag type received: {0}",e.type)}},_startFrame:function(e){i.Base.Logger.debug(i.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Add start Tag"),this._frame=new i.Providers.WCS.Frame,this._frame.setStartTag(e)},_addBinaryBlock:function(e){if(this._frame&&0<e.data.length){var t=new i.Providers.WCS.FrameBitmapLoader(e);this._frame.addBitmapElement(t)}},_endFrame:function(e){this._frame?(i.Base.Logger.debug(i.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Add End Tag - end Frame",this._frame._bitmapElements.length),e(this._frame),this._frame=m):i.Base.Logger.debug(i.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"There was no Start Tag for this End Tag")}},i.Providers.WCS.FrameBuilder=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.WCS.ScreenSharingImageTypes={JPEG:0,PNG:1,JPEG_RED_WITH_BLACK:2}}(),function(e){"use strict";AvayaClientServices.Providers.WCS.ScreenSharingKeyFrameTypes={INTRA_FRAME:0,KEY_FRAME:1}}(),function(s){"use strict";s.Providers.WCS.ScreenSharingTagEncoder=function(){},s.Providers.WCS.ScreenSharingTagEncoder.prototype={encodeTag:function(e){switch(e.type){case s.Providers.WCS.WCSScreenSharingTagTypes.START_TAG:return this._encodeStartFrame(e);case s.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG:return this._encodeBinaryBlock(e);case s.Providers.WCS.WCSScreenSharingTagTypes.END_TAG:return this._encodeEndFrame();default:s.Base.Logger.warn(s.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Unknown tag type received: {0}",e.type)}},_encodeStartFrame:function(e){var t=new ArrayBuffer(14),i=new DataView(t);i.setInt8(0,s.Providers.WCS.WCSScreenSharingTagTypes.START_TAG),i.setInt8(1,e.isKeyFrame?s.Providers.WCS.ScreenSharingKeyFrameTypes.KEY_FRAME:s.Providers.WCS.ScreenSharingKeyFrameTypes.INTRA_FRAME),i.setInt16(2,e.width),i.setInt16(4,e.height);for(var a=this._getCurrentTimeStamp(e.creationTime),r=0;r<a.length;r++)i.setInt8(6+r,a[r]);return t},_encodeBinaryBlock:function(e){var t=new ArrayBuffer(18+e.data.length),i=new Uint8Array(t),a=new DataView(t);return a.setInt8(0,s.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG),a.setInt16(1,e.width),a.setInt16(3,e.height),a.setInt16(5,e.x),a.setInt16(7,e.y),a.setInt8(9,e.imageType),0===e.length?a.setInt32(10,e.data.length):a.setInt32(10,e.length),a.setInt32(14,0),i.set(e.data,18),t},_encodeEndFrame:function(){var e=new ArrayBuffer(1);return new DataView(e).setInt8(0,s.Providers.WCS.WCSScreenSharingTagTypes.END_TAG),e},_getCurrentTimeStamp:function(e){var t=this._longToByteArray(e);return t.reverse(),t},_longToByteArray:function(e){for(var t=[0,0,0,0,0,0,0,0],i=0;i<t.length;i++){var a=255&e;e=(e-(t[i]=a))/256}return t}}}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.WCS.WCSScreenSharingTagTypes={START_TAG:0,BLOCK_TAG:1,CURSOR_TAG:2,END_TAG:3}}(),function(e){"use strict";AvayaClientServices.Providers.WCS.WCSSharingTag=function(e){this.type=e}}(),function(n){"use strict";function e(){this._parsers={}}e.prototype={parse:function(e){var t;if(0<e.byteLength){var i=new n.Providers.WCS.ByteArray(e),a=i.readByte(),r=a>>4,s=15&a;this._parsers[r]&&this._parsers[r][s]&&(t=this._parsers[r][s].parse(i))}else n.Base.Logger.warn(n.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Buffer length = 0. Parse process skipped.");return t},registerParser:function(e,t,i){this._parsers[e]||(this._parsers[e]={}),this._parsers[e][t]=i}},n.Providers.WCS.WCSBinaryParser=e}(AvayaClientServices),function(r){"use strict";function e(e){this._frameBuilder=e,this._lastPoint=m,this._timeout=m,this._isKeyFrameArrived=!1}e.prototype={updateFrame:function(a,e){this._frameBuilder.processTag(e,function(e){var t=e._bitmapElements.map(function(e){return new r.Services.Collaboration.Bitmap(e.x,e.y,e.width,e.height,e.imageType,e.bitmapData)}),i=new r.Services.Collaboration.Frame(e.width,e.height,t,e.isKeyFrame);i.isKeyFrame()?(this._isKeyFrameArrived=!0,a._contentSharing._onFrameReceivedCallbacks.fire(a._contentSharing,i)):this._isKeyFrameArrived?a._contentSharing._onFrameChangedCallbacks.fire(a._contentSharing,i):r.Base.Logger.warn(r.Base.LoggerTags.WCS_CONTENT_SHARING_HANDLER,"A normal frame has arrived before the key frame")}.bind(this))},updateCursor:function(e,t){this._lastPoint=new r.Services.Collaboration.Point(t.x,t.y),this._timeout||(this._timeout=setTimeout(function(){e._contentSharing._onCursorReceivedCallbacks.fire(e._contentSharing,this._lastPoint),this._timeout=m}.bind(this),100))},startScreenSharing:function(e,t){var i=this._getParticipant(e,t);e._contentSharing._contentSharingService._sharingState=r.Services.Collaboration.ContentSharingState.SHARING,!0===e._contentSharing._isPaused?(e._contentSharing._isPaused=!1,e._contentSharing._onContentSharingResumedCallbacks.fire(e._contentSharing,i)):e._contentSharing._onContentSharingStartedCallbacks.fire(e._contentSharing,i)},pauseScreenSharing:function(e,t){e._contentSharing._isPaused=!0;var i=this._getParticipant(e,t);e._contentSharing._contentSharingService._sharingState=r.Services.Collaboration.ContentSharingState.PAUSED,e._contentSharing._onContentSharingPausedCallbacks.fire(e._contentSharing,i)},endScreenSharing:function(e,t){this._isKeyFrameArrived=!1;var i=this._getParticipant(e,t);e._contentSharing._isPaused=!1,e._contentSharing._contentSharingService._sharingState=r.Services.Collaboration.ContentSharingState.NOT_SHARING,e._contentSharing._onContentSharingEndedCallbacks.fire(e._contentSharing,i)},endScreenSharingByParticipant:function(e,t){this._isKeyFrameArrived=!1,e._contentSharing._isPaused=!1,e._contentSharing._contentSharingService._sharingState=r.Services.Collaboration.ContentSharingState.NOT_SHARING,e._contentSharing._onContentSharingEndedCallbacks.fire(e._contentSharing,t)},frameReport:function(e,t){e._contentSharing._onFrameReportReceivedCallbacks.fire(e._contentSharing,t)},_getParticipant:function(e,t){var i=e._participants.filter(function(e){return e.getParticipantId()===t.senderId})[0];return i||(i=new r.Services.Collaboration.Participant(t.senderId,t.senderName),e._participants.push(i)),i}},r.Providers.WCS.WCSContentSharingHandler=e}(AvayaClientServices),function(o,c){"use strict";function e(){this.parsers=[]}e.prototype={register:function(e,t){this.parsers[e]=t},unregister:function(e){this.parsers[e]=m},parse:function(e){var t;"string"==typeof e?t=c.parseString(e):"object"==typeof e&&(t=e);var a,i=t.response[0],r=[];if(i.error){a=o.Providers.WCS.WCSEventTypes.ERROR;var s=i.error[0];return r.push(this.delegateParser(a,s)),r}if(i.live_events){if(i.live_events[0]&&i.live_events[0].event){T.each(i.live_events[0].event,function(e,t){a=t._attr.type._value;var i=this.delegateParser(a,t);i!==m&&r.push(i)}.bind(this));var n=new o.Providers.WCS.LiveEventQueueOptimizer(r);r=n.getOptimizedQueue()}return r}if(i.live_event||i.live_ping)return[];if(i.live_session)return a=o.Providers.WCS.WCSEventTypes.LIVE_SESSION,r.push(this.delegateParser(a,i.live_session[0])),r;if(i.frame_report)return a=o.Providers.WCS.WCSEventTypes.FRAME_REPORT,r.push(this.delegateParser(a,i.frame_report[0])),r;if(i.live_viewer)return a=o.Providers.WCS.WCSEventTypes.LIVE_VIEWER,r.push(this.delegateParser(a,i.live_viewer[0])),r;if(i.live_capabilities)return a=o.Providers.WCS.WCSEventTypes.LIVE_CAPABILITIES,r.push(this.delegateParser(a,i.live_capabilities[0])),r;if(i.live_attendees)return a=o.Providers.WCS.WCSEventTypes.LIVE_ATTENDEES,r.push(this.delegateParser(a,i.live_attendees[0])),r;throw new Error("No parser specified!")},delegateParser:function(e,t){if(this.parsers[e]!==m)return this.parsers[e].parse(t);o.Base.Logger.error(o.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"No parser specified!",e)}},o.Providers.WCS.WCSEventsParser=e}(AvayaClientServices,xmlToJSON),function(e){"use strict";AvayaClientServices.Providers.WCS.WCSEventTypes={START_WHITEBOARD:"StartWhiteboard",ADD_WHITEBOARD:"AddWhiteboard",DELETE_WHITEBOARD:"DeleteWhiteboard",START_DRAW_SHAPE:"StartDrawShape",DRAW_SHAPE:"DrawShape",END_DRAW_SHAPE:"EndDrawShape",DRAW_CIRCLE:"DrawCircle",DRAW_TEXT:"DrawText",MOVE_SELECTION:"MoveSelection",DELETE_SELECTION:"DeleteSelection",CLEAR_DRAWING:"ClearDrawing",END_WHITEBOARD:"EndWhiteboard",SEND_SLIDE:"SendSlide",END_PRESENTATION:"EndPresentation",SEND_MESSAGE:"SendMessage",ADD_NOTE:"AddNote",SET_NOTE:"SetNote",DELETE_NOTE:"DeleteNote",START_SCREEN_SHARING:"StartScreenSharing",PAUSE_SCREEN_SHARING:"PauseScreenSharing",END_SCREEN_SHARING:"EndScreenSharing",REQUEST_CONTROL:"RequestControl",GRANT_CONTROL:"GrantControl",START_CONTROL:"StartControl",DECLINE_CONTROL:"DeclineControl",DENY_CONTROL:"DenyControl",SEND_DOCUMENT:"SendDocument",END_CONTROL:"EndControl",ALLOW_PRESENTING:"AllowPresenting",DENY_PRESENTING:"DenyPresenting",EJECT_PARTICIPANT:"EjectParticipant",START_MEETING:"StartMeeting",END_MEETING:"EndMeeting",DRAW_CURSOR:"DrawCursor",DRAW_FRAME:"DrawFrame",LIVE_VIEWER:"LiveViewer",FRAME_REPORT:"FrameReport",ERROR:"Error",LIVE_SESSION:"LiveSession",LIVE_ATTENDEES:"LiveAttendees",LIVE_ATTENDEE:"LiveAttendee",LIVE_CAPABILITIES:"LiveCapabilities",SERVER_CAPABILITIES:"ServerCapabilities",SLIDER_SLIDE:"SliderSlide",SLIDER_EMPTY:"SliderEmpty"}}(),function(c){"use strict";function e(){this._config=m,this._participant=m,this._meetingId=m}e.prototype={buildDrawCircleMessage:function(e,t,i,a,r){var s=this._buildDrawCircleEventData(e,t);return this._decorateRequest(c.Providers.WCS.WCSEventTypes.DRAW_CIRCLE,i,a,r,s)},buildResourceDiscoveryMessage:function(e,t,i,a,r){return{mode:e,meeting_id:t,participant_id:i,username:a,token:r}},buildMoveSelectionMessage:function(e,t,i,a,r,s,n){var o=this._buildMoveSelectionEventData(e,t,i,a);return this._decorateRequest(c.Providers.WCS.WCSEventTypes.MOVE_SELECTION,r,s,n,o)},buildDrawShapeMessage:function(e,t,i,a,r){var s=this._buildDrawShapeEventData(e,t);return this._decorateRequest(c.Providers.WCS.WCSEventTypes.DRAW_SHAPE,i,a,r,s)},buildLiveDrawShapeMessage:function(e,t,i,a,r){var s=this._buildLiveDrawShapeEventData(e,t);return this._decorateRequest(c.Providers.WCS.WCSEventTypes.DRAW_SHAPE,i,a,r,s)},buildFirstPointLiveDrawShapeMessage:function(e,t,i,a){var r=this._buildFirstPointLiveDrawShapeEventData(e);return this._decorateRequest(c.Providers.WCS.WCSEventTypes.DRAW_SHAPE,t,i,a,r)},buildStartDrawShapeMessage:function(e,t,i,a,r){var s=this._buildStartDrawShapeEventData(e,t);return this._decorateRequest(c.Providers.WCS.WCSEventTypes.START_DRAW_SHAPE,i,a,r,s)},buildEndDrawShapeMessage:function(e,t,i,a,r){var s=this._buildEndDrawShapeEventData(e,t);return this._decorateRequest(c.Providers.WCS.WCSEventTypes.END_DRAW_SHAPE,i,a,r,s)},buildDrawTextMessage:function(e,t,i,a,r){var s=this._buildDrawTextEventData(e,t);return this._decorateRequest(c.Providers.WCS.WCSEventTypes.DRAW_TEXT,i,a,r,s)},buildAddWhiteboardMessage:function(e,t,i){return this._decorateRequest(c.Providers.WCS.WCSEventTypes.ADD_WHITEBOARD,e,t,i)},buildEndWhiteboardMessage:function(e,t,i){return this._decorateRequest(c.Providers.WCS.WCSEventTypes.END_WHITEBOARD,e,t,i)},buildRemoveWhiteboardMessage:function(e,t,i,a){var r='<whiteboard index="'+e+'"/>';return this._decorateRequest(c.Providers.WCS.WCSEventTypes.DELETE_WHITEBOARD,t,i,a,r)},buildStartWhiteboardMessage:function(e,t,i,a){var r='<whiteboard index="';return c.Base.Utils.isDefined(a)&&(r+=a),r+='"/>',this._decorateRequest(c.Providers.WCS.WCSEventTypes.START_WHITEBOARD,e,t,i,r)},buildLiveEventMessage:function(e,t,i,a){return this._decorateRequest(e,t,i,a)},buildStartScreenSharingMessage:function(e,t,i){return this._decorateRequest(c.Providers.WCS.WCSEventTypes.START_SCREEN_SHARING,e,t,i,"<transport_version>1</transport_version>")},buildStopScreenSharingMessage:function(e,t,i){return this._decorateRequest(c.Providers.WCS.WCSEventTypes.END_SCREEN_SHARING,e,t,i)},buildPauseScreenSharingMessage:function(e,t,i){return this._decorateRequest(c.Providers.WCS.WCSEventTypes.PAUSE_SCREEN_SHARING,e,t,i)},buildClearContentMessage:function(e,t,i,a){var r='<selection group="whiteboard_'+e+'"/>';return this._decorateRequest(c.Providers.WCS.WCSEventTypes.CLEAR_DRAWING,t,i,a,r)},buildGetParticipantsMessage:function(e){return"live_attendees?rc_only="+!!e+"&request_id="+c.Base.Utils.makeId(32,"abcdefgijklmnopqrstuvwxyz0123456789")},_buildMoveSelectionEventData:function(e,t,i,a){var r=e.getTranslation();return'<selection group="whiteboard_'+t+'" id="'+e.getId()+'" moveToX="'+r.getX()+'" moveToY="'+r.getY()+'" selectionX="'+i+'" selectionY="'+a+'"/>'},buildDeleteSelectionMessage:function(e,t,i,a,r,s,n){var o=this._buildDeleteSelectionEventData(e,t,i,a);return this._decorateRequest(c.Providers.WCS.WCSEventTypes.DELETE_SELECTION,r,s,n,o)},buildPauseMessage:function(){return"live_capabilities?sharing_reception=false&request_id="+c.Base.Utils.makeId(32,"0123456789abcdef")},buildResumeMessage:function(){return"live_capabilities?sharing_reception=true&request_id="+c.Base.Utils.makeId(32,"0123456789abcdef")},_buildDeleteSelectionEventData:function(e,t,i,a){return'<selection group="whiteboard_'+t+'" id="'+e._id+'" selectionX="'+i+'" selectionY="'+a+'"/>'},_buildDrawCircleEventData:function(e,t){var i='<circle alpha="'+e.getAlpha()+'" group="whiteboard_'+t+'" x0="'+e.getTopLeft().getX()+'" x1="'+e.getBottomRight().getX()+'" y0="'+e.getTopLeft().getY()+'" y1="'+e.getBottomRight().getY()+'"';return e.isFilled()?i+=' fillColor="'+e.getColor()+'"':i+=' color="'+e.getColor()+'"',i=i+' width="'+e.getWidth()+'" />'},_buildDrawShapeEventData:function(e,t){var i='<lines group="whiteboard_'+t+'" alpha="'+e.getAlpha()+'" width="'+e.getWidth()+'"';e.isFilled()?i+=' fillColor="'+e.getColor()+'"':i+=' color="'+e.getColor()+'"',i+=">";for(var a=0,r=e.getPoints();a<r.length;a++){var s=r[a];s.isMove?i+='<m x="'+s.point.getX()+'" y="'+s.point.getY()+'"/>':i+='<l x="'+s.point.getX()+'" y="'+s.point.getY()+'"/>'}return i+="</lines>"},_buildFirstPointLiveDrawShapeEventData:function(e){return'<m x="'+e.getX()+'" y="'+e.getY()+'"/>'},_buildLiveDrawShapeEventData:function(e,t){var i="",a=0;for(e[0].isMove&&(a=1,i+='<m x="'+e[0].point.getX()+'" y="'+e[0].point.getY()+'"/>'),i+='<lines group="whiteboard_'+t+'">';a<e.length;a++){var r=e[a];r.isMove?i+='<m x="'+r.point.getX()+'" y="'+r.point.getY()+'"/>':i+='<l x="'+r.point.getX()+'" y="'+r.point.getY()+'"/>'}return i+="</lines>"},_buildStartDrawShapeEventData:function(e,t){var i='<lines group="whiteboard_'+t+'" alpha="'+e.getAlpha()+'" width="'+e.getWidth()+'"';return e.isFilled()?i+=' fillColor="'+e.getColor()+'"':i+=' color="'+e.getColor()+'"',i+="/>"},_buildEndDrawShapeEventData:function(e,t){return'<lines group="whiteboard_'+t+'"/>'},_buildDrawTextEventData:function(e,t){return'<drawText fillColor="'+e.getColor()+'" fontSize="'+e.getFontSize()+'" group="whiteboard_'+t+'" text="'+this._escapeXMLSpecialChars(e.getContent())+'" x="'+e.getPosition().getX()+'" y="'+e.getPosition().getY()+'"/>'},_translateColor:function(e){return parseInt("0x".concat(e.slice(1))).toString()},_decorateRequest:function(e,t,i,a,r){return"live_event"+(r?"?event_data="+encodeURIComponent(r)+"&":"?")+"event_type="+e+"&meeting_id="+t+"&sender_id="+i+"&sender_name="+encodeURIComponent(a)+"&request_id="+c.Base.Utils.makeId(32,"0123456789abcdef")},_escapeXMLSpecialChars:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\n/g,"&#xA;")}},c.Providers.WCS.WCSMessageBuilder=e}(AvayaClientServices),function(e){"use strict";function t(){e.Providers.Interfaces.CollaborationProvider.call(this),this._providers=[],this._selectedProvider=m,this._config={}}(t.prototype=Object.create(e.Providers.Interfaces.CollaborationProvider.prototype)).stop=function(){return e.Base.Utils.isDefined(this._selectedProvider)?this._selectedProvider.stop():T.Deferred().resolve().promise()},t.prototype.registerWCSProvider=function(e,t){this._providers.push({version:e,provider:t})},t.prototype.start=function(e,t){return T.isEmptyObject(e)||this._config===e||(this._config=e.wcsConfiguration),this._selectedProvider=this._providers[0].provider,this._selectedProvider.start(e.wcsConfiguration,t)},t.prototype.on=function(e,t){this._selectedProvider.on(e,t)},t.prototype.off=function(e,t){this._selectedProvider.off(e,t)},t.prototype.getReceivingBitrate=function(){return this._selectedProvider.getReceivingBitrate()},t.prototype.getBufferedAmount=function(){return this._selectedProvider.getBufferedAmount()},t.prototype.addCircle=function(e,t){return this._selectedProvider.addCircle(e,t)},t.prototype.pause=function(){return this._selectedProvider.pause()},t.prototype.resume=function(){return this._selectedProvider.resume()},t.prototype.addText=function(e,t){return this._selectedProvider.addText(e,t)},t.prototype.addShape=function(e,t){return this._selectedProvider.addShape(e,t)},t.prototype.discoverResources=function(e){return this._selectedProvider.discoverResources(e)},t.prototype.startDrawShape=function(e,t){return this._selectedProvider.startDrawShape(e,t)},t.prototype.liveDrawShape=function(e,t){return this._selectedProvider.liveDrawShape(e,t)},t.prototype.endDrawShape=function(e,t){return this._selectedProvider.endDrawShape(e,t)},t.prototype.moveSelection=function(e,t,i){return this._selectedProvider.moveSelection(e,t,i)},t.prototype.observeCollaboration=function(e){this._selectedProvider.observeCollaboration(e)},t.prototype.startWhiteboard=function(e){return this._selectedProvider.startWhiteboard(e)},t.prototype.endWhiteboard=function(e){return this._selectedProvider.endWhiteboard(e)},t.prototype.addWhiteboardSurface=function(){return this._selectedProvider.addWhiteboardSurface()},t.prototype.removeWhiteboardSurface=function(e){return this._selectedProvider.removeWhiteboardSurface(e)},t.prototype.sendBlocks=function(e){return this._selectedProvider.sendBlocks(e)},t.prototype.startScreenSharing=function(){return this._selectedProvider.startScreenSharing()},t.prototype.stopScreenSharing=function(){return this._selectedProvider.stopScreenSharing()},t.prototype.pauseScreenSharing=function(){return this._selectedProvider.pauseScreenSharing()},t.prototype.sendLiveEvent=function(e){return this._selectedProvider.sendLiveEvent(e)},t.prototype.removeShape=function(e,t,i){return this._selectedProvider.removeShape(e,t,i)},t.prototype.clearContent=function(e){return this._selectedProvider.clearContent(e)},t.prototype.getParticipants=function(){return this._selectedProvider.getParticipants()},t.prototype.isOpened=function(){return this._selectedProvider&&this._selectedProvider.isOpened()},t.prototype.isFeatureAvailable=function(e){return this._selectedProvider&&this._selectedProvider.isFeatureAvailable(e)},t.prototype.run=function(e){return this._selectedProvider.run(e)},t.prototype.getServerCapabilities=function(){return this._selectedProvider.getServerCapabilities()},t.prototype.isWhiteboardActive=function(){return this._selectedProvider.isWhiteboardActive()},e.Providers.WCS.WCSProvider=t}(AvayaClientServices),function(p){"use strict";function e(){this._collaborationProvider={}}e.prototype={getWCSProvider:function(e){if(p.Base.Utils.isDefined(e)&&e.enabled){if(T.isEmptyObject(this._collaborationProvider)){var t=this._createWCSv1_1Provider();this._collaborationProvider=new p.Providers.WCS.WCSProvider,this._collaborationProvider.registerWCSProvider("1.1",t)}return this._collaborationProvider}},_createWCSv1_1Provider:function(){var e=new p.Base.RESTProvider,t=new p.Base.NetworkProvider(e,m,p.Base.LoggerTags.WCS_COLLABORATION_PROVIDER),i=new p.Providers.WCS.CometParser,a=new p.Providers.WCS.WCSCometProvider(i),r=new p.Providers.WCS.WCSTransactionalWebSocketProvider,s=new p.Base.NetworkProvider(r,a,p.Base.LoggerTags.WCS_COLLABORATION_PROVIDER),n=this._createEventsParser(),o=this._createBinaryParser(),c=new p.Providers.WCS.FrameBuilder,l=new p.Providers.WCS.WCSMessageBuilder,d=new p.Providers.WCS.WCSContentSharingHandler(c),C=new p.Providers.WCS.WCSShapeConverter,u=new p.Providers.WCS.WCSWhiteboardHandler(C),v=new p.Services.Analytics.CollaborationsAnalyticsService,h=new p.Providers.WCS.WCSSliderHandler;return new p.Providers.WCS.WCSv1_1Provider(t,n,o,l,d,u,h,s,v)},_createEventsParser:function(){var e=new p.Providers.WCS.WCSEventsParser;return e.register(p.Providers.WCS.WCSEventTypes.ERROR,new p.Providers.WCS.ErrorParser),e.register(p.Providers.WCS.WCSEventTypes.LIVE_SESSION,new p.Providers.WCS.LiveSessionParser),e.register(p.Providers.WCS.WCSEventTypes.LIVE_VIEWER,new p.Providers.WCS.LiveViewerParser),e.register(p.Providers.WCS.WCSEventTypes.SEND_MESSAGE,new p.Providers.WCS.SendMessageParser),e.register(p.Providers.WCS.WCSEventTypes.DRAW_SHAPE,new p.Providers.WCS.DrawShapeParser),e.register(p.Providers.WCS.WCSEventTypes.DRAW_CIRCLE,new p.Providers.WCS.DrawCircleParser),e.register(p.Providers.WCS.WCSEventTypes.MOVE_SELECTION,new p.Providers.WCS.MoveSelectionParser),e.register(p.Providers.WCS.WCSEventTypes.DELETE_SELECTION,new p.Providers.WCS.DeleteSelectionParser),e.register(p.Providers.WCS.WCSEventTypes.CLEAR_DRAWING,new p.Providers.WCS.ClearDrawingParser),e.register(p.Providers.WCS.WCSEventTypes.DRAW_TEXT,new p.Providers.WCS.DrawTextParser),e.register(p.Providers.WCS.WCSEventTypes.START_DRAW_SHAPE,new p.Providers.WCS.StartDrawShapeParser),e.register(p.Providers.WCS.WCSEventTypes.END_DRAW_SHAPE,new p.Providers.WCS.EndDrawShapeParser),e.register(p.Providers.WCS.WCSEventTypes.START_WHITEBOARD,new p.Providers.WCS.StartWhiteboardParser),e.register(p.Providers.WCS.WCSEventTypes.ADD_WHITEBOARD,new p.Providers.WCS.AddWhiteboardParser),e.register(p.Providers.WCS.WCSEventTypes.DELETE_WHITEBOARD,new p.Providers.WCS.DeleteWhiteboardParser),e.register(p.Providers.WCS.WCSEventTypes.END_WHITEBOARD,new p.Providers.WCS.EndWhiteboardParser),e.register(p.Providers.WCS.WCSEventTypes.START_MEETING,new p.Providers.WCS.StartMeetingParser),e.register(p.Providers.WCS.WCSEventTypes.START_SCREEN_SHARING,new p.Providers.WCS.StartScreenSharingParser),e.register(p.Providers.WCS.WCSEventTypes.PAUSE_SCREEN_SHARING,new p.Providers.WCS.PauseScreenSharingParser),e.register(p.Providers.WCS.WCSEventTypes.END_SCREEN_SHARING,new p.Providers.WCS.EndScreenSharingParser),e.register(p.Providers.WCS.WCSEventTypes.GRANT_CONTROL,new p.Providers.WCS.GrantControlParser),e.register(p.Providers.WCS.WCSEventTypes.ADD_NOTE,new p.Providers.WCS.AddNoteParser),e.register(p.Providers.WCS.WCSEventTypes.DELETE_NOTE,new p.Providers.WCS.DeleteNoteParser),e.register(p.Providers.WCS.WCSEventTypes.SET_NOTE,new p.Providers.WCS.SetNoteParser),e.register(p.Providers.WCS.WCSEventTypes.DENY_CONTROL,new p.Providers.WCS.DenyControlParser),e.register(p.Providers.WCS.WCSEventTypes.END_CONTROL,new p.Providers.WCS.EndControlParser),e.register(p.Providers.WCS.WCSEventTypes.END_MEETING,new p.Providers.WCS.EndMeetingParser),e.register(p.Providers.WCS.WCSEventTypes.SEND_DOCUMENT,new p.Providers.WCS.SendDocumentParser),e.register(p.Providers.WCS.WCSEventTypes.ALLOW_PRESENTING,new p.Providers.WCS.AllowPresentingParser),e.register(p.Providers.WCS.WCSEventTypes.DENY_PRESENTING,new p.Providers.WCS.DenyPresentingParser),e.register(p.Providers.WCS.WCSEventTypes.EJECT_PARTICIPANT,new p.Providers.WCS.EjectParticipantParser),e.register(p.Providers.WCS.WCSEventTypes.LIVE_ATTENDEES,new p.Providers.WCS.LiveAttendeesParser),e.register(p.Providers.WCS.WCSEventTypes.FRAME_REPORT,new p.Providers.WCS.FrameReportParser),e.register(p.Providers.WCS.WCSEventTypes.LIVE_CAPABILITIES,new p.Providers.WCS.LiveCapabilitiesParser),e.register(p.Providers.WCS.WCSEventTypes.SERVER_CAPABILITIES,new p.Providers.WCS.ServerCapabilitiesParser),e.register(p.Providers.WCS.WCSEventTypes.SLIDER_SLIDE,new p.Providers.WCS.SliderSlideParser),e.register(p.Providers.WCS.WCSEventTypes.SLIDER_EMPTY,new p.Providers.WCS.SliderEmptyParser),e},_createBinaryParser:function(){var e=new p.Providers.WCS.WCSBinaryParser;return e.registerParser(p.Providers.WCS.WCSTransmissionTypes.SCREEN_SHARING,p.Providers.WCS.WCSScreenSharingTagTypes.START_TAG,new p.Providers.WCS.StartTagBinaryParser),e.registerParser(p.Providers.WCS.WCSTransmissionTypes.SCREEN_SHARING,p.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG,new p.Providers.WCS.BlockTagBinaryParser),e.registerParser(p.Providers.WCS.WCSTransmissionTypes.SCREEN_SHARING,p.Providers.WCS.WCSScreenSharingTagTypes.CURSOR_TAG,new p.Providers.WCS.CursorTagBinaryParser),e.registerParser(p.Providers.WCS.WCSTransmissionTypes.SCREEN_SHARING,p.Providers.WCS.WCSScreenSharingTagTypes.END_TAG,new p.Providers.WCS.EndTagBinaryParser),e}},p.Providers.WCS.WCSProviderFactory=e}(AvayaClientServices),function(C){"use strict";function e(){}e.prototype={convertShape:function(e,t){var i=this._determineColor(e.data),a=e.liveEventCommonData.fromname,r=e.data.filled,s=e.liveEventCommonData.senderId===t,n=e.data.alpha,o=e.data.width,c=new C.Services.Collaboration.Shape(a,r,s,i,n,o);if(c.setId(e.liveEventCommonData.eventId),C.Base.Utils.isDefined(e.data.m))for(var l=0;l<e.data.m.length;l++)c.addMovePoint(new C.Services.Collaboration.Point(e.data.m[l].x,e.data.m[l].y));if(C.Base.Utils.isDefined(e.data.l))for(var d=0;d<e.data.l.length;d++)c.addLinePoint(new C.Services.Collaboration.Point(e.data.l[d].x,e.data.l[d].y));return c},convertLiveShape:function(e,t){var i=e.liveEventCommonData.fromname,a=e.liveEventCommonData.senderId===t,r=this._convertColor(e.data.color),s=e.data.alpha,n=e.data.width,o=new C.Services.Collaboration.Shape(i,!1,a,r,s,n);return o.setId(e.liveEventCommonData.eventId),o},convertText:function(e,t){var i=e.data.text,a=e.liveEventCommonData.fromname,r=e.data.filled,s=e.liveEventCommonData.senderId===t,n=this._convertColor(e.data.fillColor),o=e.data.fontSize,c=new C.Services.Collaboration.WhiteboardText(i,o,a,r,s,n,void 0);return c.setId(e.liveEventCommonData.eventId),c.setPosition(new C.Services.Collaboration.Point(e.data.x,e.data.y)),c},convertCircle:function(e,t){var i=this._determineColor(e.data),a=e.liveEventCommonData.fromname,r=e.data.filled,s=e.liveEventCommonData.senderId===t,n=e.data.width,o=e.data.alpha,c=this._calculatePoints(e.data),l=new C.Services.Collaboration.Circle(c.topLeft,c.bottomRight,a,r,s,i,o,n);return l.setId(e.liveEventCommonData.eventId),l},_determineColor:function(e){return e.filled&&e.fillColor?this._convertColor(e.fillColor):e.contour&&e.color?this._convertColor(e.color):void 0},_convertColor:function(e){return 0===e.indexOf("#")?parseInt(e.slice(1),16):parseInt(e,16)},_calculatePoints:function(e){var t,i;return i=e.x0<e.x1&&e.y0<e.y1?(t=new C.Services.Collaboration.Point(e.x0,e.y0),new C.Services.Collaboration.Point(e.x1,e.y1)):e.x0>=e.x1&&e.y0>=e.y1?(t=new C.Services.Collaboration.Point(e.x1,e.y1),new C.Services.Collaboration.Point(e.x0,e.y0)):e.x0<e.x1&&e.y0>=e.y1?(t=new C.Services.Collaboration.Point(e.x0,e.y1),new C.Services.Collaboration.Point(e.x1,e.y0)):(t=new C.Services.Collaboration.Point(e.x1,e.y0),new C.Services.Collaboration.Point(e.x0,e.y1)),{topLeft:t,bottomRight:i}}},C.Providers.WCS.WCSShapeConverter=e}(AvayaClientServices),function(l){"use strict";function e(){}e.prototype={handleSliderSlide:function(e,t){l.Base.Logger.debug(l.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"handleSliderSlide");var i=e.getSlider(),a=e._config.wcsConfiguration.networkProviderConfiguration.restConfig,r=i.getSlides().length+1,s=a.getUrl(!1)+t.data.slideURL,n=a.getUrl(!1)+t.data.thumbUrl,o=new Date(t.liveEventCommonData.time),c=new l.Services.Collaboration.SliderSlide(r,s,n,o);i._addSlides(c),i._onSlidesAddedCallbacks.fire(c),e._recalculateSliderCapability()},handleSliderEmpty:function(e,t){l.Base.Logger.debug(l.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"handleSliderEmpty");var i=e.getSlider(),a=i.getSlides();i._removeSlides(),i._onSlidesRemovedCallbacks.fire(a),e._recalculateSliderCapability()}},l.Providers.WCS.WCSSliderHandler=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Providers.WCS.WCSTransmissionTypes={SCREEN_SHARING:0,SLIDE_SHARING:2}}(),function(c){"use strict";function e(e){this._shapeConverter=e}e.prototype={addWhiteboard:function(e,t){c.Base.Logger.debug(c.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"addWhiteboard");var i=e.getWhiteboard(),a=i.getSurfaceById(t.liveEventCommonData.eventId);if(c.Base.Utils.isDefined(a))this.startWhiteboard(e,t);else{var r=this._createNewSurface(i,t.liveEventCommonData.eventId),s=i.getActiveSurface(),n=this._getParticipant(e,t);c.Base.Utils.isDefined(s)&&(s._active=!1),r._active=!0,i._activeSurface=r,i._onWhiteboardSurfaceAddedCallbacks.fire(t,r,n),i._onWhiteboardSurfaceSetActiveCallbacks.fire(i,r,n),i._recalculateRemoveWhiteboardCapability(e),i._recalculateAddWhiteboardCapability(e)}},startWhiteboard:function(e,t){c.Base.Logger.debug(c.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"startWhiteboard");var i,a=t.data&&t.data.id?t.data.id:t.liveEventCommonData.eventId,r=e.getWhiteboard(),s=r.getSurfaceById(a),n=r.getActiveSurface()||r._recentlyActiveSurface,o=this._getParticipant(e,t);c.Base.Utils.isDefined(n)&&(n._active=!1),c.Base.Utils.isDefined(s)?(s._active=!0,r._activeSurface=s,r._onWhiteboardSurfaceSetActiveCallbacks.fire(r,s,o)):((i=this._createNewSurface(r,t.liveEventCommonData.eventId))._active=!0,r._activeSurface=i,r._onWhiteboardSurfaceAddedCallbacks.fire(r,i,o),r._onWhiteboardSurfaceSetActiveCallbacks.fire(r,i,o)),r._onWhiteboardStartedCallbacks.fire(r,i,o),r._recalculateRemoveWhiteboardCapability(e),r._recalculateAddWhiteboardCapability(e)},endWhiteboard:function(e,t){c.Base.Logger.debug(c.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"endWhiteboard");var i=e.getWhiteboard(),a=this._getParticipant(e,t);i._recentlyActiveSurface=i._activeSurface,i._activeSurface=m,i._onWhiteboardEndedCallbacks.fire(i,a),i._recalculateRemoveWhiteboardCapability(e),i._recalculateAddWhiteboardCapability(e)},deleteWhiteboard:function(e,t){c.Base.Logger.debug(c.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"deleteWhiteboard");var i,a=e.getWhiteboard(),r=a.getSurfaceById(t.data.id),s=this._getParticipant(e,t);if(r){(i=r).isActive()&&(a._activeSurface=this._chooseNewActiveSurface(a,t.data.id));var n=a.getSurfaces().indexOf(r);-1<n&&a.getSurfaces().splice(n,1),a._onWhiteboardSurfaceRemovedCallbacks.fire(a,i,s),a._onWhiteboardSurfaceSetActiveCallbacks.fire(a,a.getActiveSurface(),s)}a._recalculateRemoveWhiteboardCapability(e)},startDrawShape:function(e,t){c.Base.Logger.debug(c.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"startDrawShape");var i=e.getWhiteboard(),a=i.getSurfaceById(t.data.groupId);if(a){var r=this._shapeConverter.convertLiveShape(t,e._selfParticipant.getParticipantId());r._tempId=t.liveEventCommonData.eventId,a._appendShape(t.liveEventCommonData.eventId,r),i._currentLiveDrawingWhiteboardIds[t.liveEventCommonData.senderId]=t.data.groupId,i._currentLiveDrawingShapes[t.liveEventCommonData.senderId]=r,a._onShapeAddedCallbacks.fire(a,r)}},drawShape:function(e,t){c.Base.Logger.debug(c.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"drawShape");var i=e.getWhiteboard(),a=i.getSurfaceById(t.data.groupId);if(c.Base.Utils.isDefined(i._currentLiveDrawingShapes[t.liveEventCommonData.senderId])){var r=(a=i.getSurfaceById(i._currentLiveDrawingWhiteboardIds[t.liveEventCommonData.senderId]))._getShapeById(i._currentLiveDrawingShapes[t.liveEventCommonData.senderId].getId()),s=t.liveEventCommonData.senderId===e._selfParticipant.getParticipantId();if(r&&!s){if(0<t.data.m.length&&i._currentLiveDrawingShapes[t.liveEventCommonData.senderId].addMovePoint(new c.Services.Collaboration.Point(t.data.m[0].x,t.data.m[0].y)),0<t.data.l.length)for(var n=0;n<t.data.l.length;n++)i._currentLiveDrawingShapes[t.liveEventCommonData.senderId].addLinePoint(new c.Services.Collaboration.Point(t.data.l[n].x,t.data.l[n].y));a._onShapeUpdatedCallbacks.fire(a,i._currentLiveDrawingShapes[t.liveEventCommonData.senderId])}}else if(c.Base.Utils.isDefined(a)){var o=this._shapeConverter.convertShape(t,e._selfParticipant.getParticipantId());a._appendShape(t.liveEventCommonData.eventId,o),a._onShapeAddedCallbacks.fire(a,o)}},endDrawShape:function(e,t){c.Base.Logger.debug(c.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"endDrawShape");var i=e.getWhiteboard(),a=i.getSurfaceById(t.data.groupId);if(a&&i._currentLiveDrawingShapes[t.liveEventCommonData.senderId]){var r=a._getShapeById(i._currentLiveDrawingShapes[t.liveEventCommonData.senderId].getId());a._removeShapeById(i._currentLiveDrawingShapes[t.liveEventCommonData.senderId].getId()),r.setId(t.liveEventCommonData.eventId),a._appendShape(t.liveEventCommonData.eventId,r),a._onShapeUpdatedCallbacks.fire(a,r),r._tempId=t.liveEventCommonData.eventId,delete i._currentLiveDrawingWhiteboardIds[t.liveEventCommonData.senderId],i._currentLiveDrawingShapes[t.liveEventCommonData.senderId].finishDrawing(),delete i._currentLiveDrawingShapes[t.liveEventCommonData.senderId]}},drawCircle:function(e,t){c.Base.Logger.debug(c.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"drawCircle");var i=e.getWhiteboard().getSurfaceById(t.data.groupId);if(i){var a=this._shapeConverter.convertCircle(t,e._selfParticipant.getParticipantId());i._appendShape(t.liveEventCommonData.eventId,a),i._onShapeAddedCallbacks.fire(i,a)}},drawText:function(e,t){c.Base.Logger.debug(c.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"drawText");var i=e.getWhiteboard().getSurfaceById(t.data.groupId);if(i){var a=this._shapeConverter.convertText(t,e._selfParticipant.getParticipantId());i._appendShape(t.liveEventCommonData.eventId,a),i._onShapeAddedCallbacks.fire(i,a)}},clearDrawing:function(e,t){c.Base.Logger.debug(c.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"clearDrawing");var i=e.getWhiteboard().getSurfaceById(t.data.groupId);i&&(i._clearShapes(),i._onSurfaceClearedCallbacks.fire(i))},moveSelection:function(e,t){var i=e.getWhiteboard().getSurfaceById(t.data.groupId);if(i){var a=i._getShapeById(t.data.shapeId);a.setTranslation(new c.Services.Collaboration.Point(t.data.moveToX,t.data.moveToY)),i._onShapeUpdatedCallbacks.fire(i,a)}},deleteSelection:function(e,t){c.Base.Logger.debug(c.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"deleteSelection");var i=e.getWhiteboard().getSurfaceById(t.data.groupId);if(i){var a=i._getShapeById(t.data.shapeId);a&&(i._onShapeDeletedCallbacks.fire(i,a),i._removeShapeById(a.getId()))}},_createNewSurface:function(e,t){var i=new c.Services.Collaboration.WhiteboardSurface(e,e._whiteboardService);return e.getSurfaces().push(i),i._surfaceId=t,i},_chooseNewActiveSurface:function(e,t){var i=e.getSurfaces(),a=e.getSurfaceById(t),r=i.indexOf(a);return c.Base.Utils.isDefined(e.getActiveSurface())&&(e.getActiveSurface()._active=!1),0===r?1<i.length?(i[1]._active=!0,i[1]):(i[0]._active=!0,i[0]):(i[r-1]._active=!0,i[r-1])},_getParticipant:function(e,t){var i=t.liveEventCommonData?t.liveEventCommonData.senderId:t.senderId,a=t.liveEventCommonData?t.liveEventCommonData.senderName:t.senderName,r=e._participants.filter(function(e){return e.getParticipantId()===i})[0];return r||(r=new c.Services.Collaboration.Participant(i,a),e._participants.push(r)),r}},c.Providers.WCS.WCSWhiteboardHandler=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Analytics.AnalyticsErrorCode={NOTIFICATION_ERROR:"Notification failed",UNAUTHORIZED:"Unauthorized status",NETWORK_ERROR:"Network Error",MESSAGE_SENDING_ERROR:"Message sending error",CONNECTION_BACKOFF_ALGORITHM_ERROR:"connection Backoff Algorithm error",GETTING_CONVERSATIONS_ERROR:"Getting conversations error",SEARCHING_CONVERSATIONS_ERROR:"Searching conversations error",STARTING_COLLABORATION_ERROR:"Starting Collaboration is error",HOLD_CALL_ERROR:"Hold call error",TRANSFER_CALL_ERROR:"Transfer call error",ATTENDED_TRANSFER_CALL_ERROR:"Attended transfer call error",JOIN_CALL_ERROR:"Join call error",STARTING_CALL_ERROR:"Starting call is error",STOPPING_CALL_ERROR:"Stopping call is error",GETTING_CALL_STATISTICS_ERROR:"Getting call statistics error",SETTING_VIDEO_MODE_ERROR:"Setting video mode error",DENY_SEND_VIDEO_ERROR:"Deny send video error",ACCEPT_SEND_VIDEO_ERROR:"Accept send video error",MUTE_AUDIO_ERROR:"Mute audio error",UNMUTE_AUDIO_ERROR:"Unmute audio error",MUTE_VIDEO_ERROR:"Mute video error",UNMUTE_VIDEO_ERROR:"Unmute video error",MUTE_SPEAKER_ERROR:"Mute speaker error",UNMUTE_SPEAKER_ERROR:"Unmute speaker error",ACCEPT_CALL_ERROR:"accept call error",MEDIA_PRESERVED_ERROR:"Media preserved error",SEND_DTMF_ERROR:"send dtmf error",WEBRTC_NOT_SUPPORTED:"WebRTC not supported",NO_CALL_WAS_CREATED_ERROR:"No call was created"}}(),function(e){"use strict";AvayaClientServices.Services.Call.AlertType={AUTO_CALLBACK:"AUTO_CALLBACK",AUTOMATIC_CALL_DISTRIBUTION_EXTERNAL:"AUTOMATIC_CALL_DISTRIBUTION_EXTERNAL",AUTOMATIC_CALL_DISTRIBUTION_INTERNAL:"AUTOMATIC_CALL_DISTRIBUTION_INTERNAL",DIRECT_AGENT_CALL_EXTERNAL:"DIRECT_AGENT_CALL_EXTERNAL",DIRECT_AGENT_CALL_INTERNAL:"DIRECT_AGENT_CALL_INTERNAL",DIRECT_AGENT_CALL_PRIORITY:"DIRECT_AGENT_CALL_PRIORITY",EXTERNAL:"EXTERNAL",HOLD_RECALL:"HOLD_RECALL",INTERCOM:"INTERCOM",INTERNAL:"INTERNAL",NONE:"NONE",PRIORITY:"PRIORITY",TRANSFER_RECALL:"TRANSFER_RECALL",UNSPECIFIED:"UNSPECIFIED"}}(),function(e){"use strict";function t(){this._requestedDirection=m,this._negotiatedDirection=m}t.prototype={getRequestedDirection:function(){return this._requestedDirection},_getNegotiatedDirection:function(){return this._negotiatedDirection},_setRequestedDirection:function(e){this._requestedDirection=e},_setNegotiatedDirection:function(e){this._negotiatedDirection=e}},e.Services.Call.AudioChannel=t}(AvayaClientServices),function(e){"use strict";(AvayaClientServices||{}).Services.Call.AudioDetails=function(e){this.bytesTransmitted=e.bytesTransmitted,this.bytesReceived=e.bytesReceived,this.packetsTransmitted=e.packetsTransmitted,this.packetsReceived=e.packetsReceived,this.roundTripTimeMilliseconds=e.roundTripTimeMilliseconds,this.packetLossTotalTransmitted=e.packetLossTotalTransmitted,this.packetLossTotalReceived=e.packetLossTotalReceived,this.jitterMillisecondsReceived=e.jitterMillisecondsReceived,this.totalAudioEnergyTransmitted=e.totalAudioEnergyTransmitted,this.totalAudioEnergyReceived=e.totalAudioEnergyReceived,this.audioLevelTransmitted=e.audioLevelTransmitted,this.audioLevelReceived=e.audioLevelReceived,this.codec=e.codec,this.fractionLostLocal=e.fractionLostLocal}}(),function(e){"use strict";AvayaClientServices.Services.Call.AudioMode={SEND_RECEIVE:"SEND_RECEIVE",DISABLE:"DISABLE",ENABLE:"ENABLE"}}(),function(a){"use strict";function e(e,t,i){this._remoteAddress=e,this._presentationModeOnly=!!a.Base.Utils.isDefined(t)&&!!t,this._subject=i,this._avayaLineId=m,this._avayaLineOwner=m,this._conferenceID=m,this._conferencePasscode=m,this._portalToken=m,this._meetMeUserName=m,this._serviceGatewayURL=m,this._uccpURL=m,this._callType=a.Services.Call.CallType.CallTypeDefaultRegisteredService,this._authorizationToken=m,this._contextId=m}e.prototype={getRemoteAddress:function(){return this._remoteAddress},isPresentationModeOnly:function(){return a.Base.Utils.isDefined(this._presentationModeOnly)&&!!this._presentationModeOnly},getSubject:function(){return this._subject},getConferenceID:function(){return this._conferenceID},setConferenceID:function(e){this._conferenceID=e},getPasscode:function(){return this._conferencePasscode},setPasscode:function(e){this._conferencePasscode=e},getContextId:function(){return this._contextId},setContextId:function(e){this._contextId=e},getPortalToken:function(){return this._portalToken},setPortalToken:function(e){this._portalToken=e},getMeetMeUserName:function(){return this._meetMeUserName},setMeetMeUserName:function(e){this._meetMeUserName=e},getCallType:function(){return this._callType},setCallType:function(e){this._callType=e},getServiceGatewayURL:function(){return this._serviceGatewayURL},setServiceGatewayURL:function(e){this._serviceGatewayURL=e},setUccpURL:function(e){this._uccpURL=e},getUccpURL:function(){return this._uccpURL},getAvayaLineId:function(){return this._avayaLineId},getAvayaLineOwner:function(){return this._avayaLineOwner},setAuthorizationToken:function(e){this._authorizationToken=e},getAuthorizationToken:function(){return this._authorizationToken}},a.Services.Call.CallCreationInfo=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Call.CallDenialReason={BUSY:"BUSY",FORBIDDEN:"FORBIDDEN",TEMPORARILY_UNAVAILABLE:"TEMPORARILY_UNAVAILABLE"}}(),function(){"use strict";AvayaClientServices.Services.Call.CallDetails=function(e,t,i,a,r,s){this.callId=e,this.callingParticipant=t,this.calledParticipant=i,this.participants=a,this.connectionId=r,this.status=s}}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a){this._reason=e,this._reasonProtocol=t,this._reasonCause=i,this._reasonText=a}t.prototype={getReason:function(){return this._reason},getReasonProtocol:function(){return this._reasonProtocol},getReasonCause:function(){return this._reasonCause},getReasonText:function(){return this._reasonText},_setReason:function(e){this._reason=e}},e.Services.Call.CallEndEvent=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Call.CallEndReason={CALL_DISCONNECTED:"CALL_DISCONNECTED",CALL_DISCONNECTED_UNKNOWN_REASON:"CALL_DISCONNECTED_UNKNOWN_REASON",CALL_ENDED_LOCALLY:"CALL_ENDED_LOCALLY",DISCONNECTED_BY_CONFERENCE_MODERATOR:"DISCONNECTED_BY_CONFERENCE_MODERATOR",CONFERENCE_TERMINATED:"CONFERENCE_TERMINATED",DTLS_FAILURE:"DTLS_FAILURE",ICE_FAILURE:"ICE_FAILURE"}}(),function(e){"use strict";AvayaClientServices.Services.Call.CallError={AUTHENTICATION_ERROR:"AUTHENTICATION_ERROR",AUTO_HOLD_FAILED:"AUTO_HOLD_FAILED",BUSY:"BUSY",CALL_STATE_MISMATCH:"CALL_STATE_MISMATCH",CALL_NOT_FOUND:"CALL_NOT_FOUND",CAPABILITY_NOT_ALLOWED:"CAPABILITY_NOT_ALLOWED",CODEC_MISMATCH:"CODEC_MISMATCH",DEVICES_NOT_FOUND:"DEVICES_NOT_FOUND",MICROPHONE_NOT_FOUND:"MICROPHONE_NOT_FOUND",MICROPHONE_PERMISSION_DENIED:"MICROPHONE_PERMISSION_DENIED",SPEAKERS_NOT_FOUND:"SPEAKERS_NOT_FOUND",CAMERA_NOT_FOUND:"CAMERA_NOT_FOUND",CAMERA_PERMISSION_DENIED:"CAMERA_PERMISSION_DENIED",FAILED:"FAILED",TCP_TLS_TURN_NOT_SUPPORTED:"TCP_TLS_TURN_NOT_SUPPORTED",ENDED:"ENDED",IN_PROGRESS:"IN_PROGRESS",INTERNAL_ERROR:"INTERNAL_ERROR",INVALID_PARAMETER:"INVALID_PARAMETER",LINE_RESERVATION_ERROR:"LINE_RESERVATION_ERROR",MEDIA_CREATION_FAILURE:"MEDIA_CREATION_FAILURE",MEDIA_START_FAILURE:"MEDIA_START_FAILURE",MULTIPLE_CALLS_NOT_SUPPORTED:"MULTIPLE_CALLS_NOT_SUPPORTED",MEDIA_PATH_FAILURE:"MEDIA_PATH_FAILURE",MULTIPLE_VIDEO_CHANNELS_NOT_SUPPORTED:"MULTIPLE_VIDEO_CHANNELS_NOT_SUPPORTED",MUTE_STATE_MISMATCH:"MUTE_STATE_MISMATCH",NO_AVAILABLE_CALL_APPEARANCE:"NO_AVAILABLE_CALL_APPEARANCE",NOT_AUTHORIZED:"NOT_AUTHORIZED",NOT_FOUND:"NOT_FOUND",NOT_LICENSED:"NOT_LICENSED",NOT_REGISTERED:"NOT_REGISTERED",REDIRECTED:"REDIRECTED",REGISTRATION_TERMINATED:"REGISTRATION_TERMINATED",REMOTE_CALL_NOT_ALERTING:"REMOTE_CALL_NOT_ALERTING",REMOTE_MEDIA_PROCESSING_FAILURE:"REMOTE_MEDIA_PROCESSING_FAILURE",SEND_ERROR:"SEND_ERROR",SERVER_ERROR:"SERVER_ERROR",SESSION_ID_NOT_FOUND:"SESSION_ID_NOT_FOUND",SESSION_ID_ALREADY_CONNECTED:"SESSION_ID_ALREADY_CONNECTED",SUCCESS:"SUCCESS",TIMEOUT:"TIMEOUT",TRANSPORT_ERROR:"TRANSPORT_ERROR",UNDEFINED:"UNDEFINED",UNHANDLED_VIDEO_DIRECTION:"UNHANDLED_VIDEO_DIRECTION",USER_NOT_FOUND:"USER_NOT_FOUND",USER_TEMPORARILY_UNAVAILABLE:"USER_TEMPORARILY_UNAVAILABLE",VIDEO_DENIED:"VIDEO_DENIED",VIDEO_DEESCALATION_NOT_SUPPORTED:"VIDEO_DEESCALATION_NOT_SUPPORTED",WEBRTC_NOT_SUPPORTED:"WEBRTC_NOT_SUPPORTED",STATISTICS_UNAVAILABLE:"STATISTICS_UNAVAILABLE",MEDIA_PRESERVED:"MEDIA_PRESERVED",SERVICE_TEMPORARILY_UNAVAILABLE:"SERVICE_TEMPORARILY_UNAVAILABLE",SERVICE_UNAVAILABLE:"SERVICE_UNAVAILABLE",VIDEO_ONLY_CALL_NOT_SUPPORTED:"VIDEO_ONLY_CALL_NOT_SUPPORTED",VIDEO_REJECTION_NOT_SUPPORTED:"VIDEO_REJECTION_NOT_SUPPORTED",COLLABORATION_ONLY_CALL_NOT_SUPPORTED:"COLLABORATION_ONLY_CALL_NOT_SUPPORTED",NETWORK_EVENTS_SUBSCRIPTION_UNAVAILABLE:"NETWORK_EVENTS_SUBSCRIPTION_UNAVAILABLE",NETWORK_EVENTS_SUBSCRIPTION_FAILED:"NETWORK_EVENTS_SUBSCRIPTION_FAILED",MEDIA_SERVICE_UNAVAILABLE:"MEDIA_SERVICE_UNAVAILABLE",INVALID_ACCEPTED_EVENTS:"INVALID_ACCEPTED_EVENTS"}}(),function(){"use strict";function e(e,t,i,a){this._error=e,this._protocolType=t,this._protocolErrorCode=i,this._protocolErrorReason=a}e.prototype={getError:function(){return this._error},getProtocolType:function(){return this._protocolType},getProtocolErrorCode:function(){return this._protocolErrorCode},getProtocolErrorReason:function(){return this._protocolErrorReason}},AvayaClientServices.Services.Call.CallException=e}(AvayaClientServices),function(s){"use strict";function e(e,t,i,a,r){this._providerFactory=e,this._bandwidthManager=a,this._mediaServiceFactory=t,this._callService={},this._callManager=new s.Services.Call.CallManager,this.calls=m,this._callProvider={},this._participantService=m,this._conferenceService=m,this._contactsIntegrationService=i,this._callsAnalyticsService=r}e.prototype={init:function(e){this._callProvider=this._providerFactory.getCallProviders(e,this._mediaServiceFactory,this._callsAnalyticsService)[0],this._callService=new s.Services.Call.CallService(e,this._callProvider,this._callManager,this._mediaServiceFactory,this._contactsIntegrationService,this._bandwidthManager,this._callsAnalyticsService,this._providerFactory.getRemoteLoggerProvider()),this.calls=new s.Services.Call.Calls(this._callManager,this._callService)},getCalls:function(){return this.calls}},s.Services.Call.CallFactory=e}(AvayaClientServices),function(v){"use strict";function e(){this._callsObject=m,this._calls=[],this._lastMissedCall=m}e.prototype={setCalls:function(e){this._callsObject=e},createCall:function(e){var t=new v.Services.Call.Call(e);return t._setServiceAvailability(e.isServiceAvailable()),e._config.sgConfiguration&&e._config.sgConfiguration.credentialProvider&&t._setIsGuestUser(e._config.sgConfiguration.credentialProvider.isGuest),this._calls.push(t),this._callsObject._callCreatedCallbacks.fire(t),t},createRemoteOrIncomingCall:function(e,t,i,a,r,s,n,o,c,l,d,C){var u=new v.Services.Call.Call(e);return u._setServiceAvailability(e.isServiceAvailable()),u._setCallId(t),u._setRemoteAddress(i),u._setRemoteDisplayName(a),u._isPrivateCallerID=!!v.Base.Utils.isDefined(s)&&s,u._isAuraAsserted=!!v.Base.Utils.isDefined(r)&&r,u._alertType=o,u._subject=c,n&&(u._incomingVideoOffered=v.Services.Call.VideoNetworkSignalingType.SUPPORTED),u._setRemote(!!v.Base.Utils.isDefined(d)&&d),u._setState(l),u._incoming=!!v.Base.Utils.isDefined(C)&&C,u.isRemote()&&this._lastMissedCall&&(this._lastMissedCall.getRemoteAddress()===i&&u._setIsMissed(!0),this._lastMissedCall=m),v.Base.Utils.isDefined(e._config.wcsConfiguration)&&v.Base.Utils.isDefined(e._config.wcsConfiguration.enabled)&&(u._webCollaboration=e._config.wcsConfiguration.enabled),this._calls.push(u),this._callsObject._callCreatedCallbacks.fire(u),u},createMakeCall:function(e,t,i,a,r,s){var n=new v.Services.Call.Call(e);return n._setServiceAvailability(e.isServiceAvailable()),n._setCallId(t),n._setRemoteAddress(i),v.Base.Utils.isDefined(a)&&n._setUserToUserInfo(new v.Services.Call.UserToUserInfo(a,r,s)),this._calls.push(n),this._callsObject._callCreatedCallbacks.fire(n),n},deleteCall:function(e){var t=this._calls.indexOf(e);-1<t&&(this._calls.splice(t,1),this._callsObject._callRemovedCallbacks.fire(e))},getCallCount:function(){return this._calls.length},_getLiveCallCount:function(){for(var e=0,t=0;t<this._calls.length;t++){var i=this._calls[t];i.getState()!==v.Services.Call.CallStates.ENDED&&i.getState()!==v.Services.Call.CallStates.ENDING&&e++}return e},setLastMissedCall:function(e){this._lastMissedCall=e},getLastMissedCall:function(){return this._lastMissedCall},getAllCalls:function(){return this._calls},getActiveCall:function(){for(var e=0;e<this._calls.length;e++){var t=this._calls[e];if(t.getState()===v.Services.Call.CallStates.ESTABLISHED&&!t.isRemote()||t.getState()===v.Services.Call.CallStates.RENEGOTIATING||t.getState()===v.Services.Call.CallStates.FAR_END_RENEGOTIATING)return t}return m},getIgnoredCalls:function(){return this._calls.filter(function(e){return e.getState()===v.Services.Call.CallStates.IGNORED})},hasHeldCall:function(){for(var e=0;e<this._calls.length;e++){if(this._calls[e].getState()===v.Services.Call.CallStates.HELD)return!0}return!1},hasInitiatingCall:function(){for(var e=0;e<this._calls.length;e++){var t=this._calls[e];if(t.getState()===v.Services.Call.CallStates.INITIATING||t.getState()===v.Services.Call.CallStates.REMOTE_ALERTING||t.getState()===v.Services.Call.CallStates.IDLE)return!0}return!1},setCallMode:function(e,t){var i=this._calls.indexOf(e);this._calls[i]._modes.push(t)},getCallModes:function(e){var t=this._calls.indexOf(e);return t<0?[]:this._calls[t]._modes}},v.Services.Call.CallManager=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Call.CallModes={CONFERENCE_CALL:"conferenceCall",AV_COLLABORATION_CALL:"avCollaborationCall"}}(),function(e){"use strict";AvayaClientServices.Services.Call.CallProtocolType={APPLICATION:"APPLICATION",HTTP:"HTTP"}}(),function(A){"use strict";function e(e,t,i,a,r,s,n,o){A.Base.Observable.call(this),this._config=e,this._bandwidthManager=s,this._callProvider=t,this._callManager=i,this._mediaServiceFactory=a,this._remoteLoggerProvider=o,this._isServiceAvailable=!1,this._mediaServices=a.getMediaServices(),this._scopiaConferenceProviderFactory=new A.Providers.Scopia.ScopiaConferenceProviderFactory,this._contactsIntegrationService=r,this._onContactListChanged=m,this._videoLicenseEnabled=!0,this.videoResolution={},this._videoCapability=new A.Base.Capability(A.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._calls=m,this._callsAnalyticsService=n,this._uploadLoggerProvider=m,this._isUploadedOnServiceUnavailable=!1,this._isRegistrationTerminated=!1}(e.prototype=Object.create(A.Base.Observable.prototype)).setCollaborations=function(e){this._collaborations=e},e.prototype.startCall=function(t){if(A.Base.Logger.info(A.Base.LoggerTags.CALL_SERVICE,"Call Service is starting..."),!this._isMakeCallAllowed(t))return this._callsAnalyticsService.sendOperationFailureEvent("start",A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),void this._notifyCallFailure(t,A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED);if(t.getState()!==A.Services.Call.CallStates.IDLE){var e=this._config._mediaServiceConfiguration?A.Services.Call.CallError.MULTIPLE_CALLS_NOT_SUPPORTED:A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED;return this._callsAnalyticsService.sendOperationFailureEvent("start",e),void this._notifyCallFailure(t,e)}if(t._setState(A.Services.Call.CallStates.INITIATING),t._callCreationInfo&&t._callCreationInfo.getAuthorizationToken()&&this._registerCallbacks(),this._bandwidthManager.registerCall(t),t.addOnCallEndedCallback(function(e){this._bandwidthManager.unregisterCall(e),this._stopCollaboration(e)}.bind(this)),t._isDataOnly())for(var i=this._callManager.getCallModes(t),a=0;a<i.length;a++){var r=i[a];if(r.id===A.Services.Call.CallModes.CONFERENCE_CALL)return void r.startCall(t)}else{var s=t.getRemoteAddress();if(null===s.match(/sips?:.*/)){var n=s.search(/,/);-1!==n&&(t._setDtmfString(s.substring(n).split("")),t._setRemoteAddress(s.substring(0,n)))}}var o=this._getMicrophoneAvailability(),c=this._getSpeakersAvailability(),l=this._getCameraAvailability(t),d=0<t.getVideoChannels().length;this._setupDevicesListeners(t),this._setupAnalyticsListeners(t),this._setupStatisticsLogger(t);var C=A.Services.Call.MediaDirection.RECV_ONLY,u=A.Services.Call.MediaDirection.SEND_RECV,v=A.Services.Call.MediaDirection.SEND_RECV,h=t.getAudioChannel()&&t.getAudioChannel().getRequestedDirection()===A.Services.Call.MediaDirection.DISABLE;if(o||h)if(c||h){if(this.isVideoEnabled())if(d){var p=t.getVideoChannels(),_=p[0]._getInternalRequestedDirection();v=C=_,l||(_===A.Services.Call.MediaDirection.SEND_RECV?(p[0]._setRequestedDirection(A.Services.Call.MediaDirection.RECV_ONLY),A.Base.Logger.warn(A.Base.LoggerTags.CALL_SERVICE,"No camera found for video call - update SEND_RECV video direction to RECV_ONLY"),v=A.Services.Call.MediaDirection.RECV_ONLY):_===A.Services.Call.MediaDirection.SEND_ONLY&&(p[0]._setRequestedDirection(A.Services.Call.MediaDirection.INACTIVE),v=A.Services.Call.MediaDirection.INACTIVE,A.Base.Logger.warn(A.Base.LoggerTags.CALL_SERVICE,"No camera found for video call - update SEND_ONLY video direction to INACTIVE")))}else this._isCollabCall(t)||this._setupNailedUpVideoConnection(t,A.Services.Call.VideoMode.RECEIVE_ONLY)&&(C=A.Services.Call.MediaDirection.RECV_ONLY,v=A.Services.Call.MediaDirection.INACTIVE);else C=A.Services.Call.MediaDirection.INACTIVE,u=A.Services.Call.MediaDirection.INACTIVE,v=A.Services.Call.MediaDirection.INACTIVE;var S;if(!this._callProvider.isNailedUpVideoConnectionRequired()||t._isDataOnly()||this._isCollabCall(t)||(S=new A.Providers.Call.NailedUpVideoConnectionInfo(v,C,u)),A.Base.Utils.isUndefined(t.getAudioChannel())){var g=this._callProvider._createAudioChannel_AudioMode(A.Services.Call.AudioMode.SEND_RECEIVE);t._audioChannel=g}var f=function(){return this._callProvider.startCall(t,this.isVideoEnabled(),this.isWebCollaborationEnabled(t),this.isUccpEnabled(),this._mediaServices.getAudioInterface().getInputInterface().getSelectedDevice(),this._mediaServices.getVideoInterface().getSelectedDevice(),this.videoResolution,S).fail(function(e){A.Base.Logger.warn("Failed to start call.",e),this.uploadLogs(),this._notifyCallFailure(t,A.Services.Call.CallError.FAILED),this._callsAnalyticsService.sendOperationFailureEvent("start",A.Services.Call.CallError.FAILED)}.bind(this))}.bind(this),E=this._callManager.getActiveCall();E!==m?(this._callProvider.setActiveCallVideoTrack(E.getCallId()),E.hold().then(function(){f()}.bind(this),function(e){A.Base.Logger.warn("Auto hold failed when starting call.",e),this.uploadLogs(),this._notifyCallFailure(t,A.Services.Call.CallError.AUTO_HOLD_FAILED),this._callsAnalyticsService.sendOperationFailureEvent("start",A.Services.Call.CallError.AUTO_HOLD_FAILED)}.bind(this))):f()}else A.Base.Logger.warn("Speaker is not available"),this.uploadLogs(),this._notifyCallFailure(t,A.Services.Call.CallError.SPEAKERS_NOT_FOUND),this._callsAnalyticsService.sendOperationFailureEvent("start",A.Services.Call.CallError.SPEAKERS_NOT_FOUND);else A.Base.Logger.warn("Microphone is not available"),this.uploadLogs(),this._notifyCallFailure(t,A.Services.Call.CallError.MICROPHONE_NOT_FOUND),this._callsAnalyticsService.sendOperationFailureEvent("start",A.Services.Call.CallError.MICROPHONE_NOT_FOUND)},e.prototype._setupNailedUpVideoConnection=function(e,t){if(e._isDataOnly()||!this._callProvider.isNailedUpVideoConnectionRequired())return!1;var i=this._callProvider._createVideoChannel_VideoMode(A.Services.Call.VideoMode.DISABLE);return i._setInternalRequestedDirection(A.Providers.Call.Utils.getVideoDirection(t)),i._setChannelId("NailedUp_"+i.getChannelId()),e._videoChannels.push(i),!0},e.prototype._getMicrophoneAvailability=function(){var e=this._mediaServices.getAudioInterface().getInputInterface();return!e.getSelectDeviceCapability().isAllowed||e.hasAvailableDevices()},e.prototype._getSpeakersAvailability=function(){var e,t=this._mediaServices.getAudioInterface().getOutputInterface(),i=t.getSelectDeviceCapability().isAllowed,a=A.Base.Utils.getBrowserType();return e=a===A.Base.BrowserType.FIREFOX||a===A.Base.BrowserType.FIREFOX_EXTENSION||a===A.Base.BrowserType.SAFARI||t.hasAvailableDevices(),!i||e},e.prototype._getCameraAvailability=function(e){var t=!1;0<e.getVideoChannels().length&&(t=e.getVideoChannels().reduce(function(e,t){return e&&t._getInternalRequestedDirection()===A.Services.Call.MediaDirection.RECV_ONLY},!0));var i=this._mediaServices.getVideoInterface(),a=i.getSelectDeviceCapability().isAllowed,r=i.hasAvailableDevices();return t||!a||r},e.prototype._setupDevicesListeners=function(e){var t=this._handleOnSelectedDeviceChanged(e).bind(this);this._mediaServices.getAudioInterface().getInputInterface().addOnSelectedDeviceChangedCallback(t),this._mediaServices.getVideoInterface().addOnSelectedDeviceChangedCallback(t);var i=this._handleOnSelectedDeviceRemoved;this._mediaServices.getAudioInterface().getInputInterface().addOnSelectedDeviceRemovedCallback(i),this._mediaServices.getAudioInterface().getOutputInterface().addOnSelectedDeviceRemovedCallback(i),this._mediaServices.getVideoInterface().addOnSelectedDeviceRemovedCallback(i),e.addOnCallEndedCallback(function(){this._mediaServices.getAudioInterface().getInputInterface().removeOnSelectedDeviceChangedCallback(t),this._mediaServices.getVideoInterface().removeOnSelectedDeviceChangedCallback(t),this._mediaServices.getAudioInterface().getInputInterface().removeOnSelectedDeviceRemovedCallback(i),this._mediaServices.getAudioInterface().getOutputInterface().removeOnSelectedDeviceRemovedCallback(i),this._mediaServices.getVideoInterface().removeOnSelectedDeviceRemovedCallback(i)}.bind(this))},e.prototype._setupAnalyticsListeners=function(e){var t;e.addOnCallEstablishedCallback(function(){t=this._callsAnalyticsService.startTimingMetric(),this._callsAnalyticsService.setCallMediaTypes(Boolean(e._videoChannels.length))}.bind(this)),e.addOnCallVideoChannelsUpdatedCallback(function(){this._callsAnalyticsService.setCallMediaTypes(!0)}.bind(this)),e.addOnCallEndedCallback(function(){this._callsAnalyticsService.callTimeEnd(t),this._callsAnalyticsService.sendCallMediaTypes()}.bind(this))},e.prototype._setupStatisticsLogger=function(e){e.addOnCallEstablishedCallback(function(){e._isDataOnly()||e.startLoggingStatistics()}.bind(this)),e.addOnCallEndedCallback(function(){e._isDataOnly()||e.stopLoggingStatistics()}.bind(this))},e.prototype._initAnalyticsMetrics=function(){var i,a;this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_UNAVAILABLE,function(e){i=this._callsAnalyticsService.startTimingMetric();var t=e&&e.getState()===A.Services.Call.CallStates.ESTABLISHED;a=this._callsAnalyticsService.callPreservationTimeStart(t)}.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_AVAILABLE,function(){this._callsAnalyticsService.serviceUnavailableTimeEnd(i);var e=this._callsAnalyticsService.callPreservationTimeEnd(a);this._callsAnalyticsService.sendPreservationEvent(!0,e)}.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_ENDED,function(){var e=this._callsAnalyticsService.callPreservationTimeEnd(a);this._callsAnalyticsService.sendPreservationEvent(!1,e)}.bind(this))},e.prototype._handleOnSelectedDeviceRemoved=function(e){var t=e.getAvailableDevices();e.getSelectDeviceCapability().isAllowed&&t.length&&e.setSelectedDevice(t[0])},e.prototype._handleOnSelectedDeviceChanged=function(i){return function(e,t){i.isRemote()||i.getState()!==A.Services.Call.CallStates.ESTABLISHED&&i.getState()!==A.Services.Call.CallStates.HELD&&i.getState()!==A.Services.Call.CallStates.RENEGOTIATING&&i.getState()!==A.Services.Call.CallStates.FAR_END_RENEGOTIATING||this._callProvider.updateDevices(i,t).fail(function(e){this._callsAnalyticsService.sendOperationFailureEvent("updateDevices",A.Services.Call.CallError.FAILED)}.bind(this))}.bind(this)},e.prototype._updateVideoResolution=function(e,t){if(e.isRemote()||e.getState()!==A.Services.Call.CallStates.ESTABLISHED&&e.getState()!==A.Services.Call.CallStates.HELD&&e.getState()!==A.Services.Call.CallStates.RENEGOTIATING&&e.getState()!==A.Services.Call.CallStates.FAR_END_RENEGOTIATING){var i=T.Deferred();return i.reject(),i.promise()}return this._callProvider.updateVideoResolution(e,t).fail(function(e){this._callsAnalyticsService.sendOperationFailureEvent("updateVideoResolution",A.Services.Call.CallError.FAILED)}.bind(this))},e.prototype.endCall=function(t,e){if(t){if(t._isDataOnly())for(var i=this._callManager.getCallModes(t),a=0;a<i.length;a++){var r=i[a];if(r.id===A.Services.Call.CallModes.CONFERENCE_CALL)return void r.endCall(t)}return this._callProvider._cpCalls[t.getCallId()]&&t.isConference()&&this._disconnectCallFromConference(t),this._callProvider.stopCall(t,e).then(function(){t._remoteVideoRemovedCallbacks.fire(t)},function(e){e.getError()===A.Services.Call.CallError.CALL_NOT_FOUND&&(e._error=A.Services.Call.CallError.ENDED,t._setState(A.Services.Call.CallStates.ENDED),this._callManager.deleteCall(t),this._callProvider.stopExternalGatewayProvider(t)),t._callFailedCallbacks.fire(t,e),this._callsAnalyticsService.sendOperationFailureEvent("end",A.Services.Call.CallError.FAILED)}.bind(this))}},e.prototype.mute=function(e){return e.getMuteCapability().isAllowed?this._callProvider.muteAudio(e).then(function(){e._isAudioMuted=!0,e._onCallAudioMuteStatusChangedCallbacks.fire(e,!0)},function(e){return this._callsAnalyticsService.sendOperationFailureEvent("mute",A.Services.Analytics.AnalyticsErrorCode.MUTE_AUDIO_ERROR),T.Deferred().reject(e).promise()}.bind(this)):(A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not mute call: "+e.getCallId()+": "+e.getMuteCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("mute",A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise())},e.prototype.unmute=function(e){return e.getUnmuteCapability().isAllowed?this._callProvider.unmuteAudio(e).then(function(){e._isAudioMuted=!1,e._onCallAudioMuteStatusChangedCallbacks.fire(e,!1)},function(e){return this._callsAnalyticsService.sendOperationFailureEvent("unmute",A.Services.Analytics.AnalyticsErrorCode.UNMUTE_AUDIO_ERROR),T.Deferred().reject(e).promise()}.bind(this)):(A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not un-mute call: "+e.getCallId()+": "+e.getUnmuteCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("unmute",A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise())},e.prototype.muteVideo=function(e){return!e.getMuteVideoCapability().isAllowed&&e._isDataOnly()?(A.Base.Logger.warn(A.Base.LoggerTags.CALL_SERVICE,"Incorrect mute video capability: "+e.getCallId()+": "+e.getMuteVideoCapability().denialReason),T.Deferred().reject("Mute video not allowed for data only conference").promise()):this._callProvider.muteVideo(e).fail(function(e){this._callsAnalyticsService.sendOperationFailureEvent("muteVideo",A.Services.Analytics.AnalyticsErrorCode.MUTE_VIDEO_ERROR)}.bind(this))},e.prototype.unmuteVideo=function(e){return!e.getUnmuteVideoCapability().isAllowed&&e._isDataOnly()?(A.Base.Logger.warn(A.Base.LoggerTags.CALL_SERVICE,"Incorrect unmute video: "+e.getCallId()+": "+e.getUnmuteVideoCapability().denialReason),T.Deferred().reject("Unmute video not allowed for data only conference").promise()):this._callProvider.unmuteVideo(e).fail(function(){this._callsAnalyticsService.sendOperationFailureEvent("unmuteVideo",A.Services.Analytics.AnalyticsErrorCode.UNMUTE_VIDEO_ERROR)}.bind(this))},e.prototype.muteSpeaker=function(e){if(e.getMuteSpeakerCapability().isAllowed)return this._callProvider.muteSpeaker(e).then(function(){e._isSpeakerMuted=!0,e._onCallSpeakerMuteStatusChangedCallbacks.fire(e,!0)},function(e){return this._callsAnalyticsService.sendOperationFailureEvent("muteSpeaker",A.Services.Analytics.AnalyticsErrorCode.MUTE_SPEAKER_ERROR),T.Deferred().reject(e).promise()}.bind(this));A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not mute speakers for call: "+e.getCallId()+": "+e.getMuteSpeakerCapability().denialReason);var t=A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED;return this._callsAnalyticsService.sendOperationFailureEvent("muteSpeaker",t),T.Deferred().reject(new A.Services.Call.CallException(t)).promise()},e.prototype.unmuteSpeaker=function(e){return e.getUnmuteSpeakerCapability().isAllowed?this._callProvider.unmuteSpeaker(e).then(function(){e._isSpeakerMuted=!1,e._onCallSpeakerMuteStatusChangedCallbacks.fire(e,!1)},function(e){return this._callsAnalyticsService.sendOperationFailureEvent("unmuteSpeaker",A.Services.Analytics.AnalyticsErrorCode.UNMUTE_SPEAKER_ERROR),T.Deferred().reject(e).promise()}.bind(this)):(A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not un-mute speakers for call: "+e.getCallId()+": "+e.getUnmuteSpeakerCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("unmuteSpeaker",A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise())},e.prototype.hold=function(t){if(t.getHoldCapability().isAllowed){t._setState(A.Services.Call.CallStates.HOLDING);var e=this._callProvider.hold(t);return e.then(function(){t._heldTime=new Date,t._setState(A.Services.Call.CallStates.HELD),t._onCallHeldCallbacks.fire(t)},function(e){return t.getState()===A.Services.Call.CallStates.HOLDING&&t._setState(A.Services.Call.CallStates.ESTABLISHED),this._callsAnalyticsService.sendOperationFailureEvent("hold",A.Services.Analytics.AnalyticsErrorCode.HOLD_CALL_ERROR),T.Deferred().reject(e).promise()}.bind(this)),e}return A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not hold call: "+t.getCallId()+": "+t.getHoldCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("hold",A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise()},e.prototype.unhold=function(t){var e=this._callManager.getActiveCall(),i=function(){t._setState(A.Services.Call.CallStates.ESTABLISHED),t._onCallUnheldCallbacks.fire(t)},a=function(e){return t.getState()===A.Services.Call.CallStates.UNHOLDING&&t._setState(A.Services.Call.CallStates.HELD),this._callsAnalyticsService.sendOperationFailureEvent("unhold",A.Services.Call.CallError.FAILED),T.Deferred().reject(e).promise()}.bind(this);return t.getUnholdCapability().isAllowed?e!==m?(t._setState(A.Services.Call.CallStates.UNHOLDING),e.hold().then(function(){return this._callProvider.unhold(t).then(i,a)}.bind(this),function(){var e=T.Deferred();return this._callsAnalyticsService.sendOperationFailureEvent("unhold",A.Services.Call.CallError.AUTO_HOLD_FAILED),e.reject(new A.Services.Call.CallException(A.Services.Call.CallError.AUTO_HOLD_FAILED)),e.promise()}.bind(this))):this._callProvider.unhold(t).then(i,a):(A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not un-hold call: "+t.getCallId()+": "+t.getUnholdCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("unhold",A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise())},e.prototype.ignore=function(e){var t=T.Deferred();return e.getState()===A.Services.Call.CallStates.ALERTING?(e._setState(A.Services.Call.CallStates.IGNORED),e._onCallIgnoredCallbacks.fire(e),t.resolve()):(A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not ignore call: "+e.getCallId()+": CALL_STATE_MISMATCH"),this._callsAnalyticsService.sendOperationFailureEvent("ignore",A.Services.Call.CallError.CALL_STATE_MISMATCH),t.reject(new A.Services.Call.CallException(A.Services.Call.CallError.CALL_STATE_MISMATCH))),t.promise()},e.prototype._notifyCallFailure=function(e,t,i,a,r){e._setState(A.Services.Call.CallStates.FAILED),e._callFailedCallbacks.fire(e,new A.Services.Call.CallException(t,i,a,r))},e.prototype._stopCollaboration=function(e){var t;this._collaborations&&(this._collaborations._isCollaborationForCall(e.getCallId())?(t=this._collaborations.getCollaborationForCall(e.getCallId())).stop().always(function(){this._collaborations._deleteCollaboration(t._collaborationId)}.bind(this)):this._collaborations._isCollaborationForCall("standalone")&&(t=this._collaborations.getCollaborationForCall("standalone")).stop().always(function(){this._collaborations._deleteCollaboration(t._collaborationId)}.bind(this)))},e.prototype.accept=function(i){i._setIsMissed(!1),i.getServiceQualityScoreCapability()._recalculate(),this._bandwidthManager.registerCall(i),i.addOnCallEndedCallback(function(e){this._bandwidthManager.unregisterCall(e),this._stopCollaboration(e)}.bind(this));var e=this._getMicrophoneAvailability(),t=this._getSpeakersAvailability();if(this._setupDevicesListeners(i),this._setupAnalyticsListeners(i),this._setupStatisticsLogger(i),e){if(t){if(i.getState()!==A.Services.Call.CallStates.ALERTING&&i.getState()!==A.Services.Call.CallStates.IGNORED)return A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not accept call: "+i.getCallId()+": CALL_STATE_MISMATCH"),this._callsAnalyticsService.sendOperationFailureEvent("accept",A.Services.Call.CallError.CALL_STATE_MISMATCH),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CALL_STATE_MISMATCH)).promise();0<i.getVideoChannels().length&&(this._getCameraAvailability(i)||i.getVideoChannels()[0]._setRequestedDirection(A.Services.Call.MediaDirection.RECV_ONLY));var a=this._callManager.getActiveCall();return a!==m?a.hold().then(function(){return this._callProvider.accept(i,this._mediaServices.getAudioInterface().getInputInterface().getSelectedDevice(),this._mediaServices.getVideoInterface().getSelectedDevice()).fail(function(e){this._callsAnalyticsService.sendOperationFailureEvent("accept",A.Services.Analytics.AnalyticsErrorCode.ACCEPT_CALL_ERROR)}.bind(this))}.bind(this),function(e){if(e&&e.getError()===A.Services.Call.CallError.ENDED)return this._callProvider.accept(i,this._mediaServices.getAudioInterface().getInputInterface().getSelectedDevice(),this._mediaServices.getVideoInterface().getSelectedDevice()).fail(function(){this._callsAnalyticsService.sendOperationFailureEvent("accept",A.Services.Analytics.AnalyticsErrorCode.ACCEPT_CALL_ERROR)}.bind(this));var t=T.Deferred();return this._callsAnalyticsService.sendOperationFailureEvent("accept",A.Services.Call.CallError.AUTO_HOLD_FAILED),t.reject(new A.Services.Call.CallException(A.Services.Call.CallError.AUTO_HOLD_FAILED)),t.promise()}.bind(this)):this._callProvider.accept(i,this._mediaServices.getAudioInterface().getInputInterface().getSelectedDevice(),this._mediaServices.getVideoInterface().getSelectedDevice()).fail(function(e){this._callsAnalyticsService.sendOperationFailureEvent("accept",A.Services.Analytics.AnalyticsErrorCode.ACCEPT_CALL_ERROR)}.bind(this))}return A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not accept call: "+i.getCallId()+": Speakers not available"),this._callsAnalyticsService.sendOperationFailureEvent("accept",A.Services.Call.CallError.SPEAKERS_NOT_FOUND),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.SPEAKERS_NOT_FOUND))}return A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not accept call: "+i.getCallId()+": Microphone not available"),this._callsAnalyticsService.sendOperationFailureEvent("accept",A.Services.Call.CallError.MICROPHONE_NOT_FOUND),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.MICROPHONE_NOT_FOUND))},e.prototype.acceptSendVideo=function(i,e){if(i.getState()!==A.Services.Call.CallStates.FAR_END_RENEGOTIATING&&i.getState()!==A.Services.Call.CallStates.ESTABLISHED)return A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not acceptSendVideo for call: "+i.getCallId()+": CALL_STATE_MISMATCH"),this._callsAnalyticsService.sendOperationFailureEvent("acceptSendVideo",A.Services.Call.CallError.AUTO_HOLD_FAILED),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CALL_STATE_MISMATCH)).promise();this._mediaServices.getVideoInterface().addOnSelectedDeviceChangedCallback(function(e,t){this._callProvider.updateDevices(i,t).fail(function(e){this._callsAnalyticsService.sendOperationFailureEvent("updateDevices",A.Services.Call.CallError.FAILED)}.bind(this))}.bind(this)),this._getCameraAvailability(i)||(e=A.Services.Call.VideoMode.RECEIVE_ONLY);var t=function(){i.getState()===A.Services.Call.CallStates.FAR_END_RENEGOTIATING&&i._setState(A.Services.Call.CallStates.ESTABLISHED)},a=function(e){return t(),this._callsAnalyticsService.sendOperationFailureEvent("acceptSendVideo",A.Services.Analytics.AnalyticsErrorCode.ACCEPT_SEND_VIDEO_ERROR),T.Deferred().reject(e).promise()}.bind(this);return this._callProvider.acceptSendVideo(i,this._mediaServices.getVideoInterface().getSelectedDevice(),e).then(t,a)},e.prototype.denySendVideo=function(e){if(e.getState()!==A.Services.Call.CallStates.FAR_END_RENEGOTIATING&&e.getState()!==A.Services.Call.CallStates.ESTABLISHED)return A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not denySendVideo for call: "+e.getCallId()+": CALL_STATE_MISMATCH"),this._callsAnalyticsService.sendOperationFailureEvent("denySendVideo",A.Services.Call.CallError.CALL_STATE_MISMATCH),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CALL_STATE_MISMATCH)).promise();var t=function(){e.getState()===A.Services.Call.CallStates.FAR_END_RENEGOTIATING&&e._setState(A.Services.Call.CallStates.ESTABLISHED)},i=function(e){return t(),this._callsAnalyticsService.sendOperationFailureEvent("denySendVideo",A.Services.Analytics.AnalyticsErrorCode.DENY_SEND_VIDEO_ERROR),T.Deferred().reject(e).promise()}.bind(this);return this._callProvider.denySendVideo(e).then(t,i)},e.prototype.transfer=function(t,e){if(t.getTransferCapability().isAllowed){var i=t.getState();return t._setState(A.Services.Call.CallStates.TRANSFERRING),this._callProvider.transfer(t,e).then(function(){t._setState(A.Services.Call.CallStates.ESTABLISHED)},function(e){return A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Unattended transfer failed: "+e),t._setState(i),this._callsAnalyticsService.sendOperationFailureEvent("transfer",A.Services.Analytics.AnalyticsErrorCode.TRANSFER_CALL_ERROR),T.Deferred().reject(e).promise()}.bind(this))}return A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not transfer call: "+t.getCallId()+": "+t.getTransferCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("transfer",A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise()},e.prototype.attendedTransfer=function(t,e){if(t.getTransferCapability().isAllowed&&e.getTransferToCapability().isAllowed){var i=t.getState();return t._setState(A.Services.Call.CallStates.TRANSFERRING),this._callProvider.attendedTransfer(t,e).then(function(){t._setState(A.Services.Call.CallStates.ESTABLISHED)},function(e){return A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Attended transfer failed: "+e),t._setState(i),this._callsAnalyticsService.sendOperationFailureEvent("attendedTransfer",A.Services.Analytics.AnalyticsErrorCode.ATTENDED_TRANSFER_CALL_ERROR),T.Deferred().reject(e).promise()}.bind(this))}return A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not attended transfer call: "+t.getCallId()+": "+t.getTransferCapability().denialReason+" "+e.getTransferToCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("attendedTransfer",A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise()},e.prototype.join=function(e){if(!e.getJoinCapability().isAllowed)return A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not join call: "+e.getCallId()+": "+e.getJoinCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("join",A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise();var t=this._getMicrophoneAvailability(),i=this._getSpeakersAvailability();if(this._setupDevicesListeners(e),this._setupAnalyticsListeners(e),this._setupStatisticsLogger(e),t){if(i){e.getServiceQualityScoreCapability()._recalculate();var a=this._callManager.getActiveCall();return a!==m&&a.getCallId()!==e.getCallId()?a.hold().then(function(){return this._callProvider.join(e,this._mediaServices.getAudioInterface().getInputInterface().getSelectedDevice()).fail(function(e){this._callsAnalyticsService.sendOperationFailureEvent("join",A.Services.Analytics.AnalyticsErrorCode.JOIN_CALL_ERROR)}.bind(this))}.bind(this),function(){return this._callsAnalyticsService.sendOperationFailureEvent("join",A.Services.Call.CallError.AUTO_HOLD_FAILED),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.AUTO_HOLD_FAILED))}.bind(this)):this._callProvider.join(e,this._mediaServices.getAudioInterface().getInputInterface().getSelectedDevice()).fail(function(e){this._callsAnalyticsService.sendOperationFailureEvent("join",A.Services.Analytics.AnalyticsErrorCode.JOIN_CALL_ERROR)}.bind(this))}this._notifyCallFailure(e,A.Services.Call.CallError.SPEAKERS_NOT_FOUND),this._callsAnalyticsService.sendOperationFailureEvent("join",A.Services.Call.CallError.SPEAKERS_NOT_FOUND)}else this._notifyCallFailure(e,A.Services.Call.CallError.MICROPHONE_NOT_FOUND),this._callsAnalyticsService.sendOperationFailureEvent("join",A.Services.Call.CallError.MICROPHONE_NOT_FOUND)},e.prototype.start=function(i){return this._startDfd=T.Deferred(),this._calls=i,this._config.mediaConfiguration&&this._config.mediaConfiguration.voipConfigurationVideo&&this._config.callUserConfiguration.videoMaxBandwidthAnyNetwork&&(this.videoResolution=this._callProvider.getMediaServiceFactory().getMediaServicesService().getUserMedia().adjustVideoResolution(this._config.callUserConfiguration.videoMaxBandwidthAnyNetwork,A.Base.VideoResolution[this._config.mediaConfiguration.voipConfigurationVideo.videoResolution])||A.Base.VideoResolution[this._config.mediaConfiguration.voipConfigurationVideo.videoResolution]),this._recalculateVideoCapability(),this._registerCallbacks(),this._callProvider.on(A.Providers.CallServiceGateway.ObservableEvents.IVIEW_TOKEN_UPDATE,function(e){i._onIviewTokenChanged(e)}.bind(this)),this._callProvider.on(A.Base.NetworkProviderEvents.UNAUTHORIZED,function(){(A.Base.Utils.isUndefined(i._isAvailable)||i._isAvailable)&&(i._isAvailable=!1,i._callsServiceUnavailableCallbacks.fire(i))}.bind(this)),this._callProvider.on(A.Base.NetworkProviderEvents.AUTHORIZED,function(){!A.Base.Utils.isUndefined(i._isAvailable)&&i._isAvailable||(i._isAvailable=!0,i._callsServiceAvailableCallbacks.fire(i))}.bind(this)),this._initAnalyticsMetrics(),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_AVAILABLE,function(){!A.Base.Utils.isUndefined(i._isAvailable)&&i._isAvailable||(i._isAvailable=!0,i._callsServiceAvailableCallbacks.fire(i)),i._voipCallingCapability._recalculate()}.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_UNSUPPORTED,function(){this._isServiceAvailable=!1,i._isAvailable=!1,i._callsServiceUnavailableCallbacks.fire(i),this.trigger(A.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_UNAVAILABLE,[])}.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_UNAVAILABLE,function(){(A.Base.Utils.isUndefined(i._isAvailable)||i._isAvailable)&&(i._isAvailable=!1,i._callsServiceUnavailableCallbacks.fire(i)),i._voipCallingCapability._recalculate(),this._startDfd.state()===A.Base.DeferredStates.PENDING&&this._startDfd.reject()}.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.MEDIA_CHANNEL_GUIDELINES_AVAILABLE,function(){i._voipCallingCapability._recalculate()}.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.MEDIA_CHANNEL_GUIDELINES_UNAVAILABLE,function(){i._voipCallingCapability._recalculate()}.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.UPLOAD_LOGS_UPDATE,function(e,t,i){var a=A.Base.Utils.parseUrl(e);if(a){A.Base.Logger.info("Initializing remote logger provider");var r=new A.Config.ServerInfo(a.hostname,a.port,a.isSecure,a.path);this._uploadLoggerProvider=this._remoteLoggerProvider.getProvider(A.Providers.RemoteLogger.Names.MPAAS),this._uploadLoggerProvider.start(r,e,t,this._config._mediaServiceConfiguration.sessionId,i,this._config.sgConfiguration.credentialProvider).then(function(){this.uploadLogs()}.bind(this))}}.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.AUDIO_STREAM_UPDATED,function(e,t){e._onAudioStreamUpdatedCallback.fire(e,t)}),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_DEACTIVATED,function(e,t){"REGISTRATION_TERMINATED"===t&&(this._isRegistrationTerminated=!0,i._voipCallingCapability._recalculate(),this._callProvider.stop().always(function(){this._isServiceAvailable=!1,i._isAvailable=!1,i._callsServiceUnavailableCallbacks.fire(i)}.bind(this)))}.bind(this)),this._callProvider.start(this._config,this.videoResolution).then(function(e){return this._onContactListChanged=function(){this._callManager.getAllCalls().forEach(this._updateMatchedContactsForCall,this)}.bind(this),this._contactsIntegrationService.addOnContactListChangedCallback(this._onContactListChanged),this._startDfd.state()===A.Base.DeferredStates.PENDING&&this._startDfd.resolve(),!A.Base.Utils.isUndefined(i._isAvailable)&&i._isAvailable||(i._isAvailable=!0,i._callsServiceAvailableCallbacks.fire(i)),e}.bind(this),function(e){this._callsAnalyticsService.sendOperationFailureEvent("start",A.Services.Analytics.AnalyticsErrorCode.STARTING_CALL_ERROR),this._startDfd.reject(e)}.bind(this)),this._startDfd.promise()},e.prototype.stop=function(){return this._callProvider.stop().then(function(e){return this._contactsIntegrationService.removeOnContactListChangedCallback(this._onContactListChanged),this._onContactListChanged=m,this._calls=m,e}.bind(this),function(e){return this._callsAnalyticsService.sendOperationFailureEvent("stop",A.Services.Analytics.AnalyticsErrorCode.STOPPING_CALL_ERROR),T.Deferred().reject(e).promise()}.bind(this))},e.prototype.stopImmediately=function(){return this._callProvider.stopImmediately().fail(function(e){this._callsAnalyticsService.sendOperationFailureEvent("stopImmediately",A.Services.Call.CallError.FAILED)}.bind(this))},e.prototype.sendDTMF=function(e,t){return e.getSendDTMFCapability().isAllowed?this._callProvider.sendDTMF(e,t).fail(function(e){this._callsAnalyticsService.sendOperationFailureEvent("sendDTMF",A.Services.Analytics.AnalyticsErrorCode.SEND_DTMF_ERROR)}.bind(this)):(A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not send DTMF for call: "+e.getCallId()+": "+e.getSendDTMFCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("sendDTMF",A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise())},e.prototype.isVideoEnabled=function(){var e=A.Base.Utils.queryJSONObject(this._config,"callUserConfiguration.videoEnabled");return this._videoLicenseEnabled&&(!!e||A.Base.Utils.isUndefined(e))},e.prototype.isWebCollaborationEnabled=function(e){return e._webCollaboration},e.prototype.isUccpEnabled=function(){return!(!A.Base.Utils.isDefined(this._config.uccpConfiguration)||!A.Base.Utils.isDefined(this._config.uccpConfiguration.enabled))&&this._config.uccpConfiguration.enabled},e.prototype.setVideoChannels=function(e,t){return 0===t.length?this.setVideoMode(e,A.Services.Call.VideoMode.DISABLE):this.setVideoMode(e,this._getVideoMode(t[0].direction))},e.prototype._getVideoMode=function(e){switch(e){case A.Services.Call.MediaDirection.SEND_RECV:return A.Services.Call.VideoMode.SEND_RECEIVE;case A.Services.Call.MediaDirection.SEND_ONLY:return A.Services.Call.VideoMode.SEND_ONLY;case A.Services.Call.MediaDirection.RECV_ONLY:return A.Services.Call.VideoMode.RECEIVE_ONLY;case A.Services.Call.MediaDirection.DISABLE:return A.Services.Call.VideoMode.DISABLE;default:return A.Services.Call.VideoMode.INACTIVE}},e.prototype.setVideoMode=function(e,t){if(e.getState()===A.Services.Call.CallStates.IDLE||e.getState()===A.Services.Call.CallStates.ALERTING||e.getState()===A.Services.Call.CallStates.IGNORED||e.getUpdateVideoChannelsCapability().isAllowed){if(!this._isSetVideoModeCapabilityAllowed(e,t))return t===A.Services.Call.VideoMode.INACTIVE?T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.UNHANDLED_VIDEO_DIRECTION)):T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED));e.getState()===A.Services.Call.CallStates.ESTABLISHED&&e._setState(A.Services.Call.CallStates.RENEGOTIATING);var i=function(){e.getState()===A.Services.Call.CallStates.RENEGOTIATING&&e._setState(A.Services.Call.CallStates.ESTABLISHED)},a=function(e){return i(),this._callsAnalyticsService.sendOperationFailureEvent("setVideoMode",A.Services.Analytics.AnalyticsErrorCode.SETTING_VIDEO_MODE_ERROR),T.Deferred().reject(e).promise()}.bind(this),r=this._callProvider.setVideoMode(e,t,this._mediaServices.getVideoInterface().getSelectedDevice());return r.then(i,a),r}return A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not setVideoMode for call: "+e.getCallId()+": "+e.getUpdateVideoChannelsCapability().denialReason),this._callsAnalyticsService.sendOperationFailureEvent("setVideoMode",A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise()},e.prototype._isSetVideoModeCapabilityAllowed=function(e,t){switch(t){case A.Services.Call.VideoMode.SEND_RECEIVE:return e.getState()===A.Services.Call.CallStates.IDLE||e.getUpdateVideoModeSendReceiveCapability().isAllowed;case A.Services.Call.VideoMode.SEND_ONLY:return e.getState()===A.Services.Call.CallStates.IDLE||e.getUpdateVideoModeSendOnlyCapability().isAllowed;case A.Services.Call.VideoMode.RECEIVE_ONLY:return e.getState()===A.Services.Call.CallStates.IDLE||e.getUpdateVideoModeReceiveOnlyCapability().isAllowed;case A.Services.Call.VideoMode.INACTIVE:return e.getState()===A.Services.Call.CallStates.IDLE||e.getUpdateVideoModeInactiveCapability().isAllowed;case A.Services.Call.VideoMode.DISABLE:return e.getUpdateVideoModeDisableCapability().isAllowed;default:return!1}},e.prototype.setAudioMode=function(e,t){return e.getUpdateAudioModeCapability().isAllowed||t===A.Services.Call.AudioMode.DISABLE?this._callProvider.setAudioMode(e,t):(A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not setAudioMode for call: "+e.getUpdateAudioModeCapability().denialReason),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)))},e.prototype.setWebCollaboration=function(e,t){return e.getUpdateWebCollaborationCapability().isAllowed||this._isCollabCallCapable(e)?(e._webCollaboration=t,this._callProvider.setWebCollaboration(e,t)):(A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Could not setWebCollaboration for call: "+e.getUpdateWebCollaborationCapability().denialReason),T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)))},e.prototype.isServiceAvailable=function(){return this._isServiceAvailable},e.prototype.getVideoCapability=function(){return this._videoCapability},e.prototype.getDefaultVideoResolution=function(){return this._config.mediaConfiguration.voipConfigurationVideo.videoResolution},e.prototype._recalculateVideoCapability=function(){var e=!0,t=A.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;this.isServiceAvailable()&&this.isVideoEnabled()&&this._config.mediaConfiguration.mediaEngineEnabled||(e=!1,t=A.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED),this._videoCapability._updateIfChanged(e,t)},e.prototype.startRinging=function(e){return this._callProvider.startRinging(e)},e.prototype.acceptAnswerCallRequest=function(e){return this._callProvider.acceptAnswerCallRequest(e)},e.prototype.acceptTerminateCallRequest=function(e){return this._callProvider.acceptTerminateCallRequest(e)},e.prototype.acceptUpdateCallRequest=function(e,t){return this._callProvider.acceptUpdateCallRequest(e,t)},e.prototype.acceptMakeCallRequest=function(e){return this._callProvider.acceptMakeCallRequest(e)},e.prototype.rejectAnswerCallRequest=function(e){return this._callProvider.rejectAnswerCallRequest(e)},e.prototype.rejectTerminateCallRequest=function(e){return this._callProvider.rejectTerminateCallRequest(e)},e.prototype.rejectUpdateCallRequest=function(e,t){return this._callProvider.rejectUpdateCallRequest(e,t)},e.prototype.rejectMakeCallRequest=function(e){return this._callProvider.rejectMakeCallRequest(e)},e.prototype._registerCallbacks=function(){this._callProvider._removeListeners(),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CONFERENCE_ESCALATION,this._conferenceEscalationHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_STARTED,this._callStartedHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_RINGING,this._callRingingHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_ESTABLISHED,this._callEstablishedHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_ESTABLISHING,this._callEstablishingHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.ICE_CONNECTION_UPDATE,this._iceConnectionUpdateHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.INCOMING_CALL,this._incomingCallHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_REQUEST,this._incomingAddVideoRequestHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_ACCEPTED,this._incomingAddVideoAcceptedHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_DENIED,this._incomingAddVideoDeniedHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.INCOMING_ADD_VIDEO_TIMEDOUT,this._incomingAddVideoTimedOutHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.INCOMING_HOLD,this._incomingHoldHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.INCOMING_UNHOLD,this._incomingUnholdHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.VIDEO_CHANNEL_UPDATE,this._videoChannelUpdateHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_ENDED,this._callEndedHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_FAILURE,this._callFailureHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_UNAVAILABLE,this._callServiceUnavailableHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_SERVICE_AVAILABLE,this._callServiceAvailableHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.MAX_NETWORK_RECOVERY_ATTEMPTED,this._maxNetworkRecoveryAttemptedHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.REMOTE_ADDRESS_CHANGED,this._remoteAddressChangedHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.REMOTE_CALL_CREATED,this._remoteCallCreatedHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.VIDEO_LICENSE_UPDATED,this._videoLicenseUpdatedHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.RINGBACK_TONE_URLS_CHANGED,this._ringbackToneURLsChangedHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.ANSWER_CALL_REQUESTED,this._answerCallRequestedHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.TERMINATE_CALL_REQUESTED,this._terminateCallRequestedHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.UPDATE_CALL_REQUESTED,this._updateCallRequestedHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.MAKE_CALL_REQUESTED,this._makeCallRequestedHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.ALLOWED_NAILEDUP_VIDEO_MODES,this._allowedNailedUpVideoModesHandler.bind(this)),this._callProvider.on(A.Providers.Interfaces.CallProviderCallbackIds.CALL_MEDIA_FAILED,this._callMediaFailedHandler.bind(this))},e.prototype._conferenceEscalationHandler=function(e,t,i,a){var r,s;if(i=e._webCollaboration&&A.Base.Utils.isNotEmptyString(i)?i:m,a){if(e.isConference())A.Base.Utils.isDefined(t)&&null!==t&&(this._config.uccpConfiguration.enabled?e._conference._isStarted?e._conference.stop().then(function(){r=this._parseUccpUrl(t),e._conference._setConfiguration(r)}.bind(this)):(r=this._parseUccpUrl(t),e._conference._setConfiguration(r),(A.Base.Utils.isUndefined(i)||0===i.length)&&this.watchForWebCollaborationURIChanges(e)):t=m,e._conference._collaborationURI=i,A.Base.Utils.isDefined(i)&&0<i.length&&this.createCollaborationForConference(e,i));else if(A.Base.Utils.isDefined(t)&&null!==t){if(this._config.uccpConfiguration.enabled){r=this._parseUccpUrl(t);var n=this._scopiaConferenceProviderFactory.getScopiaConferenceProvider(r),o=new A.Services.Conference.Chat(this.createChatService(n)),c=this.createParticipantService(n);s=new A.Services.Conference.ConferenceService(A.Services.Conference.ConferenceType.SCOPIA_CONFERENCE,n,this._contactsIntegrationService),e._setConference(new A.Services.Conference.Conference(s,c,o)),e._conference._isUccpConference=!0,e._conference._setConfiguration(r),(A.Base.Utils.isUndefined(i)||0===i.length)&&this.watchForWebCollaborationURIChanges(e)}else t=m,s=new A.Services.Conference.ConferenceService(A.Services.Conference.ConferenceType.SCOPIA_CONFERENCE),e._setConference(new A.Services.Conference.Conference(s)),e._conference._isUccpConference=!1;e._conference._collaborationURI=i,A.Base.Utils.isDefined(i)&&0<i.length&&this.createCollaborationForConference(e,i)}else A.Base.Utils.isDefined(i)&&0<i.length?(a=!1,this.createCollaborationForCall(e,i)):e._createCMConference();e._onCallConferenceStatusChangedCallbacks.fire(e,a,t,i)}else A.Base.Utils.isDefined(i)&&0<i.length&&(this.createCollaborationForCall(e,i),e._onCallConferenceStatusChangedCallbacks.fire(e,a,t,i))},e.prototype.getScopiaConferenceProvider=function(e){var t=A.Base.Utils.isDefined(e)?e:this._config.uccpConfiguration;return this._scopiaConferenceProviderFactory.getScopiaConferenceProvider(t)},e.prototype.createChatService=function(e){return new A.Services.Conference.ChatService(e)},e.prototype.createParticipantService=function(e){return new A.Services.Conference.ParticipantService(e)},e.prototype.createCollaborationForConference=function(e,t){if(this._collaborations){if(e.getCallId()?e._conference._setCollaboration(this._collaborations.getCollaborationForCall(e.getCallId())):e._conference._setCollaboration(this._collaborations.getCollaborationForCall("standalone")),A.Base.Utils.isDefined(t)&&0<t.length){var i=this._parseWebCollabUrl(t);this._config.wcsConfiguration=i,e._conference._collaboration._setConfiguration(this._config,i.meetingId)}this.watchForWebCollaborationURIChanges(e)}},e.prototype.watchForWebCollaborationURIChanges=function(a){this._collaborations&&a._conference.addOnConferenceCollaborationURIChangedCallback(function(e,t){if(A.Base.Utils.isDefined(t)&&0<t.length){var i=this._parseWebCollabUrl(t);A.Base.Utils.isUndefined(e._collaboration)&&(a.getCallId()?e._setCollaboration(this._collaborations.getCollaborationForCall(a.getCallId())):e._setCollaboration(this._collaborations.getCollaborationForCall("standalone"))),(e._collaborationURI!==t||A.Base.Utils.isUndefined(e._collaboration._config))&&(e._collaboration._isStarted?e._collaboration.stop().then(function(){this._config.wcsConfiguration=i,e._collaboration._setConfiguration(this._config,i.meetingId),e._collaboration.start()}.bind(this)):(this._config.wcsConfiguration=i,e._collaboration._setConfiguration(this._config,i.meetingId)))}}.bind(this))},e.prototype.createCollaborationForCall=function(e,t){if(e.getCallId()){var i=this._collaborations.getCollaborationForCall(e.getCallId());if(A.Base.Utils.isDefined(t)&&0<t.length){var a=this._parseWebCollabUrl(t);this._config.wcsConfiguration=a,i._setConfiguration(this._config,a.meetingId)}}},e.prototype._parseUccpUrl=function(e){var t=A.Base.Utils.parseUrl(e);return A.Base.Utils.isDefined(t)?{enabled:!0,networkProviderConfiguration:{webSocketConfig:new A.Config.ServerInfo(t.hostname,t.port,t.isSecure,t.path,t.credentials,t.query)}}:m},e.prototype._parseWebCollabUrl=function(e){var t;if(A.Base.Utils.isDefined(e)&&0<e.length){var i=A.Base.Utils.parseUrl(e),a=i.path.indexOf("/viewer.php"),r=i.path.substring(0,a),s="https:"===document.location.protocol||"chrome-extension:"===document.location.protocol,n=new A.Config.ServerInfo(i.hostname,i.port,s,r),o=i.query.split("&").map(function(e){var t=e.split("=");return{key:t[0],value:t[1]}});o.getValue=function(t){var e=this.filter(function(e){return e.key===t});return 0!==e.length?e[0].value:null};var c=o.getValue("token"),l=o.getValue("meeting_id"),d=o.getValue("mode"),C=o.getValue("login"),u=o.getValue("participantId");t={enabled:!0,meetingId:l,credentialProvider:new A.Config.WCSCredentialTokenProvider(c,C,u,m,d),networkProviderConfiguration:{restConfig:n}}}return t},e.prototype._callStartedHandler=function(e){e._onCallStartedCallbacks.fire(e)},e.prototype._callRingingHandler=function(e,t){e.getState()===A.Services.Call.CallStates.ESTABLISHED?e._setState(A.Services.Call.CallStates.BEING_TRANSFERRED):e.getState()!==A.Services.Call.CallStates.HELD&&e._setState(A.Services.Call.CallStates.REMOTE_ALERTING),e._isEarlyMedia=t,e._sendDTMFCapability._recalculate(t),e._onCallRemoteAlertingCallbacks.fire(e,t),A.Base.Utils.isDefined(e._dtmfString)&&t&&this._handleDTMFString(e)},e.prototype._callEstablishedHandler=function(e,t,i,a,r,s){e._heldRemotely=!1,e._establishedTime=new Date,e.getState()!==A.Services.Call.CallStates.HELD&&e._setState(A.Services.Call.CallStates.ESTABLISHED),A.Base.Utils.isDefined(a)&&e._setUserToUserInfo(new A.Services.Call.UserToUserInfo(a,r,s)),this.uploadLogs(),e._onCallEstablishedCallbacks.fire(e);var n=e.getAudioChannel();e.getState()!==A.Services.Call.CallStates.HELD&&n&&n._getNegotiatedDirection()===A.Services.Call.MediaDirection.RECV_ONLY&&this._incomingHoldHandler(e),e.isRemote()&&!1===i&&(this._callManager.setLastMissedCall(m),e._setRemote(!1),e._setIsMissed(!1),e._onCallJoinedCallbacks.fire(e)),A.Base.Utils.isDefined(e._dtmfString)&&!e._isEarlyMedia&&this._handleDTMFString(e),this._callsAnalyticsService.sendCallInfo(e._incoming,e._videoChannels.length),this._callsAnalyticsService.sendCallType(t)},e.prototype._callEstablishingHandler=function(e){var t=e.getUserToUserInfo();t&&A.Base.Utils.isDefined(t.getUCID())&&e._onCallEstablishingCallbacks.fire(e)},e.prototype._remoteCallCreatedHandler=function(e,t,i,a,r,s,n,o){var c=this._callManager.createRemoteOrIncomingCall(this,e,t,i,a,r,s,n,o,A.Services.Call.CallStates.ESTABLISHED,!0,!1);this._callProvider.registerIncomingOrRemoteCall(c)},e.prototype._incomingCallHandler=function(e,t,i,a,r,s,n,o,c,l,d){if(this._isWebRTCSupportedBrowser()){var C=this._callManager.getActiveCall();C!==m&&this._callProvider.setActiveCallVideoTrack(C.getCallId());var u=this._callManager.createRemoteOrIncomingCall(this,e,t,i,a,r,s,n,o,A.Services.Call.CallStates.ALERTING,!1,!0);A.Base.Utils.isDefined(c)&&u._setUserToUserInfo(new A.Services.Call.UserToUserInfo(c,l,d)),this._callProvider.registerIncomingOrRemoteCall(u),this.trigger(A.Providers.Interfaces.CallServiceCallbackIds.INCOMING_CALL,[u]),(A.Base.Utils.isUndefined(this._config.callUserConfiguration.startRingingOnIncomingCall)||this._config.callUserConfiguration.startRingingOnIncomingCall)&&this.startRinging(u)}},e.prototype._incomingAddVideoRequestHandler=function(e,t){e._setState(A.Services.Call.CallStates.FAR_END_RENEGOTIATING),e._onCallIncomingVideoAddRequestReceivedCallbacks.fire(e,t)},e.prototype._incomingAddVideoAcceptedHandler=function(e){e._onCallIncomingVideoAddRequestAcceptedCallbacks.fire(e)},e.prototype._incomingAddVideoDeniedHandler=function(e){e._onCallIncomingVideoAddRequestDeniedCallbacks.fire(e)},e.prototype._incomingAddVideoTimedOutHandler=function(e){e.getState()===A.Services.Call.CallStates.FAR_END_RENEGOTIATING&&e._setState(A.Services.Call.CallStates.ESTABLISHED),e._onCallIncomingVideoAddRequestTimedOutCallbacks.fire(e)},e.prototype._incomingHoldHandler=function(e){e._heldTime=new Date,e._heldRemotely=!0,e._onCallHeldRemotelyCallbacks.fire(e)},e.prototype._incomingUnholdHandler=function(e){e._heldRemotely=!1,e._onCallUnheldRemotelyCallbacks.fire(e)},e.prototype._videoChannelUpdateHandler=function(e){e.getState()===A.Services.Call.CallStates.ESTABLISHED&&e._recalculateVideoModeCapabilities(),e._onCallVideoChannelsUpdatedCallback.fire(e,e._videoChannels)},e.prototype._callEndedHandler=function(e,t,i){e.isConference()&&this._stopConferenceCall(e),e.getState()!==A.Services.Call.CallStates.ALERTING&&e.getState()!==A.Services.Call.CallStates.IGNORED||(e._setIsMissed(!0),this._callManager.setLastMissedCall(e)),e.getState()!==A.Services.Call.CallStates.ENDING||i&&i.getCause()||(t=!1);var a=this._createEndCallEvent(t,i);e._setState(A.Services.Call.CallStates.ENDED),e._onCallEndedCallbacks.fire(e,a),this._callManager.deleteCall(e),this._callProvider.stopExternalGatewayProvider(e).always(function(){this.uploadLogs()}.bind(this))},e.prototype._callFailureHandler=function(e,t,i,a,r){var s=t;t!==A.Services.Call.CallError.NOT_FOUND||e.getState()!==A.Services.Call.CallStates.ENDING&&e.getState()!==A.Services.Call.CallStates.ENDED||(s=A.Services.Call.CallError.ENDED),t!==A.Services.Call.CallError.SESSION_ID_NOT_FOUND&&t!==A.Services.Call.CallError.SESSION_ID_ALREADY_CONNECTED||A.Base.Logger.error(A.Base.LoggerTags.CALL_SERVICE,"Received MPaaS session failure:",t),this.uploadLogs(),this._notifyCallFailure(e,s,i,a,r),this._callsAnalyticsService.sendDroppedCallEvent(s)},e.prototype._callServiceUnavailableHandler=function(e){this._isServiceAvailable=!1,this._recalculateVideoCapability(),this._calls._setOnNetworkEventsCapability._recalculate(),this._calls._removeOnNetworkEventsCapability._recalculate(),this._isUploadedOnServiceUnavailable||(this._isUploadedOnServiceUnavailable=!0,this.uploadLogs()),A.Base.Utils.isDefined(e)&&(e._setServiceAvailability(!1),e._callServiceUnavailableCallbacks.fire(e))},e.prototype._callServiceAvailableHandler=function(e){this._isServiceAvailable=!0,this._isUploadedOnServiceUnavailable=!1,this._recalculateVideoCapability(),this._calls._setOnNetworkEventsCapability._recalculate(),this._calls._removeOnNetworkEventsCapability._recalculate(),A.Base.Utils.isDefined(e)&&(e._setServiceAvailability(!0),e._callServiceAvailableCallbacks.fire(e))},e.prototype._maxNetworkRecoveryAttemptedHandler=function(i){this._callManager.getAllCalls().forEach(function(e){if(this._callProvider.isExternalGatewayCall(e,i)){var t=e.getState();t!==A.Services.Call.CallStates.INITIATING&&t!==A.Services.Call.CallStates.REMOTE_ALERTING||(this.uploadLogs(),this._notifyCallFailure(e,A.Services.Call.CallError.SERVICE_UNAVAILABLE))}}.bind(this))},e.prototype._remoteAddressChangedHandler=function(e,t,i,a,r,s){A.Base.Utils.isDefined(e)&&(A.Base.Utils.isDefined(t)&&e._setRemoteAddress(t),A.Base.Utils.isDefined(i)&&e._setRemoteDisplayName(i),A.Base.Utils.isDefined(a)&&e._setUserToUserInfo(new A.Services.Call.UserToUserInfo(a,r,s)),e._onCallRemoteAddressChangedCallbacks.fire(e))},e.prototype._videoLicenseUpdatedHandler=function(e){this._videoLicenseEnabled!==e&&(this._videoLicenseEnabled=e,this._recalculateVideoCapability())},e.prototype._allowedNailedUpVideoModesHandler=function(e,t){e._setAllowedNailedUpVideoModes(t)},e.prototype._iceConnectionUpdateHandler=function(e,t){t?(A.Base.Logger.info(A.Base.LoggerTags.CALL_SERVICE,"Media path connected"),e._mediaConnectedCallbacks.fire(e)):(A.Base.Logger.info(A.Base.LoggerTags.CALL_SERVICE,"Media path disconnected"),e._mediaDisconnectedCallbacks.fire(e))},e.prototype._buildUccpConfig=function(e){var t=this._config.uccpConfiguration,i=A.Base.Utils.parseUrl(e);return t.networkProviderConfiguration.webSocketConfig.hostName=i.hostname,t.networkProviderConfiguration.webSocketConfig.port=i.port,t.networkProviderConfiguration.webSocketConfig.isSecure=i.isSecure,t.networkProviderConfiguration.webSocketConfig.path=i.path,t},e.prototype._updateMatchedContactsForCall=function(e){e&&this._contactsIntegrationService.updateMatchedContactsForParticipant(e.getRemoteParticipant())},e.prototype._handleDTMFString=function(t){var i,a=function(){if(0===t._dtmfString.length)clearTimeout(i);else{var e=t._dtmfString.shift();i=","!==e?(this.sendDTMF(t,this._convertToDtmf(e)),setTimeout(a.bind(this),200)):setTimeout(a.bind(this),2e3)}};setTimeout(function(){A.Base.Logger.info(A.Base.LoggerTags.CALL_SERVICE,"Handle DTMF string passed as part of dial string"),i=setTimeout(a.bind(this),200)}.bind(this),2e3)},e.prototype._convertToDtmf=function(e){var t;switch(e){case"1":t=A.Services.Call.DTMFTone.ONE;break;case"2":t=A.Services.Call.DTMFTone.TWO;break;case"3":t=A.Services.Call.DTMFTone.THREE;break;case"4":t=A.Services.Call.DTMFTone.FOUR;break;case"5":t=A.Services.Call.DTMFTone.FIVE;break;case"6":t=A.Services.Call.DTMFTone.SIX;break;case"7":t=A.Services.Call.DTMFTone.SEVEN;break;case"8":t=A.Services.Call.DTMFTone.EIGHT;break;case"9":t=A.Services.Call.DTMFTone.NINE;break;case"0":t=A.Services.Call.DTMFTone.ZERO;break;case"A":t=A.Services.Call.DTMFTone.A;break;case"B":t=A.Services.Call.DTMFTone.B;break;case"C":t=A.Services.Call.DTMFTone.C;break;case"D":t=A.Services.Call.DTMFTone.D;break;case"*":t=A.Services.Call.DTMFTone.STAR;break;case"#":t=A.Services.Call.DTMFTone.POUND;break;default:A.Base.Logger.warn(A.Base.LoggerTags.CALL_SERVICE,"{0} is not a DTMF symbol",e)}return t},e.prototype.createCMConference=function(e){var t=new A.Providers.CM.CMConferenceProvider(this._callProvider,e.getCallId()),i=new A.Services.Conference.ConferenceService(A.Services.Conference.ConferenceType.CM_CONFERENCE,t,this._contactsIntegrationService);return new A.Services.Conference.Conference(i)},e.prototype._disconnectCallFromConference=function(e){e.isConference()&&e.getConference()._disconnect()},e.prototype._stopConferenceCall=function(e){e.isConference()&&(e.getConference()._removeOnConferenceAllowVideoDirectionChangedCallback(e._recalculateVideoModeCapabilities.bind(e)),e.getConference()._disconnect(),e.getConference()._isAvailable&&(e.getConference()._onConferenceConnectionEndedCallbacks.fire(e.getConference()),e.getConference().stop()),e.getConference()._setCollaboration(m),e._setConference(m))},e.prototype.getAudioDetails=function(e){return this._getCallStatistics(e).then(function(e){return e.audioStatistics})},e.prototype.getVideoDetails=function(e){return this._getCallStatistics(e).then(function(e){return e.videoStatistics})},e.prototype._getCallStatistics=function(e){return this._callProvider.getCallStatistics(e).then(function(e){return{audioStatistics:new A.Services.Call.AudioDetails(e.audioStatistics),videoStatistics:new A.Services.Call.VideoDetails(e.videoStatistics)}}.bind(this),function(e){return this._callsAnalyticsService.sendOperationFailureEvent("_getCallStatistics",A.Services.Analytics.AnalyticsErrorCode.GETTING_CALL_STATISTICS_ERROR),A.Base.Logger.debug(A.Base.LoggerTags.CALL_SERVICE,"Call statistics download fail: ",e.getError()),T.Deferred().reject(e).promise()}.bind(this))},e.prototype._parseChromeStatistics=function(e){var i,a,r,s,t,n,o,c,l,d;return e.result().forEach(function(e){var t=e.stat("mediaType");"ssrc"===e.type&&-1<e.id.indexOf("send")&&"audio"===t&&(i=e),"ssrc"===e.type&&-1<e.id.indexOf("send")&&"video"===t&&(r=e),"ssrc"===e.type&&-1<e.id.indexOf("recv")&&"audio"===t&&(a=e),"ssrc"===e.type&&-1<e.id.indexOf("recv")&&"video"===t&&(s=e)}),(a||i)&&(t={bytesReceived:parseInt(a?a.stat("bytesReceived"):0),packetsReceived:parseInt(a?a.stat("packetsReceived"):0),packetsLost:parseInt(a?a.stat("packetsLost"):0),googJitterReceived:parseInt(a?a.stat("googJitterReceived"):0)},n={bytesSent:parseInt(i?i.stat("bytesSent"):0),packetsSent:parseInt(i?i.stat("packetsSent"):0),googRtt:parseInt(i?i.stat("googRtt"):0),packetsLost:parseInt(i?i.stat("packetsLost"):0)},i&&""===i.stat("packetsLost")&&(n.packetsLost=0),i&&""===i.stat("googRtt")&&(n.googRtt=0),l=new A.Services.Call.AudioDetails(t.bytesReceived,n.bytesSent,t.packetsReceived,n.packetsSent,n.googRtt,n.packetsLost,t.packetsLost,t.googJitterReceived)),(s||r)&&(o={bytesReceived:parseInt(s?s.stat("bytesReceived"):0),actualBitRateReceived:m,packetsReceived:parseInt(s?s.stat("packetsReceived"):0),packetsLost:parseInt(s?s.stat("packetsLost"):0),googFrameRateReceived:parseInt(s?s.stat("googFrameRateReceived"):0)},A.Base.Utils.isUndefined(o.packetsLost)&&(o.packetsLost=0),A.Base.Utils.isUndefined(o.packetsReceived)&&(o.packetsReceived=0),0===o.packetsReceived?o.packetsLossFractionReceived=0:o.packetsLossFractionReceived=s.stat("packetsLost")/s.stat("packetsReceived"),c={bytesSent:parseInt(r?r.stat("bytesSent"):0),actualBitRateTransmitted:m,packetsSent:parseInt(r?r.stat("packetsSent"):0),packetsLost:parseInt(r?r.stat("packetsLost"):0),googFrameRateSent:parseInt(r?r.stat("googFrameRateSent"):0)},A.Base.Utils.isUndefined(c.packetsLost)&&(c.packetsLost=0),A.Base.Utils.isUndefined(c.packetsSent)&&(c.packetsSent=0),0===c.packetsSent?c.packetsLossFractionTransmitted=0:c.packetsLossFractionTransmitted=r.stat("packetsLost")/r.stat("packetsSent"),d=new A.Services.Call.VideoDetails(c.bytesSent,o.bytesReceived,c.actualBitRateTransmitted,o.actualBitRateReceived,c.packetsSent,o.packetsReceived,c.packetsLost,o.packetsLost,c.packetsLossFractionTransmitted,o.packetsLossFractionReceived,c.googFrameRateSent,o.googFrameRateReceived)),{audioStatistics:l,videoStatistics:d}},e.prototype._parseFirefoxStatistics=function(e){var t,i={},a={},r={},s={};return e.forEach(function(e){"audio"===e.mediaType?e.id.includes("inbound_rtp_audio")?(i.bytesReceived=e.bytesReceived,i.packetsReceived=e.packetsReceived,i.packetsLost=e.packetsLost,i.jitterReceived=e.jitter):e.id.includes("outbound_rtp_audio")?(a.bytesSent=e.bytesSent,a.packetsSent=e.packetsSent):e.id.includes("outbound_rtcp_audio")&&(a.mozRtt=e.mozRtt,a.packetsLost=e.packetsLost):"video"===e.mediaType&&(e.id.includes("inbound_rtp_video")?(r.bytesReceived=e.bytesReceived,r.actualBitRateReceived=e.bitrateMean,r.packetsReceived=e.packetsReceived,r.packetsLost=e.packetsLost,r.frameRateReceived=e.framerateMean):e.id.includes("outbound_rtcp_video")?s.packetsLost=e.packetsLost:e.id.includes("outbound_rtp_video")&&(s.bytesSent=e.bytesSent,s.actualBitRateTransmitted=e.bitrateMean,s.packetsSent=e.packetsSent,s.frameRateSent=e.framerateMean))}),A.Base.Utils.isUndefined(a.packetsLost)&&(a.packetsLost=0),A.Base.Utils.isUndefined(a.mozRtt)&&(a.mozRtt=0),t=new A.Services.Call.AudioDetails(i.bytesReceived,a.bytesSent,i.packetsReceived,a.packetsSent,a.mozRtt,a.packetsLost,i.packetsLost,i.jitterReceived),A.Base.Utils.isUndefined(r.packetsLost)&&(r.packetsLost=0),A.Base.Utils.isUndefined(r.packetsReceived)&&(r.packetsReceived=0),0===r.packetsReceived?r.packetsLossFractionReceived=0:r.packetsLossFractionReceived=r.packetsLost/r.packetsReceived,A.Base.Utils.isUndefined(s.packetsLost)&&(s.packetsLost=0),A.Base.Utils.isUndefined(s.packetsSent)&&(s.packetsSent=0),0===s.packetsSent?s.packetsLossFractionTransmitted=0:s.packetsLossFractionTransmitted=s.packetsLost/s.packetsSent,{audioStatistics:t,videoStatistics:new A.Services.Call.VideoDetails(s.bytesSent,r.bytesReceived,s.actualBitRateTransmitted,r.actualBitRateReceived,s.packetsSent,r.packetsReceived,s.packetsLost,r.packetsLost,s.packetsLossFractionTransmitted,r.packetsLossFractionReceived,s.frameRateSent,r.frameRateReceived)}},e.prototype._parseEdgeStatistics=function(e){var t,i={},a={},r={},s={};return A.Base.Utils.isDefined(e.rtp_audio)&&(i.bytesReceived=m,i.packetsReceived=e.rtp_audio.packetsReceived,i.packetsLost=e.rtp_audio.packetsLost,i.jitterReceived=e.rtp_audio.jitter),A.Base.Utils.isDefined(e.rtp_audio)&&(a.bytesSent=m,a.packetsSent=e.rtp_audio.packetsSent,a.packetsLost=e.rtp_audio.packetsLost),t=new A.Services.Call.AudioDetails(i.bytesReceived,a.bytesSent,i.packetsReceived,a.packetsSent,a.mozRtt,a.packetsLost,i.packetsLost,i.jitterReceived),A.Base.Utils.isDefined(e.rtp_video)&&(r.bytesReceived=m,r.packetsReceived=e.rtp_video.packetsReceived,r.packetsLost=e.rtp_video.packetsLost,r.frameRateReceived=e.rtp_video.frameRateReceived),r.packetsLossFractionReceived=e.rtp_video.fractionLost,A.Base.Utils.isDefined(e.rtp_video)&&(s.packetsLost=e.rtp_video.packetsLost,s.bytesSent=m,s.packetsSent=e.rtp_video.packetsSent,s.frameRateSent=e.rtp_video.frameRateSent),s.packetsLossFractionTransmitted=m,{audioStatistics:t,videoStatistics:new A.Services.Call.VideoDetails(s.bytesSent,r.bytesReceived,s.actualBitRateTransmitted,r.actualBitRateReceived,s.packetsSent,r.packetsReceived,s.packetsLost,r.packetsLost,s.packetsLossFractionTransmitted,r.packetsLossFractionReceived,s.frameRateSent,r.frameRateReceived)}},e.prototype._ringbackToneURLsChangedHandler=function(e){this._calls&&this._calls._onRingbackToneURLsChangedCallback.fire(e)},e.prototype._answerCallRequestedHandler=function(e){e._answerCallRequestedCallbacks.fire(e)},e.prototype._terminateCallRequestedHandler=function(e){e._terminateCallRequestedCallbacks.fire(e)},e.prototype._updateCallRequestedHandler=function(e,t){e._updateCallRequestedCallbacks.fire(e,t)},e.prototype._makeCallRequestedHandler=function(e,t,i,a,r){var s=this._callManager.createMakeCall(this,e,t,i,a,r);this._callProvider.registerIncomingOrRemoteCall(s),this.trigger(A.Providers.Interfaces.CallServiceCallbackIds.MAKE_CALL_REQUESTED,[s])},e.prototype._callMediaFailedHandler=function(e){e._mediaFailedCallbacks.fire(e)},e.prototype._isMakeCallAllowed=function(e){return!!(e._isDataOnly()||this._isCollabCall(e)||this._isWebRTCSupportedBrowser()&&this._config.mediaConfiguration.mediaEngineEnabled)},e.prototype._isCollabCallCapable=function(e){var t=e.getVideoChannels(),i=e.getAudioChannel(),a=!!i&&i.getRequestedDirection()===A.Services.Call.MediaDirection.DISABLE,r=!t||0===t.length||t[0].getRequestedDirection()===A.Services.Call.MediaDirection.DISABLE;return a&&r},e.prototype._isCollabCall=function(e){return this.isWebCollaborationEnabled(e)&&this._isCollabCallCapable(e)},e.prototype._isWebRTCSupportedBrowser=function(){var e=A.Base.Utils.queryJSONObject(this._config,"sgConfiguration._disableWebRTCForTheseBrowsers"),t=A.Base.Utils.isWebRTC_SupportedBrowser(e);return this._callProvider.isNailedUpVideoConnectionRequired()?t&&this._callProvider.isServerSupportsNailedUpVideoConnection():t},e.prototype._createEndCallEvent=function(e,t){var i;if(e)if(t&&t.getCause()){if(i=new A.Services.Call.CallEndEvent(A.Services.Call.CallEndReason.CALL_DISCONNECTED_UNKNOWN_REASON,t.getProtocol(),t.getCause(),t.getText()),"avaya-action"===t.getProtocol())switch(t.getCause()){case 200:i._setReason(A.Services.Call.CallEndReason.DISCONNECTED_BY_CONFERENCE_MODERATOR);break;case 201:i._setReason(A.Services.Call.CallEndReason.CONFERENCE_TERMINATED);break;case 202:i._setReason(A.Services.Call.CallEndReason.CALL_DISCONNECTED);break;case 450:i._setReason(A.Services.Call.CallEndReason.DTLS_FAILURE);break;case 451:i._setReason(A.Services.Call.CallEndReason.ICE_FAILURE)}}else i=new A.Services.Call.CallEndEvent(A.Services.Call.CallEndReason.CALL_DISCONNECTED);else i=new A.Services.Call.CallEndEvent(A.Services.Call.CallEndReason.CALL_ENDED_LOCALLY);return i},e.prototype.uploadLogs=function(){if(this._config.mediaServiceContext)return this._uploadLoggerProvider?this._remoteLoggerProvider.uploadLogs(A.Providers.RemoteLogger.Names.MPAAS).fail(function(e){A.Base.Logger.error("Failed to upload logs",e)}):(A.Base.Logger.error("Uninitialized remote logger provider"),T.Deferred().reject("Uninitialized remote logger provider").promise())},e.prototype.isRegistrationTerminated=function(){return this._isRegistrationTerminated},e.prototype.setOnNetworkEvents=function(e,t){return this._callProvider.setOnNetworkEvents(e,t)},e.prototype.isNetworkEventsUrlDefined=function(){return this._callProvider.isNetworkEventsUrlDefined()},e.prototype.removeOnNetworkEvents=function(){return this._callProvider.removeOnNetworkEvents()},e.prototype.isMediaConnected=function(e){return this._callProvider.isMediaConnected(e)},e.prototype.setPreferredReceiveResolution=function(e,t,i){return e._preferredReceiveResolutionCapability.isAllowed?0<T.map(A.Base.VideoResolution,function(e,t){return t===i?e:m}).length?this._callProvider.setPreferredReceiveResolution(e,t,i):T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.NOT_FOUND)).promise():T.Deferred().reject(new A.Services.Call.CallException(A.Services.Call.CallError.CAPABILITY_NOT_ALLOWED)).promise()},A.Services.Call.CallService=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Call.CallStates={FAR_END_RENEGOTIATING:"far_end_renegotiating",IDLE:"idle",IGNORED:"ignored",INITIATING:"initiating",REMOTE_ALERTING:"remote_alerting",RENEGOTIATING:"renegotiating",FAILED:"failed",ALERTING:"alerting",HELD:"held",ENDED:"ended",ENDING:"ending",HOLDING:"holding",UNHOLDING:"unholding",ESTABLISHED:"established",BEING_TRANSFERRED:"being_transferred",TRANSFERRING:"transferring"}}(),function(e){"use strict";AvayaClientServices.Services.Call.CallType={CallTypeDefaultRegisteredService:"DefaultRegisteredService",CallTypeHttpMeetMe:"HttpMeetMe"}}(),function(n){"use strict";function e(e,t,i,a,r,s){n.Base.Capability.call(this,n.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._call=e,this._validCallStates=t,this._mediaPreservedAllowed=i,this._validForRemote=a,this._validForLocal=r,this._validForBrowsers=s,e._addOnCallStateChangedCallback(this._recalculate.bind(this)),e.addOnCallServiceAvailableCallback(this._recalculate.bind(this)),e.addOnCallServiceUnavailableCallback(this._recalculate.bind(this)),e.addOnCallJoinedCallback(this._recalculate.bind(this))}(e.prototype=Object.create(n.Base.Capability.prototype))._recalculateDenialReason=function(){var e=n.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;return-1===this._validCallStates.indexOf(this._call.getState())||!this._mediaPreservedAllowed&&!this._call.isServiceAvailable()?e=n.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE:this._call.isRemote()&&!this._validForRemote?e=n.Base.CapabilityDenialReason.CAPABILITY_CALL_IS_REMOTE:this._call.isRemote()||this._validForLocal?this._isSupportedBrowser()?this._call._isDataOnly()&&(e=n.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED):e=n.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED:e=n.Base.CapabilityDenialReason.CAPABILITY_CALL_IS_NOT_REMOTE,e},e.prototype._recalculate=function(){var e=this._recalculateDenialReason(),t=e===n.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;this._updateIfChanged(t,e)},e.prototype._isSupportedBrowser=function(){var e=n.Base.Utils.getBrowserType();return!this._validForBrowsers||-1!==this._validForBrowsers.indexOf(e)},n.Services.Call.Capabilities.AbstractCallStateCapability=e}(AvayaClientServices),function(r){"use strict";function e(e){r.Base.Capability.call(this,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._callService=e}(e.prototype=Object.create(r.Base.Capability.prototype))._recalculate=function(){var e=r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,t=!0,i=this._callService.isServiceAvailable(),a=this._callService.isNetworkEventsUrlDefined();i&&a||(t=!1,e=r.Services.Call.CallError.CAPABILITY_NOT_ALLOWED),this._updateIfChanged(t,e)},r.Services.Call.Capabilities.AbstractNetworkEventsCapability=e}(AvayaClientServices),function(o){"use strict";function e(e,t,i,a,r,s,n){this._videoCapability=t,this._videoCapability.addOnChangedCallback(this._recalculate.bind(this)),e.addOnCallHeldRemotelyCallback(this._recalculate.bind(this)),e.addOnCallUnheldRemotelyCallback(this._recalculate.bind(this)),e.addOnCallEstablishedCallback(this._recalculate.bind(this)),o.Services.Call.Capabilities.AbstractCallStateCapability.call(this,e,i,a,r,s,n)}(e.prototype=Object.create(o.Services.Call.Capabilities.AbstractCallStateCapability.prototype)).isAllowedNailedUpVideoMode=function(e){var t=this._call._getAllowedNailedUpVideoModes();return!(0<t.length)||t.includes(e)},e.prototype._recalculate=function(){var e=o.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),t=e===o.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,i=this._call._conference,a=i?i._allowVideoDirection:m;t&&o.Base.Utils.isDefined(a)&&o.Base.Utils.isDefined(this._allowVideoDirections)&&(e=-1<this._allowVideoDirections.indexOf(a)?(t=!0,o.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(t=!1,o.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED));var r=this._isDirectionAllowed();!t||!this._call.isHeldRemotely()&&this._videoCapability.isAllowed&&r||(t=!1,e=this._videoCapability.isAllowed?o.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED:this._videoCapability.denialReason);var s=!o.Base.Utils.isDefined(this._call.getAudioChannel())||this._call.getAudioChannel()._getNegotiatedDirection()!==o.Services.Call.MediaDirection.DISABLE;t&&!s&&(t=!1,e=o.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED),this._updateIfChanged(t,e)},o.Services.Call.Capabilities.AbstractUpdateVideoModeCapability=e}(AvayaClientServices),function(a){"use strict";function e(e,t){var i=[a.Services.Call.CallStates.INITIATING,a.Services.Call.CallStates.IDLE,a.Services.Call.CallStates.ALERTING,a.Services.Call.CallStates.IGNORED,a.Services.Call.CallStates.ESTABLISHED,a.Services.Call.CallStates.HELD,a.Services.Call.CallStates.HOLDING,a.Services.Call.CallStates.UNHOLDING,a.Services.Call.CallStates.RENEGOTIATING,a.Services.Call.CallStates.FAR_END_RENEGOTIATING,a.Services.Call.CallStates.REMOTE_ALERTING];this._videoCapability=t,this._videoCapability.addOnChangedCallback(this._recalculate.bind(this)),e.addOnCallEstablishedCallback(this._recalculate.bind(this)),a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,e,i,!0,!1,!0)}(e.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype))._denyDataOnlyConference=function(e,t){e&&this._call._isDataOnly()&&(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED)},e.prototype._recalculateDenialReason=function(){var e=a.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),t=e===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;return this._denyDataOnlyConference(t,e),this._updateIfChanged(t,e),e},a.Services.Call.Capabilities.AbstractVideoMuteUnmuteCapability=e}(AvayaClientServices),function(r){"use strict";function e(e){var t=[r.Services.Call.CallStates.ESTABLISHED],i=[r.Base.BrowserType.CHROME,r.Base.BrowserType.CHROME_EXTENSION,r.Base.BrowserType.FIREFOX,r.Base.BrowserType.EDGE,r.Base.BrowserType.SAFARI];r.Services.Call.Capabilities.AbstractCallStateCapability.call(this,e,t,!1,!1,!0,i)}(e.prototype=Object.create(r.Services.Call.Capabilities.AbstractCallStateCapability.prototype))._recalculate=function(){var e=r.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),t=e===r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,i=!r.Base.Utils.isDefined(this._call.getAudioChannel())||this._call.getAudioChannel()._getNegotiatedDirection()!==r.Services.Call.MediaDirection.DISABLE,a=0!==this._call.getVideoChannels().length&&this._call.getVideoChannels()[0].getNegotiatedDirection()!==r.Services.Call.MediaDirection.DISABLE;!t||i||a||(t=!1,e=r.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED),this._updateIfChanged(t,e)},r.Services.Call.Capabilities.HoldCapability=e}(AvayaClientServices),function(r){"use strict";function e(e){var t=[r.Services.Call.CallStates.ESTABLISHED,r.Services.Call.CallStates.HELD];r.Services.Call.Capabilities.AbstractCallStateCapability.call(this,e,t,!1,!0,!1)}(e.prototype=Object.create(r.Services.Call.Capabilities.AbstractCallStateCapability.prototype))._recalculate=function(){var e=r.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),t=e===r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,i=!r.Base.Utils.isDefined(this._call.getAudioChannel())||this._call.getAudioChannel()._getNegotiatedDirection()!==r.Services.Call.MediaDirection.DISABLE,a=0!==this._call.getVideoChannels().length&&this._call.getVideoChannels()[0].getNegotiatedDirection()!==r.Services.Call.MediaDirection.DISABLE;!t||i||a||(t=!1,e=r.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED),this._updateIfChanged(t,e)},r.Services.Call.Capabilities.JoinCapability=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Services.Call.Capabilities.AbstractVideoMuteUnmuteCapability.call(this,e,t)}(e.prototype=Object.create(i.Services.Call.Capabilities.AbstractVideoMuteUnmuteCapability.prototype))._recalculate=function(){var e=i.Services.Call.Capabilities.AbstractVideoMuteUnmuteCapability.prototype._recalculateDenialReason.call(this),t=e===i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;t&&this._call._videoMuteState===i.Services.Call.MediaMuteStates.MUTED&&(t=!1,e=i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIfChanged(t,e)},i.Services.Call.Capabilities.MuteVideoCapability=e}(AvayaClientServices),function(t){"use strict";function e(e){t.Services.Call.Capabilities.AbstractNetworkEventsCapability.call(this,e)}e.prototype=Object.create(t.Services.Call.Capabilities.AbstractNetworkEventsCapability.prototype),t.Services.Call.Capabilities.RemoveOnNetworkEventsCapability=e}(AvayaClientServices),function(s){"use strict";function e(e){var t=[s.Services.Call.CallStates.ESTABLISHED,s.Services.Call.CallStates.RENEGOTIATING,s.Services.Call.CallStates.FAR_END_RENEGOTIATING],i=[s.Base.BrowserType.CHROME,s.Base.BrowserType.CHROME_EXTENSION,s.Base.BrowserType.FIREFOX,s.Base.BrowserType.FIREFOX_EXTENSION];s.Services.Call.Capabilities.AbstractCallStateCapability.call(this,e,t,!0,!1,!0,i)}(e.prototype=Object.create(s.Services.Call.Capabilities.AbstractCallStateCapability.prototype))._recalculate=function(e){var t=s.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),i=t===s.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,a=!s.Base.Utils.isDefined(this._call.getAudioChannel())||this._call.getAudioChannel()._getNegotiatedDirection()!==s.Services.Call.MediaDirection.DISABLE,r=0!==this._call.getVideoChannels().length&&this._call.getVideoChannels()[0].getNegotiatedDirection()!==s.Services.Call.MediaDirection.DISABLE;!i&&e&&this._call.getState()===s.Services.Call.CallStates.REMOTE_ALERTING&&(i=!0,t=s.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),!i||a||r||(i=!1,t=s.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED),this._updateIfChanged(i,t)},s.Services.Call.Capabilities.SendDTMFCapability=e}(AvayaClientServices),function(i){"use strict";function e(e){i.Base.Capability.call(this,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._call=e}(e.prototype=Object.create(i.Base.Capability.prototype))._recalculate=function(){var e=!1,t=i.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED;this._isSupportedByBrowser()&&this._isSupportedByCallType()&&(e=!0,t=i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateIfChanged(e,t)},e.prototype._isSupportedByBrowser=function(){var e=i.Base.Utils.getBrowserType();return e!==i.Base.BrowserType.IE&&e!==i.Base.BrowserType.EDGE},e.prototype._isSupportedByCallType=function(){return!1===this._call._isDataOnly()},i.Services.Call.Capabilities.ServiceQualityScoreCapability=e}(AvayaClientServices),function(t){"use strict";function e(e){t.Services.Call.Capabilities.AbstractNetworkEventsCapability.call(this,e)}e.prototype=Object.create(t.Services.Call.Capabilities.AbstractNetworkEventsCapability.prototype),t.Services.Call.Capabilities.SetOnNetworkEventsCapability=e}(AvayaClientServices),function(r){"use strict";function e(e){var t=[r.Services.Call.CallStates.ESTABLISHED,r.Services.Call.CallStates.HELD];e.addOnCallConferenceStatusChangedCallback(function(){this._recalculate()}.bind(this)),r.Services.Call.Capabilities.AbstractCallStateCapability.call(this,e,t,!1,!1,!0)}(e.prototype=Object.create(r.Services.Call.Capabilities.AbstractCallStateCapability.prototype))._recalculate=function(){var e=r.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),t=e===r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;t&&(this._call.isConference()||r.Base.Utils.isDefined(this._call._sessionId))&&(t=!1,e=r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),!0===t&&!1===this._isAllowedByProvider()&&(t=!1,e=r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIfChanged(t,e)},e.prototype._isAllowedByProvider=function(){if(this._call._callCreationInfo===m||typeof this._call._callCreationInfo.getServiceGatewayURL!=typeof Function.prototype)return!0;var e=this._call._callCreationInfo.getServiceGatewayURL();if(e===m)return!0;var t=r.Base.Utils.parseUrl(e),i=r.Base.Utils.getHost(t),a=this._call._callService._callProvider._csgwProviderFactory.getCSGCallsProvider(i);return null===a||a.isAllowedToTransfer(this._call.getCallId())},r.Services.Call.Capabilities.TransferCapability=e}(AvayaClientServices),function(i){"use strict";function e(e){var t=[i.Services.Call.CallStates.ESTABLISHED,i.Services.Call.CallStates.HELD];e.addOnCallConferenceStatusChangedCallback(function(){this._recalculate()}.bind(this)),i.Services.Call.Capabilities.AbstractCallStateCapability.call(this,e,t,!1,!1,!0)}(e.prototype=Object.create(i.Services.Call.Capabilities.AbstractCallStateCapability.prototype))._recalculate=function(){var e=i.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),t=e===i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;t&&(this._call.isConference()||i.Base.Utils.isDefined(this._call._sessionId))&&(t=!1,e=i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),!0===t&&!1===this._isAllowedByProvider()&&(t=!1,e=i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIfChanged(t,e)},e.prototype._isAllowedByProvider=i.Services.Call.Capabilities.TransferCapability.prototype._isAllowedByProvider,i.Services.Call.Capabilities.TransferToCapability=e}(AvayaClientServices),function(r){"use strict";function e(e){var t=[r.Services.Call.CallStates.HELD],i=[r.Base.BrowserType.CHROME,r.Base.BrowserType.CHROME_EXTENSION,r.Base.BrowserType.FIREFOX,r.Base.BrowserType.EDGE,r.Base.BrowserType.SAFARI];r.Services.Call.Capabilities.AbstractCallStateCapability.call(this,e,t,!1,!1,!0,i)}(e.prototype=Object.create(r.Services.Call.Capabilities.AbstractCallStateCapability.prototype))._recalculate=function(){var e=r.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),t=e===r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,i=!r.Base.Utils.isDefined(this._call.getAudioChannel())||this._call.getAudioChannel()._getNegotiatedDirection()!==r.Services.Call.MediaDirection.DISABLE,a=0!==this._call.getVideoChannels().length&&this._call.getVideoChannels()[0].getNegotiatedDirection()!==r.Services.Call.MediaDirection.DISABLE;!t||i||a||(t=!1,e=r.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED),this._updateIfChanged(t,e)},r.Services.Call.Capabilities.UnholdCapability=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Services.Call.Capabilities.AbstractVideoMuteUnmuteCapability.call(this,e,t)}(e.prototype=Object.create(i.Services.Call.Capabilities.AbstractVideoMuteUnmuteCapability.prototype))._recalculate=function(){var e=i.Services.Call.Capabilities.AbstractVideoMuteUnmuteCapability.prototype._recalculateDenialReason.call(this),t=e===i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;t&&this._call._videoMuteState!==i.Services.Call.MediaMuteStates.MUTED&&(t=!1,e=i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIfChanged(t,e)},i.Services.Call.Capabilities.UnmuteVideoCapability=e}(AvayaClientServices),function(a){"use strict";function e(e){var t=[a.Services.Call.CallStates.IDLE];a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,e,t,!1,!1,!0)}(e.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype))._recalculate=function(){var e=a.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),t=e===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,i=a.Base.Utils.isDefined(this._call._callCreationInfo)&&a.Base.Utils.isDefined(this._call._callCreationInfo.getUccpURL());!t||a.Base.Utils.isDefined(this._call._sessionId)||i||(t=!1,e=a.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED),this._updateIfChanged(t,e)},a.Services.Call.Capabilities.UpdateAudioModeCapability=e}(AvayaClientServices),function(r){"use strict";function e(e,t){var i=[r.Services.Call.CallStates.ESTABLISHED],a=[r.Base.BrowserType.CHROME,r.Base.BrowserType.CHROME_EXTENSION,r.Base.BrowserType.FIREFOX,r.Base.BrowserType.EDGE,r.Base.BrowserType.SAFARI];this._videoCapability=t,this._videoCapability.addOnChangedCallback(this._recalculate.bind(this)),e.addOnCallEstablishedCallback(this._recalculate.bind(this)),r.Services.Call.Capabilities.AbstractCallStateCapability.call(this,e,i,!1,!1,!0,a)}(e.prototype=Object.create(r.Services.Call.Capabilities.AbstractCallStateCapability.prototype))._recalculateDenialReason=function(){var e=r.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),t=e===r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;if(t)if(this._videoCapability.isAllowed){var i=this._call.getVideoChannels();0<i.length&&(i[0].getNegotiatedDirection()===r.Services.Call.MediaDirection.SEND_RECV||i[0].getNegotiatedDirection()===r.Services.Call.MediaDirection.RECV_ONLY)||(t=!1,e=r.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED)}else t=!1,e=this._videoCapability.denialReason;return this._updateIfChanged(t,e),e},r.Services.Call.Capabilities.UpdatePreferredReceiveResolutionCapability=e}(AvayaClientServices),function(r){"use strict";function e(e,t){this._videoCapability=t,this._videoCapability.addOnChangedCallback(this._recalculate.bind(this));var i=[r.Services.Call.CallStates.ESTABLISHED];r.Services.Call.Capabilities.AbstractCallStateCapability.call(this,e,i,!1,!1,!0)}(e.prototype=Object.create(r.Services.Call.Capabilities.AbstractCallStateCapability.prototype))._recalculate=function(){var e=r.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),t=e===r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,i=!r.Base.Utils.isDefined(this._call.getAudioChannel())||this._call.getAudioChannel()._getNegotiatedDirection()!==r.Services.Call.MediaDirection.DISABLE,a=0!==this._call.getVideoChannels().length&&this._call.getVideoChannels()[0].getNegotiatedDirection()!==r.Services.Call.MediaDirection.DISABLE;!t||!this._call._isDataOnly()&&this._videoCapability.isAllowed&&(i||a)||(t=!1,e=this._call._isDataOnly()?r.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED:this._videoCapability.denialReason),this._updateIfChanged(t,e)},r.Services.Call.Capabilities.UpdateVideoChannelsCapability=e}(AvayaClientServices),function(r){"use strict";function e(e,t){var i=[r.Services.Call.CallStates.ESTABLISHED],a=[r.Base.BrowserType.CHROME,r.Base.BrowserType.CHROME_EXTENSION,r.Base.BrowserType.FIREFOX,r.Base.BrowserType.EDGE,r.Base.BrowserType.SAFARI,r.Base.BrowserType.IE];r.Services.Call.Capabilities.AbstractUpdateVideoModeCapability.call(this,e,t,i,!1,!1,!0,a)}(e.prototype=Object.create(r.Services.Call.Capabilities.AbstractUpdateVideoModeCapability.prototype))._isDirectionAllowed=function(){var e=this._call.getVideoChannels(),t=0<e.length&&e[0].getNegotiatedDirection()!==r.Services.Call.MediaDirection.INACTIVE&&e[0].getNegotiatedDirection()!==r.Services.Call.MediaDirection.DISABLE,i=r.Base.Utils.getBrowserType()===r.Base.BrowserType.SAFARI;return t&&!(i&&this._call.getEstablishedTime())&&this.isAllowedNailedUpVideoMode(r.Services.Call.VideoMode.DISABLE)},r.Services.Call.Capabilities.UpdateVideoModeDisableCapability=e}(AvayaClientServices),function(a){"use strict";function e(e,t){this._allowVideoDirections=[a.Services.Conference.AllowVideoDirection.SEND_RECEIVE,a.Services.Conference.AllowVideoDirection.SEND_ONLY,a.Services.Conference.AllowVideoDirection.RECEIVE_ONLY,a.Services.Conference.AllowVideoDirection.INACTIVE];var i=[a.Services.Call.CallStates.IDLE,a.Services.Call.CallStates.IGNORED];a.Services.Call.Capabilities.AbstractUpdateVideoModeCapability.call(this,e,t,i,!1,!1,!0)}(e.prototype=Object.create(a.Services.Call.Capabilities.AbstractUpdateVideoModeCapability.prototype))._isDirectionAllowed=function(){var e=this._call.getVideoChannels();return 0<e.length&&e[0].getNegotiatedDirection()!==a.Services.Call.MediaDirection.INACTIVE&&e[0].getNegotiatedDirection()!==a.Services.Call.MediaDirection.DISABLE&&this.isAllowedNailedUpVideoMode(a.Services.Call.VideoMode.INACTIVE)},a.Services.Call.Capabilities.UpdateVideoModeInactiveCapability=e}(AvayaClientServices),function(a){"use strict";function e(e,t){this._allowVideoDirections=[a.Services.Conference.AllowVideoDirection.SEND_RECEIVE,a.Services.Conference.AllowVideoDirection.RECEIVE_ONLY];var i=[a.Services.Call.CallStates.IDLE,a.Services.Call.CallStates.IGNORED,a.Services.Call.CallStates.ALERTING,a.Services.Call.CallStates.ESTABLISHED];a.Services.Call.Capabilities.AbstractUpdateVideoModeCapability.call(this,e,t,i,!1,!1,!0)}(e.prototype=Object.create(a.Services.Call.Capabilities.AbstractUpdateVideoModeCapability.prototype))._isDirectionAllowed=function(){var e=this._call.getVideoChannels();return(0===e.length&&this._call.getState()!==a.Services.Call.CallStates.ESTABLISHED||0<e.length&&e[0].getNegotiatedDirection()!==a.Services.Call.MediaDirection.RECV_ONLY)&&this.isAllowedNailedUpVideoMode(a.Services.Call.VideoMode.RECEIVE_ONLY)},a.Services.Call.Capabilities.UpdateVideoModeReceiveOnlyCapability=e}(AvayaClientServices),function(r){"use strict";function e(e,t){this._allowVideoDirections=[r.Services.Conference.AllowVideoDirection.SEND_RECEIVE,r.Services.Conference.AllowVideoDirection.SEND_ONLY];var i=[r.Services.Call.CallStates.IDLE,r.Services.Call.CallStates.IGNORED,r.Services.Call.CallStates.ALERTING,r.Services.Call.CallStates.ESTABLISHED],a=[r.Base.BrowserType.CHROME,r.Base.BrowserType.CHROME_EXTENSION,r.Base.BrowserType.FIREFOX,r.Base.BrowserType.EDGE,r.Base.BrowserType.SAFARI];r.Services.Call.Capabilities.AbstractUpdateVideoModeCapability.call(this,e,t,i,!1,!1,!0,a)}(e.prototype=Object.create(r.Services.Call.Capabilities.AbstractUpdateVideoModeCapability.prototype))._isDirectionAllowed=function(){var e=this._call.getVideoChannels(),t=0===e.length&&this._call.getState()!==r.Services.Call.CallStates.ESTABLISHED||0<e.length&&e[0].getNegotiatedDirection()!==r.Services.Call.MediaDirection.SEND_ONLY&&e[0].getNegotiatedDirection()!==r.Services.Call.MediaDirection.RECV_ONLY,i=r.Base.Utils.getBrowserType()===r.Base.BrowserType.SAFARI;return t&&!(i&&this._call.getEstablishedTime())&&this.isAllowedNailedUpVideoMode(r.Services.Call.VideoMode.SEND_ONLY)},r.Services.Call.Capabilities.UpdateVideoModeSendOnlyCapability=e}(AvayaClientServices),function(r){"use strict";function e(e,t){this._allowVideoDirections=[r.Services.Conference.AllowVideoDirection.SEND_RECEIVE];var i=[r.Services.Call.CallStates.IDLE,r.Services.Call.CallStates.IGNORED,r.Services.Call.CallStates.ALERTING,r.Services.Call.CallStates.ESTABLISHED];r.Services.Call.Capabilities.AbstractUpdateVideoModeCapability.call(this,e,t,i,!1,!1,!0)}(e.prototype=Object.create(r.Services.Call.Capabilities.AbstractUpdateVideoModeCapability.prototype))._isDirectionAllowed=function(){var e=this._call.getVideoChannels(),t=-1!==[r.Base.BrowserType.CHROME,r.Base.BrowserType.CHROME_EXTENSION,r.Base.BrowserType.FIREFOX,r.Base.BrowserType.EDGE,r.Base.BrowserType.SAFARI].indexOf(r.Base.Utils.getBrowserType()),i=0===e.length&&(t||this._call.getState()!==r.Services.Call.CallStates.ESTABLISHED)||0<e.length&&e[0].getNegotiatedDirection()!==r.Services.Call.MediaDirection.SEND_RECV,a=!1;return r.Base.Utils.getBrowserType()===r.Base.BrowserType.SAFARI&&0!==e.length&&(a=e[0].getNegotiatedDirection()===r.Services.Call.MediaDirection.SEND_ONLY&&this._call.getEstablishedTime()),i&&!a&&this.isAllowedNailedUpVideoMode(r.Services.Call.VideoMode.SEND_RECEIVE)},r.Services.Call.Capabilities.UpdateVideoModeSendReceiveCapability=e}(AvayaClientServices),function(a){"use strict";function e(e){var t=[a.Services.Call.CallStates.IDLE];a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,e,t,!1,!1,!0)}(e.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype))._recalculate=function(){var e=a.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),t=e===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,i=this._call._callService._config&&this._call._callService._config.wcsConfiguration&&this._call._callService._config.wcsConfiguration.enabled;t&&!i&&(t=!1,e=a.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED),this._updateIfChanged(t,e)},a.Services.Call.Capabilities.UpdateWebCollaborationCapability=e}(AvayaClientServices),function(r){"use strict";function e(e){r.Base.Capability.call(this,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._calls=e}(e.prototype=Object.create(r.Base.Capability.prototype))._recalculate=function(){var e=r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,t=!0,i=this._calls._isWebRTCSupportedBrowser(),a=this._calls._isRegistrationTerminated();this._calls._isAvailable&&i&&!a||(t=!1,e=a?r.Services.Call.CallError.REGISTRATION_TERMINATED:i?r.Services.Call.CallError.SERVICE_TEMPORARILY_UNAVAILABLE:r.Services.Call.CallError.WEBRTC_NOT_SUPPORTED),this._updateIfChanged(t,e)},r.Services.Call.Capabilities.VoipCallingCapability=e}(AvayaClientServices),function(r){"use strict";function e(e,t,i,a){this._token=e,this._isOTT=!!r.Base.Utils.isDefined(t)&&t,this._meetingId=r.Base.Utils.isDefined(i)?i:null,this._passcode=r.Base.Utils.isDefined(a)?a:null}e.prototype={getToken:function(){return this._token},setToken:function(e){this._token=e},isOTT:function(){return this._isOTT},enableOTT:function(e){this._isOTT=e,this._isWebRTCAbleConf=this._isOTT},getMeetingId:function(){return this._meetingId},setMeetingId:function(e){this._meetingId=e},getPasscode:function(){return this._passcode},setPasscode:function(e){this._passcode=e}},r.Services.Call.ConferenceEntryOptions=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Call.DTMFTone={A:"A",B:"B",C:"C",D:"D",STAR:"*",POUND:"#",ONE:1,TWO:2,THREE:3,FOUR:4,FIVE:5,SIX:6,SEVEN:7,EIGHT:8,NINE:9,ZERO:0}}(),function(t){"use strict";var e={RECV_ONLY:"recvonly",SEND_ONLY:"sendonly",SEND_RECV:"sendrecv",INACTIVE:"inactive",DISABLE:"disable",UNDEFINED:"undefined",_isDisabled:function(e){return e===t.Services.Call.MediaDirection.DISABLE||e===t.Services.Call.MediaDirection.UNDEFINED}};t.Services.Call.MediaDirection=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Call.MediaMuteStates={UNDEFINED:0,MUTED:1,UNMUTED:2}}(),function(e){"use strict";function t(e,t){this.call=e,this.id=t}t.prototype.startCall=function(e){},t.prototype.endCall=function(e){},e.Services.Call.Modes.AbstractCallMode=t}(AvayaClientServices),function(o){"use strict";function e(e,t,i){o.Services.Call.Modes.AbstractCallMode.call(this,e,t),this._contactsIntegrationService=i}(e.prototype=Object.create(o.Services.Call.Modes.AbstractCallMode.prototype)).startCall=function(e){var t;if(this._createDataOnlyConference(e),o.Base.Utils.isDefined(e._callCreationInfo)&&o.Base.Utils.isDefined(e._callCreationInfo.getUccpURL())){t=e._callCreationInfo.getUccpURL();var i=e._callService._parseUccpUrl(t);if(!o.Base.Utils.isDefined(i))return o.Base.Logger.error(o.Base.LoggerTags.CALL_SERVICE,"Failed to parse UCCP url: "+t),void e._callService._notifyCallFailure(e,o.Services.Call.CallError.SERVICE_TEMPORARILY_UNAVAILABLE);e._onCallStartedCallbacks.fire(e),e._onCallEstablishedCallbacks.fire(e),e._conference._setConfiguration(i)}e._callService.createCollaborationForConference(e),e._onCallConferenceStatusChangedCallbacks.fire(e,!0,t)},e.prototype.endCall=function(e){e.getConference()._conferenceService.sendDisconnectEvent(),e.getConference().stop();var t=new o.Services.Call.CallEndEvent(o.Services.Call.CallEndReason.CALL_DISCONNECTED);e._onCallEndedCallbacks.fire(e,t),e._callService._callManager.deleteCall(e)},e.prototype._createDataOnlyConference=function(e){var t=e._callService.getScopiaConferenceProvider(),i=e._callService.createChatService(t),a=e._callService.createParticipantService(t),r=new o.Services.Conference.Chat(i),s=new o.Services.Conference.ConferenceService(o.Services.Conference.ConferenceType.SCOPIA_CONFERENCE,t,this._contactsIntegrationService);e._setConference(new o.Services.Conference.Conference(s,a,r)),e._conference._isUccpConference=!0;var n=e._callCreationInfo.getPasscode();e._conference._setPreEnteredPasscode(n)},o.Services.Call.Modes.ConferenceCallMode=e}(AvayaClientServices),function(e){"use strict";function t(){this.ringback=m,this.intercept=m,this.reorder=m,this.fastBusy=m}t.prototype._setRingbackToneUrl=function(e){this.ringback=e},t.prototype.getRingbackToneUrl=function(){return this.ringback},t.prototype._setInterceptToneUrl=function(e){this.intercept=e},t.prototype.getInterceptToneUrl=function(){return this.intercept},t.prototype._setReorderToneUrl=function(e){this.reorder=e},t.prototype.getReorderToneUrl=function(){return this.reorder},t.prototype._setFastBusyToneUrl=function(e){this.fastBusy=e},t.prototype.getFastBusyToneUrl=function(){return this.fastBusy},e.Services.Call.RingbackToneURLs=t}(AvayaClientServices),function(t){"use strict";var i=[{score:t.Base.AbsoluteCategoryRating.EXCELLENT,max:3},{score:t.Base.AbsoluteCategoryRating.GOOD,max:7},{score:t.Base.AbsoluteCategoryRating.FAIR,max:10},{score:t.Base.AbsoluteCategoryRating.POOR,max:15},{score:t.Base.AbsoluteCategoryRating.BAD}],a=[{score:t.Base.AbsoluteCategoryRating.EXCELLENT,max:1},{score:t.Base.AbsoluteCategoryRating.GOOD,max:3},{score:t.Base.AbsoluteCategoryRating.FAIR,max:5},{score:t.Base.AbsoluteCategoryRating.POOR,max:10},{score:t.Base.AbsoluteCategoryRating.BAD}];function e(e){this._call=e,this._bound=!1,this._score=m,this._onScoreChangedCallbacks=T.Callbacks(),this._updateScoreInterval=m,this._previousAudioReport=m,this._previousVideoReport=m}e.prototype.watch=function(){return this._canBeBound()&&(this._call.addOnCallStartedCallback(this._start.bind(this)),this._call.addOnCallEstablishedCallback(this._start.bind(this)),this._call.addOnCallHeldCallback(this._stop.bind(this)),this._call.addOnCallUnheldCallback(this._start.bind(this)),this._call.addOnCallEndedCallback(this._stop.bind(this)),this._bound=!0),this._bound},e.prototype.getScore=function(){return this._score},e.prototype.addOnScoreChangedCallback=function(e){this._onScoreChangedCallbacks.add(e)},e.prototype.removeOnScoreChangedCallback=function(e){this._onScoreChangedCallbacks.remove(e)},e.prototype._canBeBound=function(){return!0===this._call.getServiceQualityScoreCapability().isAllowed&&!1===this._bound},e.prototype._start=function(){var e=T.Deferred();e.then(function(){t.Base.Utils.isUndefined(this._updateScoreInterval)&&(this._updateScoreInterval=setInterval(this._updateScore.bind(this),5e3))}.bind(this)),this._updateScore(e)},e.prototype._stop=function(){clearInterval(this._updateScoreInterval),this._updateScoreInterval=m,this._previousAudioReport=m,this._previousVideoReport=m,this._setScore(m)},e.prototype._updateScore=function(e){this._call._callService._getCallStatistics(this._call).then(function(e){var t=this._getScoreForAudio(e.audioStatistics),i=this._getScoreForVideo(e.videoStatistics);this._setScore(this._getTotalScore(t,i))}.bind(this)).always(function(){e!==m&&e.resolve()})},e.prototype._getScoreForAudio=function(e){var t=this._getScore(e,this._previousAudioReport,i);return this._previousAudioReport=e,t},e.prototype._getScoreForVideo=function(e){var t=this._getScore(e,this._previousVideoReport,a);return this._previousVideoReport=e,t},e.prototype._getScore=function(e,t,i){var a=this._getIncomingLosses(e,t),r=this._getOutgoingLosses(e,t);return a===m&&r===m?m:a===m?this._packetLossToScore(r,i):r===m?this._packetLossToScore(a,i):this._packetLossToScore(Math.max(a,r),i)},e.prototype._getIncomingLosses=function(e,t){var i,a;return t!==m&&(i=t.packetsReceived,a=t.packetLossTotalReceived),this._getLosses(e.packetsReceived,e.packetLossTotalReceived,i,a)},e.prototype._getOutgoingLosses=function(e,t){var i,a;return t!==m&&(i=t.packetsTransmitted,a=t.packetLossTotalTransmitted),this._getLosses(e.packetsTransmitted,e.packetLossTotalTransmitted,i,a)},e.prototype._getLosses=function(e,t,i,a){return t===m||0===t?t:t===a?0:("number"==typeof i&&"number"==typeof a&&(e-=i,t-=a),t/e*100)},e.prototype._packetLossToScore=function(e,t){for(var i=0;i<t.length;++i)if(t[i].max===m||e<=t[i].max)return t[i].score;return m},e.prototype._getTotalScore=function(e,t){return e===m&&t===m?m:e===m?t:t===m?e:Math.min(e,t)},e.prototype._setScore=function(e){this._score!==e&&(this._score=e,this._onScoreChangedCallbacks.fire(e))},t.Services.Call.ServiceQuality=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Call.TransferProgressCode={ACCEPTED:"ACCEPTED",NONE:"NONE",REMOTE_CALL_ESTABLISHED:"REMOTE_CALL_ESTABLISHED",REMOTE_CALL_IN_PROGRESS:"REMOTE_CALL_IN_PROGRESS",REMOTE_CALL_STARTED:"REMOTE_CALL_STARTED",STARTED:"STARTED"}}(),function(){"use strict";function e(e,t,i){this._ucid=e,this._parentUcid=t,this._contextId=i}e.prototype={getUCID:function(){return this._ucid},getParentUCID:function(){return this._parentUcid},getContextId:function(){return this._contextId},setContextId:function(e){this._contextId=e},_setUCID:function(e){this._ucid=e},_setParentUCID:function(e){this._parentUcid=e}},AvayaClientServices.Services.Call.UserToUserInfo=e}(AvayaClientServices),function(t){"use strict";function e(e){this._channelId=m,this._requestedDirection=m,this._internalRequestedDirection=m,this._negotiatedDirection=m,this._disabledReason=t.Services.Call.VideoChannelDisabledReason.NONE,this._isCameraAccessDenied=!1,this._call=e,this._preferredVideoResolution=m,this._cameraDenialReason=m}e.prototype={getChannelId:function(){return this._channelId},getNegotiatedDirection:function(){return this._negotiatedDirection},getRequestedDirection:function(){return this._requestedDirection},getVideoDisabledReason:function(){return this._disabledReason},getCameraDenialReason:function(){return this._cameraDenialReason},isDisabled:function(){return this._disabledReason!==t.Services.Call.VideoChannelDisabledReason.NONE},isCameraAccessDenied:function(){return this._isCameraAccessDenied},setPreferredReceiveResolution:function(e){return this._call._callService.setPreferredReceiveResolution(this._call,this._channelId,e)},getUpdatePreferredReceiveResolutionCapability:function(){return this._call._preferredReceiveResolutionCapability},getPreferredReceiveResolution:function(){return this._preferredVideoResolution},_setRequestedDirection:function(e){this._requestedDirection=e,this._internalRequestedDirection=e},_setNegotiatedDirection:function(e){this._negotiatedDirection=e},_setInternalRequestedDirection:function(e){this._internalRequestedDirection=e},_getInternalRequestedDirection:function(){return this._internalRequestedDirection},_setChannelId:function(e){this._channelId=e},_setVideoDisabledReason:function(e){this._disabledReason=e},_setCameraAccessIsDenied:function(e){this._isCameraAccessDenied=!0,this._cameraDenialReason=e}},t.Services.Call.VideoChannel=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Call.VideoChannelDisabledReason={NONE:"none",DISABLED_BY_LOCAL_USER:"disabledByLocalUser",DISABLED_BY_REMOTE_USER:"disabledByRemoteUser",DISABLED_DUE_TO_CPU_OVERLOAD:"disabledDueToCpuOverload",DISABLED_DUE_TO_INSUFFICIENT_BANDWIDTH:"disabledDueToInsufficientBandwidth",DISABLED_DUE_TO_LOCAL_PLATFORM_LIMITATIONS:"disabledDueToLocalPlatformLimitations",DISABLED_DUE_TO_LOCAL_LAYOUT_SELECTION:"disabledDueToLocalLayoutSelection",DISABLED_DUE_TO_MISSING_H264_PLUGIN:"disabledDueToMissingH264Plugin"}}(),function(e){"use strict";(AvayaClientServices||{}).Services.Call.VideoDetails=function(e){this.bytesTransmitted=e.bytesTransmitted,this.bytesReceived=e.bytesReceived,this.actualBitRateTransmitted=e.actualBitRateTransmitted,this.actualBitRateReceived=e.actualBitRateReceived,this.packetsTransmitted=e.packetsTransmitted,this.packetsReceived=e.packetsReceived,this.packetLossTotalTransmitted=e.packetLossTotalTransmitted,this.packetLossTotalReceived=e.packetLossTotalReceived,this.packetsLossFractionTransmitted=e.packetsLossFractionTransmitted,this.packetsLossFractionReceived=e.packetsLossFractionReceived,this.actualFrameRateTransmitted=e.actualFrameRateTransmitted,this.actualFrameRateReceived=e.actualFrameRateReceived,this.codec=e.codec,this.roundTripTimeMillis=e.roundTripTimeMillis,this.heightTransmitted=e.heightTransmitted,this.heightReceived=e.heightReceived,this.widthTransmitted=e.widthTransmitted,this.widthReceived=e.widthReceived,this.firCountTransmitted=e.firCountTransmitted,this.firCountReceived=e.firCountReceived,this.pliCountTransmitted=e.pliCountTransmitted,this.pliCountReceived=e.pliCountReceived,this.framesTransmitted=e.framesTransmitted,this.framesReceived=e.framesReceived,this.nackCountTransmitted=e.nackCountTransmitted,this.nackCountReceived=e.nackCountReceived,this.availableTransmitBitrate=e.availableTransmitBitrate,this.availableReceiveBitrate=e.availableReceiveBitrate,this.jitterMillisecondsReceived=e.jitterMillisecondsReceived}}(),function(e){"use strict";AvayaClientServices.Services.Call.VideoMode={SEND_RECEIVE:"SEND_RECEIVE",RECEIVE_ONLY:"RECEIVE_ONLY",SEND_ONLY:"SEND_ONLY",INACTIVE:"INACTIVE",DISABLE:"DISABLE"}}(),function(e){"use strict";AvayaClientServices.Services.Call.VideoNetworkSignalingType={INDEFINITE:"indefinite",OFF:"off",SUPPORTED:"supported"}}(),function(i){"use strict";function e(e,t){i.Base.BaseError.call(this,e,t),this.name="CollaborationError"}e.prototype=Object.create(i.Base.BaseError.prototype),i.Services.Collaboration.CollaborationError=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Collaboration.CollaborationErrorReason={COLLABORATION_START_FAILURE:"Failed to start collaboration.",COLLABORATION_STOP_FAILURE:"Failed to stop collaboration.",COLLABORATION_NOTIFICATIONS_CHANNEL_FAILED:"Start notification channel failed.",BROWSER_NOT_SUPPORTED:"Browser is not supported",WHITEBOARD_REMOVE_LAST_SURFACE:"Failed to remove surface. You cannot remove last surface.",WHITEBOARD_REMOVE_SURFACE_FAILED:"Failed to remove surface.",WHITEBOARD_REMOVE_SHAPE_NOT_MINE:"Failed to remove shape. You can only remove shapes that you drew.",WHITEBOARD_ALREADY_ACTIVE:"Failed to start whiteboard surface. Surface is already started.",WHITEBOARD_INACTIVE:"Whiteboard is not started.",INTERNAL_ERROR:"An internal error occurred."}}(),function(d){"use strict";function e(e,t,i,a){this._userConfig=e,this._providerFactory=t,this._bandwidthManager=i,this._colaborationsAnalyticsService=a}e.prototype={create:function(e,t,i,a){a=a||this._userConfig;var r=this._providerFactory.createCollaborationProviders(a)[0],s=this._createCollaborationService(r),n=this._createWhiteboard(r),o=this._createContentSharing(r,a,e),c=new d.Services.Collaboration.Slider,l=new d.Services.Collaboration.Collaboration(s,n,o,c,t,i);return n._setCollaboration(l),o._setCollaboration(l),l},_createCollaborationService:function(e){return this._identity=m,this._collaborationProviderInitialized=!1,new d.Services.Collaboration.CollaborationService(e,this._colaborationsAnalyticsService)},_createWhiteboard:function(e){var t=new d.Services.Collaboration.WhiteboardService(e,this._colaborationsAnalyticsService);return new d.Services.Collaboration.Whiteboard(t)},_createContentSharing:function(e,t,i){var a=this._createContentSharingService(e,t.collaborationConfiguration);return new d.Services.Collaboration.ContentSharing(a,i)},_createContentSharingService:function(e,t){(d.Base.Utils.isUndefined(t)||d.Base.Utils.isUndefined(t.contentSharingWorkerPath))&&d.Base.Logger.warn(d.Base.LoggerTags.COLLABORATION_SERVICE,"Web worker path is undefined. Content sharing will not be enabled.");var i=new d.Providers.ContentSharing.ScreenSharingProviderFactory(e,this._bandwidthManager);return new d.Services.Collaboration.ContentSharingService(e,i.getScreenSharingProvider(t),this._colaborationsAnalyticsService)}},d.Services.Collaboration.CollaborationFactory=e}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a,r,s){this._x=e,this._y=t,this._width=i,this._height=a,this._bitmapData=s,this._imageType=r}t.prototype={getXOffset:function(){return this._x},getYOffset:function(){return this._y},getRawBitmapData:function(){return this._bitmapData},getBlobData:function(){var e=new Blob([this._bitmapData],{type:"image/"+(0===this._imageType?"jpeg":"png")});return window.URL.createObjectURL(e)},getBase64BitmapData:function(){return"data:image/"+(0===this._imageType?"jpeg":"png")+";base64,"+this._toBase64(this._bitmapData)},getWidth:function(){return this._width},getHeight:function(){return this._height},_toBase64:function(e){for(var t,i="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(e),s=r.byteLength,n=s%3,o=s-n,c=0;c<o;c+=3)i+=a[(16515072&(t=r[c]<<16|r[c+1]<<8|r[c+2]))>>18]+a[(258048&t)>>12]+a[(4032&t)>>6]+a[63&t];return 1===n?i+=a[(252&(t=r[o]))>>2]+a[(3&t)<<4]+"==":2===n&&(i+=a[(64512&(t=r[o]<<8|r[o+1]))>>10]+a[(1008&t)>>4]+a[(15&t)<<2]+"="),i}},e.Services.Collaboration.Bitmap=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Collaboration.FeaturesAvailable={LIBRARY:"LIBRARY",POLLING:"POLLING",MINUTES:"MINUTES",WHITEBOARD:"WHITEBOARD",MESSAGES:"MESSAGES",REPORTS:"REPORTS",SCREEN_SHARING:"SCREEN_SHARING",SLIDER:"SLIDER",REMOTE_CONTROL:"REMOTE_CONTROL"}}(),function(e){"use strict";function t(e,t,i,a){this._keyFrame=a,this._height=t,this._width=e,this._bitmaps=i}t.prototype={getBitmaps:function(){return this._bitmaps},getWidth:function(){return this._width},getHeight:function(){return this._height},isKeyFrame:function(){return this._keyFrame}},e.Services.Collaboration.Frame=t}(AvayaClientServices),function(e){"use strict";function t(e,t){this._x=e,this._y=t}t.prototype={getX:function(){return this._x},getY:function(){return this._y},setX:function(e){this._x=e},setY:function(e){this._y=e}},e.Services.Collaboration.Point=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Collaboration.SelectionStatus={PENDING:"PENDING",CONFIRMED:"CONFIRMED",ERROR:"ERROR"}}(),function(e){"use strict";AvayaClientServices.Services.Collaboration.WhiteboardLineWidths={SMALL:4,MEDIUM:8,LARGE:12}}(),function(e){"use strict";AvayaClientServices.Services.Collaboration.WhiteboardTextSizes={SMALL:19,MEDIUM:23,LARGE:27}}(),function(e){"use strict";AvayaClientServices.Services.Collaboration.WhiteboardToolModes={STROKE:"STROKE",FILLED:"FILLED"}}(),function(e){"use strict";AvayaClientServices.Services.Collaboration.WhiteboardToolTypes={SELECTION:"SELECTION",RECTANGLE:"RECTANGLE",CIRCLE:"CIRCLE",MARKER:"MARKER",PEN:"PEN",LINE:"LINE",STAMP:"STAMP",TEXT:"TEXT",DELETE:"DELETE",CLEAR:"CLEAR"}}(),function(s){"use strict";function e(e,t,i){this._collaborationProvider=e,this._contentSharingType=s.Services.Collaboration.ContentSharingType.NONE,this._sharingState=s.Services.Collaboration.ContentSharingState.NOT_SHARING,this._screenSharingProvider=t,this._isScreenScraperActive=!1,this._collaborationsAnalyticsService=i}e.prototype={start:function(e){this._screenSharingProvider.start(),this._initSharingEventHandler(e)},stop:function(e){this._screenSharingProvider.stop(),this._removeSharingEventHandler(e)},setExtensionAvailable:function(e){this._screenSharingProvider.setExtensionAvailable(e)},startScreenSharingFullScreen:function(t,e,i){if(s.Base.Logger.info(s.Base.LoggerTags.COLLABORATION_SERVICE,"Content Screen Sharing Service: Start full screen sharing..."),t.getShareFullScreenCapability().isAllowed){if(this.getShareApplicationWindowCapability().isAllowed){t._collaborationEnd=!1,this._contentSharingType=s.Services.Collaboration.ContentSharingType.FULL_SCREEN_SHARING;var a=t._getCollaborations();return this._screenSharingProvider.startFullScreen(e,i).then(function(e){return this._isScreenScraperActive=!0,this._sharingState=s.Services.Collaboration.ContentSharingState.SHARING,a._activeContentSharing=t,a._onActiveContentSharingChangedCallback.fire(),this._collaborationsAnalyticsService.sendStartupEvent(!0),e}.bind(this),function(e){return a._activeContentSharing=m,a._onActiveContentSharingChangedCallback.fire(),this._collaborationsAnalyticsService.sendStartupEvent(!1),T.Deferred().reject(e).promise()}.bind(this))}return T.Deferred().reject(s.Base.ErrorReasons.CAPABILITY_NOT_INSTALLED).promise()}return T.Deferred().reject(s.Base.ErrorReasons.CAPABILITY_NOT_ALLOWED).promise()},isSharingFullScreen:function(){return this._isSharingAnyType()?m:this._sharingState!==s.Services.Collaboration.ContentSharingState.NOT_SHARING&&this._contentSharingType===s.Services.Collaboration.ContentSharingType.FULL_SCREEN_SHARING},startSharingApplicationWindow:function(t,e,i){if(s.Base.Logger.info(s.Base.LoggerTags.COLLABORATION_SERVICE,"Content Screen Sharing Service: Start appl window sharing..."),t.getShareApplicationWindowCapability().isAllowed){if(this.getShareApplicationWindowCapability().isAllowed){t._collaborationEnd=!1,this._contentSharingType=s.Services.Collaboration.ContentSharingType.APP_WINDOW_SHARING;var a=t._getCollaborations();return this._screenSharingProvider.startApplicationWindow(e,i).then(function(e){return this._isScreenScraperActive=!0,this._sharingState=s.Services.Collaboration.ContentSharingState.SHARING,a._activeContentSharing=t,a._onActiveContentSharingChangedCallback.fire(),this._collaborationsAnalyticsService.sendStartupEvent(!0),e}.bind(this),function(e){return a._activeContentSharing=m,a._onActiveContentSharingChangedCallback.fire(),this._collaborationsAnalyticsService.sendStartupEvent(!1),T.Deferred().reject(e).promise()}.bind(this))}return T.Deferred().reject(s.Base.ErrorReasons.CAPABILITY_NOT_INSTALLED).promise()}return T.Deferred().reject(s.Base.ErrorReasons.CAPABILITY_NOT_ALLOWED).promise()},startScreenSharingAnyType:function(t,e){if(s.Base.Logger.info(s.Base.LoggerTags.COLLABORATION_SERVICE,"Content Screen Sharing Service: Start screen sharing any type..."),t.getStartScreenSharingCapability().isAllowed){if(this.getShareAnyTypeCapability().isAllowed){t._collaborationEnd=!1,this._contentSharingType=s.Services.Collaboration.ContentSharingType.ANY_TYPE;var i=t._getCollaborations();return this._screenSharingProvider.startSharingAnyType(e).then(function(e){return this._isScreenScraperActive=!0,this._sharingState=s.Services.Collaboration.ContentSharingState.SHARING,i._activeContentSharing=t,i._onActiveContentSharingChangedCallback.fire(),this._collaborationsAnalyticsService.sendStartupEvent(!0),e}.bind(this),function(e){return i._activeContentSharing=m,i._onActiveContentSharingChangedCallback.fire(),this._collaborationsAnalyticsService.sendStartupEvent(!1),T.Deferred().reject(e).promise()}.bind(this))}return T.Deferred().reject(s.Base.ErrorReasons.CAPABILITY_NOT_INSTALLED).promise()}return T.Deferred().reject(s.Base.ErrorReasons.CAPABILITY_NOT_ALLOWED).promise()},isSharingApplicationWindow:function(){return this._isSharingAnyType()?m:this._sharingState!==s.Services.Collaboration.ContentSharingState.NOT_SHARING&&this._contentSharingType===s.Services.Collaboration.ContentSharingType.APP_WINDOW_SHARING},_isSharingAnyType:function(){return this._sharingState!==s.Services.Collaboration.ContentSharingState.NOT_SHARING&&this._contentSharingType===s.Services.Collaboration.ContentSharingType.ANY_TYPE},end:function(e,t){var i=t._collaboration;if(!i||!!i._selfParticipant&&i._selfParticipant._presenter){if(this._sharingState!==s.Services.Collaboration.ContentSharingState.NOT_SHARING){s.Base.Logger.info(s.Base.LoggerTags.COLLABORATION_SERVICE,"Content Screen Sharing Service: Stop sharing..."),this._sharingState=s.Services.Collaboration.ContentSharingState.NOT_SHARING,this._contentSharingType=s.Services.Collaboration.ContentSharingType.NONE;var a=t._getCollaborations();return a._activeContentSharing=m,a._onActiveContentSharingChangedCallback.fire(),this._isScreenScraperActive=!1,this._screenSharingProvider.stopScreenSharing(e)}s.Base.Logger.info(s.Base.LoggerTags.COLLABORATION_SERVICE,"Content Screen Sharing Service: Stop sharing is not allowed: sharing is inactive");var r=T.Deferred();return r.resolve(),r.promise()}return s.Base.Logger.warn(s.Base.LoggerTags.COLLABORATION_SERVICE,"Content Screen Sharing Service: Stop sharing is not allowed: presenter parameter is false."),T.Deferred().reject(s.Base.ErrorReasons.CAPABILITY_NOT_ALLOWED).promise()},isPresenting:function(){return this._contentSharingType!==s.Services.Collaboration.ContentSharingType.NONE},isContentSharingActive:function(){return this._sharingState!==s.Services.Collaboration.ContentSharingState.NOT_SHARING},isContentSharingPaused:function(){return this._sharingState===s.Services.Collaboration.ContentSharingState.PAUSED},pause:function(){if(this._sharingState===s.Services.Collaboration.ContentSharingState.SHARING)return s.Base.Logger.info(s.Base.LoggerTags.COLLABORATION_SERVICE,"Content Screen Sharing Service: Pause sharing..."),this._sharingState=s.Services.Collaboration.ContentSharingState.PAUSED,this._screenSharingProvider.pause();var e=T.Deferred();return e.resolve(),e.promise()},resume:function(){if(this._sharingState===s.Services.Collaboration.ContentSharingState.PAUSED)return s.Base.Logger.info(s.Base.LoggerTags.COLLABORATION_SERVICE,"Content Screen Sharing Service: Resume sharing..."),this._sharingState=s.Services.Collaboration.ContentSharingState.SHARING,this._screenSharingProvider.resume();var e=T.Deferred();return e.resolve(),e.promise()},getShareApplicationWindowCapability:function(){return this._screenSharingProvider.getShareApplicationWindowCapability()},getReceivingBitrate:function(){return this._collaborationProvider.getReceivingBitrate()},getOutgoingScreenSharingStream:function(){return this._screenSharingProvider.getOutgoingScreenSharingStream()},getShareFullScreenCapability:function(){return this._screenSharingProvider.getShareFullScreenCapability()},getShareAnyTypeCapability:function(){return this._screenSharingProvider.getShareAnyTypeCapability()},isOpened:function(){return this._screenSharingProvider.isOpened()},isFeatureAvailable:function(e){return this._collaborationProvider.isFeatureAvailable(e)},setImageQuality:function(e){this._screenSharingProvider.setImageQuality(e)},setMaxUploadSpeed:function(e){this._screenSharingProvider.setMaxUploadSpeed(e)},_initSharingEventHandler:function(e){this._startScreenSharingEventHandler=this._startScreenSharingHandler(),this._endScreenSharingEventHandler=this._endScreenSharingHandler(),e.addOnContentSharingStartedCallback(this._startScreenSharingEventHandler),e.addOnContentSharingEndedCallback(this._endScreenSharingEventHandler)},_removeSharingEventHandler:function(e){this._startScreenSharingEventHandler&&this._endScreenSharingEventHandler&&(e.removeOnContentSharingStartedCallback(this._startScreenSharingEventHandler),e.removeOnContentSharingEndedCallback(this._endScreenSharingEventHandler))},_startScreenSharingHandler:function(){return function(e){}.bind(this)},_endScreenSharingHandler:function(){return function(e){if(this._contentSharingType=s.Services.Collaboration.ContentSharingType.NONE,this._isScreenScraperActive)return this._isScreenScraperActive=!1,this._screenSharingProvider.stopScreenSharing(!0)}.bind(this)},_pauseScreenSharingHandler:function(t){return function(e){t._onContentSharingPausedCallbacks.fire(e)}},_endActiveScreenSharing:function(e,t){this._sharingState!==s.Services.Collaboration.ContentSharingState.NOT_SHARING&&(e._isPaused=!1,this._sharingState=s.Services.Collaboration.ContentSharingState.NOT_SHARING,this._endScreenSharingHandler(),e._onContentSharingEndedCallbacks.fire(e,t))},_recalculateAllContentSharingCapabilities:function(e){e._recalculateShareApplicationWindowCapability(e._collaboration),e._recalculateShareFullScreenCapability(e._collaboration),e._recalculateShareAnyTypeCapability(e._collaboration)}},s.Services.Collaboration.ContentSharingService=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Collaboration.ContentSharingState={NOT_SHARING:"not sharing",SHARING:"sharing",PAUSED:"paused"}}(),function(e){"use strict";AvayaClientServices.Services.Collaboration.ContentSharingType={NONE:"none",FULL_SCREEN_SHARING:"full screen",APP_WINDOW_SHARING:"application window",ANY_TYPE:"any type"}}(),function(i){"use strict";function e(){this._slides=[],this._onSlidesAddedCallbacks=T.Callbacks(),this._onSlidesRemovedCallbacks=T.Callbacks()}e.prototype={getSlides:function(){var t=[];return this._slides.forEach(function(e){t.push(new i.Services.Collaboration.SliderSlide(e.getNumber(),e.getSlideURL(),e.getThumbnailURL(),e.getCreateTime()))}),t},_addSlides:function(e){this._slides.push(new i.Services.Collaboration.SliderSlide(e.getNumber(),e.getSlideURL(),e.getThumbnailURL(),e.getCreateTime()))},_removeSlides:function(){this._slides=[]}},i.Services.Collaboration.Slider=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Collaboration.Slider.prototype,{addOnSlidesAddedCallback:function(e){this._onSlidesAddedCallbacks.add(e)},removeOnSlidesAddedCallback:function(e){this._onSlidesAddedCallbacks.remove(e)},addOnSlidesRemovedCallback:function(e){this._onSlidesRemovedCallbacks.add(e)},removeOnSlidesRemovedCallback:function(e){this._onSlidesRemovedCallbacks.remove(e)}})}(AvayaClientServices),function(e){"use strict";function t(e,t,i,a){this._number=e,this._slideURL=t,this._thumbnailURL=i,this._createTime=a}t.prototype={getSlideURL:function(){return this._slideURL},getThumbnailURL:function(){return this._thumbnailURL},getNumber:function(){return this._number},getCreateTime:function(){return this._createTime}},e.Services.Collaboration.SliderSlide=t}(AvayaClientServices),function(o){"use strict";function e(e,t){this._collaborationProvider=e,this._checkOnNewPoints=m,this._throttlingInterval=100,this._collaborationsAnalyticsService=t}e.prototype={start:function(e,t){var i=T.Deferred();if(e._collaboration.getWhiteboardCapability().isAllowed){var a=function(){this._collaborationsAnalyticsService.sendStartupEvent(!0)}.bind(this),r=function(){this._collaborationsAnalyticsService.sendStartupEvent(!1)}.bind(this);if(o.Base.Utils.isDefined(t))return t.isActive()?(i.reject(new o.Services.Collaboration.CollaborationError(o.Services.Collaboration.CollaborationErrorReason.WHITEBOARD_ALREADY_ACTIVE)),i.promise()):(e.getSurfaces().forEach(function(e){e._active=!1}),this._collaborationProvider.startWhiteboard(t.getSurfaceId()).then(a,r));var s=e.getSurfaces();if(0===s.length)return this._collaborationProvider.startWhiteboard().then(a,r);var n=s.filter(function(e){return e.isActive()})[0];return n?this._collaborationProvider.startWhiteboard(n.getSurfaceId()).then(a,r):this._collaborationProvider.startWhiteboard(s[0].getSurfaceId()).then(a,r)}return i.reject(new o.Base.BaseError(o.Base.ErrorReasons.CAPABILITY_NOT_ALLOWED)),i},end:function(e){var t=T.Deferred();if(e.getActiveSurface()){if(e._collaboration.getWhiteboardCapability().isAllowed)return this._collaborationProvider.endWhiteboard(e);t.reject(new o.Base.BaseError(o.Base.ErrorReasons.CAPABILITY_NOT_ALLOWED))}else t.reject(new o.Services.Collaboration.CollaborationError(o.Services.Collaboration.CollaborationErrorReason.WHITEBOARD_INACTIVE));return t},stop:function(e){var t=T.Deferred();return e._currentLiveDrawingWhiteboardIds=[],e._currentLiveDrawingShapes=[],e._activeSurface=m,e._recentlyActiveSurface=m,e._surfaces.length=0,e._onWhiteboardStartedCallbacks.empty(),e._onWhiteboardEndedCallbacks.empty(),e._onWhiteboardSurfaceAddedCallbacks.empty(),e._onWhiteboardSurfaceRemovedCallbacks.empty(),e._onWhiteboardSurfaceSetActiveCallbacks.empty(),e._removeWhiteboardCapability=new o.Base.Capability(o.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),t.resolve(),t.promise()},requestNewSurface:function(e){var t=T.Deferred();return e.getActiveSurface()?e.getAddWhiteboardCapability().isAllowed?this._collaborationProvider.addWhiteboardSurface().then(function(e){t.resolve(e)},function(e){t.reject(new o.Services.Collaboration.CollaborationError(o.Services.Collaboration.CollaborationErrorReason.WHITEBOARD_REMOVE_SURFACE_FAILED,e))}):t.reject(new o.Base.BaseError(o.Base.ErrorReasons.CAPABILITY_NOT_ALLOWED)):t.reject(new o.Services.Collaboration.CollaborationError(o.Services.Collaboration.CollaborationErrorReason.WHITEBOARD_INACTIVE)),t.promise()},removeSurface:function(e,t){var i=T.Deferred();return e.getActiveSurface()?1<e.getSurfaces().length?e.getRemoveWhiteboardCapability().isAllowed?this._collaborationProvider.removeWhiteboardSurface(t.getSurfaceId()).then(function(e){i.resolve(e)},function(e){i.reject(new o.Services.Collaboration.CollaborationError(o.Services.Collaboration.CollaborationErrorReason.WHITEBOARD_REMOVE_SURFACE_FAILED,e))}):i.reject(new o.Base.BaseError(o.Base.ErrorReasons.CAPABILITY_NOT_ALLOWED)):i.reject(new o.Services.Collaboration.CollaborationError(o.Services.Collaboration.CollaborationErrorReason.WHITEBOARD_REMOVE_LAST_SURFACE)):i.reject(new o.Services.Collaboration.CollaborationError(o.Services.Collaboration.CollaborationErrorReason.WHITEBOARD_INACTIVE)),i.promise()},addCircle:function(i,a){return this._collaborationProvider.addCircle(a,i.getSurfaceId()).done(function(e){var t=a.getId();return a.setId(e),delete i.getShapes()[t],i.getShapes()[e]=a,e})},addShape:function(i,a){return a.isFinished()?this._collaborationProvider.addShape(a,i.getSurfaceId()).done(function(e){var t=a.getId();return a.setId(e),delete i.getShapes()[t],i.getShapes()[e]=a,e}):(a._readyToSendCallbacks.add(this._throttleLiveDrawing.bind(this,a,i)),this._collaborationProvider.startDrawShape(a,i.getSurfaceId()).done(function(e){var t=a.getId();return a.setId(e),delete i.getShapes()[t],i.getShapes()[e]=a,e}))},addText:function(i,a){return this._collaborationProvider.addText(a,i.getSurfaceId()).done(function(e){var t=a.getId();return a.setId(e),delete i.getShapes()[t],i.getShapes()[e]=a,e})},moveSelection:function(e,t){return t instanceof o.Services.Collaboration.Shape?this._collaborationProvider.moveSelection(t,e.getSurfaceId(),t.getPoints()[0].point):t instanceof o.Services.Collaboration.Circle?this._collaborationProvider.moveSelection(t,e.getSurfaceId(),t.getTopLeft()):t instanceof o.Services.Collaboration.WhiteboardText?this._collaborationProvider.moveSelection(t,e.getSurfaceId(),t.getPosition()):this._collaborationProvider.moveSelection(t,e.getSurfaceId())},removeShape:function(e,t){var i;if(t.isMine())return t instanceof o.Services.Collaboration.Shape?i=t.getPoints()[0].point:t instanceof o.Services.Collaboration.Circle?i=t.getTopLeft():t instanceof o.Services.Collaboration.WhiteboardText&&(i=t.getPosition()),this._collaborationProvider.removeShape(t,e.getSurfaceId(),i);var a=T.Deferred();return a.reject(new o.Services.Collaboration.CollaborationError(o.Services.Collaboration.CollaborationErrorReason.WHITEBOARD_REMOVE_SHAPE_NOT_MINE)),a.promise()},clearContent:function(e){return this._collaborationProvider.clearContent(e.getSurfaceId())},endDrawShape:function(e,t){return t._hasPointsToSend()&&this._collaborationProvider.liveDrawShape(t,e.getSurfaceId()),this._collaborationProvider.endDrawShape(t,e.getSurfaceId())},_throttleLiveDrawing:function(e,t){if(e._hasPointsToSend())return this._collaborationProvider.liveDrawShape(e,t.getSurfaceId())}},o.Services.Collaboration.WhiteboardService=e}(AvayaClientServices),function(){"use strict";AvayaClientServices.Services.Collaboration.WhiteboardTools=function(){this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.SELECTION]={name:"Selection",type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.SELECTION},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.PEN]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.PEN,name:"Pen",drag:!1,live:!0},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.MARKER]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.MARKER,name:"Marker",drag:!1,live:!0},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.LINE]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.LINE,name:"Line",drag:!0,live:!1,modes:AvayaClientServices.Services.Collaboration.WhiteboardLineWidths,startFunction:function(){},endFunction:function(){}},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.RECTANGLE]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.RECTANGLE,name:"Rect",drag:!0,live:!1,modes:AvayaClientServices.Services.Collaboration.WhiteboardToolModes,startFunction:function(){},endFunction:function(){}},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.CIRCLE]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.CIRCLE,name:"Circle",drag:!0,live:!1,modes:AvayaClientServices.Services.Collaboration.WhiteboardToolModes,startFunction:function(){},endFunction:function(){}},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.STAMP]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.STAMP,name:"Stamp",drag:!1,live:!1,drawFunction:function(){}},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.TEXT]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.TEXT,name:"Text",drag:!1,live:!1,modes:AvayaClientServices.Services.Collaboration.WhiteboardTextSizes},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.DELETE]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.DELETE,name:"Delete"},this[AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.CLEAR]={type:AvayaClientServices.Services.Collaboration.WhiteboardToolTypes.CLEAR,name:"Clear All"}}}(),function(a){"use strict";function r(e,t,i,a){this._messageContent=e,this._sender=t,this._recipient=i,this._isPrivate=a,this._time=new Date,r._idCounter===Number.MAX_SAFE_INTEGER&&(r._idCounter=1e5),this._id=""+ ++r._idCounter,this.status=m}Number.MAX_SAFE_INTEGER||(Number.MAX_SAFE_INTEGER=Math.pow(2,53)-1),r._idCounter=1e5,r.prototype={setStatus:function(e){var t=!1;for(var i in a.Services.Conference.ChatMessageStatus)if(a.Services.Conference.ChatMessageStatus.hasOwnProperty(i)&&e===a.Services.Conference.ChatMessageStatus[i]){a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.status=e,t=!0;break}return t},getSender:function(){return this._sender},getMessageContent:function(){return this._messageContent},isPrivate:function(){return this._isPrivate},getRecipient:function(){return this._recipient},getTime:function(){return this._time},getId:function(){return this._id}},a.Services.Conference.ChatMessage=r}(AvayaClientServices),function(c){"use strict";function e(e){this._conferenceProvider=e,this._enableSendingMessages=!0}e.prototype={sendMessage:function(e,t,i){if(this._enableSendingMessages){var a=i?i._participantId:m,r=!!i,s=new c.Services.Conference.ChatMessage(t,e._selfParticipant,i,r);return s.setStatus(c.Services.Conference.ChatMessageStatus.PENDING),this.addMessage(e,s),this._conferenceProvider.sendChatMessage(t,a).then(function(){s.setStatus(c.Services.Conference.ChatMessageStatus.CONFIRMED)}.bind(this),function(e){return s.setStatus(c.Services.Conference.ChatMessageStatus.ERROR),T.Deferred().reject(e).promise()}.bind(this))}var n="Sending messages is disabled while conference is in WAITING_ROOM state";c.Base.Logger.error(c.Base.LoggerTags.CHAT_SERVICE,n);var o=new c.Services.Conference.ConferenceException(c.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,n);return T.Deferred().reject(o).promise()},addMessage:function(e,t){t.isPrivate()?e._privateMessages.push(t):e._publicMessages.push(t),e._allMessages.push(t),e._onChatMessageReceivedCallbacks.fire(e,t)},_setEnableSendingMessages:function(e){this._enableSendingMessages=e}},c.Services.Conference.ChatService=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Conference.ConferenceException=function(e,t){this.name=e,this.message=t}}(),function(s){"use strict";function e(e,t,i){this._conferenceType=e,this._conferenceProvider=t,this._contactsIntegrationService=i,this._onContactListChanged=m,this._isDisconnecting=!1}e.prototype={start:function(t,e){if(s.Base.Utils.isDefined(this._conferenceProvider))return s.Base.Logger.info(s.Base.LoggerTags.CONFERENCE_SERVICE,"Conference Service is starting..."),t._isStarting=!0,this._conferenceProvider.start(t,e).then(function(){this._conferenceProvider.on(s.Base.NetworkProviderEvents.UNAUTHORIZED,function(){(s.Base.Utils.isUndefined(t._isAvailable)||t._isAvailable)&&(t._isAvailable=!1,t._onConferenceServiceUnavailableCallbacks.fire(t))}.bind(this)),this._conferenceProvider.on(s.Base.NetworkProviderEvents.AUTHORIZED,function(){!s.Base.Utils.isUndefined(t._isAvailable)&&t._isAvailable||(t._isAvailable=!0,t._onConferenceServiceAvailableCallbacks.fire(t))}.bind(this)),this._onContactListChanged=function(){this._updateMatchedContactsForConference(t)}.bind(this),this._contactsIntegrationService.addOnContactListChangedCallback(this._onContactListChanged),!s.Base.Utils.isUndefined(t._isAvailable)&&t._isAvailable||(t._isAvailable=!0,t._onConferenceServiceAvailableCallbacks.fire(t)),t._setConferenceStarted(!0),t._recalculateAllAddParticipantFromCallCapability(),t.addOnConferenceRecordingStatusChangedCallback(this._recalculateConferenceRecordingStatuses)}.bind(this),function(e){return t._isStarting=!1,t._setConferenceStarted(!1),T.Deferred().reject(e).promise()});var i=T.Deferred();return s.Base.Logger.info(s.Base.LoggerTags.CONFERENCE_SERVICE,"Conference Service is not enabled"),i.reject({name:s.Services.Conference.ConferenceStartStatus.CONFERENCE_SERVICE_NOT_ENABLED,message:"Conference Service is not enabled"}),i.promise()},stop:function(t){return t._isAvailable&&(t._isAvailable=!1,t._onConferenceServiceUnavailableCallbacks.fire(t)),t._isStarting=!1,t._setConferenceStarted(!1),s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.stop().then(function(e){return this._contactsIntegrationService.removeOnContactListChangedCallback(this._onContactListChanged),this._onContactListChanged=m,t.removeOnConferenceRecordingStatusChangedCallback(this._recalculateConferenceRecordingStatuses),t._selfParticipantId="",t._activeTalkerId="",t._lecturerId="",t._presenterId="",t._conferenceOwnerAddress="",t._mediaStatus="",t._activeParticipants=[],t._droppedParticipants=[],t._pendingParticipants=[],t._isLectureModeActive=!1,t._isHandRaised=!1,t._recordingStatus=s.Services.Conference.RecordingStatus.OFF,t._isVideoAllowed=!1,t._isWebCollaborationActive=!1,t._isLocked=!1,t._isPasscodeRequiredToBecomeModerator=!1,t._isVideoParticipantNameDisplayActive=!1,t._isVideoPersonalLayoutActive=m,t._isVideoSelfSeeActive=!1,t._isVideoSelfSeeChangeAllowed=!1,t._isVideoPinAllowed=!1,t._isVideoParticipantNameDisplayChangeAllowed=!1,t._currentVideoLayout="",t._supportedVideoLayouts=[],t._subject="",t._sipURI="",t._isApplicationSharingActive=!1,t._brandName="",t._collaborationURI="",t._joinMeetingURI="",t._streamingURI="",t._dialInInformation="",t._dialInInformationHtml="",t._admissionPermissionNeeded=!1,t._admissionPasscodeNeeded=!1,e}.bind(this)):T.Deferred().reject().promise()},stopImmediately:function(e){return e._isAvailable&&(e._isAvailable=!1,e._onConferenceServiceUnavailableCallbacks.fire(e)),e._isStarting=!1,e._setConferenceStarted(!1),T.Deferred().resolve().promise()},terminateConference:function(e){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.terminateConference():T.Deferred().reject().promise()},getType:function(){return this._conferenceType},removeLastParticipant:function(){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.removeLastParticipant():T.Deferred().reject().promise()},sendAdmissionRequest:function(e,t){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.sendAdmissionRequest(e,t):T.Deferred().reject().promise()},requestToBecomeModerator:function(e,t){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.requestToBecomeModerator(t):T.Deferred().reject().promise()},signIn:function(e,t){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.signIn(t):T.Deferred().reject().promise()},videoPin:function(e,t,i,a,r){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.videoPin(e,t,i,a,r):T.Deferred().reject().promise()},extendMeeting:function(e){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.extendMeeting(e):T.Deferred().reject().promise()},addParticipant:function(e,t){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.addParticipant(e,t):T.Deferred().reject().promise()},addParticipantFromCall:function(e){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.addParticipantFromCall(e):T.Deferred().reject().promise()},cancelDialoutParticipant:function(e,t){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.cancelDialoutParticipant(e,t._participantId):T.Deferred().reject().promise()},setAsLecturer:function(e){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.setAsLecturer(e._participantId):T.Deferred().reject().promise()},setLocked:function(e,t){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.setLocked(t):T.Deferred().reject().promise()},startRecording:function(e,t,i){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.startRecording(e,t,i):T.Deferred().reject().promise()},stopRecording:function(e){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.stopRecording(e):T.Deferred().reject().promise()},pauseRecording:function(e){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.pauseRecording(e):T.Deferred().reject().promise()},resumeRecording:function(e){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.resumeRecording(e):T.Deferred().reject().promise()},setVideoLayout:function(e,t){if(!s.Base.Utils.isDefined(this._conferenceProvider))return T.Deferred().reject().promise();var i=e.getUpdateVideoLayoutCapability();if(!1!==i.isAllowed)return this._conferenceProvider.setVideoLayout(t);var a=i.denialReason;return T.Deferred().reject(a).promise()},setVideoLayoutSelfSee:function(e,t){if(!s.Base.Utils.isDefined(this._conferenceProvider))return T.Deferred().reject().promise();var i=e.getUpdateVideoSelfSeeCapability();if(!1!==i.isAllowed)return this._conferenceProvider.setVideoLayoutSelfSee(t);var a=i.denialReason;return T.Deferred().reject(a).promise()},setVideoLayoutTextOverlay:function(e,t){if(!s.Base.Utils.isDefined(this._conferenceProvider))return T.Deferred().reject().promise();var i=e.getUpdateDisplayVideoParticipantNameCapability();if(!1!==i.isAllowed)return this._conferenceProvider.setVideoLayoutTextOverlay(t);var a=i.denialReason;return T.Deferred().reject(a).promise()},getCurrentVideoLayout:function(e){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.getCurrentVideoLayout():T.Deferred().reject().promise()},muteAllParticipants:function(e){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.muteUnmuteAll(!0):T.Deferred().reject().promise()},unmuteAllParticipants:function(e){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.muteUnmuteAll(!1):T.Deferred().reject().promise()},raiseLowerHand:function(e){return s.Base.Utils.isDefined(this._conferenceProvider)?e?this._conferenceProvider.raiseLowerHand(s.Services.Conference.ParticipantHandState.RAISE):this._conferenceProvider.raiseLowerHand(s.Services.Conference.ParticipantHandState.LOWER):T.Deferred().reject().promise()},disconnectParticipant:function(e){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.disconnectParticipant(e):T.Deferred().reject().promise()},sendDisconnectEvent:function(){return s.Base.Utils.isDefined(this._conferenceProvider)?this._isDisconnecting?T.Deferred().resolve():(this._isDisconnecting=!0,s.Base.Logger.info(s.Base.LoggerTags.CONFERENCE_SERVICE,"Conference sent disconnect event"),this._conferenceProvider.sendDisconnectEvent(s.Services.Conference.DisconnectReason.CALL_DISCONNECTED)):T.Deferred().reject().promise()},sendLocalMuteEvent:function(e,t){return s.Base.Utils.isDefined(this._conferenceProvider)?this._conferenceProvider.sendLocalMuteEvent(e,t):T.Deferred().reject().promise()},_recalculateAllCapabilities:function(e){e._recalculateSetLockCapability(),e._recalculateDisplayVideoParticipantNameCapability(),e._recalculateVideoSelfSeeCapability(),e._recalculateSetVideoLayoutCapability(),e._recalculateStartStopRecordingCapability(),e._recalculatePauseResumeRecordingCapability(),e._recalculateMuteUnmuteAllCapability(),e._recalculateRaiseHandSupportCapability(),e._recalculateLowerHandSupportCapability(),e._recalculateRequestToBecomeModeratorCapability(),e._recalculateVideoPinCapability(),e._recalculateRemoveSelectParticipantCapability(),e._recalculateAddParticipantViaDialoutCapability(),e._recalculateSignInCapability(),e._recalculateModerateConferenceCapability(),e._recalculateActiveTalkerCapability(),e._recalculateMuteSelfAudioCapability(),e._recalculateUnmuteSelfAudioCapability(),e._recalculateSendFeccCapability(),e._recalculateTerminateConferenceCapability(),e._recalculateAcceptPendingParticipantCapability(),e._recalculateDenyPendingParticipantCapability(),e._recalculateExtendMeetingCapability(),e._recalculateRetrieveParticipantListCapability(),e._recalculateInConferenceChatCapability()},_updateMatchedContactsForParticipant:function(e){this._contactsIntegrationService.updateMatchedContactsForParticipant(e,!0)},_updateMatchedContactsForConference:function(e){if(this._contactsIntegrationService.isStarted()&&e){var t=[];e.getActiveParticipants().forEach(function(e){t.push(e)}),e.getPendingParticipants().forEach(function(e){t.push(e)}),e.getDroppedParticipants().forEach(function(e){t.push(e)}),t.forEach(function(e){this._updateMatchedContactsForParticipant(e)},this)}},_recalculateAddParticipantFromCallCapability:function(e,t){this._conferenceProvider&&this._conferenceProvider.recalculateAddParticipantFromCallCapability(e,t)},_recalculateAddParticipantFromCallCapabilityByCallId:function(e,t){this._conferenceProvider&&this._conferenceProvider.recalculateAddParticipantFromCallCapabilityByCallId(e,t)},_recalculateConferenceRecordingStatuses:function(e){e._recalculateStartStopRecordingCapability(),e._recalculatePauseResumeRecordingCapability()}},s.Services.Conference.ConferenceService=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Conference.ConferenceType={CM_CONFERENCE:"CM",SCOPIA_CONFERENCE:"Scopia"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.AdmissionResponseCode={SUCCESS:"success",INCORRECT_PASSCODE_TRY_AGAIN:"incorrectPasscodeTryAgain",INCORRECT_PASSCODE_DISCONNECTING:"incorrectPasscodeDisconnecting",PENDING_APPROVAL:"pendingApproval",REJECTED:"rejected"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.AllowVideoDirection={SEND_RECEIVE:"biDirectional",RECEIVE_ONLY:"serverToClient",SEND_ONLY:"clientToServer",INACTIVE:"none"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.CameraControl={CAMERA_CONTROL_UP:"up",CAMERA_CONTROL_DOWN:"down",CAMERA_CONTROL_RIGHT:"right",CAMERA_CONTROL_LEFT:"left",CAMERA_CONTROL_ZOOM_IN:"in",CAMERA_CONTROL_ZOOM_OUT:"out"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.ChatMessageStatus={PENDING:"pending",CONFIRMED:"confirmed",ERROR:"error"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.ChatType={PRIVATE:"private",PUBLIC:"public"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.ConferenceError={CAPABILITY_NOT_ALLOWED:"CAPABILITY_NOT_ALLOWED",INVALID_ARGUMENT:"INVALID_ARGUMENT",NETWORK_UNAVAILABLE:"NETWORK_UNAVAILABLE",CONFERENCE_CONNECTION_FAILED_TO_RECOVER:"CONFERENCE_CONNECTION_FAILED_TO_RECOVER"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.ConferenceStartStatus={ADMISSION_NEEDED:"admissionNeeded",CONFERENCE_SERVICE_NOT_ENABLED:"conferenceServiceNotEnabled",CONFERENCE_CONFIG_NOT_ENABLED:"conferenceConfigIsNotEnabled",HANDSHAKE_REJECTED:"handshakeRejected"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.ContentFromParticipantStatus={ACTIVE:"active",ALLOWED:"allowed",NOT_ALLOWED:"notAllowed"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.DialoutStatus={DIALING:"dialing",UNAUTHORIZED:"unauthorized",FAIL:"fail",NOT_ADMITTED:"notAdmitted",NOT_ALLOWED:"notAllowed",CONNECT:"connect",BUSY:"busy",NO_ANSWER:"noAnswer",CANCELED:"canceled"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.DisconnectReason={CALL_DISCONNECTED:"callDisconnected",CONFERENCE_TERMINATED:"conferenceTerminated",DISCONNECTED_BY_MODERATOR_OR_ADMIN:"disconnectedByModeratorOrAdmin",ERROR:"error"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.MediaFromParticipantStatus={ACTIVE:"active",NA:"na",SELF_MUTED:"selfMuted",MODERATOR_MUTED:"moderatorMuted",BOTH_MUTED:"bothMuted"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.MediaStatus={WAITING_ROOM:"waitingRoom",ACTIVE:"active",MUTE_ALL_AUDIO:"muteAllAudio"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.MediaToParticipantStatus={AVAILABLE:"available",NA:"na"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.MediaType={AUDIO:"audio",VIDEO:"video"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.MeetingEncryptionStatus={YES:"yes",NO:"no",PARTIAL:"partial"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.ModeratorAdmissionActions={ADMIT:"admit",REJECT:"reject"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.ParticipantAuthorizationStatus={ACTIVE:"active",AUTHORIZING:"authorizing"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.ParticipantConnectionStatus={CONNECTION_STATUS_UNKNOWN:"CONNECTION_STATUS_UNKNOWN",CONNECTION_STATUS_CONNECTING:"CONNECTION_STATUS_CONNECTING",CONNECTION_STATUS_CONNECTED:"CONNECTION_STATUS_CONNECTED",CONNECTION_STATUS_DISCONNECTING:"CONNECTION_STATUS_DISCONNECTING",CONNECTION_STATUS_DISCONNECTED:"CONNECTION_STATUS_DISCONNECTED"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.ParticipantDisconnectionReason={DISCONNECT_REASON_UNKNOWN:"DISCONNECT_REASON_UNKNOWN",DISCONNECT_REASON_DEPARTED:"DISCONNECT_REASON_DEPARTED",DISCONNECT_REASON_DISCONNECTED_BY_MODERATOR:"DISCONNECT_REASON_DISCONNECTED_BY_MODERATOR"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.ParticipantHandState={RAISE:"raise",LOWER:"lower"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.ParticipantMediaState={MEDIA_STATUS_NO_MEDIA:"MEDIA_STATUS_NO_MEDIA",MEDIA_STATUS_INACTIVE:"MEDIA_STATUS_INACTIVE",MEDIA_STATUS_RECEIVE_ONLY:"MEDIA_STATUS_RECEIVE_ONLY",MEDIA_STATUS_SEND_ONLY:"MEDIA_STATUS_SEND_ONLY",MEDIA_STATUS_SEND_RECEIVE:"MEDIA_STATUS_SEND_RECEIVE"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.ParticipantRole={MODERATOR:"moderator",PARTICIPANT:"participant",GUEST:"guest",OPERATOR:"operator",RESTRICTED_PARTICIPANT:"restrictedParticipant"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.PermissionStatus={ALLOWED:"allowed",NOT_ALLOWED:"notAllowed",NEED_SIGNIN:"needSignin",NEED_MODERATOR:"needModerator",NEED_SIGNIN_OR_MODERATOR:"needSigninOrModerator"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.RecorderStatus={NONE:"none",START_STOP:"start/stop",WITH_PAUSE:"withPause"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.RecordingOperation={START:"start",STOP:"stop",PAUSE:"pause",RESUME:"resume"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.RecordingStatus={ON:"on",OFF:"off",PAUSE:"pause"}}(),function(e){"use strict";AvayaClientServices.Services.Conference.VideoLayout={LAYOUT_AUTOMATIC:"1",LAYOUT_SINGLE_SCREEN:"10",LAYOUT_DOUBLE_SCREEN_HORIZONTAL:"21",LAYOUT_DOUBLE_SCREEN_VERTICAL:"22",LAYOUT_DOUBLE_SCREEN_4_TO_1:"27",LAYOUT_1_HOST_1_PIP:"28",LAYOUT_PYRAMID_3:"32",LAYOUT_LANDSCAPE_PLUS_2_ASYM:"33",LAYOUT_1_HOST_2_PIP:"34",LAYOUT_3x1:"35",LAYOUT_2x2:"40",LAYOUT_4_PYRAMID:"41",LAYOUT_3_PLUS_1:"42",LAYOUT_1_HOST_3_PIP:"43",LAYOUT_5_PYRAMID:"51",LAYOUT_1_HOST_4_PIP:"52",LAYOUT_5_PLUS_1:"60",LAYOUT_3x2:"61",LAYOUT_6_PLUS_1_1:"75",LAYOUT_7_PLUS_1_NEW:"81",LAYOUT_4x2:"82",LAYOUT_3x3:"90",LAYOUT_9_PYRAMID:"91",LAYOUT_8_PLUS_2_1_2:"101",LAYOUT_4x3:"120",LAYOUT_12_PLUS_1_1:"131",LAYOUT_12_PLUS_1_5:"135",LAYOUT_4x4:"160",LAYOUT_20_PLUS_1:"210",LAYOUT_20_PLUS_1_LEFT:"211",LAYOUT_1_PLUS_27:"280"}}(),function(t){"use strict";function e(e){this._conferenceProvider=e}e.prototype={setAsLecturer:function(e){return this._conferenceProvider.setAsLecturer(e.getParticipantId())},unsetAsLecturer:function(){return this._conferenceProvider.unsetAsLecturer()},controlRemoteCamera:function(e,t){return this._conferenceProvider.controlRemoteCamera(e.getParticipantId(),t)},mute:function(e){return this._conferenceProvider.muteUnmute(e.getParticipantId(),t.Services.Conference.MediaType.AUDIO,!0)},unmute:function(e){return this._conferenceProvider.muteUnmute(e.getParticipantId(),t.Services.Conference.MediaType.AUDIO,!1)},accept:function(e){return this._conferenceProvider.moderatorAdmission(e,t.Services.Conference.ModeratorAdmissionActions.ADMIT)},deny:function(e){return this._conferenceProvider.moderatorAdmission(e,t.Services.Conference.ModeratorAdmissionActions.REJECT)},blockVideo:function(e){return this._conferenceProvider.muteUnmute(e.getParticipantId(),t.Services.Conference.MediaType.VIDEO,!0)},unblockVideo:function(e){return this._conferenceProvider.muteUnmute(e.getParticipantId(),t.Services.Conference.MediaType.VIDEO,!1)},lowerHand:function(e,t){return this._conferenceProvider.moderatorLowerHand(e.getParticipantId(),t)},recalculateAllCapabilities:function(e){e._recalculateBlockUnblockVideoCapability(),e._recalculateMuteUnmuteCapability(),e._recalculateLowerHandCapability(),e._recalculateSetAsLecturerCapability(),e._recalculateRemoteCameraControlCapability()}},t.Services.Conference.ParticipantService=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Conference.RecentTalkersConfiguration={SIZE:4}}(),function(e){"use strict";function t(){this._writeCapability=new e.Base.Capability(e.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED)}t.prototype={getWriteCapability:function(){return this._writeCapability},_setWriteCapability:function(e){this._writeCapability=e}},e.Services.Contacts.ContactField=t}(AvayaClientServices),function(e){"use strict";function t(){e.Services.Contacts.ContactField.call(this),this._values=[]}(t.prototype=Object.create(e.Services.Contacts.ContactField.prototype)).getValues=function(){return this._values},t.prototype.isEmpty=function(){return!this._values||0===this._values.length},t.prototype.getSize=function(){return this._values?this._values.length:0},e.Services.Contacts.ContactFieldList=t}(AvayaClientServices),function(e){"use strict";function t(){e.Services.Contacts.ContactField.call(this),this._address=m,this._imAddressType=e.Services.Contacts.ContactIMAddressType.IM_ADDRESS_OTHER,this._default=!1,this._avayaAdministered=!1}(t.prototype=Object.create(e.Services.Contacts.ContactField.prototype)).getAddress=function(){return this._address},t.prototype.getIMAddressType=function(){return this._imAddressType},t.prototype.isDefault=function(){return this._default},t.prototype.setAvayaAdministered=function(e){this._avayaAdministered=e},t.prototype.isAvayaAdministered=function(){return this._avayaAdministered},e.Services.Contacts.ContactIMAddressField=t}(AvayaClientServices),function(e){"use strict";function t(){e.Services.Contacts.ContactField.call(this),this._value=0}(t.prototype=Object.create(e.Services.Contacts.ContactField.prototype)).getValue=function(){return this._value},e.Services.Contacts.ContactNumberField=t}(AvayaClientServices),function(e){"use strict";function t(){e.Services.Contacts.ContactField.call(this),this._phoneNumber=m,this._label1=m,this._label2=m,this._phoneNumberType=e.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_WORK,this._speedDialEnabled=!1,this._default=!1,this._avayaAdministered=!1}(t.prototype=Object.create(e.Services.Contacts.ContactField.prototype)).getPhoneNumber=function(){return this._phoneNumber},t.prototype.getLabel1=function(){return this._label1},t.prototype.getLabel2=function(){return this._label2},t.prototype.getPhoneNumberType=function(){return this._phoneNumberType},t.prototype.isSpeedDialEnabled=function(){return this._speedDialEnabled},t.prototype.isDefault=function(){return this._default},t.prototype.setAvayaAdministered=function(e){this._avayaAdministered=e},t.prototype.isAvayaAdministered=function(){return this._avayaAdministered},e.Services.Contacts.ContactPhoneField=t}(AvayaClientServices),function(e){"use strict";function t(){e.Services.Contacts.ContactField.call(this),this._value=m}(t.prototype=Object.create(e.Services.Contacts.ContactField.prototype)).getValue=function(){return this._value},e.Services.Contacts.ContactStringField=t}(AvayaClientServices),function(a){"use strict";function e(){a.Services.Contacts.ContactIMAddressField.call(this)}(e.prototype=Object.create(a.Services.Contacts.ContactIMAddressField.prototype)).setAddress=function(e){this._address=e},e.prototype.setIMAddressType=function(e){var t=!1;for(var i in a.Services.Contacts.ContactIMAddressType)if(a.Services.Contacts.ContactIMAddressType.hasOwnProperty(i)&&e===a.Services.Contacts.ContactIMAddressType[i]){this._imAddressType=e,this._default=this._imAddressType===a.Services.Contacts.ContactIMAddressType.IM_ADDRESS_WORK,t=!0;break}return t},a.Services.Contacts.EditableContactIMAddressField=e}(AvayaClientServices),function(e){"use strict";function t(){e.Services.Contacts.ContactNumberField.call(this)}(t.prototype=Object.create(e.Services.Contacts.ContactNumberField.prototype)).setValue=function(e){this._value=e},e.Services.Contacts.EditableContactNumberField=t}(AvayaClientServices),function(a){"use strict";function e(){a.Services.Contacts.ContactPhoneField.call(this)}(e.prototype=Object.create(a.Services.Contacts.ContactPhoneField.prototype)).setPhoneNumber=function(e){this._phoneNumber=e},e.prototype.setLabel1=function(e){this._label1=e},e.prototype.setLabel2=function(e){this._label2=e},e.prototype.setPhoneNumberType=function(e){var t=!1;for(var i in a.Services.Contacts.ContactPhoneNumberType)if(a.Services.Contacts.ContactPhoneNumberType.hasOwnProperty(i)&&e===a.Services.Contacts.ContactPhoneNumberType[i]){this._phoneNumberType=e,t=!0;break}return t},e.prototype.setSpeedDialEnabled=function(e){this._speedDialEnabled=e},e.prototype.setDefault=function(e){this._default=e},a.Services.Contacts.EditableContactPhoneField=e}(AvayaClientServices),function(e){"use strict";function t(){e.Services.Contacts.ContactStringField.call(this)}(t.prototype=Object.create(e.Services.Contacts.ContactStringField.prototype)).setValue=function(e){this._value=e},e.Services.Contacts.EditableContactStringField=t}(AvayaClientServices),function(R){"use strict";function e(){this._cacheKeys=[R.Services.Contacts.ContactCacheKeys.FIRST_NAME,R.Services.Contacts.ContactCacheKeys.LAST_NAME,R.Services.Contacts.ContactCacheKeys.DISPLAY_NAME,R.Services.Contacts.ContactCacheKeys.ALIAS,R.Services.Contacts.ContactCacheKeys.EMAIL_ADDRESS,R.Services.Contacts.ContactCacheKeys.HANDLE,R.Services.Contacts.ContactCacheKeys.LOGIN_ID,R.Services.Contacts.ContactCacheKeys.PHONE_NUMBER,R.Services.Contacts.ContactCacheKeys.CITY,R.Services.Contacts.ContactCacheKeys.DEPARTMENT,R.Services.Contacts.ContactCacheKeys.ADDRESS_FOR_MATCHING,R.Services.Contacts.ContactCacheKeys.TERMINAL_NAME],this._imdb=new R.Base.SimpleIMDB(this._cacheKeys)}e.prototype={addContact:function(e){var t=this._buildKeys(e);try{this._imdb.addElement(t,e)}catch(e){R.Base.Logger.warn(R.Base.LoggerTags.CONTACTS_SERVICE,"Failed to add contact to cache ("+e.message+")")}},updateContact:function(e){var t=this._buildKeysWithMatchingAddressOnly(e),i=this._buildKeys(e);try{this._imdb.updateElement(t,i,e)}catch(e){R.Base.Logger.warn(R.Base.LoggerTags.CONTACTS_SERVICE,"Failed to update contact in cache ("+e.message+")")}},deleteContact:function(e){var t=this._buildKeysWithMatchingAddressOnly(e);try{this._imdb.deleteElements(t)}catch(e){R.Base.Logger.warn(R.Base.LoggerTags.CONTACTS_SERVICE,"Failed to delete contact from cache ("+e.message+")")}},searchContacts:function(e,t,i){var a=e.trim();if(t===R.Services.Contacts.SearchFieldType.NAME)return this.searchByName(a,i);if(t===R.Services.Contacts.SearchFieldType.HANDLE)return this.searchByHandle(a,i);if(t===R.Services.Contacts.SearchFieldType.LOGIN_ID)return this.searchByLoginId(a,i);if(t===R.Services.Contacts.SearchFieldType.TERMINAL)return this.searchByTerminal(a,i);if(t===R.Services.Contacts.SearchFieldType.ALL)return this.searchAll(a,i);throw new R.Services.Contacts.ContactsError(R.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_FIELD,"Unknown contact search scope: "+t)},resolveContacts:function(e,t,i){var a=e.trim();if(t===R.Services.Contacts.ResolveContactsFieldType.HANDLE)return this.searchByHandle(a,i);if(t===R.Services.Contacts.ResolveContactsFieldType.PHONE_NUMBER)return this.resolveContactsByPhone(a,i);throw new R.Services.Contacts.ContactsError(R.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_FIELD,"Unknown contact search scope: "+t)},searchAll:function(e,t){var i=R.Services.Contacts.ContactsUtils.normalizeAndSimplifyNameString(e).split(/[,]+/);1===(i=i.filter(function(e){return""!==e.trim()})).length&&(i=i.toString().split(/[\s]+/)),2<i.length&&(i[2]=i.slice(2).toString().trim());var r=new Array(i.length);if(r[0]=this._imdb.searchByAllKeys(i[0].trim(),R.Base.IMDBSearchOptions.BEGINS_WITH),r[0]===m)return m;for(var s=1;s<i.length&&s<3;s++)if(r[s]=this._imdb.searchByAllKeys(i[s].trim(),R.Base.IMDBSearchOptions.BEGINS_WITH),r[s]===m)return m;var a=R.Base.Utils.removeDuplicatesFromArray(r[0]).filter(function(e){for(s=1;s<r.length;s++){for(var t=r[s],i=!1,a=0;a<t.length;a++)e===t[a]&&(i=!0);if(!i)return!1}return!0});if(t){var n=new R.Services.Contacts.MatchedContactsWithMatchLevel;return 0<a.length&&(n._exactType1Contacts=a,n._allContacts=a,n._empty=!1),n}return a},searchByName:function(e,t){var i=R.Services.Contacts.ContactsUtils.normalizeAndSimplifyNameString(e).split(/[,]+/);1===(i=i.filter(function(e){return""!==e.trim()})).length&&(i=i.toString().split(/[\s]+/)),2<i.length&&(i[2]=i.slice(2).toString().trim());for(var a=new Array(i.length),r=[R.Services.Contacts.ContactCacheKeys.FIRST_NAME,R.Services.Contacts.ContactCacheKeys.LAST_NAME,R.Services.Contacts.ContactCacheKeys.DISPLAY_NAME,R.Services.Contacts.ContactCacheKeys.ALIAS],s=0;s<i.length&&s<3;s++){a[s]=[];for(var n=0;n<r.length;n++){var o=this._imdb.searchBySingleKey(r[n],i[s].trim(),R.Base.IMDBSearchOptions.BEGINS_WITH);a[s]=a[s].concat(o)}if(0===a[s].length)return m}var c=R.Base.Utils.removeDuplicatesFromArray(a[0]).filter(function(t){var e=function(e){return t===e};for(s=1;s<a.length;s++)if(!a[s].some(e))return!1;return!0});if(t){var l=new R.Services.Contacts.MatchedContactsWithMatchLevel;return 0<c.length&&(l._exactType1Contacts=c,l._allContacts=c,l._empty=!1),l}return c},searchByHandle:function(e,t){var i=R.Services.Contacts.ContactsUtils.normalizeHandle(e),a=this._imdb.searchBySingleKey(R.Services.Contacts.ContactCacheKeys.HANDLE,i),r=this._imdb.searchBySingleKey(R.Services.Contacts.ContactCacheKeys.EMAIL_ADDRESS,i),s=a.concat(r);if(s=R.Base.Utils.removeDuplicatesFromArray(s),t){var n=new R.Services.Contacts.MatchedContactsWithMatchLevel;return 0<s.length&&(n._exactType1Contacts=s,n._allContacts=s,n._empty=!1),n}return s},searchByLoginId:function(e,t){var i=this._imdb.searchBySingleKey(R.Services.Contacts.ContactCacheKeys.LOGIN_ID,e);if(i=R.Base.Utils.removeDuplicatesFromArray(i),t){var a=new R.Services.Contacts.MatchedContactsWithMatchLevel;return 0<i.length&&(a._exactType1Contacts=i,a._allContacts=i,a._empty=!1),a}return i},searchByTerminal:function(e,t){var i=R.Services.Contacts.ContactsUtils.normalizeAndSimplifyNameString(e),a=this._imdb.searchBySingleKey(R.Services.Contacts.ContactCacheKeys.TERMINAL_NAME,i,R.Base.IMDBSearchOptions.CONTAINS);if(a=R.Base.Utils.removeDuplicatesFromArray(a),t){var r=new R.Services.Contacts.MatchedContactsWithMatchLevel;return 0<a.length&&(r._exactType1Contacts=a,r._allContacts=a,r._empty=!1),r}return a},searchByPhone:function(e,t){for(var i=this._imdb.getAllElements(),r=new R.Services.Contacts.MatchedContactsWithMatchLevel,s=!1,a=function(e,t,i){var a=R.Services.Contacts.ContactsUtils.comparePhoneStrings(e,t);a===R.Services.Contacts.ContactMatchTypes.EXACT_TYPE1?(r._exactType1Contacts.push(i),s=!0):a===R.Services.Contacts.ContactMatchTypes.EXACT_TYPE2?r._exactType2Contacts.push(i):a===R.Services.Contacts.ContactMatchTypes.PARTIAL_TYPE1&&r._partialType1Contacts.push(i)}.bind(this),n=0;n<i.length&&!s;n++){for(var o=i[n],c=o.getPhoneNumbers().getValues(),l=0;l<c.length&&!s;l++)a(e,c[l].getPhoneNumber(),o);var d=o.getEmailAddresses().getValues();for(l=0;l<d.length&&!s;l++)a(e,d[l].getAddress(),o);var C=o.getEmailAddresses().getValues();for(l=0;l<C.length&&!s;l++)a(e,C[l].getAddress(),o);a(e,o.getFirstName().getValue(),o),a(e,o.getLastName().getValue(),o),a(e,o.getDisplayName().getValue(),o),a(e,o.getASCIIFirstName().getValue(),o),a(e,o.getASCIILastName().getValue(),o),a(e,o.getASCIIDisplayName().getValue(),o),a(e,o.getAlias().getValue(),o),a(e,o.getManager().getValue(),o),a(e,o.getCompany().getValue(),o),a(e,o.getDepartment().getValue(),o),a(e,o.getNotes().getValue(),o),a(e,o.getLocation().getValue(),o),a(e,o.getStreetAddress().getValue(),o),a(e,o.getCity().getValue(),o),a(e,o.getState().getValue(),o),a(e,o.getCountry().getValue(),o),a(e,o.getPostalCode().getValue(),o),a(e,o.getWorkRoomNumber().getValue(),o);var u=o.getCustom1().getValues();for(l=0;l<u.length&&!s;l++)a(e,u[n].getValue(),o);var v=o.getCustom2().getValues();for(l=0;l<v.length&&!s;l++)a(e,v[n].getValue(),o);var h=o.getCustom3().getValues();for(l=0;l<h.length&&!s;l++)a(e,h[n].getValue(),o)}return r._allContacts=r._exactType1Contacts.concat(r._exactType2Contacts).concat(r._partialType1Contacts),r._allContacts=R.Base.Utils.removeDuplicatesFromArray(r._allContacts),t?(0<r._allContacts.length&&(r._empty=!1),r):r._allContacts},resolveContactsByPhone:function(e,t){var i=this._imdb.searchBySingleKey(R.Services.Contacts.ContactCacheKeys.PHONE_NUMBER,e,R.Base.IMDBSearchOptions.EXACT_MATCH);if(i=R.Base.Utils.removeDuplicatesFromArray(i),t){var a=new R.Services.Contacts.MatchedContactsWithMatchLevel;return 0<i.length&&(a._exactType1Contacts=i,a._allContacts=i,a._empty=!1),a}return i},empty:function(){this._imdb=new R.Base.SimpleIMDB(this._cacheKeys)},_buildKeys:function(e){var t=e.getUniqueAddressForMatching();if(!this.hasUniqueAddressForMatching(t))return m;var i=[],a=e.getFirstName().getValue(),r=e.getASCIIFirstName().getValue();a!==m&&""!==a&&i.push(R.Services.Contacts.ContactsUtils.normalizeAndSimplifyNameString(a)),r!==m&&""!==r&&r!==a&&i.push(r);var s=[],n=e.getLastName().getValue(),o=e.getASCIILastName().getValue();n!==m&&""!==n&&s.push(R.Services.Contacts.ContactsUtils.normalizeAndSimplifyNameString(n)),o!==m&&""!==o&&o!==n&&s.push(o);var c=[],l=e.getDisplayName().getValue(),d=e.getASCIIDisplayName().getValue();l!==m&&""!==l&&c.push(R.Services.Contacts.ContactsUtils.normalizeAndSimplifyNameString(l)),d!==m&&""!==d&&d!==l&&c.push(d);for(var C=[],u=e.getPhoneNumbers().getValues(),v=0;v<u.length;v++){var h=u[v].getPhoneNumber();h!==m&&""!==h&&-1===C.indexOf(h)&&C.push(h)}var p=[],_=e.getEmailAddresses().getValues();for(v=0;v<_.length;v++){var S=_[v].getAddress();S!==m&&""!==S&&-1===p.indexOf(S)&&p.push(S)}var g=[],f=e.getIMAddresses().getValues();for(v=0;v<f.length;v++){var E=f[v].getAddress();E!==m&&""!==E&&-1===g.indexOf(E)&&g.push(E)}var A={};A[R.Services.Contacts.ContactCacheKeys.ADDRESS_FOR_MATCHING]=[t];var P=e.getAlias().getValue();P!==m&&""!==P&&(A[R.Services.Contacts.ContactCacheKeys.ALIAS]=[R.Services.Contacts.ContactsUtils.normalizeAndSimplifyNameString(P)]);var T=e.getCity().getValue();T!==m&&""!==T&&(A[R.Services.Contacts.ContactCacheKeys.CITY]=[T]);var y=e.getAlias().getValue();if(y!==m&&""!==y&&(A[R.Services.Contacts.ContactCacheKeys.DEPARTMENT]=[y]),R.Base.Utils.isDefined(e.getTerminal())){var b=e.getTerminal().getTerminalName();b!==m&&""!==b&&(A[R.Services.Contacts.ContactCacheKeys.TERMINAL_NAME]=[b])}0<i.length&&(A[R.Services.Contacts.ContactCacheKeys.FIRST_NAME]=i),0<s.length&&(A[R.Services.Contacts.ContactCacheKeys.LAST_NAME]=s),0<c.length&&(A[R.Services.Contacts.ContactCacheKeys.DISPLAY_NAME]=c),0<C.length&&(A[R.Services.Contacts.ContactCacheKeys.PHONE_NUMBER]=C),0<p.length&&(A[R.Services.Contacts.ContactCacheKeys.EMAIL_ADDRESS]=p),0<g.length&&(A[R.Services.Contacts.ContactCacheKeys.HANDLE]=g);var I=e.getScopiaLoginId().getValue();return I!==m&&""!==I&&(A[R.Services.Contacts.ContactCacheKeys.LOGIN_ID]=[I]),A},_buildKeysWithMatchingAddressOnly:function(e){var t=e.getUniqueAddressForMatching();if(!this.hasUniqueAddressForMatching(t))return m;var i={};return i[R.Services.Contacts.ContactCacheKeys.ADDRESS_FOR_MATCHING]=[t],i},hasUniqueAddressForMatching:function(e){return!(!R.Base.Utils.isDefined(e)||""===e)||(R.Base.Logger.warn(R.Base.LoggerTags.CONTACTS_SERVICE,"Failed to build keys for contact without unique address"),!1)},isContactInCache:function(e){if(!this.hasUniqueAddressForMatching(e))return!1;var t=R.Services.Contacts.ContactCacheKeys.ADDRESS_FOR_MATCHING;return 0<this._imdb.searchBySingleKey(t,e).length}},R.Services.Contacts.ContactsCache=e}(AvayaClientServices),function(n){"use strict";function e(e,t,i,a,r,s){this._uniqueSearchId=n.Base.Utils.makeId(16),this._searchString=e,this._searchField=t,this._searchSource=i,this._maxResults=a,this._maxChunkSize=r,this._searchNetworkSource=s}e.prototype={getUniqueSearchId:function(){return this._uniqueSearchId},_generateNewUniqueSearchId:function(){this._uniqueSearchId=n.Base.Utils.makeId(16)},getSearchString:function(){return this._searchString},_setSearchString:function(e){this._searchString=e},getSearchField:function(){return this._searchField},getSearchSource:function(){return this._searchSource},getSearchNetworkSource:function(){return this._searchNetworkSource},getMaxResults:function(){return this._maxResults},getMaxChunkSize:function(){return this._maxChunkSize}},n.Services.Contacts.ContactSearchRequest=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Base.BaseError.call(this),this._reason=e,this.name="ContactError",this.message=t}(e.prototype=Object.create(i.Base.BaseError.prototype)).getReason=function(){return this._reason},i.Services.Contacts.ContactsError=e}(AvayaClientServices),function(o){"use strict";function e(){this._contactsService=m,this._contacts=m,this._started=!1,this._onContactsChangedCallback=m,this._externalContactListChangesCallbacks=T.Callbacks()}e.prototype={start:function(e,t){!this._started&&e&&t&&(this._started=!0,this._contactsService=e,this._contacts=t,this._registerCallbacks())},stop:function(){this._started&&(this._started=!1,this._unregisterCallbacks())},isStarted:function(){return this._started},addOnContactListChangedCallback:function(e){e&&this._externalContactListChangesCallbacks.add(e)},removeOnContactListChangedCallback:function(e){e&&this._externalContactListChangesCallbacks.remove(e)},updateMatchedContactsForParticipant:function(e,t){var i=o.Services.Contacts.SearchFieldType.HANDLE,a=o.Services.Contacts.SearchFieldType.ALL;if(this._started&&e){var r=e.getAddress();if(r){var s=this._contactsService.findLocalMatchingContacts(r,i);if(t&&s.isEmpty()){var n=o.Services.Contacts.ContactsUtils.parseSipUri(r).userpart;o.Base.Utils.isDefined(n)&&(s=this._contactsService.findLocalMatchingContacts(n,a))}e.setMatchedContacts(s)}}},_registerCallbacks:function(){this._onContactsChangedCallback=function(){this._externalContactListChangesCallbacks.fire()}.bind(this),this._contactsService.getDataSet().addOnDataSetChangedCallback(this._onContactsChangedCallback)},_unregisterCallbacks:function(){this._contactsService.getDataSet().removeOnDataSetChangedCallback(this._onContactsChangedCallback)}},o.Services.Contacts.ContactsIntegrationService=e}(AvayaClientServices),function(c){"use strict";function e(e,t,i,a,r,s){this._presenceService=a,this._contactsService=r,this._directorySearchProvider=t,this._contactsCache=i,this._searchRequest=e,this._dataSet=new c.Base.DataSet,this._dataRetrieval=new c.Base.DataRetrieval(this._dataSet),this._dataRetrieval._onCancel=this._cancel.bind(this),this._resultsCounter=0,this._maxResults=m,this._currentUniqueSearchId=m,this._searchCompletionDate=m,this._contactsAnalyticsService=s}e.prototype={start:function(){var e=this._searchRequest.getSearchSource(),r=this._searchRequest.getUniqueSearchId();this._maxResults=0<this._searchRequest.getMaxResults()?Math.min(this._searchRequest.getMaxResults(),this._directorySearchProvider._selectedProvider.getMaxSearchResultsTotal()):this._directorySearchProvider._selectedProvider.getMaxSearchResultsTotal(),this._currentUniqueSearchId=r,this._searchCompletionDate=m,this._resultsCounter=0;var t=function(e,t,i){this._isResultValid(r)&&(!0===t?this._dataRetrieval._dataRetrievalDone.fire(t,i):this._dataRetrieval._dataRetrievalDone.fire(t,m),this._searchCompletionDate=new Date)}.bind(this),i=function(e){this._isResultValid(r)&&(this._dataRetrieval._dataRetrievalFailed.fire(e),this._searchCompletionDate=new Date)}.bind(this),a=function(e,t,i,a){this._isResultValid(r)&&this._handleResults(e,t,i,a)}.bind(this);e===c.Services.Contacts.SearchSourceType.NETWORK?this._searchNetworkContacts().then(t,i,a):e===c.Services.Contacts.SearchSourceType.LOCAL?this._searchLocalContacts().then(t,i,a):this._searchAllContacts().then(t,i,a)},updateRequest:function(e){this._searchRequest._setSearchString(e),this._searchRequest._generateNewUniqueSearchId(),this._dataSet.onDataSetChanged(this._dataSet.splice(0,this._dataSet.length),c.Base.DataSetChangeTypes.REMOVED),this._searchFinished=!1,this.start()},getDataRetrieval:function(){return this._dataRetrieval},getSearchCompletionDate:function(){return this._searchCompletionDate},_isResultValid:function(e){return!this._searchCompletionDate&&this._currentUniqueSearchId===e},_handleResults:function(e,t,i,a){for(var r=!1,s=function(t){try{return this._findInArray(this._dataSet,function(e){return e.getUniqueAddressForMatching()===t.getUniqueAddressForMatching()})}catch(e){return null}}.bind(this),n=0;n<e.length&&!this._searchFinished;n++){r=!0,e[n]._setPresenceService(this._presenceService),e[n]._setContactsService(this._contactsService);var o=!1;a&&(o=s(e[n])),o?this._mergeContacts(o,e[n]):this._dataSet.push(e[n]),this._searchFinished=this._maxResults!==m&&0!==this._maxResults&&++this._resultsCounter>=this._maxResults}void 0===t&&(t=!1),r&&(this._dataSet.onDataSetChanged(e.slice(0,n),c.Base.DataSetChangeTypes.ADDED),this._dataRetrieval._dataRetrievalProgress.fire(this._dataSet.length,t,i))},_mergeContacts:function(e,t){this._updateContactField(e.getFirstName(),t.getFirstName()),this._updateContactField(e.getLastName(),t.getLastName()),this._updateContactField(e.getDisplayName(),t.getDisplayName()),this._updateContactField(e.getASCIIFirstName(),t.getASCIIFirstName()),this._updateContactField(e.getASCIILastName(),t.getASCIILastName()),this._updateContactField(e.getASCIIDisplayName(),t.getASCIIDisplayName()),this._updateContactField(e.getAlias(),t.getAlias()),this._updateContactField(e.getLocation(),t.getLocation()),this._updateContactField(e.getWorkRoomNumber(),t.getWorkRoomNumber()),this._updateContactField(e.getStreetAddress(),t.getStreetAddress()),this._updateContactField(e.getCity(),t.getCity()),this._updateContactField(e.getState(),t.getState()),this._updateContactField(e.getCountry(),t.getCountry()),this._updateContactField(e.getPostalCode(),t.getPostalCode()),this._updateContactField(e.getCompany(),t.getCompany()),this._updateContactField(e.getManager(),t.getManager()),this._updateContactField(e.getDepartment(),t.getDepartment()),this._updateContactField(e.getLanguage(),t.getLanguage()),this._updateContactField(e.getNotes(),t.getNotes()),this._updateContactField(e.getScopiaUserId(),t.getScopiaUserId()),this._updateContactField(e.getScopiaLoginId(),t.getScopiaLoginId()),this._updateContactField(e.getRank(),t.getRank()),this._updateContactField(e.isBuddy(),t.isBuddy()),this._updateContactField(e.isFavorite(),t.isFavorite()),this._updateContactField(e.isVideoCapable(),t.isVideoCapable());var i=function(t,e){return this._findInArray(e,function(e){return e.getPhoneNumber()===t.getPhoneNumber()})}.bind(this);this._mergeContactArrayField(e.getPhoneNumbers().getValues(),t.getPhoneNumbers().getValues(),i);var a=function(t,e){return this._findInArray(e,function(e){return e.getAddress()===t.getAddress()})}.bind(this);this._mergeContactArrayField(e.getEmailAddresses().getValues(),t.getEmailAddresses().getValues(),a),this._mergeContactArrayField(e.getIMAddresses().getValues(),t.getIMAddresses().getValues(),a);var r=function(t,e){return this._findInArray(e,function(e){return e.getValue()===t.getValue()})}.bind(this);this._mergeContactArrayField(e.getCustom1().getValues(),t.getCustom1().getValues(),r),this._mergeContactArrayField(e.getCustom2().getValues(),t.getCustom2().getValues(),r),this._mergeContactArrayField(e.getCustom3().getValues(),t.getCustom3().getValues(),r)},_updateContactField:function(e,t){c.Base.Utils.isDefined(t._value)&&e._value!==t._value&&(e._value=t._value)},_mergeContactArrayField:function(e,t,i){for(var a=0;a<t.length;a++)i(t[a],e)||e.push(t[a])},_findInArray:function(e,t){if(!e||"function"!=typeof t)return null;for(var i=0;i<e.length;){var a=e[i];if(t(a))return a;i++}return null},_cancel:function(){this._searchCompletionDate=new Date,this._dataRetrieval._dataRetrievalFailed.fire(new c.Services.Contacts.ContactsError(c.Services.Contacts.ContactsErrorReason.REQUEST_CANCELED)),this._searchRequest.getSearchSource()!==c.Services.Contacts.SearchSourceType.LOCAL&&this._directorySearchProvider.stopDirectorySearch(this._searchRequest.getUniqueSearchId())},_limitExceeded:function(e){return this._maxResults!==m&&0!==this._maxResults&&e>this._maxResults},_resolveSearch:function(e,t,i){this._limitExceeded(t)?e.resolve(t,!1):e.resolve(t,i,t)},_searchNetworkContacts:function(){var a=this._contactsAnalyticsService.startTimingMetric(),e=this._directorySearchProvider.startDirectorySearch(this._searchRequest);return e.then(function(e,t,i){this._contactsAnalyticsService.sendNumDirectorySearches(this._searchRequest.getSearchField()),this._contactsAnalyticsService.directorySearchTimeEnd(a)}.bind(this)),e},_searchLocalContacts:function(){var e=T.Deferred(),t=this._contactsAnalyticsService.startTimingMetric(),i=this._contactsCache.searchContacts(this._searchRequest.getSearchString(),this._searchRequest.getSearchField(),!1);return this._contactsAnalyticsService.cachedContactsSearchTimeEnd(t),this._contactsAnalyticsService.sendNumCachedContactSearches(this._searchRequest.getSearchField()),setTimeout(function(){i?e.notify(i,!0,0):i=[],this._resolveSearch(e,i.length,!0)}.bind(this),0),e.promise()},_searchAllContacts:function(){var s,n=T.Deferred(),r=[],o=function(e,t,i){t?s=r.length+e.length:e.forEach(function(e){r.push(e.getUniqueAddressForMatching())});var a=!1;(i||0===i)&&(a=!0),n.notify(e,a,i,t)},t=function(e,t,i,a,r){return this._searchLocalContacts().then(function(){a?n.reject(r):this._resolveSearch(n,s,t)}.bind(this),function(e){n.reject(e)},function(e){o(e,!0,i)})}.bind(this);return this._searchNetworkContacts().then(t,function(e){c.Base.Logger.error(c.Base.LoggerTags.CONTACTS_SERVICE,"Network contacts search failed",e),t(0,!1,0,!0,e)},o),n.promise()}},c.Services.Contacts.ContactsSearch=e}(AvayaClientServices),function(P){"use strict";function e(e,t,i,a,r){this._started=!1,this._starting=!1,this._isNetworkAvailable=m,this._contactsModule=m,this._contactsIntegrationService=i,this._presenceService=a,this._contactsProvider=e,this._directorySearchProvider=t,this._contactsCache=new P.Services.Contacts.ContactsCache,this._contactsDataSet=new P.Base.DataSet,this._contactsRetrieval=new P.Base.DataRetrieval(this._contactsDataSet),this._retrievalFinished=!1,this._selfContact=m,this._activeSearches={},this._activeResolveContactsRequests={},this._searchAuditIntervalId=m,this._deniedCapability=new P.Base.Capability(P.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._addContactCapability=new P.Base.Capability(P.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._updateContactCapability=new P.Base.Capability(P.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._deleteContactCapability=new P.Base.Capability(P.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._searchContactCapability=new P.Base.Capability(P.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._searchTerminalCapability=new P.Base.Capability(P.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._resolveContactsCapability=new P.Base.Capability(P.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._conferenceSearchCapability=new P.Base.Capability(P.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._contactsAnalyticsService=r,this._selfContactBackoffPromise=m,this._selfContactBackoffTimeout=m}e.prototype={start:function(t,e){P.Base.Logger.info(P.Base.LoggerTags.CONTACTS_SERVICE,"Starting the service");var i,a=this._contactsAnalyticsService.startTimingMetric();t.addOnContactsServiceUnavailableCallback(function(){i=this._contactsAnalyticsService.startTimingMetric()}.bind(this)),t.addOnContactsServiceAvailableCallback(function(){this._contactsAnalyticsService.durationContactProviderOutagesEnd(i)}.bind(this)),this._contactsModule=t,this._starting=!0,this._selfContactBackoffPromise=T.Deferred();var r=function(){return this._contactsProvider.on(P.Base.NetworkProviderEvents.UNAUTHORIZED,function(){t._fireContactsUnavailableCallback(t)}.bind(this)),this._directorySearchProvider.start(e,t)}.bind(this),s=function(){return this._directorySearchProvider.getSelfContact().then(function(e){e._setContactsService(this),e._setPresenceService(this._presenceService),e._setSelfContact(!0),this._selfContact=e,this._starting=!1,this._started=!0,t._fireContactsAvailableCallback(t),P.Base.Logger.info(P.Base.LoggerTags.CONTACTS_SERVICE,"Service started successfully")}.bind(this),function(e){return P.Base.Logger.error(P.Base.LoggerTags.CONTACTS_SERVICE,"Self contact cannot be found",e),T.Deferred().reject(e).promise()}.bind(this))}.bind(this),n=function(t){var i=this._selfContactBackoffPromise;return this._selfContactBackoffTimeout=setTimeout(function(){t().then(function(){i.resolve()},function(e){e&&e.getReason&&e.getReason()===P.Services.Contacts.ContactsErrorReason.REQUEST_TIMEOUT?n(t):i.reject(e)})}.bind(this),3e4),i}.bind(this),o=function(){return r().then(function(){this._registerContactChangesCallbacks(),this._recalculateCapabilities(),this._contactsIntegrationService.start(this,t)}.bind(this)).then(s).fail(function(e){t._fireContactsUnavailableCallback(t),this._starting=!1,this._started=!1,P.Base.Logger.error(P.Base.LoggerTags.CONTACTS_SERVICE,"Failed to start service",e),e&&e.getReason&&e.getReason()===P.Services.Contacts.ContactsErrorReason.REQUEST_TIMEOUT&&(P.Base.Logger.warn(P.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Starting backoff algorithm for populateSelfContact."),n(s))}.bind(this)).then(function(){this._contactsAnalyticsService.contactsLoadTimeEnd(a)}.bind(this))}.bind(this);return function(){return this._contactsProvider.on(P.Providers.ACS.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,function(){P.Base.Utils.isDefined(this._isNetworkAvailable)&&!this._isNetworkAvailable&&(this._isNetworkAvailable=!0,o())}.bind(this)),this._contactsProvider.on(P.Providers.ACS.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,function(){this._selfContactBackoffPromise&&this._selfContactBackoffPromise.reject(new P.Base.NetworkError(P.Base.ErrorReasons.NETWORK_ERROR)),this._selfContactBackoffTimeout&&clearTimeout(this._selfContactBackoffTimeout),this._isNetworkAvailable=!1}.bind(this)),this._contactsProvider.start(e,t)}.bind(this)().then(o,function(e){P.Base.Logger.error(P.Base.LoggerTags.CONTACTS_SERVICE,"Failed to start service",e)})},stop:function(e){P.Base.Logger.info(P.Base.LoggerTags.CONTACTS_SERVICE,"Stopping the service");var t=T.Deferred();this._started||t.reject(new P.Services.Contacts.ContactsError(P.Services.Contacts.ContactsErrorReason.INTERNAL_ERROR)),e._fireContactsUnavailableCallback(e),this._started=!1,this._selfContactBackoffPromise&&this._selfContactBackoffPromise.reject(new P.Base.NetworkError(P.Base.ErrorReasons.NETWORK_CANCELED)),this._selfContactBackoffTimeout&&clearTimeout(this._selfContactBackoffTimeout);var i=function(e){this._started=!0,P.Base.Logger.error(P.Base.LoggerTags.CONTACTS_SERVICE,"Failed to stop service",e),t.reject(e)}.bind(this),a=function(){return this._contactsProvider.stop().fail(i)}.bind(this),r=function(){return this._cleanupResources(),this._directorySearchProvider.stop().fail(i)}.bind(this);return a().then(r).then(function(){this._contactsIntegrationService.stop(),this._selfContact=m,P.Base.Logger.info(P.Base.LoggerTags.CONTACTS_SERVICE,"Service stopped successfully"),t.resolve()}.bind(this),i.bind(this)),t.promise()},stopImmediately:function(e){P.Base.Logger.info(P.Base.LoggerTags.CONTACTS_SERVICE,"Stopping the service");var t=T.Deferred();return this._started||t.reject(new P.Services.Contacts.ContactsError(P.Services.Contacts.ContactsErrorReason.INTERNAL_ERROR)),e._fireContactsUnavailableCallback(e),this._started=!1,P.Base.Logger.info(P.Base.LoggerTags.CONTACTS_SERVICE,"Service stopped successfully"),t.resolve(),t.promise()},isStarted:function(){return this._started},isStarting:function(){return this._starting},createEditableContact:function(){var e=this._contactsProvider.createContactForAdd();return e._setContactsService(this),e},createEditableContactFromContact:function(e){if(e.getTerminal()&&""!==e.getTerminal().getTerminalId())throw new P.Services.Contacts.ContactsError(P.Services.Contacts.ContactsErrorReason.EDIT_TERMINAL_NOT_SUPPORTED);var t=new P.Services.Contacts.EditableContact,i=this._contactsProvider.createContactForAdd();t._setContactsService(this),t._setInContactList(e._isInContactList()),t._isInContactList()&&t._setUniqueAddressForMatching(e.getUniqueAddressForMatching()),t.getFirstName().setValue(e.getFirstName().getValue()),t.getLastName().setValue(e.getLastName().getValue()),t.getDisplayName().setValue(e.getDisplayName().getValue()),t.getASCIIFirstName().setValue(e.getASCIIFirstName().getValue()),t.getASCIILastName().setValue(e.getASCIILastName().getValue()),t.getASCIIDisplayName().setValue(e.getASCIIDisplayName().getValue()),t.getAlias().setValue(e.getAlias().getValue()),t.getLocation().setValue(e.getLocation().getValue()),t.getWorkRoomNumber().setValue(e.getWorkRoomNumber().getValue()),t.getStreetAddress().setValue(e.getStreetAddress().getValue()),t.getCity().setValue(e.getCity().getValue()),t.getState().setValue(e.getState().getValue()),t.getCountry().setValue(e.getCountry().getValue()),t.getPostalCode().setValue(e.getPostalCode().getValue()),t.getCompany().setValue(e.getCompany().getValue()),t.getManager().setValue(e.getManager().getValue()),t.getDepartment().setValue(e.getDepartment().getValue()),t.getLanguage().setValue(e.getLanguage().getValue()),t.getNotes().setValue(e.getNotes().getValue()),t.getScopiaUserId().setValue(e.getScopiaUserId().getValue()),t.getScopiaLoginId().setValue(e.getScopiaLoginId().getValue()),t.getRank().setValue(e.getRank().getValue()),t.isBuddy().setValue(e.isBuddy().getValue()),t.isFavorite().setValue(e.isFavorite().getValue()),t.isVideoCapable().setValue(e.isVideoCapable().getValue()),t.getFirstName()._setWriteCapability(e.getFirstName().getWriteCapability()),t.getLastName()._setWriteCapability(e.getLastName().getWriteCapability()),t.getDisplayName()._setWriteCapability(e.getDisplayName().getWriteCapability()),t.getASCIIFirstName()._setWriteCapability(e.getASCIIFirstName().getWriteCapability()),t.getASCIILastName()._setWriteCapability(e.getASCIILastName().getWriteCapability()),t.getASCIIDisplayName()._setWriteCapability(e.getASCIIDisplayName().getWriteCapability()),t.getAlias()._setWriteCapability(e.getAlias().getWriteCapability()),t.getLocation()._setWriteCapability(e.getLocation().getWriteCapability()),t.getWorkRoomNumber()._setWriteCapability(e.getWorkRoomNumber().getWriteCapability()),t.getStreetAddress()._setWriteCapability(e.getStreetAddress().getWriteCapability()),t.getCity()._setWriteCapability(e.getCity().getWriteCapability()),t.getState()._setWriteCapability(e.getState().getWriteCapability()),t.getCountry()._setWriteCapability(e.getCountry().getWriteCapability()),t.getPostalCode()._setWriteCapability(e.getPostalCode().getWriteCapability()),t.getCompany()._setWriteCapability(e.getCompany().getWriteCapability()),t.getManager()._setWriteCapability(e.getManager().getWriteCapability()),t.getDepartment()._setWriteCapability(e.getDepartment().getWriteCapability()),t.getLanguage()._setWriteCapability(e.getLanguage().getWriteCapability()),t.getNotes()._setWriteCapability(e.getNotes().getWriteCapability()),t.getScopiaUserId()._setWriteCapability(e.getScopiaUserId().getWriteCapability()),t.getScopiaLoginId()._setWriteCapability(e.getScopiaLoginId().getWriteCapability()),t.getRank()._setWriteCapability(e.getRank().getWriteCapability()),t.isBuddy()._setWriteCapability(e.isBuddy().getWriteCapability()),t.isFavorite()._setWriteCapability(e.isFavorite().getWriteCapability()),t.isVideoCapable()._setWriteCapability(e.isVideoCapable().getWriteCapability());for(var a=e.getPhoneNumbers().getValues(),r=t.getPhoneNumbers().getValues(),s=0;s<a.length;s++){var n=new P.Services.Contacts.EditableContactPhoneField;n.setPhoneNumber(a[s].getPhoneNumber()),n.setPhoneNumberType(a[s].getPhoneNumberType()),n.setSpeedDialEnabled(a[s].isSpeedDialEnabled()),n.setLabel1(a[s].getLabel1()),n.setLabel2(a[s].getLabel2()),n.setDefault(a[s].isDefault()),n._setWriteCapability(a[s].getWriteCapability()),r.push(n)}var o=e.getEmailAddresses().getValues(),c=t.getEmailAddresses().getValues();for(s=0;s<o.length;s++){var l=new P.Services.Contacts.EditableContactEmailAddressField;l.setAddress(o[s].getAddress()),l.setEmailAddressType(o[s].getEmailAddressType()),l._setWriteCapability(o[s].getWriteCapability()),c.push(l)}var d=e.getIMAddresses().getValues(),C=t.getIMAddresses().getValues();for(s=0;s<d.length;s++){var u=new P.Services.Contacts.EditableContactIMAddressField;u.setAddress(d[s].getAddress()),u.setIMAddressType(d[s].getIMAddressType()),u._setWriteCapability(d[s].getWriteCapability()),C.push(u)}var v=e.getCustom1().getValues(),h=t.getCustom1().getValues();for(s=0;s<v.length;s++){var p=new P.Services.Contacts.EditableContactStringField;p.setValue(v[s].getValue()),p._setWriteCapability(v[s].getWriteCapability()),h.push(p)}var _=e.getCustom2().getValues(),S=t.getCustom2().getValues();for(s=0;s<_.length;s++){var g=new P.Services.Contacts.EditableContactStringField;g.setValue(_[s].getValue()),g._setWriteCapability(_[s].getWriteCapability()),S.push(g)}var f=e.getCustom3().getValues(),E=t.getCustom3().getValues();for(s=0;s<f.length;s++){var A=new P.Services.Contacts.EditableContactStringField;A.setValue(f[s].getValue()),A._setWriteCapability(f[s].getWriteCapability()),E.push(A)}return e.getPhoneNumbers()._setWriteCapability(i.getPhoneNumbers().getWriteCapability()),e.getEmailAddresses()._setWriteCapability(i.getEmailAddresses().getWriteCapability()),e.getIMAddresses()._setWriteCapability(i.getIMAddresses().getWriteCapability()),e.getCustom1()._setWriteCapability(i.getCustom1().getWriteCapability()),e.getCustom2()._setWriteCapability(i.getCustom2().getWriteCapability()),e.getCustom3()._setWriteCapability(i.getCustom3().getWriteCapability()),t},addContact:function(e){return this._contactsProvider.addContact(e)},updateContact:function(e){return this._contactsProvider.updateContact(e)},deleteContact:function(e){return this._contactsProvider.deleteContact(e)},getContacts:function(){if(this._retrievalFinished)setTimeout(function(){this._contactsRetrieval._dataRetrievalDone.fire()}.bind(this),1);else{var e=function(){this._retrievalFinished=!0,this._contactsAnalyticsService.sendNumContactsLoaded(this._contactsDataSet.length),this._contactsRetrieval._dataRetrievalDone.fire()}.bind(this),t=function(e){this._contactsRetrieval._dataRetrievalFailed.fire(e)}.bind(this),i=function(e){this._contactsRetrieval._dataRetrievalProgress.fire(this._contactsDataSet.length,!0,e.length)}.bind(this);this._contactsProvider.retrieveAllContacts().then(e,t,i)}return this._contactsRetrieval},searchContacts:function(e){var t=e.getUniqueSearchId();if(this._activeSearches[t])return P.Base.Logger.warn(P.Base.LoggerTags.CONTACTS_SERVICE,"Contact search with provided requestId is already in progress - returning associated DataRetrieval"),this._activeSearches[t].getDataRetrieval();var i=new P.Services.Contacts.ContactsSearch(e,this._directorySearchProvider,this._contactsCache,this._presenceService,this,this._contactsAnalyticsService);return(this._activeSearches[t]=i).start(),i.getDataRetrieval()},resolveContacts:function(e){var t=e.getUniqueSearchId();if(this._activeResolveContactsRequests[t])return P.Base.Logger.warn(P.Base.LoggerTags.CONTACTS_SERVICE,"Contact resolution with provided requestId is already in progress - returning associated DataRetrieval"),this._activeResolveContactsRequests[t].getDataRetrieval();var i=new P.Services.Contacts.ResolveContacts(e,this._directorySearchProvider,this._contactsCache,this._contactsAnalyticsService);return(this._activeResolveContactsRequests[t]=i).start(),i.getDataRetrieval()},changeSearchContactsRequest:function(e,t){var i;for(var a in this._activeSearches)if(this._activeSearches.hasOwnProperty(a)&&this._activeSearches[a].getDataRetrieval()===e){i=this._activeSearches[a];break}if(!i)throw new P.Services.Contacts.ContactsError(P.Services.Contacts.ContactsErrorReason.SEARCH_REQUEST_NOT_FOUND);i.updateRequest(t)},_startSearchRequestsAudit:function(){this._searchAuditIntervalId=setInterval(function(){var e=new Date;for(var t in this._activeSearches)if(this._activeSearches.hasOwnProperty(t)){var i=this._activeSearches[t].getSearchCompletionDate();i&&12e4<e-i&&delete this._activeSearches[t]}}.bind(this),12e4)},_stopSearchRequestsAudit:function(){clearInterval(this._searchAuditIntervalId),this._searchAuditIntervalId=m},findLocalMatchingContacts:function(e,t){return this._contactsCache.searchContacts(e,t,!0)},getAddContactCapability:function(){return this._addContactCapability},getUpdateContactCapability:function(e){return e&&e._isInContactList()?this._updateContactCapability:this._deniedCapability},getDeleteContactCapability:function(e){return e&&e._isInContactList()?this._deleteContactCapability:this._deniedCapability},getNetworkSearchContactCapability:function(){return this._searchContactCapability},getNetworkResolveContactsCapability:function(){return this._resolveContactsCapability},getNetworkSearchTerminalCapability:function(){return this._searchTerminalCapability},getExtendedContactDetailsCapability:function(){return this._extendedDetailsCapability},getConferenceSearchCapability:function(){return this._conferenceSearchCapability},_recalculateCapabilities:function(){var e=!1,t=this._contactsProvider.getAddContactCapability();this._addContactCapability!==t&&(this._addContactCapability=t,e=!0);var i=this._contactsProvider.getUpdateContactCapability();this._updateContactCapability!==i&&(this._updateContactCapability=i,e=!0);var a=this._contactsProvider.getDeleteContactCapability();this._deleteContactCapability!==a&&(this._deleteContactCapability=a,e=!0);var r=this._directorySearchProvider.getNetworkSearchContactCapability();this._searchContactCapability!==r&&(this._searchContactCapability=r,e=!0);var s=this._directorySearchProvider.getNetworkResolveContactsCapability();this._resolveContactsCapability!==s&&(this._resolveContactsCapability=s,e=!0);var n=this._directorySearchProvider.getNetworkSearchTerminalCapability();this._searchTerminalCapability!==n&&(this._searchTerminalCapability=n,e=!0);var o=this._directorySearchProvider.getConferenceSearchCapability();this._conferenceSearchCapability!==o&&(this._conferenceSearchCapability=o,e=!0);var c=this._contactsProvider.getExtendedContactDetailsCapability();this._extendedDetailsCapability!==c&&(this._extendedDetailsCapability=c,e=!0),e&&this._contactsModule._onCapabilitiesChangedCallbacks.fire(this)},_registerContactChangesCallbacks:function(){var e=P.Providers.Interfaces.ContactsProviderCallbackIds;this._contactsProvider.on(e.CONTACT_ADDED,function(e){for(var t=0;t<e.length;t++)e[t]._setInContactList(!0),e[t]._setPresenceService(this._presenceService),e[t]._setContactsService(this),this._contactsDataSet.push(e[t]),this._contactsCache.addContact(e[t]);this._contactsDataSet.onDataSetChanged(e,P.Base.DataSetChangeTypes.ADDED)}.bind(this));var a=function(e){for(var t=0;t<this._contactsDataSet.length;t++)if(e.getUniqueAddressForMatching()===this._contactsDataSet[t].getUniqueAddressForMatching())return t}.bind(this);this._contactsProvider.on(e.CONTACT_UPDATED,function(e){var t=a(e);P.Base.Utils.isDefined(t)?(this._contactsDataSet[t]=e,this._contactsDataSet.onDataSetChanged([e],P.Base.DataSetChangeTypes.UPDATED)):(P.Base.Logger.warn(P.Base.LoggerTags.CONTACTS_SERVICE,"Updated contact was not found in DataSet",e),this._contactsDataSet.push(e),this._contactsDataSet.onDataSetChanged([e],P.Base.DataSetChangeTypes.ADDED)),e._setInContactList(!0),e._setPresenceService(this._presenceService),e._setContactsService(this),this._contactsCache.updateContact(e)}.bind(this)),this._contactsProvider.on(e.CONTACT_DELETED,function(e){for(var t=0;t<e.length;t++){var i=a(e[t]);this._contactsDataSet.splice(i,1),e[t]._setInContactList(!1),e[t]._setPresenceService(this._presenceService),e[t]._setContactsService(this),this._contactsCache.deleteContact(e[t])}this._contactsDataSet.onDataSetChanged(e,P.Base.DataSetChangeTypes.REMOVED)}.bind(this)),this._contactsProvider.on(e.CAPABILITIES_CHANGED,this._recalculateCapabilities.bind(this)),this._directorySearchProvider.on(e.CAPABILITIES_CHANGED,this._recalculateCapabilities.bind(this))},getContactsModule:function(){return this._contactsModule},isContactInCache:function(e){return this._contactsCache.isContactInCache(e.getUniqueAddressForMatching())},getSelfContact:function(){return this._selfContact},getDataSet:function(){return this._contactsDataSet},_cleanupResources:function(){this._contactsCache.empty();var e=this._contactsDataSet.splice(0,this._contactsDataSet.length);0<e.length&&this._contactsDataSet.onDataSetChanged(e,P.Base.DataSetChangeTypes.REMOVED),this._contactsDataSet.dataSetChangeCallbacks.empty(),this._contactsDataSet.dataSetInvalidatedCallbacks.empty(),this._contactsRetrieval._dataRetrievalProgress.empty(),this._contactsRetrieval._dataRetrievalDone.empty(),this._contactsRetrieval._dataRetrievalFailed.empty(),this._activeSearches={},this._activeResolveContactsRequests={}}},P.Services.Contacts.ContactsService=e}(AvayaClientServices),function(d){"use strict";var e="\\+?[0-9\\(\\)\\.\\-]*\\d{1}[0-9\\(\\)\\.\\-]*",t="(\\*|#|\\d)\\d{0,3}",i=new RegExp("^"+e+"$","i"),a=new RegExp("^"+t+"$","i"),r=new RegExp("^((\\+?[0-9\\(\\)\\.\\-]*\\d{1}[0-9\\(\\)\\.\\-]*)|((\\*|#|\\d)\\d{0,3}))[#\\*,;]{1}[#\\*,;0-9]*$","i"),s=new RegExp("^(([^:/?#]+):)?(([^/?@#]*)@)?([^/?;#\\s]*)?","i"),n=new RegExp("^\\++[1-9]\\d{1,14}$","i"),o=new RegExp("^.+\\@.+$","i"),c=new RegExp("^\\+?[0-9a-z]+[0-9a-z\\(\\)\\.\\-]*$","i"),C={getPhoneStringType:function(e){return e&&""!==e.trim()?C.isPhoneNumber(e)?d.Services.Contacts.PhoneStringTypes.PHONE_NUMBER:C.isDialString(e)?d.Services.Contacts.PhoneStringTypes.DIALSTRING:C.isFeatureAccessCode(e)?d.Services.Contacts.PhoneStringTypes.FEATURE_ACCESS_CODE:C.isSipUri(e)?d.Services.Contacts.PhoneStringTypes.SIP_URI:d.Services.Contacts.PhoneStringTypes.UNKNOWN:d.Services.Contacts.PhoneStringTypes.UNKNOWN},isSipUri:function(e){return!!e&&!!C.parseSipUri(e).userpart},isPhoneNumber:function(e){return i.test(e)},isFeatureAccessCode:function(e){return a.test(e)},isDialString:function(e){return r.test(e)},isPhoneWithDomain:function(e){return o.test(e)},isE164Userpart:function(e){return n.test(C.parseSipUri(e).userpart)},isAlphanumericUserpart:function(e){return c.test(C.parseSipUri(e).userpart)},isNumericUserpart:function(e){return C.isPhoneNumber(C.parseSipUri(e).userpart)},normalizePhoneString:function(e){var t=e.replace(/^(\+)+|([\s\-\(\)\.])+/g,"");return C.mapAlphabeticalToITU(t)},normalizeHandle:function(e){return e.replace(/^([a-z]+[a-z0-9+.-]*\:)/g,"")},normalizeAndSimplifyNameString:function(e){return e.toLowerCase().replace(/\u1E9E/g,"sz").replace(/\u00DF/g,"sz").replace(/\u00F8/g,"o").normalize("NFD").replace(/[\u0080-\u036F]/g,"").replace("ss","sz").replace("ue","u").replace("ae","a").replace("oe","o")},mapAlphabeticalToITU:function(e){return e.replace(/[ABC]{1}/i,"2").replace(/[DEF]{1}/i,"3").replace(/[GHI]{1}/i,"4").replace(/[JKL]{1}/i,"5").replace(/[MNO]{1}/i,"6").replace(/[PQRS]{1}/i,"7").replace(/[TUV]{1}/i,"8").replace(/[WXYZ]{1}/i,"9")},parseSipUri:function(e){var t=e.match(s);return{scheme:t[2],userpart:t[4],host:t[5]}},comparePhoneStrings:function(e,t){var i,a,r,s,n=d.Services.Contacts.PhoneStringTypes,o=d.Services.Contacts.ContactMatchTypes,c=C.getPhoneStringType(e),l=C.getPhoneStringType(t);return c===n.UNKNOWN||l===n.UNKNOWN?o.NO_MATCH:(i=c===n.SIP_URI?(r=C.parseSipUri(e),C.normalizePhoneString(r.userpart)):C.normalizePhoneString(e),a=l===n.SIP_URI?(s=C.parseSipUri(t),C.normalizePhoneString(s.userpart)):C.normalizePhoneString(t),c!==n.SIP_URI||l!==n.SIP_URI||r.scheme===s.scheme&&r.host===s.host?i===a?c===n.SIP_URI&&l!==n.SIP_URI||c!==n.SIP_URI&&l===n.SIP_URI?o.EXACT_TYPE2:o.EXACT_TYPE1:C._trimPhoneString(i)===C._trimPhoneString(a)?o.PARTIAL_TYPE1:o.NO_MATCH:o.NO_MATCH)},_trimPhoneString:function(e){return e.substr(e.length-10)},getPhoneAndVideoChannelPresenceAddress:function(e){var t=e.getPhoneNumbers().getValues().filter(function(e){return e.isAvayaAdministered()&&e.getPhoneNumberType()===d.Services.Contacts.ContactPhoneNumberType.PHONE_NUMBER_WORK}),i=t.filter(function(e){return C.isPhoneWithDomain(e.getPhoneNumber())}),a=i.filter(function(e){return C.isE164Userpart(e.getPhoneNumber())});if(a[0])return d.Base.Logger.info(d.Base.LoggerTags.CONTACTS_SERVICE,"Using first E.164 phone number as Phone/Video channel presence address"),a[0];var r=i.filter(function(e){return C.isNumericUserpart(e.getPhoneNumber())});if(r[0])return d.Base.Logger.info(d.Base.LoggerTags.CONTACTS_SERVICE,"Using first numeric phone number as Phone/Video channel presence address"),r[0];var s=i.filter(function(e){return C.isAlphanumericUserpart(e.getPhoneNumber())});return s[0]?(d.Base.Logger.info(d.Base.LoggerTags.CONTACTS_SERVICE,"Using first alphanumeric phone number as Phone/Video channel presence address"),s[0]):i[0]?(d.Base.Logger.info(d.Base.LoggerTags.CONTACTS_SERVICE,"Using first phone number with domain as Phone/Video channel presence address"),i[0]):t[0]?(d.Base.Logger.info(d.Base.LoggerTags.CONTACTS_SERVICE,"Using first Avaya administered phone number as Phone/Video channel presence address"),t[0]):void d.Base.Logger.warn(d.Base.LoggerTags.CONTACTS_SERVICE,"No suitable Phone/Video channel presence address found in self contact. Channel presence publications might not work as expected.")}};d.Services.Contacts.ContactsUtils=C}(AvayaClientServices),function(e){"use strict";function t(){this._uniqueAddressForMatching=m,this._firstName=new e.Services.Contacts.EditableContactStringField,this._lastName=new e.Services.Contacts.EditableContactStringField,this._displayName=new e.Services.Contacts.EditableContactStringField,this._asciiFirstName=new e.Services.Contacts.EditableContactStringField,this._asciiLastName=new e.Services.Contacts.EditableContactStringField,this._asciiDisplayName=new e.Services.Contacts.EditableContactStringField,this._alias=new e.Services.Contacts.EditableContactStringField,this._company=new e.Services.Contacts.EditableContactStringField,this._location=new e.Services.Contacts.EditableContactStringField,this._workRoomNumber=new e.Services.Contacts.EditableContactStringField,this._streetAddress=new e.Services.Contacts.EditableContactStringField,this._city=new e.Services.Contacts.EditableContactStringField,this._state=new e.Services.Contacts.EditableContactStringField,this._country=new e.Services.Contacts.EditableContactStringField,this._postalCode=new e.Services.Contacts.EditableContactStringField,this._manager=new e.Services.Contacts.EditableContactStringField,this._department=new e.Services.Contacts.EditableContactStringField,this._language=new e.Services.Contacts.EditableContactStringField,this._emailAddresses=new e.Services.Contacts.ContactFieldList,this._phoneNumbers=new e.Services.Contacts.ContactFieldList,this._imAddresses=new e.Services.Contacts.ContactFieldList,this._buddy=new e.Services.Contacts.EditableContactBooleanField,this._favorite=new e.Services.Contacts.EditableContactBooleanField,this._videoCapable=new e.Services.Contacts.EditableContactBooleanField,this._rank=new e.Services.Contacts.EditableContactNumberField,this._notes=new e.Services.Contacts.EditableContactStringField,this._custom1=new e.Services.Contacts.ContactFieldList,this._custom2=new e.Services.Contacts.ContactFieldList,this._scopiaUserId=new e.Services.Contacts.EditableContactStringField,this._scopiaLoginId=new e.Services.Contacts.EditableContactStringField,this._custom3=new e.Services.Contacts.ContactFieldList,this._inContactList=!1,this._contactsService=m}t.prototype={getUniqueAddressForMatching:function(){return this._uniqueAddressForMatching},_setUniqueAddressForMatching:function(e){this._uniqueAddressForMatching=e},getFirstName:function(){return this._firstName},getLastName:function(){return this._lastName},getDisplayName:function(){return this._displayName},getASCIIFirstName:function(){return this._asciiFirstName},getASCIILastName:function(){return this._asciiLastName},getASCIIDisplayName:function(){return this._asciiDisplayName},getAlias:function(){return this._alias},getLocation:function(){return this._location},getWorkRoomNumber:function(){return this._workRoomNumber},getStreetAddress:function(){return this._streetAddress},getCity:function(){return this._city},getState:function(){return this._state},getCountry:function(){return this._country},getPostalCode:function(){return this._postalCode},getCompany:function(){return this._company},getManager:function(){return this._manager},getDepartment:function(){return this._department},getLanguage:function(){return this._language},getEmailAddresses:function(){return this._emailAddresses},getPhoneNumbers:function(){return this._phoneNumbers},getIMAddresses:function(){return this._imAddresses},isBuddy:function(){return this._buddy},isFavorite:function(){return this._favorite},isVideoCapable:function(){return this._videoCapable},getNotes:function(){return this._notes},getRank:function(){return this._rank},getCustom1:function(){return this._custom1},getCustom2:function(){return this._custom2},getCustom3:function(){return this._custom3},getScopiaUserId:function(){return this._scopiaUserId},getScopiaLoginId:function(){return this._scopiaLoginId},_isInContactList:function(){return this._inContactList},_setInContactList:function(e){this._inContactList=e},_setContactsService:function(e){this._contactsService=e}},e.Services.Contacts.EditableContact=t}(AvayaClientServices),function(s){"use strict";var e={getUpdateContactCapability:function(){return this._contactsService.getUpdateContactCapability(this)},getDeleteContactCapability:function(){return this._contactsService.getDeleteContactCapability(this)},getContactSavableCapability:function(){var e=this.getLastName()&&this.getLastName().getValue()&&""!==this.getLastName().getValue().trim(),t=this.getFirstName()&&this.getFirstName().getValue()&&""!==this.getFirstName().getValue().trim(),i=this.getPhoneNumbers().getValues()[0]&&this.getPhoneNumbers().getValues()[0].getPhoneNumber()&&""!==this.getPhoneNumbers().getValues()[0].getPhoneNumber().trim(),a=this.getEmailAddresses().getValues()[0]&&this.getEmailAddresses().getValues()[0].getAddress()&&""!==this.getEmailAddresses().getValues()[0].getAddress().trim(),r=t&&e&&(i||a)?s.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED:s.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED;return new s.Base.Capability(r)}};T.extend(s.Services.Contacts.EditableContact.prototype,e)}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Contacts.ContactCacheKeys={ADDRESS_FOR_MATCHING:"ADDRESS_FOR_MATCHING",FIRST_NAME:"FIRST_NAME",LAST_NAME:"LAST_NAME",DISPLAY_NAME:"DISPLAY_NAME",ALIAS:"ALIAS",CITY:"CITY",DEPARTMENT:"DEPARTMENT",PHONE_NUMBER:"PHONE_NUMBER",EMAIL_ADDRESS:"EMAIL_ADDRESS",HANDLE:"HANDLE",LOGIN_ID:"LOGIN_ID",TERMINAL_NAME:"TERMINAL_NAME"}}(),function(e){"use strict";AvayaClientServices.Services.Contacts.ContactEmailAddressType={EMAIL_ADDRESS_WORK:"EMAIL_ADDRESS_WORK",EMAIL_ADDRESS_OTHER:"EMAIL_ADDRESS_OTHER"}}(),function(e){"use strict";AvayaClientServices.Services.Contacts.ContactIMAddressType={IM_ADDRESS_WORK:"IM_ADDRESS_WORK",IM_ADDRESS_OTHER:"IM_ADDRESS_OTHER"}}(),function(e){"use strict";AvayaClientServices.Services.Contacts.ContactMatchTypes={EXACT_TYPE1:"EXACT_TYPE1",EXACT_TYPE2:"EXACT_TYPE2",PARTIAL_TYPE1:"PARTIAL_TYPE1",NO_MATCH:"NO_MATCH"}}(),function(e){"use strict";AvayaClientServices.Services.Contacts.ContactPhoneNumberType={PHONE_NUMBER_WORK:"PHONE_NUMBER_WORK",PHONE_NUMBER_HANDLE:"PHONE_NUMBER_HANDLE",PHONE_NUMBER_MOBILE:"PHONE_NUMBER_MOBILE",PHONE_NUMBER_HOME:"PHONE_NUMBER_HOME",PHONE_NUMBER_FAX:"PHONE_NUMBER_FAX",PHONE_NUMBER_PAGER:"PHONE_NUMBER_PAGER"}}(),function(e){"use strict";AvayaClientServices.Services.Contacts.ContactPictureSize={XSMALL:"XSMALL",SMALL:"SMALL",MEDIUM:"MEDIUM",LARGE:"LARGE",XLARGE:"XLARGE",XXLARGE:"XXLARGE"}}(),function(e){"use strict";AvayaClientServices.Services.Contacts.ContactsErrorReason={UNKNOWN_REASON:"UNKNOWN_REASON",INTERNAL_ERROR:"INTERNAL_ERROR",RETRY:"RETRY",SERVER_UNAVAILABLE:"SERVER_UNAVAILABLE",INVALID_SERVER_RESPONSE:"INVALID_SERVER_RESPONSE",AUTHENTICATION_FAILED:"AUTHENTICATION_FAILED",AUTHENTICATION_CANCELLED:"AUTHENTICATION_CANCELLED",AUTHORIZATION_FAILED:"AUTHORIZATION_FAILED",REQUEST_TIMEOUT:"REQUEST_TIMEOUT",REQUEST_CANCELED:"REQUEST_CANCELED",DUPLICATE_CONTACT:"DUPLICATE_CONTACT",INVALID_CONTACT:"INVALID_CONTACT",REQUIRED_DATA_MISSING:"REQUIRED_DATA_MISSING",DELETE_CONTACT_NOT_AVAILABLE:"DELETE_CONTACT_NOT_AVAILABLE",ADD_CONTACT_NOT_AVAILABLE:"ADD_CONTACT_NOT_AVAILABLE",UPDATE_CONTACT_NOT_AVAILABLE:"UPDATE_CONTACT_NOT_AVAILABLE",SEARCH_CONTACTS_NOT_AVAILABLE:"SEARCH_CONTACTS_NOT_AVAILABLE",SEARCH_TERMINALS_NOT_AVAILABLE:"SEARCH_TERMINALS_NOT_AVAILABLE",CONTACT_NOT_FOUND:"CONTACT_NOT_FOUND",INVALID_SEARCH_REQUEST:"INVALID_SEARCH_REQUEST",INVALID_SEARCH_STRING:"INVALID_SEARCH_STRING",INVALID_SEARCH_STRINGS:"INVALID_SEARCH_STRINGS",INVALID_SEARCH_SOURCE:"INVALID_SEARCH_SOURCE",INVALID_SEARCH_FIELD:"INVALID_SEARCH_FIELD",SEARCH_REQUEST_NOT_FOUND:"SEARCH_REQUEST_NOT_FOUND",SEARCH_STRINGS_TOO_LARGE:"SEARCH_STRINGS_TOO_LARGE",EDIT_TERMINAL_NOT_SUPPORTED:"EDIT_TERMINAL_NOT_SUPPORTED",CONTACTS_NOTIFICATIONS_CHANNEL_FAILED:"CONTACTS_NOTIFICATIONS_CHANNEL_FAILED"}}(),function(e){"use strict";AvayaClientServices.Services.Contacts.PhoneStringTypes={PHONE_NUMBER:"PHONE_NUMBER",DIALSTRING:"DIALSTRING",FEATURE_ACCESS_CODE:"FEATURE_ACCESS_CODE",SIP_URI:"SIP_URI",UNKNOWN:"UNKNOWN"}}(),function(e){"use strict";AvayaClientServices.Services.Contacts.ResolveContactsFieldType={HANDLE:"HANDLE",PHONE_NUMBER:"PHONE_NUMBER"}}(),function(e){"use strict";AvayaClientServices.Services.Contacts.SearchFieldType={NAME:"NAME",HANDLE:"HANDLE",LOGIN_ID:"LOGIN_ID",TERMINAL:"TERMINAL",ALL:"ALL"}}(),function(e){"use strict";AvayaClientServices.Services.Contacts.SearchNetworkSource={CONFERENCE_ONLY:"CONFERENCE_ONLY",ANYWHERE:"ANYWHERE"}}(),function(e){"use strict";AvayaClientServices.Services.Contacts.SearchSourceType={LOCAL:"LOCAL",NETWORK:"NETWORK",ALL:"ALL"}}(),function(e){"use strict";function t(){this._exactType1Contacts=[],this._exactType2Contacts=[],this._partialType1Contacts=[],this._allContacts=[],this._empty=!0}t.prototype={getExactType1Contacts:function(){return this._exactType1Contacts},getExactType2Contacts:function(){return this._exactType2Contacts},getPartialType1Contacts:function(){return this._partialType1Contacts},getAllContacts:function(){return this._allContacts},isEmpty:function(){return this._empty},_setExactType1Contacts:function(e){this._exactType1Contacts=e},_setExactType2Contacts:function(e){this._exactType2Contacts=e},_setPartialType1Contacts:function(e){this._partialType1Contacts=e},_setAllContacts:function(e){this._allContacts=e},_setEmpty:function(e){this._empty=e},_equals:function(e){return e&&this.empty===e.empty&&this._areArraysEqual(this._exactType1Contacts,e._exactType1Contacts)&&this._areArraysEqual(this._exactType2Contacts,e._exactType2Contacts)&&this._areArraysEqual(this._partialType1Contacts,e._partialType1Contacts)},_areArraysEqual:function(e,i){return e.length===i.length&&e.every(function(e,t){return e===i[t]})}},e.Services.Contacts.MatchedContactsWithMatchLevel=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Contacts.ResolveContactResult=function(e,t,i){this.searchString=e,this.searchScope=t,this.contacts=i}}(),function(s){"use strict";function e(e,t,i,a){this._directorySearchProvider=t,this._contactsCache=i,this._resolveContactsRequest=e,this._dataSet=new s.Base.DataSet,this._dataRetrieval=new s.Base.DataRetrieval(this._dataSet),this._uniqueSearchStrings=s.Base.Utils.removeDuplicatesFromArray(e.getSearchStrings()),this._contactsAnalyticsService=a}e.prototype={start:function(){var e=this._resolveContactsRequest.getSearchSource(),t=function(){this._dataRetrieval._dataRetrievalDone.fire()}.bind(this),i=function(e){this._dataRetrieval._dataRetrievalFailed.fire(e)}.bind(this),a=function(e){this._handleResults(e)}.bind(this);e===s.Services.Contacts.SearchSourceType.NETWORK?this._searchNetworkContacts().then(t,i,a):e===s.Services.Contacts.SearchSourceType.LOCAL?this._searchLocalContacts().then(t,i,a):this._searchAllContacts().then(t,i,a)},getDataRetrieval:function(){return this._dataRetrieval},_handleResults:function(e){var t=!1;e.forEach(function(e){e.contacts.length&&(t=!0,this._dataSet.push(e))}.bind(this)),t&&(this._dataSet.onDataSetChanged(e.slice(),s.Base.DataSetChangeTypes.ADDED),this._dataRetrieval._dataRetrievalProgress.fire(this._dataSet.length,!1))},_searchNetworkContacts:function(e){var t=e||this._uniqueSearchStrings,i=this._contactsAnalyticsService.startTimingMetric(),a=this._resolveContactsRequest.getSearchField(),r=this._directorySearchProvider.startResolvingContacts(t,a);return r.then(function(){this._contactsAnalyticsService.sendNumResolveContacts(a),this._contactsAnalyticsService.resolveContactsTimeEnd(i)}.bind(this)),r},_searchLocalContacts:function(){var e=T.Deferred(),a=this._resolveContactsRequest.getSearchField(),t=this._uniqueSearchStrings.reduce(function(e,t){var i=this._contactsCache.resolveContacts(t,a,!1);return e.push(new s.Services.Contacts.ResolveContactResult(t,a,i)),e}.bind(this),[]);return setTimeout(function(){t&&e.notify(t),e.resolve()},0),e.promise()},_searchAllContacts:function(){var t=T.Deferred(),i=[],a=function(e){e.forEach(function(e){e.contacts.length&&i.push(e.searchString)}),t.notify(e)},r=function(){var e=this._uniqueSearchStrings.filter(function(e){return-1===i.indexOf(e)});if(e.length)return this._searchNetworkContacts(e).then(function(){t.resolve()},function(e){s.Base.Logger.error(s.Base.LoggerTags.CONTACTS_SERVICE,"Network contacts quick search failed",e),t.reject(e)},function(e){a(e)});t.resolve()}.bind(this);return this._searchLocalContacts().then(r,function(e){s.Base.Logger.error(s.Base.LoggerTags.CONTACTS_SERVICE,"Local contacts quick search failed",e),r()},a),t.promise()}},s.Services.Contacts.ResolveContacts=e}(AvayaClientServices),function(a){"use strict";function e(e,t,i){this._uniqueSearchId=a.Base.Utils.makeId(16),this._searchStrings=e,this._searchField=t,this._searchSource=i}e.prototype={getUniqueSearchId:function(){return this._uniqueSearchId},_setSearchStrings:function(e){this._searchStrings=e},_setSearchField:function(e){this._searchField=e},_setSearchSource:function(e){this._searchSource=e},getSearchStrings:function(){return this._searchStrings},getSearchField:function(){return this._searchField},getSearchSource:function(){return this._searchSource}},a.Services.Contacts.ResolveContactsRequest=e}(AvayaClientServices),function(e){"use strict";function t(){this._terminalId="",this._terminalName=""}t.prototype={getTerminalId:function(){return this._terminalId},getTerminalName:function(){return this._terminalName}},e.Services.Contacts.Terminal=t}(AvayaClientServices),function(e){"use strict";function t(e){this._attachmentBuilder=e}t.prototype={_resizeImage:function(e,t){var i,a,r=document.createElement("canvas");return i=t.scale?(a=e.width*t.scale,e.height*t.scale):t.width&&!t.height?(a=t.width,parseInt(t.width*e.height/e.width)):t.height&&!t.width?(a=parseInt(t.height*e.width/e.height),t.height):(a=e.width,e.height),r.height=i,r.width=a,r.getContext("2d").drawImage(e,0,0,a,i),r.toDataURL("image/jpeg")},create:function(){}},e.Services.Messaging.AbstractThumbnailCreator=t}(AvayaClientServices),function(a){"use strict";function e(e){this._thumbnailCreator=e}e.prototype={build:function(e,t){var i=new a.Services.Messaging.Attachment(this._thumbnailCreator);return e=e||{},i.disposition=e.disposition,i.duration=e.duration,i.mimeType=e.mimeType,i.id=e.partId,i.location=e.location||e.media,i.size=e.size,i.name=i.getName(),i.file=t,i.status=e.status||a.Services.Messaging.ResourceStatus.PUBLISHED,this._recalculateCapabilities(i),i},update:function(e,t){t.thumbnail&&(e.thumbnail.location=t.thumbnail.location),e.id=t.partId,e.location=t.location||t.media,e.duration!==t.duration&&(e.duration=t.duration,e._onDurationChangedCallbacks.fire(e,t.duration)),e.status!==a.Services.Messaging.ResourceStatus.PUBLISHED&&(e.status=a.Services.Messaging.ResourceStatus.PUBLISHED,e._onStatusChangedCallbacks.fire(e,a.Services.Messaging.ResourceStatus.PUBLISHED)),e.file&&(e.file=m)},_recalculateCapabilities:function(e){e._recalculateUpdateNameCapability(),e._recalculateUpdateMimeTypeCapability(),e._recalculateUpdateDurationCapability(),e._recalculateUpdateIsSelfGeneratedCapability(),e._recalculateCreateThumbnailCapability(),e._recalculateRemoveThumbnailCapability(),e._recalculateRemoveCapability()}},a.Services.Messaging.AttachmentBuilder=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Messaging.AttachmentStatus={READY_TO_DOWNLOAD:"READY_TO_DOWNLOAD",DOWNLOADING:"DOWNLOADING",READY_TO_CONSUME:"READY_TO_CONSUME",CONSUMED:"CONSUMED",ERROR:"ERROR"}}(),function(e){"use strict";AvayaClientServices.Services.Messaging.AttachmentType={MAIN:"MAIN",THUMBNAIL:"THUMBNAIL"}}(),function(e){"use strict";function t(e,t){this.action=e&&e.action||"typing",this.participant=t,this.state=e&&e.state||"paused",this.timestamp=e?e.timestamp:m}t.prototype={getAction:function(){return this.action},getParticipant:function(){return this.participant},getState:function(){return this.state},getTimestamp:function(){return this.timestamp}},e.Services.Messaging.ChatStateEvent=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Messaging.ConversationType={THREAD:"THREAD"}}(),function(e){"use strict";AvayaClientServices.Services.Messaging.MessageImportance={HIGH:"HIGH",LOW:"LOW",NORMAL:"NORMAL"}}(),function(e){"use strict";AvayaClientServices.Services.Messaging.MessageType={MESSAGE:"MESSAGE",JOINED:"JOINED",LEFT:"LEFT",SESSION:"SESSION",SUBJECT_CHANGE:"SUBJECT_CHANGE",CLOSED:"CLOSED",START:"START"}}(),function(i){"use strict";function e(e,t){i.Base.BaseError.call(this,e,t),this.name="MessagingError",this.message=e}e.prototype=Object.create(i.Base.BaseError.prototype),i.Services.Messaging.MessagingError=e}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Messaging.MessagingErrorReason={MESSAGING_NOTIFICATIONS_DISABLED:"Notification channel is disabled.",MESSAGING_CLOSE_FAILED:"Server failed to be closed.",MESSAGING_SEND_ATTACHMENT_FAILED:"Failed to send attachment.",MESSAGING_FEATURE_NOT_AVAILABLE:"Feature is not available in determined server version.",MESSAGING_SERVER_ERROR:"Action failed due to server error.",MESSAGING_NOTIFICATION_FAILED:"Notification failed.",MESSAGING_PARTICIPANT_ADDRESS_INVALID:"Failed to add Participant to Conversation.",MESSAGING_LEAVE_CONVERSATION_FAILED:"Failed to leave one or more conversations.",MESSAGING_NOT_STARTED:"Failed to perform selected action. Messaging is not started.",MESSAGING_CREATE_ATTACHMENT_FAILED:"Failed to create attachment. Internal browser error.",MESSAGING_BODY_LENGTH_EXCEEDED:"Failed to send message. Maximum message body length exceeded.",MESSAGING_SUBJECT_LENGTH_EXCEEDED:"Failed to send message. Maximum message subject length exceeded.",MESSAGING_INVALID_STATE:"Invalid state.",MESSAGING_NOTIFICATIONS_CHANNEL_FAILED:"Start notification channel failed.",MESSAGING_INTERNAL_ERROR:"An internal error occurred.",MESSAGING_TIMEOUT:"An operation has timed out"}}(),function(e){"use strict";function t(){this._searchBody=!1,this._searchParticipants=!1,this._searchSubject=!1,this._resultsPerConversation=0,this._query="",this._after=m}t.prototype={isSearchParticipants:function(){return this._searchParticipants},isSearchSubject:function(){return this._searchSubject},isSearchBody:function(){return this._searchBody},getQueryAfter:function(){return this._after},getQuery:function(){return this._query},getNumberResultsPerConversation:function(){return this._resultsPerConversation},searchParticipants:function(e){this._searchParticipants=e},searchSubject:function(e){this._searchSubject=e},searchBody:function(e){this._searchBody=e},setQueryAfter:function(e){this._after=e},setQuery:function(e){this._query=e.toLowerCase()},setNumberResultsPerConversation:function(e){this._resultsPerConversation=e}},e.Services.Messaging.MessagingQuery=t}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Messaging.ResourceStatus={DRAFT_UNSENT:"DRAFT_UNSENT",DRAFT_SENDING:"DRAFT_SENDING",DRAFT_REMOVING:"DRAFT_REMOVING",DRAFT_ERROR:"DRAFT_ERROR",PUBLISHED:"PUBLISHED",PUBLISHED_LEAVING:"PUBLISHED_LEAVING",PUBLISHED_LEFT:"PUBLISHED_LEFT"}}(),function(e){"use strict";AvayaClientServices.Services.Messaging.SensitivityLevel={NORMAL:"NORMAL",PERSONAL:"PERSONAL",PRIVATE:"PRIVATE",CONFIDENTIAL:"CONFIDENTIAL"}}(),function(e){"use strict";AvayaClientServices.Services.Messaging.SessionType={AUDIO:"AUDIO",VIDEO:"VIDEO"}}(),function(e){"use strict";function t(e){this._href=e&&e.href||"",this._id=e&&e.id||"",this._lastAccessedTime=e&&e.lastAccessedTime||"",this._lastUpdated=e&&e.lastUpdated||""}t.prototype={getHref:function(){return this._href},getId:function(){return this._id},getLastAccessedTime:function(){return this._lastAccessedTime},getLastUpdatedTime:function(){return this._lastUpdated}},e.Services.Messaging.ConversationId=t}(AvayaClientServices),function(h){"use strict";function e(e,t,i,a,r,s,n){this._provider=e,this._messageService=t,this._participantsService=i,this._escalationService=a,this._messageBuilder=r,this._messagingService=m,this._conversationBuilder=s,this._messagingAnalyticsService=n}e.prototype={getParticipants:function(e,t,i){return e.participants},createMessage:function(a){var e={subject:a.subject,threadId:a.id,to:a.participants,event:{type:h.Services.Messaging.MessageType.MESSAGE},resourceStatus:h.Services.Messaging.ResourceStatus.DRAFT_UNSENT,flags:{sensitivity:a.getSensitivity()}},r=this._messageBuilder.build(e,this._participantsService.getSelfParticipant(),this._messageService,a);return this._provider.on(h.Providers.AMM.ProviderStates.AVAILABLE,function(){this._messageService._recalculateAllMessageCapabilities(r)}.bind(this)),this._provider.on(h.Providers.AMM.ProviderStates.UNAVAILABLE,function(){this._messageService._recalculateAllMessageCapabilities(r)}.bind(this)),a._getLastMessage()&&(r.coalesced=this._messageBuilder.isMessageCoalesced(r,a._getLastMessage())),r.addOnStatusChangedCallback(function(e,t){if(t===h.Services.Messaging.ResourceStatus.PUBLISHED){var i=a._draftMessages.indexOf(e);a._draftMessages.splice(i,1),a.getStatus()===h.Services.Messaging.ResourceStatus.DRAFT_SENDING&&(a.id=e.threadId,a.getParticipants(),a._setStatus(h.Services.Messaging.ResourceStatus.PUBLISHED))}else t===h.Services.Messaging.ResourceStatus.DRAFT_ERROR?(a.getStatus()===h.Services.Messaging.ResourceStatus.DRAFT_SENDING&&a._setStatus(h.Services.Messaging.ResourceStatus.DRAFT_ERROR),a.messages.onDataSetChanged([r],h.Base.DataSetChangeTypes.UPDATED)):t===h.Services.Messaging.ResourceStatus.DRAFT_SENDING&&(a.getStatus()===h.Services.Messaging.ResourceStatus.DRAFT_UNSENT&&a._setStatus(h.Services.Messaging.ResourceStatus.DRAFT_SENDING),a._onMessagesAddedCallbacks.fire(a,[r]),a.messages.onDataSetChanged([r],h.Base.DataSetChangeTypes.UPDATED));this._messageService._recalculateAllMessageCapabilities(r)}.bind(this)),a._draftMessages.push(r),a.messages.unshift(r),r},getMessageById:function(e,t){for(var i=0;i<e.length;i++)if(e[i].id===t)return e[i]},createNewClientMessage:function(e,t){return this._messageBuilder.build(e,this._participantsService.getOrCreateParticipant(e.from),this._messageService,t)},leave:function(t){var i=T.Deferred();return h.Base.Utils.isDefined(t.id)?this._provider.leaveConversation(t.id).then(function(){var e=this._messagingService.conversations.indexOf(t);0<=e&&(this._messagingService.conversations.splice(e,1),this._messagingService.conversations.onDataSetChanged([t],h.Base.DataSetChangeTypes.REMOVED)),i.resolve(!0)}.bind(this),function(e){i.reject(e)}):i.reject(new h.Services.Messaging.MessagingError(h.Services.Messaging.MessagingErrorReason.MESSAGING_LEAVE_CONVERSATION_FAILED)),i.promise()},changeSubject:function(e,t){for(var i={threadId:e.id,body:"",event:{type:"SUBJECT_CHANGE"},subject:t,to:[]},a=e.getParticipants(),r=0;r<a.length;r++)i.to.push({address:a[r].getAddress(),type:a[r].getType()});return this._provider.changeSubject(i)},getOtherMessages:function(e,t,i,a){var r=new h.Base.DataRetrieval,s=r.getDataSet(),n=this._provider.getMaxMessageCount();if(i&&n<i)this._getMoreOtherMessages(e,t,i,a,n,r);else{var o={cancel:function(){}};this._provider.getMessages(o,a.getId(),i,e,t).done(function(e){var t;0<a.getMessages().length&&(t=this._conversationBuilder.update(a,e,this),s.push(t),s.onDataSetChanged(t,h.Base.DataSetChangeTypes.ADDED),r._dataRetrievalProgress.fire(t.length,!0,t.length),r.isCompleted=!0,r._dataRetrievalDone.fire())}.bind(this)).fail(function(e){r._dataRetrievalFailed.fire(e)}),r._onCancel=function(){o.cancel()}}return r},_getMoreOtherMessages:function(e,t,i,a,n,o){var c=[],l={},d=o.getDataSet(),C=0,u=Math.floor(i/n),v=i%n;v&&(u+=1);for(var r=function(t,i,a,r){if(!o.isCancelled&&!o.isCompleted){var s,e={cancel:function(){}};this._provider.getMessages(e,r.id,a,t,i).done(function(e){0===C?l=e:l.messages=l.messages.concat(e.messages),t?t=e.messages[e.messages.length-1]:i=e.messages[e.messages.length-1],(C+=1)<u&&e.messages.length===n?(C===u-1&&v?c[C](t,i,v,r):c[C](t,i,a,r),s=this._conversationBuilder.updateMessages(r,l,this),d.push(s),d.onDataSetChanged(s,h.Base.DataSetChangeTypes.ADDED),o._dataRetrievalProgress.fire(e.messages.length,!1)):(s=this._conversationBuilder.updateMessages(r,l,this),d.push(s),d.onDataSetChanged(s,h.Base.DataSetChangeTypes.ADDED),o._dataRetrievalProgress.fire(e.messages.length,!1),o.isCompleted=!0,o._dataRetrievalDone.fire())}.bind(this)).fail(function(e){o._dataRetrievalFailed.fire(e)}),o._onCancel=function(){e.cancel()}}}.bind(this),s=0;s<u;s++)c.push(r);c[0](e,t,m,a)},markAllAsRead:function(e){return this._provider.markAllAsRead(e.id)},markMultipleAsRead:function(e,t,i){return this._provider.markAllAsRead(e.id,t,i)},removeMessage:function(e,t,i){var a=T.Deferred();if(i)if(i.getRemoveCapability().isAllowed){var r=e.indexOf(i);0<=r&&(e.splice(r,1),e.onDataSetChanged([i],h.Base.DataSetChangeTypes.REMOVED)),0<=(r=t.indexOf(i))&&t.splice(r,1),a.resolve()}else a.reject(i.getRemoveCapability().denialReason);else a.reject();return a.promise()},createEscalation:function(a){var e={type:h.Services.Messaging.MessageType.SESSION,extensions:{},conversation:a},r=new h.Services.Messaging.Escalation(e,this._escalationService);return this._provider.on(h.Providers.AMM.ProviderStates.AVAILABLE,function(){this._escalationService._recalculateAllEscalationCapabilities(r)}.bind(this)),this._provider.on(h.Providers.AMM.ProviderStates.UNAVAILABLE,function(){this._escalationService._recalculateAllEscalationCapabilities(r)}.bind(this)),r.addParticipants(this.getParticipants(a)),r._setStatus(h.Services.Messaging.ResourceStatus.DRAFT_UNSENT),r.addOnStatusChangedCallback(function(e,t){if(t===h.Services.Messaging.ResourceStatus.PUBLISHED){var i=a._draftEscalations.indexOf(e);a._draftEscalations.splice(i,1)}else t===h.Services.Messaging.ResourceStatus.DRAFT_ERROR&&a.getStatus()===h.Services.Messaging.ResourceStatus.DRAFT_SENDING?a._setStatus(h.Services.Messaging.ResourceStatus.DRAFT_ERROR):t===h.Services.Messaging.ResourceStatus.DRAFT_SENDING&&a.getStatus()===h.Services.Messaging.ResourceStatus.DRAFT_UNSENT&&a._setStatus(h.Services.Messaging.ResourceStatus.DRAFT_SENDING);this._escalationService._recalculateAllEscalationCapabilities(r)}.bind(this)),r},removeEscalation:function(e,t){var i=T.Deferred();if(e)if(e.getRemoveCapability().isAllowed){var a=t.indexOf(e);0<=a&&t.splice(a,1),i.resolve()}else i.reject(e.getRemoveCapability().denialReason);else i.reject();return i.promise()},addParticipantAddresses:function(s,e){var n=T.Deferred();h.Base.Utils.clean(e,"");var t=T.map(s.getActiveParticipants(),function(e,t){return e.getAddress()}),i=e.filter(function(e){return-1===t.indexOf(e)}),o=e.filter(function(e){return-1!==t.indexOf(e)}),a=function(e){var t=[];if(s.getStatus()===h.Services.Messaging.ResourceStatus.PUBLISHED){for(var i={participants:[]},a=0;a<e.length;a++)i.participants.push({address:e[a]._address,type:"CONTACT"}),t.push(e[a]._address);this._provider.addParticipantsToConversation(s.getId(),i).then(function(e){this._updateParticipantsList(s,e.participants),n.resolve(t)}.bind(this),function(e){n.reject(e)})}else if(s.getStatus()===h.Services.Messaging.ResourceStatus.DRAFT_UNSENT){for(var r=0;r<e.length;r++)t.push(e[r]._address);this._updateParticipantsList(s,e),n.resolve(t)}}.bind(this),r=function(e,t){if(t&&0<t.length){for(var i=[],a={participants:[]},r=0;r<t.length;r++)a.participants.push({address:t[r]._address,type:t[r].type}),i.push(t[r]._address);s.getStatus()===h.Services.Messaging.ResourceStatus.PUBLISHED?this._provider.addParticipantsToConversation(s.getId(),a).then(function(e){this._updateParticipantsList(s,e.participants),n.resolve(i)}.bind(this),function(e){n.reject(e)}):s.getStatus()===h.Services.Messaging.ResourceStatus.DRAFT_UNSENT&&(this._updateParticipantsList(s,t),n.resolve(i))}else e._data=e.getData().concat(o),n.reject(e)}.bind(this);return this.validateUsers(i).then(a,r.bind(this)),n.promise()},validateUsers:function(e){var t,i,a,r=T.Deferred(),s=this._provider.getRoutableDomains(),n=[],o=[];for(var c=0;c<e.length;c++){if(i=t=!1,a=e[c],/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(a)){t=!0;for(var l=0;l<s.length;l++)if(null!==e[c].match(s[l])){n.push(e[c]),i=!0;break}i||0}t&&i||(o.push(e[c]),h.Base.Logger.debug(h.Base.LoggerTags.MESSAGING_SERVICE,"Invalid address email:",e[c]))}if(0<n.length){var d=this._messagingAnalyticsService.startTimingMetric();this._provider.validateUsers(n).then(function(e){this._messagingAnalyticsService.trackTimeRequestsValidateAddressesEnd(d);for(var t=[],i=0;i<e.validatedAddresses.length;i++)0<e.validatedAddresses[i].addresses.length?t.push(e.validatedAddresses[i].addresses[0]):o.push(e.validatedAddresses[i].query);0<o.length?r.reject(new h.Services.Messaging.MessagingError(h.Services.Messaging.MessagingErrorReason.MESSAGING_PARTICIPANT_ADDRESS_INVALID,o),t):r.resolve(t)}.bind(this),function(e){var t=h.Services.Messaging.MessagingErrorReason.MESSAGING_SERVER_ERROR;this._messagingAnalyticsService.trackErrorsResponseValidateAddresses(t),r.reject(new h.Services.Messaging.MessagingError(t,e))}.bind(this))}else r.reject(new h.Services.Messaging.MessagingError(h.Services.Messaging.MessagingErrorReason.MESSAGING_PARTICIPANT_ADDRESS_INVALID,o));return r.promise()},addParticipants:function(e,t){for(var i=[],a=0;a<t.length;a++)i.push(t[a].address);return this.addParticipantAddresses(e,i)},_updateParticipantsList:function(e,t){for(var i,a=[],r=[],s=0;s<t.length;s++){i=!0;for(var n=0;n<e.participants.length;n++)if(t[s]._address===e.participants[n]._address){i=!1;break}if(i){var o=this._participantsService.getOrCreateParticipant(t[s]);a.push(o),e.participants.push(o),r.push(o)}}return 0<r.length&&(e.participants.onDataSetChanged(r,h.Base.DataSetChangeTypes.ADDED),e._onParticipantsAddedCallbacks.fire(e,r)),e.participants},getParticipantsFromMessage:function(e){for(var t=new h.Base.DataSet,i=0;i<e.to.length;i++){var a=this._participantsService.getOrCreateParticipant(e.to[i]);t.push(a)}if(h.Base.Utils.isDefined(e.event)&&e.event.type===h.Services.Messaging.MessageType.LEFT)for(var r=0;r<e.event.participants.length;r++){var s=this._participantsService.getOrCreateParticipant(e.event.participants[r]),n=t.indexOf(s);t.splice(n,1)}return t},removeParticipantAddresses:function(e,t){var i=T.Deferred(),a=!1,r=[];if(h.Base.Utils.clean(t,""),e.getStatus()===h.Services.Messaging.ResourceStatus.DRAFT_UNSENT){for(var s=0;s<t.length;s++)for(var n=e.participants.length-1;0<=n;n--)if(e.participants[n]._address===t[s]){r.push(e.participants.splice(n,1)[0]),a=!0;break}a&&(e.participants.onDataSetChanged(r,h.Base.DataSetChangeTypes.REMOVED),e._onParticipantsRemovedCallbacks.fire(e,r)),i.resolve()}else i.reject("Could not remove participants");return i.promise()},removeParticipants:function(e,t){for(var i=[],a=0;a<t.length;a++)i.push(t[a].address);return this.removeParticipantAddresses(e,i)},close:function(t){return this._provider.close(t.id).then(function(e){return t.closed=!0,t._onClosedStatusChangedCallbacks.fire(t,t.closed),e}.bind(this))},setLastAccessTime:function(e){this._provider.setLastAccessTime(e.id,{}).then(function(){e._onLastAccessTimeChangedCallbacks.fire(e,e.lastAccessTime)})},subscribeForTypingEvents:function(i,a){var e=function(e){if(a){var t=new h.Services.Messaging.ChatStateEvent(e,this._participantsService._getParticipant(e.address));a(t)}"composing"===e.state?this.addComposingParticipantToConversation(i,this._participantsService._getParticipant(e.address)):"paused"===e.state&&this.removeComposingParticipantFromConversation(i,this._participantsService._getParticipant(e.address))}.bind(this);return this._provider.subscribeForTypingEventsInConversation(i.getId(),e).then(function(e){return i._isSubscribed=!0,this._recalculateAllConversationCapabilities(i),e}.bind(this))},unsubscribeForTypingEvents:function(t){return this._provider.unsubscribeForTypingEventsInConversation(t.getId()).then(function(e){return t._isSubscribed=!1,this._recalculateAllConversationCapabilities(t),e}.bind(this))},reportTyping:function(e,t){var i=this._participantsService.getSelfParticipant();t?this._provider.reportTyping(e.threadId,t).then(function(){this.addComposingParticipantToConversation(e.conversation,i)}.bind(this),function(e){h.Base.Logger.error(h.Base.LoggerTags.MESSAGING_SERVICE,"Error on report typing: ",e)}.bind(this)):this._provider.reportTyping(e.conversation.id,t).then(function(){this.removeComposingParticipantFromConversation(e.conversation,i)}.bind(this),function(e){h.Base.Logger.error(h.Base.LoggerTags.MESSAGING_SERVICE,"Error on report paused typing: ",e)}.bind(this))},reportCustomChatNotification:function(t,e,i){var a=this._participantsService.getSelfParticipant();return i?this._provider.reportCustomChatNotification(t.getId(),e,i).then(function(e){return this.addComposingParticipantToConversation(t,a),e}.bind(this),function(e){return h.Base.Logger.error(h.Base.LoggerTags.MESSAGING_SERVICE,"Error on report custom chat notification: ",e),T.Deferred().reject(e).promise()}.bind(this)):this._provider.reportCustomChatNotification(t.getId(),e,i).then(function(e){return this.removeComposingParticipantFromConversation(t,a),e}.bind(this),function(e){return h.Base.Logger.error(h.Base.LoggerTags.MESSAGING_SERVICE,"Error on report pause custom chat notification: ",e),T.Deferred().reject(e).promise()}.bind(this))},addComposingParticipantToConversation:function(e,t){e.getComposingParticipants().indexOf(t)<0&&(e.composingParticipants.push(t),e._onIsComposingStatusChangedCallbacks.fire(e,!0))},removeComposingParticipantFromConversation:function(e,t){var i=e.composingParticipants.indexOf(t);0<=i&&(e.composingParticipants.splice(i,1),e._onIsComposingStatusChangedCallbacks.fire(e,!0))},isOpened:function(){return this._provider.isOpened()},isServiceAvailable:function(){return this._provider.isAvailable()},getMaxMessageCount:function(){return this._provider.getMaxMessageCount()},_recalculateAllConversationCapabilities:function(e){e._recalculateUpdateSubjectCapability(),e._recalculateUpdateLastAccessTimeCapability(),e._recalculateUpdateSensitivityCapability(),e._recalculateOlderContentCapability(),e._recalculateAddParticipantsCapability(),e._recalculateRemoveParticipantsCapability(),e._recalculateCreateMessageCapability(),e._recalculateCreateEscalationCapability(),e._recalculateMarkAllContentAsReadCapability(),e._recalculateLeaveCapability(),e._recalculateRemoveCapability(),e._recalculateStartCapability(),e._recalculateIsTypingCapability()},isUpdateSubjectSupported:function(){return this._provider.isUpdateSubjectSupported()},isMarkAllContentAsReadSupported:function(){return this._provider.isMarkAllContentAsReadSupported()},getNumberOfMessagesWithUnreadContentSinceLastAccess:function(t){var e=t.getMessages();return t.getLastAccessTime().getTime()?e.filter(function(e){return!e.isRead()&&e.getReceivedDate()>t.getLastAccessTime()}).length:e.length}},h.Services.Messaging.ConversationService=e}(AvayaClientServices),function(c){"use strict";function e(e){this._provider=e}e.prototype={start:function(t){for(var e={extensions:t.extensions,sessionType:t.sessionType||c.Services.Messaging.SessionType.AUDIO,type:t.type,participants:[]},i=0;i<t.participants.length;i++)e.participants.push({address:t.participants[i]._address});return t._setStatus(c.Services.Messaging.ResourceStatus.DRAFT_SENDING),this._provider.callEscalationEvent(e,t.conversation.id).then(function(e){return t._setStatus(c.Services.Messaging.ResourceStatus.PUBLISHED),this._recalculateAllEscalationCapabilities(t),t._onStartSuccessCallbacks.fire(t),e}.bind(this),function(e){this._recalculateAllEscalationCapabilities(t),t._onStartFailedCallbacks.fire(t,e)}.bind(this))},addParticipantAddresses:function(e,t){var i=T.Deferred(),a=this._provider.getRoutableDomains();if(e.getAddParticipantsCapability().isAllowed){for(var r=[],s=0;s<t.length;s++)for(var n=0;n<a.length;n++)if(null!==t[s].match(a[n])){var o={_address:t[s]};e.participants.push(o),r.push(o)}0<r.length&&e.participants.onDataSetChanged(r,c.Base.DataSetChangeTypes.ADDED),i.resolve(e)}else i.reject(e.getAddParticipantsCapability().denialReason);return i.promise()},addParticipants:function(e,t){var i=T.Deferred();if(e.getAddParticipantsCapability().isAllowed){for(var a=!1,r=0;r<t.length;r++)e.participants.push(t[r]),a=!0;a&&e.participants.onDataSetChanged(t,c.Base.DataSetChangeTypes.ADDED),i.resolve(e)}else i.reject(e.getAddParticipantsCapability().denialReason);return i.promise()},removeParticipantAddresses:function(e,t){var i=T.Deferred();if(e.getRemoveParticipantsCapability().isAllowed){for(var a=[],r=e.participants.length-1;0<=r;r--)for(var s=t.length-1;0<=s;s--)if(e.participants[r]._address===t[s]){a.push(e.participants[r]),e.participants.splice(r,1),t.splice(s,1);break}0<a.length&&e.participants.onDataSetChanged(a,c.Base.DataSetChangeTypes.REMOVED),i.resolve(e)}else i.reject(e.getRemoveParticipantsCapability().denialReason);return i.promise()},removeParticipants:function(e,t){var i=T.Deferred(),a=[];if(e.getRemoveParticipantsCapability().isAllowed){for(var r=e.participants.length-1;0<=r;r--)for(var s=t.length-1;0<=s;s--)if(e.participants[r]._address===t[s]._address){a.push(e.participants[r]),e.participants.splice(r,1),t.splice(s,1);break}0<a.length&&e.participants.onDataSetChanged(a,c.Base.DataSetChangeTypes.REMOVED),i.resolve(e)}else i.reject(e.getRemoveParticipantsCapability().denialReason);return i.promise()},setSessionType:function(e,t){if(!c.Base.Utils.isDefined(c.Services.Messaging.SessionType[t]))throw e._onSessionTypeChangedFailedCallbacks.fire(this,t),new Error("Unknown Session type");e.sessionType=t,e._onSessionTypeChangedSuccessCallbacks.fire(this,t)},isServiceAvailable:function(){return this._provider.isAvailable()},_recalculateAllEscalationCapabilities:function(e){e._recalculateStartCapability(),e._recalculateAddParticipantsCapability(),e._recalculateRemoveParticipantsCapability(),e._recalculateUpdateSessionTypeCapability(),e._recalculateRemoveCapability()}},c.Services.Messaging.EscalationService=e}(AvayaClientServices),function(t){"use strict";function e(e){t.Services.Messaging.AbstractThumbnailCreator.call(this,e)}(e.prototype=Object.create(t.Services.Messaging.AbstractThumbnailCreator.prototype)).create=function(i,a){var r=T.Deferred(),s={disposition:i.disposition.replace("attachment","inline"),mimeType:"image/jpeg",status:i.status},e=new FileReader;return e.onloadend=function(){var t=new Image;t.src=e.result,t.onload=function(){var e=new Blob([this._resizeImage(t,a)],{type:"image/jpeg"});s.size=e.size,i.thumbnail=this._attachmentBuilder.build(s,e),r.resolve(i.thumbnail)}.bind(this)}.bind(this),e.onerror=function(e){r.reject(e)}.bind(this),e.readAsDataURL(i.file),r.promise()},t.Services.Messaging.ImageThumbnailCreator=e}(AvayaClientServices),function(n){"use strict";function e(e,t){this._attachmentBuilder=e,this._participantService=t}e.prototype={build:function(e,t,i,a){var r=new n.Services.Messaging.Message(i,a);if(r.resourceStatus=e.resourceStatus||n.Services.Messaging.ResourceStatus.PUBLISHED,r.body=e.body,n.Base.Utils.isDefined(e.htmlBody)&&(r.htmlBody=e.htmlBody),e.event&&(r.type=e.event.type,r.eventRelatedParticipants=e.event.participants,r._sessionType=e.event.sessionType),e.flags&&(r.sensitivity=e.flags.sensitivity,r.importance=e.flags.importance,r.read=e.flags.read,r.doNotForward=e.flags.doNotForward),r.from=t,r.inReplyTo=e.inReplyTo,r.href=e.href,r.id=e.id,r.lastModifiedDate=e.lastModifiedDate?new Date(e.lastModifiedDate):new Date,r.receivedDate=new Date(e.receivedDate),r.subject=e.subject,r.threadId=e.threadId,r.to=[],e.to&&e.to.forEach&&(e.to.forEach(function(e){r.to.push(this._participantService.getOrCreateParticipant(e))}.bind(this)),a._updateParticipantsList(r.to)),e.parts){var s=[];e.parts.forEach(function(e){s.push(this._attachmentBuilder.build(e))}.bind(this)),r.parts=this.pairThumbnailsAndAttachments(s)}return i._recalculateAllMessageCapabilities(r),r},update:function(i,e){i.body!==e.body&&(i.body=e.body,i._onBodyChangedCallbacks.fire(i,i.body)),i.type!==e.event.type&&(i.type=e.event.type,i._onTypeChangedCallbacks.fire(i,i.type)),i.doNotForward!==e.flags.doNotForward&&(i.doNotForward=e.flags.doNotForward,i._onDoNotForwardStatusChangedCallbacks.fire(i,i.doNotForward)),i.importance!==e.flags.importance&&(i.importance=e.flags.importance,i._onImportanceChangedCallbacks.fire(i,i.importance)),i.sensitivity!==e.flags.sensitivity&&(i.sensitivity=e.flags.sensitivity,i._onSensitivityChangedCallbacks.fire(i,i.sensitivity)),i.read!==e.flags.read&&(i.read=e.flags.read,i._onIsReadStatusChangedCallbacks.fire(i,i.read)),i.href!==e.href&&(i.href=e.href);var t=new Date(e.lastModifiedDate);i.lastModifiedDate&&i.lastModifiedDate.toISOString()===t.toISOString()||(i.lastModifiedDate=t,i._onLastModifiedDateChangedCallbacks.fire(i,t)),t=new Date(e.receivedDate),i.receivedDate&&"Invalid Date"!==i.receivedDate.toString()&&i.receivedDate.toISOString()===t.toISOString()||(i.receivedDate=t),i.subject!==e.subject&&(i.subject=e.subject),i.id!==e.id&&(i.id=e.id),i.threadId!==e.threadId&&(i.threadId=e.threadId),i.getInReplyTo()!==e.inReplyTo&&(i.inReplyTo=e.inReplyTo,i._onInReplyToChangedCallbacks(i,i.getInReplyTo()));var a=[];e.parts.forEach(function(e){a.push(this._attachmentBuilder.build(e))}.bind(this)),this.pairThumbnailsAndAttachments(a).forEach(function(t){var e=i.parts.filter(function(e){return e.disposition===t.disposition})[0];e&&this._attachmentBuilder.update(e,t)}.bind(this)),0<i._attachments.length&&i._attachments.splice(0,i._attachments.length)},isMessageCoalesced:function(e,t){if(null===e||e===m)return!1;if(null===t||t===m)return!1;if(e.getStatus()===n.Services.Messaging.ResourceStatus.DRAFT_ERROR)return!1;if(t.getStatus()===n.Services.Messaging.ResourceStatus.DRAFT_ERROR)return!1;if(e.getFromParticipant()!==m&&e.getFromParticipant().getAddress()!==t.getFromParticipant().getAddress())return!1;if(e.hasAttachment())return!1;if(e.getType()===n.Services.Messaging.MessageType.JOINED||e.getType()===n.Services.Messaging.MessageType.LEFT||e.getType()===n.Services.Messaging.MessageType.CLOSED||e.getType()===n.Services.Messaging.MessageType.START)return!1;if(t.getType()===n.Services.Messaging.MessageType.JOINED||t.getType()===n.Services.Messaging.MessageType.LEFT||t.getType()===n.Services.Messaging.MessageType.CLOSED||t.getType()===n.Services.Messaging.MessageType.START)return!1;if(e.getSensitivity()!==t.getSensitivity())return!1;if(t.hasAttachment())return!1;if(e.getReceivedDate()<t.getReceivedDate())return!1;var i=e.getReceivedDate()-t.getReceivedDate();return!(isNaN(i)||6e4<i)},pairThumbnailsAndAttachments:function(e){var t,i={},a=[],r=function(t){return function(e){return e.getName()===t}};for(t=0;t<e.length;t++)i[e[t].getName()]=e.filter(r(e[t].getName()));for(var s in i)if(i.hasOwnProperty(s))if(2===i[s].length){var n=i[s][0]._isThumbnail()?i[s][0]:i[s][1],o=i[s][0]._isThumbnail()?i[s][1]:i[s][0];o.thumbnail=n,a.push(o)}else for(t=0;t<i[s].length;t++)a.push(i[s][t]);return a}},n.Services.Messaging.MessageBuilder=e}(AvayaClientServices),function(n){"use strict";function e(e,t,i,a){this._provider=e,this._attachmentBuilder=i,this._messageBuilder=t,this._messagesToRead=[],this._promises=[],this._messagingAnalyticsService=a}e.prototype={_prepareMessage:function(e){var t={body:e.getBody(),subject:e.subject,threadId:e.threadId,flags:{sensitivity:e.getSensitivity(),importance:e.getImportance()},to:[]};n.Base.Utils.isUndefined(e.inReplyTo)||(t.inReplyTo=e.inReplyTo);for(var i=e.conversation.getParticipants(),a=0;a<i.length;a++)t.to.push({address:i[a].getAddress(),type:i[a].type});return t},send:function(a){var e=T.Deferred();if(a.subject.length>this._provider.getMaxSubjectLength())return e.reject(new n.Services.Messaging.MessagingError(n.Services.Messaging.MessagingErrorReason.MESSAGING_SUBJECT_LENGTH_EXCEEDED)),e.promise();if(a.getBody().length>this._provider.getMaxTextLength())return e.reject(new n.Services.Messaging.MessagingError(n.Services.Messaging.MessagingErrorReason.MESSAGING_BODY_LENGTH_EXCEEDED)),e.promise();var r=this._messagingAnalyticsService.startTimingMetric();a.conversation.getStatus()===n.Services.Messaging.ResourceStatus.DRAFT_UNSENT&&(a.subject=a.conversation.getSubject());var t=this._prepareMessage(a),i=function(e){this._messagingAnalyticsService.trackTimeRequestsSendMessageEnd(r),this._messageBuilder.update(a,e),a.lastModifiedDate=new Date,a._setStatus(n.Services.Messaging.ResourceStatus.PUBLISHED),this._recalculateAllMessageCapabilities(a);var t=a.getAttachments().length;0<t&&a.getAttachments().forEach(function(e){e._setStatus(n.Services.Messaging.ResourceStatus.PUBLISHED),this._messagingAnalyticsService.trackMessageAttachmentSize(e.size,e.mimeType)}.bind(this));var i=a.getBody().length;return this._messagingAnalyticsService.trackNumMessagesSent(i,t),a},s=function(e){return this._messagingAnalyticsService.trackErrorsResponseSendMessage(n.Services.Analytics.AnalyticsErrorCode.MESSAGE_SENDING_ERROR),a._setStatus(n.Services.Messaging.ResourceStatus.DRAFT_ERROR),this._recalculateAllMessageCapabilities(a),0<a.getAttachments().length&&a.getAttachments().forEach(function(e){e._setStatus(n.Services.Messaging.ResourceStatus.DRAFT_ERROR)}.bind(this)),T.Deferred().reject(e).promise()};return e=0<a.getAttachments().length?(a.getAttachments().forEach(function(e){e._setStatus(n.Services.Messaging.ResourceStatus.DRAFT_SENDING)}.bind(this)),this._provider.sendMessageWithAttachments(t,a.getAttachments()).then(i.bind(this),s.bind(this))):this._provider.sendMessage(t).then(i.bind(this),s.bind(this)),a._setStatus(n.Services.Messaging.ResourceStatus.DRAFT_SENDING),e},getPartById:function(e,t){return e.filter(function(e){return e.id===t})[0]},markAsRead:function(e){var t=T.Deferred();return 0===this._messagesToRead.length&&setTimeout(function(){var t=[];this._messagesToRead.forEach(function(e){t.push(e.id)}),this._provider.markAsReadBatch(t).then(function(t){this._messagesToRead.forEach(function(e){e._recalculateMarkAsReadCapability()}),this._promises.forEach(function(e){e.resolve(t)}),this._messagesToRead=[],this._promises=[]}.bind(this),function(t){this._messagesToRead.forEach(function(e){e._recalculateMarkAsReadCapability()}),this._promises.forEach(function(e){e.reject(t)}),this._messagesToRead=[],this._promises=[]}.bind(this))}.bind(this),2e3),this._messagesToRead.push(e),this._promises.push(t),t.promise()},removeDraftAttachment:function(e,t){var i=e.parts.indexOf(t);-1!==i&&(e.parts.splice(i,1),e.parts.onDataSetChanged([t],n.Base.DataSetChangeTypes.REMOVED)),-1!==(i=e._attachments.indexOf(t))&&e._attachments.splice(e._attachments.indexOf(t),1)},removeAllDraftAttachments:function(i){var a=[];i._attachments.forEach(function(e){var t=i.parts.indexOf(e);-1!==t&&(i.parts.splice(t,1),a.push(e))}.bind(i)),0<a.length&&i.parts.onDataSetChanged(a,n.Base.DataSetChangeTypes.REMOVED),i._attachments.splice(0,i._attachments.length)},createAttachment:function(e,t){if(this._validateAttachmentSize(t)){var i={disposition:'attachment; filename="'+t.name+'"',mimeType:""!==t.type?t.type:"application/octet-stream",size:t.size,status:n.Services.Messaging.ResourceStatus.DRAFT_UNSENT},a=this._attachmentBuilder.build(i,t);return e._attachments.push(a),e.parts.push(a),e.parts.onDataSetChanged([a],n.Base.DataSetChangeTypes.ADDED),a.addOnStatusChangedCallback(function(){this._recalculateAllAttachmentCapabilities(a)}.bind(this)),a}throw new Error("Size not valid.")},stop:function(){this._messagesToRead=[],this._promises=[]},setBodyAndReportTyping:function(e,t,i){var a=T.Deferred();return e.getUpdateBodyCapability().isAllowed?(e.body=i,e._onBodyChangedCallbacks.fire(e,i),t.getStatus()===n.Services.Messaging.ResourceStatus.PUBLISHED&&t.getIsTypingCapability().isAllowed&&t._conversationService.reportTyping(e,!0),a.resolve(this._provider.getMaxTextLength()-e.body.length)):a.reject(new n.Services.Messaging.MessagingError(n.Services.Messaging.MessagingErrorReason.MESSAGING_INVALID_STATE)),a.promise()},isServiceAvailable:function(){return this._provider.isAvailable()},_recalculateAllMessageCapabilities:function(e){e._recalculateUpdateBodyCapability(),e._recalculateUpdateSensitivityCapability(),e._recalculateUpdateInReplyToCapability(),e._recalculateUpdateDoNotForwardCapability(),e._recalculateUpdateImportanceCapability(),e._recalculateCreateAttachmentCapability(),e._recalculateSendCapability(),e._recalculateMarkAsReadCapability(),e._recalculateRemoveCapability()},_recalculateAllAttachmentCapabilities:function(e){e._recalculateUpdateNameCapability(),e._recalculateUpdateMimeTypeCapability(),e._recalculateUpdateDurationCapability(),e._recalculateUpdateIsSelfGeneratedCapability(),e._recalculateCreateThumbnailCapability(),e._recalculateRemoveThumbnailCapability(),e._recalculateRemoveCapability()},_validateAttachmentSize:function(e){return!e.type||!(-1!==e.type.indexOf("image")&&this._provider.getMaxImageSize()&&e.size>this._provider.getMaxImageSize()||-1!==e.type.indexOf("video")&&this._provider.getMaxVideoSize()&&e.size>this._provider.getMaxVideoSize()||-1!==e.type.indexOf("audio")&&this._provider.getMaxAudioSize()&&e.size>this._provider.getMaxAudioSize())&&!(-1===e.type.indexOf("image")&&-1===e.type.indexOf("video")&&-1===e.type.indexOf("audio")&&this._provider.getMaxGenericAttachmentSize()&&e.size>this._provider.getMaxGenericAttachmentSize())}},n.Services.Messaging.MessageService=e}(AvayaClientServices),function(C){"use strict";function e(e,t,i){this._contactsIntegrationService=i;var a=new C.Services.Messaging.ThumbnailCreator,r=t.getMessagingProviders(e)[0];this._messagingService=this._createMessagingService(r,a)}e.prototype={create:function(){var e=new C.Services.Messaging.Messaging(this._messagingService);return this._messagingService._recalculateAllMessagingCapabilities(e),e},_createMessagingService:function(e,t){var i=new C.Services.Messaging.ParticipantService,a=new C.Services.Messaging.AttachmentBuilder(t);t.registerCreator("image/*",new C.Services.Messaging.ImageThumbnailCreator(a)),t.registerCreator("video/*",new C.Services.Messaging.VideoThumbnailCreator(a));var r=new C.Services.Messaging.MessageBuilder(a,i),s=new C.Services.Analytics.MessagingAnalyticsService,n=new C.Services.Messaging.MessageService(e,r,a,s),o=new C.Services.Messaging.EscalationService(e),c=new C.Services.Messaging.ConversationBuilder(r),l=new C.Services.Messaging.ConversationService(e,n,i,o,r,c,s),d=new C.Services.Messaging.MessagingService(e,l,n,i,c,this._contactsIntegrationService,s);return l._messagingService=d}},C.Services.Messaging.MessagingFactory=e}(AvayaClientServices),function(d){"use strict";function e(e,t,i,a,r,s,n){this._hasStarted=!1,this._conversationsSubscribed=!1,this._provider=e,this._messageService=i,this._conversationService=t,this.conversations=new d.Base.DataSet,this._draftConversations=[],this._identity={},this._participantsService=a,this._conversationBuilder=r,this._updateByIdDataSetFnc=m,this._contactsIntegrationService=s,this._onContactListChanged=m,this._numberOfConversationsWithUnreadContentSinceLastAccessTime=m,this._unreadConversationsCounter=m,this._messagingAnalyticsService=n}e.prototype={getActiveConversations:function(t){var i=new d.Base.DataRetrieval(this.conversations),a=this._messagingAnalyticsService.startTimingMetric(),e=function(e){this._messagingAnalyticsService.trackTimeRequestsGetConversationsEnd(a),this._updateConversationsContainer(e,this.conversations,t),0===this.conversations.length&&this.conversations.onDataSetChanged(this.conversations,d.Base.DataSetChangeTypes.ADDED),this._subscribeForConversationsUpdates(t),i.isCompleted=!0,i._dataRetrievalProgress.fire(this.conversations.length,!1),i._dataRetrievalDone.fire()}.bind(this),r=function(e){this._messagingAnalyticsService.trackErrorsResponseGetConversations(d.Services.Analytics.AnalyticsErrorCode.GETTING_CONVERSATIONS_ERROR),i._dataRetrievalFailed.fire(e)}.bind(this),s={cancel:function(){}},n=this._provider.getConversations(s);return i._onCancel=function(){s.cancel()},n.then(e,r,function(e){i._dataRetrievalProgress.fire(e,!1)}),i},getDraftConversations:function(){return this._draftConversations},leaveAllConversations:function(){return this.leaveConversations(this.conversations)},leaveConversations:function(e){for(var t=this._messagingAnalyticsService.startTimingMetric(),i=[],a=T.Deferred(),r=e.length,s=0;s<r;s++)i.push(e[s].leave());return T.when.apply(this,i).then(function(){this._messagingAnalyticsService.trackTimeRequestsLeaveConversationsEnd(t),a.resolve(!0)}.bind(this),function(){var e=d.Services.Messaging.MessagingErrorReason.MESSAGING_LEAVE_CONVERSATION_FAILED;this._messagingAnalyticsService.trackErrorsResponseLeaveConversations(e),a.reject(new d.Services.Messaging.MessagingError(e))}.bind(this)),a.promise()},createConversation:function(e){var t=this._conversationBuilder.build({resourceStatus:d.Services.Messaging.ResourceStatus.DRAFT_UNSENT},this._conversationService);return t.participants.push(this._participantsService.getSelfParticipant()),this.conversations.push(t),this.conversations.onDataSetChanged([t],d.Base.DataSetChangeTypes.ADDED),this._draftConversations.push(t),this._provider.on(d.Providers.AMM.ProviderStates.AVAILABLE,function(){this._conversationService._recalculateAllConversationCapabilities(t)}.bind(this)),this._provider.on(d.Providers.AMM.ProviderStates.UNAVAILABLE,function(){this._conversationService._recalculateAllConversationCapabilities(t)}.bind(this)),t.addOnStatusChangedCallback(function(e,t){if(t===d.Services.Messaging.ResourceStatus.PUBLISHED){var i=this._draftConversations.indexOf(e);this._draftConversations.splice(i,1)}this._conversationService._recalculateAllConversationCapabilities(e)}.bind(this)),t.addOnActiveStatusChangedCallback(function(e){this._conversationService._recalculateAllConversationCapabilities(e)}.bind(this)),t.addOnClosedStatusChangedCallback(function(e,t){var i=this.conversations.indexOf(e);-1<i&&(this.conversations.splice(i,1),this.conversations.onDataSetChanged([e],d.Base.DataSetChangeTypes.REMOVED)),this._conversationService._recalculateAllConversationCapabilities(e)}.bind(this)),t.lastUpdated=new Date,t},start:function(i,e){return d.Base.Logger.debug(d.Base.LoggerTags.MESSAGING_SERVICE,"Messaging Service is starting..."),this._serviceUnavailableAnalyticsInit(i),this._hasStarted=!0,this._provider.on(d.Base.NetworkProviderEvents.UNAUTHORIZED,function(){i._fireMessagingUnavailableCallback(d.Services.Analytics.AnalyticsErrorCode.UNAUTHORIZED)}.bind(this)),this._provider.on(d.Base.NetworkProviderEvents.AUTHORIZED,function(){i._fireMessagingAvailableCallback()}.bind(this)),this._provider.start(e.ammConfiguration,i).then(function(){return this.validateUsers([this._provider.getSelfAddress()])}.bind(this)).then(function(e){var t=this._participantsService.getOrCreateParticipant(e[0]);this._identity.participant=t,this._participantsService.setSelfParticipant(t),this._recalculateAllMessagingCapabilities(i),this._onContactListChanged=function(){this.conversations.forEach(function(e){this._updateMatchedContactsForConversation(e)},this)}.bind(this),this._contactsIntegrationService.addOnContactListChangedCallback(this._onContactListChanged),i.addOnMessagingServiceAvailableCallback(function(){this._recalculateAllMessagingCapabilities(i)}.bind(this)),i.addOnMessagingServiceUnavailableCallback(function(){this._recalculateAllMessagingCapabilities(i)}.bind(this))}.bind(this),function(e){return this._hasStarted=!1,this._recalculateAllMessagingCapabilities(i),T.Deferred().reject(e).promise()}.bind(this))},_serviceUnavailableAnalyticsInit:function(e){var t;e.addOnMessagingServiceUnavailableCallback(function(e){e._messagingUnavailableReason&&(t=this._messagingAnalyticsService.startTimingMetric(),this._messagingAnalyticsService.trackServiceUnavailable(e._messagingUnavailableReason))}.bind(this)),e.addOnMessagingServiceAvailableCallback(function(){this._messagingAnalyticsService.trackDurationServiceUnavailableEnd(t)}.bind(this))},stop:function(l){l._isAvailable&&(l._isAvailable=m,l._onMessagingServiceUnavailableCallbacks.fire(l));var e=function(){if(this._hasStarted)return this._provider.stop().then(function(e){this._messageService.stop(),this._participantsService.stop(),this._draftConversations=[];for(var t=this.conversations.length,i=0;i<t;i++){for(var a=this.conversations[i].messages.length,r=0;r<a;r++){for(var s=this.conversations[i].messages[r].parts.length,n=0;n<s;n++)delete this.conversations[i].messages[r].parts[n];delete this.conversations[i].messages[r]}for(var o=this.conversations[i]._draftEscalations.length,c=0;c<o;c++)delete this.conversations[i]._draftEscalations[c];delete this.conversations[i]}return this.conversations=new d.Base.DataSet,this._hasStarted=!1,l._onMessagingLimitsChangedCallbacks.empty(),l._onNumberOfConversationsWithUnreadContentChangedCallbacks.empty(),l._onNumberOfConversationsWithUnreadContentSinceLastAccessChangedCallbacks.empty(),l._onRoutableDomainsChangedCallbacks.empty(),this._contactsIntegrationService.removeOnContactListChangedCallback(this._onContactListChanged),this._onContactListChanged=m,this._unreadConversationsCounter=m,this._numberOfConversationsWithUnreadContentSinceLastAccessTime=m,this._recalculateAllMessagingCapabilities(l),e}.bind(this));var e=T.Deferred(),t=new d.Services.Messaging.MessagingError(d.Services.Messaging.MessagingErrorReason.MESSAGING_NOT_STARTED);return e.reject(t),e.promise()}.bind(this);return this.logout().then(e,e)},_stopImmediately:function(e){d.Base.Logger.debug(d.Base.LoggerTags.MESSAGING_SERVICE,"Stopping the Service"),e._isAvailable&&e._onMessagingServiceUnavailableCallbacks.fire(e);var t=T.Deferred();return this._hasStarted?(d.Base.Logger.debug(d.Base.LoggerTags.MESSAGING_SERVICE,"Service stopped successfully"),t.resolve()):(d.Base.Logger.debug(d.Base.LoggerTags.MESSAGING_SERVICE,"Service failed to stop"),t.reject(new d.Services.Messaging.MessagingError(d.Services.Messaging.MessagingErrorReason.MESSAGING_NOT_STARTED))),t.promise()},logout:function(){return this._provider.logout()},getNumberOfConversationsWithUnreadContent:function(){return this.conversations.filter(function(e){return 0<e.getUnreadMessageCount()||0<e.getUnreadAttachmentCount()}).length},getNumberOfConversationsWithUnreadContentSinceLastAccess:function(){return this.conversations.filter(function(e){return e.hasUnreadMessagesSinceLastAccess()}).length},validateUsers:function(e){return this._conversationService.validateUsers(e)},searchConversations:function(e,t){var i=this._messagingAnalyticsService.startTimingMetric(),a=new d.Base.DataRetrieval,r=a.getDataSet(),s={cancel:function(){}},n={q:e.getQuery(),subject:e.isSearchSubject(),participants:e.isSearchParticipants(),body:e.isSearchBody()};e.getQueryAfter()&&(n.after=e.getQueryAfter().toISOString());var o=function(e){this._messagingAnalyticsService.trackTimeRequestsSearchConversationsEnd(i),this._updateConversationsContainer(e,r,t),a.isCompleted=!0,a._dataRetrievalProgress.fire(r.length,!1),a._dataRetrievalDone.fire(),this._messagingAnalyticsService.trackNumConversationSearchRequests(n.body,n.subject,n.participants)}.bind(this),c=function(e){this._messagingAnalyticsService.trackErrorsResponseSearchConversations(d.Services.Analytics.AnalyticsErrorCode.SEARCHING_CONVERSATIONS_ERROR),a._dataRetrievalFailed.fire(e)}.bind(this),l=function(e){a._dataRetrievalProgress.fire(e,!1)}.bind(this);return this._provider.getConversationsByQuery(n,null,s).then(o,c,l),a._onCancel=function(){s.cancel()},this._searchLocalConversations(this.conversations,e).forEach(function(e){r.push(e)}),setTimeout(function(){r.onDataSetChanged(r,d.Base.DataSetChangeTypes.ADDED),l(r,!1)},0),a},_createNewConversation:function(e,t){var i=this._conversationBuilder.build(e,this._conversationService);return this._provider.on(d.Providers.AMM.ProviderStates.AVAILABLE,function(){this._conversationService._recalculateAllConversationCapabilities(i)}.bind(this)),this._provider.on(d.Providers.AMM.ProviderStates.UNAVAILABLE,function(){this._conversationService._recalculateAllConversationCapabilities(i)}.bind(this)),this._conversationBuilder.update(i,e,this._conversationService),i.addOnClosedStatusChangedCallback(function(e,t){var i=this.conversations.indexOf(e);-1<i&&(this.conversations.splice(i,1),this.conversations.onDataSetChanged([e],d.Base.DataSetChangeTypes.ADDED))}.bind(this)),i},_getById:function(e,t){return e.filter(function(e){return e.id===t})[0]},_updateConversationsContainer:function(e,t,i){if(e&&e.conversations&&0<e.conversations.length){for(var a=[],r=[],s=0;s<e.conversations.length;s++){var n=e.conversations[s],o=this._getById(t,n.id);if(o)this._conversationBuilder.update(o,n,this._conversationService),a.push(o),this._updateMatchedContactsForConversation(o);else if(n.flags.active){var c=this._createNewConversation(n,i);c.participants=this._conversationService.getParticipantsFromMessage(n.messages[0]),t.unshift(c),r.push(c),this._updateMatchedContactsForConversation(c)}}0<r.length&&t.onDataSetChanged(r,d.Base.DataSetChangeTypes.ADDED),0<a.length&&t.onDataSetChanged(a,d.Base.DataSetChangeTypes.UPDATED),this._updateNumberOfConversationsWithUnreadContent(i),this._updateNumberOfConversationsWithUnreadContentSinceLastAccessTime(i)}},_searchLocalConversations:function(e,s){var n=[];return e.forEach(function(e){var t=!1;s.isSearchSubject()&&-1!==e.getSubject().toLowerCase().indexOf(s.getQuery())&&(t=!0),s.isSearchParticipants()&&e.getParticipants().forEach(function(e){-1===e.givenName.toLowerCase().indexOf(s.getQuery())&&-1===e.surname.toLowerCase().indexOf(s.getQuery())||(t=!0)});var i=e.getMessages();s.isSearchBody()&&(i=e.getMessages().filter(function(e){if(s.isSearchBody()&&e.body&&-1!==e.body.toLowerCase().indexOf(s.getQuery()))return t=!0}));var a=s.getQueryAfter();if(a&&t&&(t=e.getLastUpdatedTime()>=a),t){var r=T.extend(new d.Services.Messaging.Conversation,e);r.messages=new d.Base.DataSet,i.forEach(function(e){r.messages.push(T.extend(new d.Services.Messaging.Message(this._messageService,r),e))}.bind(this)),this._conversationBuilder._updatePreviewText(r),n.push(r)}}.bind(this)),n},_subscribeForConversationsUpdates:function(t){this._conversationsSubscribed||this._provider.observeConversations().then(function(){this._provider.on(d.Providers.Interfaces.MessagingProviderHandlers.CONVERSATIONS_UPDATE,function(e){this._updateConversationsContainer(e,this.conversations,t)}.bind(this)),this._conversationsSubscribed=!0}.bind(this))},_updateConversationsByIdDataSet:function(e,i,t){var a={conversations:[]};e.forEach(function(t){var e=i.filter(function(e){return e.id===t.id})[0];e&&a.conversations.push(e)}.bind(this)),0<a.conversations.length&&this._updateConversationsContainer(a,e,t)},removeConversation:function(e){var t=T.Deferred();if(e.getRemoveCapability().isAllowed){var i=this.conversations.indexOf(e);0<=i&&(this.conversations.splice(i,1),this.conversations.onDataSetChanged([e],d.Base.DataSetChangeTypes.REMOVED)),0<=(i=this._draftConversations.indexOf(e))&&this._draftConversations.splice(i,1),t.resolve()}else t.reject(new d.Base.BaseError(e.getRemoveCapability().denialReason));return t.promise()},removeAllDraftConversations:function(){for(var e=this._draftConversations.length-1;0<=e;e--)this.removeConversation(this._draftConversations[e])},serviceIsAvailable:function(){return!!this._provider.isAvailable()&&this._hasStarted},_recalculateAllMessagingCapabilities:function(e){e._recalculateRetrieveConversationsCapability(),e._recalculateStartServiceCapability(),e._recalculateCreateConversationCapability(),e._recalculateSearchConversationsCapability(),e._recalculateValidateParticipantAddressCapability(),e._recalculateMarkContentAsReadCapability()},getRoutableDomains:function(){return this._provider.getRoutableDomains()},getSelfAddress:function(){return this._provider.getSelfAddress()},getConversationResource:function(){return this._provider.getSelfAddress()},getValidateAddressResource:function(){return this._provider.getValidateAddressResource()},getMarkAsReadResource:function(){return this._provider.getMarkAsReadResource()},_updateMatchedContactsForConversation:function(e){this._contactsIntegrationService.isStarted()&&e.getParticipants().forEach(function(e){this._updateMatchedContactsForParticipant(e)},this)},_updateMatchedContactsForParticipant:function(e){this._contactsIntegrationService.updateMatchedContactsForParticipant(e)},_updateNumberOfConversationsWithUnreadContent:function(e){var t=this.getNumberOfConversationsWithUnreadContent(),i=d.Base.Utils.isDefined(this._unreadConversationsCounter);this._unreadConversationsCounter!==t&&(this._unreadConversationsCounter=t,i&&e._onNumberOfConversationsWithUnreadContentChangedCallbacks.fire(e,t))},_updateNumberOfConversationsWithUnreadContentSinceLastAccessTime:function(e){var t=this.getNumberOfConversationsWithUnreadContentSinceLastAccess(),i=d.Base.Utils.isDefined(this._numberOfConversationsWithUnreadContentSinceLastAccessTime);this._numberOfConversationsWithUnreadContentSinceLastAccessTime!==t&&(this._numberOfConversationsWithUnreadContentSinceLastAccessTime=t,i&&e._onNumberOfConversationsWithUnreadContentSinceLastAccessChangedCallbacks.fire(e,t))}},d.Services.Messaging.MessagingService=e}(AvayaClientServices),function(r){"use strict";function e(){this._participants=[],this._selfParticipant=m}e.prototype={getOrCreateParticipant:function(e){var t=e._address||e.address||e.from._address||e.from.address,i=this._getParticipant(t);if(!i){var a=!!this._selfParticipant&&this._selfParticipant.getAddress()===t;i=new r.Services.Messaging.Participant(e,a),this._participants.push(i)}return i},_getParticipant:function(t){return this._participants.filter(function(e){return e.getAddress()===t})[0]},setSelfParticipant:function(e){this._selfParticipant=e,this._selfParticipant.self=!0},getSelfParticipant:function(){return this._selfParticipant},stop:function(){this._selfParticipant=m,this._participants=[]}},r.Services.Messaging.ParticipantService=e}(AvayaClientServices),function(e){"use strict";function t(e){this._config=e||{width:128},this._creators={}}t.prototype={getConfig:function(){return this._config},setConfig:function(e){this._config=e},registerCreator:function(e,t){this._creators[e]=t},unregisterCreator:function(e){this._creators[e]=m},create:function(e,t){var i;if(t||(t=this._config),e.getCreateThumbnailCapability().isAllowed)return i=this._creators[e.getMimeType()]?e.getMimeType():e.getMimeType().slice(0,e.getMimeType().indexOf("/")+1)+"*",this._creators[i].create(e,t)}},e.Services.Messaging.ThumbnailCreator=t}(AvayaClientServices),function(t){"use strict";function e(e){t.Services.Messaging.AbstractThumbnailCreator.call(this,e)}(e.prototype=Object.create(t.Services.Messaging.AbstractThumbnailCreator.prototype)).create=function(a,r){var s=T.Deferred(),n={disposition:a.disposition.replace("attachment","inline"),mimeType:"image/jpeg",status:a.status},e=new FileReader;return e.onloadend=function(){this._getFirstFrameFromVideo(e.result,function(e){var t=new Image;t.src=e;var i=new Blob([this._resizeImage(t,r)],{type:"image/jpeg"});n.size=i.size,a.thumbnail=this._attachmentBuilder.build(n,i),s.resolve(a.thumbnail)}.bind(this))}.bind(this),e.readAsDataURL(a.file),s.promise()},e.prototype._getFirstFrameFromVideo=function(e,t){var i,a,r=document.createElement("canvas"),s=document.createElement("video"),n=document.createElement("source");n.src=e,n.type="video/mp4",s.appendChild(n),T(s).on("loadedmetadata",function(){r.height=a=s.videoHeight,r.width=i=s.videoWidth}),T(s).on("loadeddata",function(){r.getContext("2d").drawImage(s,0,0,i,a),t(r.toDataURL("image/jpeg"))}),T(s).on("error",function(){throw new Error}),s.load()},t.Services.Messaging.VideoThumbnailCreator=e}(AvayaClientServices),function(e){"use strict";function t(){this._address="",this._participantId=m,this._displayName="",this._localUser=!1,this._joinTime=Date.now(),this._matchedContacts=new e.Services.Contacts.MatchedContactsWithMatchLevel,this._onParticipantMatchedContactsChangedCallbacks=T.Callbacks()}t.prototype={getAddress:function(){return this._address},setAddress:function(e){this._address=e},getDisplayName:function(){return this._displayName},setDisplayName:function(e){this._displayName=e},getParticipantId:function(){return this._participantId},isLocalUser:function(){return this._localUser},getBestContactMatch:function(){if(this._matchedContacts&&!this._matchedContacts.empty){if(0<this._matchedContacts._exactType1Contacts.length)return this._matchedContacts._exactType1Contacts[0];if(0<this._matchedContacts._exactType2Contacts.length)return this._matchedContacts._exactType2Contacts[0];if(0<this._matchedContacts._partialType1Contacts.length)return this._matchedContacts._partialType1Contacts[0]}},getAllPossibleContactMatches:function(){return this._matchedContacts},setMatchedContacts:function(e){(e&&!e._equals(this._matchedContacts)||!e&&this._matchedContacts)&&(this._matchedContacts=e,this._onParticipantMatchedContactsChangedCallbacks.fire(this))}},e.Services.Participant=t}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Participant.prototype,{addOnParticipantMatchedContactsChangedCallback:function(e){this._onParticipantMatchedContactsChangedCallbacks.add(e)},removeOnParticipantMatchedContactsChangedCallback:function(e){this._onParticipantMatchedContactsChangedCallbacks.remove(e)}})}(AvayaClientServices),function(e){"use strict";AvayaClientServices.Services.Presence.PresenceErrorReason={UNKNOWN:"UNKNOWN",UNSUPPORTED:"UNSUPPORTED",CANCELED:"CANCELED",INVALID_REQUEST:"INVALID_REQUEST",INVALID_STATE:"INVALID_STATE",INTERNAL_ERROR:"INTERNAL_ERROR",SEND_ERROR:"SEND_ERROR",TIMEOUT:"TIMEOUT",RETRY_LIMIT_EXCEEDED:"RETRY_LIMIT_EXCEEDED",INVALID_RESPONSE:"INVALID_RESPONSE",AUTHENTICATION_ERROR:"AUTHENTICATION_ERROR",SERVER_ERROR:"SERVER_ERROR"}}(),function(e){"use strict";AvayaClientServices.Services.Presence.PresenceLocationMode={PRESENCE_LOCATION_MODE_UNSPECIFIED:"PRESENCE_LOCATION_MODE_UNSPECIFIED",PRESENCE_LOCATION_MODE_OFFICE:"PRESENCE_LOCATION_MODE_OFFICE",PRESENCE_LOCATION_MODE_HOME:"PRESENCE_LOCATION_MODE_HOME",PRESENCE_LOCATION_MODE_MOBILE:"PRESENCE_LOCATION_MODE_MOBILE",PRESENCE_LOCATION_MODE_TRAVELING:"PRESENCE_LOCATION_MODE_TRAVELING"}}(),function(e){"use strict";var t={PRESENCE_STATE_UNKNOWN:"PRESENCE_STATE_UNKNOWN",PRESENCE_STATE_UNSPECIFIED:"PRESENCE_STATE_UNSPECIFIED",PRESENCE_STATE_AVAILABLE:"PRESENCE_STATE_AVAILABLE",PRESENCE_STATE_ON_A_CALL:"PRESENCE_STATE_ON_A_CALL",PRESENCE_STATE_BUSY:"PRESENCE_STATE_BUSY",PRESENCE_STATE_AWAY:"PRESENCE_STATE_AWAY",PRESENCE_STATE_DO_NOT_DISTURB:"PRESENCE_STATE_DO_NOT_DISTURB",PRESENCE_STATE_OUT_OF_OFFICE:"PRESENCE_STATE_OUT_OF_OFFICE",PRESENCE_STATE_OFFLINE:"PRESENCE_STATE_OFFLINE"},i={PRESENCE_STATE_UNKNOWN:(e.Services.Presence.PresenceState=t).PRESENCE_STATE_UNKNOWN,PRESENCE_STATE_UNSPECIFIED:t.PRESENCE_STATE_UNSPECIFIED,PRESENCE_STATE_AVAILABLE:t.PRESENCE_STATE_AVAILABLE,PRESENCE_STATE_BUSY:t.PRESENCE_STATE_BUSY,PRESENCE_STATE_AWAY:t.PRESENCE_STATE_AWAY,PRESENCE_STATE_OUT_OF_OFFICE:t.PRESENCE_STATE_OUT_OF_OFFICE,PRESENCE_STATE_OFFLINE:t.PRESENCE_STATE_OFFLINE};e.Services.Presence.ManualPresenceState=i;var a={PRESENCE_STATE_UNKNOWN:t.PRESENCE_STATE_UNKNOWN,PRESENCE_STATE_UNSPECIFIED:t.PRESENCE_STATE_UNSPECIFIED,PRESENCE_STATE_AVAILABLE:t.PRESENCE_STATE_AVAILABLE,PRESENCE_STATE_ON_A_CALL:t.PRESENCE_STATE_ON_A_CALL,PRESENCE_STATE_AWAY:t.PRESENCE_STATE_AWAY,PRESENCE_STATE_OUT_OF_OFFICE:t.PRESENCE_STATE_OUT_OF_OFFICE,PRESENCE_STATE_OFFLINE:t.PRESENCE_STATE_OFFLINE};e.Services.Presence.PhonePresenceState=a;var r={PRESENCE_STATE_UNKNOWN:t.PRESENCE_STATE_UNKNOWN,PRESENCE_STATE_UNSPECIFIED:t.PRESENCE_STATE_UNSPECIFIED,PRESENCE_STATE_AVAILABLE:t.PRESENCE_STATE_AVAILABLE,PRESENCE_STATE_ON_A_CALL:t.PRESENCE_STATE_ON_A_CALL,PRESENCE_STATE_AWAY:t.PRESENCE_STATE_AWAY,PRESENCE_STATE_OFFLINE:t.PRESENCE_STATE_OFFLINE};e.Services.Presence.VideoPresenceState=r;var s={PRESENCE_STATE_UNKNOWN:t.PRESENCE_STATE_UNKNOWN,PRESENCE_STATE_UNSPECIFIED:t.PRESENCE_STATE_UNSPECIFIED,PRESENCE_STATE_AVAILABLE:t.PRESENCE_STATE_AVAILABLE,PRESENCE_STATE_AWAY:t.PRESENCE_STATE_AWAY,PRESENCE_STATE_OFFLINE:t.PRESENCE_STATE_OFFLINE};e.Services.Presence.IMPresenceState=s;var n={PRESENCE_STATE_UNKNOWN:t.PRESENCE_STATE_UNKNOWN,PRESENCE_STATE_UNSPECIFIED:t.PRESENCE_STATE_UNSPECIFIED,PRESENCE_STATE_AVAILABLE:t.PRESENCE_STATE_AVAILABLE,PRESENCE_STATE_AWAY:t.PRESENCE_STATE_AWAY,PRESENCE_STATE_OFFLINE:t.PRESENCE_STATE_OFFLINE};e.Services.Presence.CalendarPresenceState=n}(AvayaClientServices),function(e){"use strict";function t(e){this._presentity=e,this._locationMode=m,this._note=m,this._calendarStartTime=m,this._calendarEndTime=m,this._calendarState=m,this._manualState=m,this._overallState=m,this._enterpriseIMState=m,this._phoneState=m,this._videoState=m,this._enterpriseIMContact=m,this._phoneContact=m,this._videoContact=m}t.prototype={getPresentity:function(){return this._presentity},getOverallState:function(){return this._overallState},_setOverallState:function(e){this._overallState=e},getManualState:function(){return this._manualState},_setManualState:function(e){this._manualState=e},getPhoneState:function(){return this._phoneState},_setPhoneState:function(e){this._phoneState=e},getPhoneContact:function(){return this._phoneContact},_setPhoneContact:function(e){this._phoneContact=e},getVideoState:function(){return this._videoState},_setVideoState:function(e){this._videoState=e},getVideoContact:function(){return this._videoContact},_setVideoContact:function(e){this._videoContact=e},getEnterpriseIMState:function(){return this._enterpriseIMState},_setEnterpriseIMState:function(e){this._enterpriseIMState=e},getEnterpriseIMContact:function(){return this._enterpriseIMContact},_setEnterpriseIMContact:function(e){this._enterpriseIMContact=e},getCalendarState:function(){return this._calendarState},_setCalendarState:function(e){this._calendarState=e},getCalendarStartTime:function(){return this._calendarStartTime},_setCalendarStartTime:function(e){this._calendarStartTime=e},getCalendarEndTime:function(){return this._calendarEndTime},_setCalendarEndTime:function(e){this._calendarEndTime=e},getLocationMode:function(){return this._locationMode},_setLocationMode:function(e){this._locationMode=e},getNote:function(){return this._note},_setNote:function(e){this._note=e}},e.Services.Presence.Presence=t}(AvayaClientServices),function(e){"use strict";function t(e){Error.call(this),this._reason=e}(t.prototype=Object.create(Error.prototype)).getReason=function(){return this._reason},e.Services.Presence.PresenceError=t}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Services.Presence.Presence.prototype)).setPhoneState=function(e){var t=!1;for(var i in a.Services.Presence.PhonePresenceState)if(a.Services.Presence.PhonePresenceState.hasOwnProperty(i)&&e===a.Services.Presence.PhonePresenceState[i]){this._setPhoneState(e),t=!0;break}return t},e.prototype.setVideoState=function(e){var t=!1;for(var i in a.Services.Presence.VideoPresenceState)if(a.Services.Presence.VideoPresenceState.hasOwnProperty(i)&&e===a.Services.Presence.VideoPresenceState[i]){this._setVideoState(e),t=!0;break}return t},e.prototype.setEnterpriseIMState=function(e){var t=!1;for(var i in a.Services.Presence.IMPresenceState)if(a.Services.Presence.IMPresenceState.hasOwnProperty(i)&&e===a.Services.Presence.IMPresenceState[i]){this._setEnterpriseIMState(e),t=!0;break}return t},a.Services.Presence.SelfPresence=e}(AvayaClientServices),function(e){"use strict";function t(){}t.prototype={getCallLogId:function(){},getParticipantList:function(){},getStartTime:function(){},getCallDuration:function(){},isCallerIdPrivate:function(){},getSubject:function(){},getRemoteAddress:function(){},getLocalAddress:function(){},getCallType:function(){},getWebConferenceAddress:function(){},getChannelTypeList:function(){},isBridged:function(){},isIncoming:function(){},isMissed:function(){},isDeclined:function(){},isFailed:function(){},isRead:function(){},getCorrelatedCallLogIdList:function(){}},e.Services.SessionLogs.CallLogItem=t}(AvayaClientServices),function(e){"use strict";function t(){}t.prototype={getUnreadCount:function(){}},e.Services.SessionLogs.CallLogsDataSet=t}(AvayaClientServices),function(e){"use strict";e.Services.SessionLogs.create=function(){return new e.Services.SessionLogs.SessionLogs}}(AvayaClientServices),function(e){"use strict";function t(){}t.prototype={getCurrentCallLogItemList:function(){},markAsRead:function(e,t){},deleteCallLogItemList:function(e,t){}},e.Services.SessionLogs.SessionLogs=t}(AvayaClientServices),function(i){"use strict";function e(e){this._vmProvider=e,this._available=m,this._starting=!1,this._started=!1,this._vmNumber=m,this._vmStatus=new i.Services.VoiceMessaging.VoiceMessagingStatusParameters(!1),this._onVoicemailNumberChange=m,this._onMWIStatusChange=m,this._onNetworkAvailable=m,this._onNetworkUnavailable=m,this._onVoicemailNumberChangedCallbacks=T.Callbacks(),this._onVoiceMessagingStatusChangedCallbacks=T.Callbacks(),this._onVoiceMessagingServiceAvailableCallbacks=T.Callbacks(),this._onVoiceMessagingServiceUnavailableCallbacks=T.Callbacks(),this._serviceAvailableCapability=new i.Base.Capability(i.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED)}e.prototype={getVoicemailNumber:function(){return this._vmNumber},getVoiceMessagingStatus:function(){return this._vmStatus},start:function(e){return e.sgConfiguration.credentialProvider.isGuest?(i.Base.Logger.warn(i.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Cannot start service for guest"),T.Deferred().reject(new i.Services.Call.CallException(i.Services.Call.CallError.USER_NOT_FOUND)).promise()):(this.startDfd=T.Deferred(),i.Base.Utils.isWebRTC_SupportedBrowser(e.sgConfiguration._disableWebRTCForTheseBrowsers)?(i.Base.Logger.info(i.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Starting the service"),this._subscribeForProvidersNotifications(),this._starting=!0,this._vmProvider.start(m,e.sgConfiguration).fail(function(e){this._starting=!1,this._available=!1,i.Base.Logger.error(i.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Failed to start service",e),this.startDfd.state()===i.Base.DeferredStates.PENDING&&this.startDfd.reject(e)}.bind(this)),i.Base.Utils.isDefined(this._vmProvider.isServiceAvailable)&&this._vmProvider.isServiceAvailable()&&this._onServiceAvailable(),this.startDfd.promise()):(this._available=!1,this._started=!0,this._onVoiceMessagingServiceUnavailableCallbacks.fire(this),this._serviceAvailableCapability._updateIfChanged(!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),T.Deferred().reject(new i.Services.Call.CallException(i.Services.Call.CallError.WEBRTC_NOT_SUPPORTED)).promise()))},stop:function(){i.Base.Logger.info(i.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Stopping the service"),this._unsubscribeFromProvidersNotifications(),this._onServiceUnavailable();var t=function(){this._started=!1,this._onVoicemailNumberChangedCallbacks.empty(),this._onVoiceMessagingStatusChangedCallbacks.empty(),this._onVoiceMessagingServiceAvailableCallbacks.empty(),this._onVoiceMessagingServiceUnavailableCallbacks.empty()}.bind(this);return this._vmProvider.stop().then(function(){t(),i.Base.Logger.info(i.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Service stopped successfully")}.bind(this),function(e){return t(),i.Base.Logger.error(i.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Failed to stop service",e),T.Deferred().reject(e).promise()}.bind(this))},_stopImmediately:function(){return i.Base.Logger.info(i.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Stopping the service"),this._started=!1,this._onServiceUnavailable(),i.Base.Logger.info(i.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Service stopped successfully"),T.Deferred().resolve().promise()},_onServiceAvailable:function(){if(!this._available){this._started||(this._starting=!1,this._started=!0,i.Base.Logger.info(i.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Service started successfully"),this.startDfd.state()===i.Base.DeferredStates.PENDING&&this.startDfd.resolve()),this._serviceAvailableCapability._updateIfChanged(!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._available=!0,i.Base.Logger.info(i.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Service is available"),this._onVoiceMessagingServiceAvailableCallbacks.fire(this);var e=this._vmProvider.getVoicemailMWI();this._vmStatus.isMessageWaiting()!==e&&(this._vmStatus._setMessageWaiting(e),this._onVoiceMessagingStatusChangedCallbacks.fire(this._vmStatus),i.Base.Logger.info(i.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"New MWI is "+e));var t=this._vmProvider.getVoicemailNumber();this._vmNumber!==t&&(this._vmNumber=t,this._onVoicemailNumberChangedCallbacks.fire(t),i.Base.Logger.info(i.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"New voicemail number is "+t))}},_onServiceUnavailable:function(){(this._available||this._starting)&&(this._starting&&(this._starting=!1,i.Base.Logger.error(i.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Failed to start service"),this.startDfd.state()===i.Base.DeferredStates.PENDING&&this.startDfd.reject()),this._serviceAvailableCapability._updateIfChanged(!1,i.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._available=!1,i.Base.Logger.info(i.Base.LoggerTags.VOICE_MESSAGING_SERVICE,"Service is unavailable"),this._onVoiceMessagingServiceUnavailableCallbacks.fire(this))},_subscribeForProvidersNotifications:function(){this._started||this._starting||(this._onVoicemailNumberChange=function(e){this._vmNumber!==e&&(this._vmNumber=e,this._onVoicemailNumberChangedCallbacks.fire(e))}.bind(this),this._onMWIStatusChange=function(e){this._vmStatus.isMessageWaiting()!==e&&(this._vmStatus._setMessageWaiting(e),this._onVoiceMessagingStatusChangedCallbacks.fire(this._vmStatus))}.bind(this),this._onNetworkAvailable=this._onServiceAvailable.bind(this),this._onNetworkUnavailable=this._onServiceUnavailable.bind(this),this._vmProvider.on(i.Providers.Interfaces.VoiceMessagingProviderCallbackIds.VOICEMAIL_NUMBER_CHANGED,this._onVoicemailNumberChange),this._vmProvider.on(i.Providers.Interfaces.VoiceMessagingProviderCallbackIds.MWI_STATUS_CHANGED,this._onMWIStatusChange),this._vmProvider.on(i.Base.NetworkProviderEvents.UNAUTHORIZED,this._onNetworkUnavailable),this._vmProvider.on(i.Base.NetworkProviderEvents.AUTHORIZED,this._onNetworkAvailable),this._vmProvider.on(i.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,this._onNetworkUnavailable),this._vmProvider.on(i.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,this._onNetworkAvailable),this._vmProvider.on(i.Providers.CallServiceGateway.ObservableEvents.CALLS_SERVICE_ACTIVATED,this._onNetworkAvailable),this._vmProvider.on(i.Providers.CallServiceGateway.ObservableEvents.CALLS_SERVICE_DEACTIVATED,this._onNetworkUnavailable))},_unsubscribeFromProvidersNotifications:function(){this._started&&(this._vmProvider.off(i.Providers.Interfaces.VoiceMessagingProviderCallbackIds.VOICEMAIL_NUMBER_CHANGED,this._onVoicemailNumberChange),this._vmProvider.off(i.Providers.Interfaces.VoiceMessagingProviderCallbackIds.MWI_STATUS_CHANGED,this._onMWIStatusChange),this._vmProvider.off(i.Base.NetworkProviderEvents.UNAUTHORIZED,this._onNetworkUnavailable),this._vmProvider.off(i.Base.NetworkProviderEvents.AUTHORIZED,this._onNetworkAvailable),this._vmProvider.off(i.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,this._onNetworkUnavailable),this._vmProvider.off(i.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,this._onNetworkAvailable),this._onNetworkAvailable=m,this._onNetworkUnavailable=m,this._onVoicemailNumberChange=m,this._onMWIStatusChange=m)}},i.Services.VoiceMessaging.VoiceMessaging=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.VoiceMessaging.VoiceMessaging.prototype,{addOnVoiceMessagingServiceUnavailableCallback:function(e){this._onVoiceMessagingServiceUnavailableCallbacks.add(e)},removeOnVoiceMessagingServiceUnavailableCallback:function(e){this._onVoiceMessagingServiceUnavailableCallbacks.remove(e)},addOnVoiceMessagingServiceAvailableCallback:function(e){this._onVoiceMessagingServiceAvailableCallbacks.add(e)},removeOnVoiceMessagingServiceAvailableCallback:function(e){this._onVoiceMessagingServiceAvailableCallbacks.remove(e)},addOnVoicemailNumberChangedCallback:function(e){this._onVoicemailNumberChangedCallbacks.add(e)},removeOnVoicemailNumberChangedCallback:function(e){this._onVoicemailNumberChangedCallbacks.remove(e)},addOnVoiceMessagingStatusChangedCallback:function(e){this._onVoiceMessagingStatusChangedCallbacks.add(e)},removeVoiceMessagingStatusChangedCallback:function(e){this._onVoiceMessagingStatusChangedCallbacks.remove(e)}})}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.VoiceMessaging.VoiceMessaging.prototype,{getSubscribeForVoicemailNumberChangesCapability:function(){return this._serviceAvailableCapability},getSubscribeForVoiceMessagingStatusChangesCapability:function(){return this._serviceAvailableCapability}})}(AvayaClientServices),function(e){"use strict";function t(e){this._messageWaiting=e}t.prototype={isMessageWaiting:function(){return this._messageWaiting},_setMessageWaiting:function(e){this._messageWaiting=e}},e.Services.VoiceMessaging.VoiceMessagingStatusParameters=t}(AvayaClientServices),function(c){"use strict";var e={createLogAPICallAdvice:function(r){return new c.Base.AOPAdvice(c.Base.AOPPointcutType.BEFORE,function(e,t,i,a){c.Base.Logger.info(r,"API called: "+t+"."+i)})},createWrapCaughtErrorInPromiseAdvice:function(n,o){return new c.Base.AOPAdvice(c.Base.AOPPointcutType.AROUND,function(e,t,i,a,r,s){try{return r.apply(a,s)}catch(e){return c.Base.Logger.warn(n,"Caught error in execution of function returning promise",e),T.Deferred().reject(o).promise()}})}};e.LOG_CALL_API_CALLS=e.createLogAPICallAdvice(c.Base.LoggerTags.CALL_SERVICE),e.LOG_PRESENCE_API_CALLS=e.createLogAPICallAdvice(c.Base.LoggerTags.PRESENCE_SERVICE),e.LOG_CONTACTS_API_CALLS=e.createLogAPICallAdvice(c.Base.LoggerTags.CONTACTS_SERVICE),e.LOG_MESSAGING_API_CALLS=e.createLogAPICallAdvice(c.Base.LoggerTags.MESSAGING_SERVICE),e.LOG_COLLABORATION_API_CALLS=e.createLogAPICallAdvice(c.Base.LoggerTags.COLLABORATION_SERVICE),e.LOG_CONFERENCE_API_CALLS=e.createLogAPICallAdvice(c.Base.LoggerTags.CONFERENCE_SERVICE),e.LOG_USER_API_CALLS=e.createLogAPICallAdvice(c.Base.LoggerTags.USER_SERVICE),e.WRAP_CAUGHT_CALL_ERROR=e.createWrapCaughtErrorInPromiseAdvice(c.Base.LoggerTags.CALL_SERVICE,new c.Services.Call.CallException(c.Services.Call.CallError.INTERNAL_ERROR)),e.WRAP_CAUGHT_PRESENCE_ERROR=e.createWrapCaughtErrorInPromiseAdvice(c.Base.LoggerTags.PRESENCE_SERVICE,new c.Services.Presence.PresenceError(c.Services.Presence.PresenceErrorReason.INTERNAL_ERROR)),e.WRAP_CAUGHT_CONTACTS_ERROR=e.createWrapCaughtErrorInPromiseAdvice(c.Base.LoggerTags.CONTACTS_SERVICE,new c.Services.Contacts.ContactsError(c.Services.Contacts.ContactsErrorReason.INTERNAL_ERROR)),e.WRAP_CAUGHT_MESSAGING_ERROR=e.createWrapCaughtErrorInPromiseAdvice(c.Base.LoggerTags.MESSAGING_SERVICE,new c.Services.Messaging.MessagingError(c.Services.Messaging.MessagingErrorReason.MESSAGING_INTERNAL_ERROR)),e.WRAP_CAUGHT_COLLABORATION_ERROR=e.createWrapCaughtErrorInPromiseAdvice(c.Base.LoggerTags.COLLABORATION_SERVICE,new c.Services.Collaboration.CollaborationError(c.Services.Collaboration.CollaborationErrorReason.INTERNAL_ERROR)),e.WRAP_CAUGHT_CONFERENCE_ERROR=e.createWrapCaughtErrorInPromiseAdvice(c.Base.LoggerTags.CONFERENCE_SERVICE,new c.Services.Conference.ConferenceException(c.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"An internal error occurred.")),e.WRAP_CAUGHT_USER_ERROR=e.createWrapCaughtErrorInPromiseAdvice(c.Base.LoggerTags.USER_SERVICE,new c.Base.BaseError(c.Base.ErrorReasons.INTERNAL_ERROR)),c.Base.AOPCommonAdvices=e}(AvayaClientServices),function(l){"use strict";function e(e){l.Base.Observable.call(this),this._elements={},this._appliedElementIds=[],this._elementsIds=[],this._elementAdditionDates=[],this._options=e||new l.Base.CacheOptions,this.auditIntervald=m,this._startAudit()}(e.prototype=Object.create(l.Base.Observable.prototype)).getElement=function(e){return this._elements[e]},e.prototype.getAllElements=function(){var e=[];for(var t in this._elements)this._elements.hasOwnProperty(t)&&e.push(this._elements[t]);return l.Base.Utils.removeDuplicatesFromArray(e)},e.prototype.addElement=function(e,t){return!!this._addElement(e,t)&&(this.trigger(l.Base.ElementCacheEvents.ELEMENT_ADDED,[[t]]),!0)},e.prototype.addElements=function(e){var t=this._makeRoomForNewElements(e);if(t.length)for(var i=0;i<t.length;i++)this.addElement(t[i].elementId,t[i].element)||l.Base.Logger.error(l.Base.LoggerTags.CACHE,"The element was not added",t[i]);return t},e.prototype.updateElement=function(e,t){if(e&&t){var i=this.getElement(e);if(i&&!this._areElementsEqual(i,t)){this._elements[e]=t;var a=this._getIndexOfElementId(e);return-1<a&&(this._elementAdditionDates.splice(a,1),this._elementsIds.splice(a,1),this._elementAdditionDates.push(new Date),this._elementsIds.push(e)),this.trigger(l.Base.ElementCacheEvents.ELEMENT_UPDATED,[t]),!0}}return!1},e.prototype.deleteElement=function(e){var t=this._deleteElement(e);return!!t&&(this.trigger(l.Base.ElementCacheEvents.ELEMENT_DELETED,[[t]]),!0)},e.prototype.empty=function(){var e=[];for(var t in this._elements)if(this._elements.hasOwnProperty(t)){var i=this._deleteElement(t);i&&e.push(i)}this.trigger(l.Base.ElementCacheEvents.ELEMENT_DELETED,[e])},e.prototype.applyElements=function(e,t){for(var i,a,r=e.length,s=[],n=[],o=0;o<r;o++)i=e[o].elementId,a=e[o].element,i&&a&&(this._addElement(i,a)?(this._appliedElementIds.push(i),s.push(a)):this.updateElement(i,a)||this.getElement(i)?this._appliedElementIds.push(i):l.Base.Logger.warn(l.Base.LoggerTags.CACHE,"Failed to add or update cache element",a));if(0<s.length&&this.trigger(l.Base.ElementCacheEvents.ELEMENT_ADDED,[s]),!t){for(i in this._elements)if(-1===T.inArray(i,this._appliedElementIds)){var c=this._deleteElement(i);c&&n.push(c)}this._appliedElementIds=[]}0<n.length&&this.trigger(l.Base.ElementCacheEvents.ELEMENT_DELETED,[n])},e.prototype.getCacheSize=function(){return this._elementsIds.length},e.prototype.getCacheMaxSize=function(){return this._options.maxElements},e.prototype._addElement=function(e,t){if(e&&t&&!this.getElement(e)){var i=this._makeRoomForNewElements([{elementId:e,element:t}]);if(i.length)return this._elements[i[0].elementId]=i[0].element,this._elementsIds.push(i[0].elementId),this._elementAdditionDates.push(new Date),this._startAudit(),!0}return!1},e.prototype._deleteElement=function(e){var t=this.getElement(e);if(t){delete this._elements[e];var i=this._getIndexOfElementId(e);return-1<i&&(this._elementAdditionDates.splice(i,1),this._elementsIds.splice(i,1)),this.getCacheSize()||this._stopAudit(),t}return m},e.prototype._deleteElements=function(e){for(var t=!0,i=e.length,a=0;a<i;a++)this._deleteElement(e[a])||(t=!1,l.Base.Logger.error(l.Base.LoggerTags.CACHE,"The element was not deleted",e[a]));return t},e.prototype._areElementsEqual=function(e,t){return e===t||"function"==typeof e.equals&&e.equals(t)},e.prototype._makeRoomForNewElements=function(e){var t=this.getCacheSize(),i=this.getCacheMaxSize(),a=void 0!==i?i-t:m,r=e.length,s=void 0!==a?r-a:m,n=e.slice();return i&&i<r?(this.empty(),n=e.slice(-i),l.Base.Logger.warn(l.Base.LoggerTags.CACHE,"Some elements can not be added, because the size of adding data more then max cache size",e.slice(0,-i))):s&&0<s&&this._deleteElements(this._elementsIds.slice(0,s)),n},e.prototype._startAudit=function(){this._options.auditInterval?this.auditIntervald||(this.auditIntervald=setInterval(function(){this._audit()}.bind(this),this._options.auditInterval)):this._stopAudit()},e.prototype._audit=function(){if(this._options.timeToLive)for(var e=new Date,t=this._elementAdditionDates.length,i=0;i<t;i++){if(e-this._elementAdditionDates[i]>this._options.timeToLive){var a=this._elementsIds[i];this._deleteElement(a)}}},e.prototype._stopAudit=function(){this.auditIntervald&&(clearInterval(this.auditIntervald),this.auditIntervald=m)},e.prototype._getIndexOfElementId=function(e){var t=this._elementsIds.indexOf(e);return-1===t&&l.Base.Logger.warn(l.Base.LoggerTags.CACHE,"Can not find index of element",e),t},l.Base.ElementCache=e}(AvayaClientServices),function(t){"use strict";function e(e){this._audioInputInterfaceService=e,t.Base.MediaInterface.call(this,e)}(e.prototype=Object.create(t.Base.MediaInterface.prototype)).setVolume=function(e){t.Base.Logger.warn(t.Base.LoggerTags.MEDIA_ENGINE,"Deprecated function is called: setVolume.")},e.prototype.getVolume=function(){t.Base.Logger.warn(t.Base.LoggerTags.MEDIA_ENGINE,"Deprecated function is called: getVolume.")},e.prototype._canPickDevices=function(){return!0},e.prototype.toString=function(){return"Mic"},t.Base.AudioInputInterface=e}(AvayaClientServices),function(t){"use strict";function e(){t.Base.MediaInterfaceService.call(this),this._deviceIdentifier=t.Base.MediaTypes.AUDIO_INPUT,this._audioInputVolumeController=m,this._localStreamMap={}}(e.prototype=Object.create(t.Base.MediaInterfaceService.prototype)).start=function(e){return this._audioInputVolumeController=new t.Base.AudioInputVolumeController,t.Base.MediaInterfaceService.prototype.start.call(this,e)},e.prototype.stop=function(e){return this._audioInputVolumeController&&(this._audioInputVolumeController.stop(),this._audioInputVolumeController=m),this._localStreamMap={},t.Base.MediaInterfaceService.prototype.stop.call(this,e)},e.prototype._buildDevice=function(e){return new t.Base.AudioDevice(e.deviceId,e.groupId,e.label,t.Base.MediaTypes.AUDIO_INPUT)},e.prototype.localMediaStreamCreated=function(e,t){e&&t&&0<t.getAudioTracks().length&&(this._localStreamMap[e]=t)},e.prototype.setVolume=function(e){this._audioInputVolumeController.setVolume(e)},e.prototype.getVolume=function(){return this._audioInputVolumeController.getVolume()},e.prototype.getAudioInputVolumeController=function(){return this._audioInputVolumeController},e.prototype.replaceLocalMediaStream=function(e,t){this._localStreamMap[e]=t},e.prototype.removeLocalMediaStream=function(e){delete this._localStreamMap[e]},e.prototype.getLocalMediaStream=function(e){return this._localStreamMap[e]},t.Base.AudioInputInterfaceService=e}(AvayaClientServices),function(e){"use strict";function t(e,t){this._inputInterface=e,this._outputInterface=t,this._localStreamMap={}}(t.prototype=Object.create(e.Base.MediaInterface.prototype)).getInputInterface=function(){return this._inputInterface},t.prototype.start=function(){return T.when(this._inputInterface.start(),this._outputInterface.start())},t.prototype.stop=function(){return T.when(this._inputInterface.stop(),this._outputInterface.stop())},t.prototype.getOutputInterface=function(){return this._outputInterface},t.prototype.getLocalMediaStream=function(e){if(this._inputInterface.getMediaAccessCapability().isAllowed)return this._inputInterface._audioInputInterfaceService.getLocalMediaStream(e);throw new Error("AudioInterface.getLocalMediaStream(): Capability not allowed")},t.prototype.getRemoteMediaStream=function(e){if(this._outputInterface.getMediaAccessCapability().isAllowed)return this._outputInterface._audioOutputInterfaceService.getRemoteMediaStream(e);throw new Error("AudioInterface.getRemoteMediaStream(): Capability not allowed")},e.Base.AudioInterface=t}(AvayaClientServices),function(i){"use strict";function e(e){this._audioOutputInterfaceService=e,i.Base.MediaInterface.call(this,e),this.addOnSelectedDeviceChangedCallback(e.onSelectedDeviceChanged.bind(e))}(e.prototype=Object.create(i.Base.MediaInterface.prototype)).mute=function(){if(!this._mediaAccessCapability.isAllowed)throw new Error("AudioOutputInterface.mute: Capability not allowed");this._audioOutputInterfaceService.mute()},e.prototype.unmute=function(){if(!this._mediaAccessCapability.isAllowed)throw new Error("AudioOutputInterface.unmute: Capability not allowed");this._audioOutputInterfaceService.unmute()},e.prototype.isMuted=function(){if(this._mediaAccessCapability.isAllowed)return this._audioOutputInterfaceService.isMuted();throw new Error("AudioOutputInterface.isMuted(): Capability not allowed")},e.prototype.setVolume=function(e){if(!this._mediaAccessCapability.isAllowed)throw new Error("AudioOutputInterface.setVolume(): Capability not allowed");this._audioOutputInterfaceService.setVolume(e)},e.prototype.getVolume=function(){if(this._mediaAccessCapability.isAllowed)return this._audioOutputInterfaceService.getVolume();throw new Error("AudioOutputInterface.getVolume(): Capability not allowed")},e.prototype._canPickDevices=function(){var e=i.Base.Utils.getBrowserType(),t=[i.Base.BrowserType.CHROME,i.Base.BrowserType.CHROME_EXTENSION];return i.Base.Utils.includes(e,t)},e.prototype.toString=function(){return"Speaker"},i.Base.AudioOutputInterface=e}(AvayaClientServices),function(t){"use strict";function e(){t.Base.MediaInterfaceService.call(this),this._deviceIdentifier=t.Base.MediaTypes.AUDIO_OUTPUT,this._audioOutput=m,this._remoteStreamMap={}}(e.prototype=Object.create(t.Base.MediaInterfaceService.prototype)).start=function(e){return t.Base.Utils.getBrowserType()===t.Base.BrowserType.SAFARI?this._audioOutput=new t.Base.SafariAudioOutput:this._audioOutput=new t.Base.AudioOutput,t.Base.MediaInterfaceService.prototype.start.call(this,e)},e.prototype.stop=function(e){return this._audioOutput&&(this._audioOutput.stop(),this._audioOutput=m),this._remoteStreamMap={},t.Base.MediaInterfaceService.prototype.stop.call(this,e)},e.prototype._buildDevice=function(e){return new t.Base.AudioDevice(e.deviceId,e.groupId,e.label,t.Base.MediaTypes.AUDIO_OUTPUT)},e.prototype.mute=function(){this._audioOutput.mute()},e.prototype.unmute=function(){this._audioOutput.unmute()},e.prototype.isMuted=function(){return this._audioOutput.isMuted()},e.prototype.setVolume=function(e){this._audioOutput.setVolume(e)},e.prototype.getVolume=function(){return this._audioOutput.getVolume()},e.prototype.onSelectedDeviceChanged=function(e,t){this._audioOutput.onSelectedDeviceChanged(t)},e.prototype.getAudioOutput=function(){return this._audioOutput},e.prototype.getRemoteMediaStream=function(e){return this._remoteStreamMap[e]},e.prototype.setRemoteMediaStream=function(e,t){this._remoteStreamMap[e]=t},e.prototype.removeRemoteMediaStream=function(e){delete this._remoteStreamMap[e]},t.Base.AudioOutputInterfaceService=e}(AvayaClientServices),function(i){"use strict";function e(){i.Base.Observable.call(this),this._config=m,this._credentialProvider=m,this._protocolTypes={secure:"",nonSecure:""}}(e.prototype=Object.create(i.Base.Observable.prototype)).start=function(e,t,i,a,r,s){var n=T.Deferred();return this._config=e,this._credentialProvider=t,this.onOpen(),n.resolve(),n.promise()},e.prototype.send=function(e,t,i){},e.prototype.getBufferedAmount=function(){return 0},e.prototype._onCredentialsRequired=function(e){},e.prototype.onInvalidCredentialsProvided=function(e,t){},e.prototype._getServerURL=function(e){var t="";return e&&i.Base.Utils.isDefined(e.url)?t=e.url:this._config&&(t+=(this._config.isSecure?this._protocolTypes.secure:this._protocolTypes.nonSecure)+"://",this._config.credentials&&(t+=this._config.credentials+"@"),t+=this._config.hostName,this._config.port&&(t+=":"+this._config.port)),e&&e.urlSuffix?t+=e.urlSuffix:this._config&&this._config.path&&(t+=this._config.path),e&&e.query?t+="?"+e.query:this._config&&this._config.query&&(t+="?"+this._config.query),t},e.prototype.run=function(e){},e.prototype.close=function(){this.onClose()},e.prototype.onOpen=function(){},e.prototype.onClose=function(){},e.prototype.onMessage=function(e){},e.prototype.onError=function(e){},e.prototype.onConnectionUnavailable=function(){},i.Base.AbstractNetworkProvider=e}(AvayaClientServices),function(o){"use strict";function e(e,t,i){function a(e,r){e.onOpen=function(e){r.onOpen(e)},e.onMessage=function(i,a){setTimeout(function(){try{var e=i.data?i.data:i,t=!!this._failoverPingData&&"wsIsPingMessage"in this._failoverPingData&&this._failoverPingData.wsIsPingMessage(e);i.type===o.Base.ProvidersEventTypes.PING||(o.Base.Utils.isDefined(this._failoverPingData)&&this._failoverPingData.wsKeepAliveEnabled&&(this._failoverPingData.wsIsPongMessage(e)||t)?t?r._log(o.Base.Logger.debug,"Received ping request."):r._log(o.Base.Logger.debug,"Received pong response."):r._networkLogger.logRecvMessage(i,a))}catch(e){r._log(o.Base.Logger.error,"Error caught while logging. ",e)}r.onMessage(i,a)}.bind(this))},e.onClose=function(e){r.onClose(e)},e.onError=function(e){r.onError(e)},e.on(o.Base.NetworkErrorCodes.HTTP_REDIRECTION,r._handleRedirect.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_MOVED_PERMANENTLY,r._handleRedirect.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_FOUND,r._handleRedirect.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_SEE_OTHER,r._handleRedirect.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_NOT_MODIFIED,r._handleRedirect.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_USE_PROXY,r._handleRedirect.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_TEMPORARY_REDIRECT,r._handleRedirect.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_PERMANENT_REDIRECT,r._handleRedirect.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_BAD_REQUEST,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_UNAUTHORIZED,r._handleUnauthorized.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_PAYMENT_REQUIRED,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_FORBIDDEN,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_NOT_FOUND,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_METHOD_NOT_ALLOWED,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_NOT_ACCEPTABLE,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_PROXY_AUTHENTICATION_REQUIRED,r._handleUnauthorized.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_REQUEST_TIMEOUT,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_CONFLICT,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_GONE,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_LENGTH_REQUIRED,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_PRECONDITION_FAILED,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_PAYLOAD_TO_LARGE,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_URI_TOO_LONG,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_UNSUPPORTED_MEDIA_TYPE,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_NETWORK_ERROR,r._handleNetworkError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_INTERNAL_SERVER_ERROR,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_NOT_IMPLEMENTED,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_BAD_GATEWAY,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_SERVICE_UNAVAILABLE,r._retry.bind(r)),e.on(o.Base.NetworkErrorCodes.HTTP_GATEWAY_TIMEOUT,r._handleError.bind(r)),e.on(o.Base.NetworkErrorCodes.WEBSOCKET_UNAUTHORIZED,r._handleUnauthorized.bind(r))}o.Base.AbstractNetworkProvider.apply(this),this._parentLoggerTag=i,this._networkLogger=new o.Base.NetworkLogger(i),this._communicationAdapter={},this._mainProvider=e,this._fallbackProvider=t,this._config=m,this._credentialProvider=m,this._failoverCallback=m,this._reconnectionMainProvider=!1,this._unauthorizedCount=0,this._closing=!1,this._failoverPromise=m,this._onCredentialsRequired=function(){},this.onConnectionUnavailable=function(){!this._closing&&this._failoverCallback&&this._fallbackProvider&&!this._failoverPromise?(this._log(o.Base.Logger.debug,"onConnectionUnavailable Callback - Reconnection process start with fallback provider"),this._reconnectionMainProvider?this._fallbackProvider&&(this._reconnectionMainProvider=!1,this._communicationAdapter=this._fallbackProvider,this._executeFailoverCallback()):(this._reconnectionMainProvider=!0,this._communicationAdapter=this._mainProvider,this._executeFailoverCallback().then(function(){this._reconnectionMainProvider=!1}.bind(this)))):this._closing||!this._failoverCallback||this._failoverPromise||(this._log(o.Base.Logger.debug,"onConnectionUnavailable Callback - Reconnection process start without fallback provider"),this._executeFailoverCallback())}.bind(this),a(this._mainProvider,this),this._mainProvider.onConnectionUnavailable=this.onConnectionUnavailable,this._fallbackProvider&&(a(this._fallbackProvider,this),this._fallbackProvider.onConnectionUnavailable=this.onConnectionUnavailable),this._communicationAdapter=this._mainProvider}(e.prototype=Object.create(o.Base.AbstractNetworkProvider.prototype)).start=function(e,t,i,a,r,s){this._failoverCallback=r,this._config=e,this._credentialProvider=t,this._closing=!1,this._failoverPromise&&"resolved"===this._failoverPromise.state()&&(this._failoverPromise=m);var n={message:m,options:i||{}};return this._credentialProvider&&this._onCredentialsRequired(n),a||(a=new o.Base.NetworkRequestRetryHelper(function(){return this._closing?T.Deferred().reject().promise():this.start(this._config,t,i,a,r,s)}.bind(this))),this._communicationAdapter.start(this._config,this._credentialProvider,n.options,a,s)},e.prototype.send=function(e,t,i,a){a||this._networkLogger.logSendMessage(e,t,this._communicationAdapter);var r={message:e,options:t};return this._credentialProvider&&this._onCredentialsRequired(r,this._credentialProvider),i||(i=new o.Base.NetworkRequestRetryHelper(function(){return this.send(e,t,i)}.bind(this))),this._communicationAdapter.send(r.message,r.options,i)},e.prototype.close=function(e){return this._closing=!0,e||(e=new o.Base.NetworkRequestRetryHelper(function(){return this.close()}.bind(this))),this._communicationAdapter.close(e)},e.prototype._handleUnauthorized=function(t){var i=t.getDeferred(),e=new o.Config.InvalidCredentialsEvent(this._unauthorizedCount,function(e){this._credentialProvider=e,t.getRequestRetryHelper().getRetryCallback()().then(function(e){this._unauthorizedCount=0,i.resolve(e),this.trigger(o.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this),function(e){i.reject(new o.Base.NetworkError(o.Base.ErrorReasons.NETWORK_UNAUTHORIZED,e))})}.bind(this),function(){i.reject(new o.Base.NetworkError(o.Base.ErrorReasons.NETWORK_AUTHORIZATION_CANCELED))}.bind(this));this.trigger(o.Base.NetworkProviderEvents.UNAUTHORIZED,[e]),this._unauthorizedCount++,this._credentialProvider?this._credentialProvider._onInvalidCredentialsProvidedCallbacks.fire(e):i.reject(new o.Base.NetworkError(o.Base.ErrorReasons.NETWORK_UNAUTHORIZED))},e.prototype._handleRedirect=function(e){o.Base.Utils.isDefined(e.getRetryAfter())?(this._log(o.Base.Logger.warn,"Request failed. Retrying after "+e.getRetryAfter()),this._retry(e)):this._handleError(e)},e.prototype._handleError=function(e){var t=new o.Base.NetworkError(o.Base.ErrorReasons.NETWORK_ERROR,e);this._log(o.Base.Logger.error,"Network error occurred. Status: "+e.getStatus()),e.getDeferred().reject(t),this.onError(t)},e.prototype._handleNetworkError=function(e){var t=new o.Base.NetworkError(o.Base.ErrorReasons.NETWORK_ERROR,e);this._log(o.Base.Logger.error,"Network error occurred. Status: "+e.getStatus()),e.getDeferred().reject(t),this.onError(t)},e.prototype.registerBlackList=function(e){this._networkLogger.registerBlackList(e),this._mainProvider&&"function"==typeof this._mainProvider.registerBlackList&&this._mainProvider.registerBlackList(e),this._fallbackProvider&&"function"==typeof this._fallbackProvider.registerBlackList&&this._fallbackProvider.registerBlackList(e)},e.prototype._retry=function(e){e.getRequestRetryHelper().incrementCounter();var t=e.getDeferred(),i=e.getRetryAfter(),a=e.getRequestRetryHelper().getRetryCounter();i&&a<this._config.maxConnectionErrorCount?(setTimeout(function(){e.getRequestRetryHelper().getRetryCallback()().then(t.resolve,t.reject)},i),t.notify(o.Base.NetworkProviderEvents.RETRYING)):this._handleError(e)},e.prototype.isOpened=function(){return this._communicationAdapter.isOpened()},e.prototype.getBufferedAmount=function(){return this._communicationAdapter.getBufferedAmount()},e.prototype.run=function(e){return this._communicationAdapter.run(e)},e.prototype.stopMonitorFallback=function(){this._fallbackProvider&&(this._fallbackProvider.close(),this._fallbackProvider=m),this._failoverCallback=m},e.prototype._executeFailoverCallback=function(){return this._closing||this._failoverPromise||"function"!=typeof this._failoverCallback||(this._failoverPromise=this._failoverCallback().always(function(){this._failoverPromise=m}.bind(this))),this._failoverPromise},e.prototype._log=function(e){var t=Array.prototype.slice.call(arguments,1);t.unshift(this._parentLoggerTag),e.call(m,o.Base.LoggerTags.NETWORK_PROVIDER,t)},e.prototype.disableNetworkLogging=function(){this._networkLogger.logSendMessage=function(){},this._networkLogger.logRecvMessage=function(){}},e.prototype.disableOptionsLogging=function(e){this._networkLogger.disableOptionsLogging(e)},o.Base.NetworkProvider=e}(AvayaClientServices),function(o){"use strict";function e(){var r,s=this;this._url="",this._interval=1e3,this.startPolling=function(e,t,i,a){this._url=e,this._interval=t,r=setInterval(function(){o.Base.Logger.info(o.Base.LoggerTags.REST_NETWORK_PROVIDER,"polling "+s._url),function(e,t,i,a,r){var s={type:"GET",url:e,dataType:"text",data:T.param(t)};if(o.Base.Utils.isDefined(i)&&(i.crossDomain&&!0===i.crossDomain&&(s.xhrFields={withCredentials:!0},s.crossDomain=!0),i.authentication&&i.authentication.type===o.Config.Authentication.Scheme.BASIC)){var n=o.Config.Authentication.Header.basic(i.authentication.username,i.authentication.password);s.beforeSend=function(e){e.setRequestHeader("Authorization",n)}}T.ajax(s).then(a,r)}(s._url,i,a,function(e){s.onMessage({data:e})},function(e){s.onError(e)})},s._interval)},this.stopPolling=function(){clearInterval(r)}}o.Providers=o.Providers||{},e.prototype=Object.create(o.Base.AbstractNetworkProvider.prototype),o.Base.PollingRESTProvider=e}(AvayaClientServices),function(l){"use strict";function e(){l.Base.AbstractNetworkProvider.call(this),this.type=l.Base.ProviderTypes.REST_PROVIDER,this._xhrPool=[],this._protocolTypes={secure:"https",nonSecure:"http"}}(e.prototype=Object.create(l.Base.AbstractNetworkProvider.prototype)).defaultOptions={url:m,sendType:"POST",timeout:3e4,urlSuffix:"",dataType:"text",headers:{},processData:!0},e.prototype.start=function(e,t,i,a){return l.Base.AbstractNetworkProvider.prototype.start.call(this,e.restConfig,t,i,a)},e.prototype.send=function(e,t,i){var a,r=T.extend({},this.defaultOptions,t),s={url:this._getServerURL(r),type:r.sendType,timeout:r.timeout,dataType:r.dataType,jsonp:!1,headers:r.headers,processData:r.processData,beforeSend:function(e){e.withCredentials=!0,this._xhrPool.push(e),a=e}.bind(this)};r.binaryProgressCallback&&(s.binaryProgressCallback=r.binaryProgressCallback),r.keepAliveCallback&&(s.keepAliveCallback=r.keepAliveCallback),r.responseType&&(s.responseType=r.responseType),e&&(s.data=e),r.crossDomain&&!0===r.crossDomain&&(s.crossDomain=!0),l.Base.Utils.isDefined(r.async)&&!0!==r.async||(s.xhrFields={withCredentials:!0}),l.Base.Utils.isDefined(r.contentType)&&(s.contentType=r.contentType);var n=[l.Config.Authentication.Scheme.BASIC,l.Config.Authentication.Scheme.BEARER];if(r.authentication&&l.Base.Utils.includes(r.authentication.type,n)){var o;if(r.authentication.type===l.Config.Authentication.Scheme.BASIC)o=l.Config.Authentication.Header.basic(r.authentication.username,r.authentication.password);else{var c=r.authentication.bearer||l.Config.Authentication.TokenType.BEARER;o=l.Config.Authentication.Header.bearer(c,r.authentication.token)}s.beforeSend=function(e){e.withCredentials=!0,e.setRequestHeader("Authorization",o),this._xhrPool.push(e),a=e}.bind(this)}return r.cancel&&(s.cancel=function(){a.abort(new l.Base.NetworkError(l.Base.ErrorReasons.NETWORK_CANCELED))}),l.Base.Utils.isDefined(r.async)&&!1===r.async?(s.async=!1,this._sendSync(s)):this._sendAsync(s,i)},e.prototype._sendAsync=function(e,a){var r=T.Deferred();return T.ajax(e).then(function(e,t,i){this._ajaxOnSuccess(e,t,i,r)}.bind(this),function(e,t,i){0===e.status&&(e.status=l.Base.NetworkErrorCodes.HTTP_NETWORK_ERROR),this._ajaxOnError(e,t,i,r,a)}.bind(this)),r.promise()},e.prototype._sendSync=function(e){var a=T.Deferred();return e.success=function(e,t,i){this._ajaxOnSuccess(e,t,i,a)}.bind(this),e.error=function(e,t,i){0===e.status&&(e.status=l.Base.NetworkErrorCodes.HTTP_NETWORK_ERROR),this._ajaxOnError(e,t,i,a)}.bind(this),T.ajax(e),a.promise()},e.prototype._ajaxOnSuccess=function(e,t,i,a){return this._removeXhrFromPool(i),this.onMessage(e,i),a.resolve(e,i),e},e.prototype._ajaxOnError=function(e,t,i,a,r){var s=new l.Base.NetworkErrorEvent(r,a,e.status,e.responseText,e.getResponseHeader("Retry-After"));if(this.hasListeners(e.status))this.trigger(e.status,[s]);else{this.onError(t);var n=new l.Base.NetworkError(l.Base.ErrorReasons.NETWORK_ERROR,new l.Base.NetworkErrorEvent(m,m,e.status,e.responseText));a.reject(n,e)}return this._removeXhrFromPool(e),e},e.prototype.close=function(){return this._xhrPool.forEach(function(e){e.abort()}),this._xhrPool=[],this.onClose(),T.Deferred().resolve().promise()},e.prototype.abort=function(){this._xhrPool.forEach(function(e){e.abort()}),this._xhrPool=[]},e.prototype._removeXhrFromPool=function(e){-1<this._xhrPool.indexOf(e)&&this._xhrPool.splice(this._xhrPool.indexOf(e),1)},l.Base.RESTProvider=e}(AvayaClientServices),function(a){"use strict";function e(e,t){function i(e,i){for(var t in e.onOpen=function(e){i.onOpen(e)},e.onMessage=function(e,t){e&&e.type===a.Base.ProvidersEventTypes.PING&&i._keepAlive(),i.onMessage(e,t)},e.onClose=function(e){i.onClose(e)},e.onError=function(e){i.onError(e)},e.onConnectionUnavailable=function(e){i.onConnectionUnavailable(e)},a.Base.NetworkErrorCodes)a.Base.NetworkErrorCodes.hasOwnProperty(t)&&e.on(a.Base.NetworkErrorCodes[t],i._triggerErrors.bind(i))}a.Base.AbstractNetworkProvider.apply(this),this.type=a.Base.ProviderTypes.SSE_PROVIDER,this._restProvider=e,this._sseProvider=t,this._onCredentialsRequired=function(){},i(this._restProvider,this),i(this._sseProvider,this),this._config={},this._credentialProvider={},this._keepAliveTimeout=m,this._failoverPingData=m}(e.prototype=Object.create(a.Base.AbstractNetworkProvider.prototype)).onConnectionUnavailable=function(){},e.prototype.start=function(e,t,i,a,r){this._config=e,this._credentialProvider=t,this._failoverPingData=r;var s={message:m,options:i};this._credentialProvider&&this._onCredentialsRequired(s);var n=this._sseProvider.start(this._config,this._credentialProvider,s.options,a),o=this._restProvider.start(this._config,this._credentialProvider,s.options,a);return T.when(n,o).done(function(){this._keepAlive()}.bind(this)).fail(function(){this.close(),setTimeout(function(){this.onConnectionUnavailable()}.bind(this))}.bind(this))},e.prototype.send=function(e,t,i){var a={message:e,options:t};return this._credentialProvider&&this._onCredentialsRequired(a),this._restProvider.send(a.message,a.options,i)},e.prototype.close=function(){return T.when(this._restProvider.close(),this._sseProvider.close())},e.prototype.isOpened=function(){return this._sseProvider.isOpened()},e.prototype._triggerErrors=function(e){this.trigger(e._status,[e])},e.prototype._keepAlive=function(){this._keepAliveTimeout&&clearTimeout(this._keepAliveTimeout),this._failoverPingData&&this._failoverPingData.ssePingInterval&&(this._keepAliveTimeout=setTimeout(function(){this.close(),clearTimeout(this._keepAliveTimeout),this.onConnectionUnavailable()}.bind(this),this._failoverPingData.ssePingInterval))},a.Base.SSEIntegrationProvider=e}(AvayaClientServices),function(a){"use strict";function e(e){a.Base.AbstractNetworkProvider.apply(this),this._stream=m,this._isOpened=!1,this._isShutdown=!1,this._eventTypes=e||[],this._protocolTypes={secure:"https",nonSecure:"http"}}(e.prototype=Object.create(a.Base.AbstractNetworkProvider.prototype)).start=function(e,t,i){var a=T.Deferred();return this._isOpened?(this.onOpen(),a.resolve()):(this._maxConnectionErrorCount=e.maxConnectionErrorCount,this._config=e.sseConfig,this._isShutdown=!1,this._credentialProvider=t,this._createStream(i,a)),a.promise()},e.prototype.close=function(){this._isShutdown=!0,this._stream&&(this._stream.close(),this._stream=m),this._isOpened?this._isOpened=!1:this.onClose()},e.prototype.isOpened=function(){return this._isOpened&&1===this._stream.readyState},e.prototype._createStream=function(e,t){this._isOpening=!0,this._stream=new EventSource(this._getServerURL(e),{withCredentials:!0}),this._stream.onopen=function(){this._isOpening=!1,this._isShutdown?(this._stream.close(),t.reject()):(this._isOpened=!0,this.onOpen(),t.resolve())}.bind(this),this._stream.onerror=function(e){(a.Base.Utils.isUndefined(e.readyState)||e.readyState===EventSource.CLOSED&&!this._isOpening)&&(this._isOpened=!1,this._stream.close(),this._stream=m,this.onClose()),this.onError(e),t.reject()}.bind(this);for(var i=0;i<this._eventTypes.length;i++)this._stream.addEventListener(this._eventTypes[i],function(e){this.onMessage(e)}.bind(this))},a.Base.SSEProvider=e}(AvayaClientServices),function(s){"use strict";function e(){s.Base.AbstractNetworkProvider.apply(this),this.type=s.Base.ProviderTypes.WEB_SOCKET_PROVIDER,this._socket=m,this._isOpened=!1,this._isShutdown=!1,this._isOnConnectionUnavailableShutdown=!1,this._protocolTypes={secure:"wss",nonSecure:"ws"},this._failoverPingData=m,this._keepAliveTimeout=m,this._keepAliveAnswerWaitingTimeout=m}(e.prototype=Object.create(s.Base.AbstractNetworkProvider.prototype)).onConnectionUnavailable=function(){},e.prototype.start=function(e,t,i,a,r,s){var n=T.Deferred();return this._failoverPingData=r,this._isOpened?(n.resolve(),this.onOpen()):(this._config=e.webSocketConfig,this._maxConnectionErrorCount=e.maxConnectionErrorCount,this._isShutdown=!1,this._isOnConnectionUnavailableShutdown=!1,this._credentialProvider=t,window.WebSocket===m?(n.reject(),setTimeout(function(){this.onConnectionUnavailable()}.bind(this))):this._createSocket(i,a,s,n)),n.promise()},e.prototype.send=function(e,t,i){var a=T.Deferred();return this.isOpened()?(this._socket.send(e),a.resolve()):a.reject("Socket is not opened!"),a.promise()},e.prototype.close=function(){this._isShutdown=!0,this._isOpened&&(this._stopKeepAlive(),this._socket.onmessage=m,this._socket.onclose=m,this._socket.onerror=m,this._socket.close(),this._isOpened=!1),this.onClose(),this._socket=m},e.prototype.isOpened=function(){return this._isOpened&&1===this._socket.readyState},e.prototype.getBufferedAmount=function(){return this._socket?this._socket.bufferedAmount:0},e.prototype._createSocket=function(e,a,t,r){this._isOpening=!0;var i=e?e.wsSecureProtocolData:m;this._socket=new WebSocket(this._getServerURL(e),i),this._socket.binaryType="arraybuffer",this._socket.onmessage=t||function(e){s.Base.Utils.isDefined(this._failoverPingData)&&this._failoverPingData.wsKeepAliveEnabled&&this._failoverPingData.wsIsPongMessage(e.data)&&(clearTimeout(this._keepAliveAnswerWaitingTimeout),this._keepAliveAnswerWaitingTimeout=m,this._keepAlive()),this.onMessage(e)}.bind(this),this._socket.onopen=function(){this._isOpening=!1,this._isShutdown?this._socket&&this._socket.close():(this._isOpened=!0,r.resolve(),s.Base.Utils.isDefined(this._failoverPingData)&&this._failoverPingData.wsKeepAliveEnabled&&this._keepAlive(),this.onOpen())}.bind(this),this._socket.onclose=function(e){this._stopKeepAlive();var t=!1;if(e.code===s.Base.NetworkErrorCodes.WEBSOCKET_UNAUTHORIZED&&this._isOpened&&!this._isOnConnectionUnavailableShutdown)t=!0,setTimeout(function(){this.onConnectionUnavailable()}.bind(this),0);else if(e.code!==s.Base.NetworkErrorCodes.WEBSOCKET_CLOSE_NORMAL&&!this._isOnConnectionUnavailableShutdown&&this.hasListeners(e.code)){var i=new s.Base.NetworkErrorEvent(a,r,e.code);this.trigger(e.code,[i])}this._isOpening||(r.reject(),this._isOpened=!1,this._socket=m,this.onClose()),this._isOpened||this._isShutdown||(r.reject(),t||setTimeout(function(){this.onConnectionUnavailable()}.bind(this)))}.bind(this),this._socket.onerror=function(e){r.reject(),this.onError(e),this.onConnectionUnavailable(e)}.bind(this)},e.prototype._keepAlive=function(){s.Base.Utils.isDefined(this._failoverPingData)&&s.Base.Utils.isDefined(this._failoverPingData.wsPingInterval)&&(this._keepAliveTimeout=setTimeout(function(){var e=this._failoverPingData.wsGeneratePingMessage();this.send(e),this._keepAliveAnswerWaitingTimeout=setTimeout(function(){this._isOnConnectionUnavailableShutdown=!0,this.close(),this.onConnectionUnavailable()}.bind(this),this._failoverPingData.keepAliveAnswerWaitingTime)}.bind(this),this._failoverPingData.wsPingInterval))},e.prototype._stopKeepAlive=function(){s.Base.Utils.isDefined(this._keepAliveTimeout)&&(clearTimeout(this._keepAliveTimeout),this._keepAliveTimeout=m),s.Base.Utils.isDefined(this._keepAliveAnswerWaitingTimeout)&&(clearTimeout(this._keepAliveAnswerWaitingTimeout),this._keepAliveAnswerWaitingTimeout=m)},s.Base.WebSocketProvider=e}(AvayaClientServices),function(e){"use strict";function t(){this.defaultMessage="One or more elements in provided array are not compatible with required type."}(t.prototype=Object.create(e.Base.Validators.BaseValidator.prototype)).validate=function(e,t,i){var a=e.filter(function(e){return typeof e===t.expected||"object"==typeof e&&e instanceof t.expected}).length===e.length;return this._processCondition(a,e,t,i)},e.Base.Validators.ArrayElementTypeValidator=t}(AvayaClientServices),function(e){"use strict";var t={resolution1080p:new e.Base.VideoResolutionDetails(1920,1080,1792,9999),resolution720p:new e.Base.VideoResolutionDetails(1280,720,1024,1792),resolution480p:new e.Base.VideoResolutionDetails(848,480,640,1024),resolution360p:new e.Base.VideoResolutionDetails(640,360,384,640),resolution240p:new e.Base.VideoResolutionDetails(416,240,256,384),resolution180p:new e.Base.VideoResolutionDetails(320,180,128,256)};e.Base.VideoResolution=t}(AvayaClientServices),function(s){"use strict";function e(e,t,i){s.Providers.Interfaces.AbstractProvider.call(this),this._acsNetworkProvider=e,this._contactsConverter=t,this._requestBuilder=i,this._state=s.Providers.ACS.ACSProviderStates.STOPPED,this._allowedCapability=new s.Base.Capability(s.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._deniedCapability=new s.Base.Capability(s.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._contactsCapability=this._deniedCapability,this._resolveContactsCapability=this._deniedCapability,this._terminalCapability=this._deniedCapability,this._conferenceSearchCapability=this._deniedCapability,this._blackListedWords=["userEmail","contactIdentifier","contactUrl","surName","givenName","displayName","asciiGivenName","asciiSurName","asciiDisplayName","isBuddy","favourite","notes","instantConnection","videoCapable","phoneNumberList","emailAddresses","preferredLanguage","type","rank","updatedTimestamp","alias","imaddresses","company","location","streetAddress","city","state","country","postalCode","manager","department","workRoomNo","value","Authorization","editable","isPrimary","searchCriteria","maxResults","data","contacts"]}(e.prototype=Object.create(s.Providers.Interfaces.AbstractProvider.prototype)).getProviderType=function(){return"ACS"},e.prototype.start=function(e,t){var i=T.Deferred();return this._changeState(s.Providers.ACS.ACSProviderStates.STARTING).then(function(){this._acsNetworkProvider.registerBlackList(this._blackListedWords),this._acsNetworkProvider.on(s.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(s.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._acsNetworkProvider.on(s.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(s.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),this._acsNetworkProvider.on(s.Providers.ACS.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,function(){this.trigger(s.Providers.ACS.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE)}.bind(this)),this._acsNetworkProvider.on(s.Providers.ACS.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,function(){this.trigger(s.Providers.ACS.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE)}.bind(this)),t.addOnContactsServiceAvailableCallback(function(){this.recalculateCapabilities()}.bind(this)),t.addOnContactsServiceUnavailableCallback(function(){this.recalculateCapabilities()}.bind(this)),this._acsNetworkProvider.start(e.acsConfiguration,t).then(function(){this._changeState(s.Providers.ACS.ACSProviderStates.STARTED).then(function(){this.recalculateCapabilities(),this._acsNetworkProvider.on("acs_availability_changed",this.recalculateCapabilities.bind(this)),i.resolve()}.bind(this),function(e){i.reject(e)})}.bind(this),function(e){s.Base.Logger.error(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to start ACSNetworkProvider",e),i.reject(e)})}.bind(this),function(e){i.reject(e)}),i.promise()},e.prototype.stop=function(){var t=T.Deferred();return this._changeState(s.Providers.ACS.ACSProviderStates.STOPPING).always(function(){this._acsNetworkProvider.stopIfNoSubscriptions().then(function(){this._changeState(s.Providers.ACS.ACSProviderStates.STOPPED),t.resolve()}.bind(this),function(e){s.Base.Logger.warn(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"acsNetworkProvider stop if no subscriptions was failed",e),t.reject(e)})}.bind(this)),t.promise().always(function(){this.recalculateCapabilities(),this._removeListeners()}.bind(this))},e.prototype._changeState=function(t){return t!==this._state?(this._state=t,this._handleStateChange(t).fail(function(e){s.Base.Logger.warn(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to change state to "+t,e)})):T.Deferred().resolve().promise()},e.prototype._handleStateChange=function(e){return T.Deferred().resolve().promise()},e.prototype.recalculateCapabilities=function(){var e=this._deniedCapability,t=this._deniedCapability,i=this._deniedCapability,a=this._deniedCapability,r=this._acsNetworkProvider.getResources();this._acsNetworkProvider.isAcsAvailable()&&(r.capabilities&&0<=r.capabilities.indexOf("contacts")&&(e=this._allowedCapability,!0===r.v2MediaType&&(t=this._allowedCapability)),r.contactSearchCapabilities&&0<=r.contactSearchCapabilities.indexOf("terminal")&&(i=this._allowedCapability),r.resources&&r.resources.contacts&&r.resources.contacts.GET&&r.resources.contacts.GET.searchIViewContacts&&r.resources.contacts.GET.searchIViewContacts.href&&(a=this._allowedCapability)),this._contactsCapability===e&&this._resolveContactsCapability===t&&this._terminalCapability===i&&this._conferenceSearchCapability===a||(this._contactsCapability=e,this._resolveContactsCapability=t,this._terminalCapability=i,this._conferenceSearchCapability=a,this.trigger(s.Providers.Interfaces.ContactsProviderCallbackIds.CAPABILITIES_CHANGED))},e.prototype.getMaxSearchResultsTotal=function(){return this._acsNetworkProvider.getMaxSearchResultsTotal()},s.Providers.ACS.ACSBaseProviderV1=e}(AvayaClientServices),function(i){"use strict";function e(){i.Providers.Interfaces.ContactsProvider.call(this),this._providers={},this._selectedProvider=m,this._userConfig={}}(e.prototype=T.extend({},i.Providers.Interfaces.ContactsProvider.prototype)).registerACSContactsProvider=function(e,t){t.on(i.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(i.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),t.on(i.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(i.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),t.on(i.Providers.ACS.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,function(){this.trigger(i.Providers.ACS.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE)}.bind(this)),t.on(i.Providers.ACS.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,function(){this.trigger(i.Providers.ACS.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE)}.bind(this)),this._providers[e]=t},e.prototype.start=function(e,t){T.isEmptyObject(e)||this._userConfig===e||(this._userConfig=e);var i=this._determineServerVersion();return this._selectedProvider=this._providers[i],this._selectedProvider.start(e,t)},e.prototype._determineServerVersion=function(){return 1},e.prototype.getProviderType=function(){return this._selectedProvider.getProviderType()},e.prototype.stop=function(){return this._selectedProvider?this._selectedProvider.stop():T.Deferred().resolve().promise()},e.prototype.createContactForAdd=function(){return this._selectedProvider.createContactForAdd()},e.prototype.addContact=function(e){return this._selectedProvider.addContact(e)},e.prototype.updateContact=function(e){return this._selectedProvider.updateContact(e)},e.prototype.deleteContact=function(e){return this._selectedProvider.deleteContact(e)},e.prototype.retrieveAllContacts=function(){return this._selectedProvider.retrieveAllContacts()},e.prototype.getContactsChanges=function(){return this._selectedProvider.getContactsChanges()},e.prototype.getAddContactCapability=function(){return this._selectedProvider.getAddContactCapability()},e.prototype.getUpdateContactCapability=function(){return this._selectedProvider.getUpdateContactCapability()},e.prototype.getDeleteContactCapability=function(){return this._selectedProvider.getDeleteContactCapability()},e.prototype.getExtendedContactDetailsCapability=function(){return this._selectedProvider.getExtendedContactDetailsCapability()},e.prototype.addOnContactAddedCallback=function(e){return this._selectedProvider.addOnContactAddedCallback(e)},e.prototype.removeOnContactAddedCallback=function(e){return this._selectedProvider.removeOnContactAddedCallback(e)},e.prototype.addOnContactUpdatedCallback=function(e){return this._selectedProvider.addOnContactUpdatedCallback(e)},e.prototype.removeOnContactUpdatedCallback=function(e){return this._selectedProvider.removeOnContactUpdatedCallback(e)},e.prototype.addOnContactDeletedCallback=function(e){return this._selectedProvider.addOnContactDeletedCallback(e)},e.prototype.removeOnContactDeletedCallback=function(e){return this._selectedProvider.removeOnContactDeletedCallback(e)},e.prototype.on=function(e,t){return this._selectedProvider?this._selectedProvider.on(e,t):i.Providers.Interfaces.ContactsProvider.prototype.on.call(this,e,t)},e.prototype.off=function(e,t){return this._selectedProvider.off(e,t)},i.Providers.ACS.ACSContactsProvider=e}(AvayaClientServices),function(o){"use strict";function e(e,t,i){o.Providers.Interfaces.ContactsProvider.call(this),o.Providers.ACS.ACSBaseProviderV1.call(this,e,t,i),this._subscribedForNotifications=!1,this._contactsCache=new o.Base.ElementCache,this._contactsCache.on(o.Base.ElementCacheEvents.ELEMENT_ADDED,function(e){var t=e.map(function(e){return this._contactsConverter.convertACSContactV1toContact(e)}.bind(this));this.trigger(o.Providers.Interfaces.ContactsProviderCallbackIds.CONTACT_ADDED,[t,this])}.bind(this)),this._contactsCache.on(o.Base.ElementCacheEvents.ELEMENT_UPDATED,function(e){this.trigger(o.Providers.Interfaces.ContactsProviderCallbackIds.CONTACT_UPDATED,[this._contactsConverter.convertACSContactV1toContact(e),this])}.bind(this)),this._contactsCache.on(o.Base.ElementCacheEvents.ELEMENT_DELETED,function(e){var t=e.map(function(e){return this._contactsConverter.convertACSContactV1toContact(e)}.bind(this));this.trigger(o.Providers.Interfaces.ContactsProviderCallbackIds.CONTACT_DELETED,[t,this])}.bind(this))}(e.prototype=T.extend({},o.Providers.Interfaces.ContactsProvider.prototype,o.Providers.ACS.ACSBaseProviderV1.prototype)).createContactForAdd=function(){var e=new o.Services.Contacts.EditableContact,t=new o.Base.Capability(o.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED);return e.getCustom1()._setWriteCapability(t),e.getCustom2()._setWriteCapability(t),e.getCustom3()._setWriteCapability(t),e.getScopiaUserId()._setWriteCapability(t),e.getScopiaLoginId()._setWriteCapability(t),e},e.prototype.addContact=function(e){var t=this._contactsConverter.convertContactToACSContactV1(e),i=this._requestBuilder.buildAddUpdateContactData(t),a=this._requestBuilder.buildAddContactOptions();return this._acsNetworkProvider.send(i,a).then(this._onContactAdded.bind(this))},e.prototype._onContactAdded=function(e){(e=this._contactsConverter.extendAcsContact(e)).contactUrl&&e.contactUrl.value&&this._contactsCache.addElement(e.contactUrl.value,e)},e.prototype.updateContact=function(e){var t=this._contactsCache.getElement(e._uniqueAddressForMatching);if(!t)return o.Base.Logger.error(o.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Can not update contact because its old version is not found in cache"),T.Deferred().reject(new o.Services.Contacts.ContactsError(o.Services.Contacts.ContactsErrorReason.INTERNAL_ERROR));var i=this._contactsConverter.mergeContactWithACSContactV1(e,t),a=this._requestBuilder.buildAddUpdateContactData(i),r=this._requestBuilder.buildUpdateContactOptions();return this._acsNetworkProvider.send(a,r).then(this._onContactUpdated.bind(this))},e.prototype._onContactUpdated=function(e){(e=this._contactsConverter.extendAcsContact(e)).contactUrl&&e.contactUrl.value&&this._contactsCache.updateElement(e.contactUrl.value,e)},e.prototype.deleteContact=function(e){var t=this._requestBuilder.buildDeleteContactOptions(e._uniqueAddressForMatching);return this._acsNetworkProvider.send(null,t).then(function(){this._onContactDeleted(e._uniqueAddressForMatching)}.bind(this))},e.prototype._onContactDeleted=function(e){e&&this._contactsCache.deleteElement(e)},e.prototype.retrieveAllContacts=function(){return this._getContacts().then(function(){this._subscribeForContactChangesNotifications()}.bind(this),function(e){return T.Deferred().reject(e).promise()},function(e){return this._applyContactsToCache(e.contacts,!0),this._contactsConverter.convertACSContactArraytoContactArray(e.contacts)}.bind(this))},e.prototype._subscribeForContactChangesNotifications=function(){if(!this._subscribedForNotifications){this._subscribedForNotifications=!0;var e=this._requestBuilder.buildSubscribeForACSNotifications(o.Providers.ACS.ACSConstants.SVC_GET_CONTACTS);this._acsNetworkProvider.subscribeForNotifications(e,this._onContactChangeNotification.bind(this)).fail(function(e){this._subscribedForNotifications=!1,o.Base.Logger.error(o.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to subscribe for contact changes notifications",e)}.bind(this))}},e.prototype._unsubscribeFromContactChangesNotifications=function(){var e;if(this._subscribedForNotifications){this._subscribedForNotifications=!1;var t=this._requestBuilder.buildUnsubscribeFromACSNotifications(o.Providers.ACS.ACSConstants.SVC_GET_CONTACTS);e=this._acsNetworkProvider.unsubscribeFromNotifications(t).fail(function(e){this._subscribedForNotifications=!0,o.Base.Logger.warn(o.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to unsubscribe from contact changes notifications: "+JSON.stringify(e))}.bind(this))}else e=T.Deferred().resolve().promise();return e},e.prototype._onContactChangeNotification=function(e){if(this._isContactChangeNotificationValid(e))if(e.action===o.Providers.ACS.ACSContentsActions.DELETE)this._onContactDeleted(e.url);else if(e.action===o.Providers.ACS.ACSContentsActions.REFRESH)this.retrieveAllContacts();else{var t;if(e.action===o.Providers.ACS.ACSContentsActions.ADD)t=this._onContactAdded;else if(e.action===o.Providers.ACS.ACSContentsActions.UPDATE){if(!this._contactsCache.getElement(e.url))return void o.Base.Logger.warn(o.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Received notification for unknown contact");t=this._onContactUpdated}var i=this._requestBuilder.buildGetContactOptions(e.url);this._acsNetworkProvider.send(null,i).then(t.bind(this),function(e){o.Base.Logger.error(o.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to download contact list updates: "+JSON.stringify(e))})}},e.prototype._isContactChangeNotificationValid=function(t){if(!t||!t.action||!t.url)return o.Base.Logger.error(o.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Received notification in unexpected format: "+JSON.stringify(t)),!1;if(""===t.url)return o.Base.Logger.error(o.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Received notification with empty URL"),!1;return!!function(){for(var e in o.Providers.ACS.ACSContentsActions)if(o.Providers.ACS.ACSContentsActions.hasOwnProperty(e)&&t.action===o.Providers.ACS.ACSContentsActions[e])return!0;return!1}()||(o.Base.Logger.error(o.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Received notification with unknown or empty type: "+t.action),!1)},e.prototype._applyContactsToCache=function(e,t){for(var i=e.length,a=[],r=0;r<i;r++)e[r].contactUrl&&e[r].contactUrl.value?a.push({elementId:e[r].contactUrl.value,element:this._contactsConverter.extendAcsContact(e[r])}):o.Base.Logger.warn(o.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Received contact does not have contactUrl set, ignoring it",e[r]);this._contactsCache.applyElements(a,t)},e.prototype._getContacts=function(){var a=T.Deferred(),r=this._requestBuilder.buildGetContactsOptions(),s=function(e){o.Base.Logger.error(o.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to retrieve contacts",e),a.reject(e)},n=function(e){if(!e)return a.resolve();if(a.notify(e),e.hasMoreResults){var t=e.contacts.length-1,i=e.contacts[t].id.value;if(!i)return o.Base.Logger.warn(o.Base.LoggerTags.ACS_CONTACTS_PROVIDER,'Last contact of the partial response to retrieve contacts request does not have "id" property set (required for consequent requests)',e.contacts[t]),a.reject(new o.Services.Contacts.ContactsError(o.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE));r=this._requestBuilder.buildGetContactsOptions(i),this._acsNetworkProvider.send(null,r).then(n.bind(this),s)}else a.resolve()};return this._acsNetworkProvider.send(null,r).then(n.bind(this),s),a.promise()},e.prototype.getContactsChanges=function(){},e.prototype.getAddContactCapability=function(){return this._contactsCapability},e.prototype.getUpdateContactCapability=function(){return this._contactsCapability},e.prototype.getDeleteContactCapability=function(){return this._contactsCapability},e.prototype.getExtendedContactDetailsCapability=function(){return this._contactsCapability},e.prototype._handleStateChange=function(e){var t;switch(e){case o.Providers.ACS.ACSProviderStates.STOPPING:t=this._unsubscribeFromContactChangesNotifications();break;case o.Providers.ACS.ACSProviderStates.STOPPED:this._contactsCache.empty(),t=T.Deferred().resolve().promise();break;default:t=T.Deferred().resolve().promise()}return t},o.Providers.ACS.ACSContactsProviderV1=e}(AvayaClientServices),function(e){"use strict";function t(){e.Providers.Interfaces.DirectorySearchProvider.call(this),this._providers={},this._selectedProvider=m,this._userConfig={}}(t.prototype=T.extend({},e.Providers.Interfaces.DirectorySearchProvider.prototype)).registerACSDirectorySearchProvider=function(e,t){this._providers[e]=t},t.prototype.start=function(e,t){T.isEmptyObject(e)||this._userConfig===e||(this._userConfig=e);var i=this._determineServerVersion();return this._selectedProvider=this._providers[i],this._selectedProvider.start(e,t)},t.prototype._determineServerVersion=function(){return 1},t.prototype.getProviderType=function(){return this._selectedProvider.getProviderType()},t.prototype.stop=function(){return this._selectedProvider?this._selectedProvider.stop():T.Deferred().resolve().promise()},t.prototype.startDirectorySearch=function(e){return this._selectedProvider.startDirectorySearch(e)},t.prototype.stopDirectorySearch=function(e){return this._selectedProvider.stopDirectorySearch(e)},t.prototype.startResolvingContacts=function(e,t){return this._selectedProvider.startResolvingContacts(e,t)},t.prototype.getNetworkSearchContactCapability=function(){return this._selectedProvider.getNetworkSearchContactCapability()},t.prototype.getNetworkResolveContactsCapability=function(){return this._selectedProvider.getNetworkResolveContactsCapability()},t.prototype.getNetworkSearchTerminalCapability=function(){return this._selectedProvider.getNetworkSearchTerminalCapability()},t.prototype.getConferenceSearchCapability=function(){return this._selectedProvider.getConferenceSearchCapability()},t.prototype.on=function(e,t){return this._selectedProvider.on(e,t)},t.prototype.off=function(e,t){return this._selectedProvider.off(e,t)},t.prototype.getSelfContact=function(){return this._selectedProvider.getSelfContact()},e.Providers.ACS.ACSDirectorySearchProvider=t}(AvayaClientServices),function(u){"use strict";function e(e,t,i,a,r){u.Providers.Interfaces.DirectorySearchProvider.call(this),u.Providers.ACS.ACSBaseProviderV1.call(this,e,t,i),this._activeSearches={},this._searchResultsQueue=new u.Base.ElementCache({maxElements:50}),this._acsContactsCache=r,this._contactsAnalyticsService=a}(e.prototype=T.extend({},u.Providers.Interfaces.DirectorySearchProvider.prototype,u.Providers.ACS.ACSBaseProviderV1.prototype)).startDirectorySearch=function(i){var a=T.Deferred(),e={},t="{}";if(i.getSearchNetworkSource()===u.Services.Contacts.SearchNetworkSource.CONFERENCE_ONLY){if(e=this._requestBuilder.buildSearchContactsIViewOnlyOptions(),t=this._requestBuilder.buildSearchContactsIViewOnlyData(i),!(this._acsNetworkProvider._acsConfig&&this._acsNetworkProvider._acsConfig.credentialProvider&&this._acsNetworkProvider._acsConfig.credentialProvider&&this._acsNetworkProvider._acsConfig.credentialProvider.token))return u.Base.Logger.error(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Can't make conference only search - authorization token is not provided",new u.Services.Contacts.ContactsError(u.Services.Contacts.ContactsErrorReason.AUTHORIZATION_FAILED)),a.reject(new u.Services.Contacts.ContactsError(u.Services.Contacts.ContactsErrorReason.AUTHORIZATION_FAILED))}else e=this._requestBuilder.buildSearchContactsOptions(),t=this._requestBuilder.buildSearchContactsData(i);return e.url?(this._acsNetworkProvider.send(t,e).then(function(e){if(i.getSearchNetworkSource()===u.Services.Contacts.SearchNetworkSource.CONFERENCE_ONLY){if(!e||!e.results)return u.Base.Logger.error(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Server returned invalid response to search contacts request",e),this._contactsAnalyticsService.trackContactProvidersUnavailable(u.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE),a.reject(new u.Services.Contacts.ContactsError(u.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE));for(var t=0;t<e.results.length;t++)a.notify(this._contactsConverter.convertACSContactArraytoContactArray([e.results[t]]),m,e.totalresults);a.resolve(e.results.length,!0,e.totalresults)}else{if(!e||!e.searchId)return u.Base.Logger.error(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Server returned invalid response to search contacts request",e),this._contactsAnalyticsService.trackContactProvidersUnavailable(u.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE),a.reject(new u.Services.Contacts.ContactsError(u.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE));this._activeSearches[e.searchId]={searchRequestId:i.getUniqueSearchId(),deferred:a,retrievedCount:0,searchRequest:i},this.startSearchTimer(e.searchId),this._processQueuedNotifications(e.searchId)}}.bind(this),function(e){return u.Base.Logger.error(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Search contacts request failed",e),a.reject(e)}.bind(this)),a.promise()):(u.Base.Logger.error(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Search contacts request failed",new u.Services.Contacts.ContactsError(u.Services.Contacts.ContactsErrorReason.SERVER_UNAVAILABLE)),a.reject(new u.Services.Contacts.ContactsError(u.Services.Contacts.ContactsErrorReason.SERVER_UNAVAILABLE)))},e.prototype.startResolvingContacts=function(e,t){var i,a=[],r=this._requestBuilder.buildQuickSearchContactsOptions(),s=[],n=[],o=T.Deferred();for(i=0;i<e.length;i++){var c=this._acsContactsCache.getQuickSearchResultsFromCache(e[i],t);if(0<c.length)for(var l=0;l<c.length;l++)n.push(c[l]);else s.push(e[i])}n.length&&o.notify(n),o.resolve(),a.push(o.promise());var d=this._splitQuickSearchCriteriaStrings(s,50);for(i=0;i<d.length;i++){var C=this._sendQuickSearchRequest(d[i],t,r);a.push(C)}return u.Base.Utils.waitForAllPromisesCompletion(a)},e.prototype._sendQuickSearchRequest=function(e,a,t){var r=T.Deferred(),i=this._requestBuilder.buildQuickSearchContactsData(e,a);return this._acsNetworkProvider.send(i,t).then(function(t){var i;try{i=JSON.parse(t).searchId}catch(e){i="string"==typeof t?t:null}return i?this._activeSearches[i]?(u.Base.Logger.error(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Server returned duplicate searchId",i),r.reject(new u.Services.Contacts.ContactsError(u.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE))):(this._activeSearches[i]={deferred:r,quickSearch:!0,searchStrings:e,searchScope:a,retrievedCount:0,searchRequest:m},this.startSearchTimer(i),void this._processQueuedNotifications(i)):(u.Base.Logger.error(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Server returned invalid response to quick search contacts request",i),r.reject(new u.Services.Contacts.ContactsError(u.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE)))}.bind(this),function(e){return u.Base.Logger.error(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Quick search contacts request failed",e),r.reject(e)}),r.promise()},e.prototype._splitQuickSearchCriteriaStrings=function(e,t){for(var i=[],a=0;a<e.length;a+=t)i.push(e.slice(a,a+t));return i},e.prototype.startSearchTimer=function(t){setTimeout(function(){if(this._activeSearches.hasOwnProperty(t)){u.Base.Logger.warn(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Result for search with ID "+t+" wasn't received in time.");var e=this._activeSearches[t].deferred;delete this._activeSearches[t],e.reject(new u.Services.Contacts.ContactsError(u.Services.Contacts.ContactsErrorReason.REQUEST_TIMEOUT))}}.bind(this),3e4)},e.prototype.stopDirectorySearch=function(e){var t,i;for(var a in this._activeSearches)if(this._activeSearches.hasOwnProperty(a)&&this._activeSearches[a].searchRequestId===e){i=a,t=this._activeSearches[a];break}t?delete this._activeSearches[i]:u.Base.Logger.warn(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Unable to cancel contact search. Search is already cancelled, completed or doesn't exist.")},e.prototype.getNetworkSearchContactCapability=function(){return this._contactsCapability},e.prototype.getNetworkResolveContactsCapability=function(){return this._resolveContactsCapability},e.prototype.getNetworkSearchTerminalCapability=function(){return this._terminalCapability},e.prototype.getConferenceSearchCapability=function(){return this._conferenceSearchCapability},e.prototype._subscribeForNotifications=function(){var e=this._requestBuilder.buildSubscribeForACSNotifications(u.Providers.ACS.ACSConstants.SVC_SEARCH_CONTACTS);return this._acsNetworkProvider.subscribeForNotifications(e,this._onSearchNotification.bind(this)).fail(function(e){u.Base.Logger.error(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to subscribe for notifications",e)})},e.prototype._unsubscribeFromNotifications=function(){var e=this._requestBuilder.buildUnsubscribeFromACSNotifications(u.Providers.ACS.ACSConstants.SVC_SEARCH_CONTACTS);return this._acsNetworkProvider.unsubscribeFromNotifications(e).fail(function(e){u.Base.Logger.warn(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to unsubscribe from notifications",e)})},e.prototype._onSearchNotification=function(e){this._isSearchNotificationValid(e)&&(this._activeSearches[e.searchId]?this._processSearchNotification(e):(u.Base.Logger.debug(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Received search notification with unknown ID "+e.searchId+", caching it"),this._searchResultsQueue.getElement(e.searchId)||this._searchResultsQueue.addElement(e.searchId,[]),this._searchResultsQueue.getElement(e.searchId).push(e)))},e.prototype._processSearchNotification=function(e){var t,i=this._activeSearches[e.searchId],a=i.deferred;try{t=JSON.parse(e.data)}catch(e){return u.Base.Logger.error(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to parse search results",e),this._contactsAnalyticsService.trackContactProvidersUnavailable(u.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE),void a.reject(new u.Services.Contacts.ContactsError(u.Services.Contacts.ContactsErrorReason.INVALID_SERVER_RESPONSE))}if(i.quickSearch){var r=this._contactsConverter.convertQuickSearchResults(t,i.searchStrings,i.searchScope);a.notify(r),this._acsContactsCache.addQuickSearchResultsToCache(r)}else a.notify(this._contactsConverter.convertACSContactArraytoContactArray(t));t&&0<t.length&&this._activeSearches[e.searchId].retrievedCount++;var s=this.getMaxSearchResultsTotal();i.searchRequest&&(s=0<i.searchRequest.getMaxResults()?Math.min(i.searchRequest.getMaxResults(),this.getMaxSearchResultsTotal()):this.getMaxSearchResultsTotal()),"false"===e.hasMoreResults?(a.resolve(this._activeSearches[e.searchId].retrievedCount,!0,this._activeSearches[e.searchId].retrievedCount),delete this._activeSearches[e.searchId]):this._activeSearches[e.searchId].retrievedCount===s&&(a.resolve(this._activeSearches[e.searchId].retrievedCount,!1),delete this._activeSearches[e.searchId])},e.prototype._processQueuedNotifications=function(e){var t=this._searchResultsQueue.getElement(e);if(t){for(var i=0;i<t.length;i++)this._processSearchNotification(t[i]);this._searchResultsQueue.deleteElement(e)}},e.prototype._isSearchNotificationValid=function(e){return!!(e&&e.searchId&&e.data&&e.hasMoreResults)||(u.Base.Logger.error(u.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Received invalid search results",e),!1)},e.prototype._handleStateChange=function(e){var t;switch(e){case u.Providers.ACS.ACSProviderStates.STARTED:t=this._subscribeForNotifications();break;case u.Providers.ACS.ACSProviderStates.STOPPING:this._activeSearches={},this._searchResultsQueue.empty(),t=this._unsubscribeFromNotifications();break;default:t=T.Deferred().resolve().promise()}return t},e.prototype.getSelfContact=function(){var t=T.Deferred(),e=new u.Services.Contacts.ContactSearchRequest(this._acsNetworkProvider.getResources().self,u.Services.Contacts.SearchFieldType.ALL,u.Services.Contacts.SearchSourceType.NETWORK,1,0,u.Services.Contacts.SearchNetworkSource.ANYWHERE);return this.startDirectorySearch(e).then(function(){}.bind(this),function(e){return t.reject(e)},function(e){if(!e||!e[0])return t.reject(new u.Services.Contacts.ContactsError(u.Services.Contacts.ContactsErrorReason.INTERNAL_ERROR));t.resolve(e[0])}),t.promise()},u.Providers.ACS.ACSDirectorySearchProviderV1=e}(AvayaClientServices),function(i){"use strict";var e=i.Providers.Call;e.StartCallEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.StartCallEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.StartCallEvent.stringValue="START_CALL",e.StartCallResponseEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.StartCallResponseEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.StartCallResponseEvent.stringValue="START_CALL_RESPONSE",e.DeviceRetrievalFailedEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.DeviceRetrievalFailedEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.DeviceRetrievalFailedEvent.stringValue="DEVICE_RETRIEVAL_FAILED",e.GetOfferSDPEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.GetOfferSDPEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.GetOfferSDPEvent.stringValue="GET_OFFER_SDP",e.OfferSDPEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.OfferSDPEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.OfferSDPEvent.stringValue="OFFER_SDP",e.RejectOfferSDPEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.RejectOfferSDPEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.RejectOfferSDPEvent.stringValue="REJECT_OFFER_SDP",e.OfferSDPFirefoxMidcallEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.OfferSDPFirefoxMidcallEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.OfferSDPFirefoxMidcallEvent.stringValue="OFFER_SDP_FIREFOX",e.CallRingingEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.CallRingingEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.CallRingingEvent.stringValue="CALL_RINGING",e.AnswerSDPEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.AnswerSDPEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.AnswerSDPEvent.stringValue="ANSWER_SDP",e.CallEstablishedEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.CallEstablishedEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.CallEstablishedEvent.stringValue="CALL_ESTABLISHED",e.EndCallEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.EndCallEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.EndCallEvent.stringValue="END_CALL",e.EndCallResponseEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.EndCallResponseEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.EndCallResponseEvent.stringValue="END_CALL_RESPONSE",e.OnAddStreamEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.OnAddStreamEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.OnAddStreamEvent.stringValue="ON_ADD_STREAM",e.IncomingCallEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.IncomingCallEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.IncomingCallEvent.stringValue="INCOMING_CALL",e.AcceptCallEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.AcceptCallEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.AcceptCallEvent.stringValue="ACCEPT_CALL",e.AcceptSendVideoEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.AcceptSendVideoEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.AcceptSendVideoEvent.stringValue="ACCEPT_SEND_VIDEO",e.MuteAudioEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.MuteAudioEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.MuteAudioEvent.stringValue="MUTE_AUDIO",e.UnmuteAudioEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.UnmuteAudioEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.UnmuteAudioEvent.stringValue="UNMUTE_AUDIO",e.MuteVideoEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.MuteVideoEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.MuteVideoEvent.stringValue="MUTE_VIDEO",e.UnmuteVideoEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.UnmuteVideoEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.UnmuteVideoEvent.stringValue="UNMUTE_VIDEO",e.MuteSpeakerEvent=function e(){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,{})},e.MuteSpeakerEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.MuteSpeakerEvent.stringValue="MUTE_SPEAKER",e.UnmuteSpeakerEvent=function e(){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,{})},e.UnmuteSpeakerEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.UnmuteSpeakerEvent.stringValue="UNMUTE_SPEAKER",e.BlockCameraEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.BlockCameraEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.BlockCameraEvent.stringValue="BLOCK_CAMERA",e.UnBlockCameraEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.UnBlockCameraEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.UnBlockCameraEvent.stringValue="UNBLOCK_CAMERA",e.HoldEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.HoldEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.HoldEvent.stringValue="HOLD",e.UnHoldEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.UnHoldEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.UnHoldEvent.stringValue="UNHOLD",e.EscalateVideoEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.EscalateVideoEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.EscalateVideoEvent.stringValue="ESCALATE_VIDEO",e.EscalateNailedUpVideoEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.EscalateNailedUpVideoEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.EscalateNailedUpVideoEvent.stringValue="ESCALATE_NAILED_UP_VIDEO",e.EscalateVideoAnswerEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.EscalateVideoAnswerEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.EscalateVideoAnswerEvent.stringValue="ESCALATE_VIDEO_GETOFFER",e.EscalateVideoGetOfferEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.EscalateVideoGetOfferEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.EscalateVideoGetOfferEvent.stringValue="ESCALATE_VIDEO_ANSWER",e.EscalateVideoOfferEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.EscalateVideoOfferEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.EscalateVideoOfferEvent.stringValue="ESCALATE_VIDEO_OFFER",e.EscalateVideoRejectedEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.EscalateVideoRejectedEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.EscalateVideoRejectedEvent.stringValue="ESCALATE_VIDEO_REJECTED",e.DeEscalateVideoEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.DeEscalateVideoEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.DeEscalateVideoEvent.stringValue="DEESCALATE_VIDEO",e.AnswerSdpAckEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.AnswerSdpAckEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.AnswerSdpAckEvent.stringValue="ANSWER_SDP_ACK",e.DenySendVideoEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.DenySendVideoEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.DenySendVideoEvent.stringValue="DENY_SEND_VIDEO",e.AcceptVideoTimedOutEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.AcceptVideoTimedOutEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.AcceptVideoTimedOutEvent.stringValue="ACCEPT_VIDEO_TIMED_OUT",e.SendDTMFEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.SendDTMFEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.SendDTMFEvent.stringValue="SEND_DTMF",e.IncomingAddVideoEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.IncomingAddVideoEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.IncomingAddVideoEvent.stringValue="INCOMING_ADD_VIDEO",e.IncomingAddVideoTimedoutEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.IncomingAddVideoTimedoutEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.IncomingAddVideoTimedoutEvent.stringValue="INCOMING_ADD_VIDEO_TIMEDOUT",e.IncomingRemoveVideoEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.IncomingRemoveVideoEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.IncomingRemoveVideoEvent.stringValue="INCOMING_REMOVE_VIDEO",e.IncomingGenericOfferSDPEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.IncomingGenericOfferSDPEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.IncomingGenericOfferSDPEvent.stringValue="INCOMING_GENERIC_OFFER",e.RevertStateEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.RevertStateEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.RevertStateEvent.stringValue="REVERT_STATE",e.OnAddRemoteTrackEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.OnAddRemoteTrackEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.OnAddRemoteTrackEvent.stringValue="ON_ADD_REMOTE_TRACK",e.OnRemoveRemoteTrackEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.OnRemoveRemoteTrackEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.OnRemoveRemoteTrackEvent.stringValue="ON_REMOVE_REMOTE_TRACK",e.UpdateRemoteVideoEvent=function e(t){i.Base.SimpleFsm.SimpleFsmEvent.call(this,e.stringValue,t)},e.UpdateRemoteVideoEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.UpdateRemoteVideoEvent.stringValue="UPDATE_REMOTE_VIDEO",e.UpdateLocalStreamEvent=function e(t){i.Providers.Call.CallFsmEvent.call(this,e.stringValue,t)},e.UpdateLocalStreamEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.UpdateLocalStreamEvent.stringValue="UPDATE_LOCAL_STREAM",e.TransferEvent=function e(t){i.Providers.Call.CallFsmEvent.call(this,e.stringValue,t)},e.TransferEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.TransferEvent.stringValue="TRANSFER",e.AttendedTransferEvent=function e(t){i.Providers.Call.CallFsmEvent.call(this,e.stringValue,t)},e.AttendedTransferEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.AttendedTransferEvent.stringValue="ATTENDED_TRANSFER",e.AddParticipantFromExistingCallEvent=function e(t){i.Providers.Call.CallFsmEvent.call(this,e.stringValue,t)},e.AddParticipantFromExistingCallEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.AddParticipantFromExistingCallEvent.stringValue="ADD_PARTICIPANT_FROM_EXISTING_CALL",e.JoinRemoteCallEvent=function e(t){i.Providers.Call.CallFsmEvent.call(this,e.stringValue,t)},e.JoinRemoteCallEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.JoinRemoteCallEvent.stringValue="JOIN_REMOTE_CALL",e.CallStateFailureEvent=function e(t){i.Providers.Call.CallFsmEvent.call(this,e.stringValue,t)},e.CallStateFailureEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.CallStateFailureEvent.stringValue="CALL_STATE_FAILURE",e.CallFailureEvent=function e(t){i.Providers.Call.CallFsmEvent.call(this,e.stringValue,t)},e.CallFailureEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.CallFailureEvent.stringValue="CALL_FAILURE",e.StartRingingEvent=function e(t){i.Providers.Call.CallFsmEvent.call(this,e.stringValue,t)},e.StartRingingEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.StartRingingEvent.stringValue="START_RINGING",e.AcceptCallRequestEvent=function e(t){i.Providers.Call.CallFsmEvent.call(this,e.stringValue,t)},e.AcceptCallRequestEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.AcceptCallRequestEvent.stringValue="ACCEPT_CALL_REQUEST",e.RejectCallRequestEvent=function e(t){i.Providers.Call.CallFsmEvent.call(this,e.stringValue,t)},e.RejectCallRequestEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.RejectCallRequestEvent.stringValue="REJECT_CALL_REQUEST",e.UpdateIceRestartMediaEvent=function e(t){i.Providers.Call.CallFsmEvent.call(this,e.stringValue,t)},e.UpdateIceRestartMediaEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.UpdateIceRestartMediaEvent.stringValue="UPDATE_ICE_RESTART_MEDIA_REQUEST",e.ServiceAvailableEvent=function e(t){i.Providers.Call.CallFsmEvent.call(this,e.stringValue,t)},e.ServiceAvailableEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.ServiceAvailableEvent.stringValue="SERVICE_AVAILABLE",e.UpdatePreferredReceiveResolutionEvent=function e(t){i.Providers.Call.CallFsmEvent.call(this,e.stringValue,t)},e.UpdatePreferredReceiveResolutionEvent.prototype=Object.create(i.Base.SimpleFsm.SimpleFsmEvent.prototype),e.UpdatePreferredReceiveResolutionEvent.stringValue="PREFERRED_RESOLUTION"}(AvayaClientServices),function(g){"use strict";var o=g.Providers.CallServiceGateway.Constants,f="0",a="1",r="2",s="3",n="4";function e(e,t,i){g.Base.Observable.call(this),this._csgProvider=e,this._callProvider=m,this._messageBuilder=t,this._host=i,this._startPromise=m,this._stopPromise=m,this._onNetworkAvailable=m,this._onNetworkUnavailable=m,this._networkProviderUnavailableCounter=0,this._started=!1,this._isNetworkAvailable=!1,this._isServiceAvailable=m,this._isExternalGateway=!1,this._parsers=[],this._registerParsers(),this._ringbackToneURLs=m,this._voicemailMWI=!1,this._voicemailNumber=m,this._eventsSubscription=m,this._onNetworkEventCallback=m,this._isServerSupportsNailedUpVideoConnection=!1,this._isSupportUpdateCallProperties=!1,this._notificationQueue=[]}(e.prototype=Object.create(g.Base.Observable.prototype)).getCallProvider=function(){return this._callProvider},e.prototype.isServiceAvailable=function(){return this._isServiceAvailable},e.prototype.start=function(i,a,r,s,n,e){if(this._startPromise)return this._startPromise;this._callProvider=i;var t=T.Deferred();return this._started=!0,this._networkProviderUnavailableCounter=0,g.Base.Utils.isDefined(e)&&(this._isExternalGateway=e),this._onNetworkAvailable&&this._onNetworkUnavailable||(this._onNetworkAvailable=function(){g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Network is available. Subscribing for notifications"),this._isNetworkAvailable=!0,this._networkProviderUnavailableCounter=0,this._csgProvider.restProviderOnErrorHandler(function(e){g.Base.Logger.warn(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"REST provider error: "+e)}.bind(this)),this._subscribeForNotifications().then(function(){var e=s?s.getMinBandwidth():null,t=new g.Providers.CallServiceGateway.ServiceActivationParameters(r,e,n);return!n||this._isServerSupportsNailedUpVideoConnection||i.supportsMPaaSCollabCall()?this._csgProvider.activateService(o.CALLS,t):(g.Base.Logger.info(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Skipped service activation because a nailed up video connection is required and the server doesn't support it",o.CALLS),T.Deferred().resolve().promise())}.bind(this)).then(function(){this._isServiceAvailable=!0,this.trigger(g.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,[this._host]),this._setRingbackToneList(),g.Base.Utils.isDefined(t)&&(t.state()===g.Base.DeferredStates.PENDING?t.resolve(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.iViewToken]):t.state()===g.Base.DeferredStates.RESOLVED&&this.trigger(g.Providers.CallServiceGateway.ObservableEvents.IVIEW_TOKEN_UPDATE,[this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.iViewToken]])),this._sendPendingNotifications()}.bind(this),function(e){return t.state()===g.Base.DeferredStates.PENDING&&t.reject(e),T.Deferred().reject(e).promise()}.bind(this)),g.Base.Utils.isDefined(this._onNetworkEventCallback)&&this._csgProvider.setOnNetworkEvents(this._eventsSubscription)}.bind(this),this._onNetworkUnavailable=function(e,t){g.Base.Logger.error(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Network is unavailable: "+e),this._isNetworkAvailable=!1,this._isServiceAvailable=!1,this._isExternalGateway&&("Notification"!==e?this._networkProviderUnavailableCounter++:t.target&&t.target.url&&t.target.url.includes("http")&&this._networkProviderUnavailableCounter++,0<=a.maxCallStartReconnectionAttempts&&a.maxCallStartReconnectionAttempts<this._networkProviderUnavailableCounter&&(g.Base.Logger.warn(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Maximum network recovery attempted: "+this._networkProviderUnavailableCounter),this.trigger(g.Providers.CallServiceGateway.ObservableEvents.MAX_NETWORK_RECONNECTION_ATTEMPTED,[this._host]))),this.trigger(g.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,[this._host,e,t])}.bind(this),this._csgProvider.on(g.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,this._onNetworkAvailable),this._csgProvider.on(g.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,this._onNetworkUnavailable),this._csgProvider.on(g.Providers.CallServiceGateway.ObservableEvents.ICE_CONFIG_UPDATES,function(e){this.trigger(g.Providers.CallServiceGateway.ObservableEvents.ICE_CONFIG_UPDATES,[e])}.bind(this)),this._csgProvider.on(g.Providers.CallServiceGateway.ObservableEvents.SUPPORTED_CALL_ENHANCEMENTS,function(e){e&&e.includes("mediaChannelGuidelines")&&(this._isServerSupportsNailedUpVideoConnection=!0),this.trigger(g.Providers.CallServiceGateway.ObservableEvents.SUPPORTED_CALL_ENHANCEMENTS,[e])}.bind(this)),this._csgProvider.on(g.Providers.CallServiceGateway.ObservableEvents.UPLOAD_LOGS_UPDATE,function(e,t,i){this.trigger(g.Providers.CallServiceGateway.ObservableEvents.UPLOAD_LOGS_UPDATE,[e,t,i])}.bind(this)),this._stopPromise=m),this._startPromise=T.when(t,this._csgProvider.start(a)),this._startPromise},e.prototype.stop=function(){if(!this._started)return T.Deferred().resolve().promise();if(g.Base.Utils.isDefined(this._stopPromise))return this._stopPromise;var e=function(){this._started=!1,this._removeListeners(),this._onNetworkAvailable=m,this._onNetworkUnavailable=m,this._networkProviderUnavailableCounter=0,this._startPromise=m,this._isExternalGateway=!1,this._onNetworkEventCallback=m,this._eventsSubscription=m}.bind(this);this._stopPromise=T.Deferred();var t=function(){this._csgProvider.stop().always(e).then(function(){g.Base.Utils.isDefined(this._stopPromise)&&(this._stopPromise.resolve(),this._stopPromise=m)}.bind(this),function(e){g.Base.Logger.error(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"stop error.",e),g.Base.Utils.isDefined(this._stopPromise)&&(this._stopPromise.reject(e),this._stopPromise=m)}.bind(this))}.bind(this);return this._isNetworkAvailable?this._unsubscribeFromNotifications().always(function(){this._csgProvider.deactivateService(o.CALLS).always(t)}.bind(this)):t(),this._isNetworkAvailable=!1,this._isServiceAvailable=!1,this._stopPromise.promise()},e.prototype.stopImmediately=function(){return this._started?this._stopPromise?this._stopPromise:(this._stopPromise=T.Deferred(),this._csgProvider.stopImmediately().then(function(){this._stopPromise.resolve()}.bind(this),function(e){this._stopPromise.reject(e)}.bind(this)),this._stopPromise.promise()):T.Deferred().resolve().promise()},e.prototype._subscribeForNotifications=function(){var e=this._messageBuilder.buildSubscribeRequest(g.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Calls]),t=this._parsers[s],i=t.parse.bind(t),a=this._csgProvider.subscribeForNotifications(e,i).then(function(){g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Subscribed for calls notifications")},function(e){return g.Base.Logger.error(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to subscribe for calls notifications: "+JSON.stringify(e)),T.Deferred().reject(e).promise()}.bind(this));return g.Base.Utils.rejectIfPromiseNotResolvedInTime(a,3e4,new g.Services.Call.CallException(g.Services.Call.CallError.TIMEOUT),function(){g.Base.Logger.error(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Calls subscription confirmation was not received in time"),this.trigger(g.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,[this._host,"Notification","Unavailable"])}.bind(this))},e.prototype._unsubscribeFromNotifications=function(){var e=this._messageBuilder.buildUnsubscribeRequest(g.Providers.CallServiceGateway.Constants.TELEPHONY_SERVICE,this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Calls]);return this._csgProvider.unsubscribeFromNotifications(e).then(function(){g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Unsubscribed from calls notifications")},function(e){return g.Base.Logger.error(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to unsubscribe from calls notifications: "+JSON.stringify(e)),T.Deferred().reject(e).promise()}.bind(this))},e.prototype.getCalls=function(){var i=T.Deferred(),e=this._messageBuilder.buildGetCallsOptions(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Calls]);return this._csgProvider.send(m,e).then(function(e){g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received get calls response");var t=this._parsers[a].parse(e);i.resolve(t)}.bind(this),function(e){this._handleError("getCalls() network provider failed - "+e.statusText),i.reject(e)}.bind(this)),i.promise()},e.prototype.getCall=function(e){var i=T.Deferred(),t=this._messageBuilder.buildGetCallOptions(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Calls],e);return this._csgProvider.send(null,t).then(function(e){g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received get call response");var t=this._parsers[f].parse(e);i.resolve(t)}.bind(this),function(e){this._handleError("getCall() network provider failed - "+e.statusText),i.reject(e)}.bind(this)),i.promise()},e.prototype.getClients=function(){var i=T.Deferred(),e=this._messageBuilder.buildGetClientsOptions(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Clients]);return this._csgProvider.send(null,e).then(function(e){g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received get clients response");var t=this._parsers[r].parse(e);i.resolve(t)}.bind(this),function(e){this._handleError("getClients() network provider failed - "+e.statusText),i.reject(e)}.bind(this)),i.promise()},e.prototype.getClient=function(e){var i=T.Deferred(),t=this._messageBuilder.buildGetClientOptions(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Clients],e);return this._csgProvider.send(null,t).then(function(e){g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received get client response");var t=this._parsers[r].parseClient(e);i.resolve(t)}.bind(this),function(e){this._handleError("getClient() network provider failed - "+e.statusText),i.reject(e)}.bind(this)),i.promise()},e.prototype.startCall=function(e,t,i,a,r,s,n,o,c,l,d){var C=T.Deferred(),u=this._messageBuilder.buildStartCallOptions(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Calls]),v="";this._csgProvider.getCredentials().isGuest&&(v=this._csgProvider.getCredentials().displayName);var h={subject:"",priority:null,privacy:null,participants:[{participantId:null,remoteDisplayName:v,remoteAddress:e}],conferenceData:{userAgentCalling:null,video:a,webCollaboration:r}};if(g.Base.Utils.isDefined(t)&&0<t.length&&(h.subject=t),g.Base.Utils.isDefined(c))h.callId=c,h.conferenceData=null;else{var p=!!g.Base.Utils.isDefined(o)&&o;h.conferenceData.uccp=p,i&&(h.conferenceData.ott=i.getCallType()===g.Services.Call.CallType.CallTypeHttpMeetMe,h.conferenceData.meetingToken=i.getPortalToken()||null,h.conferenceData.meetingId=i.getConferenceID()||null,h.conferenceData.meetingPasscode=i.getPasscode()||null)}g.Base.Utils.isDefined(l)&&(h.sessionId=l),i&&g.Base.Utils.isDefined(i.getContextId)&&(h.userToUserData={contextId:i.getContextId()}),d&&(h.videoChannelGuidelines=g.Providers.CallServiceGateway.Utils.convertToVideoChannelGuidelines(d));var _=g.Providers.CallServiceGateway.Utils.convertToAudioChannel(s),S=g.Providers.CallServiceGateway.Utils.convertToVideoChannels(n,d);return h=T.extend({},h,{audioChannel:_},{videoChannels:S}),g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Sending StartCall"),this._csgProvider.send(JSON.stringify(h),u).then(function(e){g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received make call response");var t=this._parsers[f].parse(e);this._updateGatewayCapabilities(t.capabilities),C.resolve(t)}.bind(this),function(e){this._handleError("startCall() network provider failed - "+e.statusText);var t=this._handleCsgProviderSendError(e);C.reject({errorCode:t.errorCode,protocolType:t.protocolType,protocolErrorCode:t.protocolErrorCode,errorMsg:t.errorMsg})}.bind(this)),C.promise()},e.prototype.offerSDPResponse=function(e,t,i,a,r){var s=T.Deferred(),n=this._messageBuilder.buildNotificationsOptions(),o=g.Providers.CallServiceGateway.Utils.convertToAudioChannel(a),c=g.Providers.CallServiceGateway.Utils.convertToVideoChannels(r),l=this._messageBuilder.buildProcessMediaOfferResponseNotification(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Calls],e,i,t.type,t.sdp,o,c);g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Sending offer notification");try{this._csgProvider.sendNotification(JSON.stringify(l),n),s.resolve()}catch(e){s.reject(e)}return s.promise()},e.prototype.rejectOfferSDPResponse=function(e,t){var i=T.Deferred(),a=this._messageBuilder.buildNotificationsOptions(),r=this._messageBuilder.buildRejectOfferResponseNotification(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Calls],e,t.errorCode,t.errorMsg,t.displayMsg);try{this._csgProvider.sendNotification(JSON.stringify(r),a),i.resolve()}catch(e){i.reject(e)}return i.promise()},e.prototype.answerSDPResponse=function(e,t,i){var a=T.Deferred(),r=this._messageBuilder.buildNotificationsOptions(),s=g.Providers.CallServiceGateway.Utils.convertToAudioChannel(t),n=g.Providers.CallServiceGateway.Utils.convertToVideoChannels(i),o=this._messageBuilder.buildProcessMediaAnswerResponseNotification(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Calls],e,s,n);g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Sending answer notification");try{this._csgProvider.sendNotification(JSON.stringify(o),r),a.resolve()}catch(e){a.reject(e)}return a.promise()},e.prototype.getOfferSDPResponse=function(e,t,i,a){var r=T.Deferred(),s=this._messageBuilder.buildNotificationsOptions(),n=g.Providers.CallServiceGateway.Utils.convertToAudioChannel(i),o=g.Providers.CallServiceGateway.Utils.convertToVideoChannels(a),c=this._messageBuilder.buildCreateMediaResponseNotification(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Calls],e,t.type,t.sdp,n,o);g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Sending getOffer notification:\n"+t.sdp),g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,JSON.stringify(c));try{this._csgProvider.sendNotification(JSON.stringify(c),s),r.resolve()}catch(e){r.reject(e)}return r.promise()},e.prototype.blockUnBlockCamera=function(e,t,i){return this.updateMediaRequest(e,g.Providers.CallServiceGateway.CallActionType.UPDATE_VIDEO,t,i)},e.prototype.updateVideo=function(e,t,i,a){return this.updateMediaRequest(e,g.Providers.CallServiceGateway.CallActionType.UPDATE_VIDEO,t,i,a)},e.prototype.escalateVideo=function(e,t,i){return this.updateMediaRequest(e,g.Providers.CallServiceGateway.CallActionType.ADD_VIDEO,t,i)},e.prototype.deEscalateVideo=function(e,t,i){return this.updateMediaRequest(e,g.Providers.CallServiceGateway.CallActionType.REMOVE_VIDEO,t,i)},e.prototype.updateMediaRequest=function(e,t,i,a,r){var s=T.Deferred(),n=this._messageBuilder.buildNotificationsOptions(),o=g.Providers.CallServiceGateway.Utils.convertToAudioChannel(i),c=g.Providers.CallServiceGateway.Utils.convertToVideoChannels(a),l=this._messageBuilder.buildUpdateMediaRequestNotification(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Calls],e,t,o,c,r);g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Update media request: "+t);try{this._csgProvider.sendNotification(JSON.stringify(l),n),s.resolve()}catch(e){s.reject(e)}return s.promise()},e.prototype.updateCallProperties=function(e,t,i,a){if(this._isSupportUpdateCallProperties){var r=T.Deferred(),s=this._messageBuilder.buildNotificationsOptions(),n=g.Providers.CallServiceGateway.Utils.convertToVideoChannels(i),o=this._messageBuilder.buildUpdateCallPropertiesNotification(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Calls],e,t,n,a);return g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Update local video call properties: ",a),this._csgProvider.sendNotification(JSON.stringify(o),s).done(function(){r.resolve()}).fail(function(e){this._notificationQueue.push({data:JSON.stringify(o),options:s}),r.reject(e)}.bind(this)),r.promise()}return T.Deferred().reject("Gateway does not support UpdateCallProperties").promise()},e.prototype.endCall=function(e,t){var i={actionDetails:{targetCallId:null,subject:null,participants:null,conferenceData:null,sdpType:null,sdp:null,audioChannel:null,videoChannels:[]}};return g.Base.Utils.isDefined(t)&&(i.actionDetails.denyCallReason=t),this._updateCall(e,g.Providers.CallServiceGateway.CallActionType.END,i)},e.prototype.transfer=function(e,t,i,a){if(!1===this.isAllowedToTransfer(e))return T.Deferred().reject().promise();var r=g.Providers.CallServiceGateway.Utils.convertToAudioChannel(i),s=g.Providers.CallServiceGateway.Utils.convertToVideoChannels(a),n={actionDetails:{targetRemoteAddress:t,targetCallId:null,subject:null,cmLineID:null,participants:null,conferenceData:null,sdpType:null,sdp:null,audioChannel:r,videoChannels:g.Base.Utils.isDefined(s)?s:[]}};return this._updateCall(e,g.Providers.CallServiceGateway.CallActionType.TRANSFER,n)},e.prototype.isAllowedToTransfer=function(e){if(this._callProvider._cpCalls[e].call===m)return!1;var t=this._csgProvider.getCredentials();return!(t!==m&&t.bearer!==m&&t.bearer===g.Config.Authentication.TokenType.ESGTOKEN)},e.prototype.attendedTransfer=function(e,t,i,a){if(!1===this.isAllowedToTransfer(e))return T.Deferred().reject().promise();var r=g.Providers.CallServiceGateway.Utils.convertToAudioChannel(i),s=g.Providers.CallServiceGateway.Utils.convertToVideoChannels(a),n={actionDetails:{targetRemoteAddress:null,targetCallId:t,subject:null,cmLineID:null,participants:null,conferenceData:null,sdpType:null,sdp:null,audioChannel:r,videoChannels:g.Base.Utils.isDefined(s)?s:[]}};return this._updateCall(e,g.Providers.CallServiceGateway.CallActionType.TRANSFER,n)},e.prototype.addParticipantFromCall=function(e,t,i,a){var r=g.Providers.CallServiceGateway.Utils.convertToAudioChannel(i),s=g.Providers.CallServiceGateway.Utils.convertToVideoChannels(a),n={actionDetails:{targetRemoteAddress:null,targetCallId:t,subject:null,cmLineID:null,participants:null,conferenceData:null,sdpType:null,sdp:null,audioChannel:r,videoChannels:g.Base.Utils.isDefined(s)?s:[]}};return this._updateCall(e,g.Providers.CallServiceGateway.CallActionType.ADD_PARTICIPANT,n)},e.prototype.joinRemoteCall=function(e,t,i,a){var r=g.Providers.CallServiceGateway.Utils.convertToAudioChannel(t),s=g.Providers.CallServiceGateway.Utils.convertToVideoChannels(i,a),n={actionDetails:{targetRemoteAddress:null,targetCallId:null,subject:null,cmLineID:null,participants:null,conferenceData:null,sdpType:null,sdp:null,audioChannel:r,videoChannels:g.Base.Utils.isDefined(s)?s:[]}};return a&&(n.actionDetails.videoChannelGuidelines=g.Providers.CallServiceGateway.Utils.convertToVideoChannelGuidelines(a)),this._updateCall(e,g.Providers.CallServiceGateway.CallActionType.JOIN,n)},e.prototype.acceptCall=function(e,t,i,a,r){var s=g.Providers.CallServiceGateway.Utils.convertToAudioChannel(a),n=g.Providers.CallServiceGateway.Utils.convertToVideoChannels(r),o={actionDetails:{targetCallId:null,subject:null,participants:null,conferenceData:null,sdpType:t.toUpperCase(),sdp:i,audioChannel:s,videoChannels:g.Base.Utils.isDefined(n)?n:[]}};return this._updateCall(e,g.Providers.CallServiceGateway.CallActionType.ANSWER,o)},e.prototype.holdCall=function(e,t,i){return this.updateMediaRequest(e,g.Providers.CallServiceGateway.CallActionType.HOLD,t,i)},e.prototype.unholdCall=function(e,t,i){return this.updateMediaRequest(e,g.Providers.CallServiceGateway.CallActionType.UNHOLD,t,i)},e.prototype.muteVideo=function(e,t,i){return this.updateCallProperties(e,t,i,{localVideoMute:!0})},e.prototype.unmuteVideo=function(e,t,i){return this.updateCallProperties(e,t,i,{localVideoMute:!1})},e.prototype.updatePreferredReceiveResolution=function(e,t,i,a){return this.updateCallProperties(e,t,i,{preferredReceiveResolution:a})},e.prototype.startRinging=function(e){return this._updateCall(e,g.Providers.CallServiceGateway.CallActionType.RINGING)},e.prototype.acceptCallRequest=function(e,t,i){var a=T.Deferred(),r=this._messageBuilder.buildNotificationsOptions(),s=this._messageBuilder.buildAcceptCallResponse(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Calls],e,t);g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"CSGCallProvider: Sending accept call request");try{this._csgProvider.sendNotification(JSON.stringify(s),r).done(function(){a.resolve()}).fail(function(e){a.reject(e)})}catch(e){a.reject(e)}return a.promise()},e.prototype.rejectAnswerCallRequest=function(e,t){return this._rejectCallRequest(e,t)},e.prototype.rejectTerminateCallRequest=function(e,t){return this._rejectCallRequest(e,t)},e.prototype.rejectUpdateCallRequest=function(e,t,i){return this._rejectCallRequest(e,t)},e.prototype.rejectMakeCallRequest=function(e,t){return this._rejectCallRequest(e,t)},e.prototype._rejectCallRequest=function(e,t){var i=T.Deferred(),a=this._messageBuilder.buildNotificationsOptions(),r=this._messageBuilder.buildRejectCallResponse(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Calls],e,t);g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"CSGCallProvider: Sending reject call request");try{this._csgProvider.sendNotification(JSON.stringify(r),a).done(function(){i.resolve()}).fail(function(e){i.reject(e)})}catch(e){i.reject(e)}return i.promise()},e.prototype._handleError=function(e){g.Base.Logger.error(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Error detected: "+e)},e.prototype._handleCsgProviderSendError=function(e){var t={};if(200<=e.status&&e.status<300)return t;t.errorCode=g.Services.Call.CallError.TRANSPORT_ERROR,t.protocolType=g.Services.Call.CallProtocolType.HTTP,t.protocolErrorCode=e.getData().getStatus(),t.errorMsg=e.message;var i=g.Base.Utils.queryJSONObject(e,"_data._responseText");if(i){t.protocolType=g.Services.Call.CallProtocolType.APPLICATION;try{var a=JSON.parse(i);a&&(t.errorCode=g.Providers.CallServiceGateway.Utils.convertErrorCode(a.error[0].errorCode),t.errorMsg=a.error[0].errorMsg)}catch(e){}}return t},e.prototype._updateCall=function(e,i,t){var a=this._messageBuilder.buildUpdateCallOptions(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Calls],e);if(g.Base.Utils.isUndefined(a))return T.Deferred().reject().promise();var r=T.Deferred(),s={action:i};return t&&(s=T.extend(s,t)),this._csgProvider.send(JSON.stringify(s),a).then(function(e){g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Sent call action: "+i),r.resolve()}.bind(this),function(e){var t=this._handleCsgProviderSendError(e);g.Base.Utils.queryJSONObject(t,"errorCode")?(404===t.protocolErrorCode&&t.errorCode===g.Services.Call.CallError.NOT_FOUND?t.errorCode=g.Services.Call.CallError.CALL_NOT_FOUND:this._handleError(i+" call action network provider failed - "+t.errorMsg),r.reject({errorCode:t.errorCode,protocolType:t.protocolType,protocolErrorCode:t.protocolErrorCode,errorMsg:t.errorMsg})):(g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Sent call action: "+i),r.resolve())}.bind(this)),r.promise()},e.prototype.getConfiguration=function(){var i=T.Deferred(),e=this._messageBuilder.buildGetConfigurationOptions(this._csgProvider.getResourceHrefs()[g.Providers.CallServiceGateway.ResourceType.Configuration]);return this._csgProvider.send(null,e).then(function(e){g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received get configuration response");var t=this._parsers[n].parse(e);i.resolve(t)}.bind(this),function(e){this._handleError("getConfiguration() network provider failed - "+e.statusText),i.reject(e)}.bind(this)),i.promise()},e.prototype.getVoicemailNumber=function(){return this._voicemailNumber},e.prototype.setVoicemailNumber=function(e){this._voicemailNumber=e},e.prototype.setVoicemailMWI=function(e){this._voicemailMWI=e===g.Providers.CallServiceGateway.Constants.MWI_ON,this.trigger(g.Providers.Interfaces.VoiceMessagingProviderCallbackIds.MWI_STATUS_CHANGED,[e===g.Providers.CallServiceGateway.Constants.MWI_ON])},e.prototype.getVoicemailMWI=function(){return this._voicemailMWI},e.prototype.activateService=function(e,t,i){e.toUpperCase()===o.CALLS&&(g.Base.Logger.debug(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Calls activated status: "+t),t===o.ACTIVATED?this.trigger(g.Providers.CallServiceGateway.ObservableEvents.CALLS_SERVICE_ACTIVATED,[this._host]):i===o.DEACTIVATED_BY_CLIENT?g.Base.Utils.isUndefined(this._stopPromise)?(g.Base.Logger.error("Unexpected deactivation notification when service is not stopping: "+i),this._cancelOrRestartDiscovery(i),this.trigger(g.Providers.CallServiceGateway.ObservableEvents.CALLS_SERVICE_DEACTIVATED,[this._host,i])):g.Base.Logger.info("Unexpected deactivation notification when service is stopping: "+i):(this._cancelOrRestartDiscovery(i),this.trigger(g.Providers.CallServiceGateway.ObservableEvents.CALLS_SERVICE_DEACTIVATED,[this._host,i])))},e.prototype._cancelOrRestartDiscovery=function(e){switch(e){case o.REGISTRATION_TERMINATED:this._csgProvider.cancelDiscovery();break;case o.USER_DOES_NOT_MATCH:g.Base.Logger.error(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Invalidates client session due to mismatch username"),this._csgProvider.invalidateClient(),this._csgProvider.forceNetworkRecovery();break;default:this._csgProvider.forceNetworkRecovery()}},e.prototype._registerParsers=function(){this._parsers[f]=new g.Providers.CallServiceGateway.CallInfoParser,this._parsers[s]=new g.Providers.CallServiceGateway.NotificationParser(this),this._parsers[a]=new g.Providers.CallServiceGateway.ClientCallsParser(this._parsers[f]),this._parsers[r]=new g.Providers.CallServiceGateway.UserClientsParser,this._parsers[n]=new g.Providers.CallServiceGateway.ConfigurationParser},e.prototype._setRingbackToneList=function(){var e=g.Providers.CallServiceGateway.CSGToneType,a=this._csgProvider.getRestResources(),r={};a.ringbackTones&&T.each(e,function(e,t){var i=a.ringbackTones[t];i&&i.href&&(r[t]=i.href)});var t=new g.Services.Call.RingbackToneURLs;t._setRingbackToneUrl(r[e.RINGBACK]),t._setInterceptToneUrl(r[e.INTERCEPT]),t._setReorderToneUrl(r[e.REORDER]),t._setFastBusyToneUrl(r[e.FASTBUSY]),this._ringbackToneURLs&&JSON.stringify(this._ringbackToneURLs)===JSON.stringify(t)||(this._ringbackToneURLs=t,this.trigger(g.Providers.CallServiceGateway.ObservableEvents.RINGBACK_TONE_URLS_CHANGED,[t]))},e.prototype.setOnNetworkEvents=function(t,e){return this._netWorkEventsPromise=T.Deferred(),this._eventsSubscription=t,this._onNetworkEventCallback?this._csgProvider.updateOnNetworkEvents(t).then(function(e){this._validateEventsInResponse(e,t),this._netWorkEventsPromise.resolve(e)}.bind(this),function(e){var t=this._buildNetworkEventsErrorMessage(e);this._netWorkEventsPromise.reject(t)}.bind(this)):this._csgProvider.setOnNetworkEvents(t).then(function(e){this._validateEventsInResponse(e,t),this._netWorkEventsPromise.resolve(e)}.bind(this),function(e){this._onNetworkEventCallback=m;var t=this._buildNetworkEventsErrorMessage(e);this._netWorkEventsPromise.reject(t)}.bind(this)),this._onNetworkEventCallback=e,this._netWorkEventsPromise},e.prototype._buildNetworkEventsErrorMessage=function(e){var t;return t=e._data._status===o.HTTP_BAD_REQUEST?g.Services.Call.CallError.INVALID_ACCEPTED_EVENTS:g.Services.Call.CallError.NETWORK_EVENTS_SUBSCRIPTION_FAILED,new g.Services.Call.CallException(t,o.HTTP,e._data._status,e._data._responseText)},e.prototype._validateEventsInResponse=function(t,i){t.subscribedEvents.events||(t.subscribedEvents.events=[]);var e=i.acceptedEvents.events.filter(function(e){return i.acceptedEvents.excludedEvents.indexOf(e)<0});0<(e=e.filter(function(e){return t.subscribedEvents.events.indexOf(e)<0})).length&&"*"!==e[0]&&g.Base.Logger.warn(g.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Some events couldn't be subscribed: "+JSON.stringify(e))},e.prototype.isNetworkEventsUrlDefined=function(){return this._csgProvider.isNetworkEventsUrlDefined()},e.prototype.removeOnNetworkEvents=function(e){return this._removeNetWorkEventsPromise=T.Deferred(),this._csgProvider.removeOnNetworkEvents(e).then(function(e){this._onNetworkEventCallback=m,this._removeNetWorkEventsPromise.resolve(e)}.bind(this),function(e){this._removeNetWorkEventsPromise.reject(e)}.bind(this)),this._removeNetWorkEventsPromise.promise()},e.prototype.networkEventNotification=function(e){this._onNetworkEventCallback(e)},e.prototype._sendPendingNotifications=function(){var t=this._notificationQueue.shift();t&&this._csgProvider.sendNotification(t.data,t.options).then(function(){this._sendPendingNotifications()}.bind(this),function(e){this._notificationQueue.unshift(t)})},e.prototype._updateGatewayCapabilities=function(e){e&&e.updatecallpropertiesCapability&&(this._isSupportUpdateCallProperties=e.updatecallpropertiesCapability.allowed)},g.Providers.CallServiceGateway.CSGCallsProvider=e}(AvayaClientServices),function(_){"use strict";var a=_.Providers.CallServiceGateway.ObservableEvents,r=_.Providers.CallServiceGateway.Constants;function e(e,t){_.Base.Observable.call(this),this._csgProvider=e,this._messageBuilder=t,this._started=!1,this._subscriptionStatusUnknown=!1,this._presenceContainer=m,this._presenceContainerExpirationDate=m,this._presenceContainerRefreshTimeoutId=m,this._subscribePresenceTimeoutId=m,this._addressSubscriptionTimeoutId=m,this._userSubscriptions=[],this._subscriptionsDeferredMap={},this._unsubscriptionsDeferredMap={},this._onNetworkAvailable=m,this._onNetworkUnavailable=m,this._subscribedForPresence=!1,this._deletePresenceContainerPromise=m,this._createOrExtendPresenceContainerPromise=m,this._timeoutForSubscribe=1e3,this._timeoutForUnsubscribe=7e3}(e.prototype=Object.create(_.Providers.Interfaces.PresenceProvider.prototype)).start=function(e){if(this._started)return T.Deferred().resolve();var t=T.Deferred();this._onNetworkAvailable&&this._onNetworkUnavailable||(this._onNetworkAvailable=function(){_.Base.Logger.debug(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Network is available. Subscribing for notifications"),this._csgProvider.getResourceHrefs()[_.Providers.CallServiceGateway.ResourceType.PresenceSubscriptions]?this._subscribeForNotifications().then(function(){var e=new _.Providers.CallServiceGateway.ServiceActivationParameters(!0);return this._csgProvider.activateService(r.PRESENCE,e)}.bind(this)).then(function(){0<this._userSubscriptions.length?this.subscribeForPresence(this._userSubscriptions).always(function(){t.resolve()}):t.resolve()}.bind(this),function(e){t.reject(e)}):(_.Base.Logger.error(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence subscription URL is not found. Cannot subscribe for presence notifications."),t.reject(new _.Services.Presence.PresenceError(_.Services.Presence.PresenceErrorReason.UNSUPPORTED))),t.state()!==_.Base.DeferredStates.PENDING&&this.trigger(_.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE)}.bind(this),this._onNetworkUnavailable=function(){_.Base.Logger.warn(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"CSG presence provider is unavailable"),this.trigger(_.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE)}.bind(this),this._csgProvider.on(a.NETWORK_PROVIDER_IS_AVAILABLE,this._onNetworkAvailable),this._csgProvider.on(a.NETWORK_PROVIDER_IS_UNAVAILABLE,this._onNetworkUnavailable),this._csgProvider.on(_.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(_.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._csgProvider.on(_.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(_.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)));var i=this._csgProvider.start(e.sgConfiguration).then(function(){if(!this._csgProvider.getResourceHrefs()[_.Providers.CallServiceGateway.ResourceType.PresenceSubscriptions])return this._started=!1,_.Base.Logger.warn(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence is not supported for this user"),T.Deferred().reject(new _.Services.Presence.PresenceError(_.Services.Presence.PresenceErrorReason.UNSUPPORTED))}.bind(this));return T.when(i,t).then(function(){this._started=!0}.bind(this))},e.prototype.stop=function(){if(!this._started)return T.Deferred().resolve().promise();var t=T.Deferred(),e=function(){this._started=!1,this._presenceContainer=m,this._onNetworkAvailable=m,this._onNetworkUnavailable=m}.bind(this),i=function(){return this._csgProvider.stop().always(function(){e(),this._removeListeners()}.bind(this)).then(function(){t.resolve()},function(e){_.Base.Logger.error(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to stop CSGPresenceProvider",e),t.reject(e)})}.bind(this),a=function(){return clearTimeout(this._presenceContainerRefreshTimeoutId),clearTimeout(this._subscribePresenceTimeoutId),clearTimeout(this._addressSubscriptionTimeoutId),this._csgProvider.deactivateService(r.PRESENCE)}.bind(this);return this._csgProvider.isNetworkAvailable()?this._unsubscribeFromNotifications().always(function(){this.unsubscribeFromAllAddressesPresence().always(function(){a().always(function(){i()}.bind(this))}.bind(this))}.bind(this)):i(),t.promise()},e.prototype._subscribeForNotifications=function(){var e=this._messageBuilder.buildSubscribeRequest(_.Providers.CallServiceGateway.Constants.SVC_PRESENCE,this._csgProvider.getResourceHrefs()[_.Providers.CallServiceGateway.ResourceType.PresenceSubscriptions]),t=this._csgProvider.subscribeForNotifications(e,this._onNotification.bind(this)).then(function(){_.Base.Logger.debug(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Subscribed for presence notifications")},function(e){return _.Base.Logger.error(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to subscribe for presence notifications",e),T.Deferred().reject(e).promise()}.bind(this));return _.Base.Utils.rejectIfPromiseNotResolvedInTime(t,3e4,new _.Services.Presence.PresenceError(_.Services.Presence.PresenceErrorReason.TIMEOUT),function(){_.Base.Logger.error(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence subscription confirmation was not received in time"),this.trigger(_.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE)}.bind(this))},e.prototype._unsubscribeFromNotifications=function(){var e=this._messageBuilder.buildUnsubscribeRequest(_.Providers.CallServiceGateway.Constants.SVC_PRESENCE,this._csgProvider.getResourceHrefs()[_.Providers.CallServiceGateway.ResourceType.PresenceSubscriptions]);return this._csgProvider.unsubscribeFromNotifications(e).then(function(){_.Base.Logger.debug(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Unsubscribed from presence notifications")},function(e){return _.Base.Logger.error(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to unsubscribe from presence notifications: "+JSON.stringify(e)),T.Deferred().reject(e).promise()}.bind(this))},e.prototype._onNotification=function(e){if(_.Base.Logger.debug(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received notification",e),e&&e.rlPresenceUpdatedEvent){var t;try{t=JSON.parse(e.rlPresenceUpdatedEvent)}catch(e){return void _.Base.Logger.debug(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to parse notification",e)}this._onPresenceUpdatedEvent(t)}},e.prototype._onPresenceUpdatedEvent=function(e){e.serviceContainerEvent&&e.serviceContainerEvent.terminatedResources?this._handleTerminatedResources(e.serviceContainerEvent.terminatedResources):e.presentities&&0!==e.presentities.length?e.presenceDocuments?e.presenceDocuments.forEach(this._processPresenceDocument.bind(this)):e.presentities&&e.presentities.forEach(this._processPresentities.bind(this)):_.Base.Logger.warn(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received empty presence updated notification")},e.prototype._handleTerminatedResources=function(e){_.Base.Logger.info(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Handling terminated resources  error"),e.container?(_.Base.Logger.info(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Restarting container due to resource error",e.container.terminationReason),setTimeout(this._recreatePresenceContainer.bind(this),1e3*e.container.retryAfter)):e.presenceSubscription?(_.Base.Logger.info(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Restarting container due to subscription resource error",e.presenceSubscription.terminationReason),setTimeout(this._recreatePresenceContainer.bind(this),1e3*e.presenceSubscription.retryAfter)):e.presencePublication&&(_.Base.Logger.info(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Restarting container due to publication resource error",e.presencePublication.terminationReason),setTimeout(this._recreatePresenceContainer.bind(this),1e3*e.presencePublication.retryAfter))},e.prototype._processPresenceDocument=function(e){var t=_.Base.Utils,i=_.Providers.CallServiceGateway.Utils,a=t.queryJSONObject(e,"presenceDoc.userIdentity.userId").replace("pres:","");_.Base.Logger.debug(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Processing presence document for User ID",a);var r=this._subscriptionsDeferredMap[a];if(r)r.resolve(),delete this._subscriptionsDeferredMap[a],-1===this._userSubscriptions.indexOf(a)&&this._userSubscriptions.push(a);else if(-1===this._userSubscriptions.indexOf(a))return void _.Base.Logger.debug(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Subscription list does not include address "+a+", the presence information for this user will be ignored.");var s=new _.Services.Presence.Presence(a),n=t.queryJSONObject(e,"presenceSummary.stateEnum");s._setOverallState(i.convertCSGPresenceStateToPresenceState(n));var o=t.queryJSONObject(e,"manualState.stateEnum");s._setManualState(i.convertCSGPresenceStateToPresenceState(o));var c=t.queryJSONObject(e,"mode.modeEnum");s._setLocationMode(i.convertCSGPresenceModeToPresenceMode(c)),s._setNote(t.queryJSONObject(e,"note.content"));var l=e.channelPresence[0],d=t.queryJSONObject(l,"video.stateEnum");s._setVideoState(i.convertCSGPresenceStateToPresenceState(d)),s._setVideoContact(t.queryJSONObject(l,"video.contact"));var C=t.queryJSONObject(l,"phone.stateEnum");s._setPhoneState(i.convertCSGPresenceStateToPresenceState(C)),s._setPhoneContact(t.queryJSONObject(l,"phone.contact"));var u=t.queryJSONObject(l,"im.stateEnum");s._setEnterpriseIMState(i.convertCSGPresenceStateToPresenceState(u)),s._setEnterpriseIMContact(t.queryJSONObject(l,"im.contact"));var v=t.queryJSONObject(l,"calendar.stateEnum");s._setCalendarState(i.convertCSGPresenceStateToPresenceState(v));var h=t.queryJSONObject(l,"calendar.compoundFrom");h&&s._setCalendarStartTime(new Date(h));var p=t.queryJSONObject(l,"calendar.compoundUntil");p&&s._setCalendarEndTime(new Date(p)),_.Base.Logger.debug(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Received presence status of "+a),setTimeout(function(){this.trigger(_.Providers.Interfaces.PresenceProviderCallbackIds.PRESENCE_NOTIFICATION,[s])}.bind(this),0)},e.prototype._processPresentities=function(e){var t=_.Base.Utils,i=t.queryJSONObject(e,"userIdentity.userId");if("terminated"===t.queryJSONObject(e,"status")){var a=this._subscriptionsDeferredMap[i];a&&(_.Base.Logger.error(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence subscription terminated. Provided address might be invalid.",i),a.reject(new _.Services.Presence.PresenceError(_.Services.Presence.PresenceErrorReason.INVALID_REQUEST)),delete this._subscriptionsDeferredMap[i])}},e.prototype.subscribeForSingleAddressPresence=function(e){var t=this._subscriptionsDeferredMap[e];return t||(t=T.Deferred(),this._subscriptionsDeferredMap[e]=t,this._sendSubscribeRequest()),t.promise()},e.prototype.subscribeForPresence=function(e){return e.forEach(function(e){this._subscriptionsDeferredMap[e]||(this._subscriptionsDeferredMap[e]=T.Deferred())}.bind(this)),this._sendSubscribeRequest()},e.prototype._sendSubscribeRequest=function(){return Object.keys(this._subscriptionsDeferredMap).forEach(function(e){this._unsubscriptionsDeferredMap[e]&&(this._unsubscriptionsDeferredMap[e].reject(),delete this._unsubscriptionsDeferredMap[e])}.bind(this)),this._dfdPresenceSubscription||(this._dfdPresenceSubscription=T.Deferred(),this._subscribePresenceTimeoutId=setTimeout(function(){var e=this._dfdPresenceSubscription;this._dfdPresenceSubscription=m;var i=Object.keys(this._subscriptionsDeferredMap);i.length&&this._updatePresenceSubscription(r.SUBSCRIPTION_ADD,i).done(function(){this._subscribedForPresence=!0,this._userSubscriptions=this._userSubscriptions.concat(i),e.resolve()}.bind(this)).fail(function(t){i.forEach(function(e){_.Base.Logger.error(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to subscribe for "+e+" presence",t),this._subscriptionsDeferredMap[e].reject(t),delete this._subscriptionsDeferredMap[e]}.bind(this)),e.reject(t)}.bind(this))}.bind(this),this._timeoutForSubscribe)),this._dfdPresenceSubscription.promise()},e.prototype.unsubscribeFromSingleAddressPresence=function(e){var t=this._unsubscriptionsDeferredMap[e];return t||(t=T.Deferred(),this._unsubscriptionsDeferredMap[e]=t,this._sendUnsubscribeRequest()),t.promise()},e.prototype.unsubscribeFromPresence=function(e){return e.forEach(function(e){this._unsubscriptionsDeferredMap[e]||(this._unsubscriptionsDeferredMap[e]=T.Deferred())}.bind(this)),this._sendUnsubscribeRequest()},e.prototype._sendUnsubscribeRequest=function(){return Object.keys(this._unsubscriptionsDeferredMap).forEach(function(e){this._subscriptionsDeferredMap[e]&&(this._subscriptionsDeferredMap[e].reject(),delete this._subscriptionsDeferredMap[e])}.bind(this)),this._dfdPresenceUnsubscription||(this._dfdPresenceUnsubscription=T.Deferred(),setTimeout(function(){var e=this._dfdPresenceUnsubscription;this._dfdPresenceUnsubscription=m;var i=Object.keys(this._unsubscriptionsDeferredMap);i.length&&this._updatePresenceSubscription(r.SUBSCRIPTION_REMOVE,i).then(function(){this._userSubscriptions=this._userSubscriptions.filter(function(e){return-1===i.indexOf(e)}),0===this._userSubscriptions.length&&(this._subscribedForPresence=!1),i.forEach(function(e){this._unsubscriptionsDeferredMap[e].resolve(),delete this._unsubscriptionsDeferredMap[e]}.bind(this)),e.resolve()}.bind(this),function(t){i.forEach(function(e){_.Base.Logger.error(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to unsubscribe from "+e+" presence",t),this._unsubscriptionsDeferredMap[e].reject(t),delete this._unsubscriptionsDeferredMap[e]}.bind(this)),e.reject(t)}.bind(this))}.bind(this),this._timeoutForUnsubscribe)),this._dfdPresenceUnsubscription.promise()},e.prototype.unsubscribeFromAllAddressesPresence=function(){return 0===this._userSubscriptions.length?T.Deferred().resolve():this._updatePresenceSubscription(r.SUBSCRIPTION_REMOVE,this._userSubscriptions).then(function(){this._userSubscriptions=[],this._subscribedForPresence=!1}.bind(this))},e.prototype._updatePresenceSubscription=function(a,r){_.Base.Logger.debug(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Updating presence subscriptions list",[a,r]);var t,i=T.Deferred(),e=function(e){this._onSubscriptionSucceeded(),i.resolve(e)}.bind(this),s=function(e){_.Base.Utils.queryJSONObject(e,"_data._status")===_.Base.NetworkErrorCodes.HTTP_SERVICE_UNAVAILABLE?setTimeout(function(){this._onSubscriptionFailed(),t()}.bind(this),0):i.reject(e)}.bind(this),n=function(e){e===_.Base.NetworkProviderEvents.RETRYING&&this._onSubscriptionFailed()}.bind(this);return(t=function(){this._getContainerAndSend(function(e){var t=this._messageBuilder.buildPresenceSubscriptionData(a,r),i=this._messageBuilder.buildPresenceSubscriptionOptions(e.additionalResources.presenceSubscriptions[0].replace.href);return this._csgProvider.send(t,i)}.bind(this)).done(e).fail(s).progress(n)}.bind(this))(),i.promise()},e.prototype._onSubscriptionFailed=function(){this._subscriptionStatusUnknown||(this._subscriptionStatusUnknown=!0,this._userSubscriptions.forEach(function(e){var t=this._buildUnknownPresence(e);this.trigger(_.Providers.Interfaces.PresenceProviderCallbackIds.PRESENCE_NOTIFICATION,[t])}.bind(this)))},e.prototype._onSubscriptionSucceeded=function(){if(this._subscriptionStatusUnknown&&(this._subscriptionStatusUnknown=!1,0<this._userSubscriptions.length)){var e=this._userSubscriptions.slice(0),t=function(){return this.unsubscribeFromAllAddressesPresence().then(function(){this.subscribeForPresence(e)}.bind(this))}.bind(this);_.Base.Utils.connectionBackoffAlgorithm(t)}},e.prototype.publishAutomaticPresence=function(r){return this._getContainerAndSend(function(e){var t=e.additionalResources.presencePublication.replace.href,i=this._messageBuilder.buildPublishPresenceOptions(t),a=this._messageBuilder.buildPublishAutoPresenceData(r);return this._csgProvider.send(a,i)}.bind(this))},e.prototype.publishManualState=function(e){var t,i,a;return e&&e!==_.Services.Presence.PresenceState.PRESENCE_STATE_UNSPECIFIED?(a=this._csgProvider.getResourceHrefs()[_.Providers.CallServiceGateway.ResourceType.PublishPresenceState],t=this._messageBuilder.buildPublishPresenceOptions(a),i=this._messageBuilder.buildPublishManualPresenceData(r.MANUAL_STATE,e)):(a=this._csgProvider.getResourceHrefs()[_.Providers.CallServiceGateway.ResourceType.DeletePresenceState],t=this._messageBuilder.buildDeleteManualPresenceOptions(a)),this._getContainerAndSend(function(){return this._csgProvider.send(i,t)}.bind(this))},e.prototype.publishLocationMode=function(e){var t,i,a;return e&&e!==_.Services.Presence.PresenceLocationMode.PRESENCE_LOCATION_MODE_UNSPECIFIED?(a=this._csgProvider.getResourceHrefs()[_.Providers.CallServiceGateway.ResourceType.PublishPresenceMode],t=this._messageBuilder.buildPublishPresenceOptions(a),i=this._messageBuilder.buildPublishManualPresenceData(r.MODE,e)):(a=this._csgProvider.getResourceHrefs()[_.Providers.CallServiceGateway.ResourceType.DeletePresenceMode],t=this._messageBuilder.buildDeleteManualPresenceOptions(a)),this._getContainerAndSend(function(){return this._csgProvider.send(i,t)}.bind(this))},e.prototype.publishNote=function(e){var t,i,a;return e&&""!==e?(a=this._csgProvider.getResourceHrefs()[_.Providers.CallServiceGateway.ResourceType.PublishPresenceNote],t=this._messageBuilder.buildPublishPresenceOptions(a),i=this._messageBuilder.buildPublishManualPresenceData(r.NOTE,e)):(a=this._csgProvider.getResourceHrefs()[_.Providers.CallServiceGateway.ResourceType.DeletePresenceNote],t=this._messageBuilder.buildDeleteManualPresenceOptions(a)),this._getContainerAndSend(function(){return this._csgProvider.send(i,t)}.bind(this))},e.prototype._getContainerAndSend=function(e){var t=T.Deferred(),i=function(){this._started?this._getPresenceContainer().then(e).then(function(e){t.resolve(e)},function(e){this._onErrorGetPresenceContainer(e).then(function(){setTimeout(i,0)}.bind(this),function(e){t.reject(e)}.bind(this))}.bind(this),function(e){t.notify(e)}):t.reject("Presence service has NOT started")}.bind(this);return i(),t.promise()},e.prototype._onErrorGetPresenceContainer=function(e){var t=T.Deferred();this._createOrExtendPresenceContainerPromise=m;var i=_.Base.Utils.queryJSONObject(e,"_data._status");if(i===_.Base.NetworkErrorCodes.HTTP_NOT_FOUND||i===_.Base.NetworkErrorCodes.HTTP_BAD_REQUEST||i===_.Base.NetworkErrorCodes.HTTP_UNPROCESSABLE_ENTITY)switch(this._parseErrorCode(e.getData().getResponseText())){case 404001:case 4000004:return _.Base.Logger.warn(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence container expired/invalidated"),this._recreatePresenceContainer();case 4040012:return _.Base.Logger.warn(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence subscription is unknown"),_.Base.Utils.queryJSONObject(this._presenceContainer,"additionalResources.presenceSubscriptions[0]")&&(this._presenceContainer.additionalResources.presenceSubscriptions[0]=m),t.resolve().promise();case 4040011:case 4220085:return _.Base.Logger.warn(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence session is invalid"),this._createContainerAndSubscribe()}return t.reject(e).promise()},e.prototype._recreatePresenceContainer=function(){return this._deletePresenceContainer().then(this._createContainerAndSubscribe.bind(this))},e.prototype._createContainerAndSubscribe=function(){return this._presenceContainer=m,this._createOrExtendPresenceContainer(!0,!0).then(function(){this.subscribeForPresence(this._userSubscriptions)}.bind(this))},e.prototype._parseErrorCode=function(e){var t;try{if(0<e.length){var i=JSON.parse(e),a=typeof i;"object"===a?t=_.Base.Utils.queryJSONObject(i,"error[0].errorCode"):"string"===a&&(i=JSON.parse(i),t=_.Base.Utils.queryJSONObject(i,"error[0].serviceErrorCode"))}}catch(e){_.Base.Logger.warn(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to parse error response",e)}return t},e.prototype._getPresenceContainer=function(){var e=!1,t=!1;if(this._presenceContainer){if(Date.now()<this._presenceContainerExpirationDate.getTime()&&(e=!_.Base.Utils.queryJSONObject(this._presenceContainer,"additionalResources.presenceSubscriptions[0]"),t=!_.Base.Utils.queryJSONObject(this._presenceContainer,"additionalResources.presencePublication"),!e&&!t))return _.Base.Logger.debug(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Current presence subscription container should be valid, using it"),T.Deferred().resolve(this._presenceContainer)}else e=t=!0;return this._createOrExtendPresenceContainer(t,e)},e.prototype._createOrExtendPresenceContainer=function(e,t){if(!this._createOrExtendPresenceContainerPromise){var i=T.Deferred(),a=_.Base.Utils.queryJSONObject(this._presenceContainer,"containerResources.container.updateOrExtend.href")||this._csgProvider.getResourceHrefs()[_.Providers.CallServiceGateway.ResourceType.CreatePresenceContainer];_.Base.Logger.debug(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Creating/updating presence container. Container exists: "+!!this._presenceContainer+", Publication resource needed: "+e+", Subscription resource needed: "+t),this._createOrExtendPresenceContainerPromise=i.promise();var r=this._messageBuilder.buildCreatePubSubContainerOptions(a),s=this._messageBuilder.buildCreateOrExtendPubSubContainerData(!!this._presenceContainer,e,t);this._csgProvider.send(s,r).then(function(e){if(this._presenceContainer=this._parsePresenceContainerResponse(e)||this._presenceContainer,!this._presenceContainer)return T.Deferred().reject(new _.Services.Presence.PresenceError(_.Services.Presence.PresenceErrorReason.INVALID_RESPONSE,"Received invalid response from server to create presence container request"));this._presenceContainerRefreshTimeoutId=setTimeout(this._createOrExtendPresenceContainer.bind(this),.8*this._presenceContainer.expires*1e3),this._createOrExtendPresenceContainerPromise=m,i.resolve(this._presenceContainer)}.bind(this),function(e){this._createOrExtendPresenceContainerPromise=m,i.reject(e)}.bind(this))}return this._createOrExtendPresenceContainerPromise},e.prototype._deletePresenceContainer=function(){if(!this._deletePresenceContainerPromise){_.Base.Logger.debug(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Deleting presence container");var e=T.Deferred(),t=_.Base.Utils.queryJSONObject(this._presenceContainer,"containerResources.container.delete.href");this._deletePresenceContainerPromise=e.promise();var i=function(){this._presenceContainer=m,this._deletePresenceContainerPromise=m,e.resolve(),_.Base.Logger.debug(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Deleted presence container")}.bind(this);if(t){var a=this._messageBuilder.buildDeletePubSubContainerOptions(t);this._csgProvider.send(m,a).then(i,i)}else i()}return this._deletePresenceContainerPromise},e.prototype._parsePresenceContainerResponse=function(e){var t;try{t=JSON.parse(e)}catch(e){}if(t&&t.pubSubContainer){var i=T.extend(new _.Providers.CallServiceGateway.CSGPresenceContainer,t.pubSubContainer);if(!!(i.expires&&i.containerResources.container.updateOrExtend.href&&i.additionalResources.presencePublication.replace.href&&i.additionalResources.presenceSubscriptions[0].replace.href))return this._presenceContainerExpirationDate=new Date(Date.now()+1e3*i.expires),i}},e.prototype._buildUnknownPresence=function(e){var t=new _.Services.Presence.Presence(e);return t._setOverallState(_.Services.Presence.PresenceState.PRESENCE_STATE_UNKNOWN),t._setManualState(_.Services.Presence.ManualPresenceState.PRESENCE_STATE_UNKNOWN),t._setVideoState(_.Services.Presence.VideoPresenceState.PRESENCE_STATE_UNKNOWN),t._setVideoContact(m),t._setPhoneState(_.Services.Presence.PhonePresenceState.PRESENCE_STATE_UNKNOWN),t._setPhoneContact(m),t._setEnterpriseIMState(_.Services.Presence.IMPresenceState.PRESENCE_STATE_UNKNOWN),t._setEnterpriseIMContact(m),t._setCalendarState(_.Services.Presence.CalendarPresenceState.PRESENCE_STATE_UNKNOWN),t._setCalendarStartTime(m),t._setCalendarEndTime(m),t},e.prototype.activateService=function(e,t){e.toUpperCase()===r.PRESENCE&&_.Base.Logger.info(_.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Presence activation status: "+t)},_.Providers.CallServiceGateway.CSGPresenceProvider=e}(AvayaClientServices),function(s){"use strict";function e(e,t){s.Providers.Interfaces.AbstractProvider.call(this),this._callProvider=e,this._ownerCallId=t,this._isVideoAllowed=!1;var i=this._callProvider.lookupCall(this._ownerCallId);if(i){var a=i._callService.getVideoCapability();this._isVideoAllowed=a.isAllowed,a.addOnChangedCallback(this._monitorVideoCapability.bind(this))}}(e.prototype=Object.create(s.Providers.Interfaces.AbstractProvider.prototype)).start=function(e,t){return e._isVideoAllowed=this._isVideoAllowed,e._recalculateInConferenceChatCapability(),s.Base.Logger.info(s.Base.LoggerTags.CM_CONFERENCE_PROVIDER,"started..."),T.Deferred().resolve()},e.prototype.stop=function(){var e=this._callProvider.lookupCall(this._ownerCallId);return e&&e._callService.getVideoCapability().removeOnChangedCallback(this._monitorVideoCapability.bind(this)),s.Base.Logger.info(s.Base.LoggerTags.CM_CONFERENCE_PROVIDER,"stopped..."),T.Deferred().resolve()},e.prototype._monitorVideoCapability=function(e){this._isVideoAllowed=e.isAllowed},e.prototype.observeConference=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"observeConference method is not implemented"))},e.prototype.disconnectParticipant=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"disconnectParticipant method is not implemented"))},e.prototype.setAsLecturer=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"setAsLecturer method is not implemented"))},e.prototype.setLocked=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"setLocked method is not implemented"))},e.prototype.setVideoLayoutTextOverlay=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"setVideoLayoutTextOverlay method is not implemented"))},e.prototype.setVideoLayoutSelfSee=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"setVideoLayoutSelfSee method is not implemented"))},e.prototype.setVideoLayout=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"setVideoLayout method is not implemented"))},e.prototype.terminateConference=function(){return s.Base.Logger.info(s.Base.LoggerTags.CM_CONFERENCE_PROVIDER,"terminated..."),T.Deferred().resolve()},e.prototype.removeLastParticipant=function(){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"removeLastParticipant method is not implemented"))},e.prototype.requestToBecomeModerator=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"requestToBecomeModerator method is not implemented"))},e.prototype.signIn=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"signIn method is not implemented"))},e.prototype.videoPin=function(e,t,i,a,r){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"videoPin method is not implemented"))},e.prototype.extendMeeting=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"extendMeeting method is not implemented"))},e.prototype.addParticipant=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"addParticipant method is not implemented"))},e.prototype.addParticipantFromCall=function(e){return this._callProvider.addParticipantFromCall(this._ownerCallId,e)},e.prototype.cancelDialoutParticipant=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"cancelDialoutParticipant method is not implemented"))},e.prototype.startRecording=function(e,t,i){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"startRecording method is not implemented"))},e.prototype.stopRecording=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"stopRecording method is not implemented"))},e.prototype.pauseRecording=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"pauseRecording method is not implemented"))},e.prototype.resumeRecording=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"resumeRecording method is not implemented"))},e.prototype.unsetAsLecturer=function(){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"unsetAsLecturer method is not implemented"))},e.prototype.controlRemoteCamera=function(e,t){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"controlRemoteCamera method is not implemented"))},e.prototype.muteUnmute=function(e,t,i){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"muteUnmute method is not implemented"))},e.prototype.sendChatMessage=function(e,t){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"sendChatMessage method is not implemented"))},e.prototype.muteUnmuteAll=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"muteUnmuteAll method is not implemented"))},e.prototype.raiseLowerHand=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"raiseLowerHand method is not implemented"))},e.prototype.moderatorLowerHand=function(e,t){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"moderatorLowerHand method is not implemented"))},e.prototype.getDialInInfo=function(){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"getDialInInfo method is not implemented"))},e.prototype.sendDisconnectEvent=function(e){return T.Deferred().reject(new s.Services.Conference.ConferenceException(s.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"sendDisconnectEvent method is not implemented"))},e.prototype.recalculateAddParticipantFromCallCapability=function(e,t){var i,a,r=this._callProvider.lookupCall(this._ownerCallId);a=r&&r.getState()===s.Services.Call.CallStates.ESTABLISHED?t.isConference()&&r.getConference()._isAvailable?r.getConference()._getType()!==t.getConference()._getType()?(i=!0,s.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(i=!1,s.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(i=!0,s.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(i=!1,s.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),e._addParticipantFromCallCapabilities[t.getCallId()]._updateIfChanged(i,a)},e.prototype.recalculateAddParticipantFromCallCapabilityByCallId=function(e,t){var i=this._callProvider.lookupCall(t);i&&this.recalculateAddParticipantFromCallCapability(e,i)},e.prototype.sendLocalMuteEvent=function(e,t){return T.Deferred().resolve().promise()},s.Providers.CM.CMConferenceProvider=e}(AvayaClientServices),function(n){"use strict";var o={1:{colorLimit:32,jpegQuality:.35},2:{colorLimit:32,jpegQuality:.4},3:{colorLimit:32,jpegQuality:.5},4:{colorLimit:64,jpegQuality:.5},5:{colorLimit:64,jpegQuality:.6},6:{colorLimit:64,jpegQuality:.7},7:{colorLimit:128,jpegQuality:.7},8:{colorLimit:128,jpegQuality:.8},9:{colorLimit:256,jpegQuality:.9},10:{colorLimit:256,jpegQuality:1}};function e(e,t,i,a,r,s){n.Providers.Interfaces.AbstractProvider.call(this),this._collaborationProvider=e,this._screenCapturer=t,this._shareApplicationWindowCapability=new n.Base.Capability(n.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._shareFullScreenCapability=new n.Base.Capability(n.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._shareAnyTypeCapability=new n.Base.Capability(n.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._contentSharingTagBuilder=i,this._bandwidthManager=a,this._screenSharingTagEncoder=r,this._startDeferred=m,this._browser=n.Base.Utils.getBrowserType(),this._config=s,this._outgoingScreenSharingStream=m,this._maxUploadSpeed=m,this._config&&n.Base.Utils.isDefined(this._config.imageQuality)?this.setImageQuality(this._config.imageQuality):this.setImageQuality(1),this._contentSharingTagBuilder&&this._contentSharingTagBuilder.setJpegImageQuality&&this._contentSharingTagBuilder.setJpegImageQuality(o[this._imageQuality].jpegQuality)}(e.prototype=Object.create(n.Providers.Interfaces.AbstractProvider.prototype)).start=function(){this._turnCapability(this._shareApplicationWindowCapability,n.Providers.ContentSharing.FeatureSupported.isSharingApplicationWindowAvailable()),this._turnCapability(this._shareFullScreenCapability,n.Providers.ContentSharing.FeatureSupported.isSharingFullScreenAvailable()),this._turnCapability(this._shareAnyTypeCapability,n.Providers.ContentSharing.FeatureSupported.isSharingAnyTypeAvailable())},e.prototype.stop=function(){this._turnCapability(this._shareApplicationWindowCapability,!1),this._turnCapability(this._shareFullScreenCapability,!1),this._turnCapability(this._shareAnyTypeCapability,!1)},e.prototype._turnCapability=function(e,t){var i=n.Base.Utils.getBrowserName()+": screen sharing capability was "+t===!0?"enabled":"disabled";e._updateIfChanged(t,i)},e.prototype.setExtensionAvailable=function(e){n.Base.Logger.debug(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,n.Base.Utils.getBrowserName()+" doesn't support third-party extensions for screen sharing")},e.prototype.startScreenSharing=function(){return this._screenCapturer.on(n.Providers.ContentSharing.ScreenCapturerEvents.BLOCKS_CHANGED,function(e,t){this.sendFrame(e,t)}.bind(this)),this._screenCapturer.on(n.Providers.ContentSharing.ScreenCapturerEvents.WINDOW_CLOSED,function(){this.stopScreenSharing()}.bind(this)),this._updateServerCapabilities=function(e){this._screenCapturer.setServerCapabilities(e)}.bind(this),this._collaborationProvider.on(n.Providers.Interfaces.CollaborationProviderCallbackIds.SERVER_CAPABILITIES,this._updateServerCapabilities),this._startScreenSharing()},e.prototype.sendFrame=function(e,t){var i=new n.Providers.ContentSharing.FrameBlocks(t),a=this._contentSharingTagBuilder.createStartTag(t,t?this._screenCapturer.getWidth():0,t?this._screenCapturer.getHeight():0);a=this._screenSharingTagEncoder.encodeTag(a),i.addBlock(a),e.forEach(function(e){var t=this._contentSharingTagBuilder.createBlockTag(e);t=this._screenSharingTagEncoder.encodeTag(t),i.addBlock(t)}.bind(this)),i.addBlock(this._screenSharingTagEncoder.encodeTag(this._contentSharingTagBuilder.createEndTag())),this._bandwidthManager.addToQueue(i);var r=this._bandwidthManager.getQueueDelay(),s=this._bandwidthManager.getQueueMaxDelay();s<r&&(n.Base.Logger.debug(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Screen sharing queue is longer that "+s+" seconds. Delay is in process. Resuming in "+r+" seconds."),this._screenCapturer.delayCapturing(1e3*r))},e.prototype.startFullScreen=function(e){throw n.Base.Logger.debug(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"MUST override AbstractScreenSharingProvider.startFullScreen(mediaSourceId)"),new Error("Cannot start fullscreen sharing. Unknown provider.")},e.prototype.startApplicationWindow=function(e){throw n.Base.Logger.debug(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"MUST override AbstractScreenSharingProvider.startApplicationWindow(mediaSourceId)"),new Error("Cannot start window sharing. Unknown provider.")},e.prototype.startSharingAnyType=function(e){return this._startDeferred=T.Deferred(),!0===this._shareAnyTypeCapability.isAllowed?(n.Base.Logger.info(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,n.Base.Utils.getBrowserName()+": Start sharing..."),e?this._onRetrievingStreamSucceeded(e):this._getDisplayMedia(),this._startDeferred.promise()):(n.Base.Logger.error(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,n.Base.Utils.getBrowserName()+": An attempt to start sharing any type - failed"),this._startDeferred.reject(n.Base.Utils.getBrowserName()+' doesn\'t support this method. Use "startApplicationWindow or "startFullScreen" instead').promise())},e.prototype.stopScreenSharing=function(e){return n.Base.Logger.info(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,n.Base.Utils.getBrowserName()+": Stop sharing..."),this._outgoingScreenSharingStream===m&&(this._updateServerCapabilities=m),this.clearOutgoingScreenSharingStream(),this.stopScreenCapturer().then(function(){return this._bandwidthManager.stop()}.bind(this)).then(function(){if(!e)return this._stopScreenSharing()}.bind(this)).always(function(){try{this._collaborationProvider.off(n.Providers.Interfaces.CollaborationProviderCallbackIds.SERVER_CAPABILITIES,this._updateServerCapabilities)}catch(e){n.Base.Logger.error(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,e)}}.bind(this))},e.prototype.stopScreenCapturer=function(){return this._screenCapturer.stop()},e.prototype.pause=function(){return n.Base.Logger.info(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Pause sharing..."),this._outgoingScreenSharingStream&&this._outgoingScreenSharingStream.getTracks().forEach(function(e){e.enabled=!1}),this._screenCapturer.pause().then(function(e){return e||this._pauseScreenSharing()}.bind(this))},e.prototype.resume=function(){return n.Base.Logger.info(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Resume sharing..."),this._outgoingScreenSharingStream&&this._outgoingScreenSharingStream.getTracks().forEach(function(e){e.enabled=!0}),this._screenCapturer.resume().then(function(e){return e?this._startScreenSharing():e}.bind(this))},e.prototype.getShareApplicationWindowCapability=function(){return this._shareApplicationWindowCapability},e.prototype.getShareFullScreenCapability=function(){return this._shareFullScreenCapability},e.prototype.getShareAnyTypeCapability=function(){return this._shareAnyTypeCapability},e.prototype.getOutgoingScreenSharingStream=function(){return this._outgoingScreenSharingStream},e.prototype.isOpened=function(){return this._collaborationProvider.isOpened()},e.prototype.setImageQuality=function(e){e<1||10<e?(n.Base.Logger.warn("Failed to set unsupported image quality:"+e),this._imageQuality||this.setImageQuality(1)):(this._imageQuality=e,n.Base.Logger.debug(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Selected image quality ["+o[this._imageQuality].colorLimit+", "+o[this._imageQuality].jpegQuality+"]"),this._contentSharingTagBuilder&&this._contentSharingTagBuilder.setJpegImageQuality&&this._contentSharingTagBuilder.setJpegImageQuality(o[this._imageQuality].jpegQuality))},e.prototype._startScreenSharing=function(){return this._collaborationProvider.startScreenSharing()},e.prototype._stopScreenSharing=function(){return this._collaborationProvider.stopScreenSharing()},e.prototype._pauseScreenSharing=function(){return this._collaborationProvider.pauseScreenSharing()},e.prototype.clearOutgoingScreenSharingStream=function(){this._outgoingScreenSharingStream&&(this._outgoingScreenSharingStream.getTracks().forEach(function(e){e.stop()}),this._outgoingScreenSharingStream=m)},e.prototype._getDisplayMedia=function(e){var t=n.Base.Utils.deepMerge({video:{frameRate:{max:3}}},e);this._getDisplayMediaFromBrowser(t).then(this._onRetrievingStreamSucceeded.bind(this),this._onRetrievingStreamFailed.bind(this))},e.prototype._getDisplayMediaFromBrowser=function(e){return navigator.mediaDevices.getDisplayMedia(e)},e.prototype._getUserMedia=function(e){navigator.mediaDevices.getUserMedia(e).then(this._onRetrievingStreamSucceeded.bind(this),this._onRetrievingStreamFailed.bind(this))},e.prototype._onRetrievingStreamSucceeded=function(e){this._outgoingScreenSharingStream=e.clone();var t=T.extend(new n.Providers.ContentSharing.ScreenCapturerConfig,this._config,this._collaborationProvider.getServerCapabilities());t.losslessColorLimit=o[this._imageQuality].colorLimit,this._maxUploadSpeed&&(t.maxBytesPerSecond=this._maxUploadSpeed/8*1e3),this._screenCapturer.start(e,t,this._browser).then(function(){return this._bandwidthManager.start(this._screenCapturer._config),n.Providers.ContentSharing.AbstractScreenSharingProvider.prototype.startScreenSharing.call(this)}.bind(this)).then(function(){"pending"===this._startDeferred.state()&&this._startDeferred.resolve()}.bind(this),function(e){"pending"===this._startDeferred.state()&&this._startDeferred.reject(e)}.bind(this))},e.prototype._onRetrievingStreamFailed=function(e){var t="Failed to retrieve stream: ";e&&e.message&&(t+=e.message),n.Base.Logger.warn(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,t),"pending"===this._startDeferred.state()&&this._startDeferred.reject(e)},e.prototype.setMaxUploadSpeed=function(e){this._bandwidthManager.setMaxUploadSpeed(e),this._maxUploadSpeed=e},n.Providers.ContentSharing.AbstractScreenSharingProvider=e}(AvayaClientServices),function(c,i){"use strict";function e(e,t,i,a,r,s,n,o){c.Providers.ContentSharing.AbstractScreenSharingProvider.call(this,e,t,i,a,r,s),this._networkProvider=n,this._networkProvider.addOnCapabilityChange(this._capabilityUpdate()),this._extensionRequestBuilder=o,this._mediaSourceId=m}(e.prototype=Object.create(c.Providers.ContentSharing.AbstractScreenSharingProvider.prototype)).start=function(){this._networkProvider&&this._networkProvider.start(),c.Providers.ContentSharing.AbstractScreenSharingProvider.prototype.start.call(this)},e.prototype.stop=function(){this._networkProvider&&this._networkProvider.stop(),c.Providers.ContentSharing.AbstractScreenSharingProvider.prototype.stop.call(this)},e.prototype.setExtensionAvailable=function(e){this._networkProvider.setExtensionAvailable(e)},e.prototype.startFullScreen=function(e,t){return c.Base.Logger.info(c.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Chrome: Start full screen sharing..."),this._startDeferred=T.Deferred(),t?this._onRetrievingStreamSucceeded(t):"string"==typeof e?(c.Base.Logger.info(c.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Chrome: Using third-party source for screen sharing..."),this._handleMediaAvailableEvent({data:{mediaSourceId:e}})):(this._startEventListener(),this._networkProvider.send(this._extensionRequestBuilder.createStartSharingRequest("screen"))),this._startDeferred.promise()},e.prototype.startApplicationWindow=function(e,t){return c.Base.Logger.info(c.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Chrome: Start appl window sharing..."),this._startDeferred=T.Deferred(),t?this._onRetrievingStreamSucceeded(t):"string"==typeof e?(c.Base.Logger.info(c.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Chrome: Using third-party source for appl window sharing..."),this._handleMediaAvailableEvent({data:{mediaSourceId:e}})):(this._startEventListener(),this._networkProvider.send(this._extensionRequestBuilder.createStartSharingRequest("window"))),this._startDeferred.promise()},e.prototype.stopScreenSharing=function(e){return c.Base.Logger.info(c.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Chrome: Stop sharing..."),c.Providers.ContentSharing.AbstractScreenSharingProvider.prototype.stopScreenSharing.call(this,e).then(function(){this._networkProvider.send(this._extensionRequestBuilder.createStopSharingRequest(this._mediaSourceId)),this._mediaSourceId=m,this._removeEventListener()}.bind(this))},e.prototype.stopScreenCapturer=function(){return this._removeEventListener(),this._screenCapturer.stop()},e.prototype._startEventListener=function(){this._networkProvider.addOnMediaAvailableCallback(this._handleMediaAvailableEvent.bind(this)),this._networkProvider.addOnMediaCancelledCallback(this._handleMediaCanceledEvent.bind(this))},e.prototype._removeEventListener=function(){this._networkProvider._onMediaAvailableCallbacks.empty(),this._networkProvider._onMediaCancelledCallbacks.empty()},e.prototype._handleMediaAvailableEvent=function(e){c.Base.Logger.debug(c.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"User enabled screen sharing"),this._mediaSourceId=e.data.mediaSourceId;var t={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:this._mediaSourceId,maxWidth:i.screen.width,maxHeight:i.screen.height,maxFrameRate:3}}};this._getUserMedia(t),this._removeEventListener()},e.prototype._handleMediaCanceledEvent=function(e){c.Base.Logger.error(c.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,e),this._removeEventListener(),"pending"===this._startDeferred.state()&&this._startDeferred.reject(e)},e.prototype._capabilityUpdate=function(){return function(e,t){if(c.Base.Logger.debug(c.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Extension: "+e+" is installed? "+t),!1===this._isWorkerConfigValid()){var i="Content sharing worker path is missing";return this._shareApplicationWindowCapability._updateIfChanged(!1,i),void this._shareFullScreenCapability._updateIfChanged(!1,i)}var a=e+" extension was "+(t?"installed or enabled":"uninstalled or disabled");this._shareApplicationWindowCapability._updateIfChanged(t,a),this._shareFullScreenCapability._updateIfChanged(t,a)}.bind(this)},e.prototype._isWorkerConfigValid=function(){return this._config!==m&&"string"==typeof this._config.contentSharingWorkerPath&&0<this._config.contentSharingWorkerPath.length},c.Providers.ContentSharing.ChromeScreenSharingProvider=e}(AvayaClientServices,window),function(n){"use strict";function e(e,t,i,a,r,s){n.Providers.ContentSharing.AbstractScreenSharingProvider.call(this,e,t,i,a,r,s)}(e.prototype=Object.create(n.Providers.ContentSharing.AbstractScreenSharingProvider.prototype)).startApplicationWindow=function(){return n.Base.Logger.error(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Edge: An attempt to start application window sharing - failed"),this._startDeferred=T.Deferred(),this._startDeferred.reject('Edge does not support this method. Use "startScreenSharing" instead').promise()},e.prototype.startFullScreen=function(){return n.Base.Logger.error(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Edge: An attempt to start fullscreen sharing - failed"),this._startDeferred=T.Deferred(),this._startDeferred.reject('Edge does not support this method. Use "startScreenSharing" instead').promise()},e.prototype._getDisplayMediaFromBrowser=function(e){return navigator.getDisplayMedia(e)},n.Providers.ContentSharing.EdgeScreenSharingProvider=e}(AvayaClientServices),function(n){"use strict";var i="screen",a="window";function e(e,t,i,a,r,s){n.Providers.ContentSharing.AbstractScreenSharingProvider.call(this,e,t,i,a,r,s)}(e.prototype=Object.create(n.Providers.ContentSharing.AbstractScreenSharingProvider.prototype)).startFullScreen=function(e,t){return n.Base.Logger.info(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Firefox: Start full screen sharing..."),this._startDeferred=T.Deferred(),t?this._onRetrievingStreamSucceeded(t):this._getScreenStream(i),this._startDeferred.promise()},e.prototype.startApplicationWindow=function(e,t){return n.Base.Logger.info(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"Firefox: Start application window sharing..."),this._startDeferred=T.Deferred(),t?this._onRetrievingStreamSucceeded(t):this._getScreenStream(a),this._startDeferred.promise()},e.prototype._getScreenStream=function(e){n.Base.Logger.debug(n.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,"User enabled screen sharing: "+e);var t={audio:!1,video:{mediaSource:e,width:{max:window.screen.width},height:{max:window.screen.height},frameRate:{max:3}}};this._getUserMedia(t)},n.Providers.ContentSharing.FirefoxScreenSharingProvider=e}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.UCCP.UCCPMessage.call(this,"activeTalkerChangedEvent"),this.participantId=e}e.prototype=Object.create(t.Providers.UCCP.UCCPMessage.prototype),t.Providers.UCCP.UCCPActiveTalkerChangedEvent=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.ADMISSION_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPAdmissionResponse=e}(AvayaClientServices),function(s){"use strict";function e(e,t,i,a,r){s.Providers.UCCP.UCCPMessage.call(this,s.Providers.UCCP.UCCPMessageTypes.AVAILABLE_LAYOUTS_CHANGED_EVENT),this.textOverlay=e,this.noSelfSee=t,this.videoPin=i,this.geometries=a,this.LPPOn=r}e.prototype=Object.create(s.Providers.UCCP.UCCPMessage.prototype),s.Providers.UCCP.UCCPAvailableLayoutsChangedEvent=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_GEOMETRY_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPChangeLayoutGeometryResponse=e}(AvayaClientServices);!function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_NO_SELF_SEE_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPChangeLayoutNoSelfSeeResponse=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.CHANGE_LAYOUT_OVERLAY_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPChangeLayoutTextOverlayResponse=e}(AvayaClientServices),function(r){"use strict";function e(e,t,i,a){r.Providers.UCCP.UCCPMessage.call(this,"chatEvent"),this.participantId=e,this.type=t,this.text=a,this.time=i}e.prototype=Object.create(r.Providers.UCCP.UCCPMessage.prototype),r.Providers.UCCP.UCCPChatEvent=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.CHAT_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPChatResponse=e}(AvayaClientServices),function(r){"use strict";function e(e,t,i,a){r.Providers.UCCP.UCCPMessage.call(this,r.Providers.UCCP.UCCPMessageTypes.CURRENT_LAYOUT_CHANGED_EVENT),this.textOverlay=e,this.noSelfSee=t,this.geometry=i,this.LPPOn=a}e.prototype=Object.create(r.Providers.UCCP.UCCPMessage.prototype),r.Providers.UCCP.UCCPCurrentLayoutChangedEvent=e}(AvayaClientServices),function(n){"use strict";function e(e,t,i,a,r,s){n.Providers.UCCP.UCCPMessage.call(this,n.Providers.UCCP.UCCPMessageTypes.CURRENT_LAYOUT_RESPONSE),this.transId=e,this.responseCode=t,this.textOverlay=i,this.noSelfSee=a,this.geometry=r,this.LPPOn=s}e.prototype=Object.create(n.Providers.UCCP.UCCPMessage.prototype),n.Providers.UCCP.UCCPCurrentLayoutResponse=e}(AvayaClientServices),function(n){"use strict";function e(e,t,i,a,r,s){n.Providers.UCCP.UCCPMessage.call(this,n.Providers.UCCP.UCCPMessageTypes.DIAL_IN_INFO_RESPONSE),this.transId=e,this.responseCode=t,this.webLink=i,this.streamingLink=a,this.dialInInformation=r,this.dialInInformationHtml=s}e.prototype=Object.create(n.Providers.UCCP.UCCPMessage.prototype),n.Providers.UCCP.UCCPDialInInfoResponse=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.DIALOUT_CANCEL_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPDialoutCancelResponse=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,"dialoutCompletedEvent"),this.participantId=e,this.result=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPDialoutCompletedEvent=e}(AvayaClientServices),function(a){"use strict";function e(e,t,i){a.Providers.UCCP.UCCPMessage.call(this,a.Providers.UCCP.UCCPMessageTypes.DIALOUT_RESPONSE),this.transId=e,this.responseCode=t,this.participantId=i}e.prototype=Object.create(a.Providers.UCCP.UCCPMessage.prototype),a.Providers.UCCP.UCCPDialoutResponse=e}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.UCCP.UCCPMessage.call(this,t.Providers.UCCP.UCCPMessageTypes.DISCONNECT_EVENT),this.reason=e}e.prototype=Object.create(t.Providers.UCCP.UCCPMessage.prototype),t.Providers.UCCP.UCCPDisconnectEvent=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,"disconnectParticipantResponse"),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPDisconnectParticipantResponse=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.EXTEND_MEETING_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPExtendMeetingResponse=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.FECC_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPFeccResponse=e}(AvayaClientServices),function(C){"use strict";function e(e,t,i,a,r,s,n,o,c,l,d){C.Providers.UCCP.UCCPMessage.call(this,"handshakeResponse"),this.transId=e,this.responseCode=t,this.version=i,this.participantId=a,this.externalAdmissionNeeded=r,this.admissionPasscodeNeeded=s,this.admissionPermissionNeeded=n,this.commands=o,this.currentTime=c,this.longPollEmptyResponseTimeout=l,this.knockDoorTimeout=d}e.prototype=Object.create(C.Providers.UCCP.UCCPMessage.prototype),C.Providers.UCCP.UCCPHandshakeResponse=e}(AvayaClientServices),function(t){"use strict";function e(e){t.Providers.UCCP.UCCPMessage.call(this,t.Providers.UCCP.UCCPMessageTypes.KEEPALIVE_REQUEST),this.transId=e}e.prototype=Object.create(t.Providers.UCCP.UCCPMessage.prototype),t.Providers.UCCP.UCCPKeepAliveRequestEvent=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.LECTURE_MODE_START_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPLectureModeStartResponse=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,i.Providers.UCCP.UCCPMessageTypes.LECTURE_MODE_STOP_RESPONSE),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPLectureModeStopResponse=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,"lockMeetingResponse"),this.transId=e,this.responseCode=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPLockMeetingResponse=e}(AvayaClientServices),function(u){"use strict";function e(e,t,i,a,r,s,n,o,c,l,d,C){u.Providers.UCCP.UCCPMessage.call(this,"meetingInfoChangedEvent"),this.media=e,this.locked=t,this.mediaStatus=i,this.lecturerId=a,this.lecturerName=r,this.presenterId=s,this.presenterName=n,this.recording=o,this.streaming=c,this.encrypted=l,this.slidesAvailable=d,this.terminationTime=C}e.prototype=Object.create(u.Providers.UCCP.UCCPMessage.prototype),u.Providers.UCCP.UCCPMeetingInfoChangedEvent=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.UCCP.UCCPMessage.call(this,"meetingTerminationInProgressEvent"),this.reason=e,this.userName=t}e.prototype=Object.create(i.Providers.UCCP.UCCPMessage.prototype),i.Providers.UCCP.UCCPMeetingTerminationInProgressEvent=e}(AvayaClientServices),function(h){"use strict";function e(e){h.Base.RESTProvider.apply(this),this.type=h.Base.ProviderTypes.UCCP_LONG_POLLING_PROVIDER,this._isOpened=!1,this._polling=!1,this._parser=e,this._responsesData={},this._transactionIDLocation="",this._longPollEmptyResponseTimeout=6e4}(e.prototype=Object.create(h.Base.RESTProvider.prototype)).onConnectionUnavailable=function(){},e.prototype.close=function(){this._isOpened?(h.Base.RESTProvider.prototype.close.call(this),this._polling=!1,this._isOpened=!1,this._responsesData={}):this.onClose()},e.prototype.run=function(e){this._isOpened&&this._poll(e)},e.prototype.start=function(e,t,i){return i&&i.transactionIDLocation&&(this._transactionIDLocation=i.transactionIDLocation),this._isOpened?(this.onOpen(),T.Deferred().resolve().promise()):(this._isOpened=!0,this._maxConnectionErrorCount=e.maxConnectionErrorCount||5,h.Base.RESTProvider.prototype.start.call(this,e,t,i))},e.prototype.send=function(e,t,i){var a={};return a=t&&t.sendType&&"GET"===t.sendType?this._buildGetRequestOptions():this._buildPostRequestOptions(),i||(i=new h.Base.NetworkRequestRetryHelper(function(){return this.send(e,a,i)}.bind(this))),h.Base.RESTProvider.prototype.send.call(this,e,a,i).then(function(e){this._polling||(this._polling=!0,this.run(a))}.bind(this),function(e){return e&&(this._isOpened=!1,this._polling=!1,this.onConnectionUnavailable()),T.Deferred().reject(e).promise()}.bind(this))},e.prototype.abort=function(){this._isOpened=!1,this._polling=!1,this._responsesData={},h.Base.RESTProvider.prototype.abort.call(this)},e.prototype._buildGetRequestOptions=function(){return{sendType:"GET",urlSuffix:"/uwd/rest",timeout:this._longPollEmptyResponseTimeout}},e.prototype._buildPostRequestOptions=function(){return{sendType:"POST",urlSuffix:"/uwd/rest",headers:{"Content-Type":"application/json"}}},e.prototype.isOpened=function(){return this._isOpened},e.prototype._ajaxOnSuccess=function(e,t,i,a){return this._removeXhrFromPool(i),200===i.status&&e&&this._resolveGetResponse(e,i),a.resolve(e,i),e},e.prototype._resolveGetResponse=function(e,t){for(var i=h.Base.Utils.makeId(10),a="}"+i+"{",r=e.replace(/}\\n\\n{/g,a).split(i),s=0;s<r.length;s++){var n=JSON.parse(r[s]),o=h.Base.Utils.queryJSONObject(n,this._transactionIDLocation);if(n.name===h.Providers.UCCP.UCCPMessageTypes.HANDSHAKE_RESPONSE){var c=h.Base.Utils.queryJSONObject(n,"params.longPollEmptyResponseTimeout");this._longPollEmptyResponseTimeout=h.Base.Utils.isDefined(c)?1e3*parseInt(c)+1e4:13e4}var l=this._responsesData[o];if(o&&l){var d,C=l.dfd,u=l.successIndicator;delete this._responsesData[o];try{d=this._parser.parse(n)}catch(e){return void C.reject(e)}if(d&&d.responseCode&&(u.indexOf?-1<u.indexOf(d.responseCode):d.responseCode===u))C.resolve(d);else{var v=400;n&&n.params&&n.params.responseCode&&(v=n.params.responseCode),C.reject({name:"UCCPServerError",code:v,message:"UCCP server responded with "+v})}}else this.onMessage(r[s],t)}},e.prototype._poll=function(e){this._polling&&(e.sendType="GET",this.send(m,e).done(function(){this._poll(e)}.bind(this)))},h.Providers.UCCP.UCCPLongPollingProvider=e}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t={};e.note&&(t.type=a.Base.Utils.queryJSONObject(e,"note[0]._attr.type._value"),t.text=a.Base.Utils.queryJSONObject(e,"note[0]._text")),t.meetingOwner="Y"===a.Base.Utils.queryJSONObject(e,"_attr.meeting_owner._value"),e._attr.target_id?(t.targetId=a.Base.Utils.queryJSONObject(e,"_attr.target_id._value"),t.personal=!0):t.personal=!1;var i=new a.Providers.WCS.AddNoteEventData(t.type,t.text,t.meetingOwner,t.personal,t.targetId);return new a.Providers.WCS.AddNoteEvent(this.stripCommonData(e),i)},a.Providers.WCS.AddNoteParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.WCS.LiveEventParser.prototype)).parse=function(e){return new t.Providers.WCS.AddWhiteboardEvent(this.stripCommonData(e))},t.Providers.WCS.AddWhiteboardParser=e}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t={};t.targetId=a.Base.Utils.queryJSONObject(e,"_attr.target_id._value");var i=new a.Providers.WCS.AllowPresentingEventData(t.targetId);return new a.Providers.WCS.AllowPresentingEvent(this.stripCommonData(e),i)},a.Providers.WCS.AllowPresentingParser=e}(AvayaClientServices),function(r){"use strict";function e(){}(e.prototype=Object.create(r.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var i={};if(e.selection[0]._attr&&T.each(e.selection[0]._attr,function(e,t){i[this.stringToCamel(e)]=t._value}.bind(this)),i.group){var t=this.convertGroup(i.group);i.layerType=t.layerType,i.groupId=t.groupId,delete i.group}var a=new r.Providers.WCS.ClearDrawingEventData(i.groupId,i.layerType);return new r.Providers.WCS.ClearDrawingEvent(this.stripCommonData(e),a)},r.Providers.WCS.ClearDrawingParser=e}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t={};e.note&&(t.event_id=a.Base.Utils.queryJSONObject(e,"note[0]._attr.event_id._value"));var i=new a.Providers.WCS.DeleteNoteEventData(t.event_id);return new a.Providers.WCS.DeleteNoteEvent(this.stripCommonData(e),i)},a.Providers.WCS.DeleteNoteParser=e}(AvayaClientServices),function(r){"use strict";function e(){}(e.prototype=Object.create(r.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var i={};if(e.selection[0]._attr&&T.each(e.selection[0]._attr,function(e,t){i[this.stringToCamel(e)]=t._value}.bind(this)),i.group){var t=this.convertGroup(i.group);i.layerType=t.layerType,i.groupId=t.groupId,delete i.group}var a=new r.Providers.WCS.DeleteSelectionEventData(i.groupId,i.layerType,i.id,i.selectionX,i.selectionY);return new r.Providers.WCS.DeleteSelectionEvent(this.stripCommonData(e),a)},r.Providers.WCS.DeleteSelectionParser=e}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t=a.Base.Utils.queryJSONObject(e,"whiteboard[0]._attr.index._value"),i=new a.Providers.WCS.DeleteWhiteboardEventData(t);return new a.Providers.WCS.DeleteWhiteboardEvent(this.stripCommonData(e),i)},a.Providers.WCS.DeleteWhiteboardParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.WCS.LiveEventParser.prototype)).parse=function(e){return new t.Providers.WCS.DenyControlEvent(this.stripCommonData(e))},t.Providers.WCS.DenyControlParser=e}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t={};t.targetId=a.Base.Utils.queryJSONObject(e,"_attr.target_id._value"),t.targetName=a.Base.Utils.queryJSONObject(e,"_attr.target_name._value");var i=new a.Providers.WCS.DenyPresentingEventData(t.targetId,t.targetName);return new a.Providers.WCS.DenyPresentingEvent(this.stripCommonData(e),i)},a.Providers.WCS.DenyPresentingParser=e}(AvayaClientServices),function(r){"use strict";function e(){}(e.prototype=Object.create(r.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var i={};if(e.circle[0]._attr&&T.each(e.circle[0]._attr,function(e,t){i[this.stringToCamel(e)]=t._value}.bind(this)),r.Base.Utils.isDefined(i.fillColor)&&(i.fillColor=r.Base.Utils.colorIntToHex(i.fillColor),i.filled=!0),r.Base.Utils.isDefined(i.color)&&(i.color=r.Base.Utils.colorIntToHex(i.color),i.contour=!0),i.group){var t=this.convertGroup(i.group);i.layerType=t.layerType,i.groupId=t.groupId,delete i.group}var a=new r.Providers.WCS.DrawCircleEventData(i.alpha,i.fillColor,i.color,i.groupId,i.layerType,i.width,i.x0,i.x1,i.y0,i.y1,i.filled,i.contour);return new r.Providers.WCS.DrawCircleEvent(this.stripCommonData(e),a)},r.Providers.WCS.DrawCircleParser=e}(AvayaClientServices),function(n){"use strict";function e(){}(e.prototype=Object.create(n.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var i={},a=[],r=[];if(e.m)r.push({x:n.Base.Utils.queryJSONObject(e,"m[0]._attr.x._value"),y:n.Base.Utils.queryJSONObject(e,"m[0]._attr.y._value")});else{if(e.lines&&e.lines[0]._attr&&T.each(e.lines[0]._attr,function(e,t){i[this.stringToCamel(e)]=t._value}.bind(this)),n.Base.Utils.isDefined(i.fillColor)&&(i.fillColor=n.Base.Utils.colorIntToHex(i.fillColor),i.filled=!0),n.Base.Utils.isDefined(i.color)&&(i.color=n.Base.Utils.colorIntToHex(i.color),i.contour=!0),i.group){var t=this.convertGroup(i.group);i.layerType=t.layerType,i.groupId=t.groupId,delete i.group}e.lines&&e.lines[0].l&&T.each(e.lines[0].l,function(e,t){a.push({x:t._attr.x._value,y:t._attr.y._value})}.bind(this)),e.lines&&e.lines[0].m&&T.each(e.lines[0].m,function(e,t){r.push({x:t._attr.x._value,y:t._attr.y._value})}.bind(this))}var s=new n.Providers.WCS.DrawShapeEventData(i.alpha,i.fillColor,i.color,i.groupId,i.layerType,i.width,a,r,i.filled,i.contour);return new n.Providers.WCS.DrawShapeEvent(this.stripCommonData(e),s)},n.Providers.WCS.DrawShapeParser=e}(AvayaClientServices),function(r){"use strict";function e(){}(e.prototype=Object.create(r.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var i={};if(e.drawText[0]._attr&&T.each(e.drawText[0]._attr,function(e,t){i[this.stringToCamel(e)]=t._value}.bind(this)),r.Base.Utils.isDefined(i.fillColor)&&(i.fillColor=r.Base.Utils.colorIntToHex(i.fillColor)),i.group){var t=this.convertGroup(i.group);i.layerType=t.layerType,i.groupId=t.groupId,delete i.group}var a=new r.Providers.WCS.DrawTextEventData(i.fillColor,i.fontSize,i.groupId,i.layerType,i.text,i.x,i.y);return new r.Providers.WCS.DrawTextEvent(this.stripCommonData(e),a)},r.Providers.WCS.DrawTextParser=e}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t={};t.targetId=a.Base.Utils.queryJSONObject(e,"_attr.target_id._value"),t.targetName=a.Base.Utils.queryJSONObject(e,"_attr.target_name._value"),t.targetParticipantId=a.Base.Utils.queryJSONObject(e,"_attr.targetParticipantId._value"),t.time=a.Base.Utils.queryJSONObject(e,"_attr.time._value");var i=new a.Providers.WCS.EjectParticipantEventData(t.targetId,t.targetName,t.targetParticipantId,t.time);return new a.Providers.WCS.EjectParticipantEvent(this.stripCommonData(e),i)},a.Providers.WCS.EjectParticipantParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.WCS.LiveEventParser.prototype)).parse=function(e){return new t.Providers.WCS.EndControlEvent(this.stripCommonData(e))},t.Providers.WCS.EndControlParser=e}(AvayaClientServices),function(r){"use strict";function e(){}(e.prototype=Object.create(r.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var i={};if(e.lines[0]._attr&&T.each(e.lines[0]._attr,function(e,t){i[this.stringToCamel(e)]=t._value}.bind(this)),i.group){var t=this.convertGroup(i.group);i.layerType=t.layerType,i.groupId=t.groupId,delete i.group}var a=new r.Providers.WCS.EndDrawShapeEventData(i.groupId,i.layerType);return new r.Providers.WCS.EndDrawShapeEvent(this.stripCommonData(e),a)},r.Providers.WCS.EndDrawShapeParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.WCS.LiveEventParser.prototype)).parse=function(e){return new t.Providers.WCS.EndMeetingEvent(this.stripCommonData(e))},t.Providers.WCS.EndMeetingParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.WCS.LiveEventParser.prototype)).parse=function(e){return new t.Providers.WCS.EndScreenSharingEvent(this.stripCommonData(e))},t.Providers.WCS.EndScreenSharingParser=e}(AvayaClientServices),function(t){"use strict";function e(){}(e.prototype=Object.create(t.Providers.WCS.LiveEventParser.prototype)).parse=function(e){return new t.Providers.WCS.EndWhiteboardEvent(this.stripCommonData(e))},t.Providers.WCS.EndWhiteboardParser=e}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.AbstractParser.prototype)).parse=function(e){var t={code:a.Base.Utils.queryJSONObject(e,"code[0]._text"),message:a.Base.Utils.queryJSONObject(e,"message[0]._text"),request_id:a.Base.Utils.queryJSONObject(e,"request_id[0]._text"),ws_connection_id:a.Base.Utils.queryJSONObject(e,"ws_connection_id[0]._text")},i=new a.Providers.WCS.ErrorEventData(t.code,t.message,t.request_id,t.ws_connection_id);return new a.Providers.WCS.ErrorEvent(i)},a.Providers.WCS.ErrorParser=e}(AvayaClientServices),function(a){"use strict";function e(){}(e.prototype=Object.create(a.Providers.WCS.LiveEventParser.prototype)).parse=function(e){var t=a.Base.Utils.queryJSONObject(e,"os_type[0]._text"),i=new a.Providers.WCS.GrantControlEventData(t);return new a.Providers.WCS.GrantControlEvent(this.stripCommonData(e),i)},a.Providers.WCS.GrantControlParser=e}(AvayaClientServices),function(e){"use strict";function t(){e.Providers.WCS.WCSSharingTag.call(this,e.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG),this.width=0,this.height=0,this.x=0,this.y=0,this.imageType=0,this.length=0,this.data=[]}t.prototype=Object.create(e.Providers.WCS.WCSSharingTag.prototype),e.Providers.WCS.ScreenSharingBlockTag=t}(AvayaClientServices),function(e){"use strict";function t(){e.Providers.WCS.WCSSharingTag.call(this,e.Providers.WCS.WCSScreenSharingTagTypes.CURSOR_TAG),this.x=0,this.y=0,this.creationTime=0}t.prototype=Object.create(e.Providers.WCS.WCSSharingTag.prototype),e.Providers.WCS.ScreenSharingCursorTag=t}(AvayaClientServices),function(e){"use strict";function t(){e.Providers.WCS.WCSSharingTag.call(this,e.Providers.WCS.WCSScreenSharingTagTypes.END_TAG)}t.prototype=Object.create(e.Providers.WCS.WCSSharingTag.prototype),e.Providers.WCS.ScreenSharingEndTag=t}(AvayaClientServices),function(e){"use strict";function t(){e.Providers.WCS.WCSSharingTag.call(this,e.Providers.WCS.WCSScreenSharingTagTypes.START_TAG),this.isKeyFrame=!1,this.width=0,this.height=0,this.creationTime=0}t.prototype=Object.create(e.Providers.WCS.WCSSharingTag.prototype),e.Providers.WCS.ScreenSharingStartTag=t}(AvayaClientServices),function(r,a){"use strict";function e(e){r.Base.RESTProvider.apply(this),this.type=r.Base.ProviderTypes.WCS_COMET_PROVIDER,this._connectionId=m,this._isOpened=!1,this._polling=!1,this._options={},this._parser=e,this._keepAliveTimeout=m,this._keepAliveTimer=3e4}(e.prototype=Object.create(r.Base.RESTProvider.prototype)).onConnectionUnavailable=function(){},e.prototype.close=function(){this._isOpened?(r.Base.RESTProvider.prototype.close.call(this),this._polling=!1,this._isOpened=!1,this._parser.removeOnMessageParsedCallback(this.onMessage)):this.onClose()},e.prototype.run=function(e){this._options=e,this._isOpened&&(this._polling=!0,this._poll(),this._parser.addOnMessageParsedCallback(this.onMessage))},e.prototype.start=function(e,t){return this._isOpened?(this.onOpen(),T.Deferred().resolve().promise()):(this._isOpened=!0,this._maxConnectionErrorCount=e.maxConnectionErrorCount,r.Base.RESTProvider.prototype.start.call(this,e,t))},e.prototype.send=function(e,t,i){return r.Base.Utils.isDefined(this._connectionId)&&(t.query="connection_id="+this._connectionId,t.sendType&&"POST"!==t.sendType||(e=this._addWCSHeader(e),t.processData=!1,t.dataType="binary",t.contentType="application/octet-stream")),i||(i=new r.Base.NetworkRequestRetryHelper(function(){return this.send(e,t,i)}.bind(this))),this._keepAlive(),t.keepAliveCallback=this._keepAlive.bind(this),r.Base.RESTProvider.prototype.send.call(this,e,t,i).then(function(e){if(this._isXmlString(e)){var t=a.parseString(e);return r.Base.Utils.isUndefined(this._connectionId)&&(this._connectionId=r.Base.Utils.queryJSONObject(t,"response[0].live_session[0].ws_connection_id[0]._text")),t}}.bind(this),function(e){e&&(this._keepAliveTimeout&&clearTimeout(this._keepAliveTimeout),this._connectionId=m,this._isOpened=!1,this._polling=!1,this.onConnectionUnavailable())}.bind(this))},e.prototype._isXmlString=function(e){return"string"==typeof e&&"xml"===e.substring(2,5)},e.prototype.isOpened=function(){return this._isOpened},e.prototype._ajaxOnSuccess=function(e,t,i,a){return this._removeXhrFromPool(i),a.resolve(e),e},e.prototype._poll=function(){this._polling&&(this._options.sendType="GET",this._options.dataType="binary",this._options.responseType="arraybuffer",this._options.binaryProgressCallback=this._parser.parse.bind(this._parser),this.send(m,this._options).done(function(){this._poll()}.bind(this)))},e.prototype._addWCSHeader=function(e){var t=r.Base.Utils.stringToArrayBuffer(this._parser.msgHeaderDetails.msgTxt),i=new ArrayBuffer(this._parser.msgHeaderDetails.flagSize);"string"==typeof e&&(new DataView(i).setUint8(0,this._parser.msgHeaderDetails.textFlagValue),e=r.Base.Utils.stringToArrayBuffer(e));var a=new ArrayBuffer(this._parser.msgHeaderDetails.lengthIndicatorSize);return new DataView(a).setUint32(0,e.byteLength),e=r.Base.Utils.concatArrayBuffers(r.Base.Utils.concatArrayBuffers(r.Base.Utils.concatArrayBuffers(t,i),a),e)},e.prototype._keepAlive=function(e){this._keepAliveTimeout&&clearTimeout(this._keepAliveTimeout),4!==e&&(this._keepAliveTimeout=setTimeout(function(){this._connectionId=m,this.close(),this.onConnectionUnavailable()}.bind(this),this._keepAliveTimer))},r.Providers.WCS.WCSCometProvider=e}(AvayaClientServices,xmlToJSON),function(a){"use strict";function e(e){this._callService=e,this._conference=m,this._remoteAddress="",this._remoteDisplayName="",this._callId=m,this._incoming=!1,this._subject="",this._dataOnly=!1,this._establishedTime=m,this._heldTime=m,this._remoteParticipant=new a.Services.Participant,this._activeParticipants=[],this._callState=a.Services.Call.CallStates.IDLE,this._confEntryOptions=m,this._callCreationInfo=m,this._sessionId=m,this._videoChannels=[],this._audioChannel=m,this._incomingVideoOffered=a.Services.Call.VideoNetworkSignalingType.INDEFINITE,this._isServiceAvailable=!1,this._isPrivateCallerID=!1,this._isAuraAsserted=!1,this._alertType=a.Services.Call.AlertType.UNSPECIFIED,this._heldRemotely=!1,this._remote=!1,this._isMissed=!1,this._modes=[],this._dtmfString=m,this._isEarlyMedia=!1,this._webCollaboration=!1,this._isGuestUser=!1,this._allowedNailedUpVideoModes=[],this._endCallWatchdogTimer=m,this._serviceQuality=new a.Services.Call.ServiceQuality(this),this._participantDroppedCallbacks=T.Callbacks(),this._onCallStartedCallbacks=T.Callbacks(),this._onCallRemoteAlertingCallbacks=T.Callbacks(),this._onCallRedirectedCallbacks=T.Callbacks(),this._onCallQueuedCallbacks=T.Callbacks(),this._onCallIgnoredCallbacks=T.Callbacks(),this._onCallEstablishedCallbacks=T.Callbacks(),this._onCallEstablishingCallbacks=T.Callbacks(),this._onCallRemoteAddressChangedCallbacks=T.Callbacks(),this._onCallHeldCallbacks=T.Callbacks(),this._onCallUnheldCallbacks=T.Callbacks(),this._onCallHeldRemotelyCallbacks=T.Callbacks(),this._onCallUnheldRemotelyCallbacks=T.Callbacks(),this._onCallJoinedCallbacks=T.Callbacks(),this._onCallEndedCallbacks=T.Callbacks(),this._onCallAudioMuteStatusChangedCallbacks=T.Callbacks(),this._onCallSpeakerMuteStatusChangedCallbacks=T.Callbacks(),this._onCallIncomingVideoAddRequestReceivedCallbacks=T.Callbacks(),this._onCallIncomingVideoAddRequestAcceptedCallbacks=T.Callbacks(),this._onCallIncomingVideoAddRequestDeniedCallbacks=T.Callbacks(),this._onCallIncomingVideoAddRequestTimedOutCallbacks=T.Callbacks(),this._onCallVideoChannelsUpdatedCallback=T.Callbacks(),this._onCallConferenceStatusChangedCallbacks=T.Callbacks(),this._onAudioStreamUpdatedCallback=T.Callbacks(),this._remoteVideoAddedCallbacks=T.Callbacks(),this._remoteVideoRemovedCallbacks=T.Callbacks(),this._callFailedCallbacks=T.Callbacks(),this._callServiceAvailableCallbacks=T.Callbacks(),this._callServiceUnavailableCallbacks=T.Callbacks(),this._callVideoChannelsUpdatedCallbacks=T.Callbacks(),this._callStateChangedCallBacks=T.Callbacks(),this._answerCallRequestedCallbacks=T.Callbacks(),this._terminateCallRequestedCallbacks=T.Callbacks(),this._updateCallRequestedCallbacks=T.Callbacks(),this._mediaConnectedCallbacks=T.Callbacks(),this._mediaDisconnectedCallbacks=T.Callbacks(),this._mediaFailedCallbacks=T.Callbacks(),this._isAudioMuted=!1,this._videoMuteState=a.Services.Call.MediaMuteStates.UNDEFINED,this._muteCapability=new a.Services.Call.Capabilities.MuteCapability(this),this._unmuteCapability=new a.Services.Call.Capabilities.UnmuteCapability(this),this._muteVideoCapability=new a.Services.Call.Capabilities.MuteVideoCapability(this,e.getVideoCapability()),this._unmuteVideoCapability=new a.Services.Call.Capabilities.UnmuteVideoCapability(this,e.getVideoCapability()),this._isSpeakerMuted=!1,this._ucid=m,this._muteSpeakerCapability=new a.Services.Call.Capabilities.MuteSpeakerCapability(this),this._unmuteSpeakerCapability=new a.Services.Call.Capabilities.UnmuteSpeakerCapability(this),this._videoChannelsCapability=new a.Services.Call.Capabilities.UpdateVideoChannelsCapability(this,e.getVideoCapability()),this._sendDTMFCapability=new a.Services.Call.Capabilities.SendDTMFCapability(this),this._holdCapability=new a.Services.Call.Capabilities.HoldCapability(this),this._unholdCapability=new a.Services.Call.Capabilities.UnholdCapability(this),this._joinCapability=new a.Services.Call.Capabilities.JoinCapability(this),this._transferCapability=new a.Services.Call.Capabilities.TransferCapability(this),this._transferToCapability=new a.Services.Call.Capabilities.TransferToCapability(this),this._updateVideoModeSendReceiveCapability=new a.Services.Call.Capabilities.UpdateVideoModeSendReceiveCapability(this,e.getVideoCapability()),this._updateVideoModeSendOnlyCapability=new a.Services.Call.Capabilities.UpdateVideoModeSendOnlyCapability(this,e.getVideoCapability()),this._updateVideoModeReceiveOnlyCapability=new a.Services.Call.Capabilities.UpdateVideoModeReceiveOnlyCapability(this,e.getVideoCapability()),this._updateVideoModeInactiveCapability=new a.Services.Call.Capabilities.UpdateVideoModeInactiveCapability(this,e.getVideoCapability()),this._updateVideoModeDisableCapability=new a.Services.Call.Capabilities.UpdateVideoModeDisableCapability(this,e.getVideoCapability()),this._updateWebCollaborationCapability=new a.Services.Call.Capabilities.UpdateWebCollaborationCapability(this),this._updateAudioModeCapability=new a.Services.Call.Capabilities.UpdateAudioModeCapability(this),this._serviceQualityScoreCapability=new a.Services.Call.Capabilities.ServiceQualityScoreCapability(this),this._preferredReceiveResolutionCapability=new a.Services.Call.Capabilities.UpdatePreferredReceiveResolutionCapability(this,e.getVideoCapability()),this._serviceQualityScoreCapability.addOnChangedCallback(function(){this._serviceQuality.watch()}.bind(this)),this._callStatisticsLogger=new a.Base.CallStatisticsLogger(this)}e.prototype={_setRemoteAddress:function(e){this._remoteAddress=e,this._remoteParticipant.setAddress(e),this._callService._updateMatchedContactsForCall(this)},getRemoteAddress:function(){return this._remoteAddress},_setDtmfString:function(e){this._dtmfString=e},getRemoteDisplayName:function(){return this._remoteDisplayName},isIncoming:function(){return this._incoming},getEstablishedTime:function(){return this._establishedTime},getHeldTime:function(){return this._heldTime},_setRemoteDisplayName:function(e){this._remoteDisplayName=e,this._remoteParticipant.setDisplayName(e)},getRemoteParticipant:function(){return this._remoteParticipant},start:function(){this._callService.isServiceAvailable()||this._isDataOnly()?this._callService.startCall(this):(this._callService._notifyCallFailure(this,a.Services.Call.CallError.SERVICE_UNAVAILABLE),this._endCallWatchdogTimer&&clearTimeout(this._endCallWatchdogTimer),this._endCallWatchdogTimer=setTimeout(function(){this.end()}.bind(this),5e3))},end:function(){this._endCallWatchdogTimer&&(clearTimeout(this._endCallWatchdogTimer),this._endCallWatchdogTimer=m),this.getState()!==a.Services.Call.CallStates.ENDING&&this.getState()!==a.Services.Call.CallStates.ENDED&&(this._setState(a.Services.Call.CallStates.ENDING),this._callService.endCall(this))},getConference:function(){return a.Base.Utils.isUndefined(this._conference)&&(a.Base.Logger.info(a.Base.LoggerTags.CALL_SERVICE,"getConference(): Creating new CM Conference"),this._createCMConference()),this._conference},hold:function(){return this._callService.hold(this)},unhold:function(){return this._callService.unhold(this)},ignore:function(){return this._callService.ignore(this)},accept:function(){return this._callService.accept(this)},deny:function(){return this._setState(a.Services.Call.CallStates.ENDING),this._callService.endCall(this,a.Services.Call.CallDenialReason.BUSY)},denyWithReason:function(e){this._setState(a.Services.Call.CallStates.ENDING);var t=a.Services.Call.CallDenialReason.TEMPORARILY_UNAVAILABLE;for(var i in a.Services.Call.CallDenialReason)if(a.Services.Call.CallDenialReason[i]===e){t=e;break}return this._callService.endCall(this,t)},sendDTMF:function(e){return this._callService.sendDTMF(this,e)},getState:function(){return this._callState},getRemoteNumber:function(){return this._remoteAddress},isConference:function(){return void 0!==this._conference},isIgnored:function(){return this.getState()===a.Services.Call.CallStates.IGNORED},isRemote:function(){return this._remote},_setRemote:function(e){this._remote=e},isHeldRemotely:function(){return this._heldRemotely},isMissed:function(){return this._isMissed},_setIsMissed:function(e){this._isMissed=e},isCallerIdentityPrivate:function(){return this._isPrivateCallerID},isServiceAvailable:function(){return this._isServiceAvailable},getAlertType:function(){return this._alertType},getSubject:function(){return this._subject},join:function(){return this._callService.join(this)},acceptSendVideo:function(e){return this._callService.acceptSendVideo(this,e)},denySendVideo:function(){return this._callService.denySendVideo(this)},getVideoChannels:function(){return this._videoChannels},getAudioChannel:function(){return this._audioChannel},setVideoChannels:function(e){return this._callService.setVideoChannels(this,e)},removeAllVideoChannels:function(){return this._callService.setVideoMode(this,a.Services.Call.VideoMode.DISABLE)},setVideoMode:function(e){return this._callService.setVideoMode(this,e)},setAudioMode:function(e){return this._callService.setAudioMode(this,e)},setWebCollaboration:function(e){return this._callService.setWebCollaboration(this,e)},getIncomingVideoOffered:function(){return this._incomingVideoOffered},getCallId:function(){return this._callId},_setCallId:function(e){this._callId=e},isAudioMuted:function(){return this._isAudioMuted},muteAudio:function(){if(this._isAudioMuted){var e=T.Deferred();return e.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MUTE_STATE_MISMATCH)),e.promise()}return this._callService.mute(this).then(function(){this._isAudioMuted=!0,this._muteCapability._recalculate(),this._unmuteCapability._recalculate()}.bind(this))},unmuteAudio:function(){if(this._isAudioMuted)return this._callService.unmute(this).then(function(){this._isAudioMuted=!1,this._muteCapability._recalculate(),this._unmuteCapability._recalculate()}.bind(this));var e=T.Deferred();return e.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MUTE_STATE_MISMATCH)),e.promise()},muteVideo:function(){return this._videoMuteState=a.Services.Call.MediaMuteStates.MUTED,this._callService.muteVideo(this).then(function(){this._muteVideoCapability._recalculate(),this._unmuteVideoCapability._recalculate()}.bind(this))},unmuteVideo:function(){return this._videoMuteState=a.Services.Call.MediaMuteStates.UNMUTED,this._callService.unmuteVideo(this).then(function(){this._muteVideoCapability._recalculate(),this._unmuteVideoCapability._recalculate()}.bind(this))},isSpeakerMuted:function(){return this._isSpeakerMuted},muteSpeaker:function(){if(this._isSpeakerMuted){var e=T.Deferred();return e.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MUTE_STATE_MISMATCH)),e.promise()}return this._callService.muteSpeaker(this).then(function(){this._isSpeakerMuted=!0,this._muteSpeakerCapability._recalculate(),this._unmuteSpeakerCapability._recalculate()}.bind(this))},unmuteSpeaker:function(){if(this._isSpeakerMuted)return this._callService.unmuteSpeaker(this).then(function(){this._isSpeakerMuted=!1,this._muteSpeakerCapability._recalculate(),this._unmuteSpeakerCapability._recalculate()}.bind(this));var e=T.Deferred();return e.reject(new a.Services.Call.CallException(a.Services.Call.CallError.MUTE_STATE_MISMATCH)),e.promise()},transfer:function(e){return this._callService.transfer(this,e)},attendedTransfer:function(e){return this._callService.attendedTransfer(this,e)},setConferenceEntryOptions:function(e){this._confEntryOptions=e,a.Base.Utils.isDefined(this._callCreationInfo)||(this._callCreationInfo=new a.Services.Call.CallCreationInfo),this._callCreationInfo.setConferenceID(e.getMeetingId()),this._callCreationInfo.setPortalToken(e.getToken()),this._callCreationInfo.setPasscode(e.getPasscode()),e.isOTT()?this._callCreationInfo.setCallType(a.Services.Call.CallType.CallTypeHttpMeetMe):this._callCreationInfo.setCallType(a.Services.Call.CallType.CallTypeDefaultRegisteredService)},getConferenceEntryOptions:function(){return this._confEntryOptions},getAudioDetails:function(){return this._callService.getAudioDetails(this)},getVideoDetails:function(){return this._callService.getVideoDetails(this)},getServiceQualityScore:function(){return this._serviceQuality.getScore()},_setState:function(e){var t=e!==this._callState;this._callState=e,t&&this._callStateChangedCallBacks.fire()},_setServiceAvailability:function(e){this._isServiceAvailable=e},_isDataOnly:function(){return this._dataOnly},_hasCallMode:function(t){return 0<this._modes.filter(function(e){return e.id===t}).length},_removeCallMode:function(t){this.modes=this._modes.filter(function(e){return e.id!==t})},_createCMConference:function(){this._conference=this._callService.createCMConference(this),this._updateVideoModeCapabilities()},_setConference:function(e){this._conference=e,this._updateVideoModeCapabilities()},_updateVideoModeCapabilities:function(){a.Base.Utils.isDefined(this._conference)&&(this._recalculateVideoModeCapabilities(),this._conference._addOnConferenceAllowVideoDirectionChangedCallback(this._recalculateVideoModeCapabilities.bind(this)))},_recalculateVideoModeCapabilities:function(){this._updateVideoModeSendReceiveCapability._recalculate(),this._updateVideoModeSendOnlyCapability._recalculate(),this._updateVideoModeReceiveOnlyCapability._recalculate(),this._updateVideoModeInactiveCapability._recalculate(),this._updateVideoModeDisableCapability._recalculate()},_setUserToUserInfo:function(e){this._userToUserInfo=e},_setAllowedNailedUpVideoModes:function(e){this._allowedNailedUpVideoModes=e},_getAllowedNailedUpVideoModes:function(){return this._allowedNailedUpVideoModes},getUserToUserInfo:function(){return this._userToUserInfo},startRinging:function(){return this._callService.startRinging(this)},acceptAnswerCallRequest:function(){return this._callService.acceptAnswerCallRequest(this)},acceptTerminateCallRequest:function(){return this._callService.acceptTerminateCallRequest(this)},acceptUpdateCallRequest:function(e){return this._callService.acceptUpdateCallRequest(this,e)},acceptMakeCallRequest:function(){return this._callService.acceptMakeCallRequest(this)},rejectAnswerCallRequest:function(){return this._callService.rejectAnswerCallRequest(this)},rejectTerminateCallRequest:function(){return this._callService.rejectTerminateCallRequest(this)},rejectUpdateCallRequest:function(e){return this._callService.rejectUpdateCallRequest(this,e)},rejectMakeCallRequest:function(){return this._callService.rejectMakeCallRequest(this)},isMediaConnected:function(){return this._callService.isMediaConnected(this)},_setIsGuestUser:function(e){this._isGuestUser=e},startLoggingStatistics:function(){this._callStatisticsLogger.start()},stopLoggingStatistics:function(){this._callStatisticsLogger.stop()}},a.Base.AOPTools.addAdvices(e,"Call",["start","end","getConference","setVideoMode","setConferenceEntryOptions"],[a.Base.AOPCommonAdvices.LOG_CALL_API_CALLS]),a.Base.AOPTools.addAdvices(e,"Call",["hold","unhold","ignore","accept","deny","denyWithReason","sendDTMF","join","acceptSendVideo","denySendVideo","setVideoChannels","removeAllVideoChannels","muteAudio","unmuteAudio","muteSpeaker","unmuteSpeaker","transfer","attendedTransfer","startRinging","acceptAnswerCallRequest","acceptTerminateCallRequest","acceptUpdateCallRequest","acceptMakeCallRequest","rejectAnswerCallRequest","rejectTerminateCallRequest","rejectUpdateCallRequest","rejectMakeCallRequest","muteVideo","unmuteVideo"],[a.Base.AOPCommonAdvices.LOG_CALL_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_CALL_ERROR]),a.Services.Call.Call=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Call.Call.prototype,{addOnRemoteVideoAddedCallback:function(e){this._remoteVideoAddedCallbacks.add(e)},removeOnRemoteVideoAddedCallback:function(e){this._remoteVideoAddedCallbacks.remove(e)},addOnRemoteVideoRemovedCallback:function(e){this._remoteVideoRemovedCallbacks.add(e)},removeOnRemoteVideoRemovedCallback:function(e){this._remoteVideoRemovedCallbacks.remove(e)},addOnCallVideoChannelsUpdatedCallback:function(e){this._onCallVideoChannelsUpdatedCallback.add(e)},removeOnCallVideoChannelsUpdatedCallback:function(e){this._onCallVideoChannelsUpdatedCallback.remove(e)},addOnAudioStreamUpdatedCallback:function(e){this._onAudioStreamUpdatedCallback.add(e)},removeOnAudioStreamUpdatedCallback:function(e){this._onAudioStreamUpdatedCallback.remove(e)},addOnCallStartedCallback:function(e){this._onCallStartedCallbacks.add(e)},removeOnCallStartedCallback:function(e){this._onCallStartedCallbacks.remove(e)},addOnCallRemoteAlertingCallback:function(e){this._onCallRemoteAlertingCallbacks.add(e)},removeOnCallRemoteAlertingCallback:function(e){this._onCallRemoteAlertingCallbacks.remove(e)},addOnCallRedirectedCallback:function(e){this._onCallRedirectedCallbacks.add(e)},removeOnCallRedirectedCallback:function(e){this._onCallRedirectedCallbacks.remove(e)},addOnCallQueuedCallback:function(e){this._onCallQueuedCallbacks.add(e)},removeOnCallQueuedCallback:function(e){this._onCallQueuedCallbacks.remove(e)},addOnCallIgnoredCallback:function(e){this._onCallIgnoredCallbacks.add(e)},removeOnCallIgnoredCallback:function(e){this._onCallIgnoredCallbacks.remove(e)},addOnCallEstablishedCallback:function(e){this._onCallEstablishedCallbacks.add(e)},removeOnCallEstablishedCallback:function(e){this._onCallEstablishedCallbacks.remove(e)},addOnCallEstablishingCallback:function(e){this._onCallEstablishingCallbacks.add(e)},removeOnCallEstablishingCallback:function(e){this._onCallEstablishingCallbacks.remove(e)},addOnCallRemoteAddressChangedCallback:function(e){this._onCallRemoteAddressChangedCallbacks.add(e)},removeOnCallRemoteAddressChangedCallback:function(e){this._onCallRemoteAddressChangedCallbacks.remove(e)},addOnCallHeldCallback:function(e){this._onCallHeldCallbacks.add(e)},removeOnCallHeldCallback:function(e){this._onCallHeldCallbacks.remove(e)},addOnCallUnheldCallback:function(e){this._onCallUnheldCallbacks.add(e)},removeOnCallUnheldCallback:function(e){this._onCallUnheldCallbacks.remove(e)},addOnCallHeldRemotelyCallback:function(e){this._onCallHeldRemotelyCallbacks.add(e)},removeOnCallHeldRemotelyCallback:function(e){this._onCallHeldRemotelyCallbacks.remove(e)},addOnCallUnheldRemotelyCallback:function(e){this._onCallUnheldRemotelyCallbacks.add(e)},removeOnCallUnheldRemotelyCallback:function(e){this._onCallUnheldRemotelyCallbacks.remove(e)},addOnCallJoinedCallback:function(e){this._onCallJoinedCallbacks.add(e)},removeOnCallJoinedCallback:function(e){this._onCallJoinedCallbacks.remove(e)},addOnCallEndedCallback:function(e){this._onCallEndedCallbacks.add(e)},removeOnCallEndedCallback:function(e){this._onCallEndedCallbacks.remove(e)},addOnCallAudioMuteStatusChangedCallback:function(e){this._onCallAudioMuteStatusChangedCallbacks.add(e)},removeOnCallAudioMuteStatusChangedCallback:function(e){this._onCallAudioMuteStatusChangedCallbacks.remove(e)},addOnCallSpeakerMuteStatusChangedCallback:function(e){this._onCallSpeakerMuteStatusChangedCallbacks.add(e)},removeOnCallSpeakerMuteStatusChangedCallback:function(e){this._onCallSpeakerMuteStatusChangedCallbacks.remove(e)},addOnCallIncomingVideoAddRequestReceivedCallback:function(e){this._onCallIncomingVideoAddRequestReceivedCallbacks.add(e)},removeOnCallIncomingVideoAddRequestReceivedCallback:function(e){this._onCallIncomingVideoAddRequestReceivedCallbacks.remove(e)},addOnCallIncomingVideoAddRequestAcceptedCallback:function(e){this._onCallIncomingVideoAddRequestAcceptedCallbacks.add(e)},removeOnCallIncomingVideoAddRequestAcceptedCallback:function(e){this._onCallIncomingVideoAddRequestAcceptedCallbacks.remove(e)},addOnCallIncomingVideoAddRequestDeniedCallback:function(e){this._onCallIncomingVideoAddRequestDeniedCallbacks.add(e)},removeOnCallIncomingVideoAddRequestDeniedCallback:function(e){this._onCallIncomingVideoAddRequestDeniedCallbacks.remove(e)},addOnCallIncomingVideoAddRequestTimedOutCallback:function(e){this._onCallIncomingVideoAddRequestTimedOutCallbacks.add(e)},removeOnCallIncomingVideoAddRequestTimedOutCallback:function(e){this._onCallIncomingVideoAddRequestTimedOutCallbacks.remove(e)},addOnCallVideoRemovedRemotelyCallback:function(e){},removeOnCallVideoRemovedRemotelyCallback:function(e){},addOnCallConferenceStatusChangedCallback:function(e){this._onCallConferenceStatusChangedCallbacks.add(e)},removeOnCallConferenceStatusChangedCallback:function(e){this._onCallConferenceStatusChangedCallbacks.remove(e)},addOnParticipantDroppedCallback:function(e){this._participantDroppedCallbacks.add(e)},removeOnParticipantDroppedCallback:function(e){this._participantDroppedCallbacks.remove(e)},addOnCallFailedCallback:function(e){this._callFailedCallbacks.add(e)},removeOnCallFailedCallback:function(e){this._callFailedCallbacks.remove(e)},addOnCallServiceAvailableCallback:function(e){this._callServiceAvailableCallbacks.add(e)},removeOnCallServiceAvailableCallback:function(e){this._callServiceAvailableCallbacks.remove(e)},addOnCallServiceUnavailableCallback:function(e){this._callServiceUnavailableCallbacks.add(e)},removeOnCallServiceUnavailableCallback:function(e){this._callServiceUnavailableCallbacks.remove(e)},addOnAnswerCallRequestedCallback:function(e){this._answerCallRequestedCallbacks.add(e)},removeOnAnswerCallRequestedCallback:function(e){this._answerCallRequestedCallbacks.remove(e)},addOnUpdateCallRequestedCallback:function(e){this._updateCallRequestedCallbacks.add(e)},removeOnUpdateCallRequestedCallback:function(e){this._updateCallRequestedCallbacks.remove(e)},addOnTerminateCallRequestedCallback:function(e){this._terminateCallRequestedCallbacks.add(e)},removeOnTerminateCallRequestedCallback:function(e){this._terminateCallRequestedCallbacks.remove(e)},addOnServiceQualityScoreChangedCallback:function(e){this._serviceQuality.addOnScoreChangedCallback(e)},removeOnServiceQualityScoreChangedCallback:function(e){this._serviceQuality.removeOnScoreChangedCallback(e)},addOnMediaConnectedCallback:function(e){this._mediaConnectedCallbacks.add(e)},removeOnMediaConnectedCallback:function(e){this._mediaConnectedCallbacks.remove(e)},addOnMediaDisconnectedCallback:function(e){this._mediaDisconnectedCallbacks.add(e)},removeOnMediaDisconnectedCallback:function(e){this._mediaDisconnectedCallbacks.remove(e)},addOnMediaFailedCallback:function(e){this._mediaFailedCallbacks.add(e)},removeOnMediaFailedCallback:function(e){this._mediaFailedCallbacks.remove(e)},_addOnCallStateChangedCallback:function(e){this._callStateChangedCallBacks.add(e)},_removeOnCallStateChangedCallback:function(e){this._callStateChangedCallBacks.remove(e)}})}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Call.Call.prototype,{getHoldCapability:function(){return this._holdCapability},getUnholdCapability:function(){return this._unholdCapability},getJoinCapability:function(){return this._joinCapability},getMuteCapability:function(){return this._muteCapability},getUnmuteCapability:function(){return this._unmuteCapability},getMuteVideoCapability:function(){return this._muteVideoCapability},getUnmuteVideoCapability:function(){return this._unmuteVideoCapability},getMuteSpeakerCapability:function(){return this._muteSpeakerCapability},getUnmuteSpeakerCapability:function(){return this._unmuteSpeakerCapability},getSendDTMFCapability:function(){return this._sendDTMFCapability},getTransferCapability:function(){return this._transferCapability},getTransferToCapability:function(){return this._transferToCapability},getUpdateVideoChannelsCapability:function(){return this._videoChannelsCapability},getUpdateVideoModeSendReceiveCapability:function(){return this._updateVideoModeSendReceiveCapability},getUpdateVideoModeSendOnlyCapability:function(){return this._updateVideoModeSendOnlyCapability},getUpdateVideoModeReceiveOnlyCapability:function(){return this._updateVideoModeReceiveOnlyCapability},getUpdateVideoModeInactiveCapability:function(){return this._updateVideoModeInactiveCapability},getUpdateVideoModeDisableCapability:function(){return this._updateVideoModeDisableCapability},getUpdateWebCollaborationCapability:function(){return this._updateWebCollaborationCapability},getUpdateAudioModeCapability:function(){return this._updateAudioModeCapability},getServiceQualityScoreCapability:function(){return this._serviceQualityScoreCapability}})}(AvayaClientServices),function(a){"use strict";function e(e,t){this._callManager=e,this._isAvailable=m,this._callService=t,this._callCreatedCallbacks=T.Callbacks(),this._callRemovedCallbacks=T.Callbacks(),this._incomingCallCallbacks=T.Callbacks(),this._undeliveredCallCallbacks=T.Callbacks(),this._callsServiceAvailableCallbacks=T.Callbacks(),this._callsServiceUnavailableCallbacks=T.Callbacks(),this._makeCallRequestedCallbacks=T.Callbacks(),this._voipCallingCapability=new a.Services.Call.Capabilities.VoipCallingCapability(this),this._setOnNetworkEventsCapability=new a.Services.Call.Capabilities.SetOnNetworkEventsCapability(t),this._removeOnNetworkEventsCapability=new a.Services.Call.Capabilities.RemoveOnNetworkEventsCapability(t),this._callService.on(a.Providers.Interfaces.CallServiceCallbackIds.INCOMING_CALL,function(e){this._incomingCallCallbacks.fire(e)}.bind(this)),this._callService.on(a.Providers.Interfaces.CallServiceCallbackIds.MAKE_CALL_REQUESTED,function(e){this._makeCallRequestedCallbacks.fire(e)}.bind(this)),this._voipCallingCapability._recalculate(),this._callManager.setCalls(this),this._onIviewTokenChanged=function(){},this._onRingbackToneURLsChangedCallback=T.Callbacks()}e.prototype={createCall:function(e){if(!e.isPresentationModeOnly()&&!this.getVoipCallingCapability().isAllowed)throw new a.Services.Call.CallException(this.getVoipCallingCapability().denialReason);if(e.getServiceGatewayURL()!==m&&e.getPortalToken()===m&&e.getAuthorizationToken()===m)throw a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Failed to create a call - token is invalid"),new a.Services.Call.CallException(a.Services.Call.CallError.INVALID_PARAMETER);var t=this._callManager.createCall(this._callService);if(t._remoteAddress=e.getRemoteAddress(),t._subject=e.getSubject(),t._dataOnly=e.isPresentationModeOnly(),t._callCreationInfo=e,t.getUpdateWebCollaborationCapability()._recalculate(),t.getUpdateAudioModeCapability()._recalculate(),t.getServiceQualityScoreCapability()._recalculate(),t._dataOnly){var i=new a.Services.Call.Modes.ConferenceCallMode(t,a.Services.Call.CallModes.CONFERENCE_CALL,this._callService._contactsIntegrationService);this._callManager.setCallMode(t,i)}return a.Base.Utils.isDefined(this._callService._config.wcsConfiguration)&&a.Base.Utils.isDefined(this._callService._config.wcsConfiguration.enabled)&&(t._webCollaboration=this._callService._config.wcsConfiguration.enabled),t},createDefaultCall:function(){var e;if(!this._callService._config._mediaServiceConfiguration)throw a.Base.Logger.error(a.Base.LoggerTags.CALL_SERVICE,"Failed to create call - media service context is invalid"),new a.Services.Call.CallException(a.Services.Call.CallError.INVALID_PARAMETER);if(0<this._callManager._getLiveCallCount())throw new a.Services.Call.CallException(a.Services.Call.CallError.MULTIPLE_CALLS_NOT_SUPPORTED);var t=new a.Services.Call.CallCreationInfo("",!1,"");return(e=this._callManager.createCall(this._callService))._sessionId=this._callService._config._mediaServiceConfiguration.sessionId,e._callCreationInfo=t,e.getUpdateWebCollaborationCapability()._recalculate(),e.getUpdateAudioModeCapability()._recalculate(),a.Base.Logger.info(a.Base.LoggerTags.CALL_SERVICE,"session id: "+e._sessionId),e},getCalls:function(){return this._callManager.getAllCalls()},getCallCount:function(){return this._callManager.getCallCount()},getActiveCall:function(){return this._callManager.getActiveCall()},getIgnoredCalls:function(){return this._callManager.getIgnoredCalls()},getVideoCapability:function(){return this._callService.getVideoCapability()},hasHeldCall:function(){return this._callManager.hasHeldCall()},hasInitiatingCall:function(){return this._callManager.hasInitiatingCall()},getVoipCallingCapability:function(){return this._voipCallingCapability},getSetOnNetworkEventsCapability:function(){return this._setOnNetworkEventsCapability},getRemoveOnNetworkEventsCapability:function(){return this._removeOnNetworkEventsCapability},setOnNetworkEvents:function(e,t){return this._callService.setOnNetworkEvents(e,t)},removeOnNetworkEvents:function(){return this._callService.removeOnNetworkEvents()},_start:function(){return this._callService.start(this)},_stop:function(){return this._callService.stop().always(function(){this._cleanupAndTriggerServiceUnavailable()}.bind(this))},_stopImmediately:function(){return this._callService.stopImmediately().always(function(){for(var e=0;e<this._callManager._calls.length;e++)this._callManager._calls[e].isConference()&&this._callManager._calls[e]._conference.stopImmediately();this._cleanupAndTriggerServiceUnavailable()}.bind(this))},_cleanupAndTriggerServiceUnavailable:function(){this._callsServiceUnavailableCallbacks.fire(this),this._isAvailable=m,this._callManager._calls=[],this._resetCallbacks()},_resetCallbacks:function(){this._callRemovedCallbacks.empty(),this._incomingCallCallbacks.empty(),this._undeliveredCallCallbacks.empty(),this._callsServiceAvailableCallbacks.empty(),this._callsServiceUnavailableCallbacks.empty(),this._callCreatedCallbacks.empty()},_isWebRTCSupportedBrowser:function(){return this._callService._isWebRTCSupportedBrowser()},_uploadLogs:function(){return this._callService.uploadLogs()},_isRegistrationTerminated:function(){return this._callService.isRegistrationTerminated()}},a.Base.AOPTools.addAdvices(e,"Calls",["createCall","createDefaultCall"],[a.Base.AOPCommonAdvices.LOG_CALL_API_CALLS]),a.Services.Call.Calls=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Call.Calls.prototype,{addOnCallsServiceAvailableCallback:function(e){this._callsServiceAvailableCallbacks.add(e)},removeOnCallsServiceAvailableCallback:function(e){this._callsServiceAvailableCallbacks.remove(e)},addOnCallsServiceUnavailableCallback:function(e){this._callsServiceUnavailableCallbacks.add(e)},removeOnCallsServiceUnavailableCallback:function(e){this._callsServiceUnavailableCallbacks.remove(e)},addOnCallCreatedCallback:function(e){this._callCreatedCallbacks.add(e)},removeOnCallCreatedCallback:function(e){this._callCreatedCallbacks.remove(e)},addOnCallRemovedCallback:function(e){this._callRemovedCallbacks.add(e)},removeOnCallRemovedCallback:function(e){this._callRemovedCallbacks.remove(e)},addOnIncomingCallCallback:function(e){this._incomingCallCallbacks.add(e)},removeOnIncomingCallCallback:function(e){this._incomingCallCallbacks.remove(e)},addOnUndeliveredCallCallback:function(e){this._undeliveredCallCallbacks.add(e)},removeOnUndeliveredCallCallback:function(e){this._undeliveredCallCallbacks.remove(e)},addOnRingbackToneURLsChangedCallback:function(e){this._onRingbackToneURLsChangedCallback.add(e)},removeOnRingbackToneURLsChangedCallback:function(e){this._onRingbackToneURLsChangedCallback.remove(e)},addOnMakeCallRequestedCallback:function(e){this._makeCallRequestedCallbacks.add(e)},removeOnMakeCallRequestedCallback:function(e){this._makeCallRequestedCallbacks.remove(e)}})}(AvayaClientServices),function(a){"use strict";function e(e){var t=[a.Services.Call.CallStates.ESTABLISHED,a.Services.Call.CallStates.HELD,a.Services.Call.CallStates.HOLDING,a.Services.Call.CallStates.UNHOLDING,a.Services.Call.CallStates.RENEGOTIATING,a.Services.Call.CallStates.FAR_END_RENEGOTIATING,a.Services.Call.CallStates.REMOTE_ALERTING];a.Services.Call.Capabilities.AbstractCallStateCapability.call(this,e,t,!0,!1,!0)}(e.prototype=Object.create(a.Services.Call.Capabilities.AbstractCallStateCapability.prototype))._recalculateDenialReason=function(){var e=a.Services.Call.Capabilities.AbstractCallStateCapability.prototype._recalculateDenialReason.call(this),t=e===a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,i=!a.Base.Utils.isDefined(this._call.getAudioChannel())||this._call.getAudioChannel()._getNegotiatedDirection()!==a.Services.Call.MediaDirection.DISABLE;return t&&!i&&(e=a.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED),e},a.Services.Call.Capabilities.AbstractCallMuteCapability=e}(AvayaClientServices),function(i){"use strict";function e(e){i.Services.Call.Capabilities.AbstractCallMuteCapability.call(this,e)}(e.prototype=Object.create(i.Services.Call.Capabilities.AbstractCallMuteCapability.prototype))._recalculate=function(){var e=i.Services.Call.Capabilities.AbstractCallMuteCapability.prototype._recalculateDenialReason.call(this),t=e===i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;t&&this._call.isAudioMuted()&&(t=!1,e=i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIfChanged(t,e)},i.Services.Call.Capabilities.MuteCapability=e}(AvayaClientServices),function(i){"use strict";function e(e){i.Services.Call.Capabilities.AbstractCallMuteCapability.call(this,e)}(e.prototype=Object.create(i.Services.Call.Capabilities.AbstractCallMuteCapability.prototype))._recalculate=function(){var e=i.Services.Call.Capabilities.AbstractCallMuteCapability.prototype._recalculateDenialReason.call(this),t=e===i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;t&&this._call.isSpeakerMuted()&&(t=!1,e=i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIfChanged(t,e)},i.Services.Call.Capabilities.MuteSpeakerCapability=e}(AvayaClientServices),function(i){"use strict";function e(e){i.Services.Call.Capabilities.AbstractCallMuteCapability.call(this,e)}(e.prototype=Object.create(i.Services.Call.Capabilities.AbstractCallMuteCapability.prototype))._recalculate=function(){var e=i.Services.Call.Capabilities.AbstractCallMuteCapability.prototype._recalculateDenialReason.call(this),t=e===i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;t&&!this._call.isAudioMuted()&&(t=!1,e=i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIfChanged(t,e)},i.Services.Call.Capabilities.UnmuteCapability=e}(AvayaClientServices),function(i){"use strict";function e(e){i.Services.Call.Capabilities.AbstractCallMuteCapability.call(this,e)}(e.prototype=Object.create(i.Services.Call.Capabilities.AbstractCallMuteCapability.prototype))._recalculate=function(){var e=i.Services.Call.Capabilities.AbstractCallMuteCapability.prototype._recalculateDenialReason.call(this),t=e===i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;t&&!this._call.isSpeakerMuted()&&(t=!1,e=i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIfChanged(t,e)},i.Services.Call.Capabilities.UnmuteSpeakerCapability=e}(AvayaClientServices),function(n){"use strict";function e(e,t,i,a,r,s){this._collaborationService=e,this._whiteboard=t,this._contentSharing=i,this._slider=a,this._collaborationId=r,this._callId=s,this._isAvailable=m,this._participants=new n.Base.DataSet,this._selfParticipant=m,this._supportedFeatures=[n.Services.Collaboration.FeaturesAvailable.SCREEN_SHARING,n.Services.Collaboration.FeaturesAvailable.WHITEBOARD,n.Services.Collaboration.FeaturesAvailable.SLIDER],this._onCollaborationStartedCallbacks=T.Callbacks(),this._onCollaborationEndedCallbacks=T.Callbacks("unique"),this._onCollaborationServiceAvailableCallbacks=T.Callbacks("unique"),this._onCollaborationServiceUnavailableCallbacks=T.Callbacks("unique"),this._onCollaborationNearEndByEjectCallbacks=T.Callbacks("unique"),this._onCollaborationPresenterPrivilegeChangedCallbacks=T.Callbacks("unique"),this._onCollaborationModeratorPrivilegeChangedCallbacks=T.Callbacks("unique"),this._onCollaborationInitializedCallbacks=T.Callbacks("unique"),this._isPaused=!1,this._chatCapability=new n.Base.Capability(n.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._meetingMinutesCapability=new n.Base.Capability(n.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._contentSharingCapability=new n.Base.Capability(n.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._networkLibraryCapability=new n.Base.Capability(n.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._librarySharingCapability=new n.Base.Capability(n.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._whiteboardCapability=new n.Base.Capability(n.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._retrieveParticipantListCapability=new n.Base.Capability(n.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._sliderCapability=new n.Base.Capability(n.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._isStarted=!1,this._isStopped=!0,this._config=m,this._meetingId=m,this._isReceivingSharingPaused=!1}e.prototype={start:function(e,t){if(n.Base.Utils.isDefined(e)&&n.Base.Utils.isDefined(t)&&(this._config=e,this._meetingId=t),n.Base.Utils.isDefined(this._config)&&n.Base.Utils.isDefined(this._meetingId))return this._collaborationService.start(this,this._config,this._meetingId).then(function(){this._contentSharing._start()}.bind(this));n.Base.Logger.error(n.Base.LoggerTags.COLLABORATION_SERVICE,"Configuration or meeting Id is missing");var i=n.Services.Collaboration.CollaborationErrorReason.COLLABORATION_START_FAILURE;return T.Deferred().reject(new n.Services.Collaboration.CollaborationError(i)).promise()},stop:function(){return this._contentSharing._collaborationEnd=!0,this._contentSharing.end().always(function(){this._contentSharing._stop()}.bind(this)),this._whiteboard.stop(),this._collaborationService.stop(this)},getContentSharing:function(){return this._contentSharing},getWhiteboard:function(){return this._whiteboard},getParticipants:function(){return this._collaborationService.getParticipants(this)},getCallId:function(){return this._callId},getCollaborationId:function(){return this._collaborationId},hasPresenterPrivilege:function(){},isEjected:function(){},hasModeratorPrivilege:function(){},pause:function(){return this._isReceivingSharingPaused=!0,this._collaborationService.pause(this)},resume:function(){return this._isReceivingSharingPaused=!1,this._collaborationService.resume(this)},_setConfiguration:function(e,t){this._config=e,this._meetingId=t},getSlider:function(){return this._slider},isReceivingSharingPaused:function(){return this._isReceivingSharingPaused},_setSelfParticipant:function(e){this._selfParticipant=e,this._selfParticipant&&this._selfParticipant instanceof n.Services.Participant&&(this._selfParticipant._localUser=!0),this._participants.push(this._selfParticipant),this._participants.onDataSetChanged([this._selfParticipant],n.Base.DataSetChangeTypes.ADDED)}},n.Base.AOPTools.addAdvices(e,"Collaboration",["getParticipants"],[n.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS]),n.Base.AOPTools.addAdvices(e,"Collaboration",["start","stop","pause","resume"],[n.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS,n.Base.AOPCommonAdvices.WRAP_CAUGHT_COLLABORATION_ERROR]),n.Services.Collaboration.Collaboration=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Collaboration.Collaboration.prototype,{addOnCollaborationStartedCallback:function(e){this._onCollaborationStartedCallbacks.add(e)},removeOnCollaborationStartedCallback:function(e){this._onCollaborationStartedCallbacks.remove(e)},addOnCollaborationEndedCallback:function(e){this._onCollaborationEndedCallbacks.add(e)},removeOnCollaborationEndedCallback:function(e){this._onCollaborationEndedCallbacks.remove(e)},addOnCollaborationServiceAvailableCallback:function(e){this._onCollaborationServiceAvailableCallbacks.add(e)},removeOnCollaborationServiceAvailableCallback:function(e){this._onCollaborationServiceAvailableCallbacks.remove(e)},addOnCollaborationServiceUnavailableCallback:function(e){this._onCollaborationServiceUnavailableCallbacks.add(e)},removeOnCollaborationServiceUnavailableCallback:function(e){this._onCollaborationServiceUnavailableCallbacks.remove(e)},addOnCollaborationNearEndByEjectCallback:function(e){this._onCollaborationNearEndByEjectCallbacks.add(e)},removeOnCollaborationNearEndByEjectCallback:function(e){this._onCollaborationNearEndByEjectCallbacks.remove(e)},addOnCollaborationPresenterPrivilegeChangedCallback:function(e){this._onCollaborationPresenterPrivilegeChangedCallbacks.add(e)},removeOnCollaborationPresenterPrivilegeChangedCallback:function(e){this._onCollaborationPresenterPrivilegeChangedCallbacks.remove(e)},addOnCollaborationModeratorPrivilegeChangedCallback:function(e){this._onCollaborationModeratorPrivilegeChangedCallbacks.add(e)},removeOnCollaborationModeratorPrivilegeChangedCallback:function(e){this._onCollaborationModeratorPrivilegeChangedCallbacks.remove(e)},addOnCollaborationInitializedCallback:function(e){this._onCollaborationInitializedCallbacks.add(e)},removeOnCollaborationInitializedCallback:function(e){this._onCollaborationInitializedCallbacks.remove(e)}})}(AvayaClientServices),function(l){"use strict";var e={getChatCapability:function(){return this._chatCapability},_recalculateChatCapability:function(){var e,t,i=this._isAvailable,a=this._collaborationService.isFeatureSupported(this,l.Services.Collaboration.FeaturesAvailable.MESSAGES);t=i&&a&&this._isBrowserAllowed()?(e=!0,l.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._chatCapability._updateIfChanged(e,t)},getMeetingMinutesCapability:function(){return this._meetingMinutesCapability},_recalculateMeetingMinutesCapability:function(){var e,t,i=this._isAvailable,a=this._collaborationService.isFeatureSupported(this,l.Services.Collaboration.FeaturesAvailable.MINUTES);t=i&&a&&this._isBrowserAllowed()?(e=!0,l.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._meetingMinutesCapability._updateIfChanged(e,t)},getContentSharingCapability:function(){return this._contentSharingCapability},_recalculateContentSharingCapability:function(e){var t,i,a=this._isAvailable,r=this._contentSharing.getShareApplicationWindowCapability(),s=this._contentSharing.getShareApplicationWindowCapability().isAllowed||this._contentSharing.getShareFullScreenCapability().isAllowed||this._contentSharing.getStartScreenSharingCapability().isAllowed,n=this._collaborationService.isFeatureSupported(this,l.Services.Collaboration.FeaturesAvailable.SCREEN_SHARING),o=!e||!!e._selfParticipant&&e._selfParticipant._presenter,c=l.Providers.ContentSharing.FeatureSupported.isSharingApplicationWindowAvailable()||l.Providers.ContentSharing.FeatureSupported.isSharingFullScreenAvailable()||l.Providers.ContentSharing.FeatureSupported.isSharingAnyTypeAvailable();i=a&&c&&s&&n&&o?(t=!0,l.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):c?c&&!s&&r.denialReason===l.Base.CapabilityDenialReason.CAPABILITY_NOT_INSTALLED?(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_INSTALLED):(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._contentSharingCapability._updateIfChanged(t,i)},getNetworkLibraryCapability:function(){return this._networkLibraryCapability},_recalculateNetworkLibraryCapability:function(){var e,t,i=this._isAvailable,a=this._collaborationService.isFeatureSupported(this,l.Services.Collaboration.FeaturesAvailable.LIBRARY);t=i&&a&&this._isBrowserAllowed()?(e=!0,l.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._networkLibraryCapability._updateIfChanged(e,t)},getLibrarySharingCapability:function(){return this._librarySharingCapability},_recalculateLibrarySharingCapability:function(){var e,t,i=this._isAvailable,a=this._collaborationService.isFeatureSupported(this,l.Services.Collaboration.FeaturesAvailable.LIBRARY);t=i&&a&&this._isBrowserAllowed()?(e=!0,l.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._librarySharingCapability._updateIfChanged(e,t)},getWhiteboardCapability:function(){return this._whiteboardCapability},_recalculateWhiteboardCapability:function(e){var t,i,a=this._isAvailable,r=this._collaborationService.isFeatureSupported(this,l.Services.Collaboration.FeaturesAvailable.WHITEBOARD),s=!e||!!e._selfParticipant&&e._selfParticipant._presenter;i=a&&r&&this._isBrowserAllowed()&&s?(t=!0,l.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._whiteboardCapability._updateIfChanged(t,i)},getRetrieveParticipantListCapability:function(){return this._retrieveParticipantListCapability},_recalculateRetrieveParticipantListCapability:function(){var e,t;t=this._isAvailable&&this._isBrowserAllowed()?(e=!0,l.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._retrieveParticipantListCapability._updateIfChanged(e,t)},_isBrowserAllowed:function(){return!0},getSliderCapability:function(){return this._sliderCapability},_recalculateSliderCapability:function(){var e,t,i=this._isAvailable,a=this._collaborationService.isFeatureSupported(this,l.Services.Collaboration.FeaturesAvailable.SLIDER);t=i&&a&&this._isBrowserAllowed()?(e=!0,l.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._sliderCapability._updateIfChanged(e,t)}};T.extend(l.Services.Collaboration.Collaboration.prototype,e)}(AvayaClientServices),function(a){"use strict";function e(e){this._factory=e,this._collaborationsStore={},this._onActiveContentSharingChangedCallback=T.Callbacks(),this._activeContentSharing=m}e.prototype={getCollaborationForCall:function(e){for(var t in a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this._collaborationsStore)if(this._collaborationsStore.hasOwnProperty(t)&&this._collaborationsStore[t].getCallId()===e)return this._collaborationsStore[t];return this._createAndSaveCollaboration(e)},getCollaborationById:function(e){return this._collaborationsStore.hasOwnProperty(e)?this._collaborationsStore[e]:this._createAndSaveCollaboration(e)},_generateUniqueIdForCollaboration:function(){var e=a.Base.Utils.makeId();return this._collaborationsStore.hasOwnProperty(e)?this._generateUniqueIdForCollaboration():e},_createAndSaveCollaboration:function(e){var t=this._factory.create(this,this._generateUniqueIdForCollaboration(),e);return this._collaborationsStore[t.getCollaborationId()]=t},_isCollaborationForCall:function(e){var t=!1;if(a.Base.Utils.isUndefined(e))return t;for(var i in this._collaborationsStore)this._collaborationsStore.hasOwnProperty(i)&&this._collaborationsStore[i].getCallId()===e&&(t=!0);return t},_deleteCollaboration:function(e){this._collaborationsStore[e]&&delete this._collaborationsStore[e]},_stopAndDeleteAllCollaborations:function(){for(var e in this._collaborationsStore)this._collaborationsStore.hasOwnProperty(e)&&(this._collaborationsStore[e].stop(),this._deleteCollaboration(e));return this._collaborationsStore={},T.Deferred().resolve().promise()},_stopImmediately:function(){for(var e in this._collaborationsStore)this._collaborationsStore.hasOwnProperty(e)&&(this._collaborationsStore[e]._isStarted=!1,this._collaborationsStore[e]._isAvailable&&(this._collaborationsStore[e]._isAvailable=m,this._collaborationsStore[e]._onCollaborationServiceUnavailableCallbacks.fire(this._collaborationsStore[e])),this._collaborationsStore[e]._isStopped=!0,a.Base.Logger.debug(a.Base.LoggerTags.COLLABORATION_SERVICE,"Collaboration Service stop",e),delete this._collaborationsStore[e]);return T.Deferred().resolve().promise()}},a.Base.AOPTools.addAdvices(e,"Collaborations",["getCollaborationById","getCollaborationForCall"],[a.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS]),a.Services.Collaboration.Collaborations=e}(AvayaClientServices),function(i){"use strict";function e(e,t){this._contentSharingService=e,this._collaborations=t,this._collaborations._onActiveContentSharingChangedCallback.add(this._onActiveContentSharingChanged.bind(this)),this._collaborationEnd=!1,this._collaboration=m,this._isPaused=!1,this._onContentSharingStartedCallbacks=T.Callbacks(),this._onContentSharingEndedCallbacks=T.Callbacks(),this._onContentSharingPausedCallbacks=T.Callbacks(),this._onContentSharingResumedCallbacks=T.Callbacks(),this._onCursorReceivedCallbacks=T.Callbacks(),this._onFrameStartReceivedCallbacks=T.Callbacks(),this._onFrameEndReceivedCallbacks=T.Callbacks(),this._onFrameReceivedCallbacks=T.Callbacks(),this._onFrameChangedCallbacks=T.Callbacks(),this._onBlockReceivedCallbacks=T.Callbacks(),this._onFrameReportReceivedCallbacks=T.Callbacks(),this._shareApplicationWindowCapability=new i.Base.Capability(i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._shareFullScreenCapability=new i.Base.Capability(i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._shareAnyTypeCapability=new i.Base.Capability(i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._contentSharingService.getShareFullScreenCapability()._onChangedCallbacks.add(function(){this._recalculateShareFullScreenCapability(this._collaboration)}.bind(this)),this._contentSharingService.getShareApplicationWindowCapability()._onChangedCallbacks.add(function(){this._recalculateShareApplicationWindowCapability(this._collaboration)}.bind(this)),this._contentSharingService.getShareAnyTypeCapability()._onChangedCallbacks.add(function(){this._recalculateShareAnyTypeCapability(this._collaboration)}.bind(this))}e.prototype={_start:function(){this._contentSharingService.start(this)},_stop:function(){this._contentSharingService.stop(this)},_setCollaboration:function(e){this._collaboration=e},_setMaxUploadSpeed:function(e){this._contentSharingService.setMaxUploadSpeed(e)},setExtensionAvailable:function(e){this._contentSharingService.setExtensionAvailable(e)},startScreenSharingFullScreen:function(e){var t=i.Base.ErrorReasons.DEPRECATED+" Please use ContentSharing.startScreenSharing instead of ContentSharing.startScreenSharingFullscreen";return i.Base.Logger.warn(i.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,t),this._contentSharingService.startScreenSharingFullScreen(this,e)},startScreenSharing:function(){return this._contentSharingService.startScreenSharingAnyType(this)},isSharingFullScreen:function(){return this._contentSharingService.isSharingFullScreen()},getReceivingBitrate:function(){return this._contentSharingService.getReceivingBitrate()},getOutgoingScreenSharingStream:function(){return this._contentSharingService.getOutgoingScreenSharingStream()},startSharingApplicationWindow:function(e){var t=i.Base.ErrorReasons.DEPRECATED+" Please use ContentSharing.startScreenSharing instead of ContentSharing.startSharingApplicationWindow";return i.Base.Logger.warn(i.Base.LoggerTags.CONTENT_SHARING_COLLABORATION_PROVIDER,t),this._contentSharingService.startSharingApplicationWindow(this,e)},isSharingApplicationWindow:function(){return this._contentSharingService.isSharingApplicationWindow()},end:function(){var e=this._collaborationEnd&&!(this.isSharingFullScreen()||this.isSharingApplicationWindow());return this._collaborationEnd=!1,this._contentSharingService.end(e,this)},isPresenting:function(){return this._contentSharingService.isPresenting()},isContentSharingActive:function(){return this._contentSharingService.isContentSharingActive()},isContentSharingPaused:function(){return this._contentSharingService.isContentSharingPaused()},pause:function(){return this._contentSharingService.pause()},resume:function(){return this._contentSharingService.resume()},_onActiveContentSharingChanged:function(){this._contentSharingService._recalculateAllContentSharingCapabilities(this)},_getCollaborations:function(){return this._collaborations},_clearActiveContentSharing:function(){var e=this._collaborations._activeContentSharing;e&&e===this&&(this._collaborations._activeContentSharing=m)},_endActiveScreenSharing:function(e){this._contentSharingService._endActiveScreenSharing(this,e)},_setImageQuality:function(e){this._contentSharingService.setImageQuality(e)}},i.Base.AOPTools.addAdvices(e,"ContentSharing",["startScreenSharing","startScreenSharingFullScreen","startSharingApplicationWindow","end","pause","resume"],[i.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS,i.Base.AOPCommonAdvices.WRAP_CAUGHT_COLLABORATION_ERROR]),i.Services.Collaboration.ContentSharing=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Collaboration.ContentSharing.prototype,{addOnContentSharingStartedCallback:function(e){this._onContentSharingStartedCallbacks.add(e)},removeOnContentSharingStartedCallback:function(e){this._onContentSharingStartedCallbacks.remove(e)},addOnContentSharingEndedCallback:function(e){this._onContentSharingEndedCallbacks.add(e)},removeOnContentSharingEndedCallback:function(e){this._onContentSharingEndedCallbacks.remove(e)},addOnContentSharingPausedCallback:function(e){this._onContentSharingPausedCallbacks.add(e)},removeOnContentSharingPausedCallback:function(e){this._onContentSharingPausedCallbacks.remove(e)},addOnContentSharingResumedCallback:function(e){this._onContentSharingResumedCallbacks.add(e)},removeOnContentSharingResumedCallback:function(e){this._onContentSharingResumedCallbacks.remove(e)},addOnCursorReceivedCallback:function(e){this._onCursorReceivedCallbacks.add(e)},removeOnCursorReceivedCallback:function(e){this._onCursorReceivedCallbacks.remove(e)},addOnFrameChangedCallback:function(e){this._onFrameChangedCallbacks.add(e)},removeOnFrameChangedCallback:function(e){this._onFrameChangedCallbacks.remove(e)},addOnFrameReceivedCallback:function(e){this._onFrameReceivedCallbacks.add(e)},removeOnFrameReceivedCallback:function(e){this._onFrameReceivedCallbacks.remove(e)},addOnFrameReportReceivedCallbacks:function(e){this._onFrameReportReceivedCallbacks.add(e)},removeOnFrameReportReceivedCallbacks:function(e){this._onFrameReportReceivedCallbacks.remove(e)}})}(AvayaClientServices),function(l){"use strict";var e={getShareApplicationWindowCapability:function(){return this._shareApplicationWindowCapability},_recalculateShareApplicationWindowCapability:function(e){var t,i,a=this._contentSharingService.getShareApplicationWindowCapability(),r=this._contentSharingService.isOpened(),s=this._contentSharingService.isFeatureAvailable(l.Services.Collaboration.FeaturesAvailable.SCREEN_SHARING),n=l.Base.Utils.isDefined(this._collaborations._activeContentSharing)&&this._getCollaborations()._activeContentSharing!==this,o=l.Providers.ContentSharing.FeatureSupported.isSharingApplicationWindowAvailable(),c=!e||!!e._selfParticipant&&e._selfParticipant._presenter;i=o&&a.isAllowed&&r&&s&&c?n?(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(t=!0,l.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):o?o&&!a.isAllowed?(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_INSTALLED):(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._shareApplicationWindowCapability._updateIfChanged(t,i)},getShareFullScreenCapability:function(){return this._shareFullScreenCapability},_recalculateShareFullScreenCapability:function(e){var t,i,a=this._contentSharingService.getShareFullScreenCapability(),r=this._contentSharingService.isOpened(),s=this._contentSharingService.isFeatureAvailable(l.Services.Collaboration.FeaturesAvailable.SCREEN_SHARING),n=l.Base.Utils.isDefined(this._collaborations._activeContentSharing)&&this._getCollaborations()._activeContentSharing!==this,o=l.Providers.ContentSharing.FeatureSupported.isSharingFullScreenAvailable(),c=!e||!!e._selfParticipant&&e._selfParticipant._presenter;i=o&&a.isAllowed&&r&&s&&c?n?(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(t=!0,l.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):o?o&&!a.isAllowed?(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_INSTALLED):(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._shareFullScreenCapability._updateIfChanged(t,i)},getStartScreenSharingCapability:function(){return this._shareAnyTypeCapability},_recalculateShareAnyTypeCapability:function(e){var t,i,a=this._contentSharingService.getShareAnyTypeCapability(),r=this._contentSharingService.isOpened(),s=this._contentSharingService.isFeatureAvailable(l.Services.Collaboration.FeaturesAvailable.SCREEN_SHARING),n=l.Base.Utils.isDefined(this._collaborations._activeContentSharing)&&this._getCollaborations()._activeContentSharing!==this,o=l.Providers.ContentSharing.FeatureSupported.isSharingAnyTypeAvailable(),c=!e||!!e._selfParticipant&&e._selfParticipant._presenter;i=o&&a.isAllowed&&r&&s&&c?n?(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(t=!0,l.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):o?o&&!a.isAllowed?(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_INSTALLED):(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(t=!1,l.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._shareAnyTypeCapability._updateIfChanged(t,i)},getSupportRemoteControlCapability:function(){return new l.Base.Capability(l.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED)},getRequestRemoteControlCapability:function(){return new l.Base.Capability(l.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED)}};T.extend(l.Services.Collaboration.ContentSharing.prototype,e)}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Services.Participant.call(this),this._participantId=e,this._displayName=t,this._presenter=!1}(e.prototype=Object.create(i.Services.Participant.prototype)).isPresenter=function(){return this._presenter},i.Services.Collaboration.Participant=e}(AvayaClientServices),function(t){"use strict";function e(e){this._collaboration=m,this._whiteboardService=e,this._activeSurface=m,this._currentLiveDrawingWhiteboardIds=[],this._currentLiveDrawingShapes=[],this._onWhiteboardStartedCallbacks=T.Callbacks(),this._onWhiteboardEndedCallbacks=T.Callbacks(),this._onWhiteboardSurfaceAddedCallbacks=T.Callbacks(),this._onWhiteboardSurfaceRemovedCallbacks=T.Callbacks(),this._onWhiteboardSurfaceSetActiveCallbacks=T.Callbacks(),this._recentlyActiveSurface=m,this._surfaces=new t.Base.DataSet,this._removeWhiteboardCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._drawingCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addWhiteboardCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE)}e.prototype={start:function(){return this._whiteboardService.start(this)},end:function(){return this._whiteboardService.end(this)},stop:function(){return this._whiteboardService.stop(this)},requestNewSurface:function(){return this._whiteboardService.requestNewSurface(this)},removeSurface:function(e){return this._whiteboardService.removeSurface(this,e)},getSurfaces:function(){return this._surfaces},getSurfaceById:function(t){return this._surfaces.filter(function(e){return e.getSurfaceId()===t})[0]},getActiveSurface:function(){return this._activeSurface},_setCollaboration:function(e){this._collaboration=e}},t.Base.AOPTools.addAdvices(e,"Whiteboard",["start","stop","end","requestNewSurface","removeSurface"],[t.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS,t.Base.AOPCommonAdvices.WRAP_CAUGHT_COLLABORATION_ERROR]),t.Services.Collaboration.Whiteboard=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Collaboration.Whiteboard.prototype,{addOnWhiteboardStartedCallback:function(e){this._onWhiteboardStartedCallbacks.add(e)},removeOnWhiteboardStartedCallback:function(e){this._onWhiteboardStartedCallbacks.remove(e)},addOnWhiteboardEndedCallback:function(e){this._onWhiteboardEndedCallbacks.add(e)},removeOnWhiteboardEndedCallback:function(e){this._onWhiteboardEndedCallbacks.remove(e)},addOnWhiteboardSurfaceAddedCallback:function(e){this._onWhiteboardSurfaceAddedCallbacks.add(e)},removeOnWhiteboardSurfaceAddedCallback:function(e){this._onWhiteboardSurfaceAddedCallbacks.remove(e)},addOnWhiteboardSurfaceRemovedCallback:function(e){this._onWhiteboardSurfaceRemovedCallbacks.add(e)},removeOnWhiteboardSurfaceRemovedCallback:function(e){this._onWhiteboardSurfaceRemovedCallbacks.remove(e)},addOnWhiteboardSurfaceSetActiveCallback:function(e){this._onWhiteboardSurfaceSetActiveCallbacks.add(e)},removeOnWhiteboardSurfaceSetActiveCallback:function(e){this._onWhiteboardSurfaceSetActiveCallbacks.remove(e)}})}(AvayaClientServices),function(s){"use strict";var e={getAddWhiteboardCapability:function(){return this._addWhiteboardCapability},_recalculateAddWhiteboardCapability:function(e){var t,i,a=!!e&&!!e._selfParticipant&&e._selfParticipant._presenter;i=this.getActiveSurface()&&a?(t=!0,s.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(t=!1,s.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addWhiteboardCapability._updateIfChanged(t,i)},getRemoveWhiteboardCapability:function(){return this._removeWhiteboardCapability},_recalculateRemoveWhiteboardCapability:function(e){var t,i,a=!!e&&!!e._selfParticipant&&e._selfParticipant._presenter;i=this.getActiveSurface()&&1<this._surfaces.length&&a?(t=!0,s.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(t=!1,s.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeWhiteboardCapability._updateIfChanged(t,i)},getDrawingCapability:function(){return this._drawingCapability},_recalculateDrawingCapability:function(e){var t,i,a=e._isAvailable,r=e._collaborationService.isFeatureSupported(e,s.Services.Collaboration.FeaturesAvailable.WHITEBOARD);i=a&&r&&e._isBrowserAllowed()?(t=!0,s.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(t=!1,s.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._drawingCapability._updateIfChanged(t,i)}};T.extend(s.Services.Collaboration.Whiteboard.prototype,e)}(AvayaClientServices),function(i){"use strict";function e(){this.possibleColors=["#cd2029","#f58521","#f3e913","#652d90","#3659a7","#2a8b45","#211e1e","#ffffff","#959595"],this._whiteboard=m,this._collaboration=m,this._ended=!1,this._callbacks={},this._onShowShapeAnnotationCallbacks=T.Callbacks()}e.prototype={init:function(e,r){(this._whiteboard=e).addOnWhiteboardStartedCallback(function(e,t){this._ended=!1,i.Base.Utils.isDefined(t)&&this.start(r)}.bind(this)),e.addOnWhiteboardEndedCallback(function(e){this._ended=!0,this.end(r)}.bind(this)),e.addOnWhiteboardSurfaceAddedCallback(function(e,t){var i=[{name:"OnShapeAddedCallback",callback:function(e,t){e.isActive()&&this.drawShape(t)}.bind(this)},{name:"OnShapeDeletedCallback",callback:function(e,t){this.removeShape(t)}.bind(this)},{name:"OnShapeUpdatedCallback",callback:function(e,t){this.updateShape(t)}.bind(this)},{name:"OnSurfaceClearedCallback",callback:function(e){this.clearContent()}.bind(this)}];i.forEach(function(e){t["add"+e.name](e.callback)}),this._callbacks[t.getSurfaceId()]=i}.bind(this)),e.addOnWhiteboardSurfaceRemovedCallback(function(e,t){this._callbacks[t.getSurfaceId()].forEach(function(e){t["remove"+e.name](e.callback)}),this._callbacks[t.getSurfaceId()]=m}.bind(this)),e.addOnWhiteboardSurfaceSetActiveCallback(function(e,t){if(this._ended&&this.start(r),this.clearContent(),t){var i=t.getShapes();for(var a in i)t.getShapes().hasOwnProperty(a)&&this.drawShape(t.getShapes()[a])}}.bind(this))},start:function(){},end:function(){},drawShape:function(e){},removeShape:function(e){},updateShape:function(e){},clearContent:function(){},addOnShowShapeAnnotationCallback:function(e){this._onShowShapeAnnotationCallbacks.add(e)},removeOnShowShapeAnnotationCallback:function(e){this._onShowShapeAnnotationCallbacks.remove(e)}},i.Base.AOPTools.addAdvices(e,"WhiteboardRenderer",["init"],[i.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS]),i.Services.Collaboration.WhiteboardRenderer=e}(AvayaClientServices),function(t){"use strict";function e(e,t){this._whiteboard=e,this._whiteboardService=t,this._shapes={},this._surfaceId=m,this._isDrawing=!1,this._active=!1,this._onShapeAddedCallbacks=T.Callbacks(),this._onShapeDeletedCallbacks=T.Callbacks(),this._onShapeUpdatedCallbacks=T.Callbacks(),this._onSurfaceClearedCallbacks=T.Callbacks()}e.prototype={getSurfaceId:function(){return this._surfaceId},setAsActive:function(){return this._whiteboardService.start(this._whiteboard,this)},addCircle:function(e){return this._appendShape(e._id,e),this._whiteboardService.addCircle(this,e)},addShape:function(e){return this._appendShape(e._id,e),e._onShapeFinished=function(){return this._whiteboardService.endDrawShape(this,e)}.bind(this),this._whiteboardService.addShape(this,e)},addText:function(e){return this._appendShape(e._id,e),this._whiteboardService.addText(this,e)},getShapes:function(){return this._shapes},isActive:function(){return this._active},clearContent:function(){return this._whiteboardService.clearContent(this)},updateShape:function(e){return this._whiteboardService.moveSelection(this,e)},removeShape:function(e){return this._whiteboardService.removeShape(this,e)},finishShape:function(e){return e.finishDrawing()},_appendShape:function(e,t){this._shapes[e]||(this._shapes[e]=t)},_getShapeById:function(e){if(t.Base.Utils.isDefined(this._shapes[e]))return this._shapes[e]},_removeShapeById:function(e){delete this._shapes[e]},_clearShapes:function(){this._shapes={}}},t.Base.AOPTools.addAdvices(e,"WhiteboardSurface",["finishShape","removeShape","updateShape","clearContent","addText","addShape","addCircle","setAsActive"],[t.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS,t.Base.AOPCommonAdvices.WRAP_CAUGHT_COLLABORATION_ERROR]),t.Services.Collaboration.WhiteboardSurface=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Collaboration.WhiteboardSurface.prototype,{addOnShapeAddedCallback:function(e){this._onShapeAddedCallbacks.add(e)},removeOnShapeAddedCallback:function(e){this._onShapeAddedCallbacks.remove(e)},addOnShapeUpdatedCallback:function(e){this._onShapeUpdatedCallbacks.add(e)},removeOnShapeUpdatedCallback:function(e){this._onShapeUpdatedCallbacks.remove(e)},addOnShapeDeletedCallback:function(e){this._onShapeDeletedCallbacks.add(e)},removeOnShapeDeletedCallback:function(e){this._onShapeDeletedCallbacks.remove(e)},addOnSurfaceClearedCallback:function(e){this._onSurfaceClearedCallbacks.add(e)},removeOnSurfaceClearedCallback:function(e){this._onSurfaceClearedCallbacks.remove(e)}})}(AvayaClientServices),function(i){"use strict";function e(e){this._chatService=e,this._selfParticipant=m,this._privateMessages=new i.Base.DataSet,this._publicMessages=new i.Base.DataSet,this._allMessages=new i.Base.DataSet,this._onChatMessageReceivedCallbacks=T.Callbacks(),this._onChatServiceAvailableCallbacks=T.Callbacks(),this._onChatServiceUnavailableCallbacks=T.Callbacks()}e.prototype={sendPrivateMessage:function(e,t){return i.Base.Utils.validate(t,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),i.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:i.Services.Conference.Participant}]}),this._chatService.sendMessage(this,t,e)},sendPublicMessage:function(e){return i.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this._chatService.sendMessage(this,e)},getAllPrivateMessages:function(){return this._privateMessages},getAllPublicMessages:function(){return this._publicMessages},getAllMessages:function(){return this._allMessages},_setSelfParticipant:function(e){i.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:i.Services.Conference.Participant}]}),this._selfParticipant=e},_addMessage:function(e){i.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:i.Services.Conference.ChatMessage}]}),this._chatService.addMessage(this,e)}},i.Base.AOPTools.addAdvices(e,"Chat",["sendPrivateMessage","sendPublicMessage"],[i.Base.AOPCommonAdvices.LOG_CONFERENCE_API_CALLS,i.Base.AOPCommonAdvices.WRAP_CAUGHT_CONFERENCE_ERROR]),i.Services.Conference.Chat=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Conference.Chat.prototype,{addOnChatMessageReceivedCallback:function(e){this._onChatMessageReceivedCallbacks.add(e)},removeOnChatMessageReceivedCallback:function(e){this._onChatMessageReceivedCallbacks.remove(e)},addOnChatServiceAvailableCallback:function(e){this._onChatServiceAvailableCallbacks.add(e)},removeOnChatServiceAvailableCallback:function(e){this._onChatServiceAvailableCallbacks.remove(e)},addOnChatServiceUnavailableCallback:function(e){this._onChatServiceUnavailableCallbacks.add(e)},removeOnChatServiceUnavailableCallback:function(e){this._onChatServiceUnavailableCallbacks.remove(e)}})}(AvayaClientServices),function(a){"use strict";function e(e,t,i){this._id=a.Base.Utils.generateUUID(),this._eventConference=!1,this._conferenceService=e,this._participantService=t,this._chat=i,this._selfParticipantId="",this._selfParticipant=m,this._activeTalkerId="",this._recentTalkersList=new a.Base.DataSet,this._dialoutPermissions=m,this._recordingPermissions=m,this._lockPermissions=m,this._unmuteSelfPermissions=m,this._unmuteAllPermissions=m,this._sendFeccPermissions=m,this._allowVideoDirection=m,this._lecturerId="",this._conferenceOwnerAddress="",this._presenterId="",this._mediaStatus="",this._activeParticipants=new a.Base.DataSet,this._droppedParticipants=[],this._pendingParticipants=[],this._isLectureModeActive=!1,this._isUccpConference=!1,this._isHandRaised=!1,this._recorderStatus=a.Services.Conference.RecorderStatus.NONE,this._recordingStatus=a.Services.Conference.RecordingStatus.OFF,this._isVideoAllowed=!1,this._encryptionStatus=a.Services.Conference.MeetingEncryptionStatus.NO,this._isWebCollaborationActive=!1,this._isLocked=!1,this._isPasscodeRequiredToBecomeModerator=!1,this._isVideoParticipantNameDisplayActive=!1,this._isVideoPersonalLayoutActive=m,this._isVideoSelfSeeActive=!1,this._currentVideoLayout=m,this._supportedVideoLayouts=[],this._isVideoSelfSeeChangeAllowed=!1,this._isVideoPinAllowed=!1,this._isVideoParticipantNameDisplayChangeAllowed=!1,this._isStreamingActive=!1,this._terminationTime=m,this._subject="",this._webURI="",this._sipURI="",this._isApplicationSharingActive=!1,this._brandName="",this._collaborationURI="",this._admissionPermissionNeeded=!1,this._admissionPasscodeNeeded=!1,this._streamingURI="",this._joinMeetingURI="",this._dialInInformation="",this._dialInInformationHtml="",this._isAvailable=m,this._collaboration=m,this._uccpConfig=m,this._isStarting=!1,this._isStarted=!1,this._preEnteredPasscode="",this._knockDoorTimeout=m,this._onEventConferenceStatusChangedCallbacks=T.Callbacks(),this._onConferenceLockStatusChangedCallbacks=T.Callbacks(),this._onConferenceDisplayVideoParticipantNameChangedCallbacks=T.Callbacks(),this._onConferenceVideoSelfSeeChangedCallbacks=T.Callbacks(),this._onConferenceVideoLayoutChangedCallbacks=T.Callbacks(),this._onConferenceDisplayParticipantNameOnVideoAllowedCallbacks=T.Callbacks(),this._onConferenceVideoSelfSeeAllowedCallbacks=T.Callbacks(),this._onConferenceVideoPinAllowedCallbacks=T.Callbacks(),this._onConferenceAvailableVideoLayoutsChangedCallbacks=T.Callbacks(),this._onConferenceSubjectChangedCallbacks=T.Callbacks(),this._onConferenceKnockDoorTimeoutChangedCallbacks=T.Callbacks(),this._onConferenceOwnerAddressChangedCallbacks=T.Callbacks(),this._onConferenceDialInInfoUpdatedCallbacks=T.Callbacks(),this._onConferenceJoinMeetingURIUpdatedCallbacks=T.Callbacks(),this._onConferenceStreamingURIUpdatedCallbacks=T.Callbacks(),this._onConferenceContinuationStatusChangedCallbacks=T.Callbacks(),this._onConferenceRecordingStatusChangedCallbacks=T.Callbacks(),this._onConferenceRecordingFailedCallbacks=T.Callbacks(),this._onConferenceVideoStatusChangedCallbacks=T.Callbacks(),this._onConferenceLectureModeStatusChangedCallbacks=T.Callbacks(),this._onConferenceEntryExitToneChangedCallbacks=T.Callbacks(),this._onConferencePresentationModeStatusChangedCallbacks=T.Callbacks(),this._onConferenceActiveTalkersChangedCallbacks=T.Callbacks(),this._onConferenceActiveVideoParticipantsChangedCallbacks=T.Callbacks(),this._onConferenceParticipantRoleChangedCallbacks=T.Callbacks(),this._onConferenceParticipantAudioMuteStatusChangedCallbacks=T.Callbacks(),this._onConferenceParticipantVideoBlockStatusChangedCallbacks=T.Callbacks(),this._onConferenceAllParticipantsMutedCallbacks=T.Callbacks(),this._onConferenceAllParticipantsUnmutedCallbacks=T.Callbacks(),this._onConferenceEncryptionStatusChangedCallbacks=T.Callbacks(),this._onConferenceStreamingStatusChangedCallbacks=T.Callbacks(),this._onConferenceParticipantRaiseHandStatusChangedCallbacks=T.Callbacks(),this._onConferencePendingParticipantCallbacks=T.Callbacks(),this._onConferencePendingParticipantRemovedCallbacks=T.Callbacks(),this._onConferenceDroppedParticipantAddedCallbacks=T.Callbacks(),this._onConferenceDroppedParticipantRemovedCallbacks=T.Callbacks(),this._onConferenceServiceAvailableCallbacks=T.Callbacks(),this._onConferenceServiceUnavailableCallbacks=T.Callbacks(),this._onConferenceParticipantsAddedCallbacks=T.Callbacks(),this._onConferenceParticipantsRemovedCallbacks=T.Callbacks(),this._onConferenceMeetingTerminationTimeChangedCallbacks=T.Callbacks(),this._onConferenceMeetingTerminationInProgressCallbacks=T.Callbacks(),this._onConferenceCollaborationURIChangedCallbacks=T.Callbacks(),this._onConferenceConnectionEndedCallbacks=T.Callbacks(),this._onConferenceStartingCallbacks=T.Callbacks(),this._onConferenceWaitingToStartCallbacks=T.Callbacks(),this._onConferenceAllowVideoDirectionChangedCallbacks=T.Callbacks(),this._setLectureModeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._muteUnmuteParticipantCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._blockUnblockParticipantVideoCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setLockCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeLastParticipantCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._denyPendingParticipantCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._acceptPendingParticipantCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._terminateConferenceCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._unmuteSelfAudioCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._muteSelfAudioCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._sendFeccCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._activeTalkerCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._supportMeetingMinutesCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._moderateConferenceCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._startRecordingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._stopRecordingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._pauseRecordingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._resumeRecordingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._muteUnmuteAllCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._raiseHandSupportCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._lowerHandSupportCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setDisplayVideoParticipantNameCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setVideoSelfSeeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setVideoLayoutCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setRequestToBecomeModeratorCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setVideoPinCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeSelectParticipantCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addParticipantViaDialoutCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._signInCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._extendMeetingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._retrieveParticipantListCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._inConferenceChatCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateChatService(this._inConferenceChatCapability),this._inConferenceChatCapability.addOnChangedCallback(this._updateChatService.bind(this)),this._addParticipantFromCallCapabilities={}}e.prototype={start:function(e){return a.Base.Utils.isDefined(e)&&(this._uccpConfig=e),this._conferenceService.start(this,this._uccpConfig)},stop:function(){return this._addParticipantFromCallCapabilities={},this._conferenceService.stop(this)},_stopImmediately:function(){return this._conferenceService.stopImmediately(this)},isEventConference:function(){return this._eventConference},getInConferenceChat:function(){return this._chat},getRecentTalkers:function(){return this._recentTalkersList},getMeetingMinutes:function(){},getCollaborationURI:function(){return this._collaborationURI},getConferenceOwnerAddress:function(){return this._conferenceOwnerAddress},isLocked:function(){return this._isLocked},setLocked:function(e){return this._conferenceService.setLocked(this,e)},isConferenceWaitingToStart:function(){return this._mediaStatus===a.Services.Conference.MediaStatus.WAITING_ROOM},isVideoSelfSeeActive:function(){return this._isVideoSelfSeeActive},setVideoSelfSee:function(e){return this._conferenceService.setVideoLayoutSelfSee(this,e)},isVideoParticipantNameDisplayActive:function(){return this._isVideoParticipantNameDisplayActive},setDisplayVideoParticipantName:function(e){return this._conferenceService.setVideoLayoutTextOverlay(this,e)},_setPreEnteredPasscode:function(e){this._preEnteredPasscode=e},getSupportedVideoLayoutList:function(){return this._supportedVideoLayouts},isLectureModeActive:function(){return this._isLectureModeActive},startRecording:function(e,t){return this._conferenceService.startRecording(this,e,t)},stopRecording:function(){return this._conferenceService.stopRecording(this)},pauseRecording:function(){return this._conferenceService.pauseRecording(this)},resumeRecording:function(){return this._conferenceService.resumeRecording(this)},isVideoAllowed:function(){return this._isVideoAllowed},getCurrentVideoLayout:function(){return this._currentVideoLayout},setVideoLayout:function(e){for(var t in a.Services.Conference.VideoLayout)if(a.Services.Conference.VideoLayout.hasOwnProperty(t)&&e===a.Services.Conference.VideoLayout[t])return this._conferenceService.setVideoLayout(this,e);return T.Deferred().reject(new a.Services.Conference.ConferenceException(a.Services.Conference.ConferenceError.INVALID_ARGUMENT))},getActiveParticipants:function(){return this._activeParticipants},getDroppedParticipants:function(){return this._droppedParticipants},getPendingParticipants:function(){return this._pendingParticipants},muteAllParticipants:function(){return this._conferenceService.muteAllParticipants(this)},unmuteAllParticipants:function(){return this._conferenceService.unmuteAllParticipants(this)},addParticipant:function(e){return this._conferenceService.addParticipant(this,a.Base.Utils.normalizeAddress(e))},addParticipantFromCall:function(e){return this.getAddParticipantFromCallCapability(e).isAllowed?this._conferenceService.addParticipantFromCall(e):T.Deferred().reject(new a.Services.Call.CallException(a.Services.Call.CallError.CAPABILITY_NOT_ALLOWED))},removeParticipant:function(e){return e.getParticipantConnectionStatus()===a.Services.Conference.ParticipantConnectionStatus.CONNECTION_STATUS_CONNECTING?this._conferenceService.cancelDialoutParticipant(this,e):e.isActiveParticipant()?this._conferenceService.disconnectParticipant(e):T.Deferred().reject(new a.Services.Conference.ConferenceException(a.Services.Conference.ConferenceError.INVALID_ARGUMENT,"Invalid participant state for this method"))},removeLastParticipant:function(){return this._conferenceService.removeLastParticipant()},terminateConference:function(){return this._conferenceService.terminateConference(this)},sendPasscode:function(e){return this._conferenceService.sendAdmissionRequest(this,e)},sendRequestToEnterLockedConference:function(){return this._conferenceService.sendAdmissionRequest(this)},isPasscodeRequiredToBecomeModerator:function(){return this._isPasscodeRequiredToBecomeModerator},requestToBecomeModerator:function(e){return this._conferenceService.requestToBecomeModerator(this,e)},signIn:function(e){return this._conferenceService.signIn(this,e)},pinVideoByParticipant:function(e,t,i){return this._conferenceService.videoPin(e,0,0,t,i)},pinVideoByCoordinates:function(e,t,i,a){return this._conferenceService.videoPin(void 0,e,t,i,a)},extendMeeting:function(e){return this._conferenceService.extendMeeting(e)},raiseHand:function(){return this.getSupportRaiseHandCapability().isAllowed?this._conferenceService.raiseLowerHand(!0):T.Deferred().reject(new a.Services.Conference.ConferenceException(a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"an attepmt to raise hand was failed"))},lowerHand:function(){return this.getSupportLowerHandCapability().isAllowed?this._conferenceService.raiseLowerHand(!1):T.Deferred().reject(new a.Services.Conference.ConferenceException(a.Services.Conference.ConferenceError.CAPABILITY_NOT_ALLOWED,"an attepmt to lower hand was failed"))},_recalculateAllCapabilities:function(){this._conferenceService?this._conferenceService._recalculateAllCapabilities?this._conferenceService._recalculateAllCapabilities(this):a.Base.Logger.error(a.Base.LoggerTags.CONFERENCE_SERVICE,"conferenceService has no method _recalculateAllCapabilities"):a.Base.Logger.error(a.Base.LoggerTags.CONFERENCE_SERVICE,"conference service not initialized")},_recalculate:function(){this._conferenceService._recalculateAllCapabilities(this),this._activeParticipants.forEach(function(e){e._recalculateAllCapabilities()})},getSelfParticipant:function(){return this._selfParticipant},isRecordingActive:function(){return this._recordingStatus===a.Services.Conference.RecordingStatus.ON||this._recordingStatus===a.Services.Conference.RecordingStatus.PAUSE},isRecordingPaused:function(){return this._recordingStatus===a.Services.Conference.RecordingStatus.PAUSE},getEncryptionStatus:function(){return this._encryptionStatus},getSubject:function(){return this._subject},getMeetingEndTime:function(){return this._terminationTime},isStreamingActive:function(){return this._isStreamingActive},isApplicationSharingActive:function(){return this._isApplicationSharingActive},getStreamingURI:function(){return this._streamingURI},getJoinMeetingURI:function(){return this._joinMeetingURI},getDialInInformation:function(){return this._dialInInformation},getDialInInformationHtml:function(){return this._dialInInformationHtml},toString:function(){return this._id},_getPreEnteredPasscode:function(){return this._preEnteredPasscode},_disconnect:function(){return this._conferenceService.sendDisconnectEvent()},_getType:function(){return this._conferenceService.getType()},_sendLocalMuteEvent:function(e,t){return this._conferenceService.sendLocalMuteEvent(e,t)},_setConfiguration:function(e){this._uccpConfig=e},_setCollaboration:function(e){this._collaboration=e},_setConferenceStarted:function(e){this._isStarted=e,this._isStarted&&(this._isStarting=!1),a.Base.Logger.debug(a.Base.LoggerTags.CONFERENCE_SERVICE,"_setConferenceStarted: "+e)},_isConferenceStarted:function(){return this._isStarted},_updateChatService:function(e){this._chat&&this._chat._chatService&&this._chat._chatService._setEnableSendingMessages(e.isAllowed)},getKnockDoorTimeout:function(){return this._knockDoorTimeout}},a.Base.AOPTools.addAdvices(e,"Conference",["start","stop","setLocked","setVideoSelfSee","setDisplayVideoParticipantName","startRecording","stopRecording","pauseRecording","resumeRecording","setVideoLayout","muteAllParticipants","unmuteAllParticipants","addParticipant","addParticipantFromCall","removeParticipant","removeLastParticipant","terminateConference","sendPasscode","sendRequestToEnterLockedConference","requestToBecomeModerator","signIn","pinVideoByParticipant","pinVideoByCoordinates","extendMeeting","raiseHand","lowerHand","_setConferenceStarted"],[a.Base.AOPCommonAdvices.LOG_CONFERENCE_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_CONFERENCE_ERROR]),a.Services.Conference.Conference=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Conference.Conference.prototype,{addOnEventConferenceStatusChangedCallback:function(e){this._onEventConferenceStatusChangedCallbacks.add(e)},removeOnEventConferenceStatusChangedCallback:function(e){this._onEventConferenceStatusChangedCallbacks.remove(e)},addOnConferenceLockStatusChangedCallback:function(e){this._onConferenceLockStatusChangedCallbacks.add(e)},removeOnConferenceLockStatusChangedCallback:function(e){this._onConferenceLockStatusChangedCallbacks.remove(e)},addOnConferenceDisplayVideoParticipantNameChangedCallback:function(e){this._onConferenceDisplayVideoParticipantNameChangedCallbacks.add(e)},removeOnConferenceDisplayVideoParticipantNameChangedCallback:function(e){this._onConferenceDisplayVideoParticipantNameChangedCallbacks.remove(e)},addOnConferenceVideoSelfSeeChangedCallback:function(e){this._onConferenceVideoSelfSeeChangedCallbacks.add(e)},removeOnConferenceVideoSelfSeeChangedCallback:function(e){this._onConferenceVideoSelfSeeChangedCallbacks.remove(e)},addOnConferenceVideoLayoutChangedCallback:function(e){this._onConferenceVideoLayoutChangedCallbacks.add(e)},removeOnConferenceVideoLayoutChangedCallback:function(e){this._onConferenceVideoLayoutChangedCallbacks.remove(e)},addOnConferenceDisplayParticipantNameOnVideoAllowedCallback:function(e){this._onConferenceDisplayParticipantNameOnVideoAllowedCallbacks.add(e)},removeOnConferenceDisplayParticipantNameOnVideoAllowedCallback:function(e){this._onConferenceDisplayParticipantNameOnVideoAllowedCallbacks.remove(e)},addOnConferenceVideoSelfSeeAllowedCallback:function(e){this._onConferenceVideoSelfSeeAllowedCallbacks.add(e)},removeOnConferenceVideoSelfSeeAllowedCallback:function(e){this._onConferenceVideoSelfSeeAllowedCallbacks.remove(e)},addOnConferenceVideoPinAllowedCallback:function(e){this._onConferenceVideoPinAllowedCallbacks.add(e)},removeOnConferenceVideoPinAllowedCallback:function(e){this._onConferenceVideoPinAllowedCallbacks.remove(e)},addOnConferenceAvailableVideoLayoutsChangedCallback:function(e){this._onConferenceAvailableVideoLayoutsChangedCallbacks.add(e)},removeOnConferenceAvailableVideoLayoutsChangedCallback:function(e){this._onConferenceAvailableVideoLayoutsChangedCallbacks.remove(e)},addOnConferenceContinuationStatusChangedCallback:function(e){this._onConferenceContinuationStatusChangedCallbacks.add(e)},removeOnConferenceContinuationStatusChangedCallback:function(e){this._onConferenceContinuationStatusChangedCallbacks.remove(e)},addOnConferenceRecordingStatusChangedCallback:function(e){this._onConferenceRecordingStatusChangedCallbacks.add(e)},removeOnConferenceRecordingStatusChangedCallback:function(e){this._onConferenceRecordingStatusChangedCallbacks.remove(e)},addOnConferenceRecordingFailedCallbacks:function(e){this._onConferenceRecordingFailedCallbacks.add(e)},removeOnConferenceRecordingFailedCallbacks:function(e){this._onConferenceRecordingFailedCallbacks.remove(e)},addOnConferenceVideoStatusChangedCallback:function(e){this._onConferenceVideoStatusChangedCallbacks.add(e)},removeOnConferenceVideoStatusChangedCallback:function(e){this._onConferenceVideoStatusChangedCallbacks.remove(e)},addOnConferenceLectureModeStatusChangedCallback:function(e){this._onConferenceLectureModeStatusChangedCallbacks.add(e)},removeOnConferenceLectureModeStatusChangedCallback:function(e){this._onConferenceLectureModeStatusChangedCallbacks.remove(e)},addOnConferenceStreamingStatusChangedCallback:function(e){this._onConferenceStreamingStatusChangedCallbacks.add(e)},removeOnConferenceStreamingStatusChangedCallback:function(e){this._onConferenceStreamingStatusChangedCallbacks.remove(e)},addOnConferenceEncryptionStatusChangedCallback:function(e){this._onConferenceEncryptionStatusChangedCallbacks.add(e)},removeOnConferenceEncryptionStatusChangedCallback:function(e){this._onConferenceEncryptionStatusChangedCallbacks.remove(e)},addOnConferenceMeetingTerminationTimeChangedCallback:function(e){this._onConferenceMeetingTerminationTimeChangedCallbacks.add(e)},removeOnConferenceMeetingTerminationTimeChangedCallback:function(e){this._onConferenceMeetingTerminationTimeChangedCallbacks.remove(e)},addOnConferenceMeetingTerminationInProgressCallbacks:function(e){this._onConferenceMeetingTerminationInProgressCallbacks.add(e)},removeOnConferenceMeetingTerminationInProgressCallbacks:function(e){this._onConferenceMeetingTerminationInProgressCallbacks.remove(e)},addOnConferenceEntryExitToneChangedCallback:function(e){this._onConferenceEntryExitToneChangedCallbacks.add(e)},removeOnConferenceEntryExitToneChangedCallback:function(e){this._onConferenceEntryExitToneChangedCallbacks.remove(e)},addOnConferencePresentationModeStatusChangedCallback:function(e){this._onConferencePresentationModeStatusChangedCallbacks.add(e)},removeOnConferencePresentationModeStatusChangedCallback:function(e){this._onConferencePresentationModeStatusChangedCallbacks.remove(e)},addOnConferenceActiveTalkersChangedCallback:function(e){this._onConferenceActiveTalkersChangedCallbacks.add(e)},removeOnConferenceActiveTalkersChangedCallback:function(e){this._onConferenceActiveTalkersChangedCallbacks.remove(e)},addOnConferenceActiveVideoParticipantsChangedCallback:function(e){this._onConferenceActiveVideoParticipantsChangedCallbacks.add(e)},removeOnConferenceActiveVideoParticipantsChangedCallback:function(e){this._onConferenceActiveVideoParticipantsChangedCallbacks.remove(e)},addOnConferenceAllParticipantsMutedCallback:function(e){this._onConferenceAllParticipantsMutedCallbacks.add(e)},removeOnConferenceAllParticipantsMutedCallback:function(e){this._onConferenceAllParticipantsMutedCallbacks.remove(e)},addOnConferenceAllParticipantsUnmutedCallback:function(e){this._onConferenceAllParticipantsUnmutedCallbacks.add(e)},removeOnConferenceAllParticipantsUnmutedCallback:function(e){this._onConferenceAllParticipantsUnmutedCallbacks.remove(e)},addOnConferencePendingParticipantCallback:function(e){this._onConferencePendingParticipantCallbacks.add(e)},removeOnConferencePendingParticipantCallback:function(e){this._onConferencePendingParticipantCallbacks.remove(e)},addOnConferencePendingParticipantRemovedCallback:function(e){this._onConferencePendingParticipantRemovedCallbacks.add(e)},removeOnConferencePendingParticipantRemovedCallback:function(e){this._onConferencePendingParticipantRemovedCallbacks.remove(e)},addOnConferenceDroppedParticipantAddedCallback:function(e){this._onConferenceDroppedParticipantAddedCallbacks.add(e)},removeOnConferenceDroppedParticipantAddedCallback:function(e){this._onConferenceDroppedParticipantAddedCallbacks.remove(e)},addOnConferenceDroppedParticipantRemovedCallback:function(e){this._onConferenceDroppedParticipantRemovedCallbacks.add(e)},removeOnConferenceDroppedParticipantRemovedCallback:function(e){this._onConferenceDroppedParticipantRemovedCallbacks.remove(e)},addOnConferenceServiceAvailableCallback:function(e){this._onConferenceServiceAvailableCallbacks.add(e)},removeOnConferenceServiceAvailableCallback:function(e){this._onConferenceServiceAvailableCallbacks.remove(e)},addOnConferenceServiceUnavailableCallback:function(e){this._onConferenceServiceUnavailableCallbacks.add(e)},removeOnConferenceServiceUnavailableCallback:function(e){this._onConferenceServiceUnavailableCallbacks.remove(e)},addOnConferenceParticipantsAddedCallback:function(e){this._onConferenceParticipantsAddedCallbacks.add(e)},removeOnConferenceParticipantsAddedCallback:function(e){this._onConferenceParticipantsAddedCallbacks.remove(e)},addOnConferenceParticipantsRemovedCallback:function(e){this._onConferenceParticipantsRemovedCallbacks.add(e)},removeOnConferenceParticipantsRemovedCallback:function(e){this._onConferenceParticipantsRemovedCallbacks.remove(e)},addOnConferenceSubjectCallback:function(e){this._onConferenceSubjectChangedCallbacks.add(e)},removeOnConferenceSubjectCallback:function(e){this._onConferenceSubjectChangedCallbacks.remove(e)},addOnConferenceKnockDoorTimeoutChangedCallback:function(e){this._onConferenceKnockDoorTimeoutChangedCallbacks.add(e)},removeOnConferenceKnockDoorTimeoutChangedCallback:function(e){this._onConferenceKnockDoorTimeoutChangedCallbacks.remove(e)},addOnConferenceOwnerAddressChangedCallback:function(e){this._onConferenceOwnerAddressChangedCallbacks.add(e)},removeOnConferenceOwnerAddressChangedCallback:function(e){this._onConferenceOwnerAddressChangedCallbacks.remove(e)},addOnConferenceCollaborationURIChangedCallback:function(e){this._onConferenceCollaborationURIChangedCallbacks.add(e)},removeOnConferenceCollaborationURIChangedCallback:function(e){this._onConferenceCollaborationURIChangedCallbacks.remove(e)},addOnConferenceStartingCallback:function(e){this._onConferenceStartingCallbacks.add(e)},removeOnConferenceStartingCallback:function(e){this._onConferenceStartingCallbacks.remove(e)},addOnConferenceWaitingToStartCallback:function(e){this._onConferenceWaitingToStartCallbacks.add(e)},removeOnConferenceWaitingToStartCallback:function(e){this._onConferenceWaitingToStartCallbacks.remove(e)},addOnConferenceConnectionEndedCallbacks:function(e){this._onConferenceConnectionEndedCallbacks.add(e)},removeOnConferenceConnectionEndedCallbacks:function(e){this._onConferenceConnectionEndedCallbacks.remove(e)},_addOnConferenceAllowVideoDirectionChangedCallback:function(e){this._onConferenceAllowVideoDirectionChangedCallbacks.add(e)},_removeOnConferenceAllowVideoDirectionChangedCallback:function(e){this._onConferenceAllowVideoDirectionChangedCallbacks.remove(e)},addOnConferenceStreamingURIUpdatedCallback:function(e){this._onConferenceStreamingURIUpdatedCallbacks.add(e)},removeOnConferenceStreamingURIUpdatedCallback:function(e){this._onConferenceStreamingURIUpdatedCallbacks.remove(e)},addOnConferenceJoinMeetingURIUpdatedCallback:function(e){this._onConferenceJoinMeetingURIUpdatedCallbacks.add(e)},removeOnConferenceJoinMeetingURIUpdatedCallback:function(e){this._onConferenceJoinMeetingURIUpdatedCallbacks.remove(e)},addOnConferenceDialInInfoUpdatedCallback:function(e){this._onConferenceDialInInfoUpdatedCallbacks.add(e)},removeOnConferenceDialInInfoUpdatedCallback:function(e){this._onConferenceDialInInfoUpdatedCallbacks.remove(e)}})}(AvayaClientServices),function(r){"use strict";var e={getInConferenceChatCapability:function(){return this._inConferenceChatCapability},_recalculateInConferenceChatCapability:function(){var e=!0;if(this._inConferenceChatCapability&&this._inConferenceChatCapability instanceof r.Base.Capability){var t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;(this._isInWaitingRoomState()||this._isCmConference())&&(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED),this._inConferenceChatCapability._updateIfChanged(e,t)}else r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_inConferenceChatCapability property is not defined")},_isInWaitingRoomState:function(){return this._mediaStatus===r.Services.Conference.MediaStatus.WAITING_ROOM},_isCmConference:function(){return this._conferenceProvider!==m&&this._conferenceProvider._conferenceType!==m&&this._conferenceProvider._conferenceType===r.Services.Conference.ConferenceType.CM},getSupportMeetingMinutesCapability:function(){return this._supportMeetingMinutesCapability},getModerateConferenceCapability:function(){return this._moderateConferenceCapability},_recalculateModerateConferenceCapability:function(){var e,t;this._moderateConferenceCapability&&this._moderateConferenceCapability instanceof r.Base.Capability?(t=this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant.isModerator()?(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._moderateConferenceCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_moderateConferenceCapability property is not defined")},getActiveTalkerCapability:function(){return this._activeTalkerCapability},_recalculateActiveTalkerCapability:function(){var e,t;this._activeTalkerCapability&&this._activeTalkerCapability instanceof r.Base.Capability?(t=this._isUccpConference?(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._activeTalkerCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_activeTalkerCapability property is not defined")},getMuteSelfAudioCapability:function(){return this._muteSelfAudioCapability},_recalculateMuteSelfAudioCapability:function(){var e,t;this._muteSelfAudioCapability&&this._muteSelfAudioCapability instanceof r.Base.Capability?(this._isUccpConference&&r.Base.Utils.isDefined(this._selfParticipant)&&r.Base.Utils.isDefined(this._unmuteSelfPermissions)?this._unmuteSelfPermissions===r.Services.Conference.PermissionStatus.ALLOWED?(e=!0,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):this._unmuteSelfPermissions===r.Services.Conference.PermissionStatus.NOT_ALLOWED?(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):this._unmuteSelfPermissions===r.Services.Conference.PermissionStatus.NEED_MODERATOR?(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NEED_MODERATOR):this._unmuteSelfPermissions===r.Services.Conference.PermissionStatus.NEED_SIGNIN&&(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN):(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._muteSelfAudioCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_muteSelfAudioCapability property is not defined")},getUnmuteSelfAudioCapability:function(){return this._unmuteSelfAudioCapability},_recalculateUnmuteSelfAudioCapability:function(){var e,t;this._unmuteSelfAudioCapability&&this._unmuteSelfAudioCapability instanceof r.Base.Capability?(this._isUccpConference&&r.Base.Utils.isDefined(this._selfParticipant)&&r.Base.Utils.isDefined(this._unmuteSelfPermissions)?this._unmuteSelfPermissions===r.Services.Conference.PermissionStatus.ALLOWED?(e=!0,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):this._unmuteSelfPermissions===r.Services.Conference.PermissionStatus.NOT_ALLOWED?(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):this._unmuteSelfPermissions===r.Services.Conference.PermissionStatus.NEED_MODERATOR?(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NEED_MODERATOR):this._unmuteSelfPermissions===r.Services.Conference.PermissionStatus.NEED_SIGNIN&&(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN):(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._unmuteSelfAudioCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_unmuteSelfAudioCapability property is not defined")},getSendFeccCapability:function(){return this._sendFeccCapability},_recalculateSendFeccCapability:function(){var e,t;this._sendFeccCapability&&this._sendFeccCapability instanceof r.Base.Capability?(this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&r.Base.Utils.isDefined(this._sendFeccPermissions)?this._sendFeccPermissions===r.Services.Conference.PermissionStatus.ALLOWED?(e=!0,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):this._sendFeccPermissions===r.Services.Conference.PermissionStatus.NOT_ALLOWED?(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):this._sendFeccPermissions===r.Services.Conference.PermissionStatus.NEED_MODERATOR?(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NEED_MODERATOR):this._sendFeccPermissions===r.Services.Conference.PermissionStatus.NEED_SIGNIN&&(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN):(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._sendFeccCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_sendFeccCapability property is not defined")},getTerminateConferenceCapability:function(){return this._terminateConferenceCapability},_recalculateTerminateConferenceCapability:function(){var e,t;this._terminateConferenceCapability&&this._terminateConferenceCapability instanceof r.Base.Capability?(t=this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant.isModerator()?(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._terminateConferenceCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_terminateConferenceCapability property is not defined")},getUpdateLockStatusCapability:function(){return this._setLockCapability},_recalculateSetLockCapability:function(){var e,t;this._setLockCapability&&this._setLockCapability instanceof r.Base.Capability?(this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&r.Base.Utils.isDefined(this._lockPermissions)?this._lockPermissions===r.Services.Conference.PermissionStatus.ALLOWED?(e=!0,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):this._lockPermissions===r.Services.Conference.PermissionStatus.NOT_ALLOWED?(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):this._lockPermissions===r.Services.Conference.PermissionStatus.NEED_MODERATOR?(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NEED_MODERATOR):this._lockPermissions===r.Services.Conference.PermissionStatus.NEED_SIGNIN&&(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN):(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setLockCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_setLockCapability property is not defined")},getStartRecordingCapability:function(){return this._startRecordingCapability},getStopRecordingCapability:function(){return this._stopRecordingCapability},getPauseRecordingCapability:function(){return this._pauseRecordingCapability},getResumeRecordingCapability:function(){return this._resumeRecordingCapability},_recalculateStartStopRecordingCapability:function(){var e,t,i;this._startRecordingCapability&&this._startRecordingCapability instanceof r.Base.Capability?this._stopRecordingCapability&&this._stopRecordingCapability instanceof r.Base.Capability?(this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&r.Base.Utils.isDefined(this._recorderStatus)&&r.Base.Utils.isDefined(this._recordingPermissions)?this._recordingPermissions===r.Services.Conference.PermissionStatus.NOT_ALLOWED||this._recorderStatus===r.Services.Conference.RecorderStatus.NONE?(t=e=!1,i=r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):this._recordingPermissions===r.Services.Conference.PermissionStatus.NEED_MODERATOR?(t=e=!1,i=r.Base.CapabilityDenialReason.CAPABILITY_NEED_MODERATOR):this._recordingPermissions===r.Services.Conference.PermissionStatus.NEED_SIGNIN?(t=e=!1,i=r.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN):this._recordingPermissions===r.Services.Conference.PermissionStatus.NEED_SIGNIN_OR_MODERATOR?(t=e=!1,i=r.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN_OR_MODERATOR):(i=r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,t=this.isRecordingActive()?!(e=!1):!(e=!0)):(t=e=!1,i=r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._startRecordingCapability._updateIfChanged(e,i),this._stopRecordingCapability._updateIfChanged(t,i)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_stopRecordingCapability property is not defined"):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_startRecordingCapability property is not defined")},_recalculatePauseResumeRecordingCapability:function(){var e,t,i;this._pauseRecordingCapability&&this._pauseRecordingCapability instanceof r.Base.Capability?this._resumeRecordingCapability&&this._resumeRecordingCapability instanceof r.Base.Capability?(this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&r.Base.Utils.isDefined(this._recorderStatus)&&r.Base.Utils.isDefined(this._recordingPermissions)?this._recordingPermissions===r.Services.Conference.PermissionStatus.NOT_ALLOWED||this._recorderStatus!==r.Services.Conference.RecorderStatus.WITH_PAUSE?(t=e=!1,i=r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):this._recordingPermissions===r.Services.Conference.PermissionStatus.NEED_MODERATOR?(t=e=!1,i=r.Base.CapabilityDenialReason.CAPABILITY_NEED_MODERATOR):this._recordingPermissions===r.Services.Conference.PermissionStatus.NEED_SIGNIN?(t=e=!1,i=r.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN):this._recordingPermissions===r.Services.Conference.PermissionStatus.NEED_SIGNIN_OR_MODERATOR?(t=e=!1,i=r.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN_OR_MODERATOR):(i=r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,t=this.isRecordingActive()?this.isRecordingPaused()?!(e=!1):!(e=!0):e=!1):(t=e=!1,i=r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._pauseRecordingCapability._updateIfChanged(e,i),this._resumeRecordingCapability._updateIfChanged(t,i)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_resumeRecordingCapability property is not defined"):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_pauseRecordingCapability property is not defined")},getSupportRaiseHandCapability:function(){return this._raiseHandSupportCapability},_recalculateRaiseHandSupportCapability:function(){var e,t;this._raiseHandSupportCapability&&this._raiseHandSupportCapability instanceof r.Base.Capability?(t=this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant._audioFromParticipant!==r.Services.Conference.MediaFromParticipantStatus.NA?(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._raiseHandSupportCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_raiseHandSupportCapability property is not defined")},getSupportLowerHandCapability:function(){return this._lowerHandSupportCapability},_recalculateLowerHandSupportCapability:function(){var e,t;this._lowerHandSupportCapability&&this._lowerHandSupportCapability instanceof r.Base.Capability?(t=this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant._audioFromParticipant!==r.Services.Conference.MediaFromParticipantStatus.NA?(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._lowerHandSupportCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_lowerHandSupportCapability property is not defined")},getRetrieveParticipantListCapability:function(){return this._retrieveParticipantListCapability},_recalculateRetrieveParticipantListCapability:function(){var e,t;this._retrieveParticipantListCapability&&this._retrieveParticipantListCapability instanceof r.Base.Capability?(t=this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)?(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._retrieveParticipantListCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_retrieveParticipantListCapability property is not defined")},getMuteAllParticipantsCapability:function(){return this._muteUnmuteAllCapability},getUnmuteAllParticipantsCapability:function(){return this._muteUnmuteAllCapability},_recalculateMuteUnmuteAllCapability:function(){var e,t;this._muteUnmuteAllCapability&&this._muteUnmuteAllCapability instanceof r.Base.Capability?(this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&r.Base.Utils.isDefined(this._unmuteAllPermissions)?this._unmuteAllPermissions===r.Services.Conference.PermissionStatus.ALLOWED?(e=!0,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):this._unmuteAllPermissions===r.Services.Conference.PermissionStatus.NOT_ALLOWED?(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):this._unmuteAllPermissions===r.Services.Conference.PermissionStatus.NEED_MODERATOR?(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NEED_MODERATOR):this._unmuteAllPermissions===r.Services.Conference.PermissionStatus.NEED_SIGNIN&&(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN):(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._muteUnmuteAllCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_muteUnmuteAllCapability property is not defined")},getChangeParticipantRoleCapability:function(){},getUpdateDisplayVideoParticipantNameCapability:function(){return this._setDisplayVideoParticipantNameCapability},_recalculateDisplayVideoParticipantNameCapability:function(){var e,t;this._setDisplayVideoParticipantNameCapability&&this._setDisplayVideoParticipantNameCapability instanceof r.Base.Capability?(t=this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&r.Base.Utils.isDefined(this._isVideoParticipantNameDisplayChangeAllowed)?this._isVideoParticipantNameDisplayChangeAllowed?(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setDisplayVideoParticipantNameCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_setDisplayVideoParticipantNameCapability property is not defined")},getUpdateVideoSelfSeeCapability:function(){return this._setVideoSelfSeeCapability},_recalculateVideoSelfSeeCapability:function(){var e,t;this._setVideoSelfSeeCapability&&this._setVideoSelfSeeCapability instanceof r.Base.Capability?(t=this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&r.Base.Utils.isDefined(this._isVideoSelfSeeChangeAllowed)?this._isVideoSelfSeeChangeAllowed?(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setVideoSelfSeeCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_setVideoSelfSeeCapability property is not defined")},getUpdateVideoLayoutCapability:function(){return this._setVideoLayoutCapability},_recalculateSetVideoLayoutCapability:function(){var e,t;if(this._setVideoLayoutCapability&&this._setVideoLayoutCapability instanceof r.Base.Capability){var i=void 0===this._isVideoPersonalLayoutActive||this._isVideoPersonalLayoutActive;if(this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&r.Base.Utils.isDefined(this._currentVideoLayout)&&r.Base.Utils.isDefined(this._supportedVideoLayouts)&&i){e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED;for(var a=0;a<this._supportedVideoLayouts.length;++a)if(this._supportedVideoLayouts[a].geometry===this._currentVideoLayout){e=!0,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED;break}}else t=i?(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED);this._setVideoLayoutCapability._updateIfChanged(e,t)}else r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_setVideoLayoutCapability property is not defined")},getRequestToBecomeModeratorCapability:function(){return this._setRequestToBecomeModeratorCapability},_recalculateRequestToBecomeModeratorCapability:function(){var e,t;this._setRequestToBecomeModeratorCapability&&this._setRequestToBecomeModeratorCapability instanceof r.Base.Capability?(t=this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)?this.isEventConference()&&this._selfParticipant.isRestrictedParticipant()?(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED):this._selfParticipant.isModerator()?(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setRequestToBecomeModeratorCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_setRequestToBecomeModeratorCapability property is not defined")},getVideoPinCapability:function(){return this._setVideoPinCapability},_recalculateVideoPinCapability:function(){var e,t;this._setVideoPinCapability&&this._setVideoPinCapability instanceof r.Base.Capability?(t=this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&r.Base.Utils.isDefined(this._isVideoPinAllowed)?this._isVideoPinAllowed?(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setVideoPinCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_setVideoPinCapability property is not defined")},getAddParticipantViaDialoutCapability:function(){return this._addParticipantViaDialoutCapability},_recalculateAddParticipantViaDialoutCapability:function(){var e,t;this._addParticipantViaDialoutCapability&&this._addParticipantViaDialoutCapability instanceof r.Base.Capability?(this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&r.Base.Utils.isDefined(this._dialoutPermissions)?this._dialoutPermissions===r.Services.Conference.PermissionStatus.ALLOWED?(e=!0,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):this._dialoutPermissions===r.Services.Conference.PermissionStatus.NOT_ALLOWED?(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):this._dialoutPermissions===r.Services.Conference.PermissionStatus.NEED_MODERATOR?(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NEED_MODERATOR):this._dialoutPermissions===r.Services.Conference.PermissionStatus.NEED_SIGNIN&&(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_NEED_SIGNIN):(e=!1,t=r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addParticipantViaDialoutCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_addParticipantViaDialoutCapability property is not defined")},getRemoveSelectParticipantCapability:function(){return this._removeSelectParticipantCapability},_recalculateRemoveSelectParticipantCapability:function(){var e,t;this._removeSelectParticipantCapability&&this._removeSelectParticipantCapability instanceof r.Base.Capability?(t=this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant.isModerator()?(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeSelectParticipantCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_removeSelectParticipantCapability property is not defined")},getSignInCapability:function(){return this._signInCapability},_recalculateSignInCapability:function(){var e,t;this._signInCapability&&this._signInCapability instanceof r.Base.Capability?(t=this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)?(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._signInCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_signInCapability property is not defined")},getRemoveLastParticipantCapability:function(){return this._removeLastParticipantCapability},getAcceptPendingParticipantCapability:function(){return this._acceptPendingParticipantCapability},_recalculateAcceptPendingParticipantCapability:function(){var e,t;this._acceptPendingParticipantCapability&&this._acceptPendingParticipantCapability instanceof r.Base.Capability?(t=this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant.isModerator()?(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._acceptPendingParticipantCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_acceptPendingParticipantCapability property is not defined")},getDenyPendingParticipantCapability:function(){return this._denyPendingParticipantCapability},_recalculateDenyPendingParticipantCapability:function(){var e,t;this._denyPendingParticipantCapability&&this._denyPendingParticipantCapability instanceof r.Base.Capability?(t=this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant.isModerator()?(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._denyPendingParticipantCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_denyPendingParticipantCapability property is not defined")},getExtendMeetingCapability:function(){return this._extendMeetingCapability},_recalculateExtendMeetingCapability:function(){var e,t;this._extendMeetingCapability&&this._extendMeetingCapability instanceof r.Base.Capability?(t=this._isAvailable&&r.Base.Utils.isDefined(this._selfParticipant)&&this._selfParticipant.isModerator()?(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._extendMeetingCapability._updateIfChanged(e,t)):r.Base.Logger.error(r.Base.LoggerTags.CONFERENCE_SERVICE,"_extendMeetingCapability property is not defined")},getAddParticipantFromCallCapability:function(e){var t=e.getCallId();return this._addParticipantFromCallCapabilities.hasOwnProperty(t)||(e.addOnCallConferenceStatusChangedCallback(function(){this._recalculateAddParticipantFromCallCapability(e)}.bind(this)),this._addParticipantFromCallCapabilities[t]=new r.Base.Capability(r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._recalculateAddParticipantFromCallCapability(e)),this._addParticipantFromCallCapabilities[t]},_recalculateAddParticipantFromCallCapability:function(e){this._conferenceService._recalculateAddParticipantFromCallCapability(this,e)},_recalculateAllAddParticipantFromCallCapability:function(){for(var e in this._addParticipantFromCallCapabilities)this._addParticipantFromCallCapabilities.hasOwnProperty(e)&&this._conferenceService._recalculateAddParticipantFromCallCapabilityByCallId(this,e)}};T.extend(r.Services.Conference.Conference.prototype,e)}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Services.Participant.call(this),this._participantService=e,this._conference=t,this._onParticipantStatusChangedCallbacks=T.Callbacks(),this._setUnsetAsLecturerCapability=new i.Base.Capability(i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._muteAudioCapability=new i.Base.Capability(i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._unmuteAudioCapability=new i.Base.Capability(i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._blockVideoCapability=new i.Base.Capability(i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._unblockVideoCapability=new i.Base.Capability(i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._remoteCameraControlCapability=new i.Base.Capability(i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._lowerHandCapability=new i.Base.Capability(i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE)}(e.prototype=Object.create(i.Services.Participant.prototype)).getParticipantAuthorizationStatus=function(){return this._status},e.prototype.isPendingParticipant=function(){return this._status===i.Services.Conference.ParticipantAuthorizationStatus.AUTHORIZING},e.prototype.isActiveParticipant=function(){return this._status===i.Services.Conference.ParticipantAuthorizationStatus.ACTIVE},e.prototype._recalculateAllCapabilities=function(){this._participantService.recalculateAllCapabilities(this)},i.Services.Conference.Participant=e}(AvayaClientServices),function(h){"use strict";var e={getMuteParticipantAudioCapability:function(){return this._muteAudioCapability},getUnmuteParticipantAudioCapability:function(){return this._unmuteAudioCapability},_recalculateMuteUnmuteCapability:function(){var e=h.Services.Conference.MediaFromParticipantStatus,t=h.Base.CapabilityDenialReason,i=t.CAPABILITY_INVALID_STATE,a=t.CAPABILITY_CALL_HAS_NO_AUDIO,r=t.CAPABILITY_NOT_ALLOWED,s=t.CAPABILITY_NOT_DENIED,n=!1,o=!1,c=r,l=r,d=this._conference._selfParticipant&&this._conference._selfParticipant.isModerator(),C=this._conference.isLectureModeActive();if(this._conference._isAvailable)switch(this._audioFromParticipant){case e.NA:u(!1,a),v(!1,a);break;case e.ACTIVE:case e.SELF_MUTED:d&&u(!0,s);break;case e.MODERATOR_MUTED:case e.BOTH_MUTED:(d||this._isSelfParticipant&&!C)&&v(!0,s)}else u(!1,i),v(!1,i);function u(e,t){n=e,c=t}function v(e,t){o=e,l=t}this._muteAudioCapability._updateIfChanged(n,c),this._unmuteAudioCapability._updateIfChanged(o,l)},getBlockParticipantVideoCapability:function(){return this._blockVideoCapability},getUnblockParticipantVideoCapability:function(){return this._unblockVideoCapability},_recalculateBlockUnblockVideoCapability:function(){var e=h.Services.Conference.MediaFromParticipantStatus,t=h.Base.CapabilityDenialReason,i=t.CAPABILITY_INVALID_STATE,a=t.CAPABILITY_CALL_HAS_NO_VIDEO,r=t.CAPABILITY_NOT_ALLOWED,s=t.CAPABILITY_NOT_DENIED,n=!1,o=!1,c=r,l=r,d=this._conference._selfParticipant&&this._conference._selfParticipant.isModerator(),C=this._conference.isLectureModeActive();if(this._conference._isAvailable)switch(this._videoFromParticipant){case e.NA:u(!1,a),v(!1,a);break;case e.ACTIVE:d&&u(!0,s);break;case e.MODERATOR_MUTED:(d||this._isSelfParticipant&&!C)&&v(!0,s)}else u(!1,i),v(!1,i);function u(e,t){n=e,c=t}function v(e,t){o=e,l=t}this._blockVideoCapability._updateIfChanged(n,c),this._unblockVideoCapability._updateIfChanged(o,l)},getChangeRoleCapability:function(){},getAssignParticipantAsLecturerCapability:function(){return this._setUnsetAsLecturerCapability},_recalculateSetAsLecturerCapability:function(){var e,t;t=h.Base.Utils.isUndefined(this._canLecture)&&this._audioFromParticipant===h.Services.Conference.MediaFromParticipantStatus.NA?(e=!1,h.Base.CapabilityDenialReason.CAPABILITY_CALL_HAS_NO_AUDIO):!1===this._canLecture?(e=!1,h.Base.CapabilityDenialReason.CAPABILITY_NOT_ALLOWED):this._conference._isAvailable&&h.Base.Utils.isDefined(this._conference._selfParticipant)&&this._conference._selfParticipant.isModerator()?(e=!0,h.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,h.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._setUnsetAsLecturerCapability._updateIfChanged(e,t)},getLowerParticipantHandCapability:function(){return this._lowerHandCapability},_recalculateLowerHandCapability:function(){var e,t;t=this._conference._isAvailable&&h.Base.Utils.isDefined(this._conference._selfParticipant)&&this._conference._selfParticipant.isModerator()?(e=!0,h.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,h.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._lowerHandCapability._updateIfChanged(e,t)},getRemoteCameraControlCapability:function(){return this._remoteCameraControlCapability},_recalculateRemoteCameraControlCapability:function(){var e,t;t=this._conference._isAvailable&&h.Base.Utils.isDefined(this._conference._selfParticipant)&&this._conference._selfParticipant.isModerator()?(e=!0,h.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,h.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._remoteCameraControlCapability._updateIfChanged(e,t)}};T.extend(h.Services.Conference.Participant.prototype,e)}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Services.Conference.Participant.call(this,e,t),this._onPendingParticipantAcceptedCallbacks=T.Callbacks(),this._onPendingParticipantCancelledCallbacks=T.Callbacks(),this._onPendingParticipantDeniedCallbacks=T.Callbacks()}(e.prototype=Object.create(i.Services.Conference.Participant.prototype)).accept=function(){return this._participantService.accept(this)},e.prototype.deny=function(){return this._participantService.deny(this)},i.Base.AOPTools.addAdvices(e,"PendingParticipant",["accept","deny"],[i.Base.AOPCommonAdvices.LOG_CONFERENCE_API_CALLS,i.Base.AOPCommonAdvices.WRAP_CAUGHT_CONFERENCE_ERROR]),i.Services.Conference.PendingParticipant=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Conference.PendingParticipant.prototype,{addOnPendingParticipantAcceptedCallback:function(e){this._onPendingParticipantAcceptedCallbacks.add(e)},removeOnPendingParticipantAcceptedCallback:function(e){this._onPendingParticipantAcceptedCallbacks.remove(e)},addOnPendingParticipantCancelledCallback:function(e){this._onPendingParticipantCancelledCallbacks.add(e)},removeOnPendingParticipantCancelledCallback:function(e){this._onPendingParticipantCancelledCallbacks.remove(e)},addOnPendingParticipantDeniedCallback:function(e){this._onPendingParticipantDeniedCallbacks.add(e)},removeOnPendingParticipantDeniedCallback:function(e){this._onPendingParticipantDeniedCallbacks.remove(e)}})}(AvayaClientServices),function(s){"use strict";function e(){this._uniqueAddressForMatching=m,this._firstName=new s.Services.Contacts.ContactStringField,this._lastName=new s.Services.Contacts.ContactStringField,this._displayName=new s.Services.Contacts.ContactStringField,this._asciiFirstName=new s.Services.Contacts.ContactStringField,this._asciiLastName=new s.Services.Contacts.ContactStringField,this._asciiDisplayName=new s.Services.Contacts.ContactStringField,this._alias=new s.Services.Contacts.ContactStringField,this._company=new s.Services.Contacts.ContactStringField,this._location=new s.Services.Contacts.ContactStringField,this._workRoomNumber=new s.Services.Contacts.ContactStringField,this._streetAddress=new s.Services.Contacts.ContactStringField,this._city=new s.Services.Contacts.ContactStringField,this._state=new s.Services.Contacts.ContactStringField,this._country=new s.Services.Contacts.ContactStringField,this._postalCode=new s.Services.Contacts.ContactStringField,this._manager=new s.Services.Contacts.ContactStringField,this._department=new s.Services.Contacts.ContactStringField,this._language=new s.Services.Contacts.ContactStringField,this._emailAddresses=new s.Services.Contacts.ContactFieldList,this._phoneNumbers=new s.Services.Contacts.ContactFieldList,this._imAddresses=new s.Services.Contacts.ContactFieldList,this._buddy=new s.Services.Contacts.ContactBooleanField,this._favorite=new s.Services.Contacts.ContactBooleanField,this._videoCapable=new s.Services.Contacts.ContactBooleanField,this._rank=new s.Services.Contacts.ContactNumberField,this._notes=new s.Services.Contacts.ContactStringField,this._custom1=new s.Services.Contacts.ContactFieldList,this._custom2=new s.Services.Contacts.ContactFieldList,this._custom3=new s.Services.Contacts.ContactFieldList,this._terminal=new s.Services.Contacts.Terminal,this._scopiaUserId=new s.Services.Contacts.ContactStringField,this._scopiaLoginId=new s.Services.Contacts.ContactStringField,this._inContactList=!1,this._pictureUrlMap={},this._selfContact=!1,this._presenceService=m,this._contactsService=m,this._presence=m,this._presenceAddress=m,this._presenceAddressCandidates=m,this._onPresenceReceived=m,this._getPresenceCapability=new s.Base.Capability(s.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED),this._onPresenceChangedCallbacks=T.Callbacks(),this._onContactChangedCallbacks=T.Callbacks()}e.prototype={getUniqueAddressForMatching:function(){return this._uniqueAddressForMatching},_setUniqueAddressForMatching:function(e){this._uniqueAddressForMatching=e},getFirstName:function(){return this._firstName},getLastName:function(){return this._lastName},getDisplayName:function(){return this._displayName},getASCIIFirstName:function(){return this._asciiFirstName},getASCIILastName:function(){return this._asciiLastName},getASCIIDisplayName:function(){return this._asciiDisplayName},getAlias:function(){return this._alias},getLocation:function(){return this._location},getWorkRoomNumber:function(){return this._workRoomNumber},getStreetAddress:function(){return this._streetAddress},getCity:function(){return this._city},getState:function(){return this._state},getCountry:function(){return this._country},getPostalCode:function(){return this._postalCode},getCompany:function(){return this._company},getManager:function(){return this._manager},getDepartment:function(){return this._department},getPictureUrl:function(e){return e&&s.Services.Contacts.ContactPictureSize[e]||(e=s.Services.Contacts.ContactPictureSize.MEDIUM),this._pictureUrlMap[e]},addPictureUrl:function(e,t){e&&s.Services.Contacts.ContactPictureSize[e]&&t&&(this._pictureUrlMap[e]=t)},getLanguage:function(){return this._language},getEmailAddresses:function(){return this._emailAddresses},getPhoneNumbers:function(){return this._phoneNumbers},getIMAddresses:function(){return this._imAddresses},isBuddy:function(){return this._buddy},isFavorite:function(){return this._favorite},isVideoCapable:function(){return this._videoCapable},getNotes:function(){return this._notes},getRank:function(){return this._rank},getCustom1:function(){return this._custom1},getCustom2:function(){return this._custom2},getCustom3:function(){return this._custom3},getScopiaUserId:function(){return this._scopiaUserId},getScopiaLoginId:function(){return this._scopiaLoginId},getTerminal:function(){return this._terminal},_isInContactList:function(){return this._inContactList},_setInContactList:function(e){this._inContactList=e},getPresence:function(){return this._presence},startPresence:function(){if(!this._getPresenceCapability.isAllowed)return T.Deferred().reject(new s.Services.Presence.PresenceError(s.Services.Presence.PresenceErrorReason.UNSUPPORTED)).promise();this._onPresenceReceived=function(e){if(e.getPresentity()===this._presenceAddress){if(this._selfContact){e=T.extend(new s.Services.Presence.SelfPresence,e);var t=s.Services.Contacts.ContactsUtils.getPhoneAndVideoChannelPresenceAddress(this);this._presenceService._setSelfPresence(e,this._presenceAddress,t.getPhoneNumber())}this._presence=e,this._onPresenceChangedCallbacks.fire(this,e)}}.bind(this);var i=this._presenceService.getPresenceListSubscription();i._addOnInternalPresenceReceivedCallback(this._onPresenceReceived);var a=T.Deferred(),r=function(){var t=this._getPresenceAddress()||this._getNextPresenceAddressCandidate();if(!t)return s.Base.Logger.error(s.Base.LoggerTags.CONTACTS_SERVICE,"No IM addresses available for contact's presence subscription"),i._removeOnInternalPresenceReceivedCallback(this._onPresenceReceived),T.Deferred().reject(new s.Services.Presence.PresenceError(s.Services.Presence.PresenceErrorReason.UNSUPPORTED)).promise();s.Base.Logger.debug(s.Base.LoggerTags.CONTACTS_SERVICE,"Attempting to subscribe for contact's presence using IM address",t),i._addInternalAddress(t).done(function(){this._presenceAddress=t,a.resolve()}.bind(this)).fail(function(e){e instanceof s.Services.Presence.PresenceError&&e.getReason()===s.Services.Presence.PresenceErrorReason.TIMEOUT?(s.Base.Logger.warn(s.Base.LoggerTags.CONTACTS_SERVICE,"Unable to subscribe for contact's presence using "+t+" IM address. Trying next one."),setTimeout(r,0)):(s.Base.Logger.error(s.Base.LoggerTags.CONTACTS_SERVICE,"Failed to subscribe for contact's presence",e),i._removeOnInternalPresenceReceivedCallback(this._onPresenceReceived),a.reject(e))}.bind(this))}.bind(this);return r(),a.promise()},stopPresence:function(){if(!this._getPresenceCapability.isAllowed)return T.Deferred().reject(new s.Services.Presence.PresenceError(s.Services.Presence.PresenceErrorReason.UNSUPPORTED));if(!this.getPresence())return s.Base.Logger.warn(s.Base.LoggerTags.CONTACTS_SERVICE,"Cannot stop monitoring presence of this contact as it was not started"),T.Deferred().reject(new s.Services.Presence.PresenceError(s.Services.Presence.PresenceErrorReason.INVALID_STATE));var e=this._presenceService.getPresenceListSubscription();return e._removeInternalAddress(this._getPresenceAddress()).then(function(){e._removeOnInternalPresenceReceivedCallback(this._onPresenceReceived),this._presence=m}.bind(this))},_setPresenceService:function(e){this._presenceService=e,this._presenceService&&(this._presenceService.addOnPresenceServiceAvailableCallback(this._recalculateCapabilities.bind(this)),this._presenceService.addOnPresenceServiceUnavailableCallback(this._recalculateCapabilities.bind(this))),this._recalculateCapabilities()},_setContactsService:function(e){this._contactsService=e},_getPresenceAddress:function(){return this._presenceAddress},_getNextPresenceAddressCandidate:function(){if(!this._presenceAddressCandidates){var e=this._imAddresses.getValues();(e=e.slice(0,e.length)).sort(function(e,t){return e.isAvayaAdministered()&&!t.isAvayaAdministered()||e.getIMAddressType()===s.Services.Contacts.ContactIMAddressType.IM_ADDRESS_WORK&&t.getIMAddressType()!==s.Services.Contacts.ContactIMAddressType.IM_ADDRESS_WORK?-1:!e.isAvayaAdministered()&&t.isAvayaAdministered()||e.getIMAddressType()!==s.Services.Contacts.ContactIMAddressType.IM_ADDRESS_WORK&&t.getIMAddressType()===s.Services.Contacts.ContactIMAddressType.IM_ADDRESS_WORK?1:0}),this._presenceAddressCandidates=e}var t=this._presenceAddressCandidates.shift();if(t)return t.getAddress()},_recalculateCapabilities:function(){var e;e=this._presenceService&&0<this._imAddresses.getValues().length&&this._presenceService._available?s.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED:s.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED,this._getPresenceCapability._updateIfChanged(e===s.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,e)},_setSelfContact:function(e){this._selfContact=e}},s.Base.AOPTools.addAdvices(e,"Contact",["startPresence","stopPresence"],[s.Base.AOPCommonAdvices.LOG_CONTACTS_API_CALLS,s.Base.AOPCommonAdvices.WRAP_CAUGHT_CONTACTS_ERROR]),s.Services.Contacts.Contact=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Contacts.Contact.prototype,{addOnPresenceChangedCallback:function(e){this._onPresenceChangedCallbacks.add(e)},removeOnPresenceChangedCallback:function(e){this._onPresenceChangedCallbacks.remove(e)},addOnContactChangedCallback:function(e){this._onContactChangedCallbacks.add(e)},removeOnContactChangedCallback:function(e){this._onContactChangedCallbacks.remove(e)}})}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Contacts.Contact.prototype,{getUpdateContactCapability:function(){return this._contactsService.getUpdateContactCapability(this)},getDeleteContactCapability:function(){return this._contactsService.getDeleteContactCapability(this)},getPresenceCapability:function(){return this._getPresenceCapability}})}(AvayaClientServices),function(e){"use strict";function t(){e.Services.Contacts.ContactField.call(this),this._value=!1}(t.prototype=Object.create(e.Services.Contacts.ContactField.prototype)).getValue=function(){return this._value},e.Services.Contacts.ContactBooleanField=t}(AvayaClientServices),function(e){"use strict";function t(){e.Services.Contacts.ContactField.call(this),this._address=m,this._emailAddressType=e.Services.Contacts.ContactEmailAddressType.EMAIL_ADDRESS_OTHER,this._default=!1}(t.prototype=Object.create(e.Services.Contacts.ContactField.prototype)).getAddress=function(){return this._address},t.prototype.getEmailAddressType=function(){return this._emailAddressType},t.prototype.isDefault=function(){return this._default},e.Services.Contacts.ContactEmailAddressField=t}(AvayaClientServices),function(e){"use strict";function t(){e.Services.Contacts.ContactBooleanField.call(this)}(t.prototype=Object.create(e.Services.Contacts.ContactBooleanField.prototype)).setValue=function(e){this._value=e},e.Services.Contacts.EditableContactBooleanField=t}(AvayaClientServices),function(t){"use strict";function e(){t.Services.Contacts.ContactEmailAddressField.call(this)}(e.prototype=Object.create(t.Services.Contacts.ContactEmailAddressField.prototype)).setAddress=function(e){this._address=e},e.prototype.setEmailAddressType=function(e){this._emailAddressType=e,this._default=this._emailAddressType===t.Services.Contacts.ContactEmailAddressType.EMAIL_ADDRESS_WORK},t.Services.Contacts.EditableContactEmailAddressField=e}(AvayaClientServices),function(n){"use strict";function e(e){this._contactsService=e,this._isAvailable=!1,this._onCapabilitiesChangedCallbacks=T.Callbacks(),this._onContactsServiceUnavailableCallbacks=T.Callbacks(),this._onContactsServiceAvailableCallbacks=T.Callbacks()}e.prototype={createEditableContact:function(){return this._contactsService.createEditableContact()},createEditableContactFromContact:function(e){return this._contactsService.createEditableContactFromContact(e)},addContact:function(e){return n.Base.Utils.isUndefined(e)||!e.getContactSavableCapability().isAllowed?T.Deferred().reject(new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.REQUIRED_DATA_MISSING)):this._contactsService.getAddContactCapability(e).isAllowed?this._contactsService.addContact(e):T.Deferred().reject(new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.ADD_CONTACT_NOT_AVAILABLE))},updateContact:function(e){return n.Base.Utils.isUndefined(e)||!e.getContactSavableCapability().isAllowed?T.Deferred().reject(new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.REQUIRED_DATA_MISSING)):this._contactsService.isContactInCache(e)?this._contactsService.getUpdateContactCapability(e).isAllowed?this._contactsService.updateContact(e):T.Deferred().reject(new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.UPDATE_CONTACT_NOT_AVAILABLE)):T.Deferred().reject(new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.CONTACT_NOT_FOUND))},deleteContact:function(e){return n.Base.Utils.isUndefined(e)||!this._contactsService.isContactInCache(e)?T.Deferred().reject(new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.CONTACT_NOT_FOUND)):this._contactsService.getDeleteContactCapability(e).isAllowed?this._contactsService.deleteContact(e):T.Deferred().reject(new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.DELETE_CONTACT_NOT_AVAILABLE))},getContacts:function(){return this._contactsService.getContacts()},searchContacts:function(e){if(!e)throw n.Base.Logger.error(n.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search request"),new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_REQUEST);var t=e.getSearchField();if(t){if(!n.Services.Contacts.SearchFieldType.hasOwnProperty(t))throw n.Base.Logger.error(n.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search field"),new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_FIELD)}else e._searchField=n.Services.Contacts.SearchFieldType.ALL;if(!this._contactsService.getNetworkSearchContactCapability().isAllowed&&e.getSearchField()!==n.Services.Contacts.SearchFieldType.TERMINAL)throw n.Base.Logger.error(n.Base.LoggerTags.CONTACTS_SERVICE,"Search contacts is not available"),new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.SEARCH_CONTACTS_NOT_AVAILABLE);if(!this._contactsService.getNetworkSearchTerminalCapability().isAllowed&&e.getSearchField()===n.Services.Contacts.SearchFieldType.TERMINAL)throw n.Base.Logger.error(n.Base.LoggerTags.CONTACTS_SERVICE,"Search terminals is not available"),new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.SEARCH_TERMINALS_NOT_AVAILABLE);var i=e.getSearchString();if(!i||""===i)throw n.Base.Logger.error(n.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search string"),new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_STRING);var a=e.getSearchSource();if(a){if(!n.Services.Contacts.SearchSourceType.hasOwnProperty(a))throw n.Base.Logger.error(n.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search source"),new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_SOURCE)}else e._searchSource=n.Services.Contacts.SearchSourceType.NETWORK;var r=e.getMaxResults();(!r||r<0)&&(e._maxResults=0);var s=e.getMaxChunkSize();return(!s||s<0)&&(e._maxChunkSize=0),this._contactsService.searchContacts(e)},resolveContacts:function(e){if(!e)throw n.Base.Logger.error(n.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search request"),new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_REQUEST);var t=e.getSearchStrings();if(!t||!t.length)throw n.Base.Logger.error(n.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search strings"),new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_STRINGS);if(500<t.length)throw n.Base.Logger.error(n.Base.LoggerTags.CONTACTS_SERVICE,"Count of search strings is too large"),new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.SEARCH_STRINGS_TOO_LARGE);var i=e.getSearchField();if(i){if(!n.Services.Contacts.ResolveContactsFieldType.hasOwnProperty(i))throw n.Base.Logger.error(n.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search field"),new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_FIELD)}else e._setSearchField(n.Services.Contacts.ResolveContactsFieldType.PHONE_NUMBER);var a=n.Services.Contacts.SearchSourceType,r=this._contactsService.getNetworkResolveContactsCapability(),s=e.getSearchSource();if(s||(s=a.NETWORK,e._setSearchSource(a.NETWORK)),!r.isAllowed)switch(s){case a.NETWORK:throw n.Base.Logger.error(n.Base.LoggerTags.CONTACTS_SERVICE,"Contact resolution over the network is currently unavailable"),new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.SEARCH_CONTACTS_NOT_AVAILABLE);case a.ALL:n.Base.Logger.warn(n.Base.LoggerTags.CONTACTS_SERVICE,"Contact resolution over the network is currently unavailable, searching in local cache"),s=a.LOCAL,e._setSearchSource(a.LOCAL)}if(!a.hasOwnProperty(s))throw n.Base.Logger.error(n.Base.LoggerTags.CONTACTS_SERVICE,"Invalid search source"),new n.Services.Contacts.ContactsError(n.Services.Contacts.ContactsErrorReason.INVALID_SEARCH_SOURCE);return this._contactsService.resolveContacts(e)},changeSearchContactsRequest:function(e,t){this._contactsService.changeSearchContactsRequest(e,t)},findLocalMatchingContacts:function(e,t){for(var i in n.Services.Contacts.SearchFieldType)n.Services.Contacts.SearchFieldType.hasOwnProperty(i)&&t===n.Services.Contacts.SearchFieldType[i]&&this._contactsService.findLocalMatchingContacts(e,t)},start:function(e){return this._startDfd=T.Deferred(),this._contactsService.start(this,e),this._startDfd.promise()},stop:function(){var e=function(){this._onCapabilitiesChangedCallbacks.empty(),this._onContactsServiceAvailableCallbacks.empty(),this._onContactsServiceUnavailableCallbacks.empty()}.bind(this);return this._contactsService.stop(this).always(e)},_stopImmediately:function(){return this._contactsService.stopImmediately(this)},_fireContactsAvailableCallback:function(){!this._isAvailable&&this._contactsService.isStarted()&&(this._isAvailable=!0,n.Base.Logger.info(n.Base.LoggerTags.CONTACTS_SERVICE,"Service is available"),this._startDfd.state()===n.Base.DeferredStates.PENDING&&this._startDfd.resolve(),this._onContactsServiceAvailableCallbacks.fire(this))},_fireContactsUnavailableCallback:function(){(this._isAvailable||this._contactsService.isStarting())&&(this._isAvailable=!1,n.Base.Logger.info(n.Base.LoggerTags.CONTACTS_SERVICE,"Service is unavailable"),this._contactsService.isStarting()&&(this._contactsService._starting=!1),this._startDfd.state()===n.Base.DeferredStates.PENDING&&this._startDfd.reject(),this._onContactsServiceUnavailableCallbacks.fire(this))}},n.Base.AOPTools.addAdvices(e,"Contacts",["createEditableContact","createEditableContactFromContact","getContacts","searchContacts","resolveContacts","changeSearchContactsRequest","findLocalMatchingContacts"],[n.Base.AOPCommonAdvices.LOG_CONTACTS_API_CALLS]),n.Base.AOPTools.addAdvices(e,"Contacts",["addContact","updateContact","deleteContact"],[n.Base.AOPCommonAdvices.LOG_CONTACTS_API_CALLS,n.Base.AOPCommonAdvices.WRAP_CAUGHT_CONTACTS_ERROR]),n.Services.Contacts.Contacts=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Contacts.Contacts.prototype,{addOnContactsServiceUnavailableCallback:function(e){this._onContactsServiceUnavailableCallbacks.add(e)},removeOnContactsServiceUnavailableCallback:function(e){this._onContactsServiceUnavailableCallbacks.remove(e)},addOnContactsServiceAvailableCallback:function(e){this._onContactsServiceAvailableCallbacks.add(e)},removeOnContactsServiceAvailableCallback:function(e){this._onContactsServiceAvailableCallbacks.remove(e)},addOnContactServicesCapabilitiesChangedCallback:function(e){this._onCapabilitiesChangedCallbacks.add(e)},removeOnContactServicesCapabilitiesChangedCallback:function(e){this._onCapabilitiesChangedCallbacks.remove(e)}})}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Contacts.Contacts.prototype,{getAddContactCapability:function(){return this._contactsService.getAddContactCapability()},getNetworkSearchContactCapability:function(){return this._contactsService.getNetworkSearchContactCapability()},getNetworkSearchTerminalCapability:function(){return this._contactsService.getNetworkSearchTerminalCapability()},getConferenceSearchCapability:function(){return this._contactsService.getConferenceSearchCapability()},getNetworkResolveContactsCapability:function(){return this._contactsService.getNetworkResolveContactsCapability()}})}(AvayaClientServices),function(t){"use strict";function e(e){this._thumbnailCreator=e,this.disposition="",this.duration=-1,this.mimeType="",this.id="",this.size=-1,this.file=m,this.status="",this.name="",this.location="",this.thumbnail=m,this._onNameChangedCallbacks=T.Callbacks(),this._onMimeTypeChangedCallbacks=T.Callbacks(),this._onDurationChangedCallbacks=T.Callbacks(),this._onSizeChangedCallbacks=T.Callbacks(),this._onStatusChangedCallbacks=T.Callbacks(),this._onConsumptionStatusChangedCallbacks=T.Callbacks(),this._onTypeChangedCallbacks=T.Callbacks(),this._onHasThumbnailChangedCallbacks=T.Callbacks(),this._onIsSelfGeneratedCallbacks=T.Callbacks(),this._updateNameCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateMimeTypeCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateDurationCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateSizeCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateLocationCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateIsSelfGeneratedCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createThumbnailCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeThumbnailCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE)}e.prototype={_getStatus:function(){return this.status},getName:function(){if(this.name)return this.name;if(this.disposition&&-1!==this.disposition.search("filename"))try{return this.name=new RegExp("filename=(?:[\"']?)([^\"';]+)","i").exec(this.disposition)[1],this.name}catch(e){t.Base.Logger.error(t.Base.LoggerTags.MESSAGING_SERVICE,"Could not retrieve attachment name: "+e)}return m},getMimeType:function(){return this.mimeType},getDuration:function(){return this.duration},getSize:function(){return this.size},_isThumbnail:function(){return-1!==this.disposition.indexOf("inline")},getThumbnail:function(){return this.thumbnail},setName:function(e){t.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.name=e},setMimeType:function(e){t.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.mimeType=e},setDuration:function(e){t.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"number"}]}),this.duration=e},getDownloadURL:function(){return this.location},createThumbnail:function(){return!!this.getCreateThumbnailCapability().isAllowed&&this._thumbnailCreator.create(this)},removeThumbnail:function(){this.thumbnail=m},_setStatus:function(e){this.status=e,this._onStatusChangedCallbacks.fire(e)}},t.Base.AOPTools.addAdvices(e,"Attachment",["createThumbnail"],[t.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS,t.Base.AOPCommonAdvices.WRAP_CAUGHT_MESSAGING_ERROR]),t.Services.Messaging.Attachment=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Messaging.Attachment.prototype,{addOnStatusChangedCallback:function(e){this._onStatusChangedCallbacks.add(e)},removeOnStatusChangedCallback:function(e){this._onStatusChangedCallbacks.remove(e)},addOnHasThumbnailChangedCallback:function(e){this._onHasThumbnailChangedCallbacks.add(e)},removeOnHasThumbnailChangedCallback:function(e){this._onHasThumbnailChangedCallbacks.remove(e)},addOnIsSelfGeneratedCallback:function(e){this._onIsSelfGeneratedCallbacks.add(e)},removeOnIsSelfGeneratedCallback:function(e){this._onIsSelfGeneratedCallbacks.remove(e)}})}(AvayaClientServices),function(r){"use strict";var e={getUpdateNameCapability:function(){return this._updateNameCapability},_recalculateUpdateNameCapability:function(){var e,t;t=this.status!==r.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateNameCapability._updateIfChanged(e,t)},getUpdateMimeTypeCapability:function(){return this._updateMimeTypeCapability},_recalculateUpdateMimeTypeCapability:function(){var e,t;t=this.status!==r.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateMimeTypeCapability._updateIfChanged(e,t)},getUpdateDurationCapability:function(){return this._updateDurationCapability},_recalculateUpdateDurationCapability:function(){var e,t;t=this.status!==r.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateDurationCapability._updateIfChanged(e,t)},getUpdateIsSelfGeneratedCapability:function(){return this._updateIsSelfGeneratedCapability},_recalculateUpdateIsSelfGeneratedCapability:function(){var e;e=r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED,this._updateIsSelfGeneratedCapability._updateIfChanged(!0,e)},getCreateThumbnailCapability:function(){return this._createThumbnailCapability},_recalculateCreateThumbnailCapability:function(){var e,t;for(var i in e=!1,this._thumbnailCreator._creators)if(this._thumbnailCreator._creators.hasOwnProperty(i)){var a=i;-1!==i.indexOf("/*")&&(a=i.slice(0,i.indexOf("/*"))),-1!==this.getMimeType().indexOf(a)&&(e=!0,t=r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED)}e||(t=r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createThumbnailCapability._updateIfChanged(e,t)},getRemoveThumbnailCapability:function(){return this._removeThumbnailCapability},_recalculateRemoveThumbnailCapability:function(){var e,t;t=this.status!==r.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._removeThumbnailCapability._updateIfChanged(e,t)},getRemoveCapability:function(){return this._removeCapability},_recalculateRemoveCapability:function(){var e,t;t=this.status!==r.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!1,r.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(e=!0,r.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._removeCapability._updateIfChanged(e,t)}};T.extend(r.Services.Messaging.Attachment.prototype,e)}(AvayaClientServices),function(a){"use strict";function e(e){this._conversationService=e,this.attachmentCount=0,this.totalMessageCount=0,this.active=!1,this.closed=!1,this.sensitivity=a.Services.Messaging.SensitivityLevel.NORMAL,this.href="",this.id="",this.lastAccessTime=m,this.lastUpdated=m,this.latestEntryTimestamp=m,this.subject="",this.totalCount=0,this.type=a.Services.Messaging.ConversationType.THREAD,this.unreadAttachmentCount=0,this.unreadCount=0,this.unreadContentSinceLastAccess=0,this.resourceStatus=a.Services.Messaging.ResourceStatus.PUBLISHED,this.messages=new a.Base.DataSet,this.previewText="",this.participants=[],this.composingParticipants=new a.Base.DataSet,this.multiparty=!1,this._draftMessages=[],this._draftEscalations=[],this._counts={eventCount:0,eventUnreadMessage:0,messageAttachment:0,messageCount:0,messageUnreadAttachment:0,messageUnreadMessage:0},this._isSubscribed=!1,this._onMessagesAddedCallbacks=T.Callbacks(),this._onSubjectChangedCallbacks=T.Callbacks(),this._onParticipantsAddedCallbacks=T.Callbacks(),this._onParticipantsRemovedCallbacks=T.Callbacks(),this._onActiveStatusChangedCallbacks=T.Callbacks(),this._onClosedStatusChangedCallbacks=T.Callbacks(),this._onMultiPartyStatusChangedCallbacks=T.Callbacks(),this._onIsComposingStatusChangedCallbacks=T.Callbacks(),this._onLastAccessTimeChangedCallbacks=T.Callbacks(),this._onLastUpdatedTimeChangedCallbacks=T.Callbacks(),this._onLatestEntryTimeChangedCallbacks=T.Callbacks(),this._onStatusChangedCallbacks=T.Callbacks(),this._onPreviewTextChangedCallbacks=T.Callbacks(),this._onTotalMessagesCountChangedCallbacks=T.Callbacks(),this._onTotalUnreadMessageCountChangedCallbacks=T.Callbacks(),this._onTotalAttachmentCountChangedCallbacks=T.Callbacks(),this._onTotalUnreadAttachmentCountChangedCallbacks=T.Callbacks(),this._onTotalEventCountChangedCallbacks=T.Callbacks(),this._onTotalUnreadEventCountChangedCallbacks=T.Callbacks(),this._onSensitivityChangedCallbacks=T.Callbacks(),this._onTypeChangedCallbacks=T.Callbacks(),this._onMessagesRemovedCallbacks=T.Callbacks(),this._onOtherMessagesAddedCallbacks=T.Callbacks(),this._updateSubjectCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateLastAccessTimeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateSensitivityCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._retrieveMessagesCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addParticipantsCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeParticipantsCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createMessageCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createEscalationCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._markAllContentAsReadCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._leaveCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._startCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._isTypingCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE)}e.prototype={getSensitivity:function(){return this.sensitivity},isActive:function(){return this.active},isClosed:function(){return this.closed},isMultiParty:function(){return this.multiparty},isPrivate:function(){return this.sensitivity===a.Services.Messaging.SensitivityLevel.PRIVATE},hasUnreadMessagesSinceLastAccess:function(){return 0<this._conversationService.getNumberOfMessagesWithUnreadContentSinceLastAccess(this)},hasUnreadAttachments:function(){return 0<this._counts.messageUnreadAttachment},hasAttachments:function(){return 0<this._counts.messageAttachment},isParticipantActive:function(e){},getLastAccessTime:function(){return this.lastAccessTime},getLastUpdatedTime:function(){return this.lastUpdated},getLastEntryTime:function(){return this.latestEntryTimestamp},getComposingParticipants:function(){return this.composingParticipants},getParticipants:function(){return this.participants},getActiveParticipants:function(){return this.getParticipants()},getType:function(){return this.type},getTotalMessageCount:function(){return this._counts.messageCount},getAttachmentCount:function(){return this._counts.messageAttachment},getUnreadAttachmentCount:function(){return this._counts.messageUnreadAttachment},getUnreadMessageCount:function(){return this._counts.messageUnreadMessage},getPreviewText:function(){return this.previewText},getSubject:function(){return this.subject},getLastUpdatedByParticipant:function(){var t=this._getLastMessage();return void 0===t?m:this.participants.filter(function(e){return e.address===t.from.address})[0]},getStatus:function(){return this.resourceStatus},setSensitivity:function(e){var t=!1;for(var i in a.Services.Messaging.SensitivityLevel)if(a.Services.Messaging.SensitivityLevel.hasOwnProperty(i)&&e===a.Services.Messaging.SensitivityLevel[i]){a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.sensitivity!==e&&(this.sensitivity=e,this._onSensitivityChangedCallbacks.fire(this,e)),t=!0;break}return t},_setStatus:function(e){a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.resourceStatus!==e&&(this.resourceStatus=e,this._onStatusChangedCallbacks.fire(this,e))},setLastAccessTime:function(){this._conversationService.setLastAccessTime(this)},setSubject:function(e){a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.subject!==e&&(this.getStatus()===a.Services.Messaging.ResourceStatus.PUBLISHED&&this._conversationService.changeSubject(this,e),this.subject=e,this._onSubjectChangedCallbacks.fire(this,this.subject))},_getLastMessage:function(){return this.messages.filter(function(e){return e.getType()===a.Services.Messaging.MessageType.MESSAGE})[0]},createMessage:function(){return this._conversationService.createMessage(this)},createEscalation:function(){var e=this._conversationService.createEscalation(this);return this._draftEscalations.push(e),e},removeEscalation:function(e){return a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:a.Services.Messaging.Escalation}]}),this._conversationService.removeEscalation(e,this._draftEscalations)},getMessages:function(){return this.messages},retrieveMessagesAfter:function(e,t){return a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:a.Services.Messaging.Message}]}),a.Base.Utils.validate(t,{optional:!0,validators:[{type:"type",expected:"number"}]}),this._conversationService.getOtherMessages(null,e,t,this)},retrieveMessagesBefore:function(e,t){return a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:a.Services.Messaging.Message}]}),a.Base.Utils.validate(t,{optional:!0,validators:[{type:"type",expected:"number"}]}),this._conversationService.getOtherMessages(e,null,t,this)},markAllContentAsRead:function(){return this._conversationService.markAllAsRead(this)},subscribeForTypingEvents:function(e){return this._conversationService.subscribeForTypingEvents(this,e)},unsubscribeForTypingEvents:function(){return this._conversationService.unsubscribeForTypingEvents(this)},addParticipantAddresses:function(e){return a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:Array},{type:"arrayElementType",expected:"string"}]}),this._conversationService.addParticipantAddresses(this,e)},removeParticipantAddresses:function(e){return a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:Array},{type:"arrayElementType",expected:"string"}]}),this._conversationService.removeParticipantAddresses(this,e)},removeMessage:function(e){return a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:a.Services.Messaging.Message}]}),this._conversationService.removeMessage(this.messages,this._draftMessages,e)},start:function(){var e=T.Deferred();return setTimeout(function(){e.resolve()}),e.promise()},leave:function(){return this._conversationService.leave(this)},_updateParticipantsList:function(e){this._conversationService._updateParticipantsList(this,e)},getId:function(){return this.id}},a.Base.AOPTools.addAdvices(e,"Conversation",["setSubject","createMessage","createEscalation","retrieveMessagesAfter","retrieveMessagesBefore"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS]),a.Base.AOPTools.addAdvices(e,"Conversation",["markAllContentAsRead","removeEscalation","subscribeForTypingEvents","unsubscribeForTypingEvents","addParticipantAddresses","removeParticipantAddresses","removeMessage","start","leave"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_MESSAGING_ERROR]),a.Services.Messaging.Conversation=e}(AvayaClientServices),function(l){"use strict";function e(e){this._messageBuilder=e}e.prototype={build:function(e,t){var i=new l.Services.Messaging.Conversation(t);i.attachmentCount=e.attachmentCount||0,e.counts&&(i.totalMessageCount=e.counts.messageCount||0),e.flags&&(i.active=e.flags.active,i.closed=e.flags.closed,i.sensitivity=e.flags.sensitivity),i.href=e.href,i.id=e.id,i.lastAccessTime=new Date(e.lastAccessedTime),i.participants=new l.Base.DataSet,i.lastUpdated=new Date(e.lastUpdated),i.latestEntryTimestamp=new Date(e.latestEntryTimestamp),i.subject=e.subject,i.totalCount=e.totalCount||0,i.type=e.type||l.Services.Messaging.ConversationType.THREAD,i.unreadAttachmentCount=e.unreadAttachmentCount||0,i.unreadCount=e.unreadCount||0,i.resourceStatus=e.resourceStatus||l.Services.Messaging.ResourceStatus.PUBLISHED,e.counts&&(i._counts.eventCount=e.counts.eventCount||0,i._counts.eventUnreadMessage=e.counts.eventUnreadMessage||0,i._counts.messageAttachment=e.counts.messageAttachment||0,i._counts.messageCount=e.counts.messageCount||0,i._counts.messageUnreadAttachment=e.counts.messageUnreadAttachment||0,i._counts.messageUnreadMessage=e.counts.messageUnreadMessage||0);var a=i._getLastMessage();return i.previewText=a?a.from.givenName+": "+a.body:"",t._recalculateAllConversationCapabilities(i),i},update:function(e,t,i){e.attachmentCount!==t.attachmentCount&&(e.attachmentCount=t.attachmentCount,e._onTotalAttachmentCountChangedCallbacks.fire(e,e.attachmentCount)),t.counts&&e.totalMessageCount!==t.counts.messageCount&&(e.totalMessageCount=t.counts.messageCount,e._onTotalMessagesCountChangedCallbacks.fire(e,e.totalMessageCount)),t.flags&&(e.active!==t.flags.active&&(e.active=t.flags.active,e._onActiveStatusChangedCallbacks.fire(e,e.active)),e.closed!==t.flags.closed&&(e.closed=t.flags.closed,e._onClosedStatusChangedCallbacks.fire(e,e.closed)),e.sensitivity!==t.flags.sensitivity&&(e.sensitivity=t.flags.sensitivity,e._onSensitivityChangedCallbacks.fire(e,e.sensitivity))),e.multiparty!==t.isMultiparty&&(e.multiparty=t.isMultiparty,e._onMultiPartyStatusChangedCallbacks.fire(e,e.multiparty));var a=new Date(t.lastUpdated);return e.lastUpdated&&e.lastUpdated.getTime()===a.getTime()||(e.lastUpdated=a,e._onLastUpdatedTimeChangedCallbacks.fire(e,e.lastUpdated)),a=new Date(t.lastAccessedTime),e.lastAccessTime&&e.lastAccessTime.getTime()===a.getTime()||(e.lastAccessTime=a,e._onLastAccessTimeChangedCallbacks.fire(e,e.lastAccessTime)),a=new Date(t.latestEntryTimestamp),e.latestEntryTimestamp&&e.latestEntryTimestamp.getTime()===a.getTime()||(e.latestEntryTimestamp=a,e._onLatestEntryTimeChangedCallbacks.fire(e,e.latestEntryTimestamp)),e.subject!==t.subject&&(e.subject=t.subject,e._onSubjectChangedCallbacks.fire(e,e.subject)),e.type!==t.type&&(e.type=t.type,e._onTypeChangedCallbacks.fire(e,e.type)),e.unreadAttachmentCount!==t.unreadAttachmentCount&&(e.unreadAttachmentCount=t.unreadAttachmentCount,e._onTotalUnreadAttachmentCountChangedCallbacks.fire(e,e.unreadAttachmentCount)),e.unreadCount!==t.unreadCount&&(e.unreadCount=t.unreadCount,e._onTotalUnreadMessageCountChangedCallbacks.fire(e,e.unreadCount)),t.counts&&(e._counts.eventCount!==t.counts.eventCount&&(e._counts.eventCount=t.counts.eventCount,e._onTotalEventCountChangedCallbacks.fire(e,e._counts.eventCount)),e._counts.eventUnreadMessage!==t.counts.eventUnreadMessage&&(e._counts.eventUnreadMessage=t.counts.eventUnreadMessage,e._onTotalUnreadEventCountChangedCallbacks.fire(e,e._counts.eventUnreadMessage)),e._counts.messageAttachment!==t.counts.messageAttachment&&(e._counts.messageAttachment=t.counts.messageAttachment,e._onTotalAttachmentCountChangedCallbacks.fire(e,e._counts.messageAttachment)),e._counts.messageCount!==t.counts.messageCount&&(e._counts.messageCount=t.counts.messageCount,e._onTotalMessagesCountChangedCallbacks.fire(e,e._counts.messageCount)),e._counts.messageUnreadAttachment!==t.counts.messageUnreadAttachment&&(e._counts.messageUnreadAttachment=t.counts.messageUnreadAttachment,e._onTotalUnreadAttachmentCountChangedCallbacks.fire(e,e._counts.messageUnreadAttachment)),e._counts.messageUnreadMessage!==t.counts.messageUnreadMessage&&(e._counts.messageUnreadMessage=t.counts.messageUnreadMessage,e._onTotalUnreadMessageCountChangedCallbacks.fire(e,e._counts.messageUnreadMessage))),i._recalculateAllConversationCapabilities(e),this.updateMessages(e,t,i)},updateMessages:function(e,t,i){for(var a,r=[],s=[],n=t.messages.length-1;0<=n;n--){var o=t.messages[n],c=this._getMessageById(e.messages,o.id);void 0!==c?c.getLastModifiedDate().toISOString()!==new Date(o.lastModifiedDate).toISOString()&&(t.messages[n+1]&&(a=this._getMessageById(e.messages,t.messages[n+1].id)),this._updateExistingMessage(c,o,a),r.push(c)):(t.messages[n+1]&&(a=this._getMessageById(e.messages,t.messages[n+1].id)),a=this._addNewMessage(e,o,a,i),e._onMessagesAddedCallbacks.fire(e,[a]),s.push(a))}return 0<r.length&&e.messages.onDataSetChanged(r,l.Base.DataSetChangeTypes.UPDATED),0<s.length&&e.messages.onDataSetChanged(s,l.Base.DataSetChangeTypes.ADDED),(0<r.length||0<s.length)&&this._updatePreviewText(e),s},_getMessageById:function(e,t){for(var i=0;i<e.length;i++)if(e[i].id===t)return e[i]},_updatePreviewText:function(e){var t=e._getLastMessage(),i=t&&t.from?t.from.givenName+": "+t.getBody():"";i!==e.previewText&&(e.previewText=i,e._onPreviewTextChangedCallbacks.fire(e,i))},_removeParticipant:function(e,t){var i=e.participants.filter(function(e){return e.getAddress()===t.eventRelatedParticipants[0].address});if(0<i.length){var a=e.participants.indexOf(i[0]);e.participants.splice(a,1),e._onParticipantsRemovedCallbacks.fire(e,i[0])}},_updateExistingMessage:function(e,t,i){return this._messageBuilder.update(e,t),i&&e._setIsCoalesced(this._messageBuilder.isMessageCoalesced(e,i)),e},_addNewMessage:function(e,t,i,a){var r=a.createNewClientMessage(t,e);return i&&r._setIsCoalesced(this._messageBuilder.isMessageCoalesced(r,i)),e.messages.push(r),r.getType()===l.Services.Messaging.MessageType.LEFT&&this._removeParticipant(e,r),e.messages.sort(function(e,t){return e.lastModifiedDate.getTime()-t.lastModifiedDate.getTime()}),r}},l.Services.Messaging.ConversationBuilder=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Messaging.Conversation.prototype,{addOnTotalMessageCountChangedCallback:function(e){this._onTotalMessagesCountChangedCallbacks.add(e)},removeOnTotalMessageCountChangedCallback:function(e){this._onTotalMessagesCountChangedCallbacks.remove(e)},addOnSubjectChangedCallback:function(e){this._onSubjectChangedCallbacks.add(e)},removeOnSubjectChangedCallback:function(e){this._onSubjectChangedCallbacks.remove(e)},addOnActiveStatusChangedCallback:function(e){this._onActiveStatusChangedCallbacks.add(e)},removeOnActiveStatusChangedCallback:function(e){this._onActiveStatusChangedCallbacks.remove(e)},addOnClosedStatusChangedCallback:function(e){this._onClosedStatusChangedCallbacks.add(e)},removeOnClosedStatusChangedCallback:function(e){this._onClosedStatusChangedCallbacks.remove(e)},addOnMultiPartyStatusChangedCallback:function(e){this._onMultiPartyStatusChangedCallbacks.add(e)},removeOnMultiPartyStatusChangedCallback:function(e){this._onMultiPartyStatusChangedCallbacks.remove(e)},addOnLastAccessTimeChangedCallback:function(e){this._onLastAccessTimeChangedCallbacks.add(e)},removeOnLastAccessTimeChangedCallback:function(e){this._onLastAccessTimeChangedCallbacks.remove(e)},addOnLastUpdatedTimeChangedCallback:function(e){this._onLastUpdatedTimeChangedCallbacks.add(e)},removeOnLastUpdatedTimeChangedCallback:function(e){this._onLastUpdatedTimeChangedCallbacks.remove(e)},addOnLatestEntryTimeChangedCallback:function(e){this._onLatestEntryTimeChangedCallbacks.add(e)},removeOnLatestEntryTimeChangedCallback:function(e){this._onLatestEntryTimeChangedCallbacks.remove(e)},addOnStatusChangedCallback:function(e){this._onStatusChangedCallbacks.add(e)},removeOnStatusChangedCallback:function(e){this._onStatusChangedCallbacks.remove(e)},addOnPreviewTextChangedCallback:function(e){this._onPreviewTextChangedCallbacks.add(e)},removeOnPreviewTextChangedCallback:function(e){this._onPreviewTextChangedCallbacks.remove(e)},addOnTotalAttachmentCountChangedCallback:function(e){this._onTotalAttachmentCountChangedCallbacks.add(e)},removeOnTotalAttachmentCountChangedCallback:function(e){this._onTotalAttachmentCountChangedCallbacks.remove(e)},addOnTotalUnreadMessageCountChangedCallback:function(e){this._onTotalUnreadMessageCountChangedCallbacks.add(e)},removeOnTotalUnreadMessageCountChangedCallback:function(e){this._onTotalUnreadMessageCountChangedCallbacks.remove(e)},addOnTotalUnreadAttachmentCountChangedCallback:function(e){this._onTotalUnreadAttachmentCountChangedCallbacks.add(e)},removeOnTotalUnreadAttachmentCountChangedCallback:function(e){this._onTotalUnreadAttachmentCountChangedCallbacks.remove(e)},addOnSensitivityChangedCallback:function(e){this._onSensitivityChangedCallbacks.add(e)},removeOnSensitivityChangedCallback:function(e){this._onSensitivityChangedCallbacks.remove(e)}})}(AvayaClientServices),function(a){"use strict";var e={getUpdateSubjectCapability:function(){return this._updateSubjectCapability},_recalculateUpdateSubjectCapability:function(){var e,t;!this._conversationService.isServiceAvailable()||this.closed?(e=!1,t=a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):this.resourceStatus===a.Services.Messaging.ResourceStatus.PUBLISHED?t=this._conversationService.isUpdateSubjectSupported()?(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):this.resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT&&(e=!0,t=a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateSubjectCapability._updateIfChanged(e,t)},getUpdateLastAccessTimeCapability:function(){return this._updateLastAccessTimeCapability},_recalculateUpdateLastAccessTimeCapability:function(){var e,t;t=!this._conversationService.isServiceAvailable()||this.closed||this.resourceStatus!==a.Services.Messaging.ResourceStatus.PUBLISHED?(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateLastAccessTimeCapability._updateIfChanged(e,t)},getUpdateSensitivityCapability:function(){return this._updateSensitivityCapability},_recalculateUpdateSensitivityCapability:function(){var e,t;t=!this._conversationService.isServiceAvailable()||this.closed||this.resourceStatus!==a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._updateSensitivityCapability._updateIfChanged(e,t)},getRetrieveMessagesCapability:function(){return this._retrieveMessagesCapability},_recalculateOlderContentCapability:function(){var e,t;t=this._conversationService.isServiceAvailable()&&this.resourceStatus===a.Services.Messaging.ResourceStatus.PUBLISHED&&this.totalCount!==this.messages.length?(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._retrieveMessagesCapability._updateIfChanged(e,t)},getAddParticipantsCapability:function(){return this._addParticipantsCapability},_recalculateAddParticipantsCapability:function(){var e,t;t=this._conversationService.isServiceAvailable()&&(this.isActive()||this.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT)?(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addParticipantsCapability._updateIfChanged(e,t)},getRemoveParticipantsCapability:function(){return this._removeParticipantsCapability},_recalculateRemoveParticipantsCapability:function(){var e,t;t=this._conversationService.isServiceAvailable()&&this.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeParticipantsCapability._updateIfChanged(e,t)},getCreateMessageCapability:function(){return this._createMessageCapability},_recalculateCreateMessageCapability:function(){var e,t;t=!this._conversationService.isServiceAvailable()||this.closed?(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._createMessageCapability._updateIfChanged(e,t)},getCreateEscalationCapability:function(){return this._createEscalationCapability},_recalculateCreateEscalationCapability:function(){var e,t;t=this._conversationService.isServiceAvailable()&&this.getStatus()!==a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createEscalationCapability._updateIfChanged(e,t)},getMarkAllContentAsReadCapability:function(){return this._markAllContentAsReadCapability},_recalculateMarkAllContentAsReadCapability:function(){var e,t;t=this._conversationService.isServiceAvailable()&&0!==this._counts.messageUnreadMessage?this._conversationService.isMarkAllContentAsReadSupported()?(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._markAllContentAsReadCapability._updateIfChanged(e,t)},getLeaveCapability:function(){return this._leaveCapability},_recalculateLeaveCapability:function(){var e,t;t=this._conversationService.isServiceAvailable()&&this.active&&!this.closed?(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._leaveCapability._updateIfChanged(e,t)},getRemoveCapability:function(){return this._removeCapability},_recalculateRemoveCapability:function(){var e,t;t=this._conversationService.isServiceAvailable()&&this.getStatus()===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeCapability._updateIfChanged(e,t)},getSendCapability:function(){return this._startCapability},_recalculateStartCapability:function(){var e,t;t=this._conversationService.isServiceAvailable()&&!this.closed&&this.active&&this.resourceStatus===a.Services.Messaging.ResourceStatus.DRAFT_UNSENT?0===this.participants.filter(function(e){return!e.isLocalUser()}).length?(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._startCapability._updateIfChanged(e,t)},getIsTypingCapability:function(){return this._isTypingCapability},_recalculateIsTypingCapability:function(){var e,t,i=this._conversationService.isOpened();t=this._conversationService.isServiceAvailable()&&i&&this._isSubscribed?(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._isTypingCapability._updateIfChanged(e,t)}};T.extend(a.Services.Messaging.Conversation.prototype,e)}(AvayaClientServices),function(a){"use strict";function e(e,t){this._messageService=e,this.conversation=t,this.resourceStatus=a.Services.Messaging.ResourceStatus.PUBLISHED,this.body="",this.htmlBody="",this.type=a.Services.Messaging.MessageType.MESSAGE,this.sensitivity=a.Services.Messaging.SensitivityLevel.NORMAL,this.importance=a.Services.Messaging.MessageImportance.NORMAL,this.read=!1,this.doNotForward=!1,this.from=m,this.href="",this.id="",this.lastModifiedDate=m,this.receivedDate=m,this.subject="",this.threadId="",this.to=m,this.parts=new a.Base.DataSet,this._attachments=[],this.coalesced=!1,this.inReplyTo=m,this._sessionType=m,this._onTypeChangedCallbacks=T.Callbacks(),this._onBodyChangedCallbacks=T.Callbacks(),this._onInReplyToChangedCallbacks=T.Callbacks(),this._onLastModifiedDateChangedCallbacks=T.Callbacks(),this._onIsCoalescedStatusChangedCallbacks=T.Callbacks(),this._onHasAttachmentStatusChangedCallbacks=T.Callbacks(),this._onHasUnreadAttachmentStatusChangedCallbacks=T.Callbacks(),this._onIsPrivateStatusChangedCallbacks=T.Callbacks(),this._onDoNotForwardStatusChangedCallbacks=T.Callbacks(),this._onIsReadStatusChangedCallbacks=T.Callbacks(),this._onStatusChangedCallbacks=T.Callbacks(),this._onImportanceChangedCallbacks=T.Callbacks(),this._onSensitivityChangedCallbacks=T.Callbacks(),this._updateBodyCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateSensitivityCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateInReplyToCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateDoNotForwardCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateImportanceCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createAttachmentCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._sendCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._markAsReadCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE)}e.prototype={getType:function(){return this.type},getBody:function(){return this.body},getHtmlBody:function(){return this.htmlBody},getConversationId:function(){return this.conversation.getId()},getId:function(){return this.id},getInReplyTo:function(){return this.inReplyTo},getSessionType:function(){return this._sessionType},getLastModifiedDate:function(){return this.lastModifiedDate},getReceivedDate:function(){return this.receivedDate},isCoalesced:function(){return this.coalesced},hasHtmlBody:function(){return 0<this.htmlBody.length},hasAttachment:function(){return 0<this.parts.length},hasUnreadAttachment:function(){return this.parts.reduce(function(e,t){return e||!t.isRead()},!1)},isPrivate:function(){return this.sensitivity===a.Services.Messaging.SensitivityLevel.PRIVATE},isDoNotForward:function(){return this.doNotForward},isRead:function(){return this.read},getFromParticipant:function(){return this.from},getAttachments:function(){return this.parts},getStatus:function(){return this.resourceStatus},getImportance:function(){return this.importance},getSensitivity:function(){return this.sensitivity},setBodyAndReportTyping:function(e){return a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this._messageService.setBodyAndReportTyping(this,this.conversation,e)},reportTyping:function(e){this.conversation.getStatus()===a.Services.Messaging.ResourceStatus.PUBLISHED&&this.conversation.getIsTypingCapability().isAllowed&&this.conversation._conversationService.reportTyping(this,e)},setSensitivity:function(e){for(var t in a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),a.Services.Messaging.SensitivityLevel)a.Services.Messaging.SensitivityLevel.hasOwnProperty(t)&&e===a.Services.Messaging.SensitivityLevel[t]&&(a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.sensitivity!==e&&(this.sensitivity=e,this._onSensitivityChangedCallbacks.fire(this,e)))},_setIsCoalesced:function(e){a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"boolean"}]}),this.coalesced!==e&&(this.coalesced=e,this._onIsCoalescedStatusChangedCallbacks.fire(this,e))},isFromMe:function(){return!!this.from&&this.from.isSelf()},setInReplyTo:function(e){a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:a.Services.Messaging.Message}]}),e instanceof a.Services.Messaging.Message&&void 0!==e.getId()&&this.inReplyTo!==e&&(this.inReplyTo=e.getId(),this._onInReplyToChangedCallbacks.fire(this,this.inReplyTo))},setDoNotForward:function(e){a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"boolean"}]}),this.doNotForward!==e&&(this.doNotForward=e,this._onDoNotForwardStatusChangedCallbacks.fire(this,e))},_setStatus:function(e){a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.resourceStatus!==e&&(this.resourceStatus=e,this._onStatusChangedCallbacks.fire(this,e))},setImportance:function(e){a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"string"}]});var t=!1;for(var i in a.Services.Messaging.MessageImportance)if(a.Services.Messaging.MessageImportance.hasOwnProperty(i)&&e===a.Services.Messaging.MessageImportance[i]){a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:"string"}]}),this.importance!==e&&(this.importance=e,this._onImportanceChangedCallbacks.fire(this,e)),t=!0;break}return t},markAsRead:function(){return this._messageService.markAsRead(this)},send:function(){return this._messageService.send(this)},createAttachment:function(e){return a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:File}]}),this._messageService.createAttachment(this,e)},removeDraftAttachment:function(e){a.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:a.Services.Messaging.Attachment}]}),this._messageService.removeDraftAttachment(this,e)}},a.Base.AOPTools.addAdvices(e,"Message",["removeDraftAttachment","createAttachment","reportTyping"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS]),a.Base.AOPTools.addAdvices(e,"Message",["send","markAsRead","setBodyAndReportTyping"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_MESSAGING_ERROR]),a.Services.Messaging.Message=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Messaging.Message.prototype,{addOnBodyChangedCallback:function(e){this._onBodyChangedCallbacks.add(e)},removeOnBodyChangedCallback:function(e){this._onBodyChangedCallbacks.remove(e)},addOnInReplyToChangedCallback:function(e){this._onInReplyToChangedCallbacks.add(e)},removeOnInReplyToChangedCallback:function(e){this._onInReplyToChangedCallbacks.remove(e)},addOnLastModifiedDateChangedCallback:function(e){this._onLastModifiedDateChangedCallbacks.add(e)},removeOnLastModifiedDateChangedCallback:function(e){this._onLastModifiedDateChangedCallbacks.remove(e)},addOnIsCoalescedStatusChangedCallback:function(e){this._onIsCoalescedStatusChangedCallbacks.add(e)},removeOnIsCoalescedStatusChangedCallback:function(e){this._onIsCoalescedStatusChangedCallbacks.remove(e)},addOnHasAttachmentStatusChangedCallback:function(e){this._onHasAttachmentStatusChangedCallbacks.add(e)},removeOnHasAttachmentStatusChangedCallback:function(e){this._onHasAttachmentStatusChangedCallbacks.remove(e)},addOnHasUnreadAttachmentStatusChangedCallback:function(e){this._onHasUnreadAttachmentStatusChangedCallbacks.add(e)},removeOnHasUnreadAttachmentStatusChangedCallback:function(e){this._onHasUnreadAttachmentStatusChangedCallbacks.remove(e)},addOnIsPrivateStatusChangedCallback:function(e){this._onIsPrivateStatusChangedCallbacks.add(e)},removeOnIsPrivateStatusChangedCallback:function(e){this._onIsPrivateStatusChangedCallbacks.remove(e)},addOnDoNotForwardStatusChangedCallback:function(e){this._onDoNotForwardStatusChangedCallbacks.add(e)},removeOnDoNotForwardStatusChangedCallback:function(e){this._onDoNotForwardStatusChangedCallbacks.remove(e)},addOnIsReadStatusChangedCallback:function(e){this._onIsReadStatusChangedCallbacks.add(e)},removeOnIsReadStatusChangedCallback:function(e){this._onIsReadStatusChangedCallbacks.remove(e)},addOnStatusChangedCallback:function(e){this._onStatusChangedCallbacks.add(e)},removeOnStatusChangedCallback:function(e){this._onStatusChangedCallbacks.remove(e)},addOnImportanceChangedCallback:function(e){this._onImportanceChangedCallbacks.add(e)},removeOnImportanceChangedCallback:function(e){this._onImportanceChangedCallbacks.remove(e)},addOnSensitivityChangedCallback:function(e){this._onSensitivityChangedCallbacks.add(e)},removeOnSensitivityChangedCallback:function(e){this._onSensitivityChangedCallbacks.remove(e)}})}(AvayaClientServices),function(i){"use strict";var e={getUpdateBodyCapability:function(){return this._updateBodyCapability},_recalculateUpdateBodyCapability:function(){var e,t;t=this._messageService.isServiceAvailable()&&this.resourceStatus===i.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateBodyCapability._updateIfChanged(e,t)},getUpdateSensitivityCapability:function(){return this._updateSensitivityCapability},_recalculateUpdateSensitivityCapability:function(){var e,t;t=this._messageService.isServiceAvailable()&&this.conversation.resourceStatus===i.Services.Messaging.ResourceStatus.DRAFT_UNSENT&&this.resourceStatus===i.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateSensitivityCapability._updateIfChanged(e,t)},getUpdateInReplyToCapability:function(){return this._updateInReplyToCapability},_recalculateUpdateInReplyToCapability:function(){var e,t;t=this._messageService.isServiceAvailable()&&this.resourceStatus===i.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateInReplyToCapability._updateIfChanged(e,t)},getUpdateDoNotForwardCapability:function(){return this._updateDoNotForwardCapability},_recalculateUpdateDoNotForwardCapability:function(){var e,t;t=this._messageService.isServiceAvailable()?(e=!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateDoNotForwardCapability._updateIfChanged(e,t)},getUpdateImportanceCapability:function(){return this._updateImportanceCapability},_recalculateUpdateImportanceCapability:function(){var e,t;t=this._messageService.isServiceAvailable()&&this.resourceStatus===i.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateImportanceCapability._updateIfChanged(e,t)},getCreateAttachmentCapability:function(e){return this._createAttachmentCapability},_recalculateCreateAttachmentCapability:function(){var e,t;t=this._messageService.isServiceAvailable()&&this.resourceStatus===i.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createAttachmentCapability._updateIfChanged(e,t)},getSendCapability:function(){return this._sendCapability},_recalculateSendCapability:function(){var e,t;t=this._messageService.isServiceAvailable()&&this.resourceStatus===i.Services.Messaging.ResourceStatus.DRAFT_UNSENT&&this.conversation.active&&!this.conversation.closed?(e=!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._sendCapability._updateIfChanged(e,t)},getMarkAsReadCapability:function(){return this._markAsReadCapability},_recalculateMarkAsReadCapability:function(){var e,t;t=!this._messageService.isServiceAvailable()||this.read?(e=!1,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(e=!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._markAsReadCapability._updateIfChanged(e,t)},getRemoveCapability:function(){return this._removeCapability},_recalculateRemoveCapability:function(){var e,t;t=this._messageService.isServiceAvailable()&&this.resourceStatus===i.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeCapability._updateIfChanged(e,t)}};T.extend(i.Services.Messaging.Message.prototype,e)}(AvayaClientServices),function(t){"use strict";function e(e){this._messagingService=e,this._isAvailable=m,this._onMessagingLimitsChangedCallbacks=T.Callbacks(),this._onRoutableDomainsChangedCallbacks=T.Callbacks(),this._onNumberOfConversationsWithUnreadContentChangedCallbacks=T.Callbacks(),this._onNumberOfConversationsWithUnreadContentSinceLastAccessChangedCallbacks=T.Callbacks(),this._onMessagingServiceUnavailableCallbacks=T.Callbacks(),this._onMessagingServiceAvailableCallbacks=T.Callbacks(),this._retrieveConversationsCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._startServiceCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createConversationCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._searchConversationsCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateRefreshIntervalCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._validateParticipantAddressesCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._markContentAsReadCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._clearLocalDataCapability=new t.Base.Capability(t.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._messagingUnavailableReason=m}e.prototype={getRoutableDomains:function(){return this._messagingService.getRoutableDomains()},getSelfAddress:function(){return this._messagingService.getSelfAddress()},getNumberOfConversationsWithUnreadContentSinceLastAccess:function(){return this._messagingService.getNumberOfConversationsWithUnreadContentSinceLastAccess()},getNumberOfConversationsWithUnreadContent:function(){return this._messagingService.getNumberOfConversationsWithUnreadContent()},createConversation:function(){return this._messagingService.createConversation(this)},getActiveConversations:function(){return this._messagingService.getActiveConversations(this)},getDraftConversations:function(){return this._messagingService.getDraftConversations()},getConversationIds:function(){return this._messagingService.getConversationIds()},searchConversations:function(e){return t.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:t.Services.Messaging.MessagingQuery}]}),this._messagingService.searchConversations(e,this)},getAllActiveConversationsForContact:function(e){},validateAddresses:function(e){return t.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:Array},{type:"arrayElementType",expected:"string"}]}),this._messagingService.validateUsers(e)},leaveConversations:function(e){return t.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:Array},{type:"arrayElementType",expected:t.Services.Messaging.Conversation}]}),this._messagingService.leaveConversations(e)},leaveAllConversations:function(){return this._messagingService.leaveAllConversations()},start:function(e){return this._startDfd=T.Deferred(),this._messagingService.start(this,e),this._startDfd.promise()},stop:function(){return this._messagingService.stop(this)},_stopImmediately:function(){return this._messagingService._stopImmediately(this)},removeConversation:function(e){return t.Base.Utils.validate(e,{validators:[{type:"defined"},{type:"type",expected:t.Services.Messaging.Conversation}]}),this._messagingService.removeConversation(e)},_fireMessagingAvailableCallback:function(){!t.Base.Utils.isUndefined(this._isAvailable)&&this._isAvailable||(this._isAvailable=!0,this._messagingUnavailableReason=m,this._startDfd.state()===t.Base.DeferredStates.PENDING&&this._startDfd.resolve(),this._onMessagingServiceAvailableCallbacks.fire(this))},_fireMessagingUnavailableCallback:function(e){(t.Base.Utils.isUndefined(this._isAvailable)||this._isAvailable)&&(this._isAvailable=!1,this._messagingUnavailableReason=e,this._startDfd.state()===t.Base.DeferredStates.PENDING&&this._startDfd.reject(),this._onMessagingServiceUnavailableCallbacks.fire(this))}},t.Base.AOPTools.addAdvices(e,"Messaging",["createConversation","getActiveConversations","searchConversations"],[t.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS]),t.Base.AOPTools.addAdvices(e,"Messaging",["validateAddresses","leaveConversations","leaveAllConversations","removeConversation"],[t.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS,t.Base.AOPCommonAdvices.WRAP_CAUGHT_MESSAGING_ERROR]),t.Services.Messaging.Messaging=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Messaging.Messaging.prototype,{addOnMessagingLimitsChangedCallback:function(e){this._onMessagingLimitsChangedCallbacks.add(e)},removeOnMessagingLimitsChangedCallback:function(e){this._onMessagingLimitsChangedCallbacks.remove(e)},addOnRoutableDomainsChangedCallback:function(e){this._onRoutableDomainsChangedCallbacks.add(e)},removeOnRoutableDomainsChangedCallback:function(e){this._onRoutableDomainsChangedCallbacks.remove(e)},addOnNumberOfConversationsWithUnreadContentChangedCallback:function(e){this._onNumberOfConversationsWithUnreadContentChangedCallbacks.add(e)},removeOnNumberOfConversationsWithUnreadContentChangedCallback:function(e){this._onNumberOfConversationsWithUnreadContentChangedCallbacks.remove(e)},addOnNumberOfConversationsWithUnreadContentSinceLastAccessChangedCallback:function(e){this._onNumberOfConversationsWithUnreadContentSinceLastAccessChangedCallbacks.add(e)},removeOnNumberOfConversationsWithUnreadContentSinceLastAccessChangedCallback:function(e){this._onNumberOfConversationsWithUnreadContentSinceLastAccessChangedCallbacks.remove(e)},addOnMessagingServiceUnavailableCallback:function(e){this._onMessagingServiceUnavailableCallbacks.add(e)},removeOnMessagingServiceUnavailableCallback:function(e){this._onMessagingServiceUnavailableCallbacks.remove(e)},addOnMessagingServiceAvailableCallback:function(e){this._onMessagingServiceAvailableCallbacks.add(e)},removeOnMessagingServiceAvailableCallback:function(e){this._onMessagingServiceAvailableCallbacks.remove(e)}})}(AvayaClientServices),function(a){"use strict";var e={getStartServiceCapability:function(){return this._startServiceCapability},_recalculateStartServiceCapability:function(){var e,t;t=this._isAvailable?(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE):(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED),this._startServiceCapability._updateIfChanged(e,t)},getCreateConversationCapability:function(){return this._createConversationCapability},_recalculateCreateConversationCapability:function(){var e,t;t=this._isAvailable?this._messagingService.getConversationResource()?(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._createConversationCapability._updateIfChanged(e,t)},getRetrieveConversationsCapability:function(){return this._retrieveConversationsCapability},_recalculateRetrieveConversationsCapability:function(){var e,t;t=this._isAvailable&&this._messagingService.getConversationResource()?(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._retrieveConversationsCapability._updateIfChanged(e,t)},getSearchConversationsCapability:function(){return this._searchConversationsCapability},_recalculateSearchConversationsCapability:function(){var e,t;t=this._isAvailable?this._messagingService.getConversationResource()?(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._searchConversationsCapability._updateIfChanged(e,t)},getValidateParticipantAddressesCapability:function(){return this._validateParticipantAddressesCapability},_recalculateValidateParticipantAddressCapability:function(){var e,t,i=this._isAvailable;t=i&&this._messagingService.getValidateAddressResource()?(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):i&&!this._messagingService.getValidateAddressResource()?(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._validateParticipantAddressesCapability._updateIfChanged(e,t)},getMarkContentAsReadCapability:function(){return this._markContentAsReadCapability},_recalculateMarkContentAsReadCapability:function(){var e,t,i=this._isAvailable;t=i&&this._messagingService.getMarkAsReadResource()?(e=!0,a.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):i&&!this._messagingService.getMarkAsReadResource()?(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_NOT_SUPPORTED):(e=!1,a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._markContentAsReadCapability._updateIfChanged(e,t)}};T.extend(a.Services.Messaging.Messaging.prototype,e)}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Services.Participant.call(this),this._address=e._address,this._localUser=t,this.type=e.type,this.givenName=e.givenName,this.language=e.language,this.modalities=e.modalities,this.nativeGivenName=e.nativeGivenName,this.nativeSurname=e.nativeSurname,this.surname=e.surname}(e.prototype=Object.create(i.Services.Participant.prototype)).getType=function(){return this.type},e.prototype.getAddress=function(){return this._address},e.prototype.getGivenName=function(){return this.givenName},e.prototype.getSurname=function(){return this.nativeSurname},e.prototype.getDisplayName=function(){return this._displayName&&""!==this._displayName?this._displayName:this.givenName||this.surname?this.surname?this.givenName?this.givenName+" "+this.surname:this.surname:this.givenName:this._address},e.prototype.getSupportedModalities=function(){return this.modalities},e.prototype.isSelf=function(){return this.self},i.Services.Messaging.Participant=e}(AvayaClientServices),function(i){"use strict";function e(e){this._presenceProvider=e,this._userAddresses=[],this._internalAddresses=[],this._selfAddress=m,this._onPresenceNotification=m,this._onStartedCallbacks=T.Callbacks(),this._onStoppedCallbacks=T.Callbacks(),this._onPresenceReceivedCallbacks=T.Callbacks(),this._onInternalPresenceReceivedCallbacks=T.Callbacks(),this._onSelfPresenceReceivedCallbacks=T.Callbacks()}e.prototype={addAddress:function(e){return this._subscribe(e).then(function(){this._userAddresses.push(e)}.bind(this))},_addInternalAddress:function(e){return this._subscribe(e).then(function(){this._internalAddresses.push(e)}.bind(this))},_subscribe:function(e){return e&&""!==e.trim()?(i.Base.Logger.debug(i.Base.LoggerTags.PRESENCE_SERVICE,"Subscribing for presence",e),this._presenceProvider.subscribeForSingleAddressPresence(e)):(i.Base.Logger.error(i.Base.LoggerTags.PRESENCE_SERVICE,"Subscription was requested for empty/undefined address",e),T.Deferred().reject(new i.Services.Presence.PresenceError(i.Services.Presence.PresenceErrorReason.INVALID_REQUEST)).promise())},_setSelfAddress:function(e){this._selfAddress=e},removeAddress:function(t){return this._userAddresses=this._userAddresses.filter(function(e){return t!==e},this),this._presenceProvider.unsubscribeFromSingleAddressPresence(t)},_removeInternalAddress:function(t){return this._internalAddresses=this._internalAddresses.filter(function(e){return t!==e},this),this._presenceProvider.unsubscribeFromSingleAddressPresence(t)},_start:function(){return this._onPresenceNotification=function(e){var t=e.getPresentity();i.Base.Logger.debug(i.Base.LoggerTags.PRESENCE_SERVICE,"Received presence information",t),this._selfAddress===t&&(e=T.extend(new i.Services.Presence.SelfPresence,e),this._onSelfPresenceReceivedCallbacks.fire(e)),-1!==this._userAddresses.indexOf(t)&&this._onPresenceReceivedCallbacks.fire(this,e),-1!==this._internalAddresses.indexOf(t)&&this._onInternalPresenceReceivedCallbacks.fire(e)}.bind(this),this._presenceProvider.on(i.Providers.Interfaces.PresenceProviderCallbackIds.PRESENCE_NOTIFICATION,this._onPresenceNotification),this._presenceProvider.subscribeForPresence([this._selfAddress]).then(function(){this._onStartedCallbacks.fire()}.bind(this))},_stop:function(){return this._presenceProvider.unsubscribeFromAllAddressesPresence().always(function(){this._onStoppedCallbacks.fire(),this._onStartedCallbacks.empty(),this._onStoppedCallbacks.empty(),this._onPresenceReceivedCallbacks.empty(),this._onInternalPresenceReceivedCallbacks.empty(),this._onSelfPresenceReceivedCallbacks.empty()}.bind(this))}},i.Base.AOPTools.addAdvices(e,"PresenceListSubscription",["addAddress","removeAddress"],[i.Base.AOPCommonAdvices.LOG_PRESENCE_API_CALLS,i.Base.AOPCommonAdvices.WRAP_CAUGHT_PRESENCE_ERROR]),i.Services.Presence.PresenceListSubscription=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Presence.PresenceListSubscription.prototype,{addOnStartedCallback:function(e){this._onStartedCallbacks.add(e)},removeOnStartedCallback:function(e){this._onStartedCallbacks.remove(e)},addOnStoppedCallback:function(e){this._onStoppedCallbacks.add(e)},removeOnStoppedCallback:function(e){this._onStoppedCallbacks.remove(e)},addOnPresenceReceivedCallback:function(e){this._onPresenceReceivedCallbacks.add(e)},removeOnPresenceReceivedCallback:function(e){this._onPresenceReceivedCallbacks.remove(e)},_addOnInternalPresenceReceivedCallback:function(e){this._onInternalPresenceReceivedCallbacks.add(e)},_removeOnInternalPresenceReceivedCallback:function(e){this._onInternalPresenceReceivedCallbacks.remove(e)},_addOnSelfPresenceReceivedCallback:function(e){this._onSelfPresenceReceivedCallbacks.add(e)},_removeOnSelfPresenceReceivedCallback:function(e){this._onSelfPresenceReceivedCallbacks.remove(e)}})}(AvayaClientServices),function(i){"use strict";function e(e){this._presenceProvider=e,this._selfPresenceManagedExternally=!1,this._selfPresence=m,this._selfAddress=m,this._phoneAndVideoChannelAddress=m,this._presenceSubscriptions=new i.Services.Presence.PresenceListSubscription(this._presenceProvider),this._onSelfPresenceNotification=m,this._onNetworkAvailable=m,this._onNetworkUnavailable=m,this._available=m,this._starting=!1,this._started=!1,this._onSelfPresenceReceivedCallbacks=T.Callbacks(),this._onPresenceServiceAvailableCallbacks=T.Callbacks(),this._onPresenceServiceUnavailableCallbacks=T.Callbacks()}e.prototype={publishAutomaticPresence:function(){return this._selfPresence?(this._selfPresence._setPhoneContact(this._phoneAndVideoChannelAddress),this._selfPresence._setVideoContact(this._phoneAndVideoChannelAddress),this._selfPresence._setEnterpriseIMContact(this._selfAddress),this._presenceProvider.publishAutomaticPresence(this._selfPresence)):T.Deferred().reject(new i.Services.Presence.PresenceError(i.Services.Presence.PresenceErrorReason.INVALID_STATE))},publishManualState:function(e){return this._presenceProvider.publishManualState(e)},publishLocationMode:function(e){return this._presenceProvider.publishLocationMode(e)},publishNote:function(e){return this._presenceProvider.publishNote(e)},getPresenceListSubscription:function(){return this._presenceSubscriptions},getSelfPresence:function(){return i.Base.Logger.warn(i.Base.LoggerTags.PRESENCE_SERVICE,"Deprecated function is called: getSelfPresence()"),this._selfPresence},start:function(e){return this._startDfd=T.Deferred(),i.Base.Logger.info(i.Base.LoggerTags.PRESENCE_SERVICE,"Starting the service"),this._onSelfPresenceNotification=function(e){this._selfPresenceManagedExternally||(this._selfPresence=e,this._onSelfPresenceReceivedCallbacks.fire(this,e))}.bind(this),this._subscribeForProvidersNotifications(),this._starting=!0,this._presenceProvider.start(e).then(function(){return this._selfPresenceManagedExternally||(this._selfAddress=this._phoneAndVideoChannelAddress=e.sgConfiguration.credentialProvider.username),this._presenceSubscriptions._addOnSelfPresenceReceivedCallback(this._onSelfPresenceNotification),this._presenceSubscriptions._setSelfAddress(this._selfAddress),this._presenceSubscriptions._start()}.bind(this)).then(function(){this._starting=!1,this._started=!0,this._onServiceAvailable(),i.Base.Logger.info(i.Base.LoggerTags.PRESENCE_SERVICE,"Service started successfully")}.bind(this),function(e){this._starting=!1,i.Base.Logger.error(i.Base.LoggerTags.PRESENCE_SERVICE,"Failed to start service",e)}.bind(this)),this._startDfd.promise()},stop:function(){i.Base.Logger.info(i.Base.LoggerTags.PRESENCE_SERVICE,"Stopping the service"),this._unsubscribeFromProvidersNotifications(),this._onServiceUnavailable();var t=T.Deferred();return this._presenceSubscriptions._stop().always(function(){this._presenceProvider.stop().then(function(){i.Base.Logger.info(i.Base.LoggerTags.PRESENCE_SERVICE,"Service stopped successfully"),t.resolve()},function(e){i.Base.Logger.error(i.Base.LoggerTags.PRESENCE_SERVICE,"Failed to stop service",e),t.reject(e)}).always(function(){this._onSelfPresenceReceivedCallbacks.empty(),this._onPresenceServiceAvailableCallbacks.empty(),this._onPresenceServiceUnavailableCallbacks.empty(),this._presenceSubscriptions._removeOnSelfPresenceReceivedCallback(this._onSelfPresenceNotification),this._started=!1}.bind(this))}.bind(this)),t.promise()},_stopImmediately:function(){return i.Base.Logger.info(i.Base.LoggerTags.PRESENCE_SERVICE,"Stopping the service"),this._started=!1,this._onServiceUnavailable(),i.Base.Logger.info(i.Base.LoggerTags.PRESENCE_SERVICE,"Service stopped successfully"),T.Deferred().resolve().promise()},_setSelfPresence:function(e,t,i){this._selfPresenceManagedExternally=!0,this._selfPresence=e,this._selfAddress=t,this._phoneAndVideoChannelAddress=i},_onServiceAvailable:function(){!this._available&&this._started&&(this._available=!0,i.Base.Logger.info(i.Base.LoggerTags.PRESENCE_SERVICE,"Service is available"),this._startDfd.state()===i.Base.DeferredStates.PENDING&&this._startDfd.resolve(),this._onPresenceServiceAvailableCallbacks.fire(this))},_onServiceUnavailable:function(){(this._available||this._starting)&&(this._available=!1,i.Base.Logger.info(i.Base.LoggerTags.PRESENCE_SERVICE,"Service is unavailable"),this._starting&&(this._starting=!1),this._startDfd.state()===i.Base.DeferredStates.PENDING&&this._startDfd.reject(),this._onPresenceServiceUnavailableCallbacks.fire(this))},_subscribeForProvidersNotifications:function(){this._started||this._starting||(this._onNetworkAvailable=this._onServiceAvailable.bind(this),this._onNetworkUnavailable=this._onServiceUnavailable.bind(this),this._presenceProvider.on(i.Base.NetworkProviderEvents.UNAUTHORIZED,this._onNetworkUnavailable),this._presenceProvider.on(i.Base.NetworkProviderEvents.AUTHORIZED,this._onNetworkAvailable),this._presenceProvider.on(i.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,this._onNetworkUnavailable),this._presenceProvider.on(i.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,this._onNetworkAvailable))},_unsubscribeFromProvidersNotifications:function(){this._started&&(this._presenceProvider.off(i.Base.NetworkProviderEvents.UNAUTHORIZED,this._onNetworkUnavailable),this._presenceProvider.off(i.Base.NetworkProviderEvents.AUTHORIZED,this._onNetworkAvailable),this._presenceProvider.off(i.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,this._onNetworkUnavailable),this._presenceProvider.off(i.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE,this._onNetworkAvailable),this._onNetworkAvailable=m,this._onNetworkUnavailable=m)}},i.Base.AOPTools.addAdvices(e,"PresenceService",["publishAutomaticPresence","publishManualState","publishLocationMode","publishNote"],[i.Base.AOPCommonAdvices.LOG_PRESENCE_API_CALLS,i.Base.AOPCommonAdvices.WRAP_CAUGHT_PRESENCE_ERROR]),i.Services.Presence.PresenceService=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Presence.PresenceService.prototype,{addOnSelfPresenceReceivedCallback:function(e){this._onSelfPresenceReceivedCallbacks.add(e)},removeOnSelfPresenceReceivedCallback:function(e){this._onSelfPresenceReceivedCallbacks.remove(e)},addOnPresenceServiceAvailableCallback:function(e){this._onPresenceServiceAvailableCallbacks.add(e)},removeOnPresenceServiceAvailableCallback:function(e){this._onPresenceServiceAvailableCallbacks.remove(e)},addOnPresenceServiceUnavailableCallback:function(e){this._onPresenceServiceUnavailableCallbacks.add(e)},removeOnPresenceServiceUnavailableCallback:function(e){this._onPresenceServiceUnavailableCallbacks.remove(e)}})}(AvayaClientServices),function(n){"use strict";function e(e){n.Base.WebSocketProvider.apply(this),this._parentLoggerTag=e,this._networkLogger=new n.Base.NetworkLogger(e),this._deferreds={},this._transactionIDLocation=""}(e.prototype=Object.create(n.Base.WebSocketProvider.prototype)).start=function(e,t,i,a,r){return i&&i.transactionIDLocation&&(this._transactionIDLocation=i.transactionIDLocation),n.Base.WebSocketProvider.prototype.start.call(this,e,t,i,a,r,this._handleOnMessage.bind(this))},e.prototype._handleOnMessage=function(t){var e,i,a,r=!0,s=!1;if(t.data instanceof ArrayBuffer==!1)try{e=this.parseResponse(t.data),n.Base.Utils.isDefined(this._failoverPingData)&&this._failoverPingData.wsKeepAliveEnabled&&this._failoverPingData.wsIsPongMessage(e)&&(clearTimeout(this._keepAliveAnswerWaitingTimeout),this._keepAliveAnswerWaitingTimeout=m,this._keepAlive(),s=!0),i=this.getTransactionIDFromResponse(e,this._transactionIDLocation),a=this._deferreds[i]}catch(e){"string"==typeof t.data&&n.Base.Logger.error(n.Base.LoggerTags.WEBSOCKET_NETWORK_PROVIDER,this._parentLoggerTag,e)}i&&a&&(s||this._networkLogger.logRecvMessage(t.data,m),n.Base.Logger.debug(n.Base.LoggerTags.WEBSOCKET_NETWORK_PROVIDER,this._parentLoggerTag,"Resolving message "+e.name+" with transId "+i),delete this._deferreds[i],r=!1,a.resolve(e)),r&&this.onMessage(t)},e.prototype.parseMessage=function(e){return JSON.parse(e)},e.prototype.send=function(e,t,i){var a=T.Deferred(),r=this.getTransactionIDFromRequest(this.parseRequest(e),this._transactionIDLocation);return r&&(this._deferreds[r]=a),n.Base.WebSocketProvider.prototype.send.call(this,e,t,i).then(function(){r||a.resolve()},function(e){a.reject(e)}),a.promise()},e.prototype.close=function(){for(var e in this._deferreds)if(this._deferreds.hasOwnProperty(e)){var t=this._deferreds[e];n.Base.Utils.isDefined(t)&&t.reject({message:"Request aborted due to close request"})}return this._deferreds={},n.Base.WebSocketProvider.prototype.close.call(this)},e.prototype._getTransactionID=function(e,t){return n.Base.Utils.queryJSONObject(e,t)},e.prototype.getTransactionIDFromResponse=function(e,t){return this._getTransactionID(e,t)},e.prototype.getTransactionIDFromRequest=function(e,t){return this._getTransactionID(e,t)},e.prototype.parseRequest=function(e){return this.parseMessage(e)},e.prototype.parseResponse=function(e){return this.parseMessage(e)},e.prototype.registerBlackList=function(e){this._networkLogger.registerBlackList(e)},n.Base.TransactionalWebSocketProvider=e}(AvayaClientServices),function(u){"use strict";var t,i,r=[];r.type=new u.Base.Validators.TypeValidator,r.arrayElementType=new u.Base.Validators.ArrayElementTypeValidator,r.defined=new u.Base.Validators.DefinedValidator;var a=window.crypto||window.msCrypto;u.Base.Utils={isUndefined:function(e){return void 0===e},isDefined:function(e){return void 0!==e},validate:function(t,e,i){if(e.optional&&void 0===t)return!1;var a=!0;return e.validators.forEach(function(e){if(u.Base.Utils.isUndefined(r[e.type]))throw new Error("Validator of specified type does not exist.");a=a&&r[e.type].validate(t,e,i)}.bind(this)),a},makeId:function(e,t){var i;e||(e=10),i=t||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var a="",r=0;r<e;r++)a+=i.charAt(Math.floor(Math.random()*i.length));return a},clean:function(e,t){for(var i=0;i<e.length;i++)e[i]===t&&(e.splice(i,1),i--);return e},queryJSONObject:function(e,t){if(null==e)return m;var i=e,a=t.match(/(\w+)/g);if(!a)return m;for(var r=0;r<a.length;r++){var s=i[a[r]];if(!u.Base.Utils.isDefined(s)||null===s)return m;i=s}return i},getBrowserType:function(){if(t!==m)return t;if(t=u.Base.BrowserType.UNKNOWN,window.chrome&&-1<document.location.href.indexOf("chrome-extension"))t=u.Base.BrowserType.CHROME_EXTENSION;else if(window.chrome&&-1===window.navigator.userAgent.indexOf("Edge"))t=u.Base.BrowserType.CHROME;else if("undefined"!=typeof InstallTrigger)t=u.Base.BrowserType.FIREFOX;else if(window.chrome&&-1<document.location.href.indexOf("moz-extension"))t=u.Base.BrowserType.FIREFOX_EXTENSION;else if(-1!==window.navigator.userAgent.indexOf("Safari")&&-1===window.navigator.userAgent.indexOf("Chrome")&&-1===window.navigator.userAgent.indexOf("Edge"))t=u.Base.BrowserType.SAFARI;else{var e=!!document.documentMode;!e&&window.StyleMedia?t=u.Base.BrowserType.EDGE:e&&(t=u.Base.BrowserType.IE)}return t},getBrowserName:function(){if(i===m){var e=this.getBrowserType();i=e[0].toUpperCase()+e.toLowerCase().slice(1)}return i},isWebRTC_SupportedBrowser:function(e){var t=this.getBrowserType();if(this.isDefined(e)&&-1!==e.indexOf(t))return!1;var i=t===u.Base.BrowserType.CHROME||t===u.Base.BrowserType.CHROME_EXTENSION||t===u.Base.BrowserType.FIREFOX||t===u.Base.BrowserType.FIREFOX_EXTENSION||t===u.Base.BrowserType.EDGE||t===u.Base.BrowserType.SAFARI,a=[u.Base.BrowserType.EDGE,u.Base.BrowserType.SAFARI];return i&&~a.indexOf(t)&&!window.RTCPeerConnection&&(i=!1),i&&t===u.Base.BrowserType.SAFARI&&(i=this.isSafariSupported(window.navigator.userAgent)),i},isSafariSupported:function(e){var t=e.match(/Version\/(\d+)\.\d+/);return!!t&&13<=t[1]},removeDuplicatesFromArray:function(e){return Array.isArray(e)?e.filter(function(e,t,i){return i.indexOf(e)===t}):m},parseUrl:function(t){if(t){var i;[/^(?:([^:/?#]+):)?\/\/(([^:\/?#]+\:\w*\@)??([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(?:\?)?([^#]*|)(?:#)?(.*|)$/,/^(?:([^:/?#]+):)?\/\/(([^:\/?#]+\:\w*\@)??([^:\/?#]*)(?:\:([0-9]+))?)$/].some(function(e){return i=t.match(e)});var e,a=i[4];return i[5]&&(a+=":"+i[5]),i[3]&&(e=i[3].slice(0,-1)),{url:i[0],protocol:i[1],host:a,credentials:e,hostname:i[4],port:parseInt(i[5]),path:i[6],query:i[7],hash:i[8],isSecure:!!i[1]&&("https"===i[1]||"wss"===i[1])}}return m},getHost:function(e){var t;return t=e.port===m||isNaN(e.port)?e.isSecure?"443":"80":e.port,e.hostname+":"+t},callFunction:function(t,i,a,r,s){var n=T.Deferred(),o=0;s=s||1e3;var c=function(e){setTimeout(function(){i.apply(t,a).then(function(){n.resolve()},function(e){o++,r&&r<o?n.reject(e):c(s)})},e)};return c(0),n.promise()},connectionBackoffAlgorithm:function(e,i,t){var a,r=T.Deferred(),s=0,n=-1,o=t||15e3,c=!1,l={dfdPromise:r.promise(),cancel:function(){c=!0,u.Base.Utils.isDefined(a)&&clearTimeout(a),u.Base.Utils.isDefined(r)&&r.state()===u.Base.DeferredStates.PENDING&&r.reject(u.Base.ErrorReasons.BACKOFF_ALGORITHM_CANCELLED)}},d=function(e){if(e<0)C();else{var t=o*Math.pow(2,e);s=12e4<t?12e4:Math.min(12e4,(Math.random()*(1-.8)+.8)*t),u.Base.Logger.debug(u.Base.LoggerTags.UTILS,"BackoffAlgorithm, ConsecutiveFailures: "+e+" Timeout: "+s+"msec"),i&&i(e),a=setTimeout(function(){C()},s)}};function C(){c||e().then(function(e){r.resolve(e)},function(e){e&&e.message===u.Base.ErrorReasons.NETWORK_AUTHORIZATION_CANCELED?r.reject(e):d(++n)})}return d(n),l},colorIntToHex:function(e){var t=parseInt(e).toString(16);return(t="#000000".substr(0,7-t.length)+t).toUpperCase()},concatArrayBuffers:function(e,t){var i=new Uint8Array(e.byteLength+t.byteLength);return i.set(new Uint8Array(e),0),i.set(new Uint8Array(t),e.byteLength),i.buffer},readAsByteArray:function(e){var t=T.Deferred(),i=new FileReader;return i.onload=function(){var e=new Uint8Array(i.result);t.resolve(e)},i.readAsArrayBuffer(e),t},getSingleByteArrayFromString:function(e){for(var t=new Uint8Array(e.length),i=0;i<e.length;++i)t[i]=255&e.charCodeAt(i);return t},stringToArrayBuffer:function(e){for(var t=new ArrayBuffer(e.length),i=new Uint8Array(t),a=0,r=e.length;a<r;a++)i[a]=e.charCodeAt(a);return t},createLocalMediaStream:function(e,t,r,i,a,s,n,o){u.Base.Logger.debug(u.Base.LoggerTags.UTILS,"The video resolution of the localStream has to be changed due to bandwidth management.");var c=r.localStream.getVideoTracks()[0];if(!c||"function"!=typeof c.applyConstraints){var l=e?e.getDeviceId():m,d=this.getVideoOptions(r.call.getVideoChannels(),t);return r._rtConnection.stopStream(r.localStream),i.getMediaServicesService().createLocalMediaStream(r.call.getCallId(),!0,d.enable,l,d.videoDeviceId,d.videoChannelId,a).then(function(e){var t=e.stream;e.videoResolution&&r._updateVideoResolution(e.videoResolution);var i=r.getAudioStream(),a=[];return t.getTracks().forEach(function(e){if(e.kind===u.Providers.Call.CallProvider.Constants.VIDEO_TRACK){var t=r.getVideoStreams()[0],i=t?t.direction:u.Services.Call.MediaDirection.INACTIVE;a.push(new u.Providers.Interfaces.VideoStream(e.id,i))}}),r.setAVStreams(i,a),r._rtConnection.removeStream(r.localStream),r.localStream=t,r._rtConnection.addStream(r.localStream),r.call.isAudioMuted()&&r._rtConnection.disableLocalAudioStreams(),s.call(m,r,o),e.videoResolution},function(e){n.call(m,r,e)})}i.getMediaServicesService().getUserMedia().updateStreamUsingApplyConstraints(c,a,r).always(function(){s.call(m,r,o)})},getVideoOptions:function(e,t){var i,a,r=!1;if(u.Base.Utils.isDefined(e))for(var s=0;s<e.length;s++)e[s]._getInternalRequestedDirection()!==u.Services.Call.MediaDirection.INACTIVE&&(r=!0,i=e[s].getChannelId(),t&&(a=t.getDeviceId()));return{enable:r,videoChannelId:i,videoDeviceId:a}},getBytesCount:function(e){for(var t,i=function(e,t){t=t||0;var i,a,r=e.charCodeAt(t);if(55296<=r&&r<=56319){if(i=r,a=e.charCodeAt(t+1),isNaN(a))throw"High surrogate not followed by low surrogate in fixedCharCodeAt()";return 1024*(i-55296)+(a-56320)+65536}return!(56320<=r&&r<=57343)&&r},a=0,r=0;r<e.length;r++){try{t=i(e,r)}catch(e){return 0}!1!==t&&(t<=127?a++:a+=t<=2047?2:t<=65535?3:t<=2097151?4:t<=67108863?5:6)}return a},isInteger:function(e){return(0^e)===e},generateUUID:void 0!==a&&void 0!==a.getRandomValues?function(){var e=new Uint16Array(8);a.getRandomValues(e);var t=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return t(e[0])+t(e[1])+"-"+t(e[2])+"-"+t(e[3])+"-"+t(e[4])+"-"+t(e[5])+t(e[6])+t(e[7])}:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},deepMerge:function(t,i){if(u.Base.Utils.isUndefined(t)&&u.Base.Utils.isDefined(i))return i;for(var a in i)try{i[a].constructor===Object?t[a]=u.Base.Utils.deepMerge(t[a],i[a]):t[a]=i[a]}catch(e){t[a]=i[a]}return t},rejectIfPromiseNotResolvedInTime:function(e,t,i,a){var r=T.Deferred(),s=setTimeout(function(){r.state()===u.Base.DeferredStates.PENDING&&(u.Base.Logger.warn(u.Base.LoggerTags.UTILS,"cancelIfPromiseNotResolvedInTime - Promise was not resolved in time"),r.reject(i),a&&a())},t);return e.then(function(e){r.state()===u.Base.DeferredStates.PENDING&&(r.resolve(e),clearInterval(s))},function(e){r.state()===u.Base.DeferredStates.PENDING&&(r.reject(e),clearInterval(s))},function(e){r.state()===u.Base.DeferredStates.PENDING&&r.notify(e)}),r.promise()},waitForAllPromisesCompletion:function(e){for(var t,i=T.Deferred(),a=0,r=function(){},s=function(e){return t||(t=e),T.Deferred().reject(e).promise()},n=function(e){i.notify(e)},o=function(){++a===e.length&&(t?i.reject(t):i.resolve())},c=0;c<e.length;c++)e[c].then(r,s,n).always(o);return i.promise()},isNotEmptyString:function(e){return!(!e||!e.trim())},isBool:function(e){return typeof e==typeof!0},includes:function(e,t){return Array.prototype.includes?t.includes(e):-1!==t.indexOf(e)},forEach:function(e,t,i){if(u.Base.Utils.isDefined(e.forEach))e.forEach(function(e){t.call(i,e)});else for(var a in e)if(e.hasOwnProperty(a)){var r=e[a];t.call(i,r)}},addToQueryString:function(e,t){return this.isUndefined(t)?e:~e.indexOf("?")?e+"&"+T.param(t):e+"?"+T.param(t)},normalizeAddress:function(e){var t=e.trim();return!1===/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)/.test(t)&&!0===/^(\+?)([0-9\s\.\-\(\)\*\#\,\;]+)$/.test(t)?t.replace(/[\s\-\.\(\)]/g,""):t}},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(t){var i=this;return function(){var e=Array.prototype.slice.call(arguments);return i.apply(t||null,e)}}),void 0===FileReader.prototype.readAsBinaryString&&(FileReader.prototype.readAsBinaryString=function(e){var r="",s=this,n=new FileReader;n.onload=function(e){for(var t=new Uint8Array(n.result),i=t.byteLength,a=0;a<i;a++)r+=String.fromCharCode(t[a]);s.content=r,T(s).trigger("onload")},n.readAsArrayBuffer(e)})}(AvayaClientServices),function(s){"use strict";function e(e,t,i,a){s.Base.Observable.call(this),this._requestBuilder=e,this._restProvider=t,this._restProvider._onCredentialsRequired=this.onCredentialsRequired.bind(this),this._notificationProvider=i,this._notificationProvider._onCredentialsRequired=this.onCredentialsRequired.bind(this),this._started=!1,this._acsAvailable=!1,this._acsConfig={},this._acsResources={},this._acsNotificationResources={},this._maxConnectionErrorCount=5,this._notificationsConfiguration=m,this._notificationPromises={},this._notificationHandlers={},this._eTag=null,this._refreshRestSessionIntervalId=m,this._refreshNotificationSessionIntervalId=m,this._startPromise=T.Deferred(),this._stopPromise=T.Deferred(),this._subscriptions={},this._failoverPingData={wsKeepAliveEnabled:!0,wsPingInterval:3e4,wsGeneratePingMessage:function(){var e=s.Base.Utils.makeId(32,"0123456789abcdef"),t={ping:{requestId:this._failoverPingData.wsPingMessageRequestId=e,version:"1"}};return JSON.stringify(t)}.bind(this),wsIsPongMessage:function(e){var t="string"==typeof e?JSON.parse(e):e;return s.Base.Utils.isDefined(t.pong)&&this._failoverPingData.wsPingMessageRequestId===t.pong.requestId}.bind(this),wsPingMessageRequestId:"",keepAliveAnswerWaitingTime:5e3,ssePingInterval:65e3},this._blackList=[],this._discoveryBackoffDataObject=m,this._contactsAnalyticsService=a,this._invalidateBackoffDataObject=m,this._maxSearchResultsTotal=m}(e.prototype=T.extend({},s.Base.Observable.prototype)).start=function(e,t){return!1===this._started&&(this._started=!0,this._startPromise=T.Deferred(),this._acsConfig=e,this._restProvider.onMessage=function(e,t){if(this._setAcsAvailable(!0),void 0!==t){var i=t.getResponseHeader("ETag");null!=i&&(this._eTag=i)}}.bind(this),this._restProvider.onError=function(){this._setAcsAvailable(!1),t._fireContactsUnavailableCallback(t)}.bind(this),this._restProvider.on(s.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(s.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._notificationProvider.on(s.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(s.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._restProvider.on(s.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(s.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),this._notificationProvider.on(s.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(s.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),this._restProvider.registerBlackList(this._blackList),this._notificationProvider.registerBlackList(this._blackList),this._restProvider.start(this._acsConfig.networkProviderConfiguration,this._acsConfig.credentialProvider),this.sendDiscoverResources().then(function(){this.createNotificationsConfig(),this.startNotificationProvider(t).then(function(){this._startRefreshingRestSession(),this._startRefreshingNotificationSession(),this._startPromise.resolve()}.bind(this),function(e){s.Base.Logger.error(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to start notification provider",e),this._started=!1,this._startPromise.reject(e)}.bind(this))}.bind(this))),this._startPromise.promise()},e.prototype.registerBlackList=function(e){this._blackList=e},e.prototype.stop=function(){if(!0===this._started){this._started=!1,this._stopPromise=T.Deferred(),s.Base.Utils.isDefined(this._discoveryBackoffDataObject)&&(this._discoveryBackoffDataObject.cancel(),this._discoveryBackoffDataObject=m),s.Base.Utils.isDefined(this._invalidateBackoffDataObject)&&(this._invalidateBackoffDataObject.cancel(),this._invalidateBackoffDataObject=m),this._restProvider.onClose=function(){this._setAcsAvailable(!1),this._stopRefreshingRestSession(),this._stopRefreshingNotificationSession(),this._acsResources={},this._eTag=null,this._stopPromise.resolve()}.bind(this),this._notificationProvider.onClose=function(){this._notificationPromises={},this._notificationHandlers={};try{this._restProvider.close()}catch(e){this._stopPromise.reject(e)}}.bind(this);try{this._notificationProvider.close()}catch(e){this._stopPromise.reject(e)}}return this._stopPromise.promise()},e.prototype.stopIfNoSubscriptions=function(){return Object.keys(this._subscriptions).length?T.Deferred().resolve().promise():this.stop()},e.prototype._startRefreshingRestSession=function(){this._refreshRestSessionIntervalId===m?this._refreshRestSessionIntervalId=setInterval(function(){this.sendRefreshRestSession().then(function(){s.Base.Logger.info(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Successfully refreshed auth session")},function(e){s.Base.Logger.warn(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to refresh auth session",e)})}.bind(this),1e3*(this._acsResources.sessionManagement.timeout||900)*.8):s.Base.Logger.warn(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Auth session refreshing is already active")},e.prototype._stopRefreshingRestSession=function(){this._refreshRestSessionIntervalId!==m?(clearInterval(this._refreshRestSessionIntervalId),this._refreshRestSessionIntervalId=m):s.Base.Logger.warn(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Auth session refreshing is not active")},e.prototype._startRefreshingNotificationSession=function(){this._refreshNotificationSessionIntervalId===m?this._refreshNotificationSessionIntervalId=setInterval(function(){this.sendRefreshNotificationSession().then(function(){s.Base.Logger.info(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Successfully refreshed notification session")},function(e){s.Base.Logger.warn(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to refresh notification session",e)})}.bind(this),1e3*(this._notificationResources.sessionManagement.timeout||900)*.8):s.Base.Logger.warn(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Notification session refreshing is already active")},e.prototype._stopRefreshingNotificationSession=function(){this._refreshNotificationSessionIntervalId!==m?(clearInterval(this._refreshNotificationSessionIntervalId),this._refreshNotificationSessionIntervalId=m):s.Base.Logger.warn(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Notification session refreshing is not active")},e.prototype.sendDiscoverResources=function(){var i="",e=function(){return this.send(null,this._requestBuilder.buildResourcesOptions()).then(function(e,t){return i=t.getResponseHeader("Content-Type"),e})}.bind(this);return this._discoveryBackoffDataObject=s.Base.Utils.connectionBackoffAlgorithm(e),this._discoveryBackoffDataObject.dfdPromise.then(function(e){this._restProvider.onError=function(){},this._discoveryBackoffDataObject=m,this._parseResources(e,i)}.bind(this))},e.prototype.sendInvalidateSession=function(){var e=function(){return this.send(null,this._requestBuilder.buildInvalidateSessionOptions())}.bind(this);return this._invalidateBackoffDataObject=s.Base.Utils.connectionBackoffAlgorithm(e),this._invalidateBackoffDataObject.dfdPromise.then(function(){this._invalidateBackoffDataObject=m}.bind(this))},e.prototype.sendRefreshRestSession=function(){return this.send(null,this._requestBuilder.buildRefreshRestSessionOptions())},e.prototype.sendRefreshNotificationSession=function(){return this.send(null,this._requestBuilder.buildRefreshNotificationSessionOptions())},e.prototype.send=function(e,t){return this._restProvider.send(e,t).catch(function(e){return this._handleError(e)}.bind(this))},e.prototype._handleError=function(e){var t,i,a;return e instanceof s.Base.NetworkError&&e.getData()instanceof s.Base.NetworkErrorEvent&&(e=e.getData()),a=e instanceof s.Base.NetworkErrorEvent?this._handleNetworkErrorEvent(e):e instanceof s.Base.NetworkError?this._handleNetworkError(e):(t=s.Services.Contacts.ContactsErrorReason.UNKNOWN_REASON,i="Unknown error: {"+e+"}",this._contactsAnalyticsService.trackContactProvidersUnavailable(t),new s.Services.Contacts.ContactsError(t,i)),s.Base.Logger.warn(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Request failed",i),T.Deferred().reject(a).promise()},e.prototype._handleNetworkErrorEvent=function(e){var t,i,a=e.getStatus();switch(this._setAcsAvailable(!0),a){case 400:t=s.Services.Contacts.ContactsErrorReason.INVALID_CONTACT,i="Contact is invalid";break;case 401:t=s.Services.Contacts.ContactsErrorReason.AUTHENTICATION_FAILED,i="Authentication failed";break;case 404:t=s.Services.Contacts.ContactsErrorReason.CONTACT_NOT_FOUND,i="Contact was not found";break;case 408:case 504:t=s.Services.Contacts.ContactsErrorReason.REQUEST_TIMEOUT,i="Request to server has timed out",this._contactsAnalyticsService.trackContactProvidersUnavailable(t);break;case 409:t=s.Services.Contacts.ContactsErrorReason.DUPLICATE_CONTACT,i="Contact already exists";break;case 503:t=s.Services.Contacts.ContactsErrorReason.RETRY,i="Server is busy",this._contactsAnalyticsService.trackContactProvidersUnavailable(t);break;case 400001:t=s.Services.Contacts.ContactsErrorReason.SERVER_UNAVAILABLE,i="Connection failed",this._contactsAnalyticsService.trackContactProvidersUnavailable(t);break;default:400<=a&&a<500?(t=s.Services.Contacts.ContactsErrorReason.UNKNOWN_REASON,i="Unknown Client Error"):(500<=a&&a<600?(this._setAcsAvailable(!1),t=s.Services.Contacts.ContactsErrorReason.SERVER_UNAVAILABLE,i="Unknown ACS Server Error"):t=s.Services.Contacts.ContactsErrorReason.UNKNOWN_REASON,this._contactsAnalyticsService.trackContactProvidersUnavailable(t))}return new s.Services.Contacts.ContactsError(t,i)},e.prototype._handleNetworkError=function(e){var t,i;switch(e.message){case s.Base.ErrorReasons.NETWORK_AUTHORIZATION_CANCELED:t=s.Services.Contacts.ContactsErrorReason.AUTHENTICATION_CANCELLED,i=s.Base.ErrorReasons.NETWORK_AUTHORIZATION_CANCELED,this._contactsAnalyticsService.trackContactProvidersUnavailable(t);break;default:i=t=s.Services.Analytics.AnalyticsErrorCode.NETWORK_ERROR,this._contactsAnalyticsService.trackContactProvidersUnavailable(t)}return new s.Services.Contacts.ContactsError(t,i)},e.prototype.onCredentialsRequired=function(t,e){e&&e!==this._acsConfig.credentialProvider&&s.Base.Utils.deepMerge(this._acsConfig.credentialProvider,e),this._acsConfig.credentialProvider.onAuthenticationChallenge(void 0,function(e){this.onCredentialsRetrieved(e,t)}.bind(this))},e.prototype.onCredentialsRetrieved=function(e,t){if(s.Base.Utils.isDefined(t.options))if(t.options.headers=t.options.headers||{},e.token){var i=e.bearer||s.Config.Authentication.TokenType.UPTOKEN;t.options.wsSecureProtocolData=[i,e.token],t.options.headers.Authorization=s.Config.Authentication.Header.bearer(i,e.token)}else t.options.headers.Authorization=s.Config.Authentication.Header.basic(e.username,e.password)},e.prototype._parseResources=function(e,t){var i;switch(t){case this._requestBuilder._contentTypes.resourcesV2:i=new s.Providers.ACS.ResourcesV2;break;case this._requestBuilder._contentTypes.resourcesV1:i=new s.Providers.ACS.ResourcesV1;break;default:s.Base.Logger.error(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Unknown version of AADS was discovered. Returned Content-Type:",t),i=new s.Providers.ACS.ResourcesV2}this._acsResources=T.extend({},i,e),this._requestBuilder.setResources(this._acsResources),this._maxSearchResultsTotal=this._acsResources.resources.contacts&&this._acsResources.resources.contacts.GET.getContacts&&this._acsResources.resources.contacts.GET.getContacts.limits&&this._acsResources.resources.contacts.GET.getContacts.limits.maxSearchResultsTotal?this._acsResources.resources.contacts.GET.getContacts.limits.maxSearchResultsTotal:m},e.prototype.createNotificationsConfig=function(){var e=s.Base.Utils.parseUrl(this._acsResources.resources.notification.websocket.href),t=new s.Config.ServerInfo(e.hostname,e.port,e.isSecure,e.path),i=s.Base.Utils.parseUrl(this._acsResources.resources.notification.sse.href),a=new s.Config.ServerInfo(i.hostname,i.port,i.isSecure,i.path),r=new s.Config.ServerInfo;this._notificationsConfiguration=new s.Config.NetworkProviderConfiguration(r,t,a,this._maxConnectionErrorCount)},e.prototype.getETag=function(){return this._eTag},e.prototype.getResources=function(){return this._acsResources},e.prototype.startNotificationProvider=function(i){var a=T.Deferred();if(this._notificationProvider.isOpened())return a.resolve().promise();if(!this._notificationsConfiguration)return s.Base.Logger.error(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Notifications provider configuration is absent"),this._contactsAnalyticsService.trackContactProvidersUnavailable(s.Services.Contacts.ContactsErrorReason.INTERNAL_ERROR),a.reject(new s.Services.Contacts.ContactsError(s.Services.Contacts.ContactsErrorReason.INTERNAL_ERROR)).promise();this._notificationProvider.onOpen=function(){s.Base.Logger.debug(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Notifications provider has been started"),this._notificationProvider.onMessage=function(e){var t;(t=e.data&&e.type!==s.Base.ProvidersEventTypes.PING?JSON.parse(e.data):e).notification?this._onNotification(t.notification):t.discovery?(this._onNotificationDiscovery(t.discovery),this._setAcsAvailable(!0),this.trigger(s.Providers.ACS.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE),a.resolve(),i._fireContactsAvailableCallback(i)):t.subscribed&&this._onSubscribed(t.subscribed)}.bind(this)}.bind(this),this._notificationProvider.onError=function(e){s.Base.Logger.error(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Notification provider connection failed",e),this._setAcsAvailable(!1),this.trigger(s.Providers.ACS.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE),a.reject(new s.Base.NetworkError(s.Base.ErrorReasons.NETWORK_ERROR)),i._fireContactsUnavailableCallback(i)}.bind(this);var e=function(){var e=T.Deferred();return this._setAcsAvailable(!1),i._fireContactsUnavailableCallback(i),this._stopRefreshingRestSession(),this._stopRefreshingNotificationSession(),this.sendDiscoverResources().then(function(){this.createNotificationsConfig(),this.startNotificationProvider(i).then(function(){e.resolve(),this._startPromise.resolve(),this._startRefreshingRestSession(),this._startRefreshingNotificationSession(),this._resubscribeNotifications()}.bind(this),function(){e.reject()})}.bind(this),function(){e.reject()}.bind(this)),e.promise()}.bind(this);return this._notificationProvider.start(this._notificationsConfiguration,this._acsConfig.credentialProvider,m,m,e,this._failoverPingData).then(function(){return s.Base.Utils.rejectIfPromiseNotResolvedInTime(a.promise(),3e4,new s.Services.Contacts.ContactsError(s.Services.Contacts.ContactsErrorReason.REQUEST_TIMEOUT),function(){s.Base.Logger.error(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Notification discovery was not received in time"),i._fireContactsUnavailableCallback(i)})},function(){this._contactsAnalyticsService.trackContactProvidersUnavailable(s.Services.Contacts.ContactsErrorReason.CONTACTS_NOTIFICATIONS_CHANNEL_FAILED),s.Base.Logger.error(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Start notification channel failed.")}.bind(this)),a.promise()},e.prototype._onNotificationDiscovery=function(e){if(this._notificationResources=T.extend({},new s.Providers.ACS.NotificationResourcesV1,e),this._requestBuilder.setNotificationResources(this._notificationResources),this._notificationResources.commandURL){var t=s.Base.Utils.parseUrl(this._notificationResources.commandURL);this._notificationsConfiguration.restConfig.hostName=t.hostname,this._notificationsConfiguration.restConfig.port=t.port,this._notificationsConfiguration.restConfig.isSecure=t.isSecure,this._notificationsConfiguration.restConfig.path=t.path}},e.prototype._resubscribeNotifications=function(){this._subscriptions[s.Providers.ACS.ACSConstants.SVC_GET_CONTACTS]&&this.sendNotification(JSON.stringify(this._subscriptions[s.Providers.ACS.ACSConstants.SVC_GET_CONTACTS]),this._requestBuilder.buildNotificationsOptions()),this._subscriptions[s.Providers.ACS.ACSConstants.SVC_SEARCH_CONTACTS]&&this.sendNotification(JSON.stringify(this._subscriptions[s.Providers.ACS.ACSConstants.SVC_SEARCH_CONTACTS]),this._requestBuilder.buildNotificationsOptions())},e.prototype._onSubscribed=function(e){if(e.requestId&&e.results){var t=this._notificationPromises[e.requestId];if(t)if("acs"===s.Base.Utils.queryJSONObject(e,"results.successful[0].application"))t.resolve(),s.Base.Logger.debug(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Subscribed to "+s.Base.Utils.queryJSONObject(e,"results.successful[0].resource"));else if("acs"===s.Base.Utils.queryJSONObject(e,"results.failed[0].application")){var i=s.Base.Utils.queryJSONObject(e,"results.failed[0].error.description");s.Base.Logger.error(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Failed to subscribe for notifications",i),this._contactsAnalyticsService.trackContactProvidersUnavailable(s.Services.Contacts.ContactsErrorReason.SERVER_UNAVAILABLE),t.reject(new s.Services.Contacts.ContactsError(s.Services.Contacts.ContactsErrorReason.SERVER_UNAVAILABLE))}}},e.prototype._onNotification=function(e){if("acs"===e.application&&e.resource){var t=this._notificationHandlers[e.resource];t&&t(e.contents)}},e.prototype.subscribeForNotifications=function(e,t){var i=T.Deferred(),a=i.promise();return a.then(function(){this._notificationHandlers[e.subscribe.resources[0].resource]=t,this._subscriptions[e.subscribe.resources[0].service]=e}.bind(this)),this._notificationPromises[e.subscribe.requestId]=i,this.sendNotification(JSON.stringify(e),this._requestBuilder.buildNotificationsOptions()),s.Base.Utils.rejectIfPromiseNotResolvedInTime(a,3e4,new s.Services.Contacts.ContactsError(s.Services.Contacts.ContactsErrorReason.REQUEST_TIMEOUT),function(){s.Base.Logger.error(s.Base.LoggerTags.ACS_CONTACTS_PROVIDER,"Subscription confirmation was not received in time",e.subscribe.resources[0].resource)})},e.prototype.unsubscribeFromNotifications=function(e){return this.sendNotification(JSON.stringify(e),this._requestBuilder.buildNotificationsOptions()).always(function(){delete this._notificationHandlers[e.unsubscribe.resources[0].resource],delete this._subscriptions[e.unsubscribe.resources[0].service]}.bind(this))},e.prototype.sendNotification=function(e,t){return this._notificationProvider.isOpened()?this._notificationProvider.send(e,t).then(function(e){return e},function(e){return this._handleError(e)}.bind(this)):T.Deferred().reject(new s.Services.Contacts.ContactsError(s.Services.Contacts.ContactsErrorReason.CONTACTS_NOTIFICATIONS_CHANNEL_FAILED)).promise()},e.prototype.isAcsAvailable=function(){return this._acsAvailable},e.prototype.isStarted=function(){return this._started},e.prototype.getMaxSearchResultsTotal=function(){return this._maxSearchResultsTotal},e.prototype._setAcsAvailable=function(e){this._acsAvailable!==e&&(this._acsAvailable=e,this.trigger("acs_availability_changed"))},s.Providers.ACS.ACSNetworkProvider=e}(AvayaClientServices),function(d){"use strict";var a="attachment",r="inline",o="\r\n";function e(e,t){d.Providers.Interfaces.MessagingProvider.call(this),this._eTag="",this._conversationsLastModified=m,this._isStarted=!1,this._networkProvider=e,this._resources={},this._credentials=m,this._config={},this._ammMessagesParser=t,this._resourcesTypes={conversation:"application/vnd.avaya.aem.conversation.v1+json",conversationAccessTime:"application/vnd.avaya.aem.conversation.access.time.v1+json",conversationFlags:"application/vnd.avaya.aem.conversation.flags.v1+json",conversationIds:"application/vnd.avaya.aem.conversations.ids.v1+json",conversations:"application/vnd.avaya.aem.conversations.v1+json",entity:"application/vnd.avaya.aem.entity.v1+json",error:"application/vnd.avaya.aem.error.v1+json",event:"application/vnd.avaya.aem.event.v1+json",message:"application/vnd.avaya.aem.message.v1+json",messageFlags:"application/vnd.avaya.aem.message.flags.v1+json",messageIds:"application/vnd.avaya.aem.messageIds.v1+json",participants:"application/vnd.avaya.aem.participants.v1+json",resources:"application/vnd.avaya.aem.resources.v1+json",validatedAddresses:"application/vnd.avaya.aem.validatedAddresses.v2+json"},this._endpoints={conversations:"",validateAddresses:"",messages:"",outbox:"",markAsReadIf:"",markAsReadBatch:"",addresses:""},this._latestMessagesInConversations={},this._conversationsWithMissingMessages=[],this._needToGetMissingMessages=!1}(e.prototype=Object.create(d.Providers.Interfaces.MessagingProvider.prototype)).onCredentialsRequired=function(t,e){e&&e!==this._config.credentialProvider&&d.Base.Utils.deepMerge(this._config.credentialProvider,e),this._config.credentialProvider.onAuthenticationChallenge(void 0,function(e){this.onCredentialsRetrieved(e,t)}.bind(this))},e.prototype.onCredentialsRetrieved=function(e,t){this._credentials=e,t.options!==m&&(t.options.headers=t.options.headers||{},e.token?(e.bearer=e.bearer||d.Config.Authentication.TokenType.BEARER,t.options.headers.Authorization=d.Config.Authentication.Header.bearer(e.token,e.bearer)):t.options.headers.Authorization=d.Config.Authentication.Header.basic(e.username,e.password))},e.prototype.start=function(e){this._config=e,this._isStarted=!0},e.prototype.getConversations=function(e){var t=this._buildGetConversationsRequestOptions(e);return this._networkProvider.send(null,t).then(this._onGetConversationsRequestSent.bind(this),this._handleError.bind(this))},e.prototype._buildGetConversationsRequestOptions=function(e){var t=[this._resourcesTypes.conversations,this._resourcesTypes.error].join(", ");return d.Base.Utils.deepMerge(e,{url:this._endpoints.conversations,sendType:"GET",dataType:"JSON",headers:{Accept:t}})},e.prototype._onGetConversationsRequestSent=function(e){var t=this._ammMessagesParser.parse(d.Providers.AMM.AMMResponsesTypes.GET_CONVERSATIONS,e);return this._updateLatestMessagesInConversations(t.conversations),t},e.prototype.getConversationIds=function(){var e=T.Deferred();return e.reject(new d.Services.Messaging.MessagingError(d.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),e.promise()},e.prototype.getConversationsByQuery=function(e,t,i){var a=this._buildGetConversationsRequestOptions(i),r=t?this._getConversationsByIds(t,a):this._getConversationsByQuery(e,a);return r.then(function(e){this._needToGetMissingMessages?(this._updateConversationsWithMissingMessages(e),this._loadMissingMsgs.apply(this,arguments)):this._updateLatestMessagesInConversations(e.conversations)}.bind(this)),r},e.prototype._getConversationsByIds=function(e,t){return t.url+="?"+e.map(function(e){return"id="+e}).join("&"),this._networkProvider.send(null,t).then(this._onGetConversationsByQueryRequestSent.bind(this),this._handleError.bind(this))},e.prototype._getConversationsByQuery=function(e,t){return this._networkProvider.send(e,t).then(this._onGetConversationsByQueryRequestSent.bind(this),this._handleError.bind(this))},e.prototype._onGetConversationsByQueryRequestSent=function(e){return this._ammMessagesParser.parse(d.Providers.AMM.AMMResponsesTypes.GET_CONVERSATIONS,e)},e.prototype.parseResources=function(e){this._resources=e,this._config.endpoints={}},e.prototype.discoverResources=function(e){var t={urlSuffix:"/aem/resources",sendType:"GET",dataType:"JSON"};return t.headers={Accept:[this._resourcesTypes.resources,this._resourcesTypes.error].join(", ")},this._networkProvider.send(null,t).then(function(e){var t=this._ammMessagesParser.parse(d.Providers.AMM.AMMResponsesTypes.DISCOVERY,e);return this.parseResources(t),this._resources}.bind(this),this._handleError.bind(this))},e.prototype.getResources=function(){return this._resources},e.prototype.validateUsers=function(e){var t=e.map(function(e){return"address="+e}).join("&"),i=this._buildValidateUsersRequestOptions();return i.url=i.url+"?"+t,this._networkProvider.send(null,i).then(this._onValidateUsersRequestSent.bind(this),this._handleError.bind(this))},e.prototype._buildValidateUsersRequestOptions=function(){var e=[this._resourcesTypes.validatedAddresses,this._resourcesTypes.error].join(", ");return{url:this._endpoints.validateAddresses,sendType:"GET",dataType:"JSON",headers:{Accept:e}}},e.prototype._onValidateUsersRequestSent=function(e){return this._ammMessagesParser.parse(d.Providers.AMM.AMMResponsesTypes.VALIDATE_USERS,e)},e.prototype.getRoutableDomains=function(){return this._resources.domains},e.prototype.getSelfAddress=function(){return this._resources.self},e.prototype.getParticipants=function(e,t){var i=t||{};return i.url=this._endpoints.conversations+"/"+e+"/participants",i.sendType="GET",i.dataType="JSON",i.headers={Accept:[this._resourcesTypes.participants,this._resourcesTypes.error].join(", ")},this._networkProvider.send(null,i).catch(this._handleError.bind(this))},e.prototype.setLastAccessTime=function(e,t){var i=t||{};return i.url=this._endpoints.conversations+"/"+e,i.sendType="POST",i.headers={"Content-Type":[this._resourcesTypes.conversationAccessTime].join(", "),Accept:[this._resourcesTypes.conversationAccessTime,this._resourcesTypes.error].join(", ")},this._networkProvider.send(null,i).catch(this._handleError.bind(this))},e.prototype.sendMessage=function(e,t){var i=t||{};return i.url=this._endpoints.outbox,i.dataType=null,i.headers={Accept:[this._resourcesTypes.message,this._resourcesTypes.error].join(", "),"Content-Type":this._resourcesTypes.message},this._networkProvider.send(JSON.stringify(e),i).then(function(e){return this._ammMessagesParser.parse(d.Providers.AMM.AMMResponsesTypes.SEND,e)}.bind(this),this._handleError.bind(this))},e.prototype._handleError=function(e){var t=new d.Services.Messaging.MessagingError(d.Services.Messaging.MessagingErrorReason.MESSAGING_SERVER_ERROR,e);return T.Deferred().reject(t).promise()},e.prototype.sendMessageWithAttachments=function(t,e,i){var a=i||{};a.url=this._endpoints.outbox,a.dataType=null,a.headers={Accept:[this._resourcesTypes.message,this._resourcesTypes.error].join(", "),"Content-Type":'multipart/related;boundary="boundary"'},a.processData=!1;var r=T.Deferred();return this._createThumbnailsPromises(e).then(function(){return this._createAttachmentsPromises(e)}.bind(this),function(e){return T.Deferred().reject(e).promise()}).then(function(e){this._createBody("boundary",t,e).then(function(e){this._networkProvider.send(e,a).then(function(e){var t=this._ammMessagesParser.parse(d.Providers.AMM.AMMResponsesTypes.SEND,e);r.resolve(t)}.bind(this),function(e){this._handleError(e).fail(function(e){r.reject(e)})}.bind(this))}.bind(this))}.bind(this),function(e){var t=new d.Services.Messaging.MessagingError(d.Services.Messaging.MessagingErrorReason.MESSAGING_CREATE_ATTACHMENT_FAILED,e);r.reject(t)}),r.promise()},e.prototype._createThumbnailsPromises=function(e){var t=T.Deferred(),i=[];return e.forEach(function(e){i.push(e.createThumbnail())}),T.when.apply(this,i).then(function(){t.resolve(e)}),t.promise()},e.prototype._createAttachmentsPromises=function(e){var t=T.Deferred(),i=[];return e.forEach(function(e){i.push(this._readAttachment(e)),e.getCreateThumbnailCapability().isAllowed&&i.push(this._readAttachment(e.getThumbnail()))}.bind(this)),T.when.apply(this,i).then(function(){t.resolve(Array.prototype.slice.call(arguments))},t.reject),t.promise()},e.prototype._readAttachment=function(r){var s=T.Deferred(),n=new FileReader;return n.onload=function(e){var t;r.disposition&&(t=-1!==r.disposition.indexOf("inline")?d.Services.Messaging.AttachmentType.THUMBNAIL:d.Services.Messaging.AttachmentType.MAIN);var i={name:r.getName(),mime:r.getMimeType(),type:t,data:"",file:r.file},a="base64,";e&&e.target?t===d.Services.Messaging.AttachmentType.THUMBNAIL&&-1!==e.target.result.indexOf(a)?i.data=atob(e.target.result.slice(e.target.result.indexOf(a)+a.length)):i.data=e.target.result:t===d.Services.Messaging.AttachmentType.THUMBNAIL&&-1!==n.content.indexOf(a)?i.data=atob(n.content.slice(n.content.indexOf(a)+a.length)):i.data=n.content,s.resolve(i)},n.onerror=function(e){s.reject(e)},n.readAsBinaryString(r.file),s.promise()},e.prototype._createBody=function(e,t,i){var a=[this._createMessage(t)];i.map(this._createAttachment).map(function(e){a.push(e)});var r="--"+e+o,s="--"+e+"--"+o,n=a.reduce(function(e,t){return e.concat(r,t)});return n.unshift(r),n.push(s),d.Base.Utils.readAsByteArray(new Blob(n))},e.prototype._createMessage=function(e){return["Content-Type:"+this._resourcesTypes.message+";"+o+o,JSON.stringify(e),o]},e.prototype._createAttachment=function(e){var t=e.type===d.Services.Messaging.AttachmentType.THUMBNAIL?r:a,i=t===a&&e.file!==m?e.file:d.Base.Utils.getSingleByteArrayFromString(e.data);return["Content-Type:"+e.mime+o,"Content-Transfer-Encoding:binary\r\n","Content-Disposition:"+t+'; filename="'+e.name+'"'+o+o,i,o]},e.prototype.leaveConversation=function(e){var t={};return t.url=this._endpoints.conversations+"/"+e,t.sendType="DELETE",t.headers={Accept:[this._resourcesTypes.error].join(", ")},this._networkProvider.send(null,t).catch(this._handleError.bind(this))},e.prototype.markAllAsRead=function(e,t,i){var a={};return a.url=this._endpoints.markAsReadIf,a.url+="?conversationId="+e,void 0!==t&&(a.url+="&hasAttachment="+!!t),i&&(a.url+="&upTo="+i),a.sendType="POST",a.headers={Accept:[this._resourcesTypes.error].join(", ")},this._networkProvider.send(null,a).catch(this._handleError.bind(this))},e.prototype.changeSubject=function(e){var t={};return t.url=this._endpoints.outbox,t.dataType="JSON",t.headers={"Content-Type":this._resourcesTypes.message},this._networkProvider.send(JSON.stringify(e),t).catch(this._handleError.bind(this))},e.prototype.markAsReadBatch=function(e){var t={};if(t.url=this._endpoints.markAsReadBatch,""===t.url)throw new d.Services.Messaging.MessagingError(d.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE);t.sendType="POST",t.headers={Accept:[this._resourcesTypes.error].join(", "),"Content-Type":this._resourcesTypes.messageIds};var i=JSON.stringify({messageIds:e});return this._networkProvider.send(i,t).catch(this._handleError.bind(this))},e.prototype.getMessages=function(e,t,i,a,r){var s=a?a.id:m,n=r?r.id:m;return this._getMsgs(e,t,i,s,n)},e.prototype.reportTyping=function(){},e.prototype.reportCustomChatNotification=function(){var e=T.Deferred();return e.reject(new d.Services.Messaging.MessagingError(d.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),e.promise()},e.prototype.observeConversations=function(){var e=T.Deferred();return e.reject(new d.Services.Messaging.MessagingError(d.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),e.promise()},e.prototype.startNotificationProvider=function(){var e=T.Deferred();return e.reject(new d.Services.Messaging.MessagingError(d.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),e.promise()},e.prototype.subscribeForTypingEventsInConversation=function(){var e=T.Deferred();return e.reject(new d.Services.Messaging.MessagingError(d.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),e.promise()},e.prototype.unsubscribeForTypingEventsInConversation=function(){var e=T.Deferred();return e.reject(new d.Services.Messaging.MessagingError(d.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),e.promise()},e.prototype.callEscalationEvent=function(e,t){var i={};return i.url=this._endpoints.conversations+"/"+t+"/events",i.sendType="POST",i.headers={"Content-Type":this._resourcesTypes.event},this._networkProvider.send(JSON.stringify(e),i).catch(this._handleError.bind(this))},e.prototype.addParticipantsToConversation=function(e,t,i){var a=T.extend(i,{headers:{}});return a.url=this._endpoints.conversations+"/"+e+"/participants",a.sendType="POST",a.dataType="JSON",a.headers={"Content-Type":this._resourcesTypes.participants},this._networkProvider.send(JSON.stringify(t),a).then(function(e){return this._ammMessagesParser.parse(d.Providers.AMM.AMMResponsesTypes.ADD_PARTICIPANTS,e)}.bind(this),this._handleError.bind(this))},e.prototype.close=function(e){var t={};return t.url=this._endpoints.conversations+"/"+e+"/flags",t.sendType="POST",t.dataType="JSON",t.headers={"Content-Type":this._resourcesTypes.conversationFlags},this._networkProvider.send(JSON.stringify({closed:!0}),t).then(function(e){return this._ammMessagesParser.parse(d.Providers.AMM.AMMResponsesTypes.CLOSE,e)}.bind(this),this._handleError.bind(this))},e.prototype.stop=function(){this._isStarted=!1,this._eTag="";var i=T.Deferred();return this._networkProvider.onClose=function(){this._resources={},i.resolve()}.bind(this),this._networkProvider.onError=function(e){if("abort"===e.statusText)i.resolve();else{var t=new d.Services.Messaging.MessagingError(d.Services.Messaging.MessagingErrorReason.MESSAGING_CLOSE_FAILED);i.reject(t)}}.bind(this),this._networkProvider.close(),i.promise()},e.prototype.logout=function(){var e=T.Deferred();return e.reject(new d.Services.Messaging.MessagingError(d.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),e.promise()},e.prototype.isUpdateSubjectSupported=function(){return!1},e.prototype.isMarkAllContentAsReadSupported=function(){return!1},e.prototype.getMaxImageSize=function(){return 0},e.prototype.getMaxVideoSize=function(){return 0},e.prototype.getMaxAudioSize=function(){return 0},e.prototype.getMaxTextLength=function(){return 0},e.prototype.getMaxGenericAttachmentSize=function(){return 0},e.prototype.getConversationResource=function(){return this._resources.conversationsResource.href},e.prototype.getValidateAddressResource=function(){return this._resources.services.validateAddresses},e.prototype.getMarkAsReadResource=function(){return this._resources.services.markAsReadIf},e.prototype.isOpened=function(){return!1},e.prototype.getMaxMessageCount=function(){return 15},e.prototype.isStarted=function(){return this._isStarted},e.prototype._getMsgs=function(e,t,i,a,r){var s=T.extend(e,{headers:{}});s.url=this._endpoints.conversations+"/"+t;var n="?";return d.Base.Utils.isDefined(i)&&(s.url+=n+"messageCount="+i,n="&"),d.Base.Utils.isDefined(a)&&(s.url+=n+"beforeId="+a,n="&"),d.Base.Utils.isDefined(r)&&(s.url+=n+"afterId="+r),s.sendType="GET",s.dataType="JSON",s.headers={Accept:[this._resourcesTypes.conversation,this._resourcesTypes.error].join(", ")},this._networkProvider.send(null,s).then(function(e){var t=this._ammMessagesParser.parse(d.Providers.AMM.AMMResponsesTypes.GET_MESSAGES,e);return this._needToGetMissingMessages||this._updateLatestMessagesInConversations([t]),t}.bind(this),this._handleError.bind(this))},e.prototype._loadMissingMsgs=function(e){for(var o={},t={},c=[],i=0;i<e.conversations.length;i++){var a=e.conversations[i],r=a.messages,s={id:r[0].id,receivedDate:r[0].receivedDate};-1!==this._conversationsWithMissingMessages.indexOf(a.id)?(t[a.id]={loadedMsgs:0,messageID:r[r.length-1].id},o[a.id]=s):this._latestMessagesInConversations[a.id]=s}var l=function(r,s,n){var e=15<=35-s.loadedMsgs?15:35-s.loadedMsgs;this._getMsgs({},r,e,s.messageID).then(function(e){var t=e.messages;if(this.trigger(d.Providers.Interfaces.MessagingProviderHandlers.CONVERSATIONS_UPDATE,[{conversations:[e]}]),s.loadedMsgs+=t.length,35!==s.loadedMsgs){for(var i=!0,a=0;a<t.length;a++)if(t[a].id===this._latestMessagesInConversations[r].id){i=!1;break}i?(s.messageID=t[t.length-1].id,l.call(this,r,s,n)):(this._latestMessagesInConversations[r]=o[r],c[n].resolve())}else this._latestMessagesInConversations[r]=o[r],c[n].resolve()}.bind(this))};for(var n in t)t.hasOwnProperty(n)&&(c.push(T.Deferred()),l.call(this,n,t[n],c.length-1));c.length?T.when.apply(this,c).then(function(){this._needToGetMissingMessages=!1}.bind(this)):this._needToGetMissingMessages=!1},e.prototype._updateLatestMessagesInConversations=function(e){if(e)for(var t=0;t<e.length;t++){var i=e[t];this._latestMessagesInConversations[i.id]=this._getLatestMessageInConversation(i)}else d.Base.Logger.warn(d.Base.LoggerTags.AMM_MESSAGING_PROVIDER,"AbstractAMMProvider.prototype._updateLatestMessagesInConversations: conversations is not defined")},e.prototype._getLatestMessageInConversation=function(e){var t=e.id,i=e.messages,a=i.length?i[0]:null,r=this._latestMessagesInConversations[t],s=r?Date.parse(r.receivedDate):null,n=a?Date.parse(a.receivedDate):null;return a&&(!r||r&&!!(s&&n&&s<n))?{id:a.id,receivedDate:a.receivedDate}:r||null},e.prototype._areMessagesInConversationUpToDate=function(e){var t=e.id;if(this._latestMessagesInConversations[t]){for(var i=e.messages,a=0;a<i.length;a++)if(i[a].id===this._latestMessagesInConversations[t].id)return!0;return!1}return!0},e.prototype._updateConversationsWithMissingMessages=function(e){e=e.conversations;for(var t=this._conversationsWithMissingMessages.length=0;t<e.length;t++){var i=e[t];this._areMessagesInConversationUpToDate(i)||this._conversationsWithMissingMessages.push(i.id)}},e.prototype._getConversationsState=function(){var e=T.Deferred();return e.reject(new d.Services.Messaging.MessagingError(d.Services.Messaging.MessagingErrorReason.MESSAGING_FEATURE_NOT_AVAILABLE)),e.promise()},d.Providers.AMM.AbstractAMMProvider=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Providers.AMM.AbstractAMMProvider.call(this,e,t),this._networkProvider._onCredentialsRequired=this.onCredentialsRequired.bind(this),this._resourcesTypes.resources="application/vnd.avaya.aem.resources.v3+json",this._blackListedWords=["subject","message","body","mimeType","size","disposition","mediaUrl","media","givenName","href","nativeGivenName","nativeSurname","surname","address","duration"]}(e.prototype=Object.create(i.Providers.AMM.AbstractAMMProvider.prototype)).start=function(e,t){return this._config=e,this._isStarted=!0,this._networkProvider.onMessage=function(e,t){if(void 0!==t){var i=t.getResponseHeader("ETag");e&&e.conversations&&(e.lastUpdated?this._conversationsLastModified=new Date(new Date(e.lastUpdated).getTime()+1):this._conversationsLastModified=new Date(new Date(t.getResponseHeader("Last-Modified")).getTime()+1)),null!=i&&(this._eTag=i)}}.bind(this),this._networkProvider.onError=function(e){return t&&t._fireMessagingUnavailableCallback(i.Services.Analytics.AnalyticsErrorCode.NOTIFICATION_ERROR),this._handleError(e)}.bind(this),this._networkProvider.on(i.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(i.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._networkProvider.on(i.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(i.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),this._networkProvider.registerBlackList(this._blackListedWords),this._networkProvider.start(this._config.networkProviderConfiguration,this._config.credentialProvider)},e.prototype._longPollConversations=function(){if(!T.isEmptyObject(this._resources)){var e=30;this._resources.avayaRequestTimeout&&this._resources.avayaRequestTimeout.recommended&&(e=this._resources.avayaRequestTimeout.recommended);var t={headers:{"Avaya-Request-Timeout":e}};return this.getConversations(t)}},e.prototype.observeConversations=function(){return this._longPollConversations().then(function(e){if(this._isStarted)return e&&e.conversations&&0<e.conversations.length&&this.trigger("conversations.update",[e]),this.observeConversations()}.bind(this))},e.prototype.isUpdateSubjectSupported=function(){return!0},e.prototype.isMarkAllContentAsReadSupported=function(){return!!this._resources&&!!this._resources.services&&!!this._resources.services.markAsReadIf},e.prototype.parseResources=function(e){this._resources=T.extend(new i.Providers.AMM.ResourcesV2,e),this._endpoints.conversations=this._resources.conversationsResource.href,this._endpoints.validateAddresses=this._resources.services.validateAddresses,this._endpoints.messages=this._resources.messages,this._endpoints.outbox=this._resources.outbox,this._endpoints.markAsReadIf=this._resources.services.markAsReadIf,this._endpoints.addresses=this._resources.addresses},e.prototype.getMaxImageSize=function(){return i.Base.Utils.queryJSONObject(this,"_resources.limits.maxImageSize")},e.prototype.getMaxVideoSize=function(){return i.Base.Utils.queryJSONObject(this,"_resources.limits.maxVideoSize")},e.prototype.getMaxAudioSize=function(){return i.Base.Utils.queryJSONObject(this,"_resources.limits.maxAudioSize")},e.prototype.getMaxTextLength=function(){return i.Base.Utils.queryJSONObject(this,"_resources.limits.maxTextLength")},e.prototype.getMaxGenericAttachmentSize=function(){return i.Base.Utils.queryJSONObject(this,"_resources.limits.maxGenericAttachmentSize")},i.Providers.AMM.AMM2_1Provider=e}(AvayaClientServices),function(_){"use strict";function e(e,t,i,a){_.Providers.AMM.AMM2_1Provider.call(this,e,a),this._networkProvider._onCredentialsRequired=this.onCredentialsRequired.bind(this),this._resources={},this._notificationResources={},this._maxConnectionErrorCount=5,this._notificationsConfiguration={},this._notificationProvider=t,this._notificationProvider._onCredentialsRequired=this.onCredentialsRequired.bind(this),this._resourcesTypes.conversation="application/vnd.avaya.aem.conversation.v2+json",this._resourcesTypes.conversationExtensions="application/vnd.avaya.aem.conversation.extensions.v1+json",this._resourcesTypes.conversations="application/vnd.avaya.aem.conversations.v2+json",this._resourcesTypes.message="application/vnd.avaya.aem.message.v2+json",this._resourcesTypes.resources="application/vnd.avaya.aem.resources.v4+json",this._resourcesTypes.subject="application/vnd.avaya.aem.subject.v1+json",this._isListening=!1,this._requests={},this._callbacksForTypingEvents={},this._identity={},this._onCredentialsRequired=this.onCredentialsRequired.bind(this),this._dfdSubscribed={},this._dfdUnsubscribed={},this._dfdConversationsSubscribed={},this._chatStateNotifications=i,this._conversationsSubscribed=!1,this._failoverPingData={wsKeepAliveEnabled:!0,wsPingInterval:3e4,wsGeneratePingMessage:function(){var e=_.Base.Utils.makeId(32,"0123456789abcdef"),t={ping:{requestId:this._failoverPingData.wsPingMessageRequestId=e,version:"1"}};return JSON.stringify(t)}.bind(this),wsIsPongMessage:function(e){var t="string"==typeof e?JSON.parse(e):e;return _.Base.Utils.isDefined(t.pong)&&this._failoverPingData.wsPingMessageRequestId===t.pong.requestId}.bind(this),wsPingMessageRequestId:"",keepAliveAnswerWaitingTime:5e3,ssePingInterval:65e3},this._discoveryBackoffDataObject=m,this._dfdConversationsResourceState={}}(e.prototype=Object.create(_.Providers.AMM.AMM2_1Provider.prototype)).start=function(e,t){return this._notificationProvider.registerBlackList(this._blackListedWords),_.Providers.AMM.AMM2_1Provider.prototype.start.call(this,e,t)},e.prototype.startNotificationProvider=function(h){var p=T.Deferred();if(!!this.getResources().notificationService&&(this.getResources().notificationService.websocket.href||this.getResources().notificationService.sse.href)&&!this._notificationProvider.isOpened()){this._notificationProvider.onOpen=function(){this._notificationProvider.onMessage=function(e){var t,i,a;if((t=e.data&&e.type!==_.Base.ProvidersEventTypes.PING?JSON.parse(e.data):e).notification){var r=this._ammMessagesParser.parse(_.Providers.AMM.AMMResponsesTypes.NOTIFICATION,t.notification);switch(r.service){case _.Providers.AMM.MessagesService.CONVERSATION:this._eTag=_.Base.Utils.queryJSONObject(r,"contents.entityTag"),this.getConversationsByQuery({after:this._conversationsLastModified.toISOString()}).then(function(e){e&&e.conversations&&0<e.conversations.length&&this.trigger(_.Providers.Interfaces.MessagingProviderHandlers.CONVERSATIONS_UPDATE,[e])}.bind(this));break;case _.Providers.AMM.MessagesService.CHAT_STATE:var s=T.extend(new _.Providers.AMM.NotificationContentsV1,r.contents),n=s.address===this._resources.self,o=r.resource.slice(this._resources.conversationsResource.href.length+1);this._chatStateNotifications.setChatStateNotification(s,n,this._callbacksForTypingEvents[o]),this._callbacksForTypingEvents[o].fire(s);break;default:_.Base.Logger.warn(_.Base.LoggerTags.AMM_MESSAGING_PROVIDER,"Unknown notification service value received: {0}",r.service)}}else if(t.notified){var c=this._ammMessagesParser.parse(_.Providers.AMM.AMMResponsesTypes.NOTIFIED,t.notified);this._handleNotificationResponse(c)}else if(t.discovery){var l=this._ammMessagesParser.parse(_.Providers.AMM.AMMResponsesTypes.DISCOVERY_NOTIFICATION,t.discovery);if(this._notificationResources=T.extend(new _.Providers.AMM.NotificationResourcesV1,l),this._notificationResources.commandURL){var d=_.Base.Utils.parseUrl(this._notificationResources.commandURL);this._notificationsConfiguration.restConfig.hostName=d.hostname,this._notificationsConfiguration.restConfig.port=d.port,this._notificationsConfiguration.restConfig.isSecure=d.isSecure,this._notificationsConfiguration.restConfig.path=d.path}p.resolve(),this.trigger(_.Providers.AMM.ProviderStates.AVAILABLE,[]),h._fireMessagingAvailableCallback()}else if(t.subscribed){var C=this._ammMessagesParser.parse(_.Providers.AMM.AMMResponsesTypes.SUBSCRIBED,t.subscribed);i=_.Base.Utils.queryJSONObject(C,"results.successful[0].service"),a=_.Base.Utils.queryJSONObject(C,"results.successful[0].resource"),i===_.Providers.AMM.MessagesService.CHAT_STATE&&this._dfdSubscribed[a]!==m&&this._dfdSubscribed[a].state()===_.Base.DeferredStates.PENDING?this._dfdSubscribed[a].resolve(C):i===_.Providers.AMM.MessagesService.CONVERSATION&&this._dfdConversationsSubscribed!==m&&this._dfdConversationsSubscribed.state()===_.Base.DeferredStates.PENDING&&(this._dfdConversationsSubscribed.resolve(C),this._conversationsSubscribed=!0)}else if(t.unsubscribed){var u=this._ammMessagesParser.parse(_.Providers.AMM.AMMResponsesTypes.UNSUBSCRIBED,t.unsubscribed);i=_.Base.Utils.queryJSONObject(u,"results.successful[0].service"),a=_.Base.Utils.queryJSONObject(u,"results.successful[0].resource"),i===_.Providers.AMM.MessagesService.CHAT_STATE&&this._dfdUnsubscribed[a]!==m&&this._dfdUnsubscribed[a].state()===_.Base.DeferredStates.PENDING&&(this._dfdUnsubscribed[a].resolve(u),this._chatStateNotifications.clearChatStateNotifications())}else if(t.resourceState){var v=this._ammMessagesParser.parse(_.Providers.AMM.AMMResponsesTypes.RESOURCE_STATE,t.resourceState);i=_.Base.Utils.queryJSONObject(v,"results.successful[0].service"),a=_.Base.Utils.queryJSONObject(v,"results.successful[0].resource"),i===_.Providers.AMM.MessagesService.CONVERSATION&&this._dfdConversationsResourceState!==m&&this._dfdConversationsResourceState.state()===_.Base.DeferredStates.PENDING&&this._dfdConversationsResourceState.resolve(v)}}.bind(this)}.bind(this),this._chatStateNotifications.onPauseChatState=function(e,t){return""!==this._chatStateNotifications.getConversationId()?this._reportChatState(e,t,!1):(_.Base.Logger.info("Not pausing chat state because conversation already terminated."),T.Deferred().resolve().promise())}.bind(this),this._notificationProvider.on(_.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(_.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._notificationProvider.on(_.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(_.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this));var e=function(){var a=T.Deferred();return this._needToGetMissingMessages=!0,this.trigger(_.Providers.AMM.ProviderStates.UNAVAILABLE,[]),h._fireMessagingUnavailableCallback(_.Services.Analytics.AnalyticsErrorCode.NOTIFICATION_ERROR),this._discoverResources(h).then(function(){return this.startNotificationProvider(h).then(function(){if(this._conversationsSubscribed)return this.observeConversations().then(function(){return this._getConversationsState().then(function(e){var t=e.results.successful[0].state.entityTag,i=function(){a.resolve(),this._resubscribeForTypingEvents()}.bind(this);t!==this._eTag?this.getConversationsByQuery().then(function(e){e&&e.conversations&&0<e.conversations.length&&this.trigger(_.Providers.Interfaces.MessagingProviderHandlers.CONVERSATIONS_UPDATE,[e]),this._eTag=t,i()}.bind(this)):i()}.bind(this))}.bind(this));a.resolve()}.bind(this),function(){a.reject()}.bind(this))}.bind(this)),a.promise()}.bind(this);this._notificationProvider.start(this._notificationsConfiguration,this._config.credentialProvider,m,m,e,this._failoverPingData).fail(function(){_.Base.Logger.error(_.Base.LoggerTags.AMM_MESSAGING_PROVIDER,"Start notification channel failed."),p.reject(new _.Services.Messaging.MessagingError(_.Services.Messaging.MessagingErrorReason.MESSAGING_NOTIFICATION_FAILED))})}else p.reject(new _.Services.Messaging.MessagingError(_.Services.Messaging.MessagingErrorReason.MESSAGING_NOTIFICATIONS_CHANNEL_FAILED));return _.Base.Utils.rejectIfPromiseNotResolvedInTime(p.promise(),3e4,new _.Services.Messaging.MessagingError(_.Services.Messaging.MessagingErrorReason.MESSAGING_TIMEOUT),function(){_.Base.Logger.error(_.Base.LoggerTags.AMM_MESSAGING_PROVIDER,"Notification discovery was not received in time"),h._fireMessagingUnavailableCallback(_.Services.Analytics.AnalyticsErrorCode.NOTIFICATION_ERROR)})},e.prototype.stop=function(){var t=T.Deferred();return _.Base.Utils.isDefined(this._discoveryBackoffDataObject)&&(this._discoveryBackoffDataObject.cancel(),this._discoveryBackoffDataObject=m),_.Providers.AMM.AMM2_1Provider.prototype.stop.call(this).then(function(){this._notificationProvider.onClose=function(){this._conversationsLastModified=m,this._isListening=!1,t.resolve()}.bind(this);try{this._notificationProvider.close()}catch(e){t.reject(new _.Services.Messaging.MessagingError(_.Services.Messaging.MessagingErrorReason.MESSAGING_CLOSE_FAILED))}}.bind(this),t.reject),t.promise()},e.prototype.logout=function(){if(this._resources.sessionManagement){var e={};return e.url=this._resources.sessionManagement.href,e.sendType="DELETE",e.headers={Accept:this._resourcesTypes.error},this._networkProvider.send(null,e)}return T.Deferred().resolve().promise()},e.prototype.discoverResources=function(i){return this._discoverResources(i).then(function(e){var t=e.sessionManagement.username;return this._credentials.username!==t?(_.Base.Logger.warn(_.Base.LoggerTags.AMM_MESSAGING_PROVIDER,"Deleting session due to mismatch username"),this.logout().then(function(){return this.discoverResources(i)}.bind(this))):e}.bind(this))},e.prototype._discoverResources=function(t){var e=function(){var e={urlSuffix:"/aem/resources",sendType:"GET",dataType:"JSON",crossDomain:!0};return e.headers={Accept:[this._resourcesTypes.resources,this._resourcesTypes.error].join(", ")},this._networkProvider.send(null,e)}.bind(this);return this._discoveryBackoffDataObject=_.Base.Utils.connectionBackoffAlgorithm(e),this._discoveryBackoffDataObject.dfdPromise.then(function(e){var t=this._ammMessagesParser.parse(_.Providers.AMM.AMMResponsesTypes.DISCOVERY,e);return this._discoveryBackoffDataObject=m,this.parseResources(t)}.bind(this),function(e){return this.trigger(_.Providers.AMM.ProviderStates.UNAVAILABLE,[]),t._fireMessagingUnavailableCallback(_.Services.Analytics.AnalyticsErrorCode.CONNECTION_BACKOFF_ALGORITHM_ERROR),this._handleError(e)}.bind(this))},e.prototype.parseResources=function(e){this._resources=T.extend(new _.Providers.AMM.ResourcesV4,e),this._endpoints.conversations=this._resources.conversationsResource.href,this._endpoints.validateAddresses=this._resources.services.validateAddresses.href,this._endpoints.messages=this._resources.messages.href,this._endpoints.outbox=this._resources.outbox.href,this._endpoints.markAsReadIf=this._resources.services.markAsReadIf.href,this._endpoints.markAsReadBatch=this._resources.services.markAsReadBatch.href;var t=_.Base.Utils.parseUrl(this._resources.notificationService.websocket.href),i=new _.Config.ServerInfo(t.hostname,t.port,t.isSecure,t.path),a=_.Base.Utils.parseUrl(this._resources.notificationService.sse.href),r=new _.Config.ServerInfo(a.hostname,a.port,a.isSecure,a.path),s=new _.Config.ServerInfo;return this._notificationsConfiguration=new _.Config.NetworkProviderConfiguration(s,i,r,this._maxConnectionErrorCount),this._resources},e.prototype.getConversationIds=function(e){var t=_.Base.Utils.deepMerge(e,{headers:{}});return t.url=this._endpoints.conversations,t.sendType="GET",t.dataType="JSON",t.headers.Accept=[this._resourcesTypes.conversationIds,this._resourcesTypes.error].join(", "),this._networkProvider.send(null,t).then(function(e){return e},this._handleError.bind(this))},e.prototype.observeConversations=function(){this._dfdConversationsSubscribed=T.Deferred();var e={subscribe:{resources:[{application:"AMM",service:"conversation",resource:this._resources.conversationsResource.href}],version:"1"}};return this._notificationProvider.send(JSON.stringify(e),{dataType:"JSON",headers:{"Content-Type":"application/json"}}),this._dfdConversationsSubscribed.promise()},e.prototype.reportTyping=function(e,t){var i,a=this._chatStateNotifications.getChatNotification(this._resources.self);if(a&&a.action!==_.Providers.AMM.ChatStateActions.TYPING&&(this._reportChatState(a.action,e,!1),this._chatStateNotifications.clearChatStateRefreshTimeout()),this._chatStateNotifications.isChatStateAdded()){var r=T.Deferred();r.resolve(),i=r.promise()}else this._chatStateNotifications.setChatStateRefreshTimeout(),i=this._reportChatState(_.Providers.AMM.ChatStateActions.TYPING,e,t);return i},e.prototype.reportCustomChatNotification=function(e,t,i){var a,r=this._chatStateNotifications.getChatNotification(this._resources.self);if(r&&r.action===_.Providers.AMM.ChatStateActions.TYPING&&(this._reportChatState(_.Providers.AMM.ChatStateActions.TYPING,e,!1),this._chatStateNotifications.clearChatStateRefreshTimeout()),this._chatStateNotifications.isChatStateAdded()){var s=T.Deferred();s.resolve(),a=s.promise()}else this._chatStateNotifications.setChatStateRefreshTimeout(),a=this._reportChatState(t,e,i);return a},e.prototype.subscribeForTypingEventsInConversation=function(e,t){var i=this._resources.conversationsResource.href+"/"+e;this._chatStateNotifications.setConversationId(e),this._dfdSubscribed[i]=T.Deferred();var a={subscribe:{resources:[{application:"AMM",service:"chatState",resource:i}]}},r=!1;return this._callbacksForTypingEvents[e]||(this._callbacksForTypingEvents[e]=T.Callbacks()),this._callbacksForTypingEvents[e].has()||(r=!0),this._callbacksForTypingEvents[e].has(t)||this._callbacksForTypingEvents[e].add(t),r&&this._notificationProvider.send(JSON.stringify(a),{dataType:"JSON",headers:{"Content-Type":"application/json"}}),this._dfdSubscribed[i].promise()},e.prototype.unsubscribeForTypingEventsInConversation=function(e){var t=this._resources.conversationsResource.href+"/"+e;this._chatStateNotifications.setConversationId(""),this._dfdUnsubscribed[t]=T.Deferred();var i={unsubscribe:{resources:[{application:"AMM",service:"chatState",resource:t}]}};this._callbacksForTypingEvents[e]&&this._callbacksForTypingEvents[e].has()&&this._callbacksForTypingEvents[e].empty();return this._notificationProvider.send(JSON.stringify(i),{dataType:"JSON",headers:{"Content-Type":"application/json"}}),this._dfdUnsubscribed[t].promise()},e.prototype._resubscribeForTypingEvents=function(){var e=this._chatStateNotifications.getConversationId();if(""!==e){var t=this._resources.conversationsResource.href+"/"+e;this._dfdSubscribed[t]=T.Deferred();var i={subscribe:{resources:[{application:"AMM",service:"chatState",resource:t}]}};return this._notificationProvider.send(JSON.stringify(i),{dataType:"JSON",headers:{"Content-Type":"application/json"}}),this._dfdSubscribed[t].promise()}},e.prototype._sendNotification=function(e,t){for(var i=_.Base.Utils.makeId();_.Base.Utils.isDefined(this._requests[i]);)i=_.Base.Utils.makeId();var a={notify:{requestId:i,notifications:[e]}};this._requests[i]=t;return this._notificationProvider.send(JSON.stringify(a),{dataType:"JSON",headers:{"Content-Type":"application/json"}}).fail(function(e){this._requests[i].reject(e),delete this._requests[i]}.bind(this))},e.prototype._handleNotificationResponse=function(e){if(e.results.successful&&_.Base.Utils.isDefined(this._requests[e.requestId]))this._requests[e.requestId].resolve(e.results.successful[0]),delete this._requests[e.requestId];else if(e.results.failed&&_.Base.Utils.isDefined(this._requests[e.requestId])){var t=new _.Services.Messaging.MessagingError(_.Base.ErrorReasons.AMM_NOTIFICATION_FAILED,_.Base.Utils.queryJSONObject(e,"results.failed"));this._requests[e.requestId].reject(t),delete this._requests[e.requestId]}},e.prototype.isUpdateSubjectSupported=function(){return!!(this._resources&&this._resources.conversationsResource&&this._resources.conversationsResource.capabilities&&this._resources.conversationsResource.capabilities.subjectChange)},e.prototype.isMarkAllContentAsReadSupported=function(){return!!this._resources&&!!this._resources.services&&!!this._resources.services.markAsReadIf},e.prototype._reportChatState=function(e,t,i){var a=T.Deferred(),r={application:"AMM",service:"chatState",resource:this._resources.conversationsResource.href+"/"+t,contents:{state:_.Providers.AMM.ChatStates.PAUSED}};return i&&(r.contents={action:e,state:_.Providers.AMM.ChatStates.COMPOSING}),this._sendNotification(r,a),a.promise()},e.prototype.isOpened=function(){return this._notificationProvider.isOpened()},e.prototype.getMaxMessageCount=function(){return this._resources.conversationsResource.limits.maxMessageCount},e.prototype.getMaxImageSize=function(){return _.Base.Utils.queryJSONObject(this,"_resources.outbox.limits.maxImageSize")},e.prototype.getMaxVideoSize=function(){return _.Base.Utils.queryJSONObject(this,"_resources.outbox.limits.maxVideoSize")},e.prototype.getMaxAudioSize=function(){return _.Base.Utils.queryJSONObject(this,"_resources.outbox.limits.maxAudioSize")},e.prototype.getMaxTextLength=function(){return _.Base.Utils.queryJSONObject(this,"_resources.outbox.limits.maxTextLength")},e.prototype.getMaxGenericAttachmentSize=function(){return _.Base.Utils.queryJSONObject(this,"_resources.outbox.limits.maxGenericAttachmentSize")},e.prototype.changeSubject=function(e){var t={},i={subject:e.subject};return t.url=this._endpoints.conversations+"/"+e.threadId,t.sendType="POST",t.headers={"Content-Type":this._resourcesTypes.subject},this._networkProvider.send(JSON.stringify(i),t).catch(this._handleError.bind(this))},e.prototype._getConversationsState=function(){var e={getState:{requestId:"myGetState",resources:[{application:"AMM",service:"conversation",resource:this._resources.conversationsResource.href}],version:"1"}};return this._dfdConversationsResourceState=T.Deferred(),this._notificationProvider.send(JSON.stringify(e),{dataType:"JSON",headers:{"Content-Type":"application/json"}}),this._dfdConversationsResourceState.promise()},e.prototype.leaveConversation=function(e){return _.Providers.AMM.AbstractAMMProvider.prototype.leaveConversation.apply(this,[e]).then(function(){this._chatStateNotifications.setConversationId("")}.bind(this))},_.Providers.AMM.AMM3Provider=e}(AvayaClientServices),function(o){"use strict";function e(){o.Providers.AMM.AbstractAMMProvider.call(this),this._providers=[],this._selectedProvider=m,this._config={},this._isAvailable=!1}(e.prototype=Object.create(o.Providers.AMM.AbstractAMMProvider.prototype)).registerAMMProvider=function(e,t){t.on(o.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(o.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),t.on(o.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(o.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),t.on(o.Providers.AMM.ProviderStates.AVAILABLE,function(){this.trigger(o.Providers.AMM.ProviderStates.AVAILABLE,[])}.bind(this)),t.on(o.Providers.AMM.ProviderStates.UNAVAILABLE,function(){this.trigger(o.Providers.AMM.ProviderStates.UNAVAILABLE,[])}.bind(this)),this._providers.push({version:e,provider:t})},e.prototype.start=function(e,t){return T.isEmptyObject(e)||this._config===e||(this._config=e),this.determineServerVersion(t)},e.prototype.determineServerVersion=function(e){var t=T.Deferred();this._providers.sort(function(e,t){return t.version-e.version});return this._checkServer(0,t,this._config,e),t.promise()},e.prototype._checkServer=function(a,r,s,n){this._isProperVersion(a,s,n).then(function(){this._selectedProvider=this._providers[a].provider,o.Base.Logger.info(o.Base.LoggerTags.AMM_MESSAGING_PROVIDER,"Determined AMM server version: "+this._selectedProvider._resourcesTypes.resources),this._selectedProvider.startNotificationProvider(n),r.resolve()}.bind(this),function(e){a+=1;var t=e.getData()&&e.getData().message===o.Base.ErrorReasons.NETWORK_AUTHORIZATION_CANCELED,i=e.getData()&&e.getData()===o.Base.ErrorReasons.BACKOFF_ALGORITHM_CANCELLED;!(406===e.statusCode||a<this._providers.length-1)||t||i?r.reject(e):this._checkServer(a,r,s,n)}.bind(this))},e.prototype._isProperVersion=function(e,t,i){return this._selectedProvider=this._providers[e].provider,this._providers[e].provider.start(t,i),this._providers[e].provider.discoverResources(i).then(function(){this._isAvailable=!0}.bind(this))},e.prototype.getRoutableDomains=function(){return this._selectedProvider.getRoutableDomains()},e.prototype.getSelfAddress=function(){return this._selectedProvider.getSelfAddress()},e.prototype.getConversations=function(e){return this._selectedProvider.getConversations(e)},e.prototype.getConversationIds=function(e){return this._selectedProvider.getConversationIds(e).then(function(e){for(var t=[],i=0;i<e.conversationIds.length;i++)t.push(new o.Services.Messaging.ConversationId(e.conversationIds[i]));return t})},e.prototype.getConversationsByQuery=function(e,t,i){return this._selectedProvider.getConversationsByQuery(e,t,i)},e.prototype.discoverResources=function(){return this._selectedProvider.discoverResources()},e.prototype.getResources=function(){return this._selectedProvider.getResources()},e.prototype.validateUsers=function(e){return this._selectedProvider.validateUsers(e)},e.prototype.getParticipants=function(e,t){return this._selectedProvider.getParticipants(e,t)},e.prototype.sendMessage=function(e,t){return this._selectedProvider.sendMessage(e,t)},e.prototype.sendMessageWithAttachments=function(e,t,i){return this._selectedProvider.sendMessageWithAttachments(e,t,i)},e.prototype.leaveConversation=function(e){return this._selectedProvider.leaveConversation(e)},e.prototype.markAllAsRead=function(e){return this._selectedProvider.markAllAsRead(e)},e.prototype.changeSubject=function(e){return this._selectedProvider.changeSubject(e)},e.prototype.markAsReadBatch=function(e){return this._selectedProvider.markAsReadBatch(e)},e.prototype.getMessages=function(e,t,i,a,r){return this._selectedProvider.getMessages(e,t,i,a,r)},e.prototype.reportTyping=function(e,t){return this._selectedProvider.reportTyping(e,t)},e.prototype.reportCustomChatNotification=function(e,t,i){return this._selectedProvider.reportCustomChatNotification(e,t,i)},e.prototype.observeConversations=function(){return this._selectedProvider.observeConversations()},e.prototype.callEscalationEvent=function(e,t){return this._selectedProvider.callEscalationEvent(e,t)},e.prototype.setLastAccessTime=function(e,t){return this._selectedProvider.setLastAccessTime(e,t)},e.prototype.addParticipantsToConversation=function(e,t){return this._selectedProvider.addParticipantsToConversation(e,t)},e.prototype.subscribeForTypingEventsInConversation=function(e,t){return this._selectedProvider.subscribeForTypingEventsInConversation(e,t)},e.prototype.unsubscribeForTypingEventsInConversation=function(e){return this._selectedProvider.unsubscribeForTypingEventsInConversation(e)},e.prototype.close=function(e){return this._selectedProvider.close(e)},e.prototype.stop=function(){return this._selectedProvider.stop().then(function(){this._isAvailable=!1}.bind(this))},e.prototype.logout=function(){return this._selectedProvider.logout()},e.prototype.on=function(e,t){return this._selectedProvider?this._selectedProvider.on(e,t):o.Providers.AMM.AbstractAMMProvider.prototype.on.call(this,e,t)},e.prototype.off=function(e,t){return this._selectedProvider.off(e,t)},e.prototype.isUpdateSubjectSupported=function(){return this._selectedProvider.isUpdateSubjectSupported()},e.prototype.isMarkAllContentAsReadSupported=function(){return this._selectedProvider.isMarkAllContentAsReadSupported()},e.prototype.isOpened=function(){return this._selectedProvider.isOpened()},e.prototype.getMaxMessageCount=function(){return this._selectedProvider.getMaxMessageCount()},e.prototype.getMaxImageSize=function(){return this._selectedProvider.getMaxImageSize()},e.prototype.getMaxVideoSize=function(){return this._selectedProvider.getMaxVideoSize()},e.prototype.getMaxAudioSize=function(){return this._selectedProvider.getMaxAudioSize()},e.prototype.getMaxTextLength=function(){return this._selectedProvider.getMaxTextLength()},e.prototype.getMaxSubjectLength=function(){return 50},e.prototype.getMaxGenericAttachmentSize=function(){return this._selectedProvider.getMaxGenericAttachmentSize()},e.prototype.getConversationResource=function(){return this._selectedProvider.getConversationResource()},e.prototype.getValidateAddressResource=function(){return this._selectedProvider.getValidateAddressResource()},e.prototype.getMarkAsReadResource=function(){return this._selectedProvider.getMarkAsReadResource()},e.prototype.isAvailable=function(){return this._isAvailable&&!!this._selectedProvider&&!!this._selectedProvider.isStarted()&&this.isOpened()},o.Providers.AMM.AMMProvider=e}(AvayaClientServices),function(i){"use strict";var s="v",n="tid",o="cid",a="t",c="an",l="av",r="event",d="timing",t=!1,C=[],u={BUCKET_DEFINITIONS:{OPERATIONS_TIMING:{LESS_100:"<100 msec",MORE_100:"100-999 msec",MORE_1000:"1000-4999 msec",MORE_5000:"5000-9999 msec",MORE_10000:">=10000 msec"},SERVICE_OUTAGE:{LESS_1000:"<1 sec",MORE_1000:"1-59 sec",MORE_60000:"1-10 min",MORE_600000:"10-59 min",MORE_3600000:">=1 hour"},CALL_DURATION:{LESS_10000:"<10 sec",MORE_10000:"10-59 sec",MORE_60000:"1-5 min",MORE_300000:"5-10 min",MORE_600000:"10-60 min",MORE_3600000:">=60 min"},CONTACT_COUNT:{LESS_10:"<10",MORE_10:"10-99",MORE_100:"100-499",MORE_500:"500-999",MORE_1000:"1000-1999",MORE_2000:"2000-2999",MORE_3000:"3000-3999",MORE_4000:"4000-4999",MORE_5000:">=5000"},ATTACHMENT_SIZE:{LESS_100:"<100 KB",MORE_100:"100-999 KB",MORE_1000:"1000-4999 KB",MORE_5000:"5000-9999 KB",MORE_10000:"10000-29999 KB",MORE_30000:">=30000 KB"},CALL_PRESERVATION:{LESS_1000:"<1 sec",MORE_1000:"1-5 sec",MORE_5000:"5-10 sec",MORE_10000:"10-30 sec",MORE_30000:"30-60 sec",MORE_60000:">=60 sec"}}},v=i.Base.Utils;i.Providers.Analytics.AnalyticsStatistic={CONSTANTS:u,setCollectionEnabledState:function(e){(t=e)||(C.length=0)},isCollectionEnabled:function(){return t},queueCollectedHits:function(){this._hitTransmissionQueue=this._hitTransmissionQueue.concat(C),C.length=0},addHit:function(e){t&&C.push(e)},getCommonRequestsParams:function(e,t){for(var i="",a=[[s,1],[n,"UA-81637253-1"],[o,t],[c,"Client SDK Communications Package"],[l,e]],r=0;r<a.length;r++)i+=this.addURIParam(a[r][0],a[r][1],!i);return i},addHitTypeParameter:function(e){var t="";switch(e){case"event":t=r;break;case"timing":t=d;break;default:i.Base.Logger.warn(i.Base.LoggerTags.ANALYTICS_PROVIDER,"Unknown type",e)}return this.addURIParam(a,t)},addCustomDimensionsParameters:function(e){var t="";for(var i in e)if(e.hasOwnProperty(i)){var a=e[i];"string"==typeof a&&""!==a&&v.getBytesCount(encodeURIComponent(a))<=150&&(t+=this.addURIParam("cd"+i,a))}return t},addURIParam:function(e,t,i){var a="";return a+=i?"":"&",a+=e+"="+encodeURIComponent(t)},getOperationTimingLabel:function(e){var t=u.BUCKET_DEFINITIONS.OPERATIONS_TIMING;return e<100?t.LESS_100:e<1e3?t.MORE_100:e<5e3?t.MORE_1000:e<1e4?t.MORE_5000:t.MORE_10000},getServiceOutageLabel:function(e){var t=u.BUCKET_DEFINITIONS.SERVICE_OUTAGE;return e<1e3?t.LESS_1000:e<6e4?t.MORE_1000:e<6e5?t.MORE_60000:e<36e5?t.MORE_600000:t.MORE_3600000},getCallDurationLabel:function(e){var t=u.BUCKET_DEFINITIONS.CALL_DURATION;return e<1e4?t.LESS_10000:e<6e4?t.MORE_10000:e<3e5?t.MORE_60000:e<6e5?t.MORE_300000:e<36e5?t.MORE_600000:t.MORE_3600000},getContactCountLabel:function(e){var t=u.BUCKET_DEFINITIONS.CONTACT_COUNT;return e<10?t.LESS_10:e<100?t.MORE_10:e<500?t.MORE_100:e<1e3?t.MORE_500:e<2e3?t.MORE_1000:e<3e3?t.MORE_2000:e<4e3?t.MORE_3000:e<5e3?t.MORE_4000:t.MORE_5000},getAttachmentSizeLabel:function(e){var t=u.BUCKET_DEFINITIONS.ATTACHMENT_SIZE;return(e/=1024)<100?t.LESS_100:e<1e3?t.MORE_100:e<5e3?t.MORE_1000:e<1e4?t.MORE_5000:e<3e4?t.MORE_10000:t.MORE_30000},getCallPreservation:function(e){var t=u.BUCKET_DEFINITIONS.CALL_PRESERVATION;return e<1e3?t.LESS_1000:e<5e3?t.MORE_1000:e<1e4?t.MORE_5000:e<3e4?t.MORE_10000:e<6e4?t.MORE_30000:t.MORE_60000}}}(AvayaClientServices),function(e){"use strict";var c="utc",l="utv",d="utt",C="utl",u=e.Base.Utils,v=e.Providers.Analytics.AnalyticsStatistic;e.Providers.Analytics.AnalyticsTimingStatistic={send:function(e,t,i,a,r){if(v.isCollectionEnabled()){var s=this._getTimingParams.apply(this,arguments);s&&v.addHit(s)}},_getTimingParams:function(e,t,i,a,r){if(!u.isInteger(i))return null;var s=v.addHitTypeParameter("timing"),n=[[c,e],[l,t],[d,i]];a&&n.push([C,a]);for(var o=0;o<n.length;o++)s+=v.addURIParam(n[o][0],n[o][1]);return s+=v.addCustomDimensionsParameters(r)}}}(AvayaClientServices),function(o){"use strict";function e(e,t,i,a,r){o.Base.Observable.call(this),this._restProvider=t,this._notificationProvider=i,this._restKeepAliveProvider=a,this._residueRestKeepAliveProvider=m,this._messageBuilder=e,this._csgConfig=m,this._notificationsConfig=m,this._maxConnectionErrorCount=5,this._credentials=m,this._started=!1,this._isNetworkAvailable=!1,this._startPromise=m,this._eTag=m,this._cancelDiscovery=!1,this._resourceHrefs={},this._restResources={},this._notificationResources={},this._activeServices=[],this._serviceParameters={},this._notificationPromises={},this._notificationHandlers={},this._failoverPingData={wsKeepAliveEnabled:!0,wsPingInterval:3e4,wsGeneratePingMessage:function(){var e=o.Base.Utils.makeId(32,"0123456789abcdef"),t={ping:{requestId:this._failoverPingData.wsPingMessageRequestId=e,version:"1"}};return JSON.stringify(t)}.bind(this),wsIsPongMessage:function(e){var t="string"==typeof e?JSON.parse(e):e;return o.Base.Utils.isDefined(t.pong)&&this._failoverPingData.wsPingMessageRequestId===t.pong.requestId}.bind(this),wsPingMessageRequestId:"",keepAliveAnswerWaitingTime:5e3,ssePingInterval:65e3},this._blackListedWords=["remoteDisplayName","Authorization","authentication","meetingToken","meetingPasscode","meetingId","userIdentity","rlPresenceUpdatedEvent","contact","remoteAddress","targetRemoteAddress","targetCallId","participantId","webCollaborationUrl","callInfo"],this._discoveryBackoffDataObject=m,this._clientId=m,this._discoveryCounter=0}(e.prototype=Object.create(o.Base.Observable.prototype)).start=function(e){if(!this._started&&!this._startPromise){this._started=!0,this._csgConfig=e,this._discoveryCounter=0,this._cancelDiscovery=!1,this._startPromise=T.Deferred();var t=function(){this._discoverResources().then(this._startNotificationProvider.bind(this),function(e){if(e!==o.Providers.CallServiceGateway.Constants.RESOURCE_DISCOVERY_USERNAME_MISMATCH)return T.Deferred().reject(e).promise();this._clientId=m,t.call(this)}.bind(this)).then(function(){this._restProvider.onError=function(){},this._startRefreshingClientSession(),o.Base.Logger.debug(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Provider has been started successfully"),o.Base.Utils.isDefined(this._startPromise)&&this._startPromise.resolve()}.bind(this),function(e){o.Base.Utils.isDefined(this._startPromise)&&this._startPromise.reject(e)}.bind(this))}.bind(this);this._startRestProvider().then(t.bind(this))}return this._startPromise.promise()},e.prototype.stop=function(){if(!this._started&&this._isNetworkAvailable)return T.Deferred().reject("CSGProvider: Provider is not started").promise();if(0<this._activeServices.length)return T.Deferred().resolve().promise();o.Base.Utils.isDefined(this._discoveryBackoffDataObject)&&this._discoveryBackoffDataObject.cancel();var t,e=T.Deferred(),i=function(e){t||(t=e)};return this._isNetworkAvailable?this._stopNotificationProvider().then(function(){return this._stopRefreshingClientAndRestSession()}.bind(this),function(e){return i(e),this._stopRefreshingClientAndRestSession()}.bind(this)).then(function(){return this._stopRestProvider()}.bind(this),function(e){return i(e),this._stopRestProvider()}.bind(this)).fail(function(e){i(e)}).always(function(){this._cleanupAfterStop(),t?e.reject(t):e.resolve()}.bind(this)):(this._pauseRefreshingClientSession(),this._stopNotificationProvider().always(function(){this._stopRestProvider().always(function(){this._cleanupAfterStop()}.bind(this)),e.reject(new o.Base.NetworkError(o.Base.ErrorReasons.NETWORK_ERROR))}.bind(this))),e.promise().then(function(){o.Base.Logger.debug("CSGProvider: Provider has been stopped successfully")})},e.prototype.stopImmediately=function(){if(!this._started)return T.Deferred().reject("CSGProvider: Provider is not started");var t,e=T.Deferred(),i=function(e){t||(t=e)};return this._pauseRefreshingClientSession(),o.Base.Utils.isDefined(this._discoveryBackoffDataObject)&&this._discoveryBackoffDataObject.cancel(),this._stopRefreshingClientSessionSynchronously().then(function(){return this._stopNotificationProvider()}.bind(this),function(e){return i(e),this._stopNotificationProvider()}.bind(this)).then(function(){return this._stopRestProvider()}.bind(this),function(e){return i(e),this._stopRestProvider()}.bind(this)).fail(function(e){i(e)}.bind(this)).always(function(){this._cleanupAfterStop(),t?e.reject(t):e.resolve()}.bind(this)),e.promise().then(function(){o.Base.Logger.debug("CSGProvider: Provider has been stopped successfully")})},e.prototype._cleanupAfterStop=function(){this._removeListeners(),this._started=!1,this._discoveryCounter=0,this._cancelDiscovery=!1,this._notificationsConfig=m,this._credentials=m,this._startPromise=m,this._eTag=m,this._clientId=m,this._resourceHrefs={},this._restResources={},this._notificationResources={},this._activeServices=[],this._notificationPromises={},this._notificationHandlers={},o.Base.Logger.debug(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Provider has been stopped successfully")},e.prototype._startRestProvider=function(){var e=T.Deferred();return this._restProvider._onCredentialsRequired=this._onCredentialsRequired.bind(this),this._restProvider.registerBlackList(this._blackListedWords),this._restProvider.onMessage=function(e,t){if(void 0!==t){var i=t.getResponseHeader("ETag");null!=i&&(this._eTag=i)}}.bind(this),this._restProvider.onConnectionUnavailable=function(e){this._handleError("Unable to communicate with REST server"),this.trigger(o.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,["REST",e])}.bind(this),this._restProvider.onOpen=function(){this._restProvider.onError=function(e){this._isNetworkAvailable&&(this._isNetworkAvailable=!1,this.trigger(o.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,["REST",e]))}.bind(this),e.resolve()}.bind(this),this._restProvider.on(o.Base.NetworkProviderEvents.UNAUTHORIZED,function(){e.reject(o.Base.NetworkProviderEvents.UNAUTHORIZED),this.trigger(o.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._restProvider.on(o.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(o.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),this._restProvider.start(this._csgConfig.networkProviderConfiguration,this._csgConfig.credentialProvider),e.promise()},e.prototype._stopNotificationProvider=function(){var t=T.Deferred();return this._notificationProvider.onClose=function(){t.resolve(),o.Base.Logger.warn("CSGProvider: Notification service websocket connection is closed")},this._notificationProvider.stopMonitorFallback(),this._isNetworkAvailable?(this._notificationProvider.onError=function(e){o.Base.Logger.warn("CSGProvider: Notification service websocket connection is closed with error",e),t.resolve()},this._notificationProvider.close()):t.reject(new o.Base.NetworkError(o.Base.ErrorReasons.NETWORK_ERROR)),t.promise()},e.prototype._stopRestProvider=function(){return this._restProvider.close()},e.prototype.activateService=function(t,e){var i=this._messageBuilder.buildActivateServiceOptions(this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.Services]),a=this._messageBuilder.buildActivateServiceData(t,e);if(-1!==this._activeServices.indexOf(t))return o.Base.Logger.debug(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Service already activated",t),T.Deferred().resolve().promise();this._serviceParameters[t]=e;var r=JSON.stringify(a);return o.Base.Utils.callFunction(this._restProvider,this._restProvider.send,[r,i],5,3200).then(function(){this._activeServices.push(t),o.Base.Logger.debug(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Service activated",t)}.bind(this),function(e){return o.Base.Logger.debug(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to activate service",t),T.Deferred().reject(e).promise()}.bind(this))},e.prototype._reactivateService=function(){var e=this._activeServices.indexOf(o.Providers.CallServiceGateway.Constants.CALLS);-1!==e&&(this._activeServices.splice(e,1),this.activateService(o.Providers.CallServiceGateway.Constants.CALLS,this._serviceParameters[o.Providers.CallServiceGateway.Constants.CALLS]));var t=this._activeServices.indexOf(o.Providers.CallServiceGateway.Constants.PRESENCE);-1!==t&&(this._activeServices.splice(t,1),this.activateService(o.Providers.CallServiceGateway.Constants.PRESENCE,this._serviceParameters[o.Providers.CallServiceGateway.Constants.PRESENCE]))},e.prototype.deactivateService=function(i){var e=this._messageBuilder.buildDeactivateServiceOptions(this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.Services]),t=JSON.stringify(this._messageBuilder.buildDeactivateServiceData(i)),a=T.Deferred();return o.Base.Utils.callFunction(this._restProvider,this._restProvider.send,[t,e],2,2500).then(function(){var e=this._activeServices.indexOf(i);-1<e&&this._activeServices.splice(e,1),o.Base.Logger.debug(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Service deactivated: "+i+"; active service count: "+this._activeServices.length),a.resolve()}.bind(this),function(e){o.Base.Logger.debug(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Failed to deactivate service: "+i);var t=this._activeServices.indexOf(i);return-1<t&&this._activeServices.splice(t,1),a.reject(e),T.Deferred().reject(e).promise()}.bind(this)),a.promise()},e.prototype._deactivateServicesImmediately=function(){var e=this._messageBuilder.buildDeactivateServiceOptions(this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.Services]);e.async=!1;var t=JSON.stringify(this._messageBuilder.buildDeactivateServiceData(o.Providers.CallServiceGateway.Constants.CALLS));this._restProvider.send(t,e);var i=JSON.stringify(this._messageBuilder.buildDeactivateServiceData(o.Providers.CallServiceGateway.Constants.PRESENCE));this._restProvider.send(i,e)},e.prototype._discoverResources=function(){if(this._cancelDiscovery)return T.Deferred().reject("Resource Discovery Cancelled").promise();var s=T.Deferred(),e=function(e){"pending"===this._startPromise.state()&&(this.trigger(o.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,["REST","Resource Discovery"]),this._startPromise.reject("Resource discovery failed detected"))}.bind(this),t=function(){var e,t=this._messageBuilder.buildResourceDiscoveryData(this._clientId),i=this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.Clients];if(i){var a=(i=i.replace("/users/self/clients","")).indexOf("/csa"),r=i.indexOf("/bsid"),s=i.lastIndexOf("/resources");-1!==a&&-1!==r&&-1!==s&&(e=i.substring(a,r)+i.substring(s))}o.Base.Utils.isUndefined(e)&&(e=this._csgConfig.networkProviderConfiguration.restConfig.path);var n=this._messageBuilder.buildResourceDiscoveryOptions(e);return this._credentials&&this._credentials.isGuest&&(t.name=this._credentials.displayName),this._restProvider.send(t,n)}.bind(this);return o.Base.Utils.isDefined(this._discoveryBackoffDataObject)&&this._discoveryBackoffDataObject.cancel(),this._discoveryBackoffDataObject=o.Base.Utils.connectionBackoffAlgorithm(t,e),this._discoveryBackoffDataObject.dfdPromise.then(function(e){if(this._discoveryBackoffDataObject=m,null!==e){if(this._restResources=T.extend({},new o.Providers.CallServiceGateway.RestResources,e),e.clientId&&(this._clientId=e.clientId),e.resources)for(var t=0;t<e.resources.length;t++){var i=e.resources[t];this._resourceHrefs[i.name]=i.serviceReference.href,"calls"===i.name?i.serviceReference.supported?this.trigger(o.Providers.CallServiceGateway.ObservableEvents.SUPPORTED_CALL_ENHANCEMENTS,[i.serviceReference.supported]):this.trigger(o.Providers.CallServiceGateway.ObservableEvents.SUPPORTED_CALL_ENHANCEMENTS,[]):"upload-logs"===i.name&&this.trigger(o.Providers.CallServiceGateway.ObservableEvents.UPLOAD_LOGS_UPDATE,[i.serviceReference.href,i.bucketName,this._clientId])}if(e.sessionManagement){this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.RestSessionMgmt]=e.sessionManagement.href;var a=o.Base.Utils.queryJSONObject(e,"sessionManagement.username");if(o.Base.Utils.isDefined(this._credentials.username)){var r=this._credentials.username;0<=r.indexOf("csaGuest/")&&(r=r.substring("csaGuest/".length)),o.Base.Utils.isDefined(a)&&a!==r&&(!this._credentials.isGuest||0!==a.indexOf("jsg-")&&0!==a.indexOf("sessionId-")?(o.Base.Logger.warn(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Rediscovering resources due to mismatch username"),this._deleteRestSession(),this._clientId=m,s.reject(o.Providers.CallServiceGateway.Constants.RESOURCE_DISCOVERY_USERNAME_MISMATCH)):(o.Base.Logger.info(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Overriding mismatch guest username"),this._credentials.username="csaGuest/"+a,this._csgConfig.credentialProvider.username=this._credentials.username))}}e.clientManagement&&(this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.ClientKeepAlive]=e.clientManagement.refreshClient.href,this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.ClientTerminate]=e.clientManagement.terminateClient.href,e.clientManagement.fastDelete&&(this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.FastDelete]=e.clientManagement.fastDelete.href)),e.stunServers&&this.trigger(o.Providers.CallServiceGateway.ObservableEvents.ICE_CONFIG_UPDATES,[e.stunServers]),e.presence&&(this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.PublishPresenceMode]=e.presence.manualMode.set.href,this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.PublishPresenceState]=e.presence.manualPresenceState.set.href,this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.PublishPresenceNote]=e.presence.manualNote.set.href,this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.DeletePresenceMode]=e.presence.manualMode.delete.href,this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.DeletePresenceState]=e.presence.manualPresenceState.delete.href,this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.DeletePresenceNote]=e.presence.manualNote.delete.href),e.pubSubContainers&&(this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.CreatePresenceContainer]=e.pubSubContainers.create.href),e.notificationService?(this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.Websocket]=e.notificationService.websocket.href,this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.SSE]=e.notificationService.sse.href,this._createNotificationsConfig(),s.resolve()):s.reject("Notification service is undefined")}}.bind(this),function(e){this._handleError("_discoverResources() network provider failed - "+e),s.reject(e)}.bind(this)),s.promise()},e.prototype._createNotificationsConfig=function(){var e=o.Base.Utils.parseUrl(this._restResources.notificationService.websocket.href),t=new o.Config.ServerInfo(e.hostname,e.port,e.isSecure,e.path),i=o.Base.Utils.parseUrl(this._restResources.notificationService.sse.href),a=new o.Config.ServerInfo(i.hostname,i.port,i.isSecure,i.path),r=new o.Config.ServerInfo;this._notificationsConfig=new o.Config.NetworkProviderConfiguration(r,t,a,this._maxConnectionErrorCount)},e.prototype._startNotificationProvider=function(){var i=T.Deferred();if(this._notificationProvider.isOpened())return i.resolve().promise();if(!this._notificationsConfig)return i.reject(new Error("Unable to start notifications service - Notifications provider configuration is absent")).promise();this._notificationProvider.onOpen=function(){o.Base.Logger.debug(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Notifications provider has been started"),this._isNetworkAvailable=!0,this._notificationProvider.onMessage=function(e){var t;(t=e.data&&e.type!==o.Base.ProvidersEventTypes.PING?JSON.parse(e.data):e).notification?this._onNotification(t.notification):t.subscribed?this._onSubscribed(t.subscribed):t.discovery&&(this._onNotificationDiscovery(t.discovery),this.trigger(o.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE),i.resolve())}.bind(this)}.bind(this),this._notificationProvider.onError=function(e){o.Base.Logger.warn(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Notification service websocket connection failed: ",e),i.reject(new o.Base.NetworkError(o.Base.ErrorReasons.NETWORK_ERROR)),this._isNetworkAvailable&&(this._isNetworkAvailable=!1,this.trigger(o.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,["Notification",e]))}.bind(this),this._notificationProvider.on(o.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(o.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._notificationProvider.on(o.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(o.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this));var e=function(){var t=T.Deferred();return this._pauseRefreshingClientSession(),this._isNetworkAvailable&&(this._isNetworkAvailable=!1,this.trigger(o.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,["Notification","Unavailable"])),this._activeServices=[],this._discoverResources().then(function(){this._startNotificationProvider().then(function(){this._reactivateService(),this._startRefreshingClientSession(),t.resolve()}.bind(this),function(e){t.reject(e)})}.bind(this),function(e){t.reject(e)}),t.promise()}.bind(this);return this._notificationProvider.registerBlackList(this._blackListedWords),this._notificationProvider.start(this._notificationsConfig,m,m,m,e,this._failoverPingData).then(function(){return o.Base.Utils.rejectIfPromiseNotResolvedInTime(i.promise(),3e4,new o.Base.BaseError(o.Base.ErrorReasons.TIMEOUT),function(){o.Base.Logger.error(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Notification discovery was not received in time"),this.trigger(o.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,["Notification","Unavailable"])}.bind(this))}.bind(this),function(){o.Base.Logger.error(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Start notification channel failed.")}),i.promise()},e.prototype._onNotificationDiscovery=function(e){if(this._notificationResources=T.extend({},new o.Providers.CallServiceGateway.NotificationResources,e),this._notificationResources.commandURL&&this._resourceHrefs.hasOwnProperty(o.Providers.CallServiceGateway.ResourceType.SSE)){o.Base.Logger.debug(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Using SSE connection");var t=o.Base.Utils.parseUrl(this._notificationResources.commandURL);this._notificationsConfig.restConfig.hostName=t.hostname,this._notificationsConfig.restConfig.port=t.port,this._notificationsConfig.restConfig.isSecure=t.isSecure,this._notificationsConfig.restConfig.path=t.path}},e.prototype._onSubscribed=function(e){if(e.requestId&&e.results){var t=this._notificationPromises[e.requestId];if(t)if(o.Base.Utils.queryJSONObject(e,"results.successful[0].application")===o.Providers.CallServiceGateway.Constants.CSA_APPLICATION)t.resolve(),o.Base.Logger.debug(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Subscribed",o.Base.Utils.queryJSONObject(e,"results.successful[0].resource"));else if(o.Base.Utils.queryJSONObject(e,"results.failed[0].application")===o.Providers.CallServiceGateway.Constants.CSA_APPLICATION){var i=o.Base.Utils.queryJSONObject(e,"results.failed[0].error.description");t.reject({message:"Failed to subscribe for notifications",details:i})}}},e.prototype._onNotification=function(e){if(e.application===o.Providers.CallServiceGateway.Constants.CSA_APPLICATION&&e.resource){var t=this._notificationHandlers[e.resource];t&&t(e.contents)}},e.prototype.subscribeForNotifications=function(e,t){var i=T.Deferred(),a=i.promise();return a.then(function(){this._notificationHandlers[e.subscribe.resources[0].resource]=t}.bind(this)),this._notificationPromises[e.subscribe.requestId]=i,this.sendNotification(JSON.stringify(e),this._messageBuilder.buildNotificationsOptions()),a},e.prototype.unsubscribeFromNotifications=function(e){return this.sendNotification(JSON.stringify(e),this._messageBuilder.buildNotificationsOptions()).always(function(){delete this._notificationHandlers[e.unsubscribe.resources[0].resource]}.bind(this))},e.prototype.send=function(e,t){return this._restProvider.send(e,t).fail(function(e){var t=this._parseNetworkError(e);t&&(o.Base.Utils.queryJSONObject(t,"error[0].errorCode")!==o.Providers.CallServiceGateway.Constants.CALL_DOES_NOT_EXISTS&&this._handleError(JSON.stringify(e)))}.bind(this))},e.prototype.sendNotification=function(e,t){return this._notificationProvider.send(e,t).fail(function(e){this._handleError(JSON.stringify(e))}.bind(this))},e.prototype.getRestResources=function(){return this._restResources},e.prototype.getNotificationResources=function(){return this._restResources},e.prototype.getResourceHrefs=function(){return this._resourceHrefs},e.prototype.getCredentials=function(){return this._credentials},e.prototype.restProviderOnErrorHandler=function(e){this._restProvider.onError=e},e.prototype.forceNetworkRecovery=function(){this._notificationProvider.onConnectionUnavailable(),this._notificationProvider.close()},e.prototype._onCredentialsRequired=function(t,e){e&&e!==this._csgConfig.credentialProvider&&o.Base.Utils.deepMerge(this._csgConfig.credentialProvider,e),this._csgConfig.credentialProvider.onAuthenticationChallenge(void 0,function(e){this._onCredentialsRetrieved(e,t)}.bind(this))},e.prototype._onCredentialsRetrieved=function(e,t){o.Base.Utils.isDefined(t.options)&&(t.options.authentication=t.options.authentication||{},e.token?(e.bearer=e.bearer||o.Config.Authentication.TokenType.BEARER,(o.Base.Utils.isUndefined(this._credentials)||this._credentials.token!==e.token)&&(this._credentials=e),t.options.authentication.type=o.Config.Authentication.Scheme.BEARER,t.options.authentication.token=e.token,t.options.authentication.bearer=e.bearer):((o.Base.Utils.isUndefined(this._credentials)||this._credentials.username!==e.username||this._credentials.password!==e.password)&&(this._credentials=e),t.options.authentication.type=o.Config.Authentication.Scheme.BASIC,t.options.authentication.username=e.username,t.options.authentication.password=e.password))},e.prototype._startRefreshingRestSession=function(){var e=this._messageBuilder.buildKeepAliveOptions();this._restResources.sessionManagement&&(this._restKeepAliveProvider.stopPolling(),this._restKeepAliveProvider.startPolling(this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.RestSessionMgmt],1e3*this._restResources.sessionManagement.timeout*.8,{},e))},e.prototype._pauseRefreshingRestSession=function(){return this._restKeepAliveProvider.stopPolling()},e.prototype._startRefreshingClientSession=function(){var e=this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.ClientKeepAlive];if(o.Base.Utils.isDefined(e)){var t=this._messageBuilder.buildKeepAliveOptions(this._csgConfig);this._residueRestKeepAliveProvider&&(this._residueRestKeepAliveProvider.stopPolling(),this._residueRestKeepAliveProvider=m),this._restKeepAliveProvider.stopPolling(),this._restKeepAliveProvider.startPolling(e,1e3*this._restResources.clientManagement.timeout*.8,{},t),this._restKeepAliveProvider.onMessage=function(e){this._residueRestKeepAliveProvider&&(this._residueRestKeepAliveProvider.stopPolling(),this._residueRestKeepAliveProvider=m),this._isNetworkAvailable||(this._isNetworkAvailable=!0,this.trigger(o.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE))}.bind(this),this._restKeepAliveProvider.onError=function(e){o.Base.Logger.error(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Network error detected while pinging session management: ",e),this._isNetworkAvailable?(this._isNetworkAvailable=!1,this.trigger(o.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,["REST",e]),this._monitorKeepAliveSession()):this._residueRestKeepAliveProvider&&(this._residueRestKeepAliveProvider.stopPolling(),this._residueRestKeepAliveProvider=m,this.forceNetworkRecovery())}.bind(this)}else this._startRefreshingRestSession()},e.prototype._monitorKeepAliveSession=function(){var e=this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.ClientKeepAlive];if(o.Base.Utils.isDefined(e)){var t=this._messageBuilder.buildKeepAliveOptions(this._csgConfig);this._residueRestKeepAliveProvider?this._residueRestKeepAliveProvider.stopPolling():this._residueRestKeepAliveProvider=new o.Base.PollingRESTProvider;var i=3e4;this._restResources.clientManagement.timeout<30&&(i=1e3*this._restResources.clientManagement.timeout*(1-.8)),this._residueRestKeepAliveProvider.startPolling(e,i,{},t),this._residueRestKeepAliveProvider.onMessage=function(e){this._isNetworkAvailable||(this._isNetworkAvailable=!0,this.trigger(o.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_AVAILABLE)),this._startRefreshingClientSession()}.bind(this),this._restKeepAliveProvider.onError=function(e){o.Base.Logger.error(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Network error detected while pinging session management: ",e),this._isNetworkAvailable&&(this._isNetworkAvailable=!1,this.trigger(o.Providers.CallServiceGateway.ObservableEvents.NETWORK_PROVIDER_IS_UNAVAILABLE,["REST",e]))}.bind(this)}},e.prototype._pauseRefreshingClientSession=function(){return this._residueRestKeepAliveProvider&&(this._residueRestKeepAliveProvider.stopPolling(),this._residueRestKeepAliveProvider=m),this._restKeepAliveProvider.stopPolling()},e.prototype._stopRefreshingClientAndRestSession=function(){return this._pauseRefreshingClientSession(),this._invokeIfNetworkIsAvailable(function(){return this._invokeIfNetworkIsAvailable(this._deleteClientSession.bind(this)).then(function(){return this._invokeIfNetworkIsAvailable(this._deleteRestSession.bind(this))}.bind(this),function(e){return this._invokeIfNetworkIsAvailable(this._deleteRestSession.bind(this))}.bind(this))}.bind(this))},e.prototype._stopRefreshingClientSessionSynchronously=function(){return this._restKeepAliveProvider.stopPolling(),this._deleteClientSessionImmediately()},e.prototype._deleteClientSession=function(e){var t=this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.ClientTerminate];if(this._isNetworkAvailable&&o.Base.Utils.isDefined(t)){var i=this._messageBuilder.buildDeleteSessionOptions(t);return o.Base.Utils.isDefined(e)&&(i.async=e),this._restProvider.send(null,i)}return T.Deferred().resolve().promise()},e.prototype._deleteClientSessionImmediately=function(){var e=this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.FastDelete];return e&&navigator.sendBeacon?navigator.sendBeacon(e)?T.Deferred().resolve().promise():T.Deferred().reject("Failed to delete client session").promise():this._deleteClientSession(!1)},e.prototype._deleteRestSession=function(e){var t=this._messageBuilder.buildDeleteSessionOptions(this._resourceHrefs[o.Providers.CallServiceGateway.ResourceType.RestSessionMgmt]);return o.Base.Utils.isDefined(e)&&(t.async=e),this._restProvider.send(null,t)},e.prototype._invokeIfNetworkIsAvailable=function(e){return this._isNetworkAvailable?e():T.Deferred().reject("Network is unavailable").promise()},e.prototype._handleError=function(e){o.Base.Logger.error(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Error detected: "+e)},e.prototype._parseNetworkError=function(e){var t=o.Base.Utils.queryJSONObject(e,"_data._responseText");if(t)try{return JSON.parse(t)}catch(e){}return m},e.prototype.isNetworkAvailable=function(){return this._isNetworkAvailable},e.prototype.cancelDiscovery=function(){this._cancelDiscovery=!0,o.Base.Utils.isDefined(this._discoveryBackoffDataObject)&&this._discoveryBackoffDataObject.cancel(),o.Base.Logger.info(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,"Resource discovery cancelled")},e.prototype.invalidateClient=function(){this._clientId=m,this._pauseRefreshingClientSession()},e.prototype.isNetworkEventsUrlDefined=function(){return!!this.getResourceHrefs().mpaasevents},e.prototype.setOnNetworkEvents=function(e){if(!this.isNetworkEventsUrlDefined()){var t=new o.Services.Call.CallException(o.Services.Call.CallError.NETWORK_EVENTS_SUBSCRIPTION_UNAVAILABLE);return o.Base.Logger.error(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,t),T.Deferred().reject(t).promise()}var i=this._messageBuilder.buildSubscribeGenericEventsOptions(this.getResourceHrefs().mpaasevents),a=JSON.stringify(e);return this._restProvider.send(a,i)},e.prototype.removeOnNetworkEvents=function(e){if(!this.isNetworkEventsUrlDefined()){var t=new o.Services.Call.CallException(o.Services.Call.CallError.NETWORK_EVENTS_SUBSCRIPTION_UNAVAILABLE);return o.Base.Logger.error(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,t),T.Deferred().reject(t).promise()}var i=this._messageBuilder.buildUnsubscribeGenericEventsOptions(this.getResourceHrefs().mpaasevents,e);return this._restProvider.send(null,i)},e.prototype.updateOnNetworkEvents=function(e){if(!this.isNetworkEventsUrlDefined()){var t=new o.Services.Call.CallException(o.Services.Call.CallError.NETWORK_EVENTS_SUBSCRIPTION_UNAVAILABLE);return o.Base.Logger.error(o.Base.LoggerTags.CSG_PRESENCE_AND_CALL_PROVIDER,t),T.Deferred().reject(t).promise()}var i=this._messageBuilder.buildUpdateGenericEventsOptions(this.getResourceHrefs().mpaasevents),a=JSON.stringify(e);return this._restProvider.send(a,i)},o.Providers.CallServiceGateway.CSGProvider=e}(AvayaClientServices),function(n){"use strict";function e(e,t,i){n.Providers.Interfaces.ConferenceDataProvider.call(this),this._networkProvider=e,this._config=m,this._messageBuilder=t,this._messageParser=i,this._isStarted=!1}(e.prototype=Object.create(n.Providers.Interfaces.ConferenceDataProvider.prototype)).start=function(e){var t=T.Deferred();return this._config=e,this._isStarted=!0,t.resolve(),t.promise()},e.prototype.onCredentialsRequired=function(t,e){e&&e!==this._config.credentialProvider&&n.Base.Utils.deepMerge(this._config.credentialProvider,e),this._config.credentialProvider.onAuthenticationChallenge(void 0,function(e){this.onCredentialsRetrieved(e,t)}.bind(this))},e.prototype.onCredentialsRetrieved=function(e,t){},e.prototype.sendHandshake=function(e){var t=this._messageBuilder.buildHandshakeRequest(e);return this._sendMessage(t,"success")},e.prototype.subscribeMeetingInfo=function(e){var t=this._messageBuilder.buildSubscribeMeetingInfoRequest(e);return this._sendMessage(t,"success")},e.prototype.startRecording=function(e,t,i){var a=this._messageBuilder.buildSetRecordingRequest(e,n.Services.Conference.RecordingOperation.START,t,i);return this._sendMessage(a,"success")},e.prototype.stopRecording=function(e){var t=this._messageBuilder.buildSetRecordingRequest(e,n.Services.Conference.RecordingOperation.STOP);return this._sendMessage(t,"success")},e.prototype.pauseRecording=function(e){var t=this._messageBuilder.buildSetRecordingRequest(e,n.Services.Conference.RecordingOperation.PAUSE);return this._sendMessage(t,"success")},e.prototype.resumeRecording=function(e){var t=this._messageBuilder.buildSetRecordingRequest(e,n.Services.Conference.RecordingOperation.RESUME);return this._sendMessage(t,"success")},e.prototype.subscribeRoster=function(e){var t=this._messageBuilder.buildSubscribeRosterRequest(e);return this._sendMessage(t,"success")},e.prototype.subscribeActiveTalker=function(e){var t=this._messageBuilder.buildSubscribeActiveTalkerRequest(e);return this._sendMessage(t,"success")},e.prototype.subscribePermissions=function(e){var t=this._messageBuilder.buildSubscribePermissionsRequest(e);return this._sendMessage(t,"success")},e.prototype.subscribeSlider=function(e){var t=this._messageBuilder.buildSubscribeSliderRequest(e);return this._sendMessage(t,"success")},e.prototype.subscribeMeetingNote=function(e){var t=this._messageBuilder.buildSubscribeMeetingNoteRequest(e);return this._sendMessage(t,"success")},e.prototype.subscribeWebCollab=function(e){var t=this._messageBuilder.buildSubscribeWebCollabRequest(e);return this._sendMessage(t,"success")},e.prototype.subscribeAvailableLayouts=function(e){var t=this._messageBuilder.buildSubscribeAvailableLayoutsRequest(e);return this._sendMessage(t,"success")},e.prototype.setAsLecturer=function(e,t){var i=this._messageBuilder.buildSetAsLecturerRequest(e,t);return this._sendMessage(i,"success")},e.prototype.unsetAsLecturer=function(e){var t=this._messageBuilder.buildUnsetAsLecturerRequest(e);return this._sendMessage(t,"success")},e.prototype.disconnectParticipant=function(e,t){var i=this._messageBuilder.buildDisconnectParticipantRequest(e,t._participantId);return this._sendMessage(i,"success")},e.prototype.setLocked=function(e,t){var i=this._messageBuilder.buildLockMeetingRequest(e,t);return this._sendMessage(i,"success")},e.prototype.muteUnmute=function(e,t,i,a){var r=this._messageBuilder.buildModeratorMuteRequest(e,t,i,a);return this._sendMessage(r,"success")},e.prototype.controlRemoteCamera=function(e,t,i){var a=this._messageBuilder.buildFeccRequest(e,t,i);return this._sendMessage(a,"success")},e.prototype.muteUnmuteAll=function(e,t){var i=this._messageBuilder.buildMuteAllRequest(e,t);return this._sendMessage(i,"success")},e.prototype.sendLocalMuteEvent=function(e,t,i){var a=this._messageBuilder.buildLocalMuteEvent(e,t,i);return this._networkProvider.send(JSON.stringify(a))},e.prototype.sendDisconnectEvent=function(e,t){var i=this._messageBuilder.buildDisconnectEvent(e,t);return this._networkProvider.send(JSON.stringify(i))},e.prototype.terminateConference=function(e){var t=this._messageBuilder.buildTerminateMeetingRequest(e);return this._sendMessage(t,"success")},e.prototype.requestToBecomeModerator=function(e,t){var i=this._messageBuilder.buildStartModerationRequest(e,t);return this._sendMessage(i,"success")},e.prototype.signIn=function(e,t){var i=this._messageBuilder.buildUpdateCredentialsTokenRequest(e,t);return this._sendMessage(i,"success")},e.prototype.videoPin=function(e,t,i,a,r,s){var n=this._messageBuilder.buildVideoPinRequest(e,t,i,a,r,s);return this._sendMessage(n,"success")},e.prototype.extendMeeting=function(e,t){var i=this._messageBuilder.buildExtendMeetingRequest(e,t);return this._sendMessage(i,"success")},e.prototype.addParticipant=function(e,t){var i=this._messageBuilder.buildDialoutRequest(e,t);return this._sendMessage(i,n.Services.Conference.DialoutStatus.DIALING)},e.prototype.cancelDialoutParticipant=function(e,t){var i=this._messageBuilder.buildCancelDialoutRequest(e,t);return this._sendMessage(i,"success")},e.prototype.sendChatMessage=function(e,t,i){var a=this._messageBuilder.buildSendChatMessage(e,t,i);return this._sendMessage(a,"success")},e.prototype.setVideoLayout=function(e,t){var i=this._messageBuilder.buildChangeLayoutGeometryRequest(e,t);return this._sendMessage(i,"success")},e.prototype.setVideoLayoutSelfSee=function(e,t){var i=this._messageBuilder.buildChangeLayoutNoSelfSeeRequest(e,!t);return this._sendMessage(i,"success")},e.prototype.setVideoLayoutTextOverlay=function(e,t){var i=this._messageBuilder.buildChangeLayoutTextOverlayRequest(e,t);return this._sendMessage(i,"success")},e.prototype.getCurrentVideoLayout=function(e){var t=this._messageBuilder.buildCurrentLayoutRequest(e);return this._sendMessage(t,"success")},e.prototype.raiseLowerHand=function(e,t){var i=this._messageBuilder.buildRaiseHandRequest(e,t);return this._sendMessage(i,"success")},e.prototype.moderatorLowerHand=function(e,t,i){var a=this._messageBuilder.buildModeratorLowerHandRequest(e,t,i);return this._sendMessage(a,"success")},e.prototype.moderatorAdmission=function(e,t,i){var a=this._messageBuilder.buildModeratorAdmissionRequest(e,t,i);return this._sendMessage(a,"success")},e.prototype.sendAdmissionRequest=function(e,t){var i=T.Deferred(),a=this._messageBuilder.buildAdmissionRequest(e,t);return this._sendMessage(a,[n.Services.Conference.AdmissionResponseCode.SUCCESS,n.Services.Conference.AdmissionResponseCode.INCORRECT_PASSCODE_TRY_AGAIN,n.Services.Conference.AdmissionResponseCode.PENDING_APPROVAL,n.Services.Conference.AdmissionResponseCode.INCORRECT_PASSCODE_DISCONNECTING,n.Services.Conference.AdmissionResponseCode.REJECTED]).then(function(e){this._resolveAdmissionResponse(i,e)}.bind(this),function(e){i.reject(e)}),this.on(n.Providers.UCCP.UCCPMessageTypes.ADMISSION_RESPONSE,function(e){this._resolveAdmissionResponse(i,e)}.bind(this)),i.promise()},e.prototype._resolveAdmissionResponse=function(e,t){switch(t.responseCode){case n.Services.Conference.AdmissionResponseCode.SUCCESS:e.resolve(t);break;case n.Services.Conference.AdmissionResponseCode.INCORRECT_PASSCODE_DISCONNECTING:case n.Services.Conference.AdmissionResponseCode.REJECTED:case n.Services.Conference.AdmissionResponseCode.INCORRECT_PASSCODE_TRY_AGAIN:e.reject({name:"UCCPServerError",code:t.responseCode,message:"UCCP server responded with "+t.responseCode});break;case n.Services.Conference.AdmissionResponseCode.PENDING_APPROVAL:break;default:n.Base.Logger.warn(n.Base.LoggerTags.UCCP_CONFERENCE_PROVIDER,"Unknown response code received: {0}",t.responseCode)}},e.prototype.getDialInInfo=function(e){var t=this._messageBuilder.buildDialInInfoRequest(e);return this._sendMessage(t,"success")},e.prototype._sendMessage=function(e,t){var i=T.Deferred(),a=this._networkProvider._communicationAdapter instanceof n.Providers.UCCP.UCCPLongPollingProvider,r=n.Base.Utils.queryJSONObject(e,"params.transId");if(a){var s={dfd:i,successIndicator:t};this._networkProvider._communicationAdapter._responsesData[r]=s}return this._networkProvider.send(JSON.stringify(e)).then(function(e){a||this._resolveResponse(i,e,t)}.bind(this),function(e){a&&this._networkProvider._communicationAdapter._responsesData&&delete this._networkProvider._communicationAdapter._responsesData[r],i.reject(e)}.bind(this)),i.promise()},e.prototype._resolveResponse=function(t,e,i){var a;try{a=this._messageParser.parse(e)}catch(e){return void t.reject(e)}if(a&&a.responseCode&&(i.indexOf?-1<i.indexOf(a.responseCode):a.responseCode===i))t.resolve(a);else{var r=400;e&&e.params&&e.params.responseCode&&(r=e.params.responseCode),t.reject({name:"UCCPServerError",code:r,message:"UCCP server responded with "+r})}},n.Providers.UCCP.AbstractUCCPProvider=e}(AvayaClientServices),function(n){"use strict";function e(e,t,i){n.Providers.UCCP.AbstractUCCPProvider.call(this),this._networkProvider=e,this._config=m,this._messageBuilder=t,this._messageParser=i,this._networkRequestRetryHelper=m,this._reconnectCount=0,this._isReconnecting=!1,this._isStarted=!1,this._fallbackPromise=m,this._blackListedWords=["participantId","text","lecturerName","presenterName","participantName","videoPin","participantDisplayName","meetingName","virtualRoomName","userId","callerId","login","virtualRoomOwnerId","email"],this._failoverPingData={wsKeepAliveEnabled:!0,wsPingInterval:3e4,wsGeneratePingMessage:function(){var e=n.Base.Utils.makeId(32,"0123456789abcdef");this._failoverPingData.wsPingMessageRequestId=e;var t=this._messageBuilder.buildKeepaliveRequest(e);return JSON.stringify(t)}.bind(this),wsIsPongMessage:function(e){return"string"==typeof e&&(e=JSON.parse(e)),!!e.name&&e.name===n.Providers.UCCP.UCCPMessageTypes.KEEPALIVE_RESPONSE&&this._failoverPingData.wsPingMessageRequestId===e.params.transId}.bind(this),wsIsPingMessage:function(e){return"string"==typeof e&&(e=JSON.parse(e)),!!e.name&&e.name===n.Providers.UCCP.UCCPMessageTypes.KEEPALIVE_REQUEST}.bind(this),wsPingMessageRequestId:"",keepAliveAnswerWaitingTime:5e3}}(e.prototype=Object.create(n.Providers.UCCP.AbstractUCCPProvider.prototype)).start=function(e,t){this._config=e;var i=T.Deferred();this._networkProvider._onCredentialsRequired=this.onCredentialsRequired.bind(this),this._networkProvider.onOpen=function(){this._networkProvider.onClose=function(){i.reject()},this._networkProvider.isOpened()?(this._isReconnecting&&(this._isReconnecting=!1,this.handleAfterReconnect(t)),this._isStarted=!0,i.resolve()):this._waitForSocketConnection(this._networkProvider,function(){this._isReconnecting&&(this._isReconnecting=!1,this.handleAfterReconnect(t)),this._isStarted=!0,i.resolve()}.bind(this),function(e){i.reject("Failed to open")}.bind(this))}.bind(this),this._networkProvider.onClose=function(){i.reject()},this._networkProvider.onMessage=function(e){var t=e.data?JSON.parse(e.data):JSON.parse(e),i=this._messageParser.parse(t);i instanceof n.Providers.UCCP.UCCPMessage&&(n.Base.Logger.debug(n.Base.LoggerTags.UCCP_CONFERENCE_PROVIDER,"Received message "+i.name),setTimeout(function(){this.trigger(i.name,[i])}.bind(this),0))}.bind(this);var a={urlSuffix:"/uwd/ws",transactionIDLocation:"params.transId"};n.Base.Utils.queryJSONObject(e,"networkProviderConfiguration.webSocketConfig.query")&&-1<e.networkProviderConfiguration.webSocketConfig.query.indexOf("ticket=")&&(a.alreadyApplied=!0);var r=new n.Config.ServerInfo(e.networkProviderConfiguration.webSocketConfig.hostName,e.networkProviderConfiguration.webSocketConfig.port,e.networkProviderConfiguration.webSocketConfig.isSecure,"/uwd/rest","",e.networkProviderConfiguration.webSocketConfig.query);e.networkProviderConfiguration.restConfig=r;var s=function(){return this._isReconnecting||t._conferenceService._isDisconnecting?T.Deferred().resolve().promise():(this._isReconnecting=!0,this.trigger(n.Providers.Interfaces.ConferenceCallbackIds.NETWORK_PROVIDER_IS_UNAVAILABLE),this._handleReconnect().then(function(){this._isReconnecting=!1,this.handleAfterReconnect()}.bind(this)))}.bind(this);return this._networkRequestRetryHelper=new n.Base.NetworkRequestRetryHelper(function(){return this._networkProvider.start(e.networkProviderConfiguration,e.credentialProvider,a,this._networkRequestRetryHelper,s,this._failoverPingData)}.bind(this)),this._networkProvider.on(n.Base.NetworkProviderEvents.UNAUTHORIZED,function(){this.trigger(n.Base.NetworkProviderEvents.UNAUTHORIZED,[])}.bind(this)),this._networkProvider.on(n.Base.NetworkProviderEvents.AUTHORIZED,function(){this.trigger(n.Base.NetworkProviderEvents.AUTHORIZED,[])}.bind(this)),this.on(n.Providers.UCCP.UCCPMessageTypes.KEEPALIVE_REQUEST,function(e){this._sendKeepAliveResponse(e)}.bind(this)),this._networkProvider.registerBlackList(this._blackListedWords),this._networkProvider.start(e.networkProviderConfiguration,e.credentialProvider,a,this._networkRequestRetryHelper,s,this._failoverPingData),i.promise()},e.prototype._sendKeepAliveResponse=function(e){var t=this._messageBuilder.buildKeepAliveResponse(e.transId);this._networkProvider.send(JSON.stringify(t),m,m,!0)},e.prototype._waitForSocketConnection=function(t,i,a){var r=function(e){e<10?setTimeout(function(){t.isOpened()?i():r(e+1)}.bind(this),100):a("Max retry reached")};r(0)},e.prototype._handleReconnect=function(){var e=this._networkRequestRetryHelper.getRetryCallback();return this._fallbackPromise=n.Base.Utils.connectionBackoffAlgorithm(e),this._fallbackPromise.dfdPromise.state()===n.Base.DeferredStates.PENDING?T.Deferred().reject().promise():this._fallbackPromise.dfdPromise},e.prototype.handleAfterReconnect=function(){this._fallbackPromise=m,this.trigger(n.Providers.Interfaces.ConferenceCallbackIds.NETWORK_PROVIDER_IS_AVAILABLE)},e.prototype.stop=function(){this._isStarted=!1,this._removeListeners(),n.Base.Utils.isDefined(this._fallbackPromise)&&this._fallbackPromise.cancel();var t=T.Deferred();return this._networkProvider.onClose=function(){t.resolve()},this._networkProvider.onError=function(e){t.reject(e)},this._networkProvider.close(),t.promise()},n.Providers.UCCP.UCCP1Provider=e}(AvayaClientServices),function(e){"use strict";function t(){e.Providers.UCCP.AbstractUCCPProvider.call(this),this._config=m,this._providers=[],this._selectedProvider=m}(t.prototype=Object.create(e.Providers.UCCP.AbstractUCCPProvider.prototype)).start=function(e,t){return T.isEmptyObject(e)||this._config===e||(this._config=e),this._selectedProvider=this._determineServerVersion(),this._selectedProvider.start(e,t)},t.prototype.stop=function(){return this._selectedProvider?this._selectedProvider.stop():T.Deferred().reject().promise()},t.prototype._determineServerVersion=function(){return this._providers[0].provider},t.prototype.getSelectedProvider=function(){return this._selectedProvider},t.prototype.registerUCCPProvider=function(e,t){return this._providers.push({version:e,provider:t})},t.prototype.sendHandshake=function(e){return this._selectedProvider.sendHandshake(e)},t.prototype.subscribeMeetingInfo=function(e){return this._selectedProvider.subscribeMeetingInfo(e)},t.prototype.startRecording=function(e,t,i){return this._selectedProvider.startRecording(e,t,i)},t.prototype.stopRecording=function(e){return this._selectedProvider.stopRecording(e)},t.prototype.pauseRecording=function(e){return this._selectedProvider.pauseRecording(e)},t.prototype.resumeRecording=function(e){return this._selectedProvider.resumeRecording(e)},t.prototype.subscribeRoster=function(e){return this._selectedProvider.subscribeRoster(e)},t.prototype.subscribeActiveTalker=function(e){return this._selectedProvider.subscribeActiveTalker(e)},t.prototype.subscribePermissions=function(e){return this._selectedProvider.subscribePermissions(e)},t.prototype.subscribeSlider=function(e){return this._selectedProvider.subscribeSlider(e)},t.prototype.subscribeMeetingNote=function(e){return this._selectedProvider.subscribeMeetingNote(e)},t.prototype.subscribeWebCollab=function(e){return this._selectedProvider.subscribeWebCollab(e)},t.prototype.subscribeAvailableLayouts=function(e){return this._selectedProvider.subscribeAvailableLayouts(e)},t.prototype.raiseHand=function(e){return this._selectedProvider.raiseHand(e)},t.prototype.setAsLecturer=function(e,t){return this._selectedProvider.setAsLecturer(e,t)},t.prototype.unsetAsLecturer=function(e){return this._selectedProvider.unsetAsLecturer(e)},t.prototype.disconnectParticipant=function(e,t){return this._selectedProvider.disconnectParticipant(e,t)},t.prototype.setLocked=function(e,t){return this._selectedProvider.setLocked(e,t)},t.prototype.setVideoLayout=function(e,t){return this._selectedProvider.setVideoLayout(e,t)},t.prototype.setVideoLayoutSelfSee=function(e,t){return this._selectedProvider.setVideoLayoutSelfSee(e,t)},t.prototype.setVideoLayoutTextOverlay=function(e,t){return this._selectedProvider.setVideoLayoutTextOverlay(e,t)},t.prototype.getCurrentVideoLayout=function(e){return this._selectedProvider.getCurrentVideoLayout(e)},t.prototype.muteUnmute=function(e,t,i,a){return this._selectedProvider.muteUnmute(e,t,i,a)},t.prototype.controlRemoteCamera=function(e,t,i){return this._selectedProvider.controlRemoteCamera(e,t,i)},t.prototype.muteUnmuteAll=function(e,t){return this._selectedProvider.muteUnmuteAll(e,t)},t.prototype.sendLocalMuteEvent=function(e,t,i){return this._selectedProvider.sendLocalMuteEvent(e,t,i)},t.prototype.sendDisconnectEvent=function(e,t){return this._selectedProvider.sendDisconnectEvent(e,t)},t.prototype.terminateConference=function(e){return this._selectedProvider.terminateConference(e)},t.prototype.requestToBecomeModerator=function(e,t){return this._selectedProvider.requestToBecomeModerator(e,t)},t.prototype.signIn=function(e,t){return this._selectedProvider.signIn(e,t)},t.prototype.videoPin=function(e,t,i,a,r,s){return this._selectedProvider.videoPin(e,t,i,a,r,s)},t.prototype.extendMeeting=function(e,t){return this._selectedProvider.extendMeeting(e,t)},t.prototype.addParticipant=function(e,t){return this._selectedProvider.addParticipant(e,t)},t.prototype.cancelDialoutParticipant=function(e,t){return this._selectedProvider.cancelDialoutParticipant(e,t)},t.prototype.sendChatMessage=function(e,t,i){return this._selectedProvider.sendChatMessage(e,t,i)},t.prototype.raiseLowerHand=function(e,t){return this._selectedProvider.raiseLowerHand(e,t)},t.prototype.moderatorLowerHand=function(e,t,i){return this._selectedProvider.moderatorLowerHand(e,t,i)},t.prototype.sendAdmissionRequest=function(e,t){return this._selectedProvider.sendAdmissionRequest(e,t)},t.prototype.moderatorAdmission=function(e,t,i){return this._selectedProvider.moderatorAdmission(e,t,i)},t.prototype.getDialInInfo=function(e){return this._selectedProvider.getDialInInfo(e)},e.Providers.UCCP.UCCPProvider=t}(AvayaClientServices),function(r){"use strict";function e(e,t,i,a){r.Providers.Interfaces.CollaborationProvider.call(this),this._networkProvider=e,this._wcsEventsParser=t,this._wcsBinaryParser=i,this._wcsMessageBuilder=a,this._config={}}(e.prototype=Object.create(r.Providers.Interfaces.CollaborationProvider.prototype)).onCredentialsRequired=function(t,e){e&&e!==this._config.credentialProvider&&r.Base.Utils.deepMerge(this._config.credentialProvider,e),this._config.credentialProvider.onAuthenticationChallenge(void 0,function(e){this.onCredentialsRetrieved(e,t)}.bind(this))},e.prototype.onCredentialsRetrieved=function(e,t){},e.prototype.addShape=function(e){},e.prototype.addCircle=function(e){},e.prototype.getParticipants=function(){},e.prototype.discoverResources=function(){},e.prototype.run=function(){},r.Providers.WCS.AbstractWCSProvider=e}(AvayaClientServices),function(v){"use strict";function e(e,t,i,a,r,s,n,o,c){v.Providers.WCS.AbstractWCSProvider.call(this,e,t,i,a),this._meetingId=m,this._wcsContentSharingHandler=r,this._wcsWhiteboardHandler=s,this._wcsSliderHandler=n,this._version="1.1",this._bytesReceivedLastSecond=0,this._notificationsProvider=o,this._resources=m,this._isWhiteboardActive=!1,this._isScreenSharingActive=!1,this._notificationPromise=m,this._discoveryBackoffDataObject=m,this._pendingBlocks=[],this._urlSuffixes={comet:{startLiveSession:"/wcsws/Comet/StartLiveSession",endLiveSession:"/wcsws/Comet/EndLiveSession",data:"/wcsws/Comet/Data"}},this._blackListedWords=["username","user_name","token","participant_id","meeting_id","fromname","sender_id","sender_name","sender_username","from"],this._failoverPingData={wsKeepAliveEnabled:!0,wsPingInterval:3e4,wsGeneratePingMessage:function(){var e=v.Base.Utils.makeId(32,"0123456789abcdef");return"live_ping?request_id="+(this._failoverPingData.wsPingMessageRequestId=e)+"&ws_connection_id="+this._wsConnectionId}.bind(this),wsIsPongMessage:function(e){var t=v.Base.Utils.queryJSONObject(e,"response[0].live_ping[0]"),i=v.Base.Utils.queryJSONObject(e,"response[0].live_ping[0].request_id[0]._text"),a=v.Base.Utils.queryJSONObject(e,"response[0].live_ping[0].ws_connection_id[0]._text");return v.Base.Utils.isDefined(t)&&this._failoverPingData.wsPingMessageRequestId===i&&this._wsConnectionId===a}.bind(this),wsPingMessageRequestId:"",keepAliveAnswerWaitingTime:5e3},this._isShutdown=!1,this._wsConnectionId="",this._supportedFeatures={},this._supportedFeatures[v.Services.Collaboration.FeaturesAvailable.LIBRARY]=!1,this._supportedFeatures[v.Services.Collaboration.FeaturesAvailable.POLLING]=!1,this._supportedFeatures[v.Services.Collaboration.FeaturesAvailable.MINUTES]=!1,this._supportedFeatures[v.Services.Collaboration.FeaturesAvailable.WHITEBOARD]=!1,this._supportedFeatures[v.Services.Collaboration.FeaturesAvailable.MESSAGES]=!1,this._supportedFeatures[v.Services.Collaboration.FeaturesAvailable.REPORTS]=!1,this._supportedFeatures[v.Services.Collaboration.FeaturesAvailable.SCREEN_SHARING]=!1,this._supportedFeatures[v.Services.Collaboration.FeaturesAvailable.SLIDER]=!1,this._supportedFeatures[v.Services.Collaboration.FeaturesAvailable.REMOTE_CONTROL]=!1,this._colaborationsAnalyticsService=c,this._serverCapabilities={}}(e.prototype=Object.create(v.Providers.WCS.AbstractWCSProvider.prototype)).start=function(e,t){var i=T.Deferred();return this._isShutdown=!1,this._config=e,this._meetingId=t,this._credentials=m,this._participant=m,this._pendingBlocks=[],this._networkProvider._onCredentialsRequired=this._onCredentialsRequired.bind(this),this._networkProvider.onOpen=function(){i.resolve()},this._networkProvider.registerBlackList(this._blackListedWords),this._networkProvider.disableOptionsLogging(!0),this._networkProvider.start(e.networkProviderConfiguration,e.credentialProvider),i.promise()},e.prototype.stop=function(){var t=T.Deferred();return this._isShutdown=!0,v.Base.Utils.isDefined(this._discoveryBackoffDataObject)&&(this._discoveryBackoffDataObject.cancel(),this._discoveryBackoffDataObject=m),this._notificationsProvider.onClose=function(){this._colaborationsAnalyticsService.sendStopEvent(!0),v.Base.Logger.info(v.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"WCS provider stopped"),t.resolve()}.bind(this),this._notificationsProvider.onError=function(e){this._colaborationsAnalyticsService.sendStopEvent(!1),this._colaborationsAnalyticsService.sendFailureStopEvent(v.Services.Collaboration.CollaborationErrorReason.COLLABORATION_STOP_FAILURE),v.Base.Logger.info(v.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Error while stopping WCS provider",e),t.reject(new v.Services.Collaboration.CollaborationError(v.Services.Collaboration.CollaborationErrorReason.COLLABORATION_STOP_FAILURE,e))}.bind(this),this._notificationsProvider.close(),t.promise()},e.prototype.pause=function(){var e=this._wcsMessageBuilder.buildPauseMessage(),t=T.Deferred();return this._notificationsProvider.send(e),t.resolve(),t.promise()},e.prototype.resume=function(){var e=this._wcsMessageBuilder.buildResumeMessage(),t=T.Deferred();return this._notificationsProvider.send(e),t.resolve(),t.promise()},e.prototype._getFullUrlSuffix=function(e){return this._config.networkProviderConfiguration.restConfig&&this._config.networkProviderConfiguration.restConfig.path?this._config.networkProviderConfiguration.restConfig.path+e:e},e.prototype._getCometDataUrlSuffix=function(){return this._getFullUrlSuffix(this._urlSuffixes.comet.data)},e.prototype._sendLiveSession=function(){var e=Date.now(),t={urlSuffix:this._getFullUrlSuffix(this._urlSuffixes.comet.startLiveSession)},i=v.Base.Utils.makeId(32,"abcdefgijklmnopqrstuvwxyz0123456789"),a="live_session?token="+this._credentials.token+"&brand="+this._resources.brandId+"&meeting_id="+this._meetingId+"&participant_id="+this._credentials.participantId+"&username="+this._credentials.username+"&last_event_offset=0&local_time="+e+"&ejected=false&session_id="+this._credentials.sessionId+"&remote_control_enabled=false&private_chat_enabled=true&user_agent="+navigator.userAgent+"&client_version=PC;WebCollab;local_version&request_id="+i;return this._notificationsProvider.send(a,t)},e.prototype._onCredentialsRequired=function(e,t,i){v.Base.Utils.isUndefined(this._credentials)&&(i&&i!==this._config.credentialProvider&&v.Base.Utils.deepMerge(this._config.credentialProvider,i),this._config.credentialProvider.onAuthenticationChallenge(void 0,function(e){this._onCredentialsRetrieved(e,t)}.bind(this)))},e.prototype._onCredentialsRetrieved=function(e,t){this._credentials=e},e.prototype.observeCollaboration=function(l){this._networkProvider.on(v.Base.NetworkProviderEvents.UNAUTHORIZED,function(){(v.Base.Utils.isUndefined(l._isAvailable)||l._isAvailable)&&(l._isAvailable=!1,l._onCollaborationServiceUnavailableCallbacks.fire(l))}.bind(this)),this._notificationsProvider.on(v.Base.NetworkProviderEvents.UNAUTHORIZED,function(){(v.Base.Utils.isUndefined(l._isAvailable)||l._isAvailable)&&(l._isAvailable=!1,l._onCollaborationServiceUnavailableCallbacks.fire(l))}.bind(this)),this._notificationsProvider.on(v.Base.NetworkProviderEvents.AUTHORIZED,function(){!v.Base.Utils.isUndefined(l._isAvailable)&&l._isAvailable||(l._isAvailable=!0,l._onCollaborationServiceAvailableCallbacks.fire(l))}.bind(this)),this._networkProvider.on(v.Base.NetworkProviderEvents.AUTHORIZED,function(){!v.Base.Utils.isUndefined(l._isAvailable)&&l._isAvailable||(l._isAvailable=!0,l._onCollaborationServiceAvailableCallbacks.fire(l))}.bind(this));var e={urlSuffix:this._getCometDataUrlSuffix()};this._notificationsProvider.run(e),this._notificationsProvider.onMessage=function(e){var t=[];if(e.data instanceof ArrayBuffer)this._updateReceivingBitrate(e.data.byteLength),t.push(this._wcsBinaryParser.parse(e.data));else for(var i=this._wcsEventsParser.parse(e.data),a=i.length,r=0;r<a;r++)t.push(i[r]);for(var s=t.length,n=0;n<s;n++)this._delegateEvent(t[n],l);if(l._collaborationService.wasScreenSharingInterrupted()){var o=l._collaborationService.getInterruptedSharingType(),c=l._collaborationService.getInterruptedSharingStream();setTimeout(function(){!1===l.getContentSharing().isContentSharingActive()&&!1===this.isWhiteboardActive()&&(o===v.Services.Collaboration.ContentSharingType.ANY_TYPE?l.getContentSharing()._contentSharingService.startScreenSharingAnyType(l.getContentSharing(),c):o===v.Services.Collaboration.ContentSharingType.APP_WINDOW_SHARING?l.getContentSharing()._contentSharingService.startSharingApplicationWindow(l.getContentSharing(),m,c):o===v.Services.Collaboration.ContentSharingType.FULL_SCREEN_SHARING&&l.getContentSharing()._contentSharingService.startScreenSharingFullScreen(l.getContentSharing(),m,c))}.bind(this)),l._collaborationService._resetInterruptedSharing()}}.bind(this)},e.prototype.startDrawShape=function(e,t){var i={urlSuffix:this._getCometDataUrlSuffix()},a=this._wcsMessageBuilder.buildStartDrawShapeMessage(e,t,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(a,i).then(this._getEventIdFromResponse)},e.prototype._discoverResourcesFnc=function(){var e=this._wcsMessageBuilder.buildResourceDiscoveryMessage(this._credentials.mode,this._meetingId,this._credentials.participantId,this._credentials.username,this._credentials.token),t={urlSuffix:this._getFullUrlSuffix("/viewer/rest/live_viewer/"),method:"POST"};return this._networkProvider.send(e,t)},e.prototype.discoverResources=function(e){return this._discoveryBackoffDataObject=v.Base.Utils.connectionBackoffAlgorithm(this._discoverResourcesFnc.bind(this)),this._discoveryBackoffDataObject.dfdPromise.then(this._parseResources.bind(this)).then(function(){return this._discoveryBackoffDataObject=m,this._startNotificationProvider(e)}.bind(this))},e.prototype._parseResources=function(e){var t=this._wcsEventsParser.parse(e);return this._resources=t[0].data,this._resources},e.prototype._startNotificationProvider=function(u){var s=T.Deferred();this._notificationPromise||(this._notificationPromise=s),this._notificationsProvider.onOpen=function(){this._sendLiveSession().done(function(e){if(e){var t=v.Base.Utils.queryJSONObject(e,"response[0].live_session[0].live_attendee[0].attendee_id[0]._text");if(t){var i=v.Base.Utils.queryJSONObject(e,"response[0].live_session[0].live_attendee[0].user_name[0]._text"),a=v.Base.Utils.queryJSONObject(e,"response[0].live_session[0].live_attendee[0].presenter[0]._text"),r=v.Base.Utils.queryJSONObject(e,"response[0].live_session[0].server_time_diff[0]._text");this._participant=new v.Services.Collaboration.Participant(t,i),r&&(this._participant._joinTime+=r),this._participant._presenter=a}this._wsConnectionId=v.Base.Utils.queryJSONObject(e,"response[0].live_session[0].ws_connection_id[0]._text");for(var s=v.Base.Utils.queryJSONObject(e,"response[0].live_session[0].features[0].feature"),n=s.length-1;0<=n;n--){var o=v.Base.Utils.queryJSONObject(s[n],"type[0]._text");v.Base.Utils.isDefined(v.Services.Collaboration.FeaturesAvailable[o])&&(this._supportedFeatures[o]=v.Base.Utils.queryJSONObject(s[n],"enabled[0]._text"))}var c=v.Base.Utils.queryJSONObject(e,"response[0].live_session[0].suggested_screensharing_quality[0]._text");c&&u.getContentSharing()._setImageQuality(c);var l=v.Base.Utils.queryJSONObject(e,"response[0].live_session[0].max_upload_speed[0]._text");if(l&&u.getContentSharing()._setMaxUploadSpeed(l),this._notificationPromise&&(this._notificationPromise.resolve(this._participant),this._notificationPromise=m),!u._isAvailable){u._isAvailable=!0,u.isReceivingSharingPaused()&&u.pause();var d=u.getSlider(),C=d.getSlides();C.length&&(d._removeSlides(),d._onSlidesRemovedCallbacks.fire(C)),u._onCollaborationServiceAvailableCallbacks.fire(u)}}}.bind(this)).fail(function(e){s.reject(new v.Services.Collaboration.CollaborationError(v.Services.Collaboration.CollaborationErrorReason.COLLABORATION_START_FAILURE,e)),u._isAvailable&&(u._isAvailable=!1,u._onCollaborationServiceUnavailableCallbacks.fire(u))}.bind(this))}.bind(this),this._notificationsProvider._onCredentialsRequired=this._onCredentialsRequired.bind(this),this._notificationsProvider.onClose=function(){this._isShutdown||(u._isAvailable&&(u._isAvailable=!1,u._onCollaborationServiceUnavailableCallbacks.fire(u)),this._notificationPromise&&(this._notificationPromise.reject(new v.Services.Collaboration.CollaborationError(v.Services.Collaboration.CollaborationErrorReason.COLLABORATION_NOTIFICATIONS_CHANNEL_FAILED)),this._notificationPromise=m)),v.Base.Logger.info(v.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Socket was closed")}.bind(this),this._notificationsProvider.onError=function(e){v.Base.Logger.info(v.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Error on socket: ",e),s.reject(new v.Services.Collaboration.CollaborationError(v.Services.Collaboration.CollaborationErrorReason.COLLABORATION_START_FAILURE,e)),u._isAvailable&&(u._isAvailable=!1,u._onCollaborationServiceUnavailableCallbacks.fire(u))},this._notificationsProvider.onMessage=function(e){if(e.data){var t=T.parseXML(e.data),i=T(t),a=i.find("code").text(),r=i.find("message").text();v.Base.Logger.error(v.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"WCS live session response error:",a,r),s.reject(new v.Services.Collaboration.CollaborationError(v.Services.Collaboration.CollaborationErrorReason.COLLABORATION_START_FAILURE,r)),u._isAvailable&&(u._isAvailable=!1,u._onCollaborationServiceUnavailableCallbacks.fire(u))}else v.Base.Logger.warn(v.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"WCS sent some events before the live session response:",e,"These events will not be parsed.")};var e=new v.Config.ServerInfo(this._config.networkProviderConfiguration.restConfig.hostName,this._config.networkProviderConfiguration.restConfig.port,this._config.networkProviderConfiguration.restConfig.isSecure),t=new v.Config.ServerInfo(this._config.networkProviderConfiguration.restConfig.hostName,this._config.networkProviderConfiguration.restConfig.port,this._config.networkProviderConfiguration.restConfig.isSecure,this._getFullUrlSuffix("/"+this._resources.websocketPath)),i=function(){var t=T.Deferred();return u._isStopped||this._isShutdown?t.resolve().promise():(u._isAvailable&&(u._isAvailable=!1,u._onCollaborationServiceUnavailableCallbacks.fire(u)),this._discoveryBackoffDataObject=v.Base.Utils.connectionBackoffAlgorithm(this._discoverResourcesFnc.bind(this)),this._discoveryBackoffDataObject.dfdPromise.then(this._parseResources.bind(this)).then(function(){return this._discoveryBackoffDataObject=m,this._startNotificationProvider(u).then(function(e){u._setSelfParticipant(e),this.observeCollaboration(u),u.getContentSharing()._recalculateShareApplicationWindowCapability(u),u.getContentSharing()._recalculateShareFullScreenCapability(u),u.getContentSharing()._recalculateShareAnyTypeCapability(u),u._recalculateContentSharingCapability(u),u._recalculateWhiteboardCapability(u),u.getWhiteboard()._recalculateAddWhiteboardCapability(u),u.getWhiteboard()._recalculateRemoveWhiteboardCapability(u),t.resolve()}.bind(this),function(){t.reject()})}.bind(this)),t.promise())}.bind(this),a=new v.Config.NetworkProviderConfiguration(e,t);return this._notificationsProvider.registerBlackList(this._blackListedWords),this._notificationsProvider.disableOptionsLogging(!0),this._notificationsProvider.start(a,this._config.credentialProvider,m,m,i,this._failoverPingData).fail(function(){this._notificationPromise.reject(new v.Services.Collaboration.CollaborationError(v.Services.Collaboration.CollaborationErrorReason.COLLABORATION_NOTIFICATIONS_CHANNEL_FAILED)),this._notificationPromise=m}.bind(this)),s.promise()},e.prototype.liveDrawShape=function(e,t){var i,a={urlSuffix:this._getCometDataUrlSuffix()},r=e._getPointsToSend();return r&&r[0]&&r[0].isMove?(i=this._wcsMessageBuilder.buildFirstPointLiveDrawShapeMessage(r[0].point,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName()),e._markPointsAsSent(1)):(i=this._wcsMessageBuilder.buildLiveDrawShapeMessage(r,t,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName()),e._markPointsAsSent(e.getPoints().length)),this._notificationsProvider.send(i,a).then(this._getEventIdFromResponse)},e.prototype.endDrawShape=function(e,t){var i={urlSuffix:this._getCometDataUrlSuffix()},a=this._wcsMessageBuilder.buildEndDrawShapeMessage(e,t,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(a,i).then(this._getEventIdFromResponse)},e.prototype.addShape=function(e,t){var i={urlSuffix:this._getCometDataUrlSuffix()},a=this._wcsMessageBuilder.buildDrawShapeMessage(e,t,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(a,i).then(this._getEventIdFromResponse)},e.prototype.moveSelection=function(e,t,i){var a={urlSuffix:this._getCometDataUrlSuffix()},r=this._wcsMessageBuilder.buildMoveSelectionMessage(e,t,i.getX(),i.getY(),this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(r,a).then(this._getEventIdFromResponse)},e.prototype._updateReceivingBitrate=function(e){this._bytesReceivedLastSecond+=e,setTimeout(function(){this._bytesReceivedLastSecond-=e}.bind(this),1e3)},e.prototype.getReceivingBitrate=function(){return 8*this._bytesReceivedLastSecond},e.prototype.addCircle=function(e,t){var i={urlSuffix:this._getCometDataUrlSuffix()},a=this._wcsMessageBuilder.buildDrawCircleMessage(e,t,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(a,i).then(this._getEventIdFromResponse)},e.prototype.addText=function(e,t){var i={urlSuffix:this._getCometDataUrlSuffix()},a=this._wcsMessageBuilder.buildDrawTextMessage(e,t,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(a,i).then(this._getEventIdFromResponse)},e.prototype.startScreenSharing=function(){var e={urlSuffix:this._getCometDataUrlSuffix()},t=this._wcsMessageBuilder.buildStartScreenSharingMessage(this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._isWhiteboardActive?this.endWhiteboard().then(function(){return this._notificationsProvider.send(t,e)}.bind(this)):this._notificationsProvider.send(t,e)},e.prototype.stopScreenSharing=function(){var e={urlSuffix:this._getCometDataUrlSuffix()},t=this._wcsMessageBuilder.buildStopScreenSharingMessage(this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(t,e)},e.prototype.pauseScreenSharing=function(){var e={urlSuffix:this._getCometDataUrlSuffix()},t=this._wcsMessageBuilder.buildPauseScreenSharingMessage(this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(t,e)},e.prototype.sendLiveEvent=function(e){var t={urlSuffix:this._getCometDataUrlSuffix()},i=this._wcsMessageBuilder.buildLiveEventMessage(e,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(i,t)},e.prototype.sendBlocks=function(e){var t={urlSuffix:this._getCometDataUrlSuffix()};return this._isScreenSharingActive?this._notificationsProvider.send(e,t):(this._pendingBlocks.push(e),T.Deferred().resolve().promise())},e.prototype.getBufferedAmount=function(){return this._notificationsProvider.getBufferedAmount()},e.prototype.startWhiteboard=function(e){var t={urlSuffix:this._getCometDataUrlSuffix()},i=this._wcsMessageBuilder.buildStartWhiteboardMessage(this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName(),e);return this._isScreenSharingActive?this.stopScreenSharing().then(function(){return this._notificationsProvider.send(i,t)}.bind(this)):this._notificationsProvider.send(i,t)},e.prototype.endWhiteboard=function(){var e={urlSuffix:this._getCometDataUrlSuffix()},t=this._wcsMessageBuilder.buildEndWhiteboardMessage(this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(t,e)},e.prototype.addWhiteboardSurface=function(){var e={urlSuffix:this._getCometDataUrlSuffix()},t=this._wcsMessageBuilder.buildAddWhiteboardMessage(this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(t,e)},e.prototype.removeWhiteboardSurface=function(e){var t={urlSuffix:this._getCometDataUrlSuffix()},i=this._wcsMessageBuilder.buildRemoveWhiteboardMessage(e,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(i,t)},e.prototype.removeShape=function(e,t,i){var a={urlSuffix:this._getCometDataUrlSuffix()},r=this._wcsMessageBuilder.buildDeleteSelectionMessage(e,t,i.getX(),i.getY(),this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(r,a)},e.prototype.clearContent=function(e){var t={urlSuffix:this._getCometDataUrlSuffix()},i=this._wcsMessageBuilder.buildClearContentMessage(e,this._meetingId,this._participant.getParticipantId(),this._participant.getDisplayName());return this._notificationsProvider.send(i,t)},e.prototype.getParticipants=function(){var e={urlSuffix:this._getCometDataUrlSuffix()},t=this._wcsMessageBuilder.buildGetParticipantsMessage(!1);return this._notificationsProvider.send(t,e).then(function(e){for(var t=[],i=this._wcsEventsParser.parse(e),a=0;a<i[0].data.liveAttendees.length;a++){var r=v.Base.Utils.queryJSONObject(i[0],"data.liveAttendees["+a+"].attendeeId"),s=v.Base.Utils.queryJSONObject(i[0],"data.liveAttendees["+a+"].userName");t.push(new v.Services.Collaboration.Participant(r,s))}return t}.bind(this))},e.prototype.isOpened=function(){return this._notificationsProvider.isOpened()},e.prototype.isFeatureAvailable=function(e){return!!this._supportedFeatures[e]&&this._supportedFeatures[e]},e.prototype.isWhiteboardActive=function(){return this._isWhiteboardActive},e.prototype._delegateEvent=function(e,t){if(!v.Base.Utils.isUndefined(e)&&!v.Base.Utils.isUndefined(e.type))switch(e.type){case v.Providers.WCS.WCSScreenSharingTagTypes.CURSOR_TAG:this._wcsContentSharingHandler.updateCursor(t,e);break;case v.Providers.WCS.WCSScreenSharingTagTypes.START_TAG:case v.Providers.WCS.WCSScreenSharingTagTypes.BLOCK_TAG:case v.Providers.WCS.WCSScreenSharingTagTypes.END_TAG:this._wcsContentSharingHandler.updateFrame(t,e);break;case v.Providers.WCS.WCSEventTypes.START_SCREEN_SHARING:this._isWhiteboardActive&&(this._isWhiteboardActive=!1,this._wcsWhiteboardHandler.endWhiteboard(t,e)),this._isScreenSharingActive=!0;var i=this._wcsWhiteboardHandler._getParticipant(t,e);i&&this._participant&&i.getParticipantId()===this._participant.getParticipantId()&&this._sendPendingBlocks(),this._wcsContentSharingHandler.startScreenSharing(t,e);break;case v.Providers.WCS.WCSEventTypes.PAUSE_SCREEN_SHARING:this._wcsContentSharingHandler.pauseScreenSharing(t,e);break;case v.Providers.WCS.WCSEventTypes.END_SCREEN_SHARING:this._isWhiteboardActive||(this._isScreenSharingActive=!1,this._wcsContentSharingHandler.endScreenSharing(t,e));break;case v.Providers.WCS.WCSEventTypes.FRAME_REPORT:this._wcsContentSharingHandler.frameReport(t,e);break;case v.Providers.WCS.WCSEventTypes.SERVER_CAPABILITIES:this._serverCapabilities=e.data,this.trigger(v.Providers.Interfaces.CollaborationProviderCallbackIds.SERVER_CAPABILITIES,[e.data]);break;case v.Providers.WCS.WCSEventTypes.START_WHITEBOARD:if(this._isScreenSharingActive){this._isScreenSharingActive=!1;var a=this._wcsWhiteboardHandler._getParticipant(t,e);this._wcsContentSharingHandler.endScreenSharingByParticipant(t,a)}this._isWhiteboardActive=!0,this._wcsWhiteboardHandler.startWhiteboard(t,e);break;case v.Providers.WCS.WCSEventTypes.ADD_WHITEBOARD:this._wcsWhiteboardHandler.addWhiteboard(t,e);break;case v.Providers.WCS.WCSEventTypes.END_WHITEBOARD:this._isWhiteboardActive=!1,this._wcsWhiteboardHandler.endWhiteboard(t,e);break;case v.Providers.WCS.WCSEventTypes.DELETE_WHITEBOARD:this._wcsWhiteboardHandler.deleteWhiteboard(t,e);break;case v.Providers.WCS.WCSEventTypes.START_DRAW_SHAPE:this._wcsWhiteboardHandler.startDrawShape(t,e);break;case v.Providers.WCS.WCSEventTypes.DRAW_SHAPE:this._wcsWhiteboardHandler.drawShape(t,e);break;case v.Providers.WCS.WCSEventTypes.END_DRAW_SHAPE:this._wcsWhiteboardHandler.endDrawShape(t,e);break;case v.Providers.WCS.WCSEventTypes.DRAW_CIRCLE:this._wcsWhiteboardHandler.drawCircle(t,e);break;case v.Providers.WCS.WCSEventTypes.MOVE_SELECTION:this._wcsWhiteboardHandler.moveSelection(t,e);break;case v.Providers.WCS.WCSEventTypes.DRAW_TEXT:this._wcsWhiteboardHandler.drawText(t,e);break;case v.Providers.WCS.WCSEventTypes.DELETE_SELECTION:this._wcsWhiteboardHandler.deleteSelection(t,e);break;case v.Providers.WCS.WCSEventTypes.CLEAR_DRAWING:this._wcsWhiteboardHandler.clearDrawing(t,e);break;case v.Providers.WCS.WCSEventTypes.SLIDER_SLIDE:this._wcsSliderHandler.handleSliderSlide(t,e);break;case v.Providers.WCS.WCSEventTypes.SLIDER_EMPTY:this._wcsSliderHandler.handleSliderEmpty(t,e);break;case v.Providers.WCS.WCSEventTypes.END_MEETING:t._onCollaborationEndedCallbacks.fire(t),this._isShutdown||t.stop();break;case v.Providers.WCS.WCSEventTypes.EJECT_PARTICIPANT:e.data.targetId&&t._selfParticipant&&e.data.targetId===t._selfParticipant._participantId&&e.data.time>=t._selfParticipant._joinTime&&(t._onCollaborationNearEndByEjectCallbacks.fire(t),this._isShutdown||t.stop());break;case v.Providers.WCS.WCSEventTypes.ALLOW_PRESENTING:e.data.targetId&&t._selfParticipant&&e.data.targetId===t._selfParticipant._participantId&&(t._selfParticipant._presenter=!0,t.getContentSharing()._recalculateShareApplicationWindowCapability(t),t.getContentSharing()._recalculateShareFullScreenCapability(t),t.getContentSharing()._recalculateShareAnyTypeCapability(t),t._recalculateContentSharingCapability(t),t._recalculateWhiteboardCapability(t),t.getWhiteboard()._recalculateAddWhiteboardCapability(t),t.getWhiteboard()._recalculateRemoveWhiteboardCapability(t));break;case v.Providers.WCS.WCSEventTypes.DENY_PRESENTING:e.data.targetId&&t._selfParticipant&&e.data.targetId===t._selfParticipant._participantId&&(t._selfParticipant._presenter=!1,t.getContentSharing()._recalculateShareApplicationWindowCapability(t),t.getContentSharing()._recalculateShareFullScreenCapability(t),t.getContentSharing()._recalculateShareAnyTypeCapability(t),t._recalculateContentSharingCapability(t),t._recalculateWhiteboardCapability(t),t.getWhiteboard()._recalculateAddWhiteboardCapability(t),t.getWhiteboard()._recalculateRemoveWhiteboardCapability(t));break;default:v.Base.Logger.warn(v.Base.LoggerTags.WCS_COLLABORATION_PROVIDER,"Unknown event type received: {0}",e.type)}},e.prototype._getEventIdFromResponse=function(e){return v.Base.Utils.queryJSONObject(e,"response[0].live_event[0].event_id[0]._text")},e.prototype.getServerCapabilities=function(){return this._serverCapabilities},e.prototype._sendPendingBlocks=function(){for(var e=0;e<this._pendingBlocks.length;e++)this.sendBlocks(this._pendingBlocks[e]);this._pendingBlocks=[]},v.Providers.WCS.WCSv1_1Provider=e}(AvayaClientServices),function(e,t){"use strict";function i(){e.Base.TransactionalWebSocketProvider.apply(this,[e.Base.LoggerTags.WCS_COLLABORATION_PROVIDER]),this._transactionIDLocation="request_id"}(i.prototype=Object.create(e.Base.TransactionalWebSocketProvider.prototype)).getTransactionIDFromRequest=function(e,t){return!(void 0===e||e instanceof ArrayBuffer||e instanceof Blob)&&e.match(t+"=(\\w*)&?")[1]},i.prototype.getTransactionIDFromResponse=function(e,t){if(void 0===e)return!1;var i=this._getTransactionID(e,"response[0].live_session[0].request_id[0]._text"),a=this._getTransactionID(e,"response[0].live_event[0].request_id[0]._text"),r=this._getTransactionID(e,"response[0].live_attendees[0].request_id[0]._text"),s=this._getTransactionID(e,"response[0].live_ping[0].request_id[0]._text");return a||i||r||s},i.prototype.parseRequest=function(e){return e},i.prototype.parseResponse=function(e){return t.parseString(e)},e.Providers.WCS.WCSTransactionalWebSocketProvider=i}(AvayaClientServices,xmlToJSON),function(r){"use strict";function e(e,t,i,a){this._id=r.Base.Utils.makeId(10,"0123456789"),this._color=i,this._width=a,this._translation=m,this._status=r.Services.Collaboration.SelectionStatus.PENDING,this._isMine=t,this._ownerDisplayName=e,this._finished=!1}e.prototype={getId:function(){return this._id},setId:function(e){this._id=e},getColor:function(){return this._color},getWidth:function(){return this._width},getOwnerDisplayName:function(){return this._ownerDisplayName},getTranslation:function(){return this._translation},setTranslation:function(e){this._translation=e},getStatus:function(){return this._status},isMine:function(){return this._isMine},isFinished:function(){return this._finished},finishDrawing:function(){return this._finished=!0,T.when(this._finished)}},r.Base.AOPTools.addAdvices(e,"AbstractShape",["finishDrawing"],[r.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS,r.Base.AOPCommonAdvices.WRAP_CAUGHT_COLLABORATION_ERROR]),r.Services.Collaboration.AbstractShape=e}(AvayaClientServices),function(c){"use strict";function e(e,t,i,a,r,s,n,o){c.Services.Collaboration.AbstractShape.call(this,i,r,s,o),this._topLeft=e,this._bottomRight=t,this._filled=a||!1,this._alpha=n||100}(e.prototype=Object.create(c.Services.Collaboration.AbstractShape.prototype)).getTopLeft=function(){return this._topLeft},e.prototype.setTopLeft=function(e){this._topLeft=e},e.prototype.getBottomRight=function(){return this._bottomRight},e.prototype.setBottomRight=function(e){this._bottomRight=e},e.prototype.isFilled=function(){return this._filled},e.prototype.getAlpha=function(){return this._alpha},c.Services.Collaboration.Circle=e}(AvayaClientServices),function(n){"use strict";function e(e,t,i,a,r,s){n.Services.Collaboration.AbstractShape.call(this,e,i,a,s),this._filled=t||!1,this._finished=!1,this._sentPointsPos=0,this._points=[],this._alpha=r||100,this._onShapeFinished=m,this._readyToSendCallbacks=T.Callbacks(),this._throttlingInterval=100}(e.prototype=Object.create(n.Services.Collaboration.AbstractShape.prototype))._addPoint=function(e,t){var i=(new Date).getTime();this._points.push({isMove:e,point:t,_timestamp:i}),0===this._getSentPointsCount()?this._readyToSendCallbacks.fire():i-this._points[this._getSentPointsCount()-1]._timestamp>this._throttlingInterval&&this._readyToSendCallbacks.fire()},e.prototype.addMovePoint=function(e){this._addPoint(!0,e)},e.prototype.addLinePoint=function(e){this._addPoint(!1,e)},e.prototype.finishDrawing=function(){return this._finished=!0,n.Base.Utils.isDefined(this._onShapeFinished)?this._onShapeFinished():T.when(this._finished)},e.prototype.getPoints=function(){return this._points},e.prototype.updatePoints=function(e){for(var t=0;t<e.length;t++)this._points.push(e[t])},e.prototype.isFilled=function(){return this._filled},e.prototype.setFilled=function(e){this._filled=e},e.prototype._hasPointsToSend=function(){return this._sentPointsPos!==this._points.length},e.prototype._getPointsToSend=function(){return this._points.slice(this._sentPointsPos)},e.prototype._markPointsAsSent=function(e){this._sentPointsPos=e},e.prototype._getSentPointsCount=function(){return this._sentPointsPos},e.prototype.getAlpha=function(){return this._alpha},n.Base.AOPTools.addAdvices(e,"Shape",["addMovePoint","updatePoints"],[n.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS]),n.Base.AOPTools.addAdvices(e,"Shape",["finishDrawing"],[n.Base.AOPCommonAdvices.LOG_COLLABORATION_API_CALLS,n.Base.AOPCommonAdvices.WRAP_CAUGHT_COLLABORATION_ERROR]),n.Services.Collaboration.Shape=e}(AvayaClientServices),function(o){"use strict";function e(e,t,i,a,r,s,n){o.Services.Collaboration.AbstractShape.call(this,i,r,s,n),this._content=e,this._filled=a||!1,this._fontSize=t,this._position=m}(e.prototype=Object.create(o.Services.Collaboration.AbstractShape.prototype)).getPosition=function(){return this._position},e.prototype.setPosition=function(e){this._position=e},e.prototype.getContent=function(){return this._content},e.prototype.getFontSize=function(){return this._fontSize},o.Services.Collaboration.WhiteboardText=e}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Services.Conference.Participant.call(this,e,t),this._participantURI="",this._remoteDisplayName="",this._applicationActive=!1,this._handRaised=!1,this._presenter=!1,this._lecturer=!1,this._audioStatus=i.Services.Conference.ParticipantMediaState.MEDIA_STATUS_NO_MEDIA,this._videoStatus=i.Services.Conference.ParticipantMediaState.MEDIA_STATUS_NO_MEDIA,this._connectionStatus=i.Services.Conference.ParticipantConnectionStatus.CONNECTION_STATUS_UNKNOWN,this._disconnectionReason=m,this._audioId=m,this._videoId=m,this._lastSpokenTime=m,this._joinTime=m,this._lastSpokenTime=m,this._leaveTimeStamp=m,this._audioFromParticipant="",this._audioToParticipant="",this._userId="",this._sourceID="",this._feccRecvSupport=!1,this._videoFromParticipant="",this._videoToParticipant="",this._contentFromParticipant="",this._contentToParticipant="",this._canLecture=!1,this._role="",this._isVideoBlocked=!1,this._isAudioMuted=!1,this._isSelfParticipant=!1,this._wasPreviouslyNotVisibleInParticipantList=!1,this._status="",this._onParticipantCollaborationStatusChangedCallbacks=T.Callbacks(),this._onParticipantConnectionStatusChangedCallbacks=T.Callbacks(),this._onParticipantSetAsModeratorCallbacks=T.Callbacks(),this._onParticipantUnsetAsModeratorCallbacks=T.Callbacks(),this._onParticipantSetAsLecturerCallbacks=T.Callbacks(),this._onParticipantUnsetAsLecturerCallbacks=T.Callbacks(),this._onParticipantSetAsPresenterCallbacks=T.Callbacks(),this._onParticipantUnsetAsPresenterCallbacks=T.Callbacks(),this._onParticipantAudioStatusChangedCallbacks=T.Callbacks(),this._onParticipantVideoStatusChangedCallbacks=T.Callbacks(),this._onParticipantActiveTalkerStatusChangedCallbacks=T.Callbacks(),this._onParticipantHandRaisedCallbacks=T.Callbacks(),this._onParticipantHandLoweredCallbacks=T.Callbacks(),this._onParticipantDisplayNameChangedCallbacks=T.Callbacks()}(e.prototype=Object.create(i.Services.Conference.Participant.prototype)).controlRemoteCamera=function(e){for(var t in i.Services.Conference.CameraControl)if(i.Services.Conference.CameraControl.hasOwnProperty(t)&&e===i.Services.Conference.CameraControl[t])return this._participantService.controlRemoteCamera(this,e);return T.Deferred().reject(new i.Services.Conference.ConferenceException(i.Services.Conference.ConferenceError.INVALID_ARGUMENT))},e.prototype.mute=function(){return this._participantService.mute(this)},e.prototype.unmute=function(){return this._participantService.unmute(this)},e.prototype.blockVideo=function(){return this._participantService.blockVideo(this)},e.prototype.unblockVideo=function(){return this._participantService.unblockVideo(this)},e.prototype.lowerHand=function(e){return this._participantService.lowerHand(this,e)},e.prototype.setAsLecturer=function(){return this._participantService.setAsLecturer(this)},e.prototype.unsetAsLecturer=function(){return this._participantService.unsetAsLecturer()},e.prototype.isHandRaised=function(){return this._handRaised},e.prototype.getJoinTime=function(){return this._joinTime},e.prototype.getLastSpokenTime=function(){return this._lastSpokenTime},e.prototype.isVideoBlocked=function(){return this._isVideoBlocked},e.prototype.isAudioMuted=function(){return this._isAudioMuted},e.prototype.isModerator=function(){return this._role===i.Services.Conference.ParticipantRole.MODERATOR},e.prototype.isRestrictedParticipant=function(){return this._role===i.Services.Conference.ParticipantRole.RESTRICTED_PARTICIPANT},e.prototype.wasPreviouslyNotVisibleInParticipantList=function(){return this._wasPreviouslyNotVisibleInParticipantList},e.prototype.getParticipantAudioStatus=function(){return this._audioFromParticipant},e.prototype.getParticipantVideoStatus=function(){return this._videoFromParticipant},e.prototype.isLecturer=function(){return this._lecturer},e.prototype.isPresenter=function(){return this._presenter},e.prototype.getFeccRecvSupport=function(){return this._feccRecvSupport},e.prototype.getContentToParticipant=function(){return this._contentToParticipant},e.prototype.getContentFromParticipant=function(){return this._contentFromParticipant},e.prototype.getParticipantConnectionStatus=function(){return this._connectionStatus},e.prototype.getRole=function(){return this._role},i.Base.AOPTools.addAdvices(e,"ActiveParticipant",["controlRemoteCamera","mute","unmute","blockVideo","unblockVideo","lowerHand","setAsLecturer","unsetAsLecturer"],[i.Base.AOPCommonAdvices.LOG_CONFERENCE_API_CALLS,i.Base.AOPCommonAdvices.WRAP_CAUGHT_CONFERENCE_ERROR]),i.Services.Conference.ActiveParticipant=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Conference.ActiveParticipant.prototype,{addOnParticipantCollaborationStatusChangedCallback:function(e){this._onParticipantCollaborationStatusChangedCallbacks.add(e)},removeOnParticipantCollaborationStatusChangedCallback:function(e){this._onParticipantCollaborationStatusChangedCallbacks.remove(e)},addOnParticipantStatusChangedCallback:function(e){this._onParticipantStatusChangedCallbacks.add(e)},removeOnParticipantStatusChangedCallback:function(e){this._onParticipantStatusChangedCallbacks.remove(e)},addOnParticipantConnectionStatusChangedCallback:function(e){this._onParticipantConnectionStatusChangedCallbacks.add(e)},removeOnParticipantConnectionStatusChangedCallback:function(e){this._onParticipantConnectionStatusChangedCallbacks.remove(e)},addOnParticipantSetAsModeratorCallback:function(e){this._onParticipantSetAsModeratorCallbacks.add(e)},removeOnParticipantSetAsModeratorCallback:function(e){this._onParticipantSetAsModeratorCallbacks.remove(e)},addOnParticipantUnsetAsModeratorCallback:function(e){this._onParticipantUnsetAsModeratorCallbacks.add(e)},removeOnParticipantUnsetAsModeratorCallback:function(e){this._onParticipantUnsetAsModeratorCallbacks.remove(e)},addOnParticipantSetAsLecturerCallback:function(e){this._onParticipantSetAsLecturerCallbacks.add(e)},removeOnParticipantSetAsLecturerCallback:function(e){this._onParticipantSetAsLecturerCallbacks.remove(e)},addOnParticipantUnsetAsLecturerCallback:function(e){this._onParticipantUnsetAsLecturerCallbacks.add(e)},removeOnParticipantUnsetAsLecturerCallback:function(e){this._onParticipantUnsetAsLecturerCallbacks.remove(e)},addOnParticipantSetAsPresenterCallback:function(e){this._onParticipantSetAsPresenterCallbacks.add(e)},removeOnParticipantSetAsPresenterCallback:function(e){this._onParticipantSetAsPresenterCallbacks.remove(e)},addOnParticipantUnsetAsPresenterCallback:function(e){this._onParticipantUnsetAsPresenterCallbacks.add(e)},removeOnParticipantUnsetAsPresenterCallback:function(e){this._onParticipantUnsetAsPresenterCallbacks.remove(e)},addOnParticipantAudioStatusChangedCallback:function(e){this._onParticipantAudioStatusChangedCallbacks.add(e)},removeOnParticipantAudioStatusChangedCallback:function(e){this._onParticipantAudioStatusChangedCallbacks.remove(e)},addOnParticipantVideoStatusChangedCallback:function(e){this._onParticipantVideoStatusChangedCallbacks.add(e)},removeOnParticipantVideoStatusChangedCallback:function(e){this._onParticipantVideoStatusChangedCallbacks.remove(e)},addOnParticipantActiveTalkerStatusChangedCallback:function(e){this._onParticipantActiveTalkerStatusChangedCallbacks.add(e)},removeOnParticipantActiveTalkerStatusChangedCallback:function(e){this._onParticipantActiveTalkerStatusChangedCallbacks.remove(e)},addOnParticipantHandRaisedCallback:function(e){this._onParticipantHandRaisedCallbacks.add(e)},removeOnParticipantHandRaisedCallback:function(e){this._onParticipantHandRaisedCallbacks.remove(e)},addOnParticipantHandLoweredCallback:function(e){this._onParticipantHandLoweredCallbacks.add(e)},removeOnParticipantHandLoweredCallback:function(e){this._onParticipantHandLoweredCallbacks.remove(e)},addOnParticipantDisplayNameChangedCallback:function(e){this._onParticipantDisplayNameChangedCallbacks.add(e)},removeOnParticipantDisplayNameChangedCallback:function(e){this._onParticipantDisplayNameChangedCallbacks.remove(e)}})}(AvayaClientServices),function(i){"use strict";function e(e,t){i.Services.Conference.Participant.call(this,e,t)}(e.prototype=Object.create(i.Services.Conference.Participant.prototype)).reinvite=function(){},i.Base.AOPTools.addAdvices(e,"DroppedParticipant",["reinvite"],[i.Base.AOPCommonAdvices.LOG_CONFERENCE_API_CALLS,i.Base.AOPCommonAdvices.WRAP_CAUGHT_CONFERENCE_ERROR]),i.Services.Conference.DroppedParticipant=e}(AvayaClientServices),function(a){"use strict";function e(e,t){this._escalationService=t,this.type=a.Services.Messaging.MessageType.SESSION,this.sessionType=m,this.participants=new a.Base.DataSet,this.extensions={},this._resourceStatus=a.Services.Messaging.ResourceStatus.DRAFT_UNSENT,a.Base.Utils.isDefined(e)&&(this.type=e.type,this.sessionType=e.sessionType,this.extensions=e.extensions,this.conversation=e.conversation),this._onTypeChangedCallbacks=T.Callbacks(),this._onStatusChangedCallbacks=T.Callbacks(),this._onSessionTypeChangedSuccessCallbacks=T.Callbacks(),this._onSessionTypeChangedFailedCallbacks=T.Callbacks(),this._onStartSuccessCallbacks=T.Callbacks(),this._onStartFailedCallbacks=T.Callbacks(),this._onMessagingEscalationCapabilitiesChangedCallbacks=T.Callbacks(),this._sendCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addParticipantsCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeParticipantsCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateSessionTypeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeCapability=new a.Base.Capability(a.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),t._recalculateAllEscalationCapabilities(this)}e.prototype={getStatus:function(){return this._resourceStatus},getSessionType:function(){return this.sessionType},getConversation:function(){return this.conversation},setSessionType:function(e){var t=!1;for(var i in a.Services.Messaging.SessionType)if(a.Services.Messaging.SessionType.hasOwnProperty(i)&&e===a.Services.Messaging.SessionType[i]){this._escalationService.setSessionType(this,e),t=!0;break}return t},addParticipants:function(e){this._escalationService.addParticipants(this,e)},removeParticipants:function(e){this._escalationService.removeParticipants(this,e)},getParticipants:function(){return this.participants},send:function(){return this._escalationService.start(this)},_setStatus:function(e){if(!a.Base.Utils.isDefined(a.Services.Messaging.ResourceStatus[e]))throw new Error("Unknown ResourceStatus");this._resourceStatus=e,this._onStatusChangedCallbacks.fire(this,e)}},a.Base.AOPTools.addAdvices(e,"Escalation",["addParticipants","removeParticipants"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS]),a.Base.AOPTools.addAdvices(e,"Escalation",["send"],[a.Base.AOPCommonAdvices.LOG_MESSAGING_API_CALLS,a.Base.AOPCommonAdvices.WRAP_CAUGHT_MESSAGING_ERROR]),a.Services.Messaging.Escalation=e}(AvayaClientServices),function(e){"use strict";T.extend(e.Services.Messaging.Escalation.prototype,{addOnSessionTypeChangedCallback:function(e){this._onTypeChangedCallbacks.add(e)},removeOnSessionTypeChangedCallback:function(e){this._onTypeChangedCallbacks.remove(e)},addOnStatusChangedCallback:function(e){this._onStatusChangedCallbacks.add(e)},removeOnStatusChangedCallback:function(e){this._onStatusChangedCallbacks.remove(e)}})}(AvayaClientServices),function(i){"use strict";var e={getSendCapability:function(){return this._sendCapability},_recalculateStartCapability:function(){var e,t;t=this._escalationService.isServiceAvailable()?(e=!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._sendCapability._updateIfChanged(e,t)},getAddParticipantsCapability:function(){return this._addParticipantsCapability},_recalculateAddParticipantsCapability:function(){var e,t;t=this._escalationService.isServiceAvailable()?(e=!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._addParticipantsCapability._updateIfChanged(e,t)},getRemoveParticipantsCapability:function(){return this._removeParticipantsCapability},_recalculateRemoveParticipantsCapability:function(){var e,t;t=this._escalationService.isServiceAvailable()&&this._resourceStatus===i.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeParticipantsCapability._updateIfChanged(e,t)},getUpdateSessionTypeCapability:function(){return this._updateSessionTypeCapability},_recalculateUpdateSessionTypeCapability:function(){var e,t;t=this._escalationService.isServiceAvailable()&&this._resourceStatus===i.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._updateSessionTypeCapability._updateIfChanged(e,t)},getRemoveCapability:function(){return this._removeCapability},_recalculateRemoveCapability:function(){var e,t;t=this._escalationService.isServiceAvailable()&&this._resourceStatus===i.Services.Messaging.ResourceStatus.DRAFT_UNSENT?(e=!0,i.Base.CapabilityDenialReason.CAPABILITY_NOT_DENIED):(e=!1,i.Base.CapabilityDenialReason.CAPABILITY_INVALID_STATE),this._removeCapability._updateIfChanged(e,t)}};T.extend(i.Services.Messaging.Escalation.prototype,e)}(AvayaClientServices),function(s){"use strict";function e(e,t,i,a){s.Providers.AMM.AMM3Provider.call(this,e,t,i,a),this._resourcesTypes.addressesToValidate="application/vnd.avaya.aem.addressesToValidate.v1+json",this._resourcesTypes.conversationsFilter="application/vnd.avaya.aem.conversationsFilter.v1+json"}(e.prototype=Object.create(s.Providers.AMM.AMM3Provider.prototype))._discoverResources=function(e){return T.Deferred(function(i){return s.Providers.AMM.AMM3Provider.prototype._discoverResources.call(this,e).then(function(e){if(this._isProviderSupported(e))i.resolve(e);else{var t=new s.Base.BaseError("API in not supported, try different provider");i.reject(t)}}.bind(this),i.reject)}.bind(this))},e.prototype._isProviderSupported=function(e){var t=s.Base.Utils.queryJSONObject(e,"conversationsResource.requestTypes"),i=s.Base.Utils.isDefined(t)&&s.Base.Utils.includes(this._resourcesTypes.conversationsFilter,t),a=s.Base.Utils.queryJSONObject(e,"services.validateAddresses.requestTypes"),r=s.Base.Utils.isDefined(a)&&s.Base.Utils.includes(this._resourcesTypes.addressesToValidate,a);return i&&r},e.prototype.validateUsers=function(e){var t=JSON.stringify({addresses:e.map(function(e){return{address:e}})}),i=this._buildValidateUsersRequestOptions();return this._networkProvider.send(t,i).then(this._onValidateUsersRequestSent.bind(this),this._handleError.bind(this))},e.prototype._buildValidateUsersRequestOptions=function(){var e=s.Providers.AMM.AbstractAMMProvider.prototype._buildValidateUsersRequestOptions.call(this);return e.sendType="POST",e.headers["Content-Type"]=this._resourcesTypes.addressesToValidate,e},e.prototype.getConversations=function(e){var t=JSON.stringify({}),i=this._buildGetConversationsRequestOptions(e);return this._networkProvider.send(t,i).then(this._onGetConversationsRequestSent.bind(this),this._handleError.bind(this))},e.prototype._buildGetConversationsRequestOptions=function(e){var t=s.Providers.AMM.AMM3Provider.prototype._buildGetConversationsRequestOptions.call(this,e);return t.sendType="POST",t.headers["Content-Type"]=this._resourcesTypes.conversationsFilter,t},e.prototype._getConversationsByIds=function(e,t){var i=JSON.stringify({ids:e.map(function(e){return{id:e}})});return this._networkProvider.send(i,t).then(this._onGetConversationsByQueryRequestSent.bind(this),this._handleError.bind(this))},e.prototype._getConversationsByQuery=function(e,t){var i={searchString:e.q,searchSubject:e.subject,searchParticipants:e.participants,searchBody:e.body};e.after!==m&&(i.searchAfterDate=e.after);var a=JSON.stringify(i);return s.Providers.AMM.AMM3Provider.prototype._getConversationsByQuery.call(this,a,t)},s.Providers.AMM.AMM3_2Provider=e}(AvayaClientServices),function(e){"use strict";var c=e.Base.Utils,l=e.Providers.Analytics.AnalyticsStatistic,d="ec",C="ea",u="el",v="ev";e.Providers.Analytics.AnalyticsEventStatistic={send:function(e,t,i,a,r){if(l.isCollectionEnabled()){var s=this._getEventParams.apply(this,arguments);l.addHit(s)}},_getEventParams:function(e,t,i,a,r){var s=l.addHitTypeParameter("event"),n=[[d,e],[C,t]];i&&n.push([u,i]),c.isInteger(a)&&n.push([v,a]);for(var o=0;o<n.length;o++)s+=l.addURIParam(n[o][0],n[o][1]);return s+=l.addCustomDimensionsParameters(r)}}}(AvayaClientServices),function(e){"use strict";var s=e.Providers.Analytics.AnalyticsEventStatistic,n=e.Providers.Analytics.AnalyticsTimingStatistic;function t(){this._category=m,this._customDimensions=m,this._init()}t.prototype._init=function(){this._category=this._createCategory(),this._customDimensions=this._createCustomDimensions()},t.prototype.sendTiming=function(e,t,i,a){if((a=!!a)&&!this._customDimensions)throw"Provider type is not set";var r=a?this._customDimensions:{};n.send(this._category,e,i,t,r)},t.prototype.sendEvent=function(e,t,i,a){if(!this._category)throw"The category is not set";if(a&&!this._customDimensions)throw"Provider type is not set";var r=a?this._customDimensions:{};s.send(this._category,e,t,i,r)},t.prototype._createCategory=function(){throw"You must create a category using the method _createCategory"},t.prototype._createCustomDimensions=function(){return{}},t.prototype.startTimingMetric=function(){return new Date},e.Services.Analytics.AnalyticsService=t}(AvayaClientServices),function(e){"use strict";var r="Audio",i="Conference",a="Duration",t="Dropped",s="Error",n="Failure",o="Incoming",c="Media Types",l="Outgoing",d="P2P",C="Preservation",u="Service Unavailable",v="Start Type",h="Success (call continued)",p="Success (call ended)",_="Video",S=e.Providers.Analytics.AnalyticsStatistic,g=e.Providers.Analytics.AnalyticsCategories,f=e.Providers.Analytics.AnalyticsCustomDimensions,E=e.Providers.Analytics.AnalyticsProvidersTypes;function A(){e.Services.Analytics.AnalyticsService.call(this),this._callMediaTypes={AUDIO:1,VIDEO:0}}(A.prototype=Object.create(e.Services.Analytics.AnalyticsService.prototype))._createCategory=function(){return g.CALLS},A.prototype._createCustomDimensions=function(){var e={};return e[f.PROVIDER_TYPE]=E.CALLS,e},A.prototype.sendCallInfo=function(e,t){var i=e?o:l,a=r;a+=t?"+"+_:"",this.sendEvent(i,a,null,!0)},A.prototype.callTimeEnd=function(e){if(e){var t=new Date-e,i=S.getCallDurationLabel(t);this.sendTiming(a,i,t,!0)}},A.prototype.setCallMediaTypes=function(e){this._callMediaTypes.VIDEO=e?1:0},A.prototype.sendCallMediaTypes=function(){var e="";this._callMediaTypes.AUDIO&&(e+=r),this._callMediaTypes.VIDEO&&(e+=(e?"+":"")+_),this.sendEvent(c,e,null,!0)},A.prototype.sendOperationFailureEvent=function(e,t){this.sendEvent(e+" "+s,t,null,!0)},A.prototype.sendCallType=function(e){var t=e?i:d;this.sendEvent(v,t,null,!0)},A.prototype.sendUnavailableEvent=function(e){this.sendEvent(u,e,null,!0)},A.prototype.serviceUnavailableTimeEnd=function(e){if(e){var t=new Date-e,i=S.getServiceOutageLabel(t);this.sendTiming(u,i,t,!0)}},A.prototype.sendDroppedCallEvent=function(e){this.sendEvent(t,e,null,!0)},A.prototype.sendPreservationEvent=function(e,t){var i;t&&(i=e?h:5e3<t?p:n,this.sendEvent(C,i,null,!0))},A.prototype.callPreservationTimeStart=function(e){return e?this.startTimingMetric():m},A.prototype.callPreservationTimeEnd=function(e){var t;if(e){t=new Date-e;var i=S.getCallPreservation(t);this.sendTiming(C,i,t,!0)}return t},e.Services.Analytics.CallsAnalyticsService=A}(AvayaClientServices),function(i){"use strict";var r="Graceful",t="Avaya",s="Shutdown",e="Startup",n="Ungraceful",a=i.Providers.Analytics.AnalyticsCategories,o=i.Providers.Analytics.AnalyticsCustomDimensions;function c(e,t){this._productName=e,this._productVersion=t,i.Services.Analytics.AnalyticsService.call(this)}(c.prototype=Object.create(i.Services.Analytics.AnalyticsService.prototype))._createCategory=function(){return a.CLIENT},c.prototype._createCustomDimensions=function(){var e={};return e[o.PRODUCT_VENDOR]=t,e[o.PRODUCT_NAME]=this._productName,e[o.PRODUCT_VERSION]=this._productVersion,e},c.prototype.sendStartupEvent=function(){this.sendEvent(e,null,null,!0)},c.prototype.sendShutdownEvent=function(e){var t=e?r:n;this.sendEvent(s,t,null,!0)},c.prototype.shutdownTimeEnd=function(e,t){if(e){var i=new Date-e,a=t?r:n;this.sendTiming(s,a,i,!0)}},i.Services.Analytics.ClientAnalyticsService=c}(AvayaClientServices),function(e){"use strict";var t="Start Error",a="Duration",i="End",r="End Error",s="Failure",n="Start",o="Success",c=e.Providers.Analytics.AnalyticsStatistic,l=e.Providers.Analytics.AnalyticsCategories,d=e.Providers.Analytics.AnalyticsCustomDimensions,C=e.Providers.Analytics.AnalyticsProvidersTypes;function u(){e.Services.Analytics.AnalyticsService.call(this)}(u.prototype=Object.create(e.Services.Analytics.AnalyticsService.prototype))._createCategory=function(){return l.COLLABORATIONS},u.prototype._createCustomDimensions=function(){var e={};return e[d.PROVIDER_TYPE]=C.COLLABORATION,e},u.prototype.sendStartupEvent=function(e){var t=e?o:s;this.sendEvent(n,t,null,!0)},u.prototype.durationTimeEnd=function(e){if(e){var t=new Date-e,i=c.getCallDurationLabel(t);this.sendTiming(a,i,t,!0)}},u.prototype.sendStartErrorEvent=function(e){this.sendEvent(t,e,null,!0)},u.prototype.sendStopEvent=function(e){var t=e?o:s;this.sendEvent(i,t,null,!0)},u.prototype.sendFailureStopEvent=function(e){this.sendEvent(r,e,null,!0)},e.Services.Analytics.CollaborationsAnalyticsService=u}(AvayaClientServices),function(a){"use strict";var r=a.Providers.Analytics.AnalyticsStatistic,s="Loaded",n="Cache Search",o="Directory Search",c="Service Unavailable",l="RESOLVE_CONTACTS";function e(){a.Services.Analytics.AnalyticsService.call(this)}(e.prototype=Object.create(a.Services.Analytics.AnalyticsService.prototype))._createCategory=function(){return a.Providers.Analytics.AnalyticsCategories.CONTACTS},e.prototype._createCustomDimensions=function(){var e={};return e[a.Providers.Analytics.AnalyticsCustomDimensions.PROVIDER_TYPE]=a.Providers.Analytics.AnalyticsProvidersTypes.CONTACTS,e},e.prototype.sendNumContactsLoaded=function(e){var t=r.getContactCountLabel(e);this.sendEvent(s,t,e,!0)},e.prototype.contactsLoadTimeEnd=function(e){if(e){var t=new Date-e,i=r.getOperationTimingLabel(t);this.sendTiming(s,i,t,!0)}else a.Base.Logger.warn(a.Base.LoggerTags.ANALYTICS_SERVICE,"Contacts, contactsLoadTimeEnd: start time was not defined")},e.prototype.cachedContactsSearchTimeEnd=function(e){if(e){var t=new Date-e,i=r.getOperationTimingLabel(t);this.sendTiming(n,i,t,!1)}else a.Base.Logger.warn(a.Base.LoggerTags.ANALYTICS_SERVICE,"Contacts, cachedContactsSearchTimeEnd: start time was not defined")},e.prototype.sendNumCachedContactSearches=function(e){this.sendEvent(n,e,null,!1)},e.prototype.sendNumDirectorySearches=function(e){this.sendEvent(o,e,null,!0)},e.prototype.directorySearchTimeEnd=function(e){if(e){var t=new Date-e,i=r.getOperationTimingLabel(t);this.sendTiming(o,i,t,!0)}else a.Base.Logger.warn(a.Base.LoggerTags.ANALYTICS_SERVICE,"Contacts, directorySearchTimeEnd: start time was not defined")},e.prototype.trackContactProvidersUnavailable=function(e){this.sendEvent(c,e,null,!0)},e.prototype.durationContactProviderOutagesEnd=function(e){if(e){var t=new Date-e,i=r.getServiceOutageLabel(t);this.sendTiming(c,i,t,!0)}},e.prototype.sendNumResolveContacts=function(e){this.sendEvent(l,e,null,!0)},e.prototype.resolveContactsTimeEnd=function(e){if(e){var t=new Date-e,i=r.getOperationTimingLabel(t);this.sendTiming(l,i,t,!0)}else a.Base.Logger.warn(a.Base.LoggerTags.ANALYTICS_SERVICE,"Contacts, resolveContactsTimeEnd: start time was not defined")},a.Services.Analytics.ContactsAnalyticsService=e}(AvayaClientServices),function(e){"use strict";var t="Missed Hits",i="ga_missed_hits",a=e.Base.Storage,r=e.Providers.Analytics.AnalyticsCategories;function s(){e.Services.Analytics.AnalyticsService.call(this)}(s.prototype=Object.create(e.Services.Analytics.AnalyticsService.prototype))._createCategory=function(){return r.ANALYTICS},s.prototype._getMissedHitsObj=function(){return a.get(a.TYPES.LOCAL,i)},s.prototype.setMissedHitsObj=function(e){a.set(a.TYPES.LOCAL,i,e)},s.prototype.createMissedHitsObj=function(e,t){var i=this._getMissedHitsObj();e+=i?i.count:0,this.setMissedHitsObj({count:e,reason:t})},s.prototype.sendMissedHitsCount=function(){var e=this._getMissedHitsObj();e&&this.sendEvent(t,e.reason,e.count)},e.Services.Analytics.InfrastructureAnalyticsService=s}(AvayaClientServices),function(r){"use strict";var s=r.Providers.Analytics.AnalyticsStatistic,a="SendMessage",n="Attachment Size",o="SearchConversations",c="Service Unavailable",t="GetConversations",i="SearchConversations",l="LeaveConversations",d="ValidateAddresses",C="SendMessage",u="Text",v="Attachment",h="Body",p="Subject",_="Participants";function e(){r.Services.Analytics.AnalyticsService.call(this)}(e.prototype=Object.create(r.Services.Analytics.AnalyticsService.prototype))._createCategory=function(){return r.Providers.Analytics.AnalyticsCategories.MESSAGING},e.prototype._createCustomDimensions=function(){return{}},e.prototype._setCustomDimensionsMimeType=function(e){this._customDimensions[r.Providers.Analytics.AnalyticsCustomDimensions.MIME_TYPE]=e},e.prototype._resetCustomDimensionsMimeType=function(){delete this._customDimensions[r.Providers.Analytics.AnalyticsCustomDimensions.MIME_TYPE]},e.prototype.trackNumMessagesSent=function(e,t){var i=this._getLabelTypeMessage(e,t);this.sendEvent(a,i,null,!1)},e.prototype._getLabelTypeMessage=function(e,t){var i=[];return e&&i.push(u),t&&i.push(v),i.join("+")},e.prototype.trackMessageAttachmentSize=function(e,t){this._setCustomDimensionsMimeType(t);var i=s.getAttachmentSizeLabel(e);this.sendEvent(n,i,e,!0),this._resetCustomDimensionsMimeType()},e.prototype.trackNumConversationSearchRequests=function(e,t,i){var a=[];e&&a.push(h),t&&a.push(p),i&&a.push(_);var r=a.join("+");this.sendEvent(o,r,null,!1)},e.prototype.trackTimeRequestsGetConversationsEnd=function(e){this._sendTrackTimeRequests(t,e)},e.prototype.trackTimeRequestsSearchConversationsEnd=function(e){this._sendTrackTimeRequests(i,e)},e.prototype.trackTimeRequestsLeaveConversationsEnd=function(e){this._sendTrackTimeRequests(l,e)},e.prototype.trackTimeRequestsValidateAddressesEnd=function(e){this._sendTrackTimeRequests(d,e)},e.prototype.trackTimeRequestsSendMessageEnd=function(e){this._sendTrackTimeRequests(C,e)},e.prototype._sendTrackTimeRequests=function(e,t){if(t){var i=new Date-t,a=s.getOperationTimingLabel(i);this.sendTiming(e,a,i,!1)}else r.Base.Logger.warn(r.Base.LoggerTags.ANALYTICS_SERVICE,"Messaging, sendTrackTimeRequests: start time was not defined")},e.prototype.trackErrorsResponseGetConversations=function(e){this._trackErrorsResponse(t,e)},e.prototype.trackErrorsResponseSearchConversations=function(e){this._trackErrorsResponse(i,e)},e.prototype.trackErrorsResponseLeaveConversations=function(e){this._trackErrorsResponse(l,e)},e.prototype.trackErrorsResponseValidateAddresses=function(e){this._trackErrorsResponse(d,e)},e.prototype.trackErrorsResponseSendMessage=function(e){this._trackErrorsResponse(C,e)},e.prototype._trackErrorsResponse=function(e,t){this.sendEvent(e,t,null,!1)},e.prototype.trackServiceUnavailable=function(e){this.sendEvent(c,e,null,!1)},e.prototype.trackDurationServiceUnavailableEnd=function(e){if(e){var t=new Date-e,i=s.getServiceOutageLabel(t);this.sendTiming(c,i,t,!1)}},r.Services.Analytics.MessagingAnalyticsService=e}(AvayaClientServices),function(e){"use strict";var r="Create",s="Failure",n="Success",c="Services",a="Providers",t=e.Providers.Analytics.AnalyticsCategories,l=e.Providers.Analytics.AnalyticsServicesNames,o=e.Providers.Analytics.AnalyticsProvidersTypes;function i(){e.Services.Analytics.AnalyticsService.call(this)}(i.prototype=Object.create(e.Services.Analytics.AnalyticsService.prototype))._createCategory=function(){return t.USER},i.prototype.userCreationTimeEnd=function(e,t){if(e){var i=new Date-e,a=t?n:s;this.sendTiming(r,a,i)}},i.prototype.sendInfoByUseOfServices=function(e,t,i,a,r,s){var n="",o=function(e){n+=n?"+":"",n+=e};e&&o(l.CALL),t&&o(l.COLLABORATION),i&&o(l.CONTACT),a&&o(l.MESSAGING),r&&o(l.PRESENCE),s&&o(l.VOICE_MESSAGING),this.sendEvent(c,n)},i.prototype.sendInfoByUseOfProviders=function(e){var t="",i=function(e){-1===t.indexOf(e)&&(t+=t?"+":"",t+=e)};e.acsConfiguration&&e.acsConfiguration.enabled&&i(o.CONTACTS),e.ammConfiguration&&e.ammConfiguration.enabled&&i(o.MESSAGING),e.sgConfiguration&&e.sgConfiguration.enabled&&i(o.CALLS),e.presenceConfiguration&&e.presenceConfiguration.enabled&&i(o.PRESENCE),e.wcsConfiguration&&e.wcsConfiguration.enabled&&i(o.COLLABORATION),e.uccpConfiguration&&e.uccpConfiguration.enabled&&i(o.CONFERENCE),this.sendEvent(a,t)},e.Services.Analytics.UserAnalyticsService=i}(AvayaClientServices),function(s){"use strict";function e(e,t){this._collaborationProvider=e,this._collaborationProviderInitialized=!1,this._whiteboards={},this._nextCollaborationId=1,this._colaborationsAnalyticsService=t,this._wasScreenSharingInterrupted=!1,this._interruptedStream=m,this._interruptedSharingType=s.Services.Collaboration.ContentSharingType.NONE,this._interruptedSharingTimer=m}e.prototype={start:function(e,t,i){if(e._isStarted)return T.Deferred().resolve().promise();if(e._isStopped)return this._durationAnalyticsInit(e),e._isStopped=!1,s.Base.Logger.debug(s.Base.LoggerTags.COLLABORATION_SERVICE,"Collaboration Service is starting..."),this._collaborationProvider.start(t,i).then(function(){this._discoveryResource(e),e._isStarted=!0,e.addOnCollaborationServiceAvailableCallback(function(){e.getContentSharing()._clearActiveContentSharing(),this._recalculateAllCollaborationCapabilities(e)}.bind(this)),e.addOnCollaborationServiceUnavailableCallback(function(){e.getContentSharing().getOutgoingScreenSharingStream()&&(this._wasScreenSharingInterrupted=!0,this._interruptedStream=e.getContentSharing().getOutgoingScreenSharingStream().clone(),this._interruptedSharingType=e.getContentSharing()._contentSharingService._contentSharingType,this._interruptedSharingTimer=setTimeout(function(){this._resetInterruptedSharing()}.bind(this),3e5)),e.getContentSharing()._clearActiveContentSharing(),e.getContentSharing()._endActiveScreenSharing(e._selfParticipant),this._recalculateAllCollaborationCapabilities(e)}.bind(this)),e.getContentSharing().getShareApplicationWindowCapability().addOnChangedCallback(e._recalculateContentSharingCapability.bind(e))}.bind(this),function(e){return this._colaborationsAnalyticsService.sendStartErrorEvent(s.Services.Analytics.AnalyticsErrorCode.STARTING_COLLABORATION_ERROR),T.Deferred().reject(e).promise()}.bind(this));s.Base.Logger.error(s.Base.LoggerTags.COLLABORATION_SERVICE,"Rejected attempt to start a collaboration that is already starting.");var a=s.Services.Collaboration.CollaborationErrorReason.COLLABORATION_START_FAILURE;return T.Deferred().reject(new s.Services.Collaboration.CollaborationError(a)).promise()},_durationAnalyticsInit:function(e){var t,i;e._whiteboard.addOnWhiteboardStartedCallback(function(){i=this._colaborationsAnalyticsService.startTimingMetric()}.bind(this)),e._whiteboard.addOnWhiteboardEndedCallback(function(){this._colaborationsAnalyticsService.durationTimeEnd(i)}.bind(this)),e._contentSharing.addOnContentSharingStartedCallback(function(){t=this._colaborationsAnalyticsService.startTimingMetric()}.bind(this)),e._contentSharing.addOnContentSharingEndedCallback(function(){this._colaborationsAnalyticsService.durationTimeEnd(t)}.bind(this))},_resetInterruptedSharing:function(){this._wasScreenSharingInterrupted=!1,this._interruptedSharingType=s.Services.Collaboration.ContentSharingType.NONE,this._interruptedStream=m,clearTimeout(this._interruptedSharingTimer),this._interruptedSharingTimer=m},_discoveryResource:function(t){return this._collaborationProvider.discoverResources(t).done(function(e){t._setSelfParticipant(e),this._collaborationProvider.observeCollaboration(t),!s.Base.Utils.isUndefined(t._isAvailable)&&t._isAvailable||(t._isAvailable=!0,t._onCollaborationServiceAvailableCallbacks.fire(t)),this._recalculateAllCollaborationCapabilities(t)}.bind(this))},stop:function(e){if(e._isStopped)return T.Deferred().resolve().promise();e._isStarted=!1,e._isAvailable&&(e._isAvailable=m,e._onCollaborationServiceUnavailableCallbacks.fire(e)),s.Base.Logger.debug(s.Base.LoggerTags.COLLABORATION_SERVICE,"Collaboration Service stop");var t=e.getSlider(),i=t.getSlides();return t._removeSlides(),t._onSlidesRemovedCallbacks.fire(i),e._selfParticipant=m,e._participants.length=0,e._participants.onDataSetChanged(e._participants,s.Base.DataSetChangeTypes.REMOVED),e._onCollaborationStartedCallbacks.empty(),e._onCollaborationEndedCallbacks.empty(),e._onCollaborationServiceAvailableCallbacks.empty(),e._onCollaborationServiceUnavailableCallbacks.empty(),e._onCollaborationNearEndByEjectCallbacks.empty(),e._onCollaborationPresenterPrivilegeChangedCallbacks.empty(),e._onCollaborationModeratorPrivilegeChangedCallbacks.empty(),e._onCollaborationInitializedCallbacks.empty(),e._isPaused=!1,this._collaborationProvider.stop().then(function(){e._isStopped=!0},function(){e._isStopped=!0})},getNextCollaborationId:function(){return this._nextCollaborationId++},getParticipants:function(t){var i=new s.Base.DataRetrieval(t._participants),e=function(e){this.updateParticipantList(t,e),i._dataRetrievalProgress.fire(e.length,!1),i._dataRetrievalDone.fire()}.bind(this);return this._collaborationProvider.getParticipants(t).then(e),i},updateParticipantList:function(e,i){function t(e,t){return t.getParticipantId()===i[e].getParticipantId()}for(var a=[],r=0;r<i.length;r++){0===e._participants.filter(t.bind(this,r)).length&&(e._participants.push(i[r]),a.push(i[r]))}0<a.length&&e._participants.onDataSetChanged(a,s.Base.DataSetChangeTypes.ADDED)},_recalculateAllCollaborationCapabilities:function(e){e.getContentSharing()._recalculateShareApplicationWindowCapability(e),e.getContentSharing()._recalculateShareFullScreenCapability(e),e.getContentSharing()._recalculateShareAnyTypeCapability(e),e.getWhiteboard()._recalculateAddWhiteboardCapability(e),e._recalculateChatCapability(),e._recalculateMeetingMinutesCapability(),e._recalculateContentSharingCapability(e),e._recalculateNetworkLibraryCapability(),e._recalculateLibrarySharingCapability(),e._recalculateWhiteboardCapability(e),e._recalculateRetrieveParticipantListCapability(),e.getWhiteboard()._recalculateDrawingCapability(e),e._recalculateSliderCapability()},isFeatureSupported:function(e,t){return 0<=e._supportedFeatures.indexOf(t)&&this._collaborationProvider.isFeatureAvailable(t)},isServiceAvailable:function(){return this._collaborationProvider.isOpened()},pause:function(e){return this._collaborationProvider.pause()},resume:function(e){return this._collaborationProvider.resume()},wasScreenSharingInterrupted:function(){return this._wasScreenSharingInterrupted},getInterruptedSharingType:function(){return this._interruptedSharingType},getInterruptedSharingStream:function(){return this._interruptedStream}},s.Services.Collaboration.CollaborationService=e}(AvayaClientServices),function(a){"use strict";var t="ga_client_id",i=a.Base.Storage,r=a.Base.Utils,s=a.Providers.Analytics.AnalyticsStatistic;function e(e){var t=new a.Config.ServerInfo("www.google-analytics.com",null,!0,"/batch"),i=new a.Base.RESTProvider;this._networkProviderConfiguration=new a.Config.NetworkProviderConfiguration(t),this._networkProvider=new a.Base.NetworkProvider(i,m,a.Base.LoggerTags.ANALYTICS_PROVIDER),this._dfdStop=null,this._reportingTimer=null,this._isRunning=!1,this._stopRequested=!1,this._httpRequestsOutstanding=0,this._hitTransmissionQueue=[],this._pendingRequest="",this._countHitsRequest=0,this._retriedOnce=!1,this._commonHitParameters=s.getCommonRequestsParams(e,this._getClientID()),this._infrastructureAnalyticsService=new a.Services.Analytics.InfrastructureAnalyticsService}(e.prototype={}).start=function(){return s.setCollectionEnabledState(!0),this._startProvider()},e.prototype.stop=function(){return this._dfdStop=T.Deferred(),this._isRunning?(this._stopRequested=!0,this._stopProvider()):this._stopCompleted(),s.setCollectionEnabledState(!1),this._dfdStop.promise()},e.prototype._isCollectionEnabled=function(){return s.isCollectionEnabled()},e.prototype._startReportingCycle=function(){this._hitTransmissionQueue.length||(s.queueCollectedHits.call(this),this._hitTransmissionQueue.length&&(this._infrastructureAnalyticsService.sendMissedHitsCount(),s.queueCollectedHits.call(this),this._sendBatch()))},e.prototype._sendBatch=function(){for(this._countHitsRequest=0,this._pendingRequest="";this._hitTransmissionQueue.length&&this._countHitsRequest<20;){var e=this._commonHitParameters;if(e+=this._hitTransmissionQueue[0]+"\n",8192<r.getBytesCount(e))this._hitTransmissionQueue.shift();else{if(16384<r.getBytesCount(this._pendingRequest+e))break;this._pendingRequest+=e,this._countHitsRequest++,this._hitTransmissionQueue.shift()}}this._retriedOnce=!1,this._sendRequest()},e.prototype._sendRequest=function(){this._networkProvider.send(this._pendingRequest,{contentType:"text/plain"}).then(function(e){this._onDataReceived()}.bind(this),function(e){a.Base.Logger.error(a.Base.LoggerTags.ANALYTICS_PROVIDER,"Failed to send request",e),this._onErrorReceived(e)}.bind(this)),this._httpRequestsOutstanding++},e.prototype._onDataReceived=function(){this._infrastructureAnalyticsService.setMissedHitsObj(null),this._pendingRequest="",this._hitTransmissionQueue.length&&this._sendBatch(),this._onRequestCompleted()},e.prototype._onErrorReceived=function(e){this._stopRequested||this._retriedOnce||!this._pendingRequest?(this._infrastructureAnalyticsService.createMissedHitsObj(this._countHitsRequest+this._hitTransmissionQueue.length,e.name),this._pendingRequest="",this._hitTransmissionQueue.length=0):(this._retriedOnce=!0,this._sendRequest()),this._onRequestCompleted()},e.prototype._onRequestCompleted=function(){--this._httpRequestsOutstanding<=0&&(this._httpRequestsOutstanding=0,this._stopRequested&&this._stopCompleted())},e.prototype._stopCompleted=function(){this._stopRequested=!1,this._httpRequestsOutstanding=0,this._dfdStop&&this._dfdStop.resolve()},e.prototype._startProvider=function(){this._networkProvider.start(this._networkProviderConfiguration),this._startReportingTimer(),this._isRunning=!0;var e=T.Deferred();return e.resolve(),e.promise()},e.prototype._stopProvider=function(){if(this._stopReportingTimer(),this._isRunning){for(this._isRunning=!1,s.queueCollectedHits.call(this);this._hitTransmissionQueue.length;)this._sendBatch();this._httpRequestsOutstanding<=0&&this._stopCompleted()}},e.prototype._startReportingTimer=function(){this._reportingTimer||(this._reportingTimer=window.setInterval(function(){this._startReportingCycle()}.bind(this),5e3))},e.prototype._stopReportingTimer=function(){this._reportingTimer&&(window.clearInterval(this._reportingTimer),this._reportingTimer=null)},e.prototype._getClientID=function(){var e=i.get(i.TYPES.LOCAL,t);return void 0===e&&(e=a.Base.Utils.generateUUID(),i.set(i.TYPES.LOCAL,t,e)),e},a.Providers.Analytics.AnalyticsProvider=e}(AvayaClientServices),function(f){"use strict";var C=f.Providers.Analytics.AnalyticsStatistic;function e(e,t,i){if(this._config=f.Base.Utils.deepMerge(new f.Config.UserConfiguration,e),this._mediaServiceFactory=t,this._version=i,this._collaborationFactory=m,this._collaboration=m,this._collaborations=m,this._callFactory=m,this._calls=m,this._messagingFactory=m,this._messaging=m,this._contacts=m,this._contactsService=m,this._contactsIntegrationService=m,this._presenceService=m,this._voiceMessaging=m,this._bandwidthManager=new f.Base.BandwidthManager(this._config),this._diagnosticDataGenerator=new f.Base.DiagnosticDataGenerator,this._loggingInterval=m,this._isStopping=!1,this._isStarting=!1,this._isStarted=!1,this._userRegistrationSuccessfulCallbacks=T.Callbacks(),this._userUnregistrationSuccessfulCallbacks=T.Callbacks(),this._userRegistrationFailedCallbacks=T.Callbacks(),this._userUnregistrationFailedCallbacks=T.Callbacks(),this._providerFactory=new f.Base.ProviderFactory,this._contactsIntegrationService=new f.Services.Contacts.ContactsIntegrationService,this._config.presenceConfiguration&&this._config.presenceConfiguration.enabled&&this._config.sgConfiguration&&this._config.sgConfiguration.enabled){var a=this._config.sgConfiguration.networkProviderConfiguration.restConfig,r=a.hostName+":"+a.port,s=this._providerFactory.getPresenceProviders(r)[0];this._presenceService=new f.Services.Presence.PresenceService(s)}if(this._config.acsConfiguration&&this._config.acsConfiguration.enabled){var n=this._providerFactory.getContactsProviders(this._config)[0],o=this._providerFactory.getDirectorySearchProviders(this._config)[0],c=new f.Services.Analytics.ContactsAnalyticsService;this._contactsService=new f.Services.Contacts.ContactsService(n,o,this._contactsIntegrationService,this._presenceService,c),this._contacts=new f.Services.Contacts.Contacts(this._contactsService)}if(this._config.sgConfiguration&&this._config.sgConfiguration.enabled){var l=this._providerFactory.getVoiceMessagingProvider(this._config.sgConfiguration);this._voiceMessaging=new f.Services.VoiceMessaging.VoiceMessaging(l)}if(this._config.mediaServiceContext){f.Base.Logger.addLogger(this._providerFactory.getRemoteLoggerProvider().getLogger());var d=atob(this._config.mediaServiceContext);this._config._mediaServiceConfiguration=JSON.parse(d);var C=f.Base.Utils.parseUrl(this._config._mediaServiceConfiguration.userAgentURL),u=new f.Config.ServerInfo(C.hostname,isNaN(C.port)?m:C.port,C.isSecure,C.path,C.credentials,C.query);this._config.sgConfiguration.networkProviderConfiguration=new f.Config.NetworkProviderConfiguration(u);var v=new f.Config.GuestCredentialProvider;this._config.sgConfiguration.credentialProvider=v,this._config.sgConfiguration.enabled=!0}if(this._config.sgConfiguration===m||f.Base.Utils.isBool(this._config.sgConfiguration.enabled)){var h=new f.Services.Analytics.CallsAnalyticsService;this._callFactory=new f.Services.Call.CallFactory(this._providerFactory,this._mediaServiceFactory,this._contactsIntegrationService,this._bandwidthManager,h),this._callFactory.init(this._config),this._calls=this._callFactory.getCalls()}if(this._config.ammConfiguration&&this._config.ammConfiguration.enabled&&(this._messagingFactory=new f.Services.Messaging.MessagingFactory(this._config,this._providerFactory,this._contactsIntegrationService),this._messaging=this._messagingFactory.create()),this._config.wcsConfiguration&&this._config.wcsConfiguration.enabled){var p=new f.Services.Analytics.CollaborationsAnalyticsService;this._collaborationFactory=new f.Services.Collaboration.CollaborationFactory(this._config,this._providerFactory,this._bandwidthManager,p),this._collaborations=new f.Services.Collaboration.Collaborations(this._collaborationFactory),this._collaboration=this._collaborations.getCollaborationById("standalone"),this._callFactory&&this._callFactory._callService&&this._callFactory._callService.setCollaborations(this._collaborations)}this._config.analyticsConfiguration&&(this._analyticsProvider=new f.Providers.Analytics.AnalyticsProvider(i)),this._clientAnalyticsService=new f.Services.Analytics.ClientAnalyticsService(this._config.applicationProductName,this._config.applicationProductVersion),this._userAnalyticsService=new f.Services.Analytics.UserAnalyticsService}e.prototype={getCollaboration:function(){return f.Base.Logger.warn(f.Base.LoggerTags.USER_SERVICE,"getCollaboration function is deprecated. Please use AvayaClientServices.User.prototype.getCollaborations instead. Usage of the new function is slightly different."),this._collaboration},getCollaborations:function(){return this._collaborations},getMessaging:function(){return this._messaging},getContacts:function(){return this._contacts},getSelfContact:function(){return this._contactsService.getSelfContact()},getPresenceService:function(){return this._presenceService},getCalls:function(){return this._calls},getVoiceMessaging:function(){return this._voiceMessaging},stop:function(){var t=this._clientAnalyticsService.startTimingMetric(),i=T.Deferred(),e=[];if(this._isStopping)return f.Base.Logger.warn(f.Base.LoggerTags.USER_SERVICE,"Cannot stop while services are still stopping."),i.reject(new f.Base.BaseError(f.Base.ErrorReasons.CAPABILITY_INVALID_STATE)),i.promise();if(this._isStarting)return f.Base.Logger.warn(f.Base.LoggerTags.USER_SERVICE,"Cannot stop while services are still starting."),i.reject(new f.Base.BaseError(f.Base.ErrorReasons.CAPABILITY_INVALID_STATE)),i.promise();if(this._isStopping=!0,this._messaging){var a=this._messaging.stop();e.push(a)}if(this._voiceMessaging){var r=this._voiceMessaging.stop();e.push(r)}if(this._calls){var s=this._config.callUserConfiguration.incomingCall,n=this._calls._stop();e.push(n),n.then(function(){return s&&this._userUnregistrationSuccessfulCallbacks.fire(),this._resetRegistrationCallbacks(),this._mediaServiceFactory.stop()}.bind(this),function(e){return s&&this._userUnregistrationFailedCallbacks.fire(e),this._mediaServiceFactory.stop()}.bind(this))}else if(this._mediaServiceFactory){var o=this._mediaServiceFactory.stop();e.push(o)}if(this._presenceService){var c=this._presenceService.stop();e.push(c)}if(this._contacts){var l=this._contacts.stop();e.push(l)}if(this._collaborations){var d=this._collaborations._stopAndDeleteAllCollaborations();e.push(d)}return clearInterval(this._loggingInterval),T.when.apply(this,e).then(function(){this._isStopping=!1,C.isCollectionEnabled()?(this._clientAnalyticsService.sendShutdownEvent(!0),this._clientAnalyticsService.shutdownTimeEnd(t,!0),this._analyticsProvider.stop().then(function(){i.resolve()}.bind(this))):i.resolve()}.bind(this),function(e){this._isStopping=!1,C.isCollectionEnabled()?(this._clientAnalyticsService.sendShutdownEvent(!1),this._clientAnalyticsService.shutdownTimeEnd(t,!1),this._analyticsProvider.stop().always(function(){i.reject(e)})):i.reject(e)}.bind(this)).always(function(){this._isStarted=!1,this._config.mediaServiceContext&&(this._calls._uploadLogs(),f.Base.Logger.removeLogger(this._providerFactory.getRemoteLoggerProvider().getLogger()))}.bind(this)),i.promise()},stopImmediately:function(){var e=this._clientAnalyticsService.startTimingMetric(),t=T.Deferred(),i=[];if(this._isStopping)return f.Base.Logger.warn(f.Base.LoggerTags.USER_SERVICE,"Cannot stop while services are still stopping."),t.reject(new f.Base.BaseError(f.Base.ErrorReasons.CAPABILITY_INVALID_STATE)),t.promise();if(this._isStarting)return f.Base.Logger.warn(f.Base.LoggerTags.USER_SERVICE,"Cannot stop while services are still starting."),t.reject(new f.Base.BaseError(f.Base.ErrorReasons.CAPABILITY_INVALID_STATE)),t.promise();if(this._isStopping=!0,this._calls){var a=this._calls._stopImmediately().always(function(){this._stopOtherServicesImmediately(i,t)}.bind(this));i.push(a)}else this._stopOtherServicesImmediately(i,t,e);return t.promise()},_stopOtherServicesImmediately:function(e,t,i){if(this._voiceMessaging){var a=this._voiceMessaging._stopImmediately();e.push(a)}if(this._presenceService){var r=this._presenceService._stopImmediately();e.push(r)}if(this._messaging){var s=this._messaging._stopImmediately();e.push(s)}if(this._contacts){var n=this._contacts._stopImmediately();e.push(n)}if(this._collaborations){var o=this._collaborations._stopImmediately();e.push(o)}T.when.apply(this,e).then(function(){this._isStopping=!1,C.isCollectionEnabled()?(this._clientAnalyticsService.sendShutdownEvent(!0),this._clientAnalyticsService.shutdownTimeEnd(i,!0),this._analyticsProvider.stop().then(function(){t.resolve()}.bind(this))):t.resolve()}.bind(this),function(e){this._isStopping=!1,C.isCollectionEnabled()?(this._clientAnalyticsService.sendShutdownEvent(!1),this._clientAnalyticsService.shutdownTimeEnd(i,!1),this._analyticsProvider.stop().always(function(){t.reject(e)})):t.reject(e)}.bind(this)).always(function(){this._isStarted=!1}.bind(this))},start:function(){var t=this._clientAnalyticsService.startTimingMetric();f.Base.Logger.info(f.Base.LoggerTags.USER_SERVICE,"Starting SDK, version is "+this._version);var i=T.Deferred();try{this._checkDependencies()}catch(e){var a=e.getMessage(),r=e.getData(),s=r.extent===f.Base.Library.Service.SUPPORT_EXTENT_NONE?f.Base.Logger.error:f.Base.Logger.warn,n=a+" "+r.info;if(s(f.Base.LoggerTags.USER_SERVICE,n),r.extent===f.Base.Library.Service.SUPPORT_EXTENT_NONE)return i.reject(e).promise()}var o,c=[];if(f.Base.Logger.info(f.Base.LoggerTags.USER_SERVICE,"Browser detected as "+f.Base.Utils.getBrowserType()),f.Base.Logger.info(f.Base.LoggerTags.USER_SERVICE,"User agent "+navigator.userAgent),this._isStopping)return f.Base.Logger.warn(f.Base.LoggerTags.USER_SERVICE,"Cannot start while services are still stopping."),i.reject(new f.Base.BaseError(f.Base.ErrorReasons.CAPABILITY_INVALID_STATE)),i.promise();if(this._isStarting)return f.Base.Logger.warn(f.Base.LoggerTags.USER_SERVICE,"Cannot start service while services are still starting."),i.reject(new f.Base.BaseError(f.Base.ErrorReasons.CAPABILITY_INVALID_STATE)),i.promise();if(this._isStarted)return f.Base.Logger.warn(f.Base.LoggerTags.USER_SERVICE,"Cannot start service while service is already started."),i.reject(new f.Base.BaseError(f.Base.ErrorReasons.CAPABILITY_INVALID_STATE)),i.promise();if(this._isStarting=!0,this._analyticsProvider&&this._config.analyticsConfiguration&&this._config.analyticsConfiguration.enabled){var e=this._analyticsProvider.start();c.push(e),this._userAnalyticsService.sendInfoByUseOfServices(this._calls,this._collaboration||this._collaborations,this._contacts,this._messaging,this._presenceService,this._voiceMessaging),this._userAnalyticsService.sendInfoByUseOfProviders(this._config)}if(this._contacts){var l=this._contacts.start(this._config);c.push(l)}if(this._messaging){var d=this._messaging.start(this._config);c.push(d)}if(this._presenceService){var C=this._presenceService.start(this._config);c.push(C)}if(this._calls){if(o=T.Deferred(),this._config.mediaConfiguration.mediaEngineEnabled)if(this._config.mediaConfiguration.retrieveDeviceLabelsEnabled&&window.navigator.mediaDevices&&window.navigator.mediaDevices.getUserMedia){var u=T.Deferred();this._startMediaServiceFactory(u),c.push(u)}else c.push(this._mediaServiceFactory.start());var v=this._config.callUserConfiguration.incomingCall,h=this._calls._start();c.push(h),this._calls._onIviewTokenChanged=function(e){v&&this._userRegistrationSuccessfulCallbacks.fire(e)}.bind(this),h.then(function(e){v&&this._userRegistrationSuccessfulCallbacks.fire(e),o.resolve()}.bind(this),function(e){v&&this._userRegistrationFailedCallbacks.fire(e),o.reject(e)}.bind(this))}if(this._voiceMessaging)if(this._calls){var p=T.Deferred();c.push(p),o.promise().always(function(){this._voiceMessaging.start(this._config).then(function(){p.resolve()},function(e){p.reject(e)})}.bind(this))}else{var _=this._voiceMessaging.start(this._config);c.push(_)}this._loggingInterval=setInterval(function(){this._logDiagnosticData()}.bind(this),3e5);var S=0,g=0;return f.Base.Logger.info(f.Base.LoggerTags.USER_SERVICE,"Starting "+c.length+" services."),c.forEach(function(e){e.then(function(){g++,i.state()===f.Base.DeferredStates.PENDING&&g+S===c.length&&(this._userAnalyticsService.userCreationTimeEnd(t,!0),this._isStarting=!1,this._isStarted=!0,f.Base.Logger.info(f.Base.LoggerTags.USER_SERVICE,"Resolving promise : ["+g+","+S+"]"),i.resolve())}.bind(this),function(){S++,i.state()===f.Base.DeferredStates.PENDING&&(S===c.length?(this._userAnalyticsService.userCreationTimeEnd(t,!1),this._isStarting=!1,f.Base.Logger.info(f.Base.LoggerTags.USER_SERVICE,"Rejecting promise : ["+g+","+S+"]"),i.reject()):g+S===c.length&&(this._userAnalyticsService.userCreationTimeEnd(t,!0),this._isStarting=!1,this._isStarted=!0,f.Base.Logger.info(f.Base.LoggerTags.USER_SERVICE,"Resolving promise : ["+g+","+S+"]"),i.resolve()))}.bind(this))}.bind(this)),this._clientAnalyticsService.sendStartupEvent(),i.promise()},_startMediaServiceFactory:function(t){if(f.Base.Utils.getBrowserType()===f.Base.BrowserType.SAFARI)this._startMediaServiceFactoryForSafari(t);else{var i=function(t){return this._mediaServiceFactory.start().then(function(){t.getTracks().forEach(function(e){e.stop()}),this._mediaServiceFactory.getMediaServicesService()._setDefaultDevices(t)}.bind(this),function(e){t.getTracks().forEach(function(e){e.stop()})}.bind(this))}.bind(this);window.navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(function(e){i(e).then(function(){t.resolve()},function(e){t.reject(e)})}.bind(this)).catch(function(e){if("NotAllowedError"!==e.name&&"NotFoundError"!==e.name&&"PermissionDeniedError"!==e.name)return t.reject("Can not receive media stream: "+e),f.Base.Logger.info(f.Base.LoggerTags.USER_SERVICE,"Can not receive media stream: "+e),this._mediaServiceFactory.start();window.navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(e){i(e).then(function(){t.resolve()},function(e){t.reject(e)})}.bind(this),function(e){return t.reject("Can not receive media stream: "+e),f.Base.Logger.info(f.Base.LoggerTags.USER_SERVICE,"Can not receive media stream: "+e),this._mediaServiceFactory.start()}.bind(this))}.bind(this))}},_startMediaServiceFactoryForSafari:function(a){var r=function(t){return this._mediaServiceFactory.start().then(function(){t.getTracks().forEach(function(e){e.stop()}),this._mediaServiceFactory.getMediaServicesService()._setDefaultDevices(t)}.bind(this),function(e){t.getTracks().forEach(function(e){e.stop()})})}.bind(this);window.navigator.mediaDevices.getUserMedia({audio:!0}).then(function(i){window.navigator.mediaDevices.getUserMedia({video:!0}).then(function(t){i.getTracks().forEach(function(e){t.addTrack(e)}),r(t).then(function(){a.resolve()},function(e){a.reject(e)})}.bind(this),function(e){f.Base.Logger.info(f.Base.LoggerTags.USER_SERVICE,"Can only receive audio stream: "+e),r(i).then(function(){a.resolve()},function(e){a.reject()})}.bind(this))}.bind(this)).catch(function(e){return"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?(a.reject("Audio media stream permission denied: "+e),f.Base.Logger.info(f.Base.LoggerTags.USER_SERVICE,"Audio media stream permission denied: "+e)):(a.reject("Can not receive media stream: "+e),f.Base.Logger.info(f.Base.LoggerTags.USER_SERVICE,"Can not receive media stream: "+e)),this._mediaServiceFactory.start()}.bind(this))},_checkDependencies:function(){var e=f.Base.Library.Service.jQuery.getSupportExtent();if(e!==f.Base.Library.Service.SUPPORT_EXTENT_FULL){var t={extent:e,info:"Supported version of jQuery is "+f.Base.Library.Service.jQuery.getSupportedVersion()+" while current version is "+f.Base.Library.Service.jQuery.getCurrentVersion()};throw new f.Base.BaseError(f.Base.ErrorReasons.LIBRARY_NOT_SUPPORTED,t)}},_resetRegistrationCallbacks:function(){this._userRegistrationSuccessfulCallbacks.empty(),this._userUnregistrationSuccessfulCallbacks.empty(),this._userRegistrationFailedCallbacks.empty(),this._userUnregistrationFailedCallbacks.empty()},_logDiagnosticData:function(){var t=[];this._diagnosticDataGenerator.generateBatteryLogs(this._config).then(function(e){return t=t.concat(e),this._diagnosticDataGenerator.generateMessagingLogs(this._messaging)}.bind(this)).then(function(e){return t=t.concat(e),this._diagnosticDataGenerator.generateContactsLogs(this._contacts)}.bind(this)).then(function(e){return t=t.concat(e),this._diagnosticDataGenerator.generateCallLogs(this._calls)}.bind(this)).then(function(e){return t=t.concat(e),this._diagnosticDataGenerator.generatePerformanceLogs()}.bind(this)).then(function(e){t=t.concat(e),f.Base.Logger.info(f.Base.LoggerTags.USER_SERVICE,t.join("\r\n"))}.bind(this))}},f.Base.AOPTools.addAdvices(e,"User",["getSelfContact"],[f.Base.AOPCommonAdvices.LOG_USER_API_CALLS]),f.Base.AOPTools.addAdvices(e,"User",["start","stop","stopImmediately"],[f.Base.AOPCommonAdvices.LOG_USER_API_CALLS,f.Base.AOPCommonAdvices.WRAP_CAUGHT_USER_ERROR]),f.Base.AOPTools.addAdvices(window.AvayaClientServices,"AvayaClientServices",["createUser","registerLogger"],[f.Base.AOPCommonAdvices.LOG_USER_API_CALLS]),f.User=e}(AvayaClientServices),function(e){"use strict";T.extend(e.User.prototype,{addOnUserRegistrationSuccessful:function(e){this._userRegistrationSuccessfulCallbacks.add(e)},removeOnUserRegistrationSuccessful:function(e){this._userRegistrationSuccessfulCallbacks.remove(e)},addOnUserRegistrationFailed:function(e){this._userRegistrationFailedCallbacks.add(e)},removeOnUserRegistrationFailed:function(e){this._userRegistrationFailedCallbacks.remove(e)},addOnUserUnregistrationSuccessful:function(e){this._userUnregistrationSuccessfulCallbacks.add(e)},removeOnUserUnregistrationSuccessful:function(e){this._userUnregistrationSuccessfulCallbacks.remove(e)},addOnUserUnregistrationFailed:function(e){this._userUnregistrationFailedCallbacks.add(e)},removeOnUserUnregistrationFailed:function(e){this._userUnregistrationFailedCallbacks.remove(e)}})}(AvayaClientServices),AvayaClientServices.Base.Library.Service.jQuery.addOnVersionChangedCallback(function(e){T=e})}();
!function(e,t){"function"==typeof define&&define.amd?define(t):"undefined"!=typeof exports?module.exports=t():e.atmosphere=t()}(this,function(){"use strict";var e,t={},n=!1,o=[],r=[],a=0,i=Object.prototype.hasOwnProperty;return t={version:"2.3.3-javascript",onError:function(){},onClose:function(){},onOpen:function(){},onReopen:function(){},onMessage:function(){},onReconnect:function(){},onMessagePublished:function(){},onTransportFailure:function(){},onLocalMessage:function(){},onFailureToReconnect:function(){},onClientTimeout:function(){},onOpenAfterResume:function(){},onBeforeUnload:void 0,WebsocketApiAdapter:function(e){var n,o;return e.onMessage=function(e){o.onmessage({data:e.responseBody})},e.onMessagePublished=function(e){o.onmessage({data:e.responseBody})},e.onOpen=function(e){o.onopen(e)},o={close:function(){n.close()},send:function(e){n.push(e)},onmessage:function(){},onopen:function(){},onclose:function(){},onerror:function(){}},n=new t.subscribe(e),o},AtmosphereRequest:function(e){function o(){ye=!0,ke=!1,we=0,ge=null,me=null,he=null,be=null}function i(){f(),o()}function s(e){return"debug"==e?"debug"===fe.logLevel:"info"==e?"info"===fe.logLevel||"debug"===fe.logLevel:"warn"==e?"warn"===fe.logLevel||"info"===fe.logLevel||"debug"===fe.logLevel:"error"==e?"error"===fe.logLevel||"warn"===fe.logLevel||"info"===fe.logLevel||"debug"===fe.logLevel:!1}function c(e){s("debug")&&t.util.debug(new Date+" Atmosphere: "+e)}function l(e,t){return""===pe.partialMessage&&"streaming"===t.transport&&e.responseText.length>t.maxStreamingLength?!0:!1}function u(){if(fe.enableProtocol&&!fe.disableDisconnect&&!fe.firstMessage){var e="X-Atmosphere-Transport=close&X-Atmosphere-tracking-id="+fe.uuid,n=fe.url.replace(/([?&])_=[^&]*/,e);n+=n===fe.url?(/\?/.test(fe.url)?"&":"?")+e:"";var o={connected:!1},r=new t.AtmosphereRequest(o);r.connectTimeout=fe.connectTimeout,r.attachHeadersAsQueryString=!1,r.dropHeaders=!0,r.url=n,r.contentType="text/plain",r.transport="polling",r.method="GET",r.data="",r.heartbeat=null,fe.enableXDR&&(r.enableXDR=fe.enableXDR),r.async=fe.closeAsync,r.headers=fe.headers,_("",r)}}function d(){c("Closing (AtmosphereRequest._close() called)"),ke=!0,fe.reconnectId&&(clearTimeout(fe.reconnectId),delete fe.reconnectId),fe.heartbeatTimer&&clearTimeout(fe.heartbeatTimer),fe.reconnect=!1,pe.request=fe,pe.state="unsubscribe",pe.responseBody="",pe.status=408,pe.partialMessage="",ce(),u(),f()}function f(){pe.partialMessage="",fe.id&&clearTimeout(fe.id),fe.heartbeatTimer&&clearTimeout(fe.heartbeatTimer),fe.reconnectId&&(clearTimeout(fe.reconnectId),delete fe.reconnectId),null!=be&&(be.close(),be=null),null!=ve&&(ve.abort(),ve=null),null!=he&&(he.abort(),he=null),null!=ge&&(ge.canSendMessage&&(c("invoking .close() on WebSocket object"),ge.close()),ge=null),null!=me&&(me.close(),me=null),p()}function p(){null!=le&&(clearInterval(ue),document.cookie=de+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",le.signal("close",{reason:"",heir:ke?(le.get("children")||[])[0]:xe}),le.close()),null!=Ce&&Ce.close()}function g(e){i(),fe=t.util.extend(fe,e),fe.mrequest=fe.reconnect,fe.reconnect||(fe.reconnect=!0)}function m(){return null!=fe.webSocketImpl||window.WebSocket||window.MozWebSocket}function h(){var e=t.util.getAbsoluteURL(fe.url.toLowerCase()),n=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/.exec(e),o=!(!n||n[1]==window.location.protocol&&n[2]==window.location.hostname&&(n[3]||("http:"===n[1]?80:443))==(window.location.port||("http:"===window.location.protocol?80:443)));return window.EventSource&&(!o||!t.util.browser.safari||t.util.browser.vmajor>=7)}function b(){if(fe.shared){if(Ce=v(fe),null!=Ce&&(s("debug")&&t.util.debug("Storage service available. All communication will be local"),Ce.open(fe)))return;s("debug")&&t.util.debug("No Storage service available."),Ce=null}fe.firstMessage=0==a?!0:!1,fe.isOpen=!1,fe.ctime=t.util.now(),0===fe.uuid&&(fe.uuid=a),pe.closedByClientTimeout=!1,"websocket"!==fe.transport&&"sse"!==fe.transport?X(fe):"websocket"===fe.transport?m()?x(!1):B("Websocket is not supported, using request.fallbackTransport ("+fe.fallbackTransport+")"):"sse"===fe.transport&&(h()?C(!1):B("Server Side Events(SSE) is not supported, using request.fallbackTransport ("+fe.fallbackTransport+")"))}function v(e){function n(e,t){var n,o=e.length;for(n=0;o>n;n++)e[n]===t&&e.splice(n,1);return o!==e.length}function o(n){var o=t.util.parseJSON(n),r=o.data;if("c"===o.target)switch(o.type){case"open":w("opening","local",fe);break;case"close":s||(s=!0,"aborted"===r.reason?d():r.heir===xe?b():setTimeout(function(){b()},100));break;case"message":oe(r,"messageReceived",200,e.transport);break;case"localMessage":ne(r)}}function r(){var e=new RegExp("(?:^|; )("+encodeURIComponent(c)+")=([^;]*)").exec(document.cookie);return e?t.util.parseJSON(decodeURIComponent(e[2])):void 0}var a,i,s,c="atmosphere-"+e.url,l={storage:function(){function r(e){e.key===c&&e.newValue&&o(e.newValue)}if(t.util.storage){var a=window.localStorage,i=function(e){return t.util.parseJSON(a.getItem(c+"-"+e))},s=function(e,n){a.setItem(c+"-"+e,t.util.stringifyJSON(n))};return{init:function(){return s("children",i("children").concat([xe])),t.util.on(window,"storage",r),i("opened")},signal:function(e,n){a.setItem(c,t.util.stringifyJSON({target:"p",type:e,data:n}))},close:function(){var o=i("children");t.util.off(window,"storage",r),o&&n(o,e.id)&&s("children",o)}}}},windowref:function(){var e=window.open("",c.replace(/\W/g,""));if(e&&!e.closed&&e.callbacks)return{init:function(){return e.callbacks.push(o),e.children.push(xe),e.opened},signal:function(n,o){!e.closed&&e.fire&&e.fire(t.util.stringifyJSON({target:"p",type:n,data:o}))},close:function(){s||(n(e.callbacks,o),n(e.children,xe))}}}};return a=r(),!a||t.util.now()-a.ts>1e3||!(i=l.storage()||l.windowref())?void 0:{open:function(){var n;return ue=setInterval(function(){var e=a;a=r(),a&&e.ts!==a.ts||o(t.util.stringifyJSON({target:"c",type:"close",data:{reason:"error",heir:e.heir}}))},1e3),n=i.init(),n&&setTimeout(function(){w("opening","local",e)},50),n},send:function(e){i.signal("send",e)},localSend:function(e){i.signal("localSend",t.util.stringifyJSON({id:xe,event:e}))},close:function(){ke||(clearInterval(ue),i.signal("close"),i.close())}}}function y(){function e(e){var n=t.util.parseJSON(e),o=n.data;if("p"===n.target)switch(n.type){case"send":z(o);break;case"localSend":ne(o);break;case"close":d()}}function n(){document.cookie=de+"="+encodeURIComponent(t.util.stringifyJSON({ts:t.util.now()+1,heir:(o.get("children")||[])[0]}))+"; path=/"}var o,r="atmosphere-"+fe.url,a={storage:function(){function n(t){t.key===r&&t.newValue&&e(t.newValue)}if(t.util.storage){var o=window.localStorage;return{init:function(){t.util.on(window,"storage",n)},signal:function(e,n){o.setItem(r,t.util.stringifyJSON({target:"c",type:e,data:n}))},get:function(e){return t.util.parseJSON(o.getItem(r+"-"+e))},set:function(e,n){o.setItem(r+"-"+e,t.util.stringifyJSON(n))},close:function(){t.util.off(window,"storage",n),o.removeItem(r),o.removeItem(r+"-opened"),o.removeItem(r+"-children")}}}},windowref:function(){var n,o=r.replace(/\W/g,""),a=document.getElementById(o);return a||(a=document.createElement("div"),a.id=o,a.style.display="none",a.innerHTML='<iframe name="'+o+'" />',document.body.appendChild(a)),n=a.firstChild.contentWindow,{init:function(){n.callbacks=[e],n.fire=function(e){var t;for(t=0;t<n.callbacks.length;t++)n.callbacks[t](e)}},signal:function(e,o){!n.closed&&n.fire&&n.fire(t.util.stringifyJSON({target:"c",type:e,data:o}))},get:function(e){return n.closed?null:n[e]},set:function(e,t){n.closed||(n[e]=t)},close:function(){}}}};Re=function(e){o.signal("message",e)},o=a.storage()||a.windowref(),o.init(),s("debug")&&t.util.debug("Installed StorageService "+o),o.set("children",[]),null==o.get("opened")||o.get("opened")||o.set("opened",!1),de=encodeURIComponent(r),n(),ue=setInterval(n,1e3),le=o}function w(e,t,n){if(fe.shared&&"local"!==t&&y(),null!=le&&le.set("opened",!0),n.close=function(){d()},we>0&&"re-connecting"===e)n.isReopen=!0,N(pe);else if(null==pe.error){pe.request=n;var o=pe.state;pe.state=e;var r=pe.transport;pe.transport=t;var a=pe.responseBody;ce(),pe.responseBody=a,pe.state=o,pe.transport=r}}function T(e){e.transport="jsonp";var n,o=fe;null!=e&&"undefined"!=typeof e&&(o=e),ve={open:function(){function r(){o.lastIndex=0,o.openId&&clearTimeout(o.openId),o.heartbeatTimer&&clearTimeout(o.heartbeatTimer),o.reconnect&&we++<o.maxReconnectOnClose?(w("re-connecting",o.transport,o),P(ve,o,e.reconnectInterval),o.openId=setTimeout(function(){M(o)},o.reconnectInterval+1e3)):U(0,"maxReconnectOnClose reached")}function a(){var t=o.url;null!=o.dispatchUrl&&(t+=o.dispatchUrl);var a=o.data;o.attachHeadersAsQueryString&&(t=H(o),""!==a&&(t+="&X-Atmosphere-Post-Body="+encodeURIComponent(a)),a="");var s=document.head||document.getElementsByTagName("head")[0]||document.documentElement;n=document.createElement("script"),n.src=t+"&jsonpTransport="+i,n.clean=function(){n.clean=n.onerror=n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),2===++e.scriptCount&&(e.scriptCount=1,r())},n.onload=n.onreadystatechange=function(){c("jsonp.onload"),(!n.readyState||/loaded|complete/.test(n.readyState))&&n.clean()},n.onerror=function(){c("jsonp.onerror"),e.scriptCount=1,n.clean()},s.insertBefore(n,s.firstChild)}var i="atmosphere"+ ++xe;window[i]=function(n){if(c("jsonp.window"),e.scriptCount=0,o.reconnect&&-1===o.maxRequest||o.requestCount++<o.maxRequest){if(o.executeCallbackBeforeReconnect||P(ve,o,o.pollingInterval),null!=n&&"string"!=typeof n)try{n=n.message}catch(r){}var a=L(n,o,pe);a||oe(pe.responseBody,"messageReceived",200,o.transport),o.executeCallbackBeforeReconnect&&P(ve,o,o.pollingInterval),I(o)}else t.util.log(fe.logLevel,["JSONP reconnect maximum try reached "+fe.requestCount]),U(0,"maxRequest reached")},setTimeout(function(){a()},50)},abort:function(){n&&n.clean&&n.clean()}},ve.open()}function S(e){return null!=fe.webSocketImpl?fe.webSocketImpl:window.WebSocket?new WebSocket(e):new MozWebSocket(e)}function k(){return H(fe,t.util.getAbsoluteURL(fe.webSocketUrl||fe.url)).replace(/^http/,"ws")}function R(){var e=H(fe);return e}function C(e){pe.transport="sse";var n=R();if(s("debug")&&(t.util.debug("Invoking executeSSE"),t.util.debug("Using URL: "+n)),e&&!fe.reconnect)return void(null!=me&&f());try{me=new EventSource(n,{withCredentials:fe.withCredentials})}catch(o){return U(0,o),void B("SSE failed. Downgrading to fallback transport and resending")}fe.connectTimeout>0&&(fe.id=setTimeout(function(){e||f()},fe.connectTimeout)),me.onopen=function(){c("sse.onopen"),I(fe),s("debug")&&t.util.debug("SSE successfully opened"),fe.enableProtocol?fe.isReopen&&(fe.isReopen=!1,w("re-opening",fe.transport,fe)):e?w("re-opening","sse",fe):w("opening","sse",fe),e=!0,"POST"===fe.method&&(pe.state="messageReceived",me.send(fe.data))},me.onmessage=function(e){if(c("sse.onmessage"),I(fe),!fe.enableXDR&&window.location.host&&e.origin&&e.origin!==window.location.protocol+"//"+window.location.host)return void t.util.log(fe.logLevel,["Origin was not "+window.location.protocol+"//"+window.location.host]);pe.state="messageReceived",pe.status=200,e=e.data;var n=L(e,fe,pe);n||(ce(),pe.responseBody="",pe.messages=[])},me.onerror=function(){c("sse.onerror"),clearTimeout(fe.id),fe.heartbeatTimer&&clearTimeout(fe.heartbeatTimer),pe.closedByClientTimeout||(se(e),f(),ke?t.util.log(fe.logLevel,["SSE closed normally"]):e?fe.reconnect&&"sse"===pe.transport&&(we++<fe.maxReconnectOnClose?(w("re-connecting",fe.transport,fe),fe.reconnectInterval>0?fe.reconnectId=setTimeout(function(){C(!0)},fe.reconnectInterval):C(!0),pe.responseBody="",pe.messages=[]):(t.util.log(fe.logLevel,["SSE reconnect maximum try reached "+we]),U(0,"maxReconnectOnClose reached"))):B("SSE failed. Downgrading to fallback transport and resending"))}}function x(e){pe.transport="websocket";var o=k(fe.url);if(s("debug")&&t.util.debug("Invoking executeWebSocket, using URL: "+o),e&&!fe.reconnect)return void(null!=ge&&f());ge=S(o),null!=fe.webSocketBinaryType&&(ge.binaryType=fe.webSocketBinaryType),fe.connectTimeout>0&&(fe.id=setTimeout(function(){if(e);else{var t={code:1002,reason:"",wasClean:!1};ge.onclose(t);try{f()}catch(n){}}},fe.connectTimeout)),ge.onopen=function(){c("websocket.onopen"),I(fe),n=!1,delete fe.closed,s("debug")&&t.util.debug("Websocket successfully opened");var o=e;null!=ge&&(ge.canSendMessage=!0),fe.enableProtocol||(e=!0,o?w("re-opening","websocket",fe):w("opening","websocket",fe)),null!=ge&&"POST"===fe.method&&(pe.state="messageReceived",ge.send(fe.data))},ge.onmessage=function(t){c("websocket.onmessage"),I(fe),fe.enableProtocol&&(e=!0),pe.state="messageReceived",pe.status=200,t=t.data;var n="string"==typeof t;if(n){var o=L(t,fe,pe);o||(ce(),pe.responseBody="",pe.messages=[])}else{if(t=A(fe,t),""===t)return;pe.responseBody=t,ce(),pe.responseBody=null}},ge.onerror=function(){c("websocket.onerror"),clearTimeout(fe.id),fe.heartbeatTimer&&clearTimeout(fe.heartbeatTimer)},ge.onclose=function(o){if(c("websocket.onclose"),clearTimeout(fe.id),"closed"!==pe.state){var r=o.reason;if(""===r)switch(o.code){case 1e3:r="Normal closure; the connection successfully completed whatever purpose for which it was created.";break;case 1001:r="The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection.";break;case 1002:r="The endpoint is terminating the connection due to a protocol error.";break;case 1003:r="The connection is being terminated because the endpoint received data of a type it cannot accept (for example, a text-only endpoint received binary data).";break;case 1004:r="The endpoint is terminating the connection because a data frame was received that is too large.";break;case 1005:r="Unknown: no status code was provided even though one was expected.";break;case 1006:r="Connection was closed abnormally (that is, with no close frame being sent)."}if(s("warn")&&t.util.warn("Websocket closed, reason: "+r+" - wasClean: "+o.wasClean),pe.closedByClientTimeout||fe.handleOnlineOffline&&n)return void(fe.reconnectId&&(clearTimeout(fe.reconnectId),delete fe.reconnectId));se(e),pe.state="closed",ke?t.util.log(fe.logLevel,["Websocket closed normally"]):e||"websocket"===fe.fallbackTransport?fe.reconnect&&"websocket"===pe.transport&&(f(),we++<fe.maxReconnectOnClose?(w("re-connecting",fe.transport,fe),fe.reconnectInterval>0?fe.reconnectId=setTimeout(function(){pe.responseBody="",pe.messages=[],x(!0)},fe.reconnectInterval):(pe.responseBody="",pe.messages=[],x(!0))):(t.util.log(fe.logLevel,["Websocket reconnect maximum try reached "+we]),s("warn")&&t.util.warn("Websocket error, reason: "+o.reason),U(0,"maxReconnectOnClose reached"))):B("Websocket failed on first connection attempt. Downgrading to "+fe.fallbackTransport+" and resending")}};var r=navigator.userAgent.toLowerCase(),a=r.indexOf("android")>-1;a&&void 0===ge.url&&ge.onclose({reason:"Android 4.1 does not support websockets.",wasClean:!1})}function A(e,n){var o=n;if("polling"===e.transport)return o;if(e.receivedUuidOnReopen=!1,e.enableProtocol&&(e.firstMessage||e.waitForUuid)&&0!==t.util.trim(n).length){var r=e.trackMessageLength?1:0,i=n.split(e.messageDelimiter);if(i.length<=r+1)return o;if(e.receivedUuidOnReopen=!!e.waitForUuid,e.firstMessage=!1,e.uuid=t.util.trim(i[r]),i.length<=r+2&&t.util.log("error",["Protocol data not sent by the server. If you enable protocol on client side, be sure to install JavascriptProtocol interceptor on server side.Also note that atmosphere-runtime 2.2+ should be used."]),Te=parseInt(t.util.trim(i[r+1]),10),Se=i[r+2],"long-polling"!==e.transport&&M(e),a=e.uuid,o="",r=e.trackMessageLength?4:3,i.length>r+1)for(var s=r;s<i.length;s++)o+=i[s],s+1!==i.length&&(o+=e.messageDelimiter);0!==e.ackInterval&&setTimeout(function(){z("...ACK...")},e.ackInterval)}else e.enableProtocol&&e.firstMessage&&t.util.browser.msie&&+t.util.browser.version.split(".")[0]<10?t.util.log(fe.logLevel,["Receiving unexpected data from IE"]):M(e);return o}function I(e){clearTimeout(e.id),e.timeout>0&&"polling"!==e.transport&&(e.id=setTimeout(function(){O(e),u(),f()},e.timeout))}function O(){pe.closedByClientTimeout=!0,pe.state="closedByClient",pe.responseBody="",pe.status=408,pe.messages=[],ce()}function U(e,t){f(),clearTimeout(fe.id),pe.state="error",pe.reasonPhrase=t,pe.responseBody="",pe.status=e,pe.messages=[],ce()}function L(e,t,n){if(e=A(t,e),0===e.length)return!0;if(n.responseBody=e,t.trackMessageLength){e=n.partialMessage+e;var o=[],r=e.indexOf(t.messageDelimiter);if(-1!=r){for(;-1!==r;){var a=e.substring(0,r),i=+a;if(isNaN(i))throw new Error('message length "'+a+'" is not a number');r+=t.messageDelimiter.length,r+i>e.length?r=-1:(o.push(e.substring(r,r+i)),e=e.substring(r+i,e.length),r=e.indexOf(t.messageDelimiter))}return n.partialMessage=e,0!==o.length?(n.responseBody=o.join(t.messageDelimiter),n.messages=o,!1):(n.responseBody="",n.messages=[],!0)}}return n.responseBody=e,n.messages=[e],!1}function B(e){t.util.log(fe.logLevel,[e]),"undefined"!=typeof fe.onTransportFailure?fe.onTransportFailure(e,fe):"undefined"!=typeof t.util.onTransportFailure&&t.util.onTransportFailure(e,fe),fe.transport=fe.fallbackTransport;var n=-1===fe.connectTimeout?0:fe.connectTimeout;fe.reconnect&&"none"!==fe.transport||null==fe.transport?(fe.method=fe.fallbackMethod,pe.transport=fe.fallbackTransport,fe.fallbackTransport="none",n>0?fe.reconnectId=setTimeout(function(){b()},n):b()):U(500,"Unable to reconnect with fallback transport")}function H(e,n){var o=fe;return null!=e&&"undefined"!=typeof e&&(o=e),null==n&&(n=o.url),o.attachHeadersAsQueryString?-1!==n.indexOf("X-Atmosphere-Framework")?n:(n+=-1!==n.indexOf("?")?"&":"?",t.util.isArray(o.attachHeadersAsQueryString)?(-1!==t.util.inArray("X-Atmosphere-tracking-id",o.attachHeadersAsQueryString)&&(n+="X-Atmosphere-tracking-id="+o.uuid),-1!==t.util.inArray("X-Atmosphere-Framework",o.attachHeadersAsQueryString)&&(n+="&X-Atmosphere-Framework="+version),-1!==t.util.inArray("X-Atmosphere-Transport",o.attachHeadersAsQueryString)&&(n+="&X-Atmosphere-Transport="+o.transport),-1!==t.util.inArray("X-Atmosphere-TrackMessageSize",o.attachHeadersAsQueryString)&&o.trackMessageLength&&(n+="&X-Atmosphere-TrackMessageSize=true"),-1!==t.util.inArray("X-Heartbeat-Server",o.attachHeadersAsQueryString)&&null!==o.heartbeat&&null!==o.heartbeat.server&&(n+="&X-Heartbeat-Server="+o.heartbeat.server),-1!==t.util.inArray("Content-Type",o.attachHeadersAsQueryString)&&""!==o.contentType&&(n+="&Content-Type="+("websocket"===o.transport?o.contentType:encodeURIComponent(o.contentType))),-1!==t.util.inArray("X-atmo-protocol",o.attachHeadersAsQueryString)&&o.enableProtocol&&(n+="&X-atmo-protocol=true"),t.util.each(o.headers,function(r,a){if(-1!==t.util.inArray(r,o.attachHeadersAsQueryString)){var i=t.util.isFunction(a)?a.call(this,o,e,pe):a;null!=i&&(n+="&"+encodeURIComponent(r)+"="+encodeURIComponent(i))}}),n):(n+="X-Atmosphere-tracking-id="+o.uuid,n+="&X-Atmosphere-Framework="+t.version,n+="&X-Atmosphere-Transport="+o.transport,o.trackMessageLength&&(n+="&X-Atmosphere-TrackMessageSize=true"),null!==o.heartbeat&&null!==o.heartbeat.server&&(n+="&X-Heartbeat-Server="+o.heartbeat.server),""!==o.contentType&&(n+="&Content-Type="+("websocket"===o.transport?o.contentType:encodeURIComponent(o.contentType))),o.enableProtocol&&(n+="&X-atmo-protocol=true"),t.util.each(o.headers,function(r,a){var i=t.util.isFunction(a)?a.call(this,o,e,pe):a;null!=i&&(n+="&"+encodeURIComponent(r)+"="+encodeURIComponent(i))}),n)):n}function M(e){if(e.isOpen)if(e.receivedUuidOnReopen)e.isReopen=!1,e.waitForUuid=!1,w("re-opening",e.transport,e);else{if(e.isReopen)return e.isReopen=!1,void(e.waitForUuid=!0);if("messageReceived"!==pe.state||"jsonp"!==e.transport&&"long-polling"!==e.transport)return void(e.waitForUuid=!1);F(pe)}else e.isOpen=!0,w("opening",e.transport,e);q(e)}function q(e){if(null!=e.heartbeatTimer&&clearTimeout(e.heartbeatTimer),!isNaN(Te)&&Te>0){var n=function(){s("debug")&&t.util.debug("Sending heartbeat"),z(Se),e.heartbeatTimer=setTimeout(n,Te)};e.heartbeatTimer=setTimeout(n,Te)}}function X(e){var n=fe;if((null!=e||"undefined"!=typeof e)&&(n=e),n.lastIndex=0,n.readyState=0,"jsonp"===n.transport||n.enableXDR&&t.util.checkCORSSupport())return void T(n);if(t.util.browser.msie&&+t.util.browser.version.split(".")[0]<10){if("streaming"===n.transport)return void(n.enableXDR&&window.XDomainRequest?j(n):W(n));if(n.enableXDR&&window.XDomainRequest)return void j(n)}var o=function(t){if(n.lastIndex=0,we++,t||n.reconnect&&we<=n.maxReconnectOnClose){var o=t?0:e.reconnectInterval;pe.ffTryingReconnect=!0,w("re-connecting",e.transport,e),P(i,n,o)}else U(0,"maxReconnectOnClose reached")},r=function(e){t._beforeUnloadState?(t.util.debug(new Date+" Atmosphere: reconnectF: execution delayed due to _beforeUnloadState flag"),setTimeout(function(){o(e)},5e3)):o(e)},a=function(){var e=!1,n=t.util.now(),o=fe.lastReconnect||fe.ctime;pe.errorHandled=!0,f(),n>=o+6e4&&(fe.lastReconnect=n,e=!!we,we=0),r(e)};if(n.force||n.reconnect&&(-1===n.maxRequest||n.requestCount++<n.maxRequest)){n.force=!1;var i=t.util.xhr();i.hasData=!1,E(i,n,!0),n.suspend&&(he=i),"polling"!==n.transport&&(pe.transport=n.transport,i.onabort=function(){c("ajaxrequest.onabort"),se(!0)},i.onerror=function(){c("ajaxrequest.onerror"),pe.error=!0,pe.ffTryingReconnect=!0;try{pe.status=XMLHttpRequest.status}catch(e){pe.status=500}pe.status||(pe.status=500),pe.errorHandled||(f(),r(!1))}),i.onreadystatechange=function(){if(c("ajaxRequest.onreadystatechange, new state: "+i.readyState),ke)return void c("onreadystatechange has been ignored due to _abortingConnection flag");pe.error=null;var o=!1,s=!1;if("streaming"===n.transport&&n.readyState>2&&4===i.readyState)return f(),void r(!1);if(n.readyState=i.readyState,"streaming"===n.transport&&i.readyState>=3?s=!0:"long-polling"===n.transport&&4===i.readyState&&(s=!0),I(fe),"polling"!==n.transport){var u=200;if(4===i.readyState&&(u=i.status>1e3?0:i.status),!n.reconnectOnServerError&&u>=300&&600>u)return void U(u,i.statusText);if(u>=300||0===u)return void a();n.enableProtocol&&e.firstMessage||2!==i.readyState||(t.util.browser.mozilla&&pe.ffTryingReconnect?(pe.ffTryingReconnect=!1,setTimeout(function(){pe.ffTryingReconnect||M(n)},500)):M(n))}else 4===i.readyState&&(s=!0);if(s){var d=i.responseText;if(pe.errorHandled=!1,"long-polling"===n.transport&&0===t.util.trim(d).length)return void(i.hasData?i.hasData=!1:r(!0));if(i.hasData=!0,re(i,fe),"streaming"===n.transport)if(t.util.browser.opera)t.util.iterate(function(){if(500!==pe.status&&i.responseText.length>n.lastIndex){try{pe.status=i.status,pe.headers=t.util.parseHeaders(i.getAllResponseHeaders()),re(i,fe)}catch(e){pe.status=404}I(fe),pe.state="messageReceived";var r=i.responseText.substring(n.lastIndex);if(n.lastIndex=i.responseText.length,o=L(r,n,pe),o||ce(),l(i,n))return void D(i,n)}else if(pe.status>400)return n.lastIndex=i.responseText.length,!1},0);else{var p=d.substring(n.lastIndex,d.length);if(o=L(p,n,pe),n.lastIndex=d.length,o)return}else o=L(d,n,pe);var g=l(i,n);try{pe.status=i.status,pe.headers=t.util.parseHeaders(i.getAllResponseHeaders()),re(i,n)}catch(m){pe.status=404}pe.state=n.suspend?0===pe.status?"closed":"messageReceived":"messagePublished";var h=!g&&"streaming"!==e.transport&&"polling"!==e.transport;h&&!n.executeCallbackBeforeReconnect&&P(i,n,n.pollingInterval),0===pe.responseBody.length||o||ce(),h&&n.executeCallbackBeforeReconnect&&P(i,n,n.pollingInterval),g&&D(i,n)}};try{i.send(n.data),ye=!0}catch(s){t.util.log(n.logLevel,["Unable to connect to "+n.url]),U(0,s)}}else"debug"===n.logLevel&&t.util.log(n.logLevel,["Max re-connection reached."]),U(0,"maxRequest reached")}function D(e,t){pe.messages=[],t.isReopen=!0,d(),ke=!1,P(e,t,500)}function E(e,n,o){var r=n.url;null!=n.dispatchUrl&&"POST"===n.method&&(r+=n.dispatchUrl),r=H(n,r),r=t.util.prepareURL(r),o&&(e.open(n.method,r,n.async),n.connectTimeout>0&&(n.id=setTimeout(function(){0===n.requestCount&&(f(),oe("Connect timeout","closed",200,n.transport))},n.connectTimeout))),fe.withCredentials&&"websocket"!==fe.transport&&"withCredentials"in e&&(e.withCredentials=!0),t.util.isArray(fe.dropHeaders)?(-1===t.util.inArray("X-Atmosphere-Framework",fe.dropHeaders)&&e.setRequestHeader("X-Atmosphere-Framework",version),-1===t.util.inArray("X-Atmosphere-Transport",fe.dropHeaders)&&e.setRequestHeader("X-Atmosphere-Transport",n.transport),-1===t.util.inArray("X-Heartbeat-Server",fe.dropHeaders)&&null!==n.heartbeat&&null!==n.heartbeat.server&&e.setRequestHeader("X-Heartbeat-Server",e.heartbeat.server),-1===t.util.inArray("X-Atmosphere-TrackMessageSize",fe.dropHeaders)&&n.trackMessageLength&&e.setRequestHeader("X-Atmosphere-TrackMessageSize","true"),-1===t.util.inArray("X-Atmosphere-tracking-id",fe.dropHeaders)&&e.setRequestHeader("X-Atmosphere-tracking-id",n.uuid),t.util.each(n.headers,function(r,a){if(-1===t.util.inArray(r,fe.dropHeaders)){var i=t.util.isFunction(a)?a.call(this,e,n,o,pe):a;null!=i&&e.setRequestHeader(r,i)}})):fe.dropHeaders?"websocket"===pe.transport&&"unsubscribe"===pe.state&&t.util.each(n.headers,function(r,a){var i=t.util.isFunction(a)?a.call(this,e,n,o,pe):a;null!=i&&e.setRequestHeader(r,i)}):(e.setRequestHeader("X-Atmosphere-Framework",t.version),e.setRequestHeader("X-Atmosphere-Transport",n.transport),null!==n.heartbeat&&null!==n.heartbeat.server&&e.setRequestHeader("X-Heartbeat-Server",e.heartbeat.server),n.trackMessageLength&&e.setRequestHeader("X-Atmosphere-TrackMessageSize","true"),e.setRequestHeader("X-Atmosphere-tracking-id",n.uuid),t.util.each(n.headers,function(r,a){var i=t.util.isFunction(a)?a.call(this,e,n,o,pe):a;null!=i&&e.setRequestHeader(r,i)})),""!==n.contentType&&e.setRequestHeader("Content-Type",n.contentType)}function P(e,t,n){if(!pe.closedByClientTimeout&&(t.reconnect||t.suspend&&ye)){var o=0;e&&e.readyState>1&&(o=e.status>1e3?0:e.status),pe.status=0===o?204:o,pe.reason=0===o?"Server resumed the connection or down.":"OK",clearTimeout(t.id),t.reconnectId&&(clearTimeout(t.reconnectId),delete t.reconnectId),n>0?fe.reconnectId=setTimeout(function(){X(t)},n):X(t)}}function N(e){e.state="re-connecting",ae(e)}function F(e){e.state="openAfterResume",ae(e),e.state="messageReceived"}function j(e){"polling"!==e.transport?(be=J(e),be.open()):J(e).open()}function J(e){var n=fe;null!=e&&"undefined"!=typeof e&&(n=e);var o=n.transport,r=0,a=new window.XDomainRequest,i=function(){"long-polling"===n.transport&&n.reconnect&&(-1===n.maxRequest||n.requestCount++<n.maxRequest)&&(a.status=200,j(n))},s=n.rewriteURL||function(e){var t=/(?:^|;\s*)(JSESSIONID|PHPSESSID)=([^;]*)/.exec(document.cookie);switch(t&&t[1]){case"JSESSIONID":return e.replace(/;jsessionid=[^\?]*|(\?)|$/,";jsessionid="+t[2]+"$1");case"PHPSESSID":return e.replace(/\?PHPSESSID=[^&]*&?|\?|$/,"?PHPSESSID="+t[2]+"&").replace(/&$/,"")}return e};a.onprogress=function(){c(a)},a.onerror=function(){"polling"!==n.transport&&(f(),we++<n.maxReconnectOnClose?n.reconnectInterval>0?n.reconnectId=setTimeout(function(){w("re-connecting",e.transport,e),j(n)},n.reconnectInterval):(w("re-connecting",e.transport,e),j(n)):U(0,"maxReconnectOnClose reached"))},a.onload=function(){};var c=function(e){clearTimeout(n.id);var a=e.responseText;if(a=a.substring(r),r+=a.length,"polling"!==o){I(n);var s=L(a,n,pe);if("long-polling"===o&&0===t.util.trim(a).length)return;n.executeCallbackBeforeReconnect&&i(),s||oe(pe.responseBody,"messageReceived",200,o),n.executeCallbackBeforeReconnect||i()}};return{open:function(){var e=n.url;null!=n.dispatchUrl&&(e+=n.dispatchUrl),e=H(n,e),a.open(n.method,s(e)),"GET"===n.method?a.send():a.send(n.data),n.connectTimeout>0&&(n.id=setTimeout(function(){0===n.requestCount&&(f(),oe("Connect timeout","closed",200,n.transport))},n.connectTimeout))},close:function(){a.abort()}}}function W(e){be=Q(e),be.open()}function Q(e){var n=fe;null!=e&&"undefined"!=typeof e&&(n=e);var o,r=new window.ActiveXObject("htmlfile");r.open(),r.close();var a=n.url;return null!=n.dispatchUrl&&(a+=n.dispatchUrl),"polling"!==n.transport&&(pe.transport=n.transport),{open:function(){var e=r.createElement("iframe");a=H(n),""!==n.data&&(a+="&X-Atmosphere-Post-Body="+encodeURIComponent(n.data)),a=t.util.prepareURL(a),e.src=a,r.body.appendChild(e);var i=e.contentDocument||e.contentWindow.document;o=t.util.iterate(function(){try{if(!i.firstChild)return;var e=i.body?i.body.lastChild:i;e.omgThisIsBroken;var a=function(){var t=e.cloneNode(!0);t.appendChild(i.createTextNode("."));var n=t.innerText;return n=n.substring(0,n.length-1)};if(!i.body||!i.body.firstChild||"pre"!==i.body.firstChild.nodeName.toLowerCase()){var s=i.head||i.getElementsByTagName("head")[0]||i.documentElement||i,c=i.createElement("script");c.text="document.write('<plaintext>')",s.insertBefore(c,s.firstChild),s.removeChild(c),e=i.body.lastChild}return n.closed&&(n.isReopen=!0),o=t.util.iterate(function(){var t=a();if(t.length>n.lastIndex){I(fe),pe.status=200,pe.error=null,e.innerText="";var o=L(t,n,pe);if(o)return"";oe(pe.responseBody,"messageReceived",200,n.transport)}return n.lastIndex=0,"complete"===i.readyState?(se(!0),w("re-connecting",n.transport,n),n.reconnectInterval>0?n.reconnectId=setTimeout(function(){W(n)},n.reconnectInterval):W(n),!1):void 0},null),!1}catch(l){return pe.error=!0,w("re-connecting",n.transport,n),we++<n.maxReconnectOnClose?n.reconnectInterval>0?n.reconnectId=setTimeout(function(){W(n)},n.reconnectInterval):W(n):U(0,"maxReconnectOnClose reached"),r.execCommand("Stop"),r.close(),!1}})},close:function(){o&&o(),r.execCommand("Stop"),se(!0)}}}function z(e){null!=Ce?$(e):null!=he||null!=me?K(e):null!=be?V(e):null!=ve?Y(e):null!=ge?te(e):(U(0,"No suspended connection available"),t.util.error("No suspended connection available. Make sure atmosphere.subscribe has been called and request.onOpen invoked before trying to push data"))}function _(e,t){t||(t=ee(e)),t.transport="polling",t.method="GET",t.withCredentials=!1,t.reconnect=!1,t.force=!0,t.suspend=!1,t.timeout=1e3,X(t)}function $(e){Ce.send(e)}function G(e){if(0!==e.length)try{Ce?Ce.localSend(e):le&&le.signal("localMessage",t.util.stringifyJSON({id:xe,event:e}))}catch(n){t.util.error(n)}}function K(e){var t=ee(e);X(t)}function V(e){if(fe.enableXDR&&t.util.checkCORSSupport()){var n=ee(e);n.reconnect=!1,T(n)}else K(e)}function Y(e){K(e)}function Z(e){var t=e;return"object"==typeof t&&(t=e.data),t}function ee(e){var n=Z(e),o={connected:!1,timeout:6e4,method:"POST",url:fe.url,contentType:fe.contentType,headers:fe.headers,reconnect:!0,callback:null,data:n,suspend:!1,maxRequest:-1,logLevel:"info",requestCount:0,withCredentials:fe.withCredentials,async:fe.async,transport:"polling",isOpen:!0,attachHeadersAsQueryString:!0,enableXDR:fe.enableXDR,uuid:fe.uuid,dispatchUrl:fe.dispatchUrl,enableProtocol:!1,messageDelimiter:"|",trackMessageLength:fe.trackMessageLength,maxReconnectOnClose:fe.maxReconnectOnClose,heartbeatTimer:fe.heartbeatTimer,heartbeat:fe.heartbeat};return"object"==typeof e&&(o=t.util.extend(o,e)),o}function te(e){var n,o=t.util.isBinary(e)?e:Z(e);try{if(n=null!=fe.dispatchUrl?fe.webSocketPathDelimiter+fe.dispatchUrl+fe.webSocketPathDelimiter+o:o,!ge.canSendMessage)return void t.util.error("WebSocket not connected.");ge.send(n)}catch(r){ge.onclose=function(){},f(),B("Websocket failed. Downgrading to "+fe.fallbackTransport+" and resending "+e),K(e)}}function ne(e){var n=t.util.parseJSON(e);n.id!==xe&&("undefined"!=typeof fe.onLocalMessage?fe.onLocalMessage(n.event):"undefined"!=typeof t.util.onLocalMessage&&t.util.onLocalMessage(n.event))}function oe(e,t,n,o){pe.responseBody=e,pe.transport=o,pe.status=n,pe.state=t,ce()}function re(e,t){if(t.readResponsesHeaders)try{var n=e.getResponseHeader("X-Atmosphere-tracking-id");n&&null!=n&&(t.uuid=n.split(" ").pop())}catch(o){}else t.enableProtocol||(t.uuid=xe)}function ae(e){ie(e,fe),ie(e,t.util)}function ie(e,t){switch(e.state){case"messageReceived":
c("Firing onMessage"),we=0,"undefined"!=typeof t.onMessage&&t.onMessage(e),"undefined"!=typeof t.onmessage&&t.onmessage(e);break;case"error":var n="undefined"!=typeof e.reasonPhrase?e.reasonPhrase:"n/a";c("Firing onError, reasonPhrase: "+n),"undefined"!=typeof t.onError&&t.onError(e),"undefined"!=typeof t.onerror&&t.onerror(e);break;case"opening":delete fe.closed,c("Firing onOpen"),"undefined"!=typeof t.onOpen&&t.onOpen(e),"undefined"!=typeof t.onopen&&t.onopen(e);break;case"messagePublished":c("Firing messagePublished"),"undefined"!=typeof t.onMessagePublished&&t.onMessagePublished(e);break;case"re-connecting":c("Firing onReconnect"),"undefined"!=typeof t.onReconnect&&t.onReconnect(fe,e);break;case"closedByClient":c("Firing closedByClient"),"undefined"!=typeof t.onClientTimeout&&t.onClientTimeout(fe);break;case"re-opening":delete fe.closed,c("Firing onReopen"),"undefined"!=typeof t.onReopen&&t.onReopen(fe,e);break;case"fail-to-reconnect":c("Firing onFailureToReconnect"),"undefined"!=typeof t.onFailureToReconnect&&t.onFailureToReconnect(fe,e);break;case"unsubscribe":case"closed":var o="undefined"!=typeof fe.closed?fe.closed:!1;o?c("Request already closed, not firing onClose ("+e.state+" case)"):(c("Firing onClose ("+e.state+" case)"),"undefined"!=typeof t.onClose&&t.onClose(e),"undefined"!=typeof t.onclose&&t.onclose(e)),fe.closed=!0;break;case"openAfterResume":"undefined"!=typeof t.onOpenAfterResume&&t.onOpenAfterResume(fe)}}function se(e){"closed"!==pe.state&&(pe.state="closed",pe.responseBody="",pe.messages=[],pe.status=e?200:501,ce())}function ce(){var e=function(e,t){t(pe)};null==Ce&&null!=Re&&Re(pe.responseBody),fe.reconnect=fe.mrequest;for(var n="string"==typeof pe.responseBody,o=n&&fe.trackMessageLength?pe.messages.length>0?pe.messages:[""]:new Array(pe.responseBody),a=0;a<o.length;a++)if(!(o.length>1&&0===o[a].length||(pe.responseBody=n?t.util.trim(o[a]):o[a],null==Ce&&null!=Re&&Re(pe.responseBody),(0===pe.responseBody.length||n&&Se===pe.responseBody)&&"messageReceived"===pe.state))){if(ae(pe),r.length>0){s("debug")&&t.util.debug("Invoking "+r.length+" global callbacks: "+pe.state);try{t.util.each(r,e)}catch(i){t.util.log(fe.logLevel,["Callback exception"+i])}}if("function"==typeof fe.callback){s("debug")&&t.util.debug("Invoking request callbacks");try{fe.callback(pe)}catch(i){t.util.log(fe.logLevel,["Callback exception"+i])}}}}var le,ue,de,fe={timeout:3e5,method:"GET",headers:{},contentType:"",callback:null,url:"",data:"",suspend:!0,maxRequest:-1,reconnect:!0,maxStreamingLength:1e7,lastIndex:0,logLevel:"info",requestCount:0,fallbackMethod:"GET",fallbackTransport:"streaming",transport:"long-polling",webSocketImpl:null,webSocketBinaryType:null,dispatchUrl:null,webSocketPathDelimiter:"@@",enableXDR:!1,rewriteURL:!1,attachHeadersAsQueryString:!0,executeCallbackBeforeReconnect:!1,readyState:0,withCredentials:!1,trackMessageLength:!1,messageDelimiter:"|",connectTimeout:-1,reconnectInterval:0,dropHeaders:!0,uuid:0,async:!0,shared:!1,readResponsesHeaders:!1,maxReconnectOnClose:5,enableProtocol:!0,disableDisconnect:!1,pollingInterval:0,heartbeat:{client:null,server:null},ackInterval:0,closeAsync:!1,reconnectOnServerError:!0,handleOnlineOffline:!0,onError:function(){},onClose:function(){},onOpen:function(){},onMessage:function(){},onReopen:function(){},onReconnect:function(){},onMessagePublished:function(){},onTransportFailure:function(){},onLocalMessage:function(){},onFailureToReconnect:function(){},onClientTimeout:function(){},onOpenAfterResume:function(){}},pe={status:200,reasonPhrase:"OK",responseBody:"",messages:[],headers:[],state:"messageReceived",transport:"polling",error:null,request:null,partialMessage:"",errorHandled:!1,closedByClientTimeout:!1,ffTryingReconnect:!1},ge=null,me=null,he=null,be=null,ve=null,ye=!0,we=0,Te=0,Se="X",ke=!1,Re=null,Ce=null,xe=t.util.now();g(e),this.subscribe=function(e){g(e),b()},this.execute=function(){b()},this.close=function(){d()},this.disconnect=function(){u()},this.getUrl=function(){return fe.url},this.push=function(e,t){if(null!=t){var n=fe.dispatchUrl;fe.dispatchUrl=t,z(e),fe.dispatchUrl=n}else z(e)},this.getUUID=function(){return fe.uuid},this.pushLocal=function(e){G(e)},this.enableProtocol=function(){return fe.enableProtocol},this.init=function(){o()},this.request=fe,this.response=pe}},t.subscribe=function(e,n,r){"function"==typeof n&&t.addCallback(n),"string"!=typeof e?r=e:r.url=e,a="undefined"!=typeof r&&"undefined"!=typeof r.uuid?r.uuid:0;var i=new t.AtmosphereRequest(r);return i.execute(),o[o.length]=i,i},t.unsubscribe=function(){if(o.length>0)for(var e=[].concat(o),t=0;t<e.length;t++){var n=e[t];n.close(),clearTimeout(n.response.request.id),n.heartbeatTimer&&clearTimeout(n.heartbeatTimer)}o=[],r=[]},t.unsubscribeUrl=function(e){var t=-1;if(o.length>0)for(var n=0;n<o.length;n++){var r=o[n];if(r.getUrl()===e){r.close(),clearTimeout(r.response.request.id),r.heartbeatTimer&&clearTimeout(r.heartbeatTimer),t=n;break}}t>=0&&o.splice(t,1)},t.addCallback=function(e){-1===t.util.inArray(e,r)&&r.push(e)},t.removeCallback=function(e){var n=t.util.inArray(e,r);-1!==n&&r.splice(n,1)},t.util={browser:{},parseHeaders:function(e){for(var t,n=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,o={};t=n.exec(e);)o[t[1]]=t[2];return o},now:function(){return(new Date).getTime()},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},inArray:function(e,t){if(!Array.prototype.indexOf){for(var n=t.length,o=0;n>o;++o)if(t[o]===e)return o;return-1}return t.indexOf(e)},isBinary:function(e){return/^\[object\s(?:Blob|ArrayBuffer|.+Array)\]$/.test(Object.prototype.toString.call(e))},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)},getAbsoluteURL:function(e){if("undefined"==typeof document.createElement)return e;var t=document.createElement("div");return t.innerHTML='<a href="'+e+'"/>',encodeURI(decodeURI(t.firstChild.href))},prepareURL:function(e){var n=t.util.now(),o=e.replace(/([?&])_=[^&]*/,"$1_="+n);return o+(o===e?(/\?/.test(e)?"&":"?")+"_="+n:"")},trim:function(e){return String.prototype.trim?e.toString().trim():e.toString().replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")},param:function(e){function n(e,n){n=t.util.isFunction(n)?n():null==n?"":n,a.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}function o(e,r){var a;if(t.util.isArray(r))t.util.each(r,function(t,r){/\[\]$/.test(e)?n(e,r):o(e+"["+("object"==typeof r?t:"")+"]",r)});else if("[object Object]"===Object.prototype.toString.call(r))for(a in r)o(e+"["+a+"]",r[a]);else n(e,r)}var r,a=[];for(r in e)o(r,e[r]);return a.join("&").replace(/%20/g,"+")},storage:function(){try{return!(!window.localStorage||!window.StorageEvent)}catch(e){return!1}},iterate:function(e,t){var n;return t=t||0,function o(){n=setTimeout(function(){e()!==!1&&o()},t)}(),function(){clearTimeout(n)}},each:function(e,n,o){if(e){var r,a=0,i=e.length,s=t.util.isArray(e);if(o){if(s)for(;i>a&&(r=n.apply(e[a],o),r!==!1);a++);else for(a in e)if(r=n.apply(e[a],o),r===!1)break}else if(s)for(;i>a&&(r=n.call(e[a],a,e[a]),r!==!1);a++);else for(a in e)if(r=n.call(e[a],a,e[a]),r===!1)break;return e}},extend:function(e){var t,n,o;for(t=1;t<arguments.length;t++)if(null!=(n=arguments[t]))for(o in n)e[o]=n[o];return e},on:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},off:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)},log:function(e,t){if(window.console){var n=window.console[e];"function"==typeof n&&n.apply(window.console,t)}},warn:function(){t.util.log("warn",arguments)},info:function(){t.util.log("info",arguments)},debug:function(){t.util.log("debug",arguments)},error:function(){t.util.log("error",arguments)},xhr:function(){try{return new window.XMLHttpRequest}catch(e){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}},parseJSON:function(e){return e?window.JSON&&window.JSON.parse?window.JSON.parse(e):new Function("return "+e)():null},stringifyJSON:function(e){function t(e){return'"'+e.replace(o,function(e){var t=r[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"'}function n(e){return 10>e?"0"+e:e}var o=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,r={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return window.JSON&&window.JSON.stringify?window.JSON.stringify(e):function a(e,o){var r,s,c,l,u=o[e],d=typeof u;switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(e),d=typeof u),d){case"string":return t(u);case"number":return isFinite(u)?String(u):"null";case"boolean":return String(u);case"object":if(!u)return"null";switch(Object.prototype.toString.call(u)){case"[object Date]":return isFinite(u.valueOf())?'"'+u.getUTCFullYear()+"-"+n(u.getUTCMonth()+1)+"-"+n(u.getUTCDate())+"T"+n(u.getUTCHours())+":"+n(u.getUTCMinutes())+":"+n(u.getUTCSeconds())+'Z"':"null";case"[object Array]":for(c=u.length,l=[],r=0;c>r;r++)l.push(a(r,u)||"null");return"["+l.join(",")+"]";default:l=[];for(r in u)i.call(u,r)&&(s=a(r,u),s&&l.push(t(r)+":"+s));return"{"+l.join(",")+"}"}}}("",{"":e})},checkCORSSupport:function(){if(t.util.browser.msie&&!window.XDomainRequest&&+t.util.browser.version.split(".")[0]<11)return!0;if(t.util.browser.opera&&+t.util.browser.version.split(".")<12)return!0;if("KreaTVWebKit/531"===t.util.trim(navigator.userAgent).slice(0,16))return!0;if("kreatel"===t.util.trim(navigator.userAgent).slice(-7).toLowerCase())return!0;var e=navigator.userAgent.toLowerCase(),n=e.match(/.+android ([0-9]{1,2})/i),o=parseInt(n&&n[0]||-1,10);return!isNaN(o)&&o>-1&&3>o?!0:!1}},e=t.util.now(),function(){var e=navigator.userAgent.toLowerCase(),n=/(chrome)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||/(trident)(?:.*? rv:([\w.]+)|)/.exec(e)||e.indexOf("android")<0&&/version\/(.+) (safari)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];"safari"===n[2]&&(n[2]=n[1],n[1]="safari"),t.util.browser[n[1]||""]=!0,t.util.browser.version=n[2]||"0",t.util.browser.vmajor=t.util.browser.version.split(".")[0],t.util.browser.trident&&(t.util.browser.msie=!0),(t.util.browser.msie||t.util.browser.mozilla&&1===+t.util.browser.version.split(".")[0])&&(t.util.storage=!1)}(),t.util.on(window,"unload",function(){t.util.debug(new Date+" Atmosphere: unload event"),t.unsubscribe()}),t.util.on(window,"beforeunload",function(){t.util.debug(new Date+" Atmosphere: beforeunload event"),"function"==typeof t.onBeforeUnload&&t.onBeforeUnload(),t._beforeUnloadState=!0,setTimeout(function(){t.util.debug(new Date+" Atmosphere: beforeunload event timeout reached. Reset _beforeUnloadState flag"),t._beforeUnloadState=!1},5e3)}),t.util.on(window,"keypress",function(e){(27===e.charCode||27===e.keyCode)&&e.preventDefault&&e.preventDefault()}),t.util.on(window,"offline",function(){if(t.util.debug(new Date+" Atmosphere: offline event"),n=!0,o.length>0)for(var e=[].concat(o),r=0;r<e.length;r++){var a=e[r];a.request.handleOnlineOffline&&(a.close(),clearTimeout(a.response.request.id),a.heartbeatTimer&&clearTimeout(a.heartbeatTimer))}}),t.util.on(window,"online",function(){if(t.util.debug(new Date+" Atmosphere: online event"),o.length>0)for(var e=0;e<o.length;e++)o[e].request.handleOnlineOffline&&(o[e].init(),o[e].execute());n=!1}),t});
(function(){function n(n,t){return n.push.apply(n,t),n}function t(n,t,r,e){for(var u=n.length,o=r+(e?1:-1);e?o--:++o<u;)if(t(n[o],o,n))return o;return-1}function r(n){return function(t){return null==t?nt:t[n]}}function e(n){return function(t){return null==n?nt:n[t]}}function u(n,t,r,e,u){return u(n,function(n,u,o){r=e?(e=!1,n):t(r,n,u,o)}),r}function o(n,t){return E(t,function(t){return n[t]})}function i(n,t){return function(r){return n(t(r))}}function c(n){return n instanceof f?n:new f(n)}function f(n,t){
this.__wrapped__=n,this.__actions__=[],this.__chain__=!!t}function a(n,t,r){var e=n[t];Rt.call(n,t)&&wn(e,r)&&(r!==nt||t in n)||l(n,t,r)}function l(n,t,r){n[t]=r}function p(n,t,r){if("function"!=typeof n)throw new TypeError(rt);return setTimeout(function(){n.apply(nt,r)},t)}function s(n,t){var r=!0;return Ut(n,function(n,e,u){return r=!!t(n,e,u)}),r}function h(n,t,r){for(var e=-1,u=n.length;++e<u;){var o=n[e],i=t(o);if(null!=i&&(c===nt?i===i&&!0:r(i,c)))var c=i,f=o}return f}function v(n,t){var r=[];
return Ut(n,function(n,e,u){t(n,e,u)&&r.push(n)}),r}function y(t,r,e,u,o){var i=-1,c=t.length;for(e||(e=H),o||(o=[]);++i<c;){var f=t[i];r>0&&e(f)?r>1?y(f,r-1,e,u,o):n(o,f):u||(o[o.length]=f)}return o}function g(n,t){return n&&Vt(n,t,cr)}function _(n,t){return v(t,function(t){return Tn(n[t])})}function b(n){return W(n)}function j(n,t){return n>t}function d(n){return In(n)&&b(n)==ht}function m(n,t,r,e,u){return n===t||(null==n||null==t||!In(n)&&!In(t)?n!==n&&t!==t:O(n,t,r,e,m,u))}function O(n,t,r,e,u,o){
var i=Zt(n),c=Zt(t),f=i?lt:b(n),a=c?lt:b(t);f=f==at?bt:f,a=a==at?bt:a;var l=f==bt,p=a==bt,s=f==a;o||(o=[]);var h=Lt(o,function(t){return t[0]==n}),v=Lt(o,function(n){return n[0]==t});if(h&&v)return h[1]==t;if(o.push([n,t]),o.push([t,n]),s&&!l){var y=i?J(n,t,r,e,u,o):M(n,t,f,r,e,u,o);return o.pop(),y}if(!(r&et)){var g=l&&Rt.call(n,"__wrapped__"),_=p&&Rt.call(t,"__wrapped__");if(g||_){var j=g?n.value():n,d=_?t.value():t,y=u(j,d,r,e,o);return o.pop(),y}}if(!s)return!1;var y=U(n,t,r,e,u,o);return o.pop(),
y}function x(n){return In(n)&&b(n)==dt}function w(n){return"function"==typeof n?n:null==n?Hn:("object"==typeof n?N:r)(n)}function A(n,t){return n<t}function E(n,t){var r=-1,e=An(n)?Array(n.length):[];return Ut(n,function(n,u,o){e[++r]=t(n,u,o)}),e}function N(n){var t=Gt(n);return function(r){var e=t.length;if(null==r)return!e;for(r=Object(r);e--;){var u=t[e];if(!(u in r&&m(n[u],r[u],et|ut)))return!1}return!0}}function k(n,t){return n=Object(n),gn(t,function(t,r){return r in n&&(t[r]=n[r]),t},{})}
function F(n,t){return Kt(X(n,t,Hn),n+"")}function T(n,t,r){var e=-1,u=n.length;t<0&&(t=-t>u?0:u+t),r=r>u?u:r,r<0&&(r+=u),u=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(u);++e<u;)o[e]=n[e+t];return o}function S(n){return T(n,0,n.length)}function B(n,t){var r;return Ut(n,function(n,e,u){return r=t(n,e,u),!r}),!!r}function I(t,r){var e=t;return gn(r,function(t,r){return r.func.apply(r.thisArg,n([t],r.args))},e)}function R(n,t){if(n!==t){var r=n!==nt,e=null===n,u=n===n,o=!1,i=t!==nt,c=null===t,f=t===t,a=!1;if(!c&&!a&&!o&&n>t||o&&i&&f&&!c&&!a||e&&i&&f||!r&&f||!u)return 1;
if(!e&&!o&&!a&&n<t||a&&r&&u&&!e&&!o||c&&r&&u||!i&&u||!f)return-1}return 0}function $(n,t,r,e){var u=!r;r||(r={});for(var o=-1,i=t.length;++o<i;){var c=t[o],f=e?e(r[c],n[c],c,r,n):nt;f===nt&&(f=n[c]),u?l(r,c,f):a(r,c,f)}return r}function q(n){return F(function(t,r){var e=-1,u=r.length,o=u>1?r[u-1]:nt;for(o=n.length>3&&"function"==typeof o?(u--,o):nt,t=Object(t);++e<u;){var i=r[e];i&&n(t,i,e,o)}return t})}function D(n,t){return function(r,e){if(null==r)return r;if(!An(r))return n(r,e);for(var u=r.length,o=t?u:-1,i=Object(r);(t?o--:++o<u)&&e(i[o],o,i)!==!1;);
return r}}function P(n){return function(t,r,e){for(var u=-1,o=Object(t),i=e(t),c=i.length;c--;){var f=i[n?c:++u];if(r(o[f],f,o)===!1)break}return t}}function z(n){return function(){var t=arguments,r=Mt(n.prototype),e=n.apply(r,t);return Bn(e)?e:r}}function C(n){return function(t,r,e){var u=Object(t);if(!An(t)){var o=w(r,3);t=cr(t),r=function(n){return o(u[n],n,u)}}var i=n(t,r,e);return i>-1?u[o?t[i]:i]:nt}}function G(n,t,r,e){function u(){for(var t=-1,c=arguments.length,f=-1,a=e.length,l=Array(a+c),p=this&&this!==kt&&this instanceof u?i:n;++f<a;)l[f]=e[f];
for(;c--;)l[f++]=arguments[++t];return p.apply(o?r:this,l)}if("function"!=typeof n)throw new TypeError(rt);var o=t&ot,i=z(n);return u}function J(n,t,r,e,u,o){var i=r&et,c=n.length,f=t.length;if(c!=f&&!(i&&f>c))return!1;for(var a=-1,l=!0,p=r&ut?[]:nt;++a<c;){var s,h=n[a],v=t[a];if(s!==nt){if(s)continue;l=!1;break}if(p){if(!B(t,function(n,t){if(!un(p,t)&&(h===n||u(h,n,r,e,o)))return p.push(t)})){l=!1;break}}else if(h!==v&&!u(h,v,r,e,o)){l=!1;break}}return l}function M(n,t,r,e,u,o,i){switch(r){case st:
case ht:case _t:return wn(+n,+t);case vt:return n.name==t.name&&n.message==t.message;case dt:case mt:return n==t+""}return!1}function U(n,t,r,e,u,o){var i=r&et,c=cr(n),f=c.length;if(f!=cr(t).length&&!i)return!1;for(var a=f;a--;){var l=c[a];if(!(i?l in t:Rt.call(t,l)))return!1}for(var p=!0,s=i;++a<f;){l=c[a];var h,v=n[l],y=t[l];if(!(h===nt?v===y||u(v,y,r,e,o):h)){p=!1;break}s||(s="constructor"==l)}if(p&&!s){var g=n.constructor,_=t.constructor;g!=_&&"constructor"in n&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof _&&_ instanceof _)&&(p=!1);
}return p}function V(n){return Kt(X(n,nt,tn),n+"")}function H(n){return Zt(n)||Yt(n)}function K(n,t){var r=typeof n;return t=null==t?ft:t,!!t&&("number"==r||"symbol"!=r&&wt.test(n))&&n>-1&&n%1==0&&n<t}function L(n,t,r){if(!Bn(r))return!1;var e=typeof t;return!!("number"==e?An(r)&&K(t,r.length):"string"==e&&t in r)&&wn(r[t],n)}function Q(n){var t=[];if(null!=n)for(var r in Object(n))t.push(r);return t}function W(n){return qt.call(n)}function X(n,t,r){return t=Jt(t===nt?n.length-1:t,0),function(){for(var e=arguments,u=-1,o=Jt(e.length-t,0),i=Array(o);++u<o;)i[u]=e[t+u];
u=-1;for(var c=Array(t+1);++u<t;)c[u]=e[u];return c[t]=r(i),n.apply(this,c)}}function Y(n){return v(n,Boolean)}function Z(){var t=arguments.length;if(!t)return[];for(var r=Array(t-1),e=arguments[0],u=t;u--;)r[u-1]=arguments[u];return n(Zt(e)?S(e):[e],y(r,1))}function nn(n,r,e){var u=null==n?0:n.length;if(!u)return-1;var o=null==e?0:rr(e);return o<0&&(o=Jt(u+o,0)),t(n,w(r,3),o)}function tn(n){return(null==n?0:n.length)?y(n,1):[]}function rn(n){return(null==n?0:n.length)?y(n,ct):[]}function en(n){return n&&n.length?n[0]:nt;
}function un(n,t,r){var e=null==n?0:n.length;r="number"==typeof r?r<0?Jt(e+r,0):r:0;for(var u=(r||0)-1,o=t===t;++u<e;){var i=n[u];if(o?i===t:i!==i)return u}return-1}function on(n){var t=null==n?0:n.length;return t?n[t-1]:nt}function cn(n,t,r){var e=null==n?0:n.length;return t=null==t?0:+t,r=r===nt?e:+r,e?T(n,t,r):[]}function fn(n){var t=c(n);return t.__chain__=!0,t}function an(n,t){return t(n),n}function ln(n,t){return t(n)}function pn(){return I(this.__wrapped__,this.__actions__)}function sn(n,t,r){
return t=r?nt:t,s(n,w(t))}function hn(n,t){return v(n,w(t))}function vn(n,t){return Ut(n,w(t))}function yn(n,t){return E(n,w(t))}function gn(n,t,r){return u(n,w(t),r,arguments.length<3,Ut)}function _n(n){return null==n?0:(n=An(n)?n:Gt(n),n.length)}function bn(n,t,r){return t=r?nt:t,B(n,w(t))}function jn(n,t){var e=0;return t=w(t),E(E(n,function(n,r,u){return{value:n,index:e++,criteria:t(n,r,u)}}).sort(function(n,t){return R(n.criteria,t.criteria)||n.index-t.index}),r("value"))}function dn(n,t){var r;
if("function"!=typeof t)throw new TypeError(rt);return n=rr(n),function(){return--n>0&&(r=t.apply(this,arguments)),n<=1&&(t=nt),r}}function mn(n){if("function"!=typeof n)throw new TypeError(rt);return function(){return!n.apply(this,arguments)}}function On(n){return dn(2,n)}function xn(n){return Bn(n)?Zt(n)?S(n):$(n,Gt(n)):n}function wn(n,t){return n===t||n!==n&&t!==t}function An(n){return null!=n&&Sn(n.length)&&!Tn(n)}function En(n){return n===!0||n===!1||In(n)&&b(n)==st}function Nn(n){return An(n)&&(Zt(n)||Dn(n)||Tn(n.splice)||Yt(n))?!n.length:!Gt(n).length;
}function kn(n,t){return m(n,t)}function Fn(n){return"number"==typeof n&&Ct(n)}function Tn(n){if(!Bn(n))return!1;var t=b(n);return t==yt||t==gt||t==pt||t==jt}function Sn(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=ft}function Bn(n){var t=typeof n;return null!=n&&("object"==t||"function"==t)}function In(n){return null!=n&&"object"==typeof n}function Rn(n){return qn(n)&&n!=+n}function $n(n){return null===n}function qn(n){return"number"==typeof n||In(n)&&b(n)==_t}function Dn(n){return"string"==typeof n||!Zt(n)&&In(n)&&b(n)==mt;
}function Pn(n){return n===nt}function zn(n){return An(n)?n.length?S(n):[]:Un(n)}function Cn(n){return"string"==typeof n?n:null==n?"":n+""}function Gn(n,t){var r=Mt(n);return null==t?r:ur(r,t)}function Jn(n,t){return null!=n&&Rt.call(n,t)}function Mn(n,t,r){var e=null==n?nt:n[t];return e===nt&&(e=r),Tn(e)?e.call(n):e}function Un(n){return null==n?[]:o(n,cr(n))}function Vn(n){return n=Cn(n),n&&xt.test(n)?n.replace(Ot,St):n}function Hn(n){return n}function Kn(n){return N(ur({},n))}function Ln(t,r,e){
var u=cr(r),o=_(r,u);null!=e||Bn(r)&&(o.length||!u.length)||(e=r,r=t,t=this,o=_(r,cr(r)));var i=!(Bn(e)&&"chain"in e&&!e.chain),c=Tn(t);return Ut(o,function(e){var u=r[e];t[e]=u,c&&(t.prototype[e]=function(){var r=this.__chain__;if(i||r){var e=t(this.__wrapped__);return(e.__actions__=S(this.__actions__)).push({func:u,args:arguments,thisArg:t}),e.__chain__=r,e}return u.apply(t,n([this.value()],arguments))})}),t}function Qn(){return kt._===this&&(kt._=Dt),this}function Wn(){}function Xn(n){var t=++$t;
return Cn(n)+t}function Yn(n){return n&&n.length?h(n,Hn,j):nt}function Zn(n){return n&&n.length?h(n,Hn,A):nt}var nt,tt="4.17.5",rt="Expected a function",et=1,ut=2,ot=1,it=32,ct=1/0,ft=9007199254740991,at="[object Arguments]",lt="[object Array]",pt="[object AsyncFunction]",st="[object Boolean]",ht="[object Date]",vt="[object Error]",yt="[object Function]",gt="[object GeneratorFunction]",_t="[object Number]",bt="[object Object]",jt="[object Proxy]",dt="[object RegExp]",mt="[object String]",Ot=/[&<>"']/g,xt=RegExp(Ot.source),wt=/^(?:0|[1-9]\d*)$/,At={
"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Et="object"==typeof global&&global&&global.Object===Object&&global,Nt="object"==typeof self&&self&&self.Object===Object&&self,kt=Et||Nt||Function("return this")(),Ft="object"==typeof exports&&exports&&!exports.nodeType&&exports,Tt=Ft&&"object"==typeof module&&module&&!module.nodeType&&module,St=e(At),Bt=Array.prototype,It=Object.prototype,Rt=It.hasOwnProperty,$t=0,qt=It.toString,Dt=kt._,Pt=Object.create,zt=It.propertyIsEnumerable,Ct=kt.isFinite,Gt=i(Object.keys,Object),Jt=Math.max,Mt=function(){
function n(){}return function(t){if(!Bn(t))return{};if(Pt)return Pt(t);n.prototype=t;var r=new n;return n.prototype=nt,r}}();f.prototype=Mt(c.prototype),f.prototype.constructor=f;var Ut=D(g),Vt=P(),Ht=Wn,Kt=Hn,Lt=C(nn),Qt=F(function(n,t,r){return G(n,ot|it,t,r)}),Wt=F(function(n,t){return p(n,1,t)}),Xt=F(function(n,t,r){return p(n,er(t)||0,r)}),Yt=Ht(function(){return arguments}())?Ht:function(n){return In(n)&&Rt.call(n,"callee")&&!zt.call(n,"callee")},Zt=Array.isArray,nr=d,tr=x,rr=Number,er=Number,ur=q(function(n,t){
$(t,Gt(t),n)}),or=q(function(n,t){$(t,Q(t),n)}),ir=F(function(n,t){n=Object(n);var r=-1,e=t.length,u=e>2?t[2]:nt;for(u&&L(t[0],t[1],u)&&(e=1);++r<e;)for(var o=t[r],i=fr(o),c=-1,f=i.length;++c<f;){var a=i[c],l=n[a];(l===nt||wn(l,It[a])&&!Rt.call(n,a))&&(n[a]=o[a])}return n}),cr=Gt,fr=Q,ar=V(function(n,t){return null==n?{}:k(n,t)}),lr=w;c.assignIn=or,c.before=dn,c.bind=Qt,c.chain=fn,c.compact=Y,c.concat=Z,c.create=Gn,c.defaults=ir,c.defer=Wt,c.delay=Xt,c.filter=hn,c.flatten=tn,c.flattenDeep=rn,c.iteratee=lr,
c.keys=cr,c.map=yn,c.matches=Kn,c.mixin=Ln,c.negate=mn,c.once=On,c.pick=ar,c.slice=cn,c.sortBy=jn,c.tap=an,c.thru=ln,c.toArray=zn,c.values=Un,c.extend=or,Ln(c,c),c.clone=xn,c.escape=Vn,c.every=sn,c.find=Lt,c.forEach=vn,c.has=Jn,c.head=en,c.identity=Hn,c.indexOf=un,c.isArguments=Yt,c.isArray=Zt,c.isBoolean=En,c.isDate=nr,c.isEmpty=Nn,c.isEqual=kn,c.isFinite=Fn,c.isFunction=Tn,c.isNaN=Rn,c.isNull=$n,c.isNumber=qn,c.isObject=Bn,c.isRegExp=tr,c.isString=Dn,c.isUndefined=Pn,c.last=on,c.max=Yn,c.min=Zn,
c.noConflict=Qn,c.noop=Wn,c.reduce=gn,c.result=Mn,c.size=_n,c.some=bn,c.uniqueId=Xn,c.each=vn,c.first=en,Ln(c,function(){var n={};return g(c,function(t,r){Rt.call(c.prototype,r)||(n[r]=t)}),n}(),{chain:!1}),c.VERSION=tt,Ut(["pop","join","replace","reverse","split","push","shift","sort","splice","unshift"],function(n){var t=(/^(?:replace|split)$/.test(n)?String.prototype:Bt)[n],r=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",e=/^(?:pop|join|replace|shift)$/.test(n);c.prototype[n]=function(){var n=arguments;
if(e&&!this.__chain__){var u=this.value();return t.apply(Zt(u)?u:[],n)}return this[r](function(r){return t.apply(Zt(r)?r:[],n)})}}),c.prototype.toJSON=c.prototype.valueOf=c.prototype.value=pn,"function"==typeof define&&"object"==typeof define.amd&&define.amd?(kt._=c,define(function(){return c})):Tt?((Tt.exports=c)._=c,Ft._=c):kt._=c}).call(this);
//# sourceMappingURL=lodash.core.min.map
!function(e,i){void 0===e&&void 0!==window&&(e=window),"function"==typeof define&&define.amd?define(["lodash"],function(n){return e._=i(n)}):"object"==typeof module&&module.exports?module.exports=i(require("lodash")):e._=i(e._)}(this,function(d){var s=Object.prototype.toString;return d.mixin({updateByDeep:function c(a,u){return d.forEach(u,function(n,e){var i,r,t,o,f;d.has(a,e)&&(t=a,o=e,(f=Object.getOwnPropertyDescriptor(t,o)).writable||d.isUndefined(f.writable))&&("Object"===(i=u[e],r=s.call(i),/object\s(\w+)/.exec(r)[1])?c(a[e],u[e]):a[e]=u[e])}),a}}),d.mixin({assignSafe:function(i,r){return d.forEach(r,function(n,e){d.has(i,e)&&!d.isUndefined(n)&&(i[e]=r[e])}),i}}),d.mixin({mergeArrayWith:function(i,r,t){if(d.isArray(i)&&d.isArray(r)&&t){var o={};return d.forEach(i,function(n,e){o[t]=n[t],d.find(r,o)||i.splice(e,1)}),d.forEach(r,function(n){o[t]=n[t];var e=d.find(i,o);e?d.assignIn(e,n):i.push(n)}),i}}}),d});
/*!
 * @overview RSVP - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/tildeio/rsvp.js/master/LICENSE
 * @version   3.2.1
 */

(function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function n(t){return"function"==typeof t}function r(t){return"object"==typeof t&&null!==t}function e(){}function o(t,n){for(var r=0,e=t.length;e>r;r++)if(t[r]===n)return r;return-1}function i(t){var n=t._promiseCallbacks;return n||(n=t._promiseCallbacks={}),n}function u(t,n){return"onerror"===t?void jt.on("error",n):2!==arguments.length?jt[t]:void(jt[t]=n)}function s(){setTimeout(function(){for(var t,n=0;n<Tt.length;n++){t=Tt[n];var r=t.payload;r.guid=r.key+r.id,r.childGuid=r.key+r.childId,r.error&&(r.stack=r.error.stack),jt.trigger(t.name,t.payload)}Tt.length=0},50)}function a(t,n,r){1===Tt.push({name:t,payload:{key:n._guidKey,id:n._id,eventName:t,detail:n._result,childId:r&&r._id,label:n._label,timeStamp:bt(),error:jt["instrument-with-stack"]?new Error(n._label):null}})&&s()}function c(t,n,r){var e=this,o=e._state;if(o===Dt&&!t||o===Kt&&!n)return jt.instrument&&St("chained",e,e),e;e._onError=null;var i=new e.constructor(g,r),u=e._result;if(jt.instrument&&St("chained",e,i),o){var s=arguments[o-1];jt.async(function(){x(o,i,s,u)})}else R(e,i,t,n);return i}function f(t,n){var r=this;if(t&&"object"==typeof t&&t.constructor===r)return t;var e=new r(g,n);return S(e,t),e}function l(t,n,r){return t===Dt?{state:"fulfilled",value:r}:{state:"rejected",reason:r}}function h(t,n,r,e){this._instanceConstructor=t,this.promise=new t(g,e),this._abortOnReject=r,this._validateInput(n)?(this._input=n,this.length=n.length,this._remaining=n.length,this._init(),0===this.length?C(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&C(this.promise,this._result))):O(this.promise,this._validationError())}function p(t,n){return new Ot(this,t,!0,n).promise}function _(t,n){function r(t){S(i,t)}function e(t){O(i,t)}var o=this,i=new o(g,n);if(!gt(t))return O(i,new TypeError("You must pass an array to race.")),i;for(var u=t.length,s=0;i._state===Yt&&u>s;s++)R(o.resolve(t[s]),void 0,r,e);return i}function v(t,n){var r=this,e=new r(g,n);return O(e,t),e}function y(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function d(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function m(t,n){this._id=xt++,this._label=n,this._state=void 0,this._result=void 0,this._subscribers=[],jt.instrument&&St("created",this),g!==t&&("function"!=typeof t&&y(),this instanceof m?N(this,t):d())}function w(){return new TypeError("A promises callback cannot return that same promise.")}function g(){}function b(t){try{return t.then}catch(n){return Ut.error=n,Ut}}function E(t,n,r,e){try{t.call(n,r,e)}catch(o){return o}}function A(t,n,r){jt.async(function(t){var e=!1,o=E(r,n,function(r){e||(e=!0,n!==r?S(t,r,void 0):C(t,r))},function(n){e||(e=!0,O(t,n))},"Settle: "+(t._label||" unknown promise"));!e&&o&&(e=!0,O(t,o))},t)}function j(t,n){n._state===Dt?C(t,n._result):n._state===Kt?(n._onError=null,O(t,n._result)):R(n,void 0,function(r){n!==r?S(t,r,void 0):C(t,r)},function(n){O(t,n)})}function T(t,r,e){r.constructor===t.constructor&&e===kt&&constructor.resolve===Ct?j(t,r):e===Ut?O(t,Ut.error):void 0===e?C(t,r):n(e)?A(t,r,e):C(t,r)}function S(n,r){n===r?C(n,r):t(r)?T(n,r,b(r)):C(n,r)}function k(t){t._onError&&t._onError(t._result),I(t)}function C(t,n){t._state===Yt&&(t._result=n,t._state=Dt,0===t._subscribers.length?jt.instrument&&St("fulfilled",t):jt.async(I,t))}function O(t,n){t._state===Yt&&(t._state=Kt,t._result=n,jt.async(k,t))}function R(t,n,r,e){var o=t._subscribers,i=o.length;t._onError=null,o[i]=n,o[i+Dt]=r,o[i+Kt]=e,0===i&&t._state&&jt.async(I,t)}function I(t){var n=t._subscribers,r=t._state;if(jt.instrument&&St(r===Dt?"fulfilled":"rejected",t),0!==n.length){for(var e,o,i=t._result,u=0;u<n.length;u+=3)e=n[u],o=n[u+r],e?x(r,e,o,i):o(i);t._subscribers.length=0}}function M(){this.error=null}function P(t,n){try{return t(n)}catch(r){return qt.error=r,qt}}function x(t,r,e,o){var i,u,s,a,c=n(e);if(c){if(i=P(e,o),i===qt?(a=!0,u=i.error,i=null):s=!0,r===i)return void O(r,w())}else i=o,s=!0;r._state!==Yt||(c&&s?S(r,i):a?O(r,u):t===Dt?C(r,i):t===Kt&&O(r,i))}function N(t,n){var r=!1;try{n(function(n){r||(r=!0,S(t,n))},function(n){r||(r=!0,O(t,n))})}catch(e){O(t,e)}}function Y(t,n,r){this._superConstructor(t,n,!1,r)}function D(t,n){return new Y(Nt,t,n).promise}function K(t,n){return Nt.all(t,n)}function U(t,n){Xt[Wt]=t,Xt[Wt+1]=n,Wt+=2,2===Wt&&Gt()}function q(){var t=process.nextTick,n=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(n)&&"0"===n[1]&&"10"===n[2]&&(t=setImmediate),function(){t(W)}}function F(){return function(){Ft(W)}}function G(){var t=0,n=new Ht(W),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){r.data=t=++t%2}}function L(){var t=new MessageChannel;return t.port1.onmessage=W,function(){t.port2.postMessage(0)}}function V(){return function(){setTimeout(W,1)}}function W(){for(var t=0;Wt>t;t+=2){var n=Xt[t],r=Xt[t+1];n(r),Xt[t]=void 0,Xt[t+1]=void 0}Wt=0}function $(){try{var t=require,n=t("vertx");return Ft=n.runOnLoop||n.runOnContext,F()}catch(r){return V()}}function z(t){var n={};return n.promise=new Nt(function(t,r){n.resolve=t,n.reject=r},t),n}function B(t,n){return Nt.all(t,n)}function H(t,n){return Nt.resolve(t,n).then(function(t){return B(t,n)})}function J(t,r,e){var o=gt(t)?B(t,e):H(t,e);return o.then(function(t){if(!n(r))throw new TypeError("You must pass a function as filter's second argument.");for(var o=t.length,i=new Array(o),u=0;o>u;u++)i[u]=r(t[u]);return B(i,e).then(function(n){for(var r=new Array(o),e=0,i=0;o>i;i++)n[i]&&(r[e]=t[i],e++);return r.length=e,r})})}function Q(t,n,r){this._superConstructor(t,n,!0,r)}function X(t,n,r){this._superConstructor(t,n,!1,r)}function Z(t,n){return new X(Nt,t,n).promise}function tt(t,n){return new nn(Nt,t,n).promise}function nt(t,r,e){return Nt.all(t,e).then(function(t){if(!n(r))throw new TypeError("You must pass a function as map's second argument.");for(var o=t.length,i=new Array(o),u=0;o>u;u++)i[u]=r(t[u]);return Nt.all(i,e)})}function rt(){this.value=void 0}function et(t){try{return t.then}catch(n){return sn.value=n,sn}}function ot(t,n,r){try{t.apply(n,r)}catch(e){return sn.value=e,sn}}function it(t,n){for(var r,e,o={},i=t.length,u=new Array(i),s=0;i>s;s++)u[s]=t[s];for(e=0;e<n.length;e++)r=n[e],o[r]=u[e+1];return o}function ut(t){for(var n=t.length,r=new Array(n-1),e=1;n>e;e++)r[e-1]=t[e];return r}function st(t,n){return{then:function(r,e){return t.call(n,r,e)}}}function at(t,n){var r=function(){for(var r,e=this,o=arguments.length,i=new Array(o+1),u=!1,s=0;o>s;++s){if(r=arguments[s],!u){if(u=lt(r),u===an){var a=new Nt(g);return O(a,an.value),a}u&&u!==!0&&(r=st(u,r))}i[s]=r}var c=new Nt(g);return i[o]=function(t,r){t?O(c,t):void 0===n?S(c,r):n===!0?S(c,ut(arguments)):gt(n)?S(c,it(arguments,n)):S(c,r)},u?ft(c,i,t,e):ct(c,i,t,e)};return r.__proto__=t,r}function ct(t,n,r,e){var o=ot(r,e,n);return o===sn&&O(t,o.value),t}function ft(t,n,r,e){return Nt.all(n).then(function(n){var o=ot(r,e,n);return o===sn&&O(t,o.value),t})}function lt(t){return t&&"object"==typeof t?t.constructor===Nt?!0:et(t):!1}function ht(t,n){return Nt.race(t,n)}function pt(t,n){return Nt.reject(t,n)}function _t(t,n){return Nt.resolve(t,n)}function vt(t){throw setTimeout(function(){throw t}),t}function yt(t,n){jt.async(t,n)}function dt(){jt.on.apply(jt,arguments)}function mt(){jt.off.apply(jt,arguments)}var wt;wt=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var gt=wt,bt=Date.now||function(){return(new Date).getTime()},Et=Object.create||function(t){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof t)throw new TypeError("Argument must be an object");return e.prototype=t,new e},At={mixin:function(t){return t.on=this.on,t.off=this.off,t.trigger=this.trigger,t._promiseCallbacks=void 0,t},on:function(t,n){if("function"!=typeof n)throw new TypeError("Callback must be a function");var r,e=i(this);r=e[t],r||(r=e[t]=[]),-1===o(r,n)&&r.push(n)},off:function(t,n){var r,e,u=i(this);return n?(r=u[t],e=o(r,n),void(-1!==e&&r.splice(e,1))):void(u[t]=[])},trigger:function(t,n,r){var e,o,u=i(this);if(e=u[t])for(var s=0;s<e.length;s++)(o=e[s])(n,r)}},jt={instrument:!1};At.mixin(jt);var Tt=[],St=a,kt=c,Ct=f,Ot=h;h.prototype._validateInput=function(t){return gt(t)},h.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},h.prototype._init=function(){this._result=new Array(this.length)},h.prototype._enumerate=function(){for(var t=this.length,n=this.promise,r=this._input,e=0;n._state===Yt&&t>e;e++)this._eachEntry(r[e],e)},h.prototype._settleMaybeThenable=function(t,n){var r=this._instanceConstructor,e=r.resolve;if(e===Ct){var o=b(t);if(o===kt&&t._state!==Yt)t._onError=null,this._settledAt(t._state,n,t._result);else if("function"!=typeof o)this._remaining--,this._result[n]=this._makeResult(Dt,n,t);else if(r===Nt){var i=new r(g);T(i,t,o),this._willSettleAt(i,n)}else this._willSettleAt(new r(function(n){n(t)}),n)}else this._willSettleAt(e(t),n)},h.prototype._eachEntry=function(t,n){r(t)?this._settleMaybeThenable(t,n):(this._remaining--,this._result[n]=this._makeResult(Dt,n,t))},h.prototype._settledAt=function(t,n,r){var e=this.promise;e._state===Yt&&(this._remaining--,this._abortOnReject&&t===Kt?O(e,r):this._result[n]=this._makeResult(t,n,r)),0===this._remaining&&C(e,this._result)},h.prototype._makeResult=function(t,n,r){return r},h.prototype._willSettleAt=function(t,n){var r=this;R(t,void 0,function(t){r._settledAt(Dt,n,t)},function(t){r._settledAt(Kt,n,t)})};var Rt=p,It=_,Mt=v,Pt="rsvp_"+bt()+"-",xt=0,Nt=m;m.cast=Ct,m.all=Rt,m.race=It,m.resolve=Ct,m.reject=Mt,m.prototype={constructor:m,_guidKey:Pt,_onError:function(t){var n=this;jt.after(function(){n._onError&&jt.trigger("error",t,n._label)})},then:kt,"catch":function(t,n){return this.then(void 0,t,n)},"finally":function(t,n){var r=this,e=r.constructor;return r.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){return e.reject(n)})},n)}};var Yt=void 0,Dt=1,Kt=2,Ut=new M,qt=new M;Y.prototype=Et(Ot.prototype),Y.prototype._superConstructor=Ot,Y.prototype._makeResult=l,Y.prototype._validationError=function(){return new Error("allSettled must be called with an array")};var Ft,Gt,Lt=D,Vt=K,Wt=0,$t=({}.toString,U),zt="undefined"!=typeof window?window:void 0,Bt=zt||{},Ht=Bt.MutationObserver||Bt.WebKitMutationObserver,Jt="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Qt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Xt=new Array(1e3);Gt=Jt?q():Ht?G():Qt?L():void 0===zt&&"function"==typeof require?$():V();var Zt=z,tn=J,nn=Q;Q.prototype=Et(Ot.prototype),Q.prototype._superConstructor=Ot,Q.prototype._init=function(){this._result={}},Q.prototype._validateInput=function(t){return t&&"object"==typeof t},Q.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},Q.prototype._enumerate=function(){var t=this,n=t.promise,r=t._input,e=[];for(var o in r)n._state===Yt&&Object.prototype.hasOwnProperty.call(r,o)&&e.push({position:o,entry:r[o]});var i=e.length;t._remaining=i;for(var u,s=0;n._state===Yt&&i>s;s++)u=e[s],t._eachEntry(u.entry,u.position)},X.prototype=Et(nn.prototype),X.prototype._superConstructor=Ot,X.prototype._makeResult=l,X.prototype._validationError=function(){return new Error("hashSettled must be called with an object")};var rn,en=Z,on=tt,un=nt,sn=new rt,an=new rt,cn=at;if("object"==typeof self)rn=self;else{if("object"!=typeof global)throw new Error("no global: `self` or `global` found");rn=global}var fn=rn,ln=ht,hn=pt,pn=_t,_n=vt;jt.async=$t,jt.after=function(t){setTimeout(t,0)};if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var vn=window.__PROMISE_INSTRUMENTATION__;u("instrument",!0);for(var yn in vn)vn.hasOwnProperty(yn)&&dt(yn,vn[yn])}var dn={race:ln,Promise:Nt,allSettled:Lt,hash:on,hashSettled:en,denodeify:cn,on:dt,off:mt,map:un,filter:tn,resolve:pn,reject:hn,all:Vt,rethrow:_n,defer:Zt,EventTarget:At,configure:u,async:yt};"function"==typeof define&&define.amd?define(function(){return dn}):"undefined"!=typeof module&&module.exports?module.exports=dn:"undefined"!=typeof fn&&(fn.RSVP=dn)}).call(this);
(function(){"use strict";function a(a){this._config=a,this._clientSession=void 0}a.prototype={createClientSession:function(){return this._clientSession||(this._clientSession=new a.ClientSession(this._config)),this._clientSession},removeClientSession:function(){this._clientSession&&(this._clientSession.stop(),this._config=void 0,this._clientSession=void 0)},registerLogger:function(b){a.Base.Logger.addLogger(b)}},Object.defineProperty(a,"version",{value:"3.8.0.0"}),this.AvayaCustomerServices=a}).call(this),function(a){"use strict";a.Config=a.Config||{},a.Services=a.Services||{},a.Services.Agent=a.Services.Agent||{},a.Services.Work=a.Services.Work||{},a.Services.Team=a.Services.Team||{},a.Services.Contacts=a.Services.Contacts||{},a.ClientSession=a.ClientSession||{}}(AvayaCustomerServices),function(a){"use strict";a.Base=a.Base||{},a.Base.Authentication=a.Base.Authentication||{},a.Base.Collections=a.Base.Collections||{},a.Base.Network=a.Base.Network||{},a.Providers=a.Providers||{},a.Providers.Interfaces=a.Providers.Interfaces||{},a.Providers.UAC=a.Providers.UAC||{},a.Providers.CP=a.Providers.CP||{}}(AvayaCustomerServices),function(a){"use strict";var b={};b.TokenTypes={EDP_SSO_Token:"EDP_SSO_Token",UAC_Token:"UAC_Token",token:"Token"},b.Headers={EDP_SSO_Token:"X-EDP_SSO_Token",UAC_Token:"AuthToken",Token:"Authorization"},a.Base.Authentication.Constants=b}(AvayaCustomerServices),function(a){"use strict";function b(a,b){this._tokenCollection=a,this._config=b}b.prototype={getTokens:function(){var a,b,c={};return this._config&&this._config.enabled&&(a=this._tokenCollection.findAllByTokenTypes(this._config.tokens),_.forEach(a,function(a){b=a.getHeader(),c[b]=a.getValue()})),c}},a.Base.Authentication.TokenProvider=b}(AvayaCustomerServices),function(a,b){"use strict";function c(){this._callbacks=[]}c.prototype={add:function(a){this._callbacks.push(a)},fire:function(){var a=arguments;b.forEach(this._callbacks,function(b){b.apply(null,a)})},remove:function(a){var c=b.indexOf(this._callbacks,a);c!==-1&&this._callbacks.splice(c,1)},empty:function(){this._callbacks=[]}},a.Base.Callbacks=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(a,c){this._model=a,this._modelOptions=b.assignIn({idAttribute:"id"},c),this._modelId=this._modelOptions.idAttribute,this._collection=[]}c.prototype={add:function(a){var b=this.find({id:a[this._modelId]});return b||(b=new this._model(this._modelOptions),b.setData(a),this._collection.push(b)),b},edit:function(a){var b=this.find({id:a[this._modelId]});return b?(b.setData(a),b):this.add(a)},remove:function(a){var b,c=this.findIndex({id:a[this._modelId]});return c!==-1&&(b=this._collection.splice(c,1)[0]),b},empty:function(){var a=this._collection;return this._collection=[],a},find:function(a){return b.find(this._collection,a)},findIndex:function(a){var c=b.find(this._collection,a);return b.indexOf(this._collection,c)},findAll:function(a){return b.filter(this._collection,a)}},a.Base.Collections.Collection=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(a){this.id=void 0,this.isNew=!1,this._options=b.assignIn({idAttribute:"id"},a),this._id=this._options.idAttribute,this.data={}}c.prototype={setData:function(a){return b.isUndefined(this.id)&&!b.isUndefined(a[this._id])&&(this.id=a[this._id]),this.isNew=b.isEmpty(this.data),b.assignIn(this.data,a)}},a.Base.Collections.Model=c}(AvayaCustomerServices,_),function(a){"use strict";function b(a){this.message=a.message,this.reason=a.reason,this.status=a.status||0,this.code=a.code||0,this.scope=a.scope||"AvayaCustomerServices",this.severity=a.severity||"NORMAL",this.scopeId=a.scopeId||null,this.source=a.source||null}b.prototype={},a.Base.Error=b}(AvayaCustomerServices),function(a,b){"use strict";function c(a,c,d,e){b.isUndefined(e)?a[c](d):a[c](d,e)}function d(a,c,d,e){b.isUndefined(e)?a.log(c,d):a.log(c,d,e)}var e=[];a.Base.Logger={log:function(a,b,c){e.forEach(function(e){d(e,a,b,c)})},info:function(a,b){e.forEach(function(e){"function"==typeof e.info?c(e,"info",a,b):d(e,"info",a,b)})},error:function(a,b){e.forEach(function(e){"function"==typeof e.error?c(e,"error",a,b):d(e,"error",a,b)})},fatal:function(a,b){e.forEach(function(e){"function"==typeof e.fatal?c(e,"fatal",a,b):d(e,"fatal",a,b)})},debug:function(a,b){e.forEach(function(e){"function"==typeof e.debug?c(e,"debug",a,b):d(e,"debug",a,b)})},trace:function(a,b){e.forEach(function(e){"function"==typeof e.trace?c(e,"trace",a,b):d(e,"trace",a,b)})},warn:function(a,b){e.forEach(function(e){"function"==typeof e.warn?c(e,"warn",a,b):d(e,"warn",a,b)})},addLogger:function(a){if(!a||"undefined"==typeof a.log)throw new TypeError("Logger should implement log method.");e.push(a)},removeLogger:function(a){var b=e.indexOf(a);if(b===-1)throw new Error("Specified error does not exist.");e.splice(b,1)}}}(AvayaCustomerServices,_),function(a,b,c){"use strict";function d(){this._providers={}}function e(a,d,e,f){a[f]=function(){var a=[],e=arguments;return b.forEach(d,function(c){c[f]&&b.isFunction(c[f])&&a.push(c[f].apply(c,e))}),1===a.length?a[0]:c.all(a)}}d.prototype={injectProvider:function(a,c){this._providers[c]=a,b.forEach(Object.getPrototypeOf(a),b.bind(e,null,this,this._providers))},removeProvider:function(a){delete this._providers[a]}},a.Base.Mediator=d}(AvayaCustomerServices,_,RSVP),function(a,b){"use strict";function c(b){a.Base.Collections.Model.call(this,b)}c.prototype={},b.defaults(c.prototype,a.Base.Collections.Model.prototype),a.Base.Mediator.Prerequisite=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(){a.Base.Collections.Collection.call(this,a.Base.Mediator.Prerequisite)}c.prototype={fetchByName:function(a){var d={};return b.forEach(a,b.bind(function(a){var e=this.find({id:a});if(!e){var f=b.find(c.Types,{key:a});f&&(e=f.initScript(),e.id=a,this.add(e))}d[a]=e},this)),d}},c.Types=[{key:"tokenCollection",initScript:function(){return new a.Base.Authentication.TokenCollection}}],b.defaults(c.prototype,a.Base.Collections.Collection.prototype),a.Base.Mediator.PrerequisiteCollection=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Base.Collections.Model.call(this,b)}c.prototype={},b.defaults(c.prototype,a.Base.Collections.Model.prototype),a.Base.Mediator.Provider=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){if(this._xhr=void 0,XMLHttpRequest)this._xhr=new XMLHttpRequest;else{if(!ActiveXObject)throw a.Base.Logger.error("HTTPRequest",{error:"There is no XHR protocol available for HTTP Requests"}),new Error("There is no XHR protocol available for HTTP Requests");try{this._xhr=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){this._xhr=new ActiveXObject("Microsoft.XMLHTTP")}}this._xhr.withCredentials=b.withCredentials,this._xhr.onloadstart=d,this._xhr.onprogress=d,this._xhr.onabort=d,this._xhr.onerror=d,this._xhr.onload=d,this._xhr.ontimeout=d,this._xhr.onloadend=d}function d(b){var c=b&&b.target?b.target:"logXHRProgress";a.Base.Logger.debug("HTTPRequest",c)}c.prototype={encode:function(a){if(a=a||{},"string"==typeof a)return a;var c=[];return b.forEach(a,function(a,b){c.push(encodeURIComponent(b)+"="+encodeURIComponent(a))}),c.join("&")},setRequestHeader:function(a,b){this._xhr.setRequestHeader(a,b)},setRequestHeaders:function(a){var c="application/x-www-form-urlencoded";b.forEach(a,b.bind(function(a,b){"content-type"===b.toLowerCase()?c=a:this.setRequestHeader(b,a)},this)),this.setRequestHeader("Content-Type",c)},setTimeout:function(a){a&&"number"==typeof a&&(this._xhr.timeout=a)},open:function(a,b,c){this._xhr.open(a,b,c)},abort:function(){this._xhr.abort()},send:function(a){this._xhr.send(a)},addOnStateChangeCallback:function(a){this._xhr.onreadystatechange=a}},a.Base.Network.HTTPRequest=c}(AvayaCustomerServices,_),function(a,b,c){"use strict";function d(a,c){this.name=c.name||"NotificationProvider",this._socket=b,this._subSocket=null,this._config=c,this._tokenProvider=a}d.prototype={start:function(){var a=this._tokenProvider.getTokens(),b=c.assignIn({},this._config.headers,a);return this._subSocket||(this._subSocket=this._socket.subscribe({headers:b,url:this._config.broadcastUrl,timeout:this._config.timeout,logLevel:this._config.logLevel,transport:this._config.transport,fallbackTransport:this._config.fallbackTransport,enableXDR:this._config.enableXDR,trackMessageLength:this._config.trackMessageLength,maxReconnectOnClose:this._config.maxReconnectOnClose,reconnectInterval:this._config.reconnectInterval,dropHeaders:this._config.dropHeaders,attachHeadersAsQueryString:this._config.attachHeadersAsQueryString,onOpen:this.onOpen,onReconnect:this.onReconnect,onReopen:this.onReopen,onMessage:this.onMessage,onClose:this.onClose,onError:this.onError,onClientTimeout:this.onClientTimeout,onTransportFailure:this.onTransportFailure,uuid:0})),this._config.onBeforeUnload&&(this._socket.onBeforeUnload=this._config.onBeforeUnload),!!this._subSocket},close:function(){this._subSocket=null,this._socket.unsubscribe(this._config.broadcastUrl)},getConfig:function(){return this._config},onOpen:function(){},onReconnect:function(){},onReopen:function(){},onMessage:function(){},onClose:function(){},onError:function(){},onClientTimeout:function(){},onTransportFailure:function(a,b){"websocket"===b.transport&&(b.attachHeadersAsQueryString=["X-Atmosphere-tracking-id","X-Atmosphere-Framework","X-Atmosphere-Transport","X-Atmosphere-TrackMessageSize","X-atmo-protocol"],b.dropHeaders=["X-Atmosphere-tracking-id","X-Atmosphere-Framework","X-Atmosphere-Transport","X-Atmosphere-TrackMessageSize","X-atmo-protocol"])}},a.Base.Network.NotificationProvider=d}(AvayaCustomerServices,atmosphere,_),function(a,b){"use strict";function c(){this._listeners={}}c.prototype={on:function(a,b){return"function"!=typeof b?this:(this._listeners[a]=this._listeners[a]||[],this._listeners[a].push(b),this)},off:function(a,c){if("function"!=typeof c)return this;if(void 0===this._listeners[a])throw new Error("There is no such handler for event with name: "+a+".");var d=b.indexOf(this._listeners[a],c);if(d===-1)throw new Error("There is no such handler for event with name: "+a+".");return this._listeners[a].splice(d,1),0===b.size(this._listeners[a])&&delete this._listeners[a],this},trigger:function(a,c){var d=this._listeners[a];void 0!==d&&(c=c||[],b.forEach(d,function(a){a.apply(window,c)}))},removeListeners:function(a){var c=this;b.forEach(this._listeners,function(d,e){var f=b.isUndefined(a);if(a){var g=new RegExp("^"+a);f=null!==g.exec(e)}f&&b.forEach(d,function(a){c.off(e,a)})})}},a.Base.Observable=c}(AvayaCustomerServices,_),function(a){"use strict";function b(a){}b.prototype={then:function(a,b,c){},"catch":function(a,b){},"finally":function(a,b){}},a.Base.Promise=b}(AvayaCustomerServices),function(a,b){"use strict";function c(){this._tokenCollection={},this._uacProviderFactory={}}c.prototype={getTokenCollection:function(){return b.isEmpty(this._tokenCollection)?(this._tokenCollection=new a.Base.Authentication.TokenCollection,this._tokenCollection):this._tokenCollection},getUACProvider:function(c,d){return b.isEmpty(this._tokenCollection)&&this.getTokenCollection(),b.isEmpty(this._uacProviderFactory)&&(this._uacProviderFactory=new a.Providers.UAC.ProviderFactory(this._tokenCollection)),this._uacProviderFactory.subscribeToUACProvider(c,d)},removeUACProvider:function(a){b.isEmpty(this._uacProviderFactory)||this._uacProviderFactory.unsubscribeFromUACProvider(a)}},a.Base.ProviderFactory=c}(AvayaCustomerServices,_),function(a){"use strict";a.Base.Utils={parseJSON:function(b){b=b||"";try{return JSON.parse(b)}catch(c){throw new a.Base.Error({type:"JSON.parse",message:c.stack,reason:c.message})}},toJSON:function(a){a=a||"";try{return JSON.parse(a)}catch(b){return{type:"JSON.parse",message:b.stack,reason:b.message}}}}}(AvayaCustomerServices),function(a){"use strict";function b(a){this.enabled=a.enabled||!1,this.whitelist=a.whitelist||[],this.tokens=a.tokens||[]}a.Config.AuthenticationInfo=b}(AvayaCustomerServices),function(a){"use strict";function b(a){c=a.id||"unknown",Object.defineProperty(this,"id",{get:function(){return c},set:function(a){a&&(c=a)}})}var c;a.Config.ClientInfo=b}(AvayaCustomerServices),function(a){"use strict";function b(){this.async=!0,this.headers={}}a.Config.HTTPOptions=b}(AvayaCustomerServices),function(a){"use strict";function b(b){this.name=b.name,this.broadcastUrl=b.broadcastUrl||"",this.logLevel=b.logLevel||"off",this.transport=b.transport||"websocket",this.fallbackTransport=b.fallbackTransport||"long-polling",this.enableXDR=b.enableXDR||!0,this.trackMessageLength=b.trackMessageLength||!0,this.maxReconnectOnClose=b.maxReconnectOnClose||60,this.reconnectInterval=b.reconnectInterval||5e3,this.timeout=b.timeout||9e4,this.headers=b.headers||{},this.attachHeadersAsQueryString=b.attachHeadersAsQueryString||!0,this.dropHeaders=b.dropHeaders||!0,this.onBeforeUnload=b.onBeforeUnload||null,this._onClose=new a.Base.Callbacks}b.prototype={onClose:function(a){this._onClose.add(a)}},a.Config.NotificationInfo=b}(AvayaCustomerServices),function(a){"use strict";function b(a){this.name=a.name,this.apiUrl=a.apiUrl||""}a.Config.ServerInfo=b}(AvayaCustomerServices),function(a,b,c){"use strict";function d(d){a.Base.Observable.call(this),c.defaults(d,{networkConfiguration:{},callUserConfiguration:{},sgConfiguration:{},acsConfiguration:{},mediaConfiguration:{}}),c.defaults(d.sgConfiguration,{networkConfiguration:{}}),c.defaults(d.acsConfiguration,{networkConfiguration:{}}),d.sgConfiguration.authToken&&(d.sgConfiguration.credentialsProvider=new b.Config.CredentialTokenProvider(d.sgConfiguration.authToken,"Bearer"),d.sgConfiguration.credentialsProvider.addOnInvalidCredentialsCallback(c.bind(function(a){this._onInvalidCredentialsCallback.fire(a)},this))),d.acsConfiguration.authToken&&(d.acsConfiguration.credentialsProvider=new b.Config.CredentialTokenProvider(d.acsConfiguration.authToken,"Bearer"),d.acsConfiguration.credentialsProvider.addOnInvalidCredentialsCallback(c.bind(function(a){this._onInvalidCredentialsCallback.fire(a)},this)));new b.Config.ServerInfo(d.networkConfiguration.hostName,d.networkConfiguration.port,d.networkConfiguration.isSecure,d.networkConfiguration.path,d.networkConfiguration.credentials,d.networkConfiguration.query);this.callUserConfiguration={incomingCall:d.callUserConfiguration.incomingCall||!0,videoEnabled:d.callUserConfiguration.videoEnabled||!0,videoMaxBandwidthAnyNetwork:d.callUserConfiguration.videoMaxBandwidthAnyNetwork||1024},this.sgConfiguration={enabled:d.sgConfiguration.enabled||!1,credentialProvider:d.sgConfiguration.credentialsProvider||{},networkProviderConfiguration:e(c.isEmpty(d.sgConfiguration.networkConfiguration)?d.networkConfiguration:d.sgConfiguration.networkConfiguration)},this.acsConfiguration={enabled:d.acsConfiguration.enabled||!1,credentialProvider:d.acsConfiguration.credentialsProvider||{},networkProviderConfiguration:e(d.acsConfiguration.networkConfiguration)},this.mediaConfiguration={mediaEngineEnabled:d.sgConfiguration.enabled||!1},this.logger=d.logger,this._onInvalidCredentialsCallback=new a.Base.Callbacks}function e(a){var c=new b.Config.ServerInfo(a.hostName,a.port,a.isSecure,a.path,a.credentials,a.query);return new b.Config.NetworkProviderConfiguration(c)}d.prototype={addOnInvalidCredentialsProvided:function(a){this._onInvalidCredentialsCallback.add(a)}},a.Config.CPConfiguration=d}(AvayaCustomerServices,AvayaClientServices,_),function(a,b,c,d){"use strict";function e(c){a.Base.Observable.call(this),this.mediaEngine=void 0,this._config=c,this._client=new b,this._user=void 0,this._callService=void 0,this._contactsService=void 0,this._searchDataRetrieval=void 0,this._contactsServiceAvailable=!1}function f(a){a._searchDataRetrieval&&(a.trigger("contacts.search.complete",[a._searchDataRetrieval._cp_searchId,a._searchDataRetrieval._results]),j(a))}function g(a,b){"REQUEST_CANCELED"!==b.getReason()&&a.trigger("contacts.search.failed",[a._searchDataRetrieval._cp_searchId,b.getReason()]),j(a)}function h(d,e,f){var g=[],h=!1;f===b.Base.DataSetChangeTypes.ADDED&&c.forEach(e,function(a){var b=k(a);g[b]=a,d._searchDataRetrieval._results[b]=a,h=!0});var i=new a.Providers.CP.ContactSearchUpdateMessage(g);h&&d.trigger("contacts.search.update",[d._searchDataRetrieval._cp_searchId,i])}function i(a){return!!a._searchDataRetrieval&&(a._searchDataRetrieval.isCancelled||a._searchDataRetrieval.isCompleted||a._searchDataRetrieval.cancel(),j(a),!0)}function j(a){a._searchDataRetrieval&&(a._searchDataRetrieval.removeOnDataRetrievalFailedCallback(g),a._searchDataRetrieval.removeOnDataRetrievalDoneCallback(f),a._searchDataRetrieval.getDataSet().removeOnDataSetChangedCallback(h),a._searchDataRetrieval=void 0)}function k(a){return a.getUniqueAddressForMatching()}function l(a,b){a._callService=b.getCalls(),a._callService&&(a._callService.addOnCallCreatedCallback(c.bind(t,null,a)),a._callService.addOnCallRemovedCallback(c.bind(F,null,a)),a._callService.addOnMakeCallRequestedCallback(G))}function m(a,b){a._callService=b.getCalls(),a._callService&&(a._callService.removeOnCallCreatedCallback(t),a._callService.removeOnCallRemovedCallback(F),a._callService.removeOnMakeCallRequestedCallback(G))}function n(a,b){a._contactsService=b.getContacts(),a._contactsService&&(a._contactsService.addOnContactsServiceAvailableCallback(c.bind(p,null,a)),a._contactsService.addOnContactsServiceUnavailableCallback(c.bind(q,null,a)))}function o(a,b){a._contactsService=b.getContacts(),a._contactsService&&(a._contactsService.removeOnContactsServiceAvailableCallback(c.bind(p,null,a)),a._contactsService.removeOnContactsServiceUnavailableCallback(c.bind(q,null,a)))}function p(a){a._contactsServiceAvailable=!0,a.trigger("contacts.service.available",[])}function q(a){a._contactsServiceAvailable=!1,a.trigger("contacts.service.unavailable",[])}function r(a,b){if(a._config.sgConfiguration.enabled){a.mediaEngine=b.getMediaServices();var c=a.mediaEngine.getAudioInterface().getInputInterface();c&&(c.addOnDevicesAddedCallback(function(b,c){a.trigger("devices.audio_input.added",[{devices:c}])}),c.addOnDevicesRemovedCallback(function(b,c){a.trigger("devices.audio_input.removed",[{devices:c}])}),c.addOnSelectedDeviceRemovedCallback(function(b,c){a.trigger("devices.audio_input.removed",[{device:c}])}),c.addOnDevicesUnavailableCallback(function(){a.trigger("devices.audio_input.unavailable")}),c.addOnSelectedDeviceChangedCallback(function(b,c){a.trigger("devices.audio_input.selected",[{device:c}])}),a.trigger("devices.audio_input.loaded",[{devices:c.getAvailableDevices()}]));var d=a.mediaEngine.getAudioInterface().getOutputInterface();d&&(d.addOnDevicesAddedCallback(function(b,c){a.trigger("devices.audio_output.added",[{devices:c}])}),d.addOnDevicesRemovedCallback(function(b,c){a.trigger("devices.audio_output.removed",[{devices:c}])}),d.addOnSelectedDeviceRemovedCallback(function(b,c){a.trigger("devices.audio_output.removed",[{device:c}])}),d.addOnDevicesUnavailableCallback(function(){a.trigger("devices.audio_output.unavailable")}),d.addOnSelectedDeviceChangedCallback(function(b,c){a.trigger("devices.audio_output.selected",[{device:c}])}),a.trigger("devices.audio_output.loaded",[{devices:d.getAvailableDevices()}]));var e=a.mediaEngine.getVideoInterface();e&&(e.addOnDevicesAddedCallback(function(b,c){a.trigger("devices.video.added",[{devices:c}])}),e.addOnDevicesRemovedCallback(function(b,c){a.trigger("devices.video.removed",[{devices:c}])}),e.addOnSelectedDeviceRemovedCallback(function(b,c){a.trigger("devices.video.removed",[{device:c}])}),e.addOnDevicesUnavailableCallback(function(){a.trigger("devices.video.unavailable")}),e.addOnSelectedDeviceChangedCallback(function(b,c){a.trigger("devices.video.selected",[{device:c}])}),a.trigger("devices.video.loaded",[{devices:e.getAvailableDevices()}]))}a.trigger("user.registration.successful",[a._user])}function s(b){var c=new a.Base.Error({type:"User Registration Failed",message:"Communication Package - Error registering user",scope:"CP Provider - onUserRegistrationFailed",severity:"CRITICAL"});a.Base.Logger.error("CP Provider",c),b.trigger("user.registration.failed",[c])}function t(a,b){b.addOnAnswerCallRequestedCallback(c.bind(u,null,a)),b.addOnUpdateCallRequestedCallback(v),b.addOnCallEstablishedCallback(c.bind(x,null,a)),b.addOnCallIncomingVideoAddRequestReceivedCallback(c.bind(w,null,a)),b.addOnTerminateCallRequestedCallback(y),b.addOnCallAudioMuteStatusChangedCallback(c.bind(z,null,a)),b.addOnCallSpeakerMuteStatusChangedCallback(c.bind(A,null,a)),b.addOnCallFailedCallback(c.bind(C,null,a))}function u(a,c){c.acceptAnswerCallRequest().then(function(){var d=D(c.getUserToUserInfo()),e=c.getIncomingVideoOffered()===b.Services.Call.VideoNetworkSignalingType.SUPPORTED,f=E(a.mediaEngine.getVideoInterface()),g={ucid:d,call:c,isVideoSupported:e,isVideoDeviceAvailable:f};a.trigger("interaction.answer.requested",[g])})}function v(a,c){a.acceptUpdateCallRequest().then(function(){switch(c){case b.Providers.Call.CallProvider.Constants.HOLD_ACTION:a.getHoldCapability().isAllowed&&a.hold();break;case b.Providers.Call.CallProvider.Constants.UNHOLD_ACTION:a.getUnholdCapability().isAllowed&&a.unhold()}})}function w(a,b){var c=D(b.getUserToUserInfo()),d=E(a.mediaEngine.getVideoInterface()),e={ucid:c,call:b,isVideoDeviceAvailable:d};a.trigger("interaction.add_video.request",[e])}function x(a,d){var e=d.getIncomingVideoOffered()===b.Services.Call.VideoNetworkSignalingType.SUPPORTED;e&&B(a,d),d.addOnCallVideoChannelsUpdatedCallback(c.bind(B,null,a))}function y(a){a.acceptTerminateCallRequest().then(function(){a.end()})}function z(a,b,c){var d=D(b.getUserToUserInfo());a.trigger("interaction.audio_updated",[{isMuted:c,ucid:d}])}function A(a,b,c){var d=D(b.getUserToUserInfo());a.trigger("interaction.speaker_updated",[{isMuted:c,ucid:d}])}function B(a,d){var e=D(d.getUserToUserInfo()),f=d.getVideoChannels(),g=f[0],h={direction:"local",ucid:e,stream:""},i={direction:"remote",ucid:e,stream:""};if(g){var j=g.getNegotiatedDirection(),k=a.mediaEngine.getVideoInterface().getLocalMediaStream(g.getChannelId())||{},l=a.mediaEngine.getVideoInterface().getRemoteMediaStream(g.getChannelId())||{},m=j===b.Services.Call.MediaDirection.SEND_RECV||j===b.Services.Call.MediaDirection.SEND_ONLY,n=j===b.Services.Call.MediaDirection.SEND_RECV||j===b.Services.Call.MediaDirection.RECV_ONLY,o=j===b.Services.Call.MediaDirection.DISABLE||j===b.Services.Call.MediaDirection.INACTIVE,p=o?g.getVideoDisabledReason():"";c.assignIn(h,{id:k.id,stream:m?k:"",mediaDirection:j,isDisabled:!m,disabledReason:p}),c.assignIn(i,{id:l.id,stream:n?l:"",mediaDirection:j,isDisabled:!n,disabledReason:p})}a.trigger("interaction.video_updated",[h]),a.trigger("interaction.video_updated",[i])}function C(b,c,d){var e="Communication package - call failed";e+=d&&d.getError()?" ["+d.getError()+"]":"";var f=new a.Base.Error({code:503004,type:"Call failed",message:e,reason:d&&d.getError(),scope:"CP Provider - onCallFailed",severity:"CRITICAL",source:"Communication Package"});a.Base.Logger.error("CP Provider",f);var g=D(c.getUserToUserInfo()),h={ucid:g,error:f};b.trigger("interaction.error",[h])}function D(a){return a&&a.getUCID()}function E(a){return a.getAvailableDevices().length>0}function F(a,b){a.trigger("interaction.call_removed",[{call:b}])}function G(a){a.acceptMakeCallRequest().then(function(){a.start()})}e.prototype={start:function(){this._config.logger&&this._client.registerLogger(this._config.logger),this._user=this._client.createUser(this._config),this._user&&(this._user.addOnUserRegistrationSuccessful(c.bind(r,null,this,this._client)),this._user.addOnUserRegistrationFailed(c.bind(s,null,this)),this._user.start(),this._config.sgConfiguration.enabled&&(this.on("user.startCallService",c.bind(l,null,this,this._user)),this.on("user.stopCallService",c.bind(m,null,this,this._user))),this._config.acsConfiguration.enabled&&(this.on("user.startContactsService",c.bind(n,null,this,this._user)),this.on("user.stopContactsService",c.bind(o,null,this,this._user))))},stop:function(a){this._user&&(a?this._user.stopImmediately():this._user.stop(),this._user.removeOnUserRegistrationSuccessful(r),this._user.removeOnUserRegistrationFailed(s),this.removeListeners("user.startCallService"),this.removeListeners("user.stopCallService"),this.removeListeners("user.startContactsService"),this.removeListeners("user.stopContactsService"))},getCall:function(a){var b=this;return new d(function(d,e){var f=b._callService.getCalls(),g=c.find(f,{_userToUserInfo:{_ucid:a.data.contactId}});g?d(g):e({error:"Call not found"})})},muteAudio:function(a){var b=this;return new d(function(d,e){var f=b._callService.getCalls(),g=c.find(f,{_userToUserInfo:{_ucid:a.data.contactId}});g&&g.getMuteCapability().isAllowed?g.muteAudio().then(function(){d({isMuted:g.isAudioMuted()})},function(){e({error:"Failed to mute audio"})}):e({error:"Failed to mute audio"})})},unmuteAudio:function(a){var b=this;return new d(function(d,e){var f=b._callService.getCalls(),g=c.find(f,{_userToUserInfo:{_ucid:a.data.contactId}});g&&g.getUnmuteCapability().isAllowed?g.unmuteAudio().then(function(){d({isMuted:g.isAudioMuted()})},function(){e({error:"Failed to unmute audio"})}):e({error:"Failed to unmute audio"})})},setVideoMode:function(a,e){var f=this;return new d(function(d,g){var h,i=f._callService.getCalls(),j=c.find(i,{_userToUserInfo:{_ucid:a.data.contactId}});if(!j)return f.trigger("interaction.not_found",[{interaction:a}]),void g({error:"Set video mode error"});if(!b.Services.Call.VideoMode[e])return f.trigger("interaction.video_mode_unsupported",[{interaction:a,mode:e}]),void g({error:"Set video mode error"});switch(b.Services.Call.VideoMode[e]){case b.Services.Call.VideoMode.DISABLE:h=j.getUpdateVideoModeDisableCapability().isAllowed&&j.setVideoMode(b.Services.Call.VideoMode.DISABLE);break;case b.Services.Call.VideoMode.INACTIVE:h=j.getUpdateVideoModeInactiveCapability().isAllowed&&j.setVideoMode(b.Services.Call.VideoMode.INACTIVE);break;case b.Services.Call.VideoMode.RECEIVE_ONLY:h=j.getUpdateVideoModeReceiveOnlyCapability().isAllowed&&j.setVideoMode(b.Services.Call.VideoMode.RECEIVE_ONLY);break;case b.Services.Call.VideoMode.SEND_ONLY:h=j.getUpdateVideoModeSendOnlyCapability().isAllowed&&j.setVideoMode(b.Services.Call.VideoMode.SEND_ONLY);break;case b.Services.Call.VideoMode.SEND_RECEIVE:h=j.getUpdateVideoModeSendReceiveCapability().isAllowed&&j.setVideoMode(b.Services.Call.VideoMode.SEND_RECEIVE)}return h?void h.then(function(){var a=j.getVideoChannels()[0];d({channelId:a.getChannelId(),negotiatedDirection:a.getNegotiatedDirection(),requestedDirection:a.getRequestedDirection(),videoDisabledReason:a.getVideoDisabledReason()})},function(){g({error:"Set video mode error"})}):void g({error:"Set video mode error"})})},isContactsServiceAvailable:function(){return this._contactsServiceAvailable},searchContacts:function(e){var j=this;return new d(function(d,k){if(!j._contactsServiceAvailable)return void k("Contacts service is not available");var l=e.getSearchString();if(!l||!l.trim())return void k("No search string specified");var m;m=e.getSearchField()===a.Providers.CP.ContactSearchCriteria.Fields.NAME?b.Services.Contacts.SearchFieldType.NAME:e.getSearchField()===a.Providers.CP.ContactSearchCriteria.Fields.HANDLE?b.Services.Contacts.SearchFieldType.HANDLE:e.getSearchField()===a.Providers.CP.ContactSearchCriteria.Fields.LOGIN?b.Services.Contacts.SearchFieldType.LOGIN_ID:b.Services.Contacts.SearchFieldType.ALL;var n=e.getMaxResults();(!n||n>300)&&(n=300);var o=n;i(j);var p=new b.Services.Contacts.ContactSearchRequest(l,m,b.Services.Contacts.SearchSourceType.ALL,n,o);j._searchDataRetrieval=j._contactsService.searchContacts(p),j._dataset=j._searchDataRetrieval.getDataSet(),j._dataset.addOnDataSetChangedCallback(c.bind(h,null,j)),j._searchDataRetrieval.addOnDataRetrievalFailedCallback(c.bind(g,null,j)),j._searchDataRetrieval.addOnDataRetrievalDoneCallback(c.bind(f,null,j));var q=c.uniqueId(["contactSearch-"]);j._searchDataRetrieval._cp_searchId=q,j._searchDataRetrieval._results=[],d(q)})},cancelContactsSearch:function(){var a=this;return new d(function(b,c){i(a)?b():c("No active search to cancel")})}},c.defaults(e.prototype,a.Base.Observable.prototype),a.Providers.CP.Provider=e}(AvayaCustomerServices,AvayaClientServices,_,RSVP.Promise),function(a,b){"use strict";function c(){this._cpProvider={}}c.prototype={init:function(c){return b.isEmpty(this._cpProvider)&&(this._cpProvider=new a.Providers.CP.Provider(c)),this._cpProvider},destroy:function(){b.isEmpty(this._cpProvider)||(this._cpProvider={})}},a.Providers.CP.ProviderFactory=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b,c,d){a.Base.Collections.Model.call(this),this._searchString=b,this._searchField=c,this._maxResults=d}c.prototype={getSearchString:function(){return this._searchString},getSearchField:function(){return this._searchField},getMaxResults:function(){return this._maxResults}},b.defaults(c.prototype,a.Base.Collections.Model.prototype),a.Providers.CP.ContactSearchCriteria=c}(AvayaCustomerServices,_),function(a){"use strict";a.Providers.CP.ContactSearchCriteria.Fields={NAME:"NAME",HANDLE:"HANDLE",LOGIN:"LOGIN",ALL:"ALL"}}(AvayaCustomerServices),function(a,b){"use strict";function c(b){a.Base.Collections.Model.call(this),this._newContacts=b}c.prototype={getNewContacts:function(){return this._newContacts}},b.defaults(c.prototype,a.Base.Collections.Model.prototype),a.Providers.CP.ContactSearchUpdateMessage=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(){a.Base.Observable.call(this)}c.prototype={start:function(){},stop:function(){}},b.defaults(c.prototype,a.Base.Observable.prototype),a.Providers.Interfaces.AbstractProvider=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(){a.Providers.Interfaces.AbstractProvider.call(this)}c.prototype={activate:function(a,b,c,d){throw new Error("activate method must be implemented by AgentProvider subclass!")},deactivate:function(a){throw new Error("deactivate method must be implemented by AgentProvider subclass!")},login:function(a,b,c,d){throw new Error("login method must be implemented by AgentProvider subclass!")},logout:function(a,b){throw new Error("logout method must be implemented by AgentProvider subclass!")},goReady:function(a){throw new Error("goReady method must be implemented by AgentProvider subclass!")},goNotReady:function(a,b){throw new Error("goNotReady method must be implemented by AgentProvider subclass!")},goAfterContactWork:function(a,b){throw new Error("goAfterContactWork method must be implemented by AgentProvider subclass!")},setUserPreference:function(a,b,c,d,e){throw new Error("setUserPreference method must be implemented by AgentProvider subclass!")},removeUserPreference:function(a,b,c,d){throw new Error("removeUserPreference method must be implemented by AgentProvider subclass!")},setSystemPreference:function(a,b){throw new Error("setSystemPreference method must be implemented by AgentProvider subclass!")},removeSystemPreference:function(a,b){throw new Error("removeSystemPreference method must be implemented by AgentProvider subclass!")},getConfiguration:function(a){throw new Error("getConfiguration method must be implemented by AgentProvider subclass!")},getClientSessions:function(a){throw new Error("getClientSessions method must be implemented by AgentProvider subclass!")}},b.defaults(c.prototype,a.Providers.Interfaces.AbstractProvider.prototype),a.Providers.Interfaces.AgentProvider=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(){a.Providers.Interfaces.AbstractProvider.call(this)}c.prototype={getTeamState:function(a,b){throw new Error("getTeamState method must be implemented by TeamProvider subclass!")},getTeamMemberState:function(a,b,c){throw new Error("getTeamMemberState method must be implemented by TeamProvider subclass!")},setTeamMonitoring:function(a,b,c){throw new Error("setTeamMonitoring method must be implemented by TeamProvider subclass!")},setTeamMemberMonitoring:function(a,b,c,d){
throw new Error("setTeamMonitoring method must be implemented by TeamProvider subclass!")},logoutTeamMember:function(a,b,c){throw new Error("logoutTeamMember method must be implemented by TeamProvider subclass!")},goReadyTeamMember:function(a,b){throw new Error("goReadyTeamMember method must be implemented by TeamProvider subclass!")},goNotReadyTeamMember:function(a,b,c){throw new Error("goNotReadyTeamMember method must be implemented by TeamProvider subclass!")},startObserving:function(a,b,c){throw new Error("startObserving method must be implemented by TeamProvider subclass!")},stopObserving:function(a,b,c){throw new Error("stopObserving method must be implemented by TeamProvider subclass!")},coach:function(a,b,c){throw new Error("coach method must be implemented by TeamProvider subclass!")},bargeIn:function(a,b,c){throw new Error("bargeIn method must be implemented by TeamProvider subclass!")},broadcast:function(a,b){throw new Error("broadcast method must be implemented by TeamProvider subclass!")}},b.defaults(c.prototype,a.Providers.Interfaces.AbstractProvider.prototype),a.Providers.Interfaces.TeamProvider=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(){a.Providers.Interfaces.AbstractProvider.call(this)}c.prototype={initiate:function(a,b,c,d){throw new Error("initiate method must be implemented by WorkProvider subclass!")},accept:function(a,b,c){throw new Error("accept method must be implemented by WorkProvider subclass!")},hold:function(a,b,c){throw new Error("hold method must be implemented by WorkProvider subclass!")},unhold:function(a,b,c){throw new Error("unhold method must be implemented by WorkProvider subclass!")},defer:function(a,b,c){throw new Error("end method must be implemented by WorkProvider subclass!")},deferred:function(a,b,c){throw new Error("deferred method must be implemented by WorkProvider subclass!")},end:function(a,b,c){throw new Error("end method must be implemented by WorkProvider subclass!")},transfer:function(a,b,c,d){throw new Error("transfer method must be implemented by WorkProvider subclass!")},transferToService:function(a,b,c,d){throw new Error("transfer method must be implemented by WorkProvider subclass!")},transferToUser:function(a,b,c,d){throw new Error("transfer method must be implemented by WorkProvider subclass!")},consultToService:function(a,b,c,d,e){throw new Error("consult to service method must be implemented by WorkProvider subclass!")},getServices:function(a,b,c,d){throw new Error("getServices method must be implemented by WorkProvider subclass!")},getUsers:function(a,b,c,d){throw new Error("getUsers method must be implemented by WorkProvider subclass!")},consult:function(a,b,c,d,e){throw new Error("consult method must be implemented by WorkProvider subclass!")},consultCompleteAsTransfer:function(a,b,c){throw new Error("consultCompleteAsTransfer method must be implemented by WorkProvider subclass!")},consultCompleteAsConference:function(a,b,c){throw new Error("consultCompleteAsConference method must be implemented by WorkProvider subclass!")},setWorkCode:function(a,b,c,d){throw new Error("setWorkCode method must be implemented by WorkProvider subclass!")},setDispositionCode:function(a,b,c,d){throw new Error("setDispositionCode method must be implemented by WorkProvider subclass!")},sendDTMF:function(a,b,c,d){throw new Error("sendDTMF method must be implemented by WorkProvider subclass!")},removeAttachments:function(a,b,c,d){throw new Error("removeAttachments method must be implemented by WorkProvider subclass!")},applyDraftAttachments:function(a,b,c){throw new Error("applyDraftAttachments method must be implemented by WorkProvider subclass!")},applyForwardAttachments:function(a,b,c){throw new Error("applyForwardAttachments method must be implemented by WorkProvider subclass!")},extendACW:function(a,b,c){throw new Error("extendAcw method must be implemented by WorkProvider subclass!")},completeACW:function(a,b,c){throw new Error("extendAcw method must be implemented by WorkProvider subclass!")},sendMessage:function(a,b,c,d){throw new Error("sendMessage method must be implemented by WorkProvider subclass!")},addParticipant:function(a,b,c,d){throw new Error("addParticipant method must be implemented by WorkProvider subclass!")},removeParticipant:function(a,b,c,d){throw new Error("removeParticipant method must be implemented by WorkProvider subclass!")}},b.defaults(c.prototype,a.Providers.Interfaces.AbstractProvider.prototype),a.Providers.Interfaces.WorkProvider=c}(AvayaCustomerServices,_),function(a){"use strict";function b(a){this.eventName=a}a.Providers.UAC.Message=b}(AvayaCustomerServices),function(a,b){"use strict";function c(c){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.REASON_CODES_CREATED),this.reasonCodes=b.sortBy(c.newValue,function(a){return parseInt(a.code)})}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.ReasonCodesCreatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(c){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.REASON_CODES_UPDATED),this.reasonCodes=b.sortBy(c.newValue,function(a){return parseInt(a.code)})}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.ReasonCodesUpdatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.DEFERRED_INTERACTION_DELETE),this.id=b.newValue.id,this.contactId=b.newValue.contactId,this.channel=a.Providers.UAC.Response.channelTypes[b.newValue.channelType],this.workRequestId=b.newValue.workRequestId,this.participant=b.newValue.participant,this.externalInteractionId=b.newValue.externalInteractionId,this.userSessionId=b.newValue.userSessionId,this.service=b.newValue.service,this.deferTime=b.newValue.deferTime,this.routingId=b.newValue.routingId,this.providerId=b.newValue.providerId,this.resourceAddress=b.newValue.resourceAddress}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.RemoveDeferredInteractionEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.RESOURCE_ACQUIRED),this.id=b.newValue.id,this.channel=a.Providers.UAC.Response.channelTypes[b.newValue.channelType],this.state=b.newValue.resourceState,this.stationId=b.newValue.resourceAddress,this.agentId=b.newValue.loginAccountId,this.providerId=b.newValue.providerId}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.ResourceAcquiredEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.RESOURCE_RELEASED),this.id=b.newValue.id,this.channel=a.Providers.UAC.Response.channelTypes[b.newValue.channelType],this.state=b.newValue.resourceState,this.resourceId=b.newValue.resourceId,this.loginAccountId=b.newValue.loginAccountId,this.providerId=b.newValue.providerId}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.ResourceReleasedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.RESOURCE_SESSION_OUTBOUND_CONNECTED),this.id=b.newValue.id,this.resourceSessionId=b.newValue.resourceSessionId,this.providerId=b.newValue.providerId,this.userHandle=b.newValue.userHandle,this.channelType=b.newValue.channelType,this.state=b.newValue.propertyState,this.propertyType=b.newValue.propertyType,this.propertyName=b.newValue.propertyName,this.propertyState=b.newValue.propertyState}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.ResourceSessionPropertyOutboundConnectedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.RESOURCE_SESSION_OUTBOUND_DELETED),this.id=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.ResourceSessionPropertyOutboundDeletedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.RESOURCE_SESSION_OUTBOUND_FAILED),this.id=b.newValue.id,this.resourceSessionId=b.newValue.resourceSessionId,this.providerId=b.newValue.providerId,this.userHandle=b.newValue.userHandle,this.channelType=b.newValue.channelType,this.state=b.newValue.propertyState}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.ResourceSessionPropertyOutboundFailedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.RESOURCE_SESSION_OUTBOUND_NOT_CONNECTED),this.id=b.newValue.id,this.resourceSessionId=b.newValue.resourceSessionId,this.providerId=b.newValue.providerId,this.userHandle=b.newValue.userHandle,this.channelType=b.newValue.channelType,this.state=b.newValue.propertyState}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.ResourceSessionPropertyOutboundNotConnectedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.RESOURCE_SESSION_WORK_MODE_CREATED),this.id=b.newValue.id,this.resourceSessionId=b.newValue.resourceSessionId,this.providerId=b.newValue.providerId,this.userHandle=b.newValue.userHandle,this.channelType=b.newValue.channelType,this.state=b.newValue.value,this.propertyType=b.newValue.propertyType,this.propertyName=b.newValue.propertyName,this.propertyState=b.newValue.propertyState}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.ResourceSessionPropertyWorkModeCreatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.RESOURCE_SESSION_WORK_MODE_DELETED),this.id=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.ResourceSessionPropertyWorkModeDeletedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.RESOURCE_SESSION_WORK_MODE_UPDATED),this.id=b.newValue.id,this.resourceSessionId=b.newValue.resourceSessionId,this.providerId=b.newValue.providerId,this.userHandle=b.newValue.userHandle,this.channelType=b.newValue.channelType,this.state=b.newValue.value,this.propertyType=b.newValue.propertyType,this.propertyName=b.newValue.propertyName,this.propertyState=b.newValue.propertyState}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.ResourceSessionPropertyWorkModeUpdatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.SYSTEM_PREFERENCE_CREATED),this.id=b.newValue.id,this.group=b.newValue.group,this.key=b.newValue.key,this.value=b.newValue.value,this.type=b.newValue.type}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.SystemPreferenceCreatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.SYSTEM_PREFERENCE_DELETED),this.id=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.SystemPreferenceDeletedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.SYSTEM_PREFERENCE_UPDATED),this.id=b.newValue.id,this.group=b.newValue.group,this.key=b.newValue.key,this.value=b.newValue.value,this.type=b.newValue.type}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.SystemPreferenceUpdatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.TEAM_MEMBER_DETAILS_UPDATED),this.members=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.TeamMemberDetailsUpdatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.TEAM_STATE_UPDATED),this.role=b.newValue.role,this.members=b.newValue.members,this.groups=b.newValue.groups}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.TeamStateUpdatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.USER_PREFERENCE_CREATED),this.id=b.newValue.id,this.group=b.newValue.group,this.key=b.newValue.key,this.value=b.newValue.value,this.type=b.newValue.type}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.UserPreferenceCreatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.USER_PREFERENCE_DELETED),this.id=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.UserPreferenceDeletedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.USER_PREFERENCE_UPDATED),this.id=b.newValue.id,this.group=b.newValue.group,this.key=b.newValue.key,this.value=b.newValue.value,this.type=b.newValue.type}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.UserPreferenceUpdatedEvent=c}(AvayaCustomerServices,_),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.changeTypes.NEW,a.Providers.UAC.AgentActivateEvent),this.register(a.Providers.UAC.Response.changeTypes.DELETE,a.Providers.UAC.AgentDeactivateEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.changeTypes[b.notificationChangeType];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.AgentActivateParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.agentStates.UNKNOWN,a.Providers.UAC.AgentUnknownStateEvent),this.register(a.Providers.UAC.Response.agentStates.LOGIN_PENDING,a.Providers.UAC.AgentLoginPendingStateEvent),this.register(a.Providers.UAC.Response.agentStates.READY,a.Providers.UAC.AgentReadyStateEvent),this.register(a.Providers.UAC.Response.agentStates.NOT_READY_PENDING,a.Providers.UAC.AgentNotReadyPendingStateEvent),this.register(a.Providers.UAC.Response.agentStates.NOT_READY,a.Providers.UAC.AgentNotReadyStateEvent),this.register(a.Providers.UAC.Response.agentStates.AFTER_CONTACT_WORK_PENDING,a.Providers.UAC.AgentAfterContactWorkPendingStateEvent),this.register(a.Providers.UAC.Response.agentStates.AFTER_CONTACT_WORK,a.Providers.UAC.AgentAfterContactWorkStateEvent),this.register(a.Providers.UAC.Response.agentStates.LOGOUT_PENDING,a.Providers.UAC.AgentLogoutPendingStateEvent),this.register(a.Providers.UAC.Response.agentStates.LOGGED_OUT,a.Providers.UAC.AgentLoggedOutStateEvent),this.register(a.Providers.UAC.Response.agentStates.COMPLETE,a.Providers.UAC.AgentCompleteStateEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.agentStates[b.newValue.currentState];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.AgentStateParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._parsers={},this.register(a.Providers.UAC.Response.clientSessionProperties.REASON_CODES,new a.Providers.UAC.ReasonCodesParser)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.clientSessionProperties[b.updatedProperty];return this._parsers[c]?this._parsers[c].parse(b):b},register:function(a,b){this._parsers[a]=b}},a.Providers.UAC.ClientSessionParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.changeTypes.NEW,a.Providers.UAC.ConfigurationCreatedEvent),this.register(a.Providers.UAC.Response.changeTypes.UPDATE,a.Providers.UAC.ConfigurationUpdatedEvent),this.register(a.Providers.UAC.Response.changeTypes.DELETE,a.Providers.UAC.ConfigurationDeletedEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.changeTypes[b.notificationChangeType];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.ConfigurationParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.changeTypes.NEW,a.Providers.UAC.DeferredInteractionEvent),this.register(a.Providers.UAC.Response.changeTypes.DELETE,a.Providers.UAC.RemoveDeferredInteractionEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.changeTypes[b.notificationChangeType];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.DeferredInteractionParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.ErrorEvent(b)}},a.Providers.UAC.ErrorParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.InteractionActiveEvent(b)}},a.Providers.UAC.InteractionActiveParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.InteractionACWEvent(b)}},a.Providers.UAC.InteractionACWParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.InteractionACWPendingEvent(b)}},a.Providers.UAC.InteractionACWPendingParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.InteractionUpdateEvent(b)}},a.Providers.UAC.InteractionAlertingParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.contextUpdateTypes.INTERACTION_CONTEXT,a.Providers.UAC.InteractionContextCreatedEvent),this.register(a.Providers.UAC.Response.contextUpdateTypes.INTERACTION_CONTEXT_EXTRA,a.Providers.UAC.InteractionContextUpdatedEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.contextUpdateTypes[b.updatedProperty];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.InteractionContextCreatedParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.InteractionContextDeleteEvent(b)}},a.Providers.UAC.InteractionContextDeleteParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._parsers={},this.register(a.Providers.UAC.Response.changeTypes.NEW,new a.Providers.UAC.InteractionContextCreatedParser),this.register(a.Providers.UAC.Response.changeTypes.DELETE,new a.Providers.UAC.InteractionContextDeleteParser)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.changeTypes[b.notificationChangeType];return this._parsers[c]?this._parsers[c].parse(b):b},register:function(a,b){this._parsers[a]=b}},a.Providers.UAC.InteractionContextParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.InteractionCreatedEvent(b)}},a.Providers.UAC.InteractionCreatedParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.InteractionDeleteEvent(b)}},a.Providers.UAC.InteractionDeleteParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.InteractionHeldEvent(b)}},a.Providers.UAC.InteractionHeldParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.mediaEventTypes.MESSAGE,a.Providers.UAC.InteractionMediaMessageCreatedEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.IS_TYPING,a.Providers.UAC.InteractionMediaMessageIsTypingEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.PAGE_PUSH,a.Providers.UAC.InteractionMediaPagePushUrlEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.TRANSFERRED_FILE,a.Providers.UAC.InteractionMediaTransferredFileEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.CUSTOMER_DOWNLOAD_INITIATED,a.Providers.UAC.InteractionMediaCustomerDownloadInitiatedEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.CUSTOMER_DOWNLOAD_COMPLETE,a.Providers.UAC.InteractionMediaCustomerDownloadCompleteEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.CONNECTED,a.Providers.UAC.InteractionMediaConnectedEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.DISCONNECTED,a.Providers.UAC.InteractionMediaDisconnectedEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.QUERY_RESPONSE,a.Providers.UAC.InteractionMediaMessageCreatedEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.WIDGET,a.Providers.UAC.InteractionMediaMessageCreatedEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.mediaEventTypes[b.newValue.chatMessageEvent.chatEventType];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.InteractionMediaChatMessageParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._parsers={},this.register(a.Providers.UAC.Response.updatedProperties.INTERACTION_MEDIA,new a.Providers.UAC.InteractionMediaObjectParser),this.register(a.Providers.UAC.Response.updatedProperties.INTERACTION_MEDIA_MESSAGE,new a.Providers.UAC.InteractionMediaMessageParser)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.updatedProperties[b.updatedProperty];return this._parsers[c]?this._parsers[c].parse(b):b},register:function(a,b){this._parsers[a]=b}},a.Providers.UAC.InteractionMediaCreatedParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.InteractionMediaDeleteEvent(b)}},a.Providers.UAC.InteractionMediaDeleteParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.mediaEventTypes.MESSAGE,a.Providers.UAC.InteractionMediaEmailMessageEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.DRAFT,a.Providers.UAC.InteractionMediaEmailMessageEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.FORWARD_SENT,a.Providers.UAC.InteractionMediaEmailForwardSentEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.EMAIL_FILE_LIMIT_EXCEEDED,a.Providers.UAC.InteractionMediaEmailFileLimitExceededEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.OUTGOING_ATTACHMENTS_ADDED,a.Providers.UAC.InteractionMediaEmailAttachmentsAddedEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.OUTGOING_ATTACHMENTS_REMOVED,a.Providers.UAC.InteractionMediaEmailAttachmentsRemovedEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.OUTGOING_FORWARD_ATTACHMENTS_ADDED,a.Providers.UAC.InteractionMediaEmailAttachmentsAddedEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.mediaEventTypes[b.newValue.emailMessageEvent.emailEventType];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.InteractionMediaEmailMessageParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.InteractionMediaParticipantListEvent(b)}},a.Providers.UAC.InteractionMediaListParticipantParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._parsers={},this.register(a.Providers.UAC.Response.channelTypes.WEBCHAT,new a.Providers.UAC.InteractionMediaChatMessageParser),this.register(a.Providers.UAC.Response.channelTypes.SMS,new a.Providers.UAC.InteractionMediaChatMessageParser),this.register(a.Providers.UAC.Response.channelTypes.SOCIAL,new a.Providers.UAC.InteractionMediaChatMessageParser),this.register(a.Providers.UAC.Response.channelTypes.EMAIL,new a.Providers.UAC.InteractionMediaEmailMessageParser),this.register(a.Providers.UAC.Response.channelTypes.MESSAGING,new a.Providers.UAC.InteractionMediaRichMediaMessageParser)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.channelTypes[b.newValue.type];return this._parsers[c]?this._parsers[c].parse(b):b},register:function(a,b){this._parsers[a]=b}},a.Providers.UAC.InteractionMediaMessageParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.channelTypes.WEBCHAT,a.Providers.UAC.InteractionMediaChatCreatedEvent),this.register(a.Providers.UAC.Response.channelTypes.SMS,a.Providers.UAC.InteractionMediaChatCreatedEvent),this.register(a.Providers.UAC.Response.channelTypes.SOCIAL,a.Providers.UAC.InteractionMediaSocialCreatedEvent),this.register(a.Providers.UAC.Response.channelTypes.EMAIL,a.Providers.UAC.InteractionMediaEmailCreatedEvent),this.register(a.Providers.UAC.Response.channelTypes.MESSAGING,a.Providers.UAC.InteractionMediaRichMediaCreatedEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.channelTypes[b.newValue.type];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.InteractionMediaObjectParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._parsers={},this.register(a.Providers.UAC.Response.changeTypes.NEW,new a.Providers.UAC.InteractionMediaCreatedParser),this.register(a.Providers.UAC.Response.changeTypes.UPDATE,new a.Providers.UAC.InteractionMediaUpdateParser),this.register(a.Providers.UAC.Response.changeTypes.DELETE,new a.Providers.UAC.InteractionMediaDeleteParser)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.changeTypes[b.notificationChangeType];return this._parsers[c]?this._parsers[c].parse(b):b},register:function(a,b){this._parsers[a]=b}},a.Providers.UAC.InteractionMediaParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.mediaEventTypes.RICHMEDIA,a.Providers.UAC.InteractionMediaMessageCreatedEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.ERROR,a.Providers.UAC.InteractionMediaMessageCreatedEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.IS_TYPING,a.Providers.UAC.InteractionMediaMessageIsTypingEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.PAGE_PUSH,a.Providers.UAC.InteractionMediaPagePushUrlEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.TRANSFERRED_FILE,a.Providers.UAC.InteractionMediaTransferredFileEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.CUSTOMER_DOWNLOAD_INITIATED,a.Providers.UAC.InteractionMediaCustomerDownloadInitiatedEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.CUSTOMER_DOWNLOAD_COMPLETE,a.Providers.UAC.InteractionMediaCustomerDownloadCompleteEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.CONNECTED,a.Providers.UAC.InteractionMediaConnectedEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.DISCONNECTED,a.Providers.UAC.InteractionMediaDisconnectedEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.QUERY_RESPONSE,a.Providers.UAC.InteractionMediaMessageCreatedEvent),this.register(a.Providers.UAC.Response.mediaEventTypes.WIDGET,a.Providers.UAC.InteractionMediaMessageCreatedEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.mediaEventTypes[b.newValue.chatMessageEvent.chatEventType];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.InteractionMediaRichMediaMessageParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._parsers={},this.register(a.Providers.UAC.Response.updatedProperties.INTERACTION_MEDIA,new a.Providers.UAC.InteractionMediaUpdateParticipantParser),this.register(a.Providers.UAC.Response.updatedProperties.PARTICIPANT_LIST,new a.Providers.UAC.InteractionMediaListParticipantParser)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.updatedProperties[b.updatedProperty];return this._parsers[c]?this._parsers[c].parse(b):b},register:function(a,b){this._parsers[a]=b}},a.Providers.UAC.InteractionMediaUpdateParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.mediaUpdateTypes.PARTICIPANT_JOINED,a.Providers.UAC.InteractionMediaParticipantJoinedEvent),this.register(a.Providers.UAC.Response.mediaUpdateTypes.PARTICIPANT_LEFT,a.Providers.UAC.InteractionMediaParticipantLeftEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.mediaUpdateTypes[b.newValue.mediaUpdateType];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.InteractionMediaUpdateParticipantParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._parsers={},this.register(a.Providers.UAC.Response.changeTypes.NEW,new a.Providers.UAC.InteractionCreatedParser),this.register(a.Providers.UAC.Response.changeTypes.UPDATE,new a.Providers.UAC.InteractionUpdateParser),this.register(a.Providers.UAC.Response.changeTypes.DELETE,new a.Providers.UAC.InteractionDeleteParser)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.changeTypes[b.notificationChangeType];return this._parsers[c]?this._parsers[c].parse(b):b},register:function(a,b){this._parsers[a]=b}},a.Providers.UAC.InteractionParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.InteractionPassiveEvent(b)}},a.Providers.UAC.InteractionPassiveParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.InteractionRemoteParticipantAcceptedEvent(b)}},a.Providers.UAC.InteractionRemoteParticipantAcceptedParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.InteractionUnknownEvent(b)}},a.Providers.UAC.InteractionUnknownParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._parsers={},this.register(a.Providers.UAC.Response.interactionUpdatedProperties.INTERACTION,new a.Providers.UAC.InteractionUpdateStateParser),this.register(a.Providers.UAC.Response.interactionUpdatedProperties.DESTINATION_PARTICIPANT_ACCEPTED,new a.Providers.UAC.InteractionRemoteParticipantAcceptedParser)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.interactionUpdatedProperties[b.updatedProperty];return this._parsers[c]?this._parsers[c].parse(b):b},register:function(a,b){this._parsers[a]=b}},a.Providers.UAC.InteractionUpdateParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._parsers={},this.register(a.Providers.UAC.Response.interactionStates.ALERTING,new a.Providers.UAC.InteractionAlertingParser),this.register(a.Providers.UAC.Response.interactionStates.ACTIVE,new a.Providers.UAC.InteractionActiveParser),this.register(a.Providers.UAC.Response.interactionStates.HELD,new a.Providers.UAC.InteractionHeldParser),this.register(a.Providers.UAC.Response.interactionStates.ACW,new a.Providers.UAC.InteractionACWParser),this.register(a.Providers.UAC.Response.interactionStates.ACW_PENDING,new a.Providers.UAC.InteractionACWPendingParser),this.register(a.Providers.UAC.Response.interactionStates.PASSIVE,new a.Providers.UAC.InteractionPassiveParser),this.register(a.Providers.UAC.Response.interactionStates.UNKNOWN,new a.Providers.UAC.InteractionUnknownParser)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.interactionStates[b.newValue.currentState];return this._parsers[c]?this._parsers[c].parse(b):b},register:function(a,b){this._parsers[a]=b}},a.Providers.UAC.InteractionUpdateStateParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._parsers={},this.register(a.Providers.UAC.Response.preferenceTypes.USER,new a.Providers.UAC.UserPreferencesParser),
this.register(a.Providers.UAC.Response.preferenceTypes.SYSTEM,new a.Providers.UAC.SystemPreferencesParser)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.preferenceTypes[b.newValue.type];return this._parsers[c]?this._parsers[c].parse(b):b},register:function(a,b){this._parsers[a]=b}},a.Providers.UAC.PreferencesParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.changeTypes.NEW,a.Providers.UAC.ReasonCodesCreatedEvent),this.register(a.Providers.UAC.Response.changeTypes.UPDATE,a.Providers.UAC.ReasonCodesUpdatedEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.changeTypes[b.notificationChangeType];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.ReasonCodesParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.changeTypes.NEW,a.Providers.UAC.ResourceAcquiredEvent),this.register(a.Providers.UAC.Response.changeTypes.DELETE,a.Providers.UAC.ResourceReleasedEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.changeTypes[b.notificationChangeType];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.ResourceAcquireParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.outboundStates.CONNECTED,a.Providers.UAC.ResourceSessionPropertyOutboundConnectedEvent),this.register(a.Providers.UAC.Response.outboundStates.NOT_CONNECTED,a.Providers.UAC.ResourceSessionPropertyOutboundNotConnectedEvent),this.register(a.Providers.UAC.Response.outboundStates.FAILED,a.Providers.UAC.ResourceSessionPropertyOutboundFailedEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.outboundStates[b.newValue.value];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.ResourceSessionPropertyOutboundCreatedParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.ResourceSessionPropertyOutboundDeletedEvent(b)}},a.Providers.UAC.ResourceSessionPropertyOutboundDeletedParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._parsers={},this.register(a.Providers.UAC.Response.changeTypes.NEW,new a.Providers.UAC.ResourceSessionPropertyOutboundCreatedParser),this.register(a.Providers.UAC.Response.changeTypes.UPDATE,new a.Providers.UAC.ResourceSessionPropertyOutboundCreatedParser),this.register(a.Providers.UAC.Response.changeTypes.DELETE,new a.Providers.UAC.ResourceSessionPropertyOutboundDeletedParser)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.changeTypes[b.notificationChangeType];return this._parsers[c]?this._parsers[c].parse(b):b},register:function(a,b){this._parsers[a]=b}},a.Providers.UAC.ResourceSessionPropertyOutboundParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._parsers={},this.register(a.Providers.UAC.Response.resourceSessionProperties.OUTBOUND_NAILUP,new a.Providers.UAC.ResourceSessionPropertyOutboundParser),this.register(a.Providers.UAC.Response.resourceSessionProperties.WORK_MODE,new a.Providers.UAC.ResourceSessionPropertyWorkModeParser)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.resourceSessionProperties[b.updatedProperty];return this._parsers[c]?this._parsers[c].parse(b):b},register:function(a,b){this._parsers[a]=b}},a.Providers.UAC.ResourceSessionPropertyParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.changeTypes.NEW,a.Providers.UAC.ResourceSessionPropertyWorkModeCreatedEvent),this.register(a.Providers.UAC.Response.changeTypes.UPDATE,a.Providers.UAC.ResourceSessionPropertyWorkModeUpdatedEvent),this.register(a.Providers.UAC.Response.changeTypes.DELETE,a.Providers.UAC.ResourceSessionPropertyWorkModeDeletedEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.changeTypes[b.notificationChangeType];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.ResourceSessionPropertyWorkModeParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.changeTypes.NEW,a.Providers.UAC.SystemPreferenceCreatedEvent),this.register(a.Providers.UAC.Response.changeTypes.UPDATE,a.Providers.UAC.SystemPreferenceUpdatedEvent),this.register(a.Providers.UAC.Response.changeTypes.DELETE,a.Providers.UAC.SystemPreferenceDeletedEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.changeTypes[b.notificationChangeType];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.SystemPreferencesParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.TeamMemberDetailsUpdatedEvent(b)}},a.Providers.UAC.TeamMemberDetailsParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){}b.prototype={parse:function(b){return new a.Providers.UAC.TeamStateUpdatedEvent(b)}},a.Providers.UAC.TeamStateParser=b}(AvayaCustomerServices),function(a){"use strict";function b(){this._events={},this.register(a.Providers.UAC.Response.changeTypes.NEW,a.Providers.UAC.UserPreferenceCreatedEvent),this.register(a.Providers.UAC.Response.changeTypes.UPDATE,a.Providers.UAC.UserPreferenceUpdatedEvent),this.register(a.Providers.UAC.Response.changeTypes.DELETE,a.Providers.UAC.UserPreferenceDeletedEvent)}b.prototype={parse:function(b){var c=a.Providers.UAC.Response.changeTypes[b.notificationChangeType];return this._events[c]?new this._events[c](b):b},register:function(a,b){this._events[a]=b}},a.Providers.UAC.UserPreferencesParser=b}(AvayaCustomerServices),function(a,b){"use strict";function c(c){this.enabled=c.enabled||!1,this.authenticationInfo=new a.Config.AuthenticationInfo(c.authenticationInfo),this.clientInfo=new a.Config.ClientInfo(c.clientInfo),this.serverInfo=new a.Config.ServerInfo(b.assignIn(c.serverInfo,{name:"UAC"})),this.notificationInfo=new a.Config.NotificationInfo(b.assignIn(c.notificationInfo,{name:"Atmosphere"}))}a.Config.UACConfiguration=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(){this._parsers={},this.register(a.Providers.UAC.Response.types.ACQUIRE,new a.Providers.UAC.ResourceAcquireParser),this.register(a.Providers.UAC.Response.types.ACTIVATE,new a.Providers.UAC.AgentActivateParser),this.register(a.Providers.UAC.Response.types.USER_STATE,new a.Providers.UAC.AgentStateParser),this.register(a.Providers.UAC.Response.types.INTERACTION,new a.Providers.UAC.InteractionParser),this.register(a.Providers.UAC.Response.types.INTERACTION_MEDIA,new a.Providers.UAC.InteractionMediaParser),this.register(a.Providers.UAC.Response.types.INTERACTION_CONTEXT,new a.Providers.UAC.InteractionContextParser),this.register(a.Providers.UAC.Response.types.DEFERRED_INTERACTION,new a.Providers.UAC.DeferredInteractionParser),this.register(a.Providers.UAC.Response.types.TEAM,new a.Providers.UAC.TeamStateParser),this.register(a.Providers.UAC.Response.types.TEAM_MEMBERS_DETAILS,new a.Providers.UAC.TeamMemberDetailsParser),this.register(a.Providers.UAC.Response.types.PREFERENCES,new a.Providers.UAC.PreferencesParser),this.register(a.Providers.UAC.Response.types.CONFIGURATION,new a.Providers.UAC.ConfigurationParser),this.register(a.Providers.UAC.Response.types.RESOURCE_SESSION_PROPERTY,new a.Providers.UAC.ResourceSessionPropertyParser),this.register(a.Providers.UAC.Response.types.CLIENT_SESSION,new a.Providers.UAC.ClientSessionParser),this.register(a.Providers.UAC.Response.types.ERROR,new a.Providers.UAC.ErrorParser)}c.prototype={parse:function(b){var c,d;if(!b||!b.responseBody)return a.Base.Logger.info("UAC Message Parser",{info:"Empty response"}),b;try{c=a.Base.Utils.parseJSON(b.responseBody),a.Base.Logger.debug("UAC Message Parser",c)}catch(e){return a.Base.Logger.error("UAC Message Parser",e),{eventName:"error",errorType:"JSON.parse",message:b.responseBody,reason:e.message,severity:"CRITICAL",scope:"UAC Message Parser"}}return c.notificationType?(d=a.Providers.UAC.Response.types[c.notificationType],this._parsers[d]?this._parsers[d].parse(c):c):c},register:function(a,b){this._parsers[a]=b}},a.Providers.UAC.MessageParser=c}(AvayaCustomerServices,window.JSON),function(a){"use strict";var b={};b.eventName={RESOURCE_ACQUIRED:"resource.acquired",RESOURCE_RELEASED:"resource.released",RESOURCE_SESSION_OUTBOUND_CONNECTED:"resource_session.outbound.connected",RESOURCE_SESSION_OUTBOUND_NOT_CONNECTED:"resource_session.outbound.not_connected",RESOURCE_SESSION_OUTBOUND_FAILED:"resource_session.outbound.failed",RESOURCE_SESSION_OUTBOUND_DELETED:"resource_session.outbound.deleted",RESOURCE_SESSION_WORK_MODE_CREATED:"resource_session.work_mode.created",RESOURCE_SESSION_WORK_MODE_UPDATED:"resource_session.work_mode.updated",RESOURCE_SESSION_WORK_MODE_DELETED:"resource_session.work_mode.deleted",AGENT_ACTIVATED:"agent.activated",AGENT_DEACTIVATED:"agent.deactivated",AGENT_STATE_UNKNOWN:"agent.state.unknown",AGENT_STATE_LOGIN_PENDING:"agent.state.login_pending",AGENT_STATE_READY:"agent.state.ready",AGENT_STATE_NOT_READY_PENDING:"agent.state.not_ready_pending",AGENT_STATE_NOT_READY:"agent.state.not_ready",AGENT_STATE_AFTER_CONTACT_WORK_PENDING:"agent.state.after_contact_work_pending",AGENT_STATE_AFTER_CONTACT_WORK:"agent.state.after_contact_work",AGENT_STATE_LOGOUT_PENDING:"agent.state.logout_pending",AGENT_STATE_LOGGED_OUT:"agent.state.logged_out",AGENT_STATE_COMPLETE:"agent.state.complete",INTERACTION_CREATED:"interaction.created",INTERACTION_ACTIVE:"interaction.active",INTERACTION_HELD:"interaction.held",INTERACTION_ACW:"interaction.acw",INTERACTION_ACW_PENDING:"interaction.acw_pending",INTERACTION_PASSIVE:"interaction.passive",INTERACTION_UPDATE:"interaction.updated",INTERACTION_DELETE:"interaction.deleted",INTERACTION_UNKNOWN:"interaction.unknown",DESTINATION_PARTICIPANT_ACCEPTED:"interaction.destination_participant_accepted",INTERACTION_MEDIA_CREATED:"interaction_media.created",INTERACTION_MEDIA_DELETED:"interaction_media.deleted",INTERACTION_MEDIA_MESSAGE_CREATED:"interaction_media.message.created",INTERACTION_MEDIA_MESSAGE_IS_TYPING:"interaction_media.message.is_typing",INTERACTION_MEDIA_PARTICIPANT_JOINED:"interaction_media.participant.joined",INTERACTION_MEDIA_PARTICIPANT_LEFT:"interaction_media.participant.left",INTERACTION_MEDIA_PARTICIPANT_LIST:"interaction_media.participant.list",INTERACTION_MEDIA_TRANSFERRED_FILE:"interaction_media.message.transferred_file",INTERACTION_MEDIA_CUSTOMER_DOWNLOAD_INITIATED:"interaction_media.message.customer_download_initiated",INTERACTION_MEDIA_CUSTOMER_DOWNLOAD_COMPLETE:"interaction_media.message.customer_download_complete",INTERACTION_MEDIA_CONNECTED:"interaction_media.connected",INTERACTION_MEDIA_DISCONNECTED:"interaction_media.disconnected",INTERACTION_MEDIA_PAGE_PUSH:"interaction_media.page_push",INTERACTION_MEDIA_EMAIL_MESSAGE:"interaction_media.email_message",INTERACTION_MEDIA_EMAIL_FORWARD_SENT:"interaction_media.forward_sent",INTERACTION_MEDIA_EMAIL_EMAIL_FILE_LIMIT_EXCEEDED:"interaction_media.email_file_limit_exceeded",INTERACTION_MEDIA_EMAIL_ATTACHMENTS_ADDED:"interaction_media.email_attachments_added",INTERACTION_MEDIA_EMAIL_ATTACHMENTS_REMOVED:"interaction_media.email_attachments_removed",INTERACTION_CONTEXT_CREATED:"interaction_context.created",INTERACTION_CONTEXT_UPDATED:"interaction_context.updated",INTERACTION_CONTEXT_DELETED:"interaction_context.deleted",DEFERRED_INTERACTION:"deferred.interaction",DEFERRED_INTERACTION_DELETE:"deferred.interaction.delete",INITIATED_TRANSFER:"interaction.transfer.initiated",ACTIVE_TRANSFER:"interaction.transfer.active",COMPLETE_TRANSFER:"interaction.transfer.complete",INITIATED_CONFERENCE:"interaction.conference.initiated",ACTIVE_CONFERENCE:"interaction.conference.active",TEAM_STATE_UPDATED:"team.state.updated",TEAM_MEMBER_DETAILS_UPDATED:"team.member.details.updated",USER_PREFERENCE_CREATED:"user_preference.created",USER_PREFERENCE_UPDATED:"user_preference.updated",USER_PREFERENCE_DELETED:"user_preference.deleted",SYSTEM_PREFERENCE_UPDATED:"system_preference.updated",SYSTEM_PREFERENCE_DELETED:"system_preference.deleted",SYSTEM_PREFERENCE_CREATED:"system_preference.created",CONFIGURATION_CREATED:"configuration.created",CONFIGURATION_UPDATED:"configuration.updated",CONFIGURATION_DELETED:"configuration.deleted",REASON_CODES_CREATED:"reason_codes.created",REASON_CODES_UPDATED:"reason_codes.updated",ERROR:"error"},b.resourceTypes={VOICE:"VOICE",VIDEO:"VIDEO",WEBCHAT:"WEBCHAT",EMAIL:"EMAIL",SMS:"SMS",SOCIAL:"SOCIAL",OUTBOUND:"OUTBOUND",PP_OUTBOUND:"PP_OUTBOUND",GENERIC:"GENERIC",MESSAGING:"MESSAGING"},b.resourceState={READY:"READY",NOT_READY_PENDING:"NOT_READY_PENDING",NOT_READY:"NOT_READY",AFTER_CONTACT_WORK_PENDING:"AFTER_CONTACT_WORK_PENDING",AFTER_CONTACT_WORK:"AFTER_CONTACT_WORK",LOGGED_OUT:"LOGGED_OUT",COMPLETE:"COMPLETE",UNKNOWN:"UNKNOWN"},b.agentState={LOGIN_PENDING:"LOGIN_PENDING",READY:"READY",NOT_READY:"NOT_READY",NOT_READY_PENDING:"NOT_READY_PENDING",AFTER_CONTACT_WORK:"AFTER_CONTACT_WORK",AFTER_CONTACT_WORK_PENDING:"AFTER_CONTACT_WORK_PENDING",LOGOUT_PENDING:"LOGOUT_PENDING",LOGGED_OUT:"LOGGED_OUT",COMPLETE:"COMPLETE",UNKNOWN:"UNKNOWN"},b.userTypes={AGENT:"AGENT",SUPERVISOR:"SUPERVISOR",ADMIN:"ADMINISTRATOR"},a.Providers.UAC.MessageTypes=b}(AvayaCustomerServices),function(a,b,c){"use strict";function d(c,d,e,l){a.Base.Observable.call(this),this.clientSessionId=null,this._reconnectAttempts=0,this._requestProvider=c,this._notificationProvider=d,this._notificationParser=e,this._config=l,this._urlProvider=new a.Providers.UAC.UrlBuilder(this),this._notificationProviderStarted=null,this._isActivated=null,this._notificationProvider.onMessage=b.bind(f,null,this),this._notificationProvider.onReopen=b.bind(g,null,this),this._notificationProvider.onClose=b.bind(h,null,this),this._notificationProvider.onError=b.bind(i,null,this),this._notificationProvider.onClientTimeout=b.bind(j,null,this),this._requestProvider.on("xhr.error",b.bind(k,null,this))}function e(b,c,d){b._notificationProvider.onOpen=function(e){!e||null!==b.clientSessionId&&""!==b.clientSessionId?d("There was an error starting notification provider session"):(b.clientSessionId=e.request.uuid,b._reconnectAttempts=0,c(b.clientSessionId),a.Base.Logger.debug("UAC Provider",{reason:"clientsession.started",clientSessionId:b.clientSessionId,epoch:Date.now()}),b.trigger("clientsession.started",[b.clientSessionId]))}}function f(b,c){var d=b._notificationParser.parse(c);a.Base.Logger.debug("UAC Provider",d);var e=d.eventName;delete d.eventName;try{b.trigger(e,[d])}catch(f){var g=new a.Base.Error({message:f||"Could not parse JSON",reason:e+" error",scope:"UAC Provider - "+e,severity:"NORMAL",source:"UAC Provider: onNotificationProviderMessage"});a.Base.Logger.error("UAC Provider",g),b.trigger("error",[g])}}function g(b,c){c&&c.receivedUuidOnReopen&&(b.clientSessionId=c.uuid,b._reconnectAttempts=0,a.Base.Logger.debug("UAC Provider",{reason:"clientsession.restarted",clientSessionId:b.clientSessionId,epoch:Date.now()}),b.trigger("clientsession.restarted",[b.clientSessionId]))}function h(b,c){var d=new a.Base.Error({message:c.responseBody||c.transport+" "+c.state,reason:c.reasonPhrase,status:c.status,scope:"Notification Provider",severity:"NORMAL",source:b._notificationProvider.name});a.Base.Logger.debug("UAC Provider",d);var e=b._notificationProvider.getConfig();e._onClose.fire(d),b.trigger("close",[d])}function i(b,c){var d=c.reasonPhrase||{},e=new a.Base.Error({message:d.message||c.responseBody||c.transport+" "+c.state,reason:d.name||c.reasonPhrase,status:c.status,code:d.code||0,scope:"Notification Provider",severity:"CRITICAL",source:b._notificationProvider.name});b.trigger("error",[e])}function j(b,c){var d=c.reasonPhrase||{},e=new a.Base.Error({message:d.message||c.responseBody||c.transport+" "+c.state,reason:d.name||c.reasonPhrase,status:c.status,code:d.code||0,scope:"Notification Provider",severity:"CRITICAL",source:b._notificationProvider.name});b.trigger("clientsession.closed",[e]);var f=b._notificationProvider.getConfig();b._notificationProvider.close(),b._reconnectAttempts++<f.maxReconnectOnClose&&setTimeout(function(){b._notificationProvider.start()},f.reconnectInterval)}function k(b,c){c=c||{};var d=a.Base.Utils.toJSON(c.responseText),e=new a.Base.Error({message:d.message||d.type||"Unspecified XHR error",reason:d.reason,status:d.status||c.status||0,code:d.code||c.code||0,scope:"UAC Provider",severity:"CRITICAL",source:b._requestProvider.name});b.trigger("error",[e])}function l(a,b){a.on("agent.activated",function(){b()})}d.prototype={start:function(){return this._notificationProviderStarted=new c(b.bind(e,null,this)),this._isActivated=new c(b.bind(l,null,this)),new c(b.bind(function(a,b){this._notificationProvider.start()?a():b("There was an error starting notification provider session")},this))},stop:function(){return this._notificationProviderStarted.then(b.bind(function(){return this.clientSessionId=null,this.removeListeners("agent.activated"),this._notificationProvider.close()},this))},activate:function(c,d,e,f){return this._notificationProviderStarted.then(b.bind(function(b){var g=this._urlProvider.getActivateUrl(c,{clientSessionId:b,profileId:d,extensionAddress:e,sdkversion:a.version,clientid:this._config.clientInfo.id,oldClientSessionId:f});return this._requestProvider.post(g)},this))["catch"](b.bind(function(b){var c=new a.Base.Error({type:"Notification Provider failed to connect",message:b.stack||"Notification Provider failed to connect",reason:b.message,scope:"UAC Provider - activate",severity:"NORMAL"});a.Base.Logger.error("UAC Provider",c),this.trigger("error",[c])},this))},reportActivateTimeout:function(c){return this._notificationProviderStarted.then(b.bind(function(b){var d=this._urlProvider.getActivateUrl(c,{clientSessionId:b,sdkversion:a.version,clientid:this._config.clientInfo.id,operation:a.Providers.UAC.Constants.ACTIVATION_TIMEOUT});return this._requestProvider.post(d)},this))["catch"](b.bind(function(b){var c=new a.Base.Error({type:"Notification Provider failed to connect",message:b.stack||"Notification Provider failed to connect",reason:b.message,scope:"UAC Provider - reportActivateTimeout",severity:"NORMAL"});a.Base.Logger.error("UAC Provider",c),this.trigger("error",[c])},this))},deactivate:function(c){return this._isActivated.then(b.bind(function(){var a=this._urlProvider.getUserUrl(c);return this._requestProvider.del(a)},this))["catch"](b.bind(function(b){var c=new a.Base.Error({type:"Agent has not been activated",message:b.stack||"Agent has not been activated",reason:b.message,scope:"UAC Provider - deactivate",severity:"NORMAL"});a.Base.Logger.error("UAC Provider",c),this.trigger("error",[c])},this))},login:function(c,d,e,f){return this._isActivated.then(b.bind(function(){f=f||a.Providers.UAC.Constants.DEFAULT_REASON,d=d&&d.toLowerCase();var b=this._urlProvider.getUserUrl(c,{operation:a.Providers.UAC.Constants.LOGIN,state:d||a.Providers.UAC.Constants.READY,workMode:e,reason:d===a.Providers.UAC.Constants.NOT_READY?f:void 0});return this._requestProvider.post(b)},this))["catch"](b.bind(function(b){var c=new a.Base.Error({type:"Agent has not been activated",message:b.stack||"Agent has not been activated",reason:b.message,scope:"UAC Provider - login",severity:"NORMAL"});a.Base.Logger.error("UAC Provider",c),this.trigger("error",[c])},this))},logout:function(b,c){var d=this._urlProvider.getUserUrl(b,{operation:a.Providers.UAC.Constants.LOGOUT,reason:c||a.Providers.UAC.Constants.DEFAULT_REASON});return this._requestProvider.post(d)},goReady:function(b,c){var d=this._urlProvider.getUserUrl(b,{operation:a.Providers.UAC.Constants.STATE,state:a.Providers.UAC.Constants.READY,workMode:c});return this._requestProvider.post(d)},goNotReady:function(b,c){var d=this._urlProvider.getUserUrl(b,{operation:a.Providers.UAC.Constants.STATE,state:a.Providers.UAC.Constants.NOT_READY,reason:c||a.Providers.UAC.Constants.DEFAULT_REASON});return this._requestProvider.post(d)},goAfterContactWork:function(b,c){var d=this._urlProvider.getUserUrl(b,{operation:a.Providers.UAC.Constants.STATE,state:a.Providers.UAC.Constants.AFTER_CONTACT_WORK,reason:c||a.Providers.UAC.Constants.DEFAULT_REASON});return this._requestProvider.post(d)},setUserPreference:function(a,b,c,d,e){var f=this._urlProvider.getUserPreferenceUrl(a,c,d,e);return this._requestProvider.post(f,b,{headers:{"Content-Type":"application/json"}})},removeUserPreference:function(a,b,c,d){var e=this._urlProvider.getUserPreferenceUrl(a,c,d);return this._requestProvider.del(e,b,{headers:{"Content-Type":"application/json"}})},setSystemPreference:function(a,b){var c=this._urlProvider.getSystemPreferenceUrl(a);return this._requestProvider.post(c,b,{headers:{"Content-Type":"application/json"}})},removeSystemPreference:function(a,b){var c=this._urlProvider.getSystemPreferenceUrl(a);return this._requestProvider.del(c,b,{headers:{"Content-Type":"application/json"}})},getConfiguration:function(c){var d=this._urlProvider.getConfigurationUrl(encodeURIComponent(c),{sdkversion:a.version,clientid:this._config.clientInfo.id});return this._requestProvider.get(d,"",{headers:{"Cache-Control":"no-cache, no-store, must-revalidate"}})["catch"](b.bind(function(b){var c=a.Base.Utils.toJSON(b.responseText);throw a.Base.Logger.error("UAC Provider",c),this.trigger("error",[c]),c},this))},getClientSessions:function(c){return this._notificationProviderStarted.then(b.bind(function(){var b=this._urlProvider.getActivateUrl(c,{sdkversion:a.version,clientid:this._config.clientInfo.id});return this._requestProvider.get(b)},this))["catch"](b.bind(function(b){var c=a.Base.Utils.toJSON(b.responseText);a.Base.Logger.error("UAC Provider",c),this.trigger("error",[c])},this))},initiate:function(a,b,c,d){var e=this._urlProvider.getInteractionUrl(a,null,null,{type:b,address:c,subType:d});return this._requestProvider.post(e)},accept:function(b,c,d){var e=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.ACCEPT});return this._requestProvider.post(e)},hold:function(b,c,d){var e=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.HOLD});return this._requestProvider.post(e)},unhold:function(b,c,d){var e=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.UNHOLD});return this._requestProvider.post(e)},end:function(a,b,c,d){var e=this._urlProvider.getInteractionUrl(a,b,c,d);return this._requestProvider.del(e)},endMemberInteraction:function(a,b,c,d,e){var f=this._urlProvider.getTeamMemberEndIntreactionUrl(a,b,c,d,e);return this._requestProvider.del(f)},reject:function(a,b,c){var d=this._urlProvider.getInteractionUrl(a,b,c);return this._requestProvider.del(d)},defer:function(c,d,e,f,g,h,i){var j;return j=b.isUndefined(h)?this._urlProvider.getInteractionUrl(c,d,e,{operation:a.Providers.UAC.Constants.DEFER,interval:f,reason:g}):this._urlProvider.getMessageUrl(c,d,e,{operation:a.Providers.UAC.Constants.DEFER,interval:f,reason:g}),this._requestProvider.post(j,h,i)},deferForward:function(b,c,d,e,f,g,h){var i=this._urlProvider.getMessageUrl(b,c,d,{operation:a.Providers.UAC.Constants.DEFER_FORWARD,interval:e,reason:f});return this._requestProvider.post(i,g,h)},transfer:function(b,c,d,e){var f=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.TRANSFER,address:e});return this._requestProvider.post(f)},transferToService:function(b,c,d,e){var f=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.TRANSFER,service:e});return this._requestProvider.post(f)},transferToUser:function(b,c,d,e){var f=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.TRANSFER_TO_USER,transferToUserHandle:e});return this._requestProvider.post(f)},consultToService:function(b,c,d,e,f){var g=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.CONSULT,service:e,uui:f});return this._requestProvider.post(g)},getServices:function(a,b,c,d){var e=this._urlProvider.getServicesUrl(a,b,c,{channelType:d});return this._requestProvider.get(e)["catch"](function(){return[]})},getUsers:function(a,b,c,d){var e=this._urlProvider.getUsersUrl(a,b,c,{userNameSearchString:d});return this._requestProvider.get(e)["catch"](function(){return[]})},retrieveDeferredInteraction:function(b,c){var d=this._urlProvider.getRetrieveDeferredInteractionUrl(b,c,{operation:a.Providers.UAC.Constants.RETRIEVE});return this._requestProvider.post(d)},consult:function(b,c,d,e,f){var g=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.CONSULT,address:e,uui:f});return this._requestProvider.post(g)},consultCompleteAsTransfer:function(b,c,d){var e=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.CONSULT_COMPLETE,reason:a.Providers.UAC.Constants.AS_TRANSFER_REASON});return this._requestProvider.post(e)},consultCompleteAsConference:function(b,c,d){var e=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.CONSULT_COMPLETE,reason:a.Providers.UAC.Constants.AS_CONFERENCE_REASON});return this._requestProvider.post(e)},setWorkCode:function(b,c,d,e){var f=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.WORK_CODE,reason:e});return this._requestProvider.post(f)},setDispositionCode:function(b,c,d,e){var f=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.DISPOSITION_CODE,reason:e});return this._requestProvider.post(f)},sendDTMF:function(b,c,d,e){var f=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.DTMF,address:e});return this._requestProvider.post(f)},removeAttachments:function(a,b,c,d){var e=this._urlProvider.getAttachmentsUrl(a,b,c,d);return this._requestProvider.del(e)},applyDraftAttachments:function(a,b,c){var d=this._urlProvider.getAttachmentsUrl(a,b,c);return this._requestProvider.put(d)},applyForwardAttachments:function(b,c,d){var e=this._urlProvider.getAttachmentsUrl(b,c,d,null,{operation:a.Providers.UAC.Constants.APPLY_FORWARD});return this._requestProvider.put(e)},extendACW:function(b,c,d){var e=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.EXTEND_ACW});return this._requestProvider.post(e)},completeACW:function(b,c,d){var e=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.COMPLETE_ACW});return this._requestProvider.post(e)},sendMessage:function(a,b,c,d){var e=this._urlProvider.getMessageUrl(a,b,c);return this._requestProvider.post(e,d,{headers:{"Content-Type":"application/json"}})},sendEmailMessage:function(a,c,d,e,f){var g;return g=b.isUndefined(f)?this._urlProvider.getMessageUrl(a,c,d):this._urlProvider.getMessageUrl(a,c,d,{operation:f}),this._requestProvider.post(g,e,{headers:{"Content-Type":"application/json"}})},addParticipant:function(a,b,c,d){var e=this._urlProvider.getParticipantsUrl(a,b,c,{address:d});return this._requestProvider.post(e)},removeParticipant:function(a,b,c,d){var e=this._urlProvider.getParticipantsUrl(a,b,c,{participantId:d});return this._requestProvider.del(e)},getTeamState:function(a,b){var c=this._urlProvider.getTeamStateUrl(a,null,{role:b,groupsEnabled:!0});return this._requestProvider.get(c)},getTeamMemberState:function(a,b,c){var d=this._urlProvider.getTeamStateUrl(a,c,{role:b});return this._requestProvider.get(d)},setTeamMonitoring:function(a,b,c){var d=this._urlProvider.getTeamStateUrl(a,null,{role:b,monitor:c});return this._requestProvider.post(d)},setTeamMemberMonitoring:function(a,b,c){var d=this._urlProvider.getTeamStateUrl(a,b,{monitor:c});return this._requestProvider.post(d)},logoutTeamMember:function(b,c,d){var e=this._urlProvider.getTeamStateUrl(b,c,{operation:a.Providers.UAC.Constants.LOGOUT,reason:d});return this._requestProvider.post(e)},goReadyTeamMember:function(b,c){var d=this._urlProvider.getTeamStateUrl(b,c,{operation:a.Providers.UAC.Constants.STATE,state:a.Providers.UAC.Constants.READY});return this._requestProvider.post(d)},goNotReadyTeamMember:function(b,c,d){var e=this._urlProvider.getTeamStateUrl(b,c,{operation:a.Providers.UAC.Constants.STATE,state:a.Providers.UAC.Constants.NOT_READY,reason:d});return this._requestProvider.post(e)},deactivateTeamMember:function(a){var b=this._urlProvider.getUserUrl(a);return this._requestProvider.del(b)},startObserving:function(b,c,d){var e=this._urlProvider.getObserveUrl(b,c,d,{operation:a.Providers.UAC.Constants.OBSERVE});return this._requestProvider.post(e)},stopObserving:function(b,c,d){var e=this._urlProvider.getObserveUrl(b,c,d,{operation:a.Providers.UAC.Constants.STOP_OBSERVE});return this._requestProvider.post(e)},coach:function(b,c,d){var e=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.COACH});return this._requestProvider.post(e)},bargeIn:function(b,c,d){var e=this._urlProvider.getInteractionUrl(b,c,d,{operation:a.Providers.UAC.Constants.BARGE_IN});return this._requestProvider.post(e)},broadcast:function(a,b){var c=this._urlProvider.getSupervisorBroadcastUrl(a);return this._requestProvider.post(c,b,{headers:{"Content-Type":"application/json"}})}},b.defaults(d.prototype,a.Providers.Interfaces.AgentProvider.prototype,a.Providers.Interfaces.WorkProvider.prototype,a.Providers.Interfaces.TeamProvider.prototype),a.Providers.UAC.Provider=d}(AvayaCustomerServices,_,RSVP.Promise),function(a){"use strict";a.Providers.UAC.Constants={ACCEPT:"accept",HOLD:"hold",UNHOLD:"unhold",DEFER:"defer",DEFER_FORWARD:"defer_forward",RETRIEVE:"retrieve",APPLY_FORWARD:"apply_forward",TRANSFER:"transfer",TRANSFER_TO_USER:"TRANSFER_TO_USER",CONSULT:"consult",CONSULT_COMPLETE:"consult_complete",AS_TRANSFER_REASON:"transfer",AS_CONFERENCE_REASON:"conference",LOGIN:"login",LOGOUT:"logout",STATE:"state",READY:"ready",NOT_READY:"not_ready",AFTER_CONTACT_WORK:"after_contact_work",DEFAULT_REASON:"0",ALERTING:"alerting",ACTIVE:"active",HELD:"held",FAILED:"failed",IDLE:"idle",INACTIVE:"inactive",UNKNOWN:"unknown",EXTEND_ACW:"extend_acw",COMPLETE_ACW:"complete_acw",WORK_CODE:"work_code",DISPOSITION_CODE:"disposition_code",DTMF:"DTMF",OBSERVE:"observe",STOP_OBSERVE:"stop_observe",COACH:"coach",BARGE_IN:"barge",ACTIVATION_TIMEOUT:"client_time_out"}}(AvayaCustomerServices),function(a,b){"use strict";function c(a){this._uacProvider={},this._notificationProvider={},this._requestProvider={},this._tokenCollection=a}c.prototype={init:function(c){if(b.isEmpty(this._uacProvider)){var d=new a.Providers.UAC.MessageParser,e=new a.Base.Authentication.TokenProvider(this._tokenCollection,c.authenticationInfo),f=new a.Config.HTTPOptions;this._requestProvider=new a.Base.Network.RESTProvider(e,c.serverInfo,f),this._notificationProvider=new a.Base.Network.NotificationProvider(e,c.notificationInfo),this._uacProvider=new a.Providers.UAC.Provider(this._requestProvider,this._notificationProvider,d,c)}return this._uacProvider},destroy:function(){b.isEmpty(this._uacProvider)||(this._notificationProvider.close(),this._requestProvider.close(),this._uacProvider={})}},a.Providers.UAC.ProviderFactory=c}(AvayaCustomerServices,_),function(a){"use strict";var b={};b.types={ACQUIRE:"ACQUIRE",ACTIVATE:"ACTIVATE",USER_STATE:"USER_STATE",SETTINGS:"SETTINGS",INTERACTION:"INTERACTION",INTERACTION_MEDIA:"INTERACTION_MEDIA",INTERACTION_CONTEXT:"INTERACTION_CONTEXT",DEFERRED_INTERACTION:"DEFERRED_INTERACTION",TEAM:"TEAM",TEAM_MEMBERS_DETAILS:"TEAM_MEMBERS_DETAILS",PREFERENCES:"PREFERENCES",CONFIGURATION:"CONFIGURATION",RESOURCE_SESSION_PROPERTY:"RESOURCE_SESSION_PROPERTY",CLIENT_SESSION:"CLIENT_SESSION",ERROR:"ERROR"},b.changeTypes={NEW:"new",UPDATE:"update",DELETE:"delete"},b.interactionStates={UNKNOWN:"UNKNOWN",INITIATED:"INITIATED",ALERTING:"ALERTING",ACTIVE:"ACTIVE",PASSIVE:"PASSIVE",HELD:"HELD",ACW:"ACW",ACW_PENDING:"ACW_PENDING",
DELETE:"DELETE"},b.deferInteractionStates={ACTIVE:"ACTIVE",COMPLETE:"COMPLETE",RETRIEVING:"RETRIEVING"},b.channelTypes={NO_CHANNEL:"NO_CHANNEL",VOICE:"VOICE",WEBCHAT:"WEBCHAT",EMAIL:"EMAIL",SMS:"SMS",MESSAGING:"MESSAGING",FAX:"FAX",SCANNED_DOCUMENTS:"SCANNED_DOCUMENTS",SOCIAL:"SOCIAL",VIDEO:"VIDEO",CO_BROWSE:"CO_BROWSE",OUTBOUND:"OUTBOUND",PP_OUTBOUND:"PP_OUTBOUND",WEB_VOICE:"WEB_VOICE",GENERIC:"GENERIC",MMS:"MMS"},b.agentStates={UNKNOWN:"UNKNOWN",LOGIN_PENDING:"LOGIN_PENDING",READY:"READY",NOT_READY_PENDING:"NOT_READY_PENDING",NOT_READY:"NOT_READY",AFTER_CONTACT_WORK:"AFTER_CONTACT_WORK",AFTER_CONTACT_WORK_PENDING:"AFTER_CONTACT_WORK_PENDING",LOGOUT_PENDING:"LOGOUT_PENDING",LOGGED_OUT:"LOGGED_OUT",COMPLETE:"COMPLETE"},b.mediaUpdateTypes={NEW:"NEW",NEW_MESSAGE:"NEW_MESSAGE",PARTICIPANT_JOINED:"PARTICIPANT_JOINED",PARTICIPANT_LEFT:"PARTICIPANT_LEFT",PARTICIPANT_LIST:"PARTICIPANT_LIST",DELETE:"DELETE"},b.mediaEventTypes={MESSAGE:"MESSAGE",RICHMEDIA:"RICHMEDIA",ERROR:"ERROR",DRAFT:"DRAFT",JOINED:"JOINED",LEFT:"LEFT",CLOSED:"CLOSED",FORWARD_SENT:"FORWARD_SENT",EMAIL_FILE_LIMIT_EXCEEDED:"EMAIL_FILE_LIMIT_EXCEEDED",VALIDATE:"VALIDATE",SESSION:"SESSION",SUBJECT_CHANGE:"SUBJECT_CHANGE",START:"START",IS_TYPING:"IS_TYPING",PAGE_PUSH:"PAGE_PUSH",OUTGOING_ATTACHMENTS_ADDED:"OUTGOING_ATTACHMENTS_ADDED",OUTGOING_ATTACHMENTS_REMOVED:"OUTGOING_ATTACHMENTS_REMOVED",OUTGOING_FORWARD_ATTACHMENTS_ADDED:"OUTGOING_FORWARD_ATTACHMENTS_ADDED",TRANSFERRED_FILE:"TRANSFERRED_FILE",CUSTOMER_DOWNLOAD_INITIATED:"CUSTOMER_DOWNLOAD_INITIATED",CUSTOMER_DOWNLOAD_COMPLETE:"CUSTOMER_DOWNLOAD_COMPLETE",CONNECTED:"CONNECTED",DISCONNECTED:"DISCONNECTED",QUERY_RESPONSE:"QUERY_RESPONSE",WIDGET:"WIDGET"},b.contextUpdateTypes={INTERACTION_CONTEXT:"INTERACTION_CONTEXT",INTERACTION_CONTEXT_EXTRA:"INTERACTION_CONTEXT_EXTRA"},b.interactionUpdatedProperties={INTERACTION:"INTERACTION",DESTINATION_PARTICIPANT_ACCEPTED:"DESTINATION_PARTICIPANT_ACCEPTED"},b.updatedProperties={WORK_CODE:"WORK_CODE",INTERACTION_MEDIA:"INTERACTION_MEDIA",INTERACTION_MEDIA_MESSAGE:"INTERACTION_MEDIA_MESSAGE",PARTICIPANT_LIST:"PARTICIPANT_LIST"},b.mediaTypes={THREAD:"thread"},b.stateReasons={DEFAULT:"DEFAULT",CONSULT_INIT:"CONSULT_INIT",TRANSFER_INIT:"TRANSFER_INIT",TRANSFER_COMPLETE:"TRANSFER_COMPLETE",CONFERENCE_INIT:"CONFERENCE_INIT",CONFERENCE_COMPLETE:"CONFERENCE_COMPLETE"},b.resourceSessionProperties={OUTBOUND_NAILUP:"OUTBOUND_NAILUP",WORK_MODE:"WORK_MODE"},b.clientSessionProperties={REASON_CODES:"REASON_CODES"},b.outboundStates={CONNECTED:"CONNECTED",NOT_CONNECTED:"NOT_CONNECTED",FAILED:"FAILED"},b.preferenceTypes={SYSTEM:"SYSTEM",USER:"USER"},a.Providers.UAC.Response=b}(AvayaCustomerServices),function(a){"use strict";function b(a){this._uacProvider=a}b.prototype={encodeUrlParams:function(a){var b="";for(var c in a)a.hasOwnProperty(c)&&a[c]&&(b+=0===b.length?"?":"&",b+=c+"="+encodeURIComponent(a[c]));return b},getActivateUrl:function(a,b){var c=[];return c.push("/users/",a,"/sessions"),c.push(this.encodeUrlParams(b)),c.join("")},getUserUrl:function(a,b){var c=[];return c.push("/users/",a,"/sessions/"),c.push(this._uacProvider.clientSessionId),c.push(this.encodeUrlParams(b)),c.join("")},getUserPreferenceUrl:function(a,b,c,d){var e=[];return e.push("/users/",a),d&&e.push("/sessions/",d),b&&e.push("/profiles/",b),c&&e.push("/accounts/",c),e.push("/preferences"),e.join("")},getSystemPreferenceUrl:function(a){var b=[];return b.push("/clients/",a),b.push("/settings"),b.join("")},getConfigurationUrl:function(a,b){var c=[];return c.push("/auth/",a),c.push("/configuration"),c.push(this.encodeUrlParams(b)),c.join("")},getInteractionUrl:function(a,b,c,d){var e=[];return e.push("/sessions/",a,"/"),e.push(this._uacProvider.clientSessionId),b&&e.push("/workrequests/",b),e.push("/interactions"),e.push(c?"/"+c:""),e.push(this.encodeUrlParams(d)),e.join("")},getMessageUrl:function(a,b,c,d){var e=[];return e.push("/sessions/",a,"/"),e.push(this._uacProvider.clientSessionId),e.push("/workrequests/",b),e.push("/interactions/",c,"/messages"),d&&e.push(this.encodeUrlParams(d)),e.join("")},getAttachmentsUrl:function(a,b,c,d,e){var f=[];return f.push("/sessions/",a,"/"),f.push(this._uacProvider.clientSessionId),f.push("/workrequests/",b),f.push("/interactions/",c,"/attachments"),d&&f.push("/",d),e&&f.push(this.encodeUrlParams(e)),f.join("")},getParticipantsUrl:function(a,b,c,d){var e=[];return e.push("/sessions/",a,"/"),e.push(this._uacProvider.clientSessionId),e.push("/workrequests/",b),e.push("/interactions/",c,"/participants"),e.push(this.encodeUrlParams(d)),e.join("")},getServicesUrl:function(a,b,c,d){var e=[];return e.push("/sessions/",a,"/"),e.push(this._uacProvider.clientSessionId),e.push("/workrequests/",b),e.push("/interactions/",c,"/services"),e.push(this.encodeUrlParams(d)),e.join("")},getUsersUrl:function(a,b,c,d){var e=[];return e.push("/sessions/",a,"/"),e.push(this._uacProvider.clientSessionId),e.push("/workrequests/",b),e.push("/interactions/",c,"/users"),e.push(this.encodeUrlParams(d)),e.join("")},getRetrieveDeferredInteractionUrl:function(a,b,c){var d=[];return d.push("/sessions/",a,"/"),d.push(this._uacProvider.clientSessionId),d.push("/deferredinteractions/",b),d.push(this.encodeUrlParams(c)),d.join("")},getTeamStateUrl:function(a,b,c){var d=[];return d.push("/users/",a,"/sessions/"),d.push(this._uacProvider.clientSessionId),d.push("/team"),c&&c.monitor&&b?d.push("/",b):b&&d.push("/",b,"/state"),d.push(this.encodeUrlParams(c)),d.join("")},getObserveUrl:function(a,b,c,d){var e=[];return e.push("/users/",a,"/sessions/"),e.push(this._uacProvider.clientSessionId),e.push("/team"),b&&e.push("/",b),e.push("/interactions/",c),e.push(this.encodeUrlParams(d)),e.join("")},getSupervisorBroadcastUrl:function(a,b){var c=[];return c.push("/users/",a,"/sessions/"),c.push(this._uacProvider.clientSessionId),c.push("/team","/messages"),c.push(this.encodeUrlParams(b)),c.join("")},getTeamMemberEndIntreactionUrl:function(a,b,c,d,e){var f=[];return f.push("/users/",a,"/sessions/"),f.push(this._uacProvider.clientSessionId),f.push("/team"),b&&f.push("/",b),f.push("/workrequests/",c),f.push("/interactions/",d),f.push(this.encodeUrlParams(e)),f.join("")}},a.Providers.UAC.UrlBuilder=b}(AvayaCustomerServices),function(a,b){"use strict";function c(b){a.Base.Collections.Model.call(this),this._agentService=b,this.states=a.Services.Agent.States,this.capabilities=a.Services.Agent.Capabilities,this.state=void 0,this.active=void 0,this.role=void 0,this._userPreferences=[],this._systemPreferences=[],this._devices=new a.Services.Agent.DeviceCollection,this._onActivated=new a.Base.Callbacks,this._onDeactivated=new a.Base.Callbacks,this._onStateLoginPending=new a.Base.Callbacks,this._onStateReady=new a.Base.Callbacks,this._onStateNotReady=new a.Base.Callbacks,this._onStateNotReadyPending=new a.Base.Callbacks,this._onStateAfterContactWork=new a.Base.Callbacks,this._onStateAfterContactWorkPending=new a.Base.Callbacks,this._onStateLogoutPending=new a.Base.Callbacks,this._onStateLoggedOut=new a.Base.Callbacks,this._onStateUnknown=new a.Base.Callbacks,this._onStateComplete=new a.Base.Callbacks,this._onUserPreferenceCreated=new a.Base.Callbacks,this._onUserPreferenceUpdated=new a.Base.Callbacks,this._onUserPreferenceDeleted=new a.Base.Callbacks,this._onSystemPreferenceUpdated=new a.Base.Callbacks,this._onSystemPreferenceCreated=new a.Base.Callbacks,this._onSystemPreferenceDeleted=new a.Base.Callbacks,this._onConfigurationCreated=new a.Base.Callbacks,this._onConfigurationUpdated=new a.Base.Callbacks,this._onConfigurationDeleted=new a.Base.Callbacks,this._onReasonCodesUpdated=new a.Base.Callbacks}c.prototype={activate:function(a,b,c,d){return this._agentService.activate(a,b,c,d)},reportActivateTimeout:function(){return this._agentService.reportActivateTimeout()},deactivate:function(){return this._agentService.deactivate()},login:function(a,b,c){return this._agentService.login(a,b,c)},logout:function(a){return this._agentService.logout(a)},goReady:function(a){return this._agentService.goReady(a)},goNotReady:function(a){return this._agentService.goNotReady(a)},goAfterContactWork:function(a){return this._agentService.goAfterContactWork(a)},isActivated:function(){return!!this.data.isActivated},getHandle:function(){return this.data.handle},setHandle:function(a){this.data.handle=a},getProfileId:function(){return this.data.profileId},getUserPreferences:function(){return this._userPreferences},getRole:function(){return this.role},setUserPreference:function(a,b,c,d){return this._agentService.setUserPreference(a,b,c,d)},removeUserPreference:function(a,b,c){return this._agentService.removeUserPreference(a,b,c)},setUserPreferenceData:function(a){var c=b.find(this._userPreferences,{id:a.id});return c?b.assignIn(c,a):this._userPreferences.push(a)},removeUserPreferenceData:function(a){var c=b.find(this._userPreferences,{id:a.id}),d=b.indexOf(this._userPreferences,c);return d!==-1&&this._userPreferences.splice(d,1)[0]},getSystemPreferences:function(){return this._systemPreferences},setSystemPreference:function(a){return this._agentService.setSystemPreference(a)},removeSystemPreference:function(a){return this._agentService.removeSystemPreference(a)},setSystemPreferenceData:function(a){var c=b.find(this._systemPreferences,{id:a.id});return c?b.assignIn(c,a):this._systemPreferences.push(a)},removeSystemPreferenceData:function(a){var c=b.find(this._systemPreferences,{id:a.id}),d=b.indexOf(this._systemPreferences,c);return d!==-1&&this._systemPreferences.splice(d,1)[0]},getClientSessions:function(a){return this._agentService.getClientSessions(a)},getDevices:function(){return this._devices},setData:function(a){return b.assignSafe(this,{state:a.currentState,capabilities:a.capabilities,active:a.isActivated,role:a.role}),b.assignIn(this.data,a)},addOnActivatedCallback:function(a){this._onActivated.add(a)},addOnDeactivatedCallback:function(a){this._onDeactivated.add(a)},addOnStateLoginPendingCallback:function(a){this._onStateLoginPending.add(a)},addOnStateReadyCallback:function(a){this._onStateReady.add(a)},addOnStateNotReadyPendingCallback:function(a){this._onStateNotReadyPending.add(a)},addOnStateNotReadyCallback:function(a){this._onStateNotReady.add(a)},addOnStateAfterContactWorkPendingCallback:function(a){this._onStateAfterContactWorkPending.add(a)},addOnStateAfterContactWorkCallback:function(a){this._onStateAfterContactWork.add(a)},addOnStateLogoutPendingCallback:function(a){this._onStateLogoutPending.add(a)},addOnStateLoggedOutCallback:function(a){this._onStateLoggedOut.add(a)},addOnStateCompleteCallback:function(a){this._onStateComplete.add(a)},addOnStateUnknownCallback:function(a){this._onStateUnknown.add(a)},addOnUserPreferenceAddedCallback:function(a){this._onUserPreferenceCreated.add(a)},addOnSystemPreferenceAddedCallback:function(a){this._onSystemPreferenceCreated.add(a)},addOnUserPreferenceUpdatedCallback:function(a){this._onUserPreferenceUpdated.add(a)},addOnUserPreferenceRemovedCallback:function(a){this._onUserPreferenceDeleted.add(a)},addOnSystemPreferenceRemovedCallback:function(a){this._onSystemPreferenceDeleted.add(a)},addOnSystemPreferenceUpdatedCallback:function(a){this._onSystemPreferenceUpdated.add(a)},addOnConfigurationAddedCallback:function(a){this._onConfigurationCreated.add(a)},addOnConfigurationUpdatedCallback:function(a){this._onConfigurationUpdated.add(a)},addOnConfigurationRemovedCallback:function(a){this._onConfigurationDeleted.add(a)},addOnReasonCodesUpdatedCallback:function(a){this._onReasonCodesUpdated.add(a)},removeCallbacks:function(){this._onActivated.empty(),this._onDeactivated.empty(),this._onStateLoginPending.empty(),this._onStateReady.empty(),this._onStateNotReady.empty(),this._onStateNotReadyPending.empty(),this._onStateAfterContactWork.empty(),this._onStateAfterContactWorkPending.empty(),this._onStateLogoutPending.empty(),this._onStateLoggedOut.empty(),this._onStateUnknown.empty(),this._onStateComplete.empty(),this._onUserPreferenceCreated.empty(),this._onUserPreferenceUpdated.empty(),this._onUserPreferenceDeleted.empty(),this._onSystemPreferenceUpdated.empty(),this._onSystemPreferenceDeleted.empty(),this._onSystemPreferenceCreated.empty(),this._onConfigurationCreated.empty(),this._onConfigurationUpdated.empty(),this._onConfigurationDeleted.empty(),this._onReasonCodesUpdated.empty(),this._agentService.stop()}},b.defaults(c.prototype,a.Base.Collections.Model.prototype),a.Services.Agent.Agent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(a){this._started=!1,this._agentProvider=a,this._agent=void 0}function d(b,c,d){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onAgentActivated",message:d}),b.setData(d),b._onActivated.fire(d),c.trigger("user.startCallService")}function e(b,c,d){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onAgentDeactivated",message:d}),b.setData(d),b._onDeactivated.fire(d),c.trigger("user.stopCallService")}function f(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onAgentLoginPending",message:c}),b.setData(c),b._onStateLoginPending.fire(c)}function g(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onAgentReady",message:c}),b.setData(c),b._onStateReady.fire(c)}function h(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onAgentNotReadyPending",message:c}),b.setData(c),b._onStateNotReadyPending.fire(c)}function i(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onAgentNotReady",message:c}),b.setData(c),b._onStateNotReady.fire(c)}function j(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onAgentAfterContactWorkPending",message:c}),b.setData(c),b._onStateAfterContactWorkPending.fire(c)}function k(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onAgentAfterContactWork",message:c}),b.setData(c),b._onStateAfterContactWork.fire(c)}function l(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onAgentLogoutPending",message:c}),b.setData(c),b._onStateLogoutPending.fire(c)}function m(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onAgentLoggedOut",message:c}),b.setData(c),b._onStateLoggedOut.fire(c)}function n(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onAgentComplete",message:c}),b.setData(c),b._onStateComplete.fire(c)}function o(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onAgentUnknown",message:c}),b.setData(c),b._onStateUnknown.fire(c)}function p(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onUserPreferenceCreated",message:c}),b.setUserPreferenceData(c),b._onUserPreferenceCreated.fire(c)}function q(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onUserPreferenceUpdated",message:c}),b.setUserPreferenceData(c),b._onUserPreferenceUpdated.fire(c)}function r(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onUserPreferenceDeleted",message:c}),b.removeUserPreferenceData(c),b._onUserPreferenceDeleted.fire(c)}function s(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onSystemPreferenceUpdated",message:c}),b.setSystemPreferenceData(c),b._onSystemPreferenceUpdated.fire(c)}function t(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onSystemPreferenceCreated",message:c}),b.setSystemPreferenceData(c),b._onSystemPreferenceCreated.fire(c)}function u(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onSystemPreferenceDeleted",message:c}),b.removeSystemPreferenceData(c),b._onSystemPreferenceDeleted.fire(c)}function v(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onConfigurationUpdated",message:c}),b._onConfigurationUpdated.fire(c)}function w(b,c){a.Base.Logger.debug("Agent Service",{scope:"Agent Service - onReasonCodesUpdated",message:c}),b._onReasonCodesUpdated.fire(c)}function x(a,c){var d=a.getDevices();c.devices&&b.isArray(c.devices)?b.forEach(c.devices,function(a){d.add(a),d._onAudioInputAdded.fire(a)}):c.device&&(d.add(c.device),d._onAudioInputAdded.fire(c.device))}function y(a,c){var d=a.getDevices();c.devices&&b.isArray(c.devices)?b.forEach(c.devices,function(a){d.remove(a),d._onAudioInputRemoved.fire(a)}):c.device&&(d.remove(c.device),d._onAudioInputRemoved.fire(c.device))}function z(a,b){var c=a.getDevices();c._onAudioInputUnavailable.fire(b)}function A(a,b){var c=a.getDevices();c._onAudioInputSelected.fire(b)}function B(a,c){var d=a.getDevices();c.devices&&b.isArray(c.devices)&&(b.forEach(c.devices,function(a){d.add(a)}),d._onAudioInputLoaded.fire(c.devices))}function C(a,c){var d=a.getDevices();c.devices&&b.isArray(c.devices)?b.forEach(c.devices,function(a){d.add(a),d._onAudioOutputAdded.fire(a)}):c.device&&(d.add(c.device),d._onAudioOutputAdded.fire(c.device))}function D(a,c){var d=a.getDevices();c.devices&&b.isArray(c.devices)?b.forEach(c.devices,function(a){d.remove(a),d._onAudioOutputRemoved.fire(a)}):c.device&&(d.remove(c.device),d._onAudioOutputRemoved.fire(c.device))}function E(a,b){var c=a.getDevices();c._onAudioOutputUnavailable.fire(b)}function F(a,b){var c=a.getDevices();c._onAudioOutputSelected.fire(b)}function G(a,c){var d=a.getDevices();c.devices&&b.isArray(c.devices)&&(b.forEach(c.devices,function(a){d.add(a)}),d._onAudioOutputLoaded.fire(c.devices))}function H(a,c){var d=a.getDevices();c.devices&&b.isArray(c.devices)?b.forEach(c.devices,function(a){d.add(a),d._onVideoAdded.fire(a)}):c.device&&(d.add(c.device),d._onVideoAdded.fire(c.device))}function I(a,c){var d=a.getDevices();c.devices&&b.isArray(c.devices)?b.forEach(c.devices,function(a){d.remove(a),d._onVideoRemoved.fire(a)}):c.device&&(d.remove(c.device),d._onVideoRemoved.fire(c.device))}function J(a,b){var c=a.getDevices();c._onVideoUnavailable.fire(b)}function K(a,b){var c=a.getDevices();c._onVideoSelected.fire(b)}function L(a,c){var d=a.getDevices();c.devices&&b.isArray(c.devices)&&(b.forEach(c.devices,function(a){d.add(a)}),d._onVideoLoaded.fire(c.devices))}c.prototype={init:function(a){this._started=!0,this._agent=a,this._agentProvider.on("agent.activated",b.bind(d,null,a,this._agentProvider)),this._agentProvider.on("agent.deactivated",b.bind(e,null,a,this._agentProvider)),this._agentProvider.on("agent.state.login_pending",b.bind(f,null,a)),this._agentProvider.on("agent.state.ready",b.bind(g,null,a)),this._agentProvider.on("agent.state.not_ready_pending",b.bind(h,null,a)),this._agentProvider.on("agent.state.not_ready",b.bind(i,null,a)),this._agentProvider.on("agent.state.after_contact_work_pending",b.bind(j,null,a)),this._agentProvider.on("agent.state.after_contact_work",b.bind(k,null,a)),this._agentProvider.on("agent.state.logout_pending",b.bind(l,null,a)),this._agentProvider.on("agent.state.logged_out",b.bind(m,null,a)),this._agentProvider.on("agent.state.complete",b.bind(n,null,a)),this._agentProvider.on("agent.state.unknown",b.bind(o,null,a)),this._agentProvider.on("user_preference.created",b.bind(p,null,a)),this._agentProvider.on("user_preference.updated",b.bind(q,null,a)),this._agentProvider.on("user_preference.deleted",b.bind(r,null,a)),this._agentProvider.on("system_preference.updated",b.bind(s,null,a)),this._agentProvider.on("system_preference.deleted",b.bind(u,null,a)),this._agentProvider.on("system_preference.created",b.bind(t,null,a)),this._agentProvider.on("configuration.updated",b.bind(v,null,a)),this._agentProvider.on("reason_codes.created",b.bind(w,null,a)),this._agentProvider.on("reason_codes.updated",b.bind(w,null,a)),this._agentProvider.on("devices.audio_input.added",b.bind(x,null,a)),this._agentProvider.on("devices.audio_input.removed",b.bind(y,null,a)),this._agentProvider.on("devices.audio_input.unavailable",b.bind(z,null,a)),this._agentProvider.on("devices.audio_input.selected",b.bind(A,null,a)),this._agentProvider.on("devices.audio_input.loaded",b.bind(B,null,a)),this._agentProvider.on("devices.audio_output.added",b.bind(C,null,a)),this._agentProvider.on("devices.audio_output.removed",b.bind(D,null,a)),this._agentProvider.on("devices.audio_output.unavailable",b.bind(E,null,a)),this._agentProvider.on("devices.audio_output.selected",b.bind(F,null,a)),this._agentProvider.on("devices.audio_output.loaded",b.bind(G,null,a)),this._agentProvider.on("devices.video.added",b.bind(H,null,a)),this._agentProvider.on("devices.video.removed",b.bind(I,null,a)),this._agentProvider.on("devices.video.unavailable",b.bind(J,null,a)),this._agentProvider.on("devices.video.selected",b.bind(K,null,a)),this._agentProvider.on("devices.video.loaded",b.bind(L,null,a))},stop:function(){this._started=!1,this._agentProvider.removeListeners("agent"),this._agentProvider.removeListeners("user_preference"),this._agentProvider.removeListeners("system_preference"),this._agentProvider.removeListeners("configuration"),this._agentProvider.removeListeners("reason_codes"),this._agentProvider.removeListeners("devices")},isStarted:function(){return this._started},activate:function(a,b,c,d){return this._agentProvider.activate(a,b,c,d)},reportActivateTimeout:function(){var a=this._agent.getHandle();return this._agentProvider.reportActivateTimeout(a)},deactivate:function(){var a=this._agent.getHandle();return this._agentProvider.deactivate(a)},login:function(a,b,c){var d=this._agent.getHandle();return this._agentProvider.login(d,a,b,c)},logout:function(a){var b=this._agent.getHandle();return this._agentProvider.logout(b,a)},goReady:function(a){var b=this._agent.getHandle();return this._agentProvider.goReady(b,a)},goNotReady:function(a){var b=this._agent.getHandle();return this._agentProvider.goNotReady(b,a)},goAfterContactWork:function(a){var b=this._agent.getHandle();return this._agentProvider.goAfterContactWork(b,a)},setUserPreference:function(a,b,c,d){var e=this._agent.getHandle(),f=JSON.stringify(a);return this._agentProvider.setUserPreference(e,f,b,c,d)},removeUserPreference:function(a,b,c){var d=this._agent.getHandle(),e=JSON.stringify(a);return this._agentProvider.removeUserPreference(d,e,b,c)},setSystemPreference:function(a){var b="workspaces",c=JSON.stringify(a);return this._agentProvider.setSystemPreference(b,c)},removeSystemPreference:function(a){var b="workspaces",c=JSON.stringify(a);return this._agentProvider.removeSystemPreference(b,c)},getClientSessions:function(a){return this._agentProvider.getClientSessions(a)}},a.Services.Agent.AgentService=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Base.Collections.Model.call(this,b)}c.prototype={getLabel:function(){return this.data._label},getGroupId:function(){return this.data._groupId},getType:function(){return this.data._kind}},b.defaults(c.prototype,a.Base.Collections.Model.prototype),a.Services.Agent.Device=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(){a.Base.Collections.Collection.call(this,a.Services.Agent.Device,{idAttribute:"_deviceId"}),this._onAudioInputAdded=new a.Base.Callbacks,this._onAudioInputRemoved=new a.Base.Callbacks,this._onAudioInputUnavailable=new a.Base.Callbacks,this._onAudioInputSelected=new a.Base.Callbacks,this._onAudioInputLoaded=new a.Base.Callbacks,this._onAudioOutputAdded=new a.Base.Callbacks,this._onAudioOutputRemoved=new a.Base.Callbacks,this._onAudioOutputUnavailable=new a.Base.Callbacks,this._onAudioOutputSelected=new a.Base.Callbacks,this._onAudioOutputLoaded=new a.Base.Callbacks,this._onVideoAdded=new a.Base.Callbacks,this._onVideoRemoved=new a.Base.Callbacks,this._onVideoUnavailable=new a.Base.Callbacks,this._onVideoSelected=new a.Base.Callbacks,this._onVideoLoaded=new a.Base.Callbacks}c.prototype={getAudioInputDevices:function(){return this.findAll(function(b){return b.getType()===a.Services.Agent.DeviceStates.AUDIO_INPUT})},getAudioOutputDevices:function(){return this.findAll(function(b){return b.getType()===a.Services.Agent.DeviceStates.AUDIO_OUTPUT})},getVideoDevices:function(){return this.findAll(function(b){return b.getType()===a.Services.Agent.DeviceStates.VIDEO_INPUT})},addOnAudioInputAddedCallback:function(a){this._onAudioInputAdded.add(a)},addOnAudioInputRemovedCallback:function(a){this._onAudioInputRemoved.add(a)},addOnAudioInputUnavailableCallback:function(a){this._onAudioInputUnavailable.add(a)},addOnAudioInputSelectedCallback:function(a){this._onAudioInputSelected.add(a)},addOnAudioInputLoadedCallback:function(a){this._onAudioInputLoaded.add(a)},addOnAudioOutputAddedCallback:function(a){this._onAudioOutputAdded.add(a)},addOnAudioOutputRemovedCallback:function(a){this._onAudioOutputRemoved.add(a)},addOnAudioOutputUnavailableCallback:function(a){this._onAudioOutputUnavailable.add(a)},addOnAudioOutputSelectedCallback:function(a){this._onAudioOutputSelected.add(a)},addOnAudioOutputLoadedCallback:function(a){this._onAudioOutputLoaded.add(a)},addOnVideoAddedCallback:function(a){this._onVideoAdded.add(a)},addOnVideoRemovedCallback:function(a){this._onVideoRemoved.add(a)},addOnVideoUnavailableCallback:function(a){this._onVideoUnavailable.add(a)},addOnVideoSelectedCallback:function(a){this._onVideoSelected.add(a)},addOnVideoLoadedCallback:function(a){this._onVideoLoaded.add(a)},removeCallbacks:function(){this._onAudioInputAdded.empty(),this._onAudioInputRemoved.empty(),this._onAudioInputUnavailable.empty(),this._onAudioInputSelected.empty(),this._onAudioInputLoaded.empty(),this._onAudioOutputAdded.empty(),this._onAudioOutputRemoved.empty(),this._onAudioOutputUnavailable.empty(),this._onAudioOutputSelected.empty(),this._onAudioOutputLoaded.empty(),this._onVideoAdded.empty(),this._onVideoRemoved.empty(),this._onVideoUnavailable.empty(),this._onVideoSelected.empty(),this._onVideoLoaded.empty()}},b.defaults(c.prototype,a.Base.Collections.Collection.prototype),a.Services.Agent.DeviceCollection=c}(AvayaCustomerServices,_),function(a){"use strict";a.Services.Agent.Capabilities={canDeactivate:!1,canLogin:!1,canLogout:!1,canSetNotReady:!1,canSetReady:!1}}(AvayaCustomerServices),function(a){"use strict";a.Services.Agent.States={READY:a.Providers.UAC.Constants.READY,NOT_READY:a.Providers.UAC.Constants.NOT_READY}}(AvayaCustomerServices),function(a){"use strict";a.Services.Agent.DeviceStates={AUDIO_INPUT:"audioinput",AUDIO_OUTPUT:"audiooutput",VIDEO_INPUT:"videoinput"}}(AvayaCustomerServices),function(a,b){"use strict";function c(c){this._config=c,this._mediator=void 0,this._started=void 0,this._agent=void 0,this._work=void 0,this._team=void 0,this._contacts=void 0,this._reasonCodes=new a.ClientSession.ReasonCodeCollection,this.data={},this.profiles=[],this.defaultProfileId="",this._providers=new a.Base.Mediator.ProviderCollection,this._prerequisites=new a.Base.Mediator.PrerequisiteCollection,this._onClose=new a.Base.Callbacks,this._onError=new a.Base.Callbacks,this._onClientSessionStarted=new a.Base.Callbacks,this._onClientSessionRestarted=new a.Base.Callbacks,this._onClientSessionClosed=new a.Base.Callbacks,this._onResourceAcquired=new a.Base.Callbacks,this._onResourceReleased=new a.Base.Callbacks,this._onResourceSessionOutboundConnected=new a.Base.Callbacks,this._onResourceSessionOutboundNotConnected=new a.Base.Callbacks,this._onResourceSessionOutboundFailed=new a.Base.Callbacks,this._onResourceSessionOutboundDeleted=new a.Base.Callbacks,this._onResourceSessionWorkModeCreated=new a.Base.Callbacks,this._onResourceSessionWorkModeUpdated=new a.Base.Callbacks,this._onResourceSessionWorkModeDeleted=new a.Base.Callbacks,this._onUserRegistrationSuccessful=new a.Base.Callbacks,this._onUserRegistrationFailed=new a.Base.Callbacks,this._onDeferredInteraction=new a.Base.Callbacks,this._onRemoveDeferredInteraction=new a.Base.Callbacks,b.forEach(this._config,b.bind(function(a,b){this._providers.createProvider(this._prerequisites,a,b)},this))}function d(a,b){a._onClose.fire(b)}function e(a,b){a._onError.fire(b)}function f(a,b){a._onClientSessionStarted.fire(b)}function g(a,b){a._onClientSessionRestarted.fire(b)}function h(a,b){a._onClientSessionClosed.fire(b)}function i(a,b){a._onResourceAcquired.fire(b)}function j(a,b){a._onResourceReleased.fire(b)}function k(a,b){a._onResourceSessionOutboundConnected.fire(b)}function l(a,b){a._onResourceSessionOutboundNotConnected.fire(b)}function m(a,b){a._onResourceSessionOutboundFailed.fire(b)}function n(a,b){a._onResourceSessionOutboundDeleted.fire(b)}function o(a,b){a._onResourceSessionWorkModeCreated.fire(b)}function p(a,b){a._onResourceSessionWorkModeUpdated.fire(b)}function q(a,b){a._onResourceSessionWorkModeDeleted.fire(b)}function r(a,b){a._onUserRegistrationSuccessful.fire(b)}function s(a,b){a._onUserRegistrationFailed.fire(b),a.stop()}function t(a,b){a._onDeferredInteraction.fire(b)}function u(a,b){a._onRemoveDeferredInteraction.fire(b)}c.prototype={start:function(){this._started||(this._mediator=this._providers.getMediator(),this._mediator.start(),this._mediator.on("error",b.bind(e,null,this)),this._mediator.on("close",b.bind(d,null,this)),this._mediator.on("clientsession.started",b.bind(f,null,this)),this._mediator.on("clientsession.restarted",b.bind(g,null,this)),this._mediator.on("clientsession.closed",b.bind(h,null,this)),this._mediator.on("resource.acquired",b.bind(i,null,this)),this._mediator.on("resource.released",b.bind(j,null,this)),this._mediator.on("resource_session.outbound.connected",b.bind(k,null,this)),this._mediator.on("resource_session.outbound.not_connected",b.bind(l,null,this)),this._mediator.on("resource_session.outbound.failed",b.bind(m,null,this)),this._mediator.on("resource_session.outbound.deleted",b.bind(n,null,this)),this._mediator.on("resource_session.work_mode.created",b.bind(o,null,this)),this._mediator.on("resource_session.work_mode.updated",b.bind(p,null,this)),this._mediator.on("resource_session.work_mode.deleted",b.bind(q,null,this)),this._mediator.on("user.registration.successful",b.bind(r,null,this)),this._mediator.on("user.registration.failed",b.bind(s,null,this)),this._mediator.on("deferred.interaction",b.bind(t,null,this)),this._mediator.on("deferred.interaction.delete",b.bind(u,null,this)),this._started=!0)},stop:function(a){this._started&&this._mediator&&(this._mediator.stop(a),this._mediator.removeListeners("error"),this._mediator.removeListeners("close"),this._mediator.removeListeners("clientsession"),this._mediator.removeListeners("resource"),this._mediator.removeListeners("resource_session"),this._mediator.removeListeners("user"),this._mediator.removeListeners("deferred"),this.removeContacts(),this.removeTeam(),this.removeWork(),this.removeAgent(),this.removeCallbacks(),this._started=!1)},setToken:function(a){var b=this._prerequisites.find({id:"tokenCollection"});b.data&&b.data.edit(a)},setData:function(a){return a&&a.reasonCodes&&b.forEach(a.reasonCodes,b.bind(function(a){this._reasonCodes.add(a)},this)),b.updateByDeep(this,a)},setConfig:function(a){b.forEach(a,b.bind(function(a,b){this._config[b]=a,this._providers.createProvider(this._prerequisites,a,b)},this))},getConfiguration:function(a){var b=this._providers.getMediator();return b&&b.getConfiguration(a)},createAgent:function(b){var c=this._providers.getMediator(),d=new a.Services.Agent.AgentService(c);return this._agent=new a.Services.Agent.Agent(d),this._agent.setHandle(b),d.init(this._agent),this._agent},removeAgent:function(){this._agent&&(this._agent.removeCallbacks(),this._agent.getDevices().removeCallbacks(),this._agent=void 0)},getAgent:function(){return this._agent},createWork:function(){var b=this._providers.getMediator(),c=new a.Services.Work.WorkService(b,this._agent),d=new a.Services.Work.InteractionCollection(c),e=new a.Services.Work.WorkRequestCollection(d);return this._work=new a.Services.Work.Work(c,e,d),c.init(this._work,e,d),this._work},removeWork:function(){this._work&&(this._work.removeCallbacks(),this._work=void 0)},getWork:function(){return this._work},createTeam:function(){var b=this._providers.getMediator(),c=new a.Services.Team.TeamService(b,this._agent),d=new a.Services.Team.TeamCollection(c);return this._team=new a.Services.Team.Team(c,d),c.init(this._team,d),this._team},removeTeam:function(){this._team&&(this._team.removeCallbacks(),this._team=void 0)},getTeam:function(){return this._team},createContacts:function(){
var b=this._providers.getMediator(),c=new a.Services.Contacts.ContactsService(b);return this._contacts=new a.Services.Contacts.Contacts(c),c.init(this._contacts),this._contacts},removeContacts:function(){this._contacts&&(this._contacts.removeCallbacks(),this._contacts=void 0)},getContacts:function(){return this._contacts},getReasonCodes:function(){return this._reasonCodes},addOnCloseCallback:function(a){this._onClose.add(a)},addOnErrorCallback:function(a){this._onError.add(a)},addOnClientSessionStartedCallback:function(a){this._onClientSessionStarted.add(a)},addOnClientSessionRestartedCallback:function(a){this._onClientSessionRestarted.add(a)},addOnClientSessionClosedCallback:function(a){this._onClientSessionClosed.add(a)},addOnResourceAcquiredCallback:function(a){this._onResourceAcquired.add(a)},addOnResourceReleasedCallback:function(a){this._onResourceReleased.add(a)},addOnResourceSessionOutboundConnectedCallback:function(a){this._onResourceSessionOutboundConnected.add(a)},addOnResourceSessionOutboundNotConnectedCallback:function(a){this._onResourceSessionOutboundNotConnected.add(a)},addOnResourceSessionOutboundFailedCallback:function(a){this._onResourceSessionOutboundFailed.add(a)},addOnResourceSessionOutboundDeletedCallback:function(a){this._onResourceSessionOutboundDeleted.add(a)},addOnResourceSessionWorkModeCreatedCallback:function(a){this._onResourceSessionWorkModeCreated.add(a)},addOnResourceSessionWorkModeUpdatedCallback:function(a){this._onResourceSessionWorkModeUpdated.add(a)},addOnResourceSessionWorkModeDeletedCallback:function(a){this._onResourceSessionWorkModeDeleted.add(a)},addOnUserRegistrationSuccessfulCallback:function(a){this._onUserRegistrationSuccessful.add(a)},addOnUserRegistrationFailedCallback:function(a){this._onUserRegistrationFailed.add(a)},addOnDeferredInteractionCallback:function(a){this._onDeferredInteraction.add(a)},addOnRemoveDeferredInteractionCallback:function(a){this._onRemoveDeferredInteraction.add(a)},removeCallbacks:function(){this._onClose.empty(),this._onError.empty(),this._onClientSessionStarted.empty(),this._onClientSessionRestarted.empty(),this._onClientSessionClosed.empty(),this._onResourceAcquired.empty(),this._onResourceReleased.empty(),this._onResourceSessionOutboundConnected.empty(),this._onResourceSessionOutboundNotConnected.empty(),this._onResourceSessionOutboundFailed.empty(),this._onResourceSessionOutboundDeleted.empty(),this._onResourceSessionWorkModeCreated.empty(),this._onResourceSessionWorkModeUpdated.empty(),this._onResourceSessionWorkModeDeleted.empty(),this._onUserRegistrationSuccessful.empty(),this._onUserRegistrationFailed.empty(),this._onDeferredInteraction.empty(),this._onRemoveDeferredInteraction.empty()}},a.ClientSession=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Base.Collections.Model.call(this,b)}c.prototype={},b.defaults(c.prototype,a.Base.Collections.Model.prototype),a.ClientSession.ReasonCode=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(){a.Base.Collections.Collection.call(this,a.ClientSession.ReasonCode,{idAttribute:"code"})}c.prototype={findByFriendlyName:function(a){return this.find(function(b){return b.data.friendlyName===a})},findAllByType:function(a){return this.findAll(function(b){return b.data.type===a})}},b.defaults(c.prototype,a.Base.Collections.Collection.prototype),a.ClientSession.ReasonCodeCollection=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(a){this.id=a.getUniqueAddressForMatching(),this.alias=a.getAlias().getValue(),this.displayName=a.getDisplayName().getValue(),this.firstName=a.getFirstName().getValue(),this.lastName=a.getLastName().getValue(),this.city=a.getCity().getValue(),this.company=a.getCompany().getValue(),this.country=a.getCountry().getValue(),this.department=a.getDepartment().getValue(),this.emailAddresses=e(a.getEmailAddresses().getValues()),this.language=a.getLanguage().getValue(),this.location=a.getLocation().getValue(),this.manager=a.getManager().getValue(),this.phoneNumbers=d(a.getPhoneNumbers().getValues()),this.postalCode=a.getPostalCode().getValue(),this.rank=a.getRank().getValue(),this.state=a.getState().getValue(),this.streetAddress=a.getStreetAddress().getValue(),this.workRoomNumber=a.getWorkRoomNumber().getValue(),this.isFavorite=a.isFavorite().getValue()}function d(a){var c=[];return b.forEach(a,function(a){var b=!1,d=a.getPhoneNumber();if(d){d=d.replace(/([0-9]+)@.*/g,"$1");for(var e=0;e<c.length;++e)if(c[e].number===d){a.isDefault()&&(c[e].isDefault=!0),b=!0;break}}b||c.push({number:d,type:a.getPhoneNumberType(),isDefault:a.isDefault()})}),c}function e(a){var c=[];return b.forEach(a,function(a){c.push({address:a.getAddress(),type:a.getEmailAddressType(),isDefault:a.isDefault()})}),c}c.prototype={},a.Services.Contacts.Contact=c}(AvayaCustomerServices,_),function(a){"use strict";function b(b){this._contactsService=b,this._onContactsAvailable=new a.Base.Callbacks,this._onContactsUnavailable=new a.Base.Callbacks,this._onContactsSearchResultsUpdated=new a.Base.Callbacks,this._onContactsSearchCompleted=new a.Base.Callbacks,this._onContactsSearchFailed=new a.Base.Callbacks}b.prototype={addOnContactsAvailableCallback:function(a){this._onContactsAvailable.add(a)},addOnContactsUnavailableCallback:function(a){this._onContactsUnavailable.add(a)},addOnContactsSearchResultsUpdatedCallback:function(a){this._onContactsSearchResultsUpdated.add(a)},addOnContactsSearchFailedCallback:function(a){this._onContactsSearchFailed.add(a)},addOnContactsSearchCompletedCallback:function(a){this._onContactsSearchCompleted.add(a)},isContactsServiceAvailable:function(){return this._contactsService.isContactsServiceAvailable()},search:function(a,b){return this._contactsService.search(a,b)},cancelSearch:function(){return this._contactsService.cancelSearch()},removeCallbacks:function(){return this._onContactsAvailable.empty(),this._onContactsUnavailable.empty(),this._onContactsSearchResultsUpdated.empty(),this._onContactsSearchCompleted.empty(),this._onContactsSearchFailed.empty(),this._contactsService.stop()}},a.Services.Contacts.Contacts=b}(AvayaCustomerServices),function(a,b){"use strict";function c(b){a.Base.Collections.Model.call(this),this._newContacts=b}c.prototype={getNewContacts:function(){return this._newContacts}},b.defaults(c.prototype,a.Base.Collections.Model.prototype),a.Services.Contacts.ContactSearchUpdate=c}(AvayaCustomerServices,_),function(a){"use strict";function b(a){this._started=!1,this._contactsProvider=a}function c(a){a._onContactsAvailable.fire()}function d(a){a._onContactsUnavailable.fire()}function e(b,c,d){var e=h(d.getNewContacts()),f=new a.Services.Contacts.ContactSearchUpdate(e);b._onContactsSearchResultsUpdated.fire(c,f)}function f(a,b,c){a._onContactsSearchFailed.fire(b,c)}function g(a,b,c){var d=h(c);a._onContactsSearchCompleted.fire(b,d)}function h(b){var c=[];for(var d in b)b.hasOwnProperty(d)&&(c[d]=new a.Services.Contacts.Contact(b[d]));return c}b.prototype={init:function(a){this._started=!0,this._contactsProvider.on("contacts.service.available",_.bind(c,null,a)),this._contactsProvider.on("contacts.service.unavailable",_.bind(d,null,a)),this._contactsProvider.trigger("user.startContactsService"),this._contactsProvider.on("contacts.search.update",_.bind(e,null,a)),this._contactsProvider.on("contacts.search.failed",_.bind(f,null,a)),this._contactsProvider.on("contacts.search.complete",_.bind(g,null,a))},stop:function(){this._started=!1,this._contactsProvider.removeListeners("contacts"),this._contactsProvider.trigger("user.stopContactsService")},isContactsServiceAvailable:function(){return this._contactsProvider.isContactsServiceAvailable()},search:function(b,c){var d=a.Providers.CP.ContactSearchCriteria.Fields.ALL,e=new a.Providers.CP.ContactSearchCriteria(b,d,c);return this._contactsProvider.searchContacts(e)},cancelSearch:function(){return this._contactsProvider.cancelContactsSearch()}},a.Services.Contacts.ContactsService=b}(AvayaCustomerServices),function(a){"use strict";function b(b,c){this._teamService=b,this._teamCollection=c,this._onTeamMembersAdded=new a.Base.Callbacks,this._onTeamGroupsAdded=new a.Base.Callbacks}b.prototype={getMember:function(a){return this._teamCollection.find({userHandle:a})},getMembers:function(){return this._teamCollection.findAll()},getSupervisors:function(){return this._teamCollection.getSupervisors()},getAgents:function(){return this._teamCollection.getAgents()},getTeamState:function(a){return this._teamService.getTeamState(a)},setTeamMonitoring:function(a,b){return this._teamService.setTeamMonitoring(a,b)},setTeamMemberMonitoring:function(a,b,c){return this._teamService.setTeamMemberMonitoring(a,b,c)},observeMemberInteraction:function(a){return this._teamService.startObserving(a)},forceEndMemberInteraction:function(a){return this._teamService.forceEndMemberInteraction(a)},endObserveMemberInteraction:function(a){return this._teamService.stopObserving(a)},coach:function(a){return this._teamService.coach(a)},bargeIn:function(a){return this._teamService.bargeIn(a)},broadcast:function(a){return this._teamService.broadcast(a)},addOnTeamMembersAddedCallback:function(a){this._onTeamMembersAdded.add(a)},addOnTeamGroupsAddedCallback:function(a){this._onTeamGroupsAdded.add(a)},removeCallbacks:function(){return this._onTeamMembersAdded.empty(),this._onTeamGroupsAdded.empty(),this._teamService.stop()}},a.Services.Team.Team=b}(AvayaCustomerServices),function(a,b){"use strict";function c(b){a.Base.Collections.Collection.call(this,a.Services.Team.TeamMember),this._teamService=b}c.prototype={add:function(a){var b=new this._model(this._teamService);return b.id=a.id,b.setData(a),this._collection.push(b),b},getSupervisors:function(){return this.findAll({type:"SUPERVISOR"})},getAgents:function(){return this.findAll({type:"AGENT"})},getSelf:function(){return this.find({isSelf:!0})}},b.defaults(c.prototype,a.Base.Collections.Collection.prototype),a.Services.Team.TeamCollection=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b,c){a.Base.Collections.Model.call(this,c),this._teamService=b,this.id=void 0,this.displayName=void 0,this.resourceAddress=void 0,this.firstName=void 0,this.lastName=void 0,this.type=void 0,this.address=void 0,this.userHandle=void 0,this.state=void 0,this.stateReason=void 0,this.isConnected=void 0,this.disconnectedTime=void 0,this.channels=[],this.interactions=[],this.deferredInteractions=[],this.capabilities={},this.groups=null,this.isSelf=void 0}function d(a,c){var d=c&&c.newValue&&c.newValue[0]||{};return b.assignSafe(a,{capabilities:d.capabilities,state:d.state,stateReason:d.stateReason,isConnected:d.isConnected,disconnectedTime:d.disconnectedTime}),b.mergeArrayWith(a.channels,d.channels,"id"),b.mergeArrayWith(a.interactions,d.interactions,"id"),d}c.prototype={observe:function(a){return this._teamService.startObserving(a)},stopObserving:function(a){return this._teamService.stopObserving(a)},bargeIn:function(a){return this._teamService.bargeIn(a)},getInteractions:function(){return this._teamService.getInteractions(this)},getState:function(){return this._teamService.getState(this).then(b.bind(d,null,this))},logout:function(a){return this._teamService.logout(this,a).then(b.bind(d,null,this))},goReady:function(){return this._teamService.goReady(this).then(b.bind(d,null,this))},goNotReady:function(a){return this._teamService.goNotReady(this,a).then(b.bind(d,null,this))},deactivate:function(){return this._teamService.deactivate(this).then(b.bind(d,null,this))},setData:function(a){return b.assignIn(this,{address:a.accountId}),b.assignSafe(this,a)}},b.defaults(c.prototype,a.Base.Collections.Model.prototype),a.Services.Team.TeamMember=c}(AvayaCustomerServices,_),function(a){"use strict";function b(a,b){this._started=!1,this._teamProvider=a,this._agent=b,this._teamCollection=void 0}function c(a,b,c){var d=[];c=c||{},c.members&&c.members.length&&(_.forEach(c.members,function(a){d.push(b.add(a))}),a._onTeamMembersAdded.fire(d),c.groups&&a._onTeamGroupsAdded.fire({role:c.role,members:d,groups:c.groups}))}b.prototype={init:function(a,b){this._started=!0,this._teamCollection=b,this._teamProvider.on("team.state.updated",_.bind(c,null,a,b)),this._teamProvider.on("team.member.details.updated",_.bind(c,null,a,b))},stop:function(){this._started=!1,this._teamProvider.removeListeners("team")},startObserving:function(a){var b=this._agent.getHandle();return this._teamProvider.startObserving(b,a.userHandle,a.id)},stopObserving:function(a){var b=this._agent.getHandle();return this._teamProvider.stopObserving(b,a.teamMemberUserHandle,a.id)},forceEndMemberInteraction:function(a){var b=this._agent.getHandle(),c={forceEnd:!0};return this._teamProvider.endMemberInteraction(b,a.userHandle,a.workRequestId,a.id,c)},coach:function(a){var b=this._agent.getHandle();return this._teamProvider.coach(b,a.workRequestId,a.id)},bargeIn:function(a){var b=this._agent.getHandle();return this._teamProvider.bargeIn(b,a.workRequestId,a.id)},broadcast:function(a){var b=this._agent.getHandle(),c=JSON.stringify(a);return this._teamProvider.broadcast(b,c)},getTeamState:function(a){var b=this._agent.getHandle();this._teamProvider.getTeamState(b,a)},getState:function(a){var b=this._agent.getHandle(),c=this._agent.getRole();return this._teamProvider.getTeamMemberState(b,c,a.userHandle)},setTeamMonitoring:function(a,b){var c=this._agent.getHandle();return this._teamProvider.setTeamMonitoring(c,a,b)},setTeamMemberMonitoring:function(a,b){var c=this._agent.getHandle();return this._teamProvider.setTeamMemberMonitoring(c,a,b)},logout:function(a,b){var c=this._agent.getHandle();return this._teamProvider.logoutTeamMember(c,a.userHandle,b)},goReady:function(a){var b=this._agent.getHandle();return this._teamProvider.goReadyTeamMember(b,a.userHandle)},goNotReady:function(a,b){var c=this._agent.getHandle();return this._teamProvider.goNotReadyTeamMember(c,a.userHandle,b)},deactivate:function(a){return this._teamProvider.deactivateTeamMember(a.userHandle)}},a.Services.Team.TeamService=b}(AvayaCustomerServices),function(a,b){"use strict";function c(b){a.Base.Collections.Model.call(this),this._workService=b,this.workRequestId=void 0,this._interactionContext=void 0,this._interactionMedia=void 0,this._participants=[],this._videoStreams=[],this._onActive=new a.Base.Callbacks,this._onUnknown=new a.Base.Callbacks,this._onHeld=new a.Base.Callbacks,this._onUnheld=new a.Base.Callbacks,this._onACW=new a.Base.Callbacks,this._onACWPending=new a.Base.Callbacks,this._onPassive=new a.Base.Callbacks,this._onUpdated=new a.Base.Callbacks,this._onEnded=new a.Base.Callbacks,this._onRemoteParticipantAccepted=new a.Base.Callbacks,this._onMediaAdded=new a.Base.Callbacks,this._onContextAdded=new a.Base.Callbacks,this._onContextRemoved=new a.Base.Callbacks,this._onVideoUpdated=new a.Base.Callbacks,this._onAudioUpdated=new a.Base.Callbacks,this._onSpeakerUpdated=new a.Base.Callbacks,this._servicesRequestCache=null}c.prototype={accept:function(){return this._workService.accept(this)},end:function(){return this._workService.end(this)},forceEnd:function(){return this._workService.end(this,{forceEnd:!0})},defer:function(a,b,c,d){return this._workService.defer(this,a,b,c,d)},deferForward:function(a,b,c,d){return this._workService.deferForward(this,a,b,c,d)},hold:function(){return this._workService.hold(this)},unhold:function(){return this._workService.unhold(this)},consult:function(a,b){return this._workService.consult(this,a,b)},completeTransfer:function(){return this._workService.consultCompleteAsTransfer(this)},completeConference:function(){return this._workService.consultCompleteAsConference(this)},extendACW:function(){return this._workService.extendACW(this)},completeACW:function(){return this._workService.completeACW(this)},isHeldRemotely:function(){},isRemote:function(){},join:function(a){},reject:function(){return this._workService.reject(this)},sendDTMF:function(a){return this._workService.sendDTMF(this,a)},setWorkCode:function(a){return this._workService.setWorkCode(this,a)},setDispositionCode:function(a){return this._workService.setDispositionCode(this,a)},singleStepTransfer:function(a){return this._workService.transfer(this,a)},singleStepTransferToService:function(a){return this._workService.transferToService(this,a)},singleStepTransferToUser:function(a){return this._workService.transferToUser(this,a)},consultToService:function(a,b){return this._workService.consultToService(this,a,b)},getServices:function(a){return a&&this._servicesRequestCache||(this._servicesRequestCache=this._workService.getServices(this)),this._servicesRequestCache},getUsers:function(a){return this._workService.getUsers(this,a)},getWorkRequestId:function(){return this.data.workRequestId||null},getCapabilities:function(){return this.data.capabilities||{}},getInteractionContext:function(){return this._interactionContext},getInteractionMedia:function(){return this._interactionMedia},getTopic:function(){return this.data.topic},getState:function(){return this.data.state},getOriginatingAddress:function(){return this.data.originatingAddress},getDestinationAddress:function(){return this.data.destinationAddress},getDirection:function(){return this.data.direction},getRemoteParticipant:function(){return this.isIncoming()?this.getOriginatingAddress():this.getDestinationAddress()},getCall:function(){return this._workService.getCall(this)},isIncoming:function(){return"INCOMING"===this.data.direction},isCustomerInteraction:function(){return!!this.data.isCustomerInteraction},getWorkCode:function(){return this.data.workCode},getDispositionCode:function(){return this.data.dispositionCode},muteAudio:function(){return this._workService.muteAudio(this)},unmuteAudio:function(){return this._workService.unmuteAudio(this)},isAudioMuted:function(){return this.data.audioMuted},setVideoMode:function(a){return this._workService.setVideoMode(this,a)},enableLocalVideo:function(){return this._workService.enableLocalVideo(this)},disableLocalVideo:function(){return this._workService.disableLocalVideo(this)},getLocalVideoStream:function(){return b.find(this._videoStreams,{direction:"local"})},getRemoteVideoStream:function(){return b.find(this._videoStreams,{direction:"remote"})},setData:function(a){return b.assignSafe(this,{workRequestId:a.workRequestId,participants:a.participants}),this.isNew=b.isEmpty(this.data),b.assignIn(this.data,a)},addOnInteractionActiveCallback:function(a){this._onActive.add(a)},addOnInteractionUnknownCallback:function(a){this._onUnknown.add(a)},addOnInteractionHeldCallback:function(a){this._onHeld.add(a)},addOnInteractionUnheldCallback:function(a){this._onUnheld.add(a)},addOnInteractionACWCallback:function(a){this._onACW.add(a)},addOnInteractionACWPendingCallback:function(a){this._onACWPending.add(a)},addOnInteractionPassiveCallback:function(a){this._onPassive.add(a)},addOnInteractionUpdatedCallback:function(a){this._onUpdated.add(a)},addOnInteractionEndedCallback:function(a){this._onEnded.add(a)},addOnRemoteParticipantAcceptedCallback:function(a){this._onRemoteParticipantAccepted.add(a)},addOnInteractionMediaAddedCallback:function(a){this._onMediaAdded.add(a)},addOnInteractionContextAddedCallback:function(a){this._onContextAdded.add(a)},addOnInteractionContextRemovedCallback:function(a){this._onContextRemoved.add(a)},addOnInteractionAudioUpdatedCallback:function(a){this._onAudioUpdated.add(a)},addOnInteractionSpeakerUpdatedCallback:function(a){this._onSpeakerUpdated.add(a)},addOnInteractionVideoUpdatedCallback:function(a){this._onVideoUpdated.add(a)}},b.defaults(c.prototype,a.Base.Collections.Model.prototype),a.Services.Work.Interaction=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Base.Collections.Collection.call(this,a.Services.Work.Interaction),this._workService=b}c.prototype={add:function(a){var b=new this._model(this._workService);return b.id=a.id,b.setData(a),this._collection.push(b),b}},b.defaults(c.prototype,a.Base.Collections.Collection.prototype),a.Services.Work.InteractionCollection=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(){a.Base.Collections.Model.call(this)}c.prototype={mergeData:function(a){var c=this;return b.forEach(a,function(a,d){a&&b.isArray(a)&&b.has(c.data,d)&&b.forEach(a,function(a){c.data[d].push(a)})}),c.data},removeData:function(a){return b.forEach(a,b.bind(function(a,c){if(a&&b.has(this.data,c)&&b.isArray(this.data[c])){var d=b.find(this.data[c],a),e=b.indexOf(this.data[c],d);e!==-1&&this.data[c].splice(e,1)}},this)),this.data}},b.defaults(c.prototype,a.Base.Collections.Model.prototype),a.Services.Work.InteractionContext=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Base.Collections.Model.call(this),this._workService=b,this.interactionId=void 0,this.participants=[],this.messages=[],this.notifications=[],this.attachments=[],this._onMessageAdded=new a.Base.Callbacks,this._onForwardSent=new a.Base.Callbacks,this._onEmailFileLimitExceeded=new a.Base.Callbacks,this._onAttachmentAdded=new a.Base.Callbacks,this._onAttachmentRemoved=new a.Base.Callbacks,this._onParticipantsListed=new a.Base.Callbacks,this._onParticipantAdded=new a.Base.Callbacks,this._onParticipantRemoved=new a.Base.Callbacks,this._onIsTyping=new a.Base.Callbacks,this._onPagePushUrl=new a.Base.Callbacks,this._onFileTransferred=new a.Base.Callbacks,this._onCustomerDownloadInitiated=new a.Base.Callbacks,this._onCustomerDownloadComplete=new a.Base.Callbacks,this._onConnected=new a.Base.Callbacks,this._onDisconnected=new a.Base.Callbacks}c.prototype={send:function(a,b){return this._workService.sendMessage(this,a,b)},sendRichMedia:function(a,b,c){return this._workService.sendRichMediaMessage(this,a,b,c)},sendEmail:function(a){return this._workService.sendEmailMessage(this,a)},sendPagePushUrl:function(a,b){return this._workService.sendPagePushUrl(this,a,b)},sendCoBrowseSessionKey:function(a){return this._workService.sendCoBrowseSessionKey(this,a)},reportTyping:function(a){return this._workService.reportTyping(this,a)},setMessageImportance:function(){},setSensitivity:function(){},getFromParticipant:function(){},getImportance:function(){},getAttachments:function(){return this.attachments},getParticipants:function(){return this.participants},getBody:function(){},getTranscript:function(){},getType:function(){},markAsRead:function(){},addAttachment:function(){},removeAttachments:function(a){return this._workService.removeAttachments(this,a)},applyDraftAttachments:function(){return this._workService.applyDraftAttachments(this)},applyForwardAttachments:function(){return this._workService.applyForwardAttachments(this)},isRead:function(){},isPrivate:function(){},isDoNotForward:function(){},isFromMe:function(){},setData:function(a){return b.isUndefined(this.id)&&!b.isUndefined(a[this._id])&&(this.id=a[this._id]),b.assignSafe(this,{interactionId:a.interactionId,participants:a.participants,messages:a.messages,attachments:a.attachments}),b.assignIn(this.data,a)},addMessageReceivedCallback:function(a){this._onMessageAdded.add(a)},addOnForwardSentCallback:function(a){this._onForwardSent.add(a)},addOnEmailFileLimitExceededCallback:function(a){this._onEmailFileLimitExceeded.add(a)},addOnAttachmentAddedCallback:function(a){this._onAttachmentAdded.add(a)},addOnAttachmentRemovedCallback:function(a){this._onAttachmentRemoved.add(a)},addOnDoNotForwardStatusChangedCallback:function(a){},addOnHasAttachmentStatusChangedCallback:function(a){},addOnImportanceChangedCallback:function(a){},addOnIsReadStatusChangedCallback:function(a){},addOnSensitivityChangedCallback:function(a){},addOnTypeChangedCallback:function(a){},addOnParticipantsListedCallback:function(a){this._onParticipantsListed.add(a)},addOnParticipantAddedCallback:function(a){this._onParticipantAdded.add(a)},addOnParticipantRemovedCallback:function(a){this._onParticipantRemoved.add(a)},addOnIsTypingCallback:function(a){this._onIsTyping.add(a)},addOnPagePushUrlCallback:function(a){this._onPagePushUrl.add(a)},addOnFileTransferredCallback:function(a){this._onFileTransferred.add(a)},addOnCustomerDownloadInitiatedCallback:function(a){this._onCustomerDownloadInitiated.add(a)},addOnCustomerDownloadCompleteCallback:function(a){this._onCustomerDownloadComplete.add(a)},addOnConnectedCallback:function(a){this._onConnected.add(a)},addOnDisconnectedCallback:function(a){this._onDisconnected.add(a)}},b.defaults(c.prototype,a.Base.Collections.Model.prototype),a.Services.Work.InteractionMedia=c}(AvayaCustomerServices,_),function(a){"use strict";function b(b,c,d){this._workService=b,this._workRequestCollection=c,this._interactionCollection=d,this._onCreated=new a.Base.Callbacks,this._onDeleted=new a.Base.Callbacks}b.prototype={createInteraction:function(a,b,c){return this._workService.start(a,b,c)},retrieveDeferredInteraction:function(a){return this._workService.retrieveDeferredInteraction(a)},removeDeferredInteraction:function(a){return this._workService.removeDeferredInteraction(a)},getInteractionCount:function(){},hasActiveInteraction:function(){},hasActiveLocalInteraction:function(){},hasHeldInteraction:function(){},hasInitiatingInteraction:function(){},isAutoAnswerAdministered:function(){},getWorkRequests:function(){return this._workRequestCollection},getInteractions:function(){return this._interactionCollection},addOnInteractionCreatedCallback:function(a){this._onCreated.add(a)},addOnInteractionDeletedCallback:function(a){this._onDeleted.add(a)},removeCallbacks:function(){return this._onCreated.empty(),this._onDeleted.empty(),this._workService.stop()}},a.Services.Work.Work=b}(AvayaCustomerServices),function(a,b){"use strict";function c(b,c){a.Base.Collections.Model.call(this,c),this._interactionCollection=b,this._workRequestContext=new a.Services.Work.WorkRequestContext,this.interactions=[]}c.prototype={getInteractions:function(){return this._interactionCollection.findAll({data:{workRequestId:this.id}})},setData:function(a){return b.isUndefined(this.id)&&!b.isUndefined(a[this._id])&&(this.id=a[this._id]),this.isNew=b.isEmpty(this.data),this.interactions=this.getInteractions(),b.assignIn(this.data,a)}},b.defaults(c.prototype,a.Base.Collections.Model.prototype),a.Services.Work.WorkRequest=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Base.Collections.Collection.call(this,a.Services.Work.WorkRequest,{idAttribute:"workRequestId"}),this._interactionCollection=b}c.prototype={add:function(a){var b=this.find({id:a[this._modelId]});return b||(b=new this._model(this._interactionCollection,this._modelOptions),b.setData(a),this._collection.push(b)),b},remove:function(a){var c=this.findIndex({id:a[this._modelId]});if(c===-1)throw new Error("Could not find Work Request Model with id: "+a[this._modelId]);var d=this._collection[c];return 0===b.size(d.getInteractions())&&this._collection.splice(c,1),d}},b.defaults(c.prototype,a.Base.Collections.Collection.prototype),a.Services.Work.WorkRequestCollection=c}(AvayaCustomerServices,_),function(a){"use strict";function b(){}b.prototype={},a.Services.Work.WorkRequestContext=b}(AvayaCustomerServices),function(a,b){"use strict";function c(a,b){this._started=!1,this._interactionsProvider=a,this._agent=b}function d(b,c,d,e){d.add(e),c.add(e),b._onCreated.fire(e),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionCreated",message:e})}function e(b,c,d,e){var f=d.edit(e);f.isNew&&(c.add(e),b._onCreated.fire(e)),f._onActive.fire(e),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionActive",message:e})}function f(b,c,d,e){var f=d.edit(e);f._onUnknown.fire(e),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionUnknown",message:e})}function g(b,c,d,e){var f=d.edit(e);f.isNew&&(c.add(e),b._onCreated.fire(e)),f._onHeld.fire(e),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionHeld",message:e})}function h(b,c,d,e){var f=d.edit(e);f.isNew&&(c.add(e),b._onCreated.fire(e)),f._onACW.fire(e),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionACW",message:e})}function i(b,c,d,e){var f=d.edit(e);f.isNew&&(c.add(e),b._onCreated.fire(e)),f._onACWPending.fire(e),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionACWPending",message:e})}function j(b,c,d,e){var f=d.edit(e);f.isNew&&(c.add(e),b._onCreated.fire(e)),f._onPassive.fire(e),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionPassive",message:e})}function k(b,c,d,e){var f=d.edit(e);f.isNew&&(c.add(e),b._onCreated.fire(e)),f._onUpdated.fire(e),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionUpdated",message:e})}function l(b,c,d,e){var f=d.remove(e);if(!f)throw new Error("Could not find Interaction with ID: "+e.id);c.remove({workRequestId:f.workRequestId}),f._onEnded.fire(e),b._onDeleted.fire(e),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionDeleted",message:e})}function m(b,c){var d=b.find({id:c.id});if(!d)throw new Error("Could not find Interaction with ID: "+c.id);d._onRemoteParticipantAccepted.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onRemoteParticipantAccepted",message:c})}function n(b,c,d){var e=c.find({id:d.interactionId});if(!e)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaCreated",message:"Could not find Interaction with ID: "+d.interactionId}),new Error("Could not find Interaction with ID: "+d.interactionId);var f=new a.Services.Work.InteractionMedia(b);f.setData(d),e._interactionMedia=f,e._onMediaAdded.fire(d),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaCreated",message:d})}function o(b,c){var d=b.find(function(a){return a._interactionMedia&&a._interactionMedia.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaMessageCreated",message:"Could not find Interaction with an associated InteractionMedia with ID: "+c.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+c.id);c.interactionId=d.id;var e=d.getInteractionMedia();e.messages.push(c.message),e._onMessageAdded.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaMessageCreated",message:c})}function p(b,c){var d=b.find(function(a){return a._interactionMedia&&a._interactionMedia.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaMessageIsTyping",message:"Could not find Interaction with an associated InteractionMedia with ID: "+c.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+c.id);c.interactionId=d.id;var e=d.getInteractionMedia();e.notifications.push(c),e._onIsTyping.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaMessageIsTyping",message:c})}function q(b,c){var d=b.find(function(a){return a._interactionMedia&&a._interactionMedia.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaParticipantJoined",message:"Could not find Interaction with an associated InteractionMedia with ID: "+c.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+c.id);c.interactionId=d.id;var e=d.getInteractionMedia();e.notifications.push(c),e._onParticipantAdded.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaParticipantJoined",message:c})}function r(b,c){var d=b.find(function(a){return a._interactionMedia&&a._interactionMedia.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaParticipantLeft",message:"Could not find Interaction with an associated InteractionMedia with ID: "+c.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+c.id);c.interactionId=d.id;var e=d.getInteractionMedia();e.notifications.push(c),e._onParticipantRemoved.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaParticipantLeft",message:c})}function s(b,c){var d=b.find(function(a){
return a._interactionMedia&&a._interactionMedia.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaParticipantList",message:"Could not find Interaction with an associated InteractionMedia with ID: "+c.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+c.id);c.interactionId=d.id;var e=d.getInteractionMedia();e.notifications.push(c),e._onParticipantsListed.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaParticipantList",message:c})}function t(b,c){var d=b.find({id:c.interactionId});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionContextCreated",message:"Could not find Interaction with ID: "+c.interactionId}),new Error("Could not find Interaction with ID: "+c.interactionId);var e=d.getInteractionContext();e?e.mergeData(c):(e=new a.Services.Work.InteractionContext,e.setData(c),d._interactionContext=e),d._onContextAdded.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionContextCreated",message:c})}function u(b,c){var d=b.find(function(a){return a._interactionContext&&a._interactionContext.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionContextUpdated",message:"Could not find Interaction with ID: "+c.interactionId}),new Error("Could not find Interaction with an associated InteractionContext with ID: "+c.id);c.interactionId=d.id;var e=d.getInteractionContext();e?e.mergeData(c):(e=new a.Services.Work.InteractionContext,e.setData(c),d._interactionContext=e),d._onContextAdded.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionContextUpdated",message:c})}function v(b,c){var d=b.find(function(a){return a._interactionContext&&a._interactionContext.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionContextDeleted",message:"Could not find Interaction with an associated InteractionContext with ID: "+c.id}),new Error("Could not find Interaction with an associated InteractionContext with ID: "+c.id);c.interactionId=d.id;var e=d.getInteractionContext();e&&e.removeData(c),d._onContextRemoved.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionContextDeleted",message:c})}function w(b,c){var d=b.find(function(a){return a._interactionMedia&&a._interactionMedia.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaPagePush",message:"Could not find Interaction with an associated InteractionContext with ID: "+c.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+c.id);c.interactionId=d.id;var e=d.getInteractionMedia();e.messages.push(c.message),e._onPagePushUrl.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaPagePush",message:c})}function x(b,c){var d=b.find(function(a){return a._interactionMedia&&a._interactionMedia.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaForwardSent",message:"Could not find Interaction with an associated InteractionMedia with ID: "+c.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+c.id);c.interactionId=d.id;var e=d.getInteractionMedia();e.messages.push(c.message),e._onForwardSent.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaForwardSent",message:c})}function y(b,c){var d=b.find(function(a){return a._interactionMedia&&a._interactionMedia.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaEmailFileLimitExceeded",message:"Could not find Interaction with an associated InteractionMedia with ID: "+c.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+c.id);c.interactionId=d.id;var e=d.getInteractionMedia();e.messages.push(c.message),e._onEmailFileLimitExceeded.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaEmailFileLimitExceeded",message:c})}function z(b,c){var d=b.find(function(a){return a._interactionMedia&&a._interactionMedia.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaEmailMessage",message:"Could not find Interaction with an associated InteractionContext with ID: "+c.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+c.id);c.interactionId=d.id;var e=d.getInteractionMedia();e.messages.push(c.message),e._onMessageAdded.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaEmailMessage",message:c})}function A(c,d){if(d.attachments&&d.attachments.length){var e=c.find(function(a){return a._interactionMedia&&a._interactionMedia.id===d.id});if(!e)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaEmailAttachmentsAdded",message:"Could not find Interaction with an associated InteractionContext with ID: "+d.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+d.id);d.interactionId=e.id;var f=e.getInteractionMedia();b.forEach(d.attachments,function(a){f.attachments.push(a)}),f._onAttachmentAdded.fire(d),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaEmailAttachmentsAdded",message:d})}}function B(c,d){if(d.attachments&&d.attachments.length){var e=c.find(function(a){return a._interactionMedia&&a._interactionMedia.id===d.id});if(!e)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaEmailAttachmentsRemoved",message:"Could not find Interaction with an associated InteractionContext with ID: "+d.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+d.id);d.interactionId=e.id;var f=e.getInteractionMedia();b.forEach(d.attachments,function(a){var c=b.find(f.attachments,{partId:a.partId});if(c){var d=b.indexOf(f.attachments,c);f.attachments.splice(d,1)}}),f._onAttachmentRemoved.fire(d),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaEmailAttachmentsRemoved",message:d})}}function C(c,d){var e=c.find(function(a){return a._interactionMedia&&a._interactionMedia.id===d.id});if(!e)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaTransferredFile",message:"Could not find Interaction with an associated InteractionContext with ID: "+d.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+d.id);var f=e.getInteractionMedia();b.forEach(d.attachments,function(a){f.attachments.push(a)}),f.messages.push(d.message),f._onFileTransferred.fire(d),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaTransferredFile",message:d})}function D(b,c){var d=b.find(function(a){return a._interactionMedia&&a._interactionMedia.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaCustomerDownloadInitiated",message:"Could not find Interaction with an associated InteractionContext with ID: "+c.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+c.id);var e=d.getInteractionMedia();e.messages.push(c.message),e._onCustomerDownloadInitiated.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaCustomerDownloadInitiated",message:c})}function E(b,c){var d=b.find(function(a){return a._interactionMedia&&a._interactionMedia.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaCustomerDownloadComplete",message:"Could not find Interaction with an associated InteractionContext with ID: "+c.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+c.id);var e=d.getInteractionMedia();e.messages.push(c.message),e._onCustomerDownloadComplete.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaCustomerDownloadComplete",message:c})}function F(b,c){var d=b.find(function(a){return a._interactionMedia&&a._interactionMedia.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaConnected",message:"Could not find Interaction with an associated InteractionContext with ID: "+c.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+c.id);c.interactionId=d.id;var e=d.getInteractionMedia();e.notifications.push(c),e._onConnected.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaConnected",message:c})}function G(b,c){var d=b.find(function(a){return a._interactionMedia&&a._interactionMedia.id===c.id});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionMediaDisconnected",message:"Could not find Interaction with an associated InteractionContext with ID: "+c.id}),new Error("Could not find Interaction with an associated InteractionMedia with ID: "+c.id);c.interactionId=d.id;var e=d.getInteractionMedia();e.notifications.push(c),e._onDisconnected.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionMediaDisconnected",message:c})}function H(b,c){var d=b.find(function(a){return a.data.contactId===c.ucid});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionAudioUpdated",message:"Could not find Interaction with contact ID: "+c.ucid}),new Error("Could not find Interaction with contact ID: "+c.ucid);d.data.audioMuted=c.isMuted,d._onAudioUpdated.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionAudioUpdated",message:c})}function I(b,c){var d=b.find(function(a){return a.data.contactId===c.ucid});if(!d)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionSpeakerUpdated",message:"Could not find Interaction with contact ID: "+c.ucid}),new Error("Could not find Interaction with contact ID: "+c.ucid);d.data.speakerMuted=c.isMuted,d._onSpeakerUpdated.fire(c),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionSpeakerUpdated",message:c})}function J(c,d){if(!b.isUndefined(d.stream)&&!b.isUndefined(d.ucid)){var e=c.find(function(a){return a.data.contactId===d.ucid});if(!e)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionVideoUpdated",message:"Could not find Interaction with ID: "+d.ucid}),new Error("Could not find Interaction with ID: "+d.ucid);var f=b.find(e._videoStreams,{id:d.id});f?b.assignIn(f,d):e._videoStreams.push(d),e._onVideoUpdated.fire(d),a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionVideoUpdated",message:d})}}function K(a,b){var c=a.find(function(a){return a.data.contactId===b.ucid});if(c&&"VIDEO"===c.data.channel&&b.isVideoDeviceAvailable){var d="RECEIVE_ONLY";b.isVideoSupported&&(d="SEND_RECEIVE"),b.call.setVideoMode(d)}b.call.accept()}function L(a,b){var c=a.find(function(a){return a.data.contactId===b.ucid});if(c&&"VIDEO"===c.data.channel){var d="RECEIVE_ONLY";b.isVideoDeviceAvailable&&(d="SEND_RECEIVE"),b.call.acceptSendVideo(d)}else b.call.denySendVideo()}function M(c,d,e){if(!b.isUndefined(e.error)&&!b.isUndefined(e.ucid)){var f=d.find(function(a){return a.data.contactId===e.ucid});if(!f)throw a.Base.Logger.error("Work Service",{scope:"Work Service - onInteractionError",message:"Could not find Interaction with ID: "+e.ucid}),new Error("Could not find Interaction with ID: "+e.ucid);a.Base.Logger.debug("Work Service",{scope:"Work Service - onInteractionError",message:e}),c.trigger("error",[e.error])}}c.prototype={init:function(a,c,N){this._started=!0,this._interactionsProvider.on("interaction.created",b.bind(d,null,a,c,N)),this._interactionsProvider.on("interaction.active",b.bind(e,null,a,c,N)),this._interactionsProvider.on("interaction.held",b.bind(g,null,a,c,N)),this._interactionsProvider.on("interaction.acw",b.bind(h,null,a,c,N)),this._interactionsProvider.on("interaction.acw_pending",b.bind(i,null,a,c,N)),this._interactionsProvider.on("interaction.passive",b.bind(j,null,a,c,N)),this._interactionsProvider.on("interaction.updated",b.bind(k,null,a,c,N)),this._interactionsProvider.on("interaction.deleted",b.bind(l,null,a,c,N)),this._interactionsProvider.on("interaction.unknown",b.bind(f,null,a,c,N)),this._interactionsProvider.on("interaction.destination_participant_accepted",b.bind(m,null,N)),this._interactionsProvider.on("interaction_media.created",b.bind(n,null,this,N)),this._interactionsProvider.on("interaction_media.message.created",b.bind(o,null,N)),this._interactionsProvider.on("interaction_media.message.is_typing",b.bind(p,null,N)),this._interactionsProvider.on("interaction_media.participant.joined",b.bind(q,null,N)),this._interactionsProvider.on("interaction_media.participant.left",b.bind(r,null,N)),this._interactionsProvider.on("interaction_media.participant.list",b.bind(s,null,N)),this._interactionsProvider.on("interaction_media.page_push",b.bind(w,null,N)),this._interactionsProvider.on("interaction_media.email_message",b.bind(z,null,N)),this._interactionsProvider.on("interaction_media.forward_sent",b.bind(x,null,N)),this._interactionsProvider.on("interaction_media.email_file_limit_exceeded",b.bind(y,null,N)),this._interactionsProvider.on("interaction_media.email_attachments_added",b.bind(A,null,N)),this._interactionsProvider.on("interaction_media.email_attachments_removed",b.bind(B,null,N)),this._interactionsProvider.on("interaction_media.message.transferred_file",b.bind(C,null,N)),this._interactionsProvider.on("interaction_media.message.customer_download_initiated",b.bind(D,null,N)),this._interactionsProvider.on("interaction_media.message.customer_download_complete",b.bind(E,null,N)),this._interactionsProvider.on("interaction_media.connected",b.bind(F,null,N)),this._interactionsProvider.on("interaction_media.disconnected",b.bind(G,null,N)),this._interactionsProvider.on("interaction_context.created",b.bind(t,null,N)),this._interactionsProvider.on("interaction_context.updated",b.bind(u,null,N)),this._interactionsProvider.on("interaction_context.deleted",b.bind(v,null,N)),this._interactionsProvider.on("interaction.audio_updated",b.bind(H,null,N)),this._interactionsProvider.on("interaction.speaker_updated",b.bind(I,null,N)),this._interactionsProvider.on("interaction.video_updated",b.bind(J,null,N)),this._interactionsProvider.on("interaction.answer.requested",b.bind(K,null,N)),this._interactionsProvider.on("interaction.add_video.request",b.bind(L,null,N)),this._interactionsProvider.on("interaction.error",b.bind(M,null,this._interactionsProvider,N))},stop:function(){this._started=!1,this._interactionsProvider.removeListeners("interaction"),this._interactionsProvider.removeListeners("interaction_media"),this._interactionsProvider.removeListeners("interaction_context")},start:function(a,b,c){var d=this._agent.getHandle();return this._interactionsProvider.initiate(d,a,b,c)},end:function(a,b){var c=this._agent.getHandle();return this._interactionsProvider.end(c,a.workRequestId,a.id,b)},reject:function(a){var b=this._agent.getHandle();return this._interactionsProvider.reject(b,a.workRequestId,a.id)},defer:function(a,b,c,d,e){var f=this._agent.getHandle();return this._interactionsProvider.defer(f,a.workRequestId,a.id,b,c,d,e)},deferForward:function(a,b,c,d,e){var f=this._agent.getHandle();return this._interactionsProvider.deferForward(f,a.workRequestId,a.id,b,c,d,e)},hold:function(a){var b=this._agent.getHandle();return this._interactionsProvider.hold(b,a.workRequestId,a.id)},unhold:function(a){var b=this._agent.getHandle();return this._interactionsProvider.unhold(b,a.workRequestId,a.id)},accept:function(a){var b=this._agent.getHandle();return this._interactionsProvider.accept(b,a.workRequestId,a.id)},transfer:function(a,b){var c=this._agent.getHandle();return this._interactionsProvider.transfer(c,a.workRequestId,a.id,b)},transferToService:function(a,b){var c=this._agent.getHandle();return this._interactionsProvider.transferToService(c,a.workRequestId,a.id,b)},transferToUser:function(a,b){var c=this._agent.getHandle();return this._interactionsProvider.transferToUser(c,a.workRequestId,a.id,b)},consultToService:function(a,b,c){var d=this._agent.getHandle();return this._interactionsProvider.consultToService(d,a.workRequestId,a.id,b,c)},getServices:function(a){var b=this._agent.getHandle();return this._interactionsProvider.getServices(b,a.workRequestId,a.id,a.data.channel)},getUsers:function(a,b){var c=this._agent.getHandle();return this._interactionsProvider.getUsers(c,a.workRequestId,a.id,b)},getCall:function(a){var c;return b.isFunction(this._interactionsProvider.getCall)&&(c=this._interactionsProvider.getCall(a)),c},retrieveDeferredInteraction:function(a){var b=this._agent.getHandle();return this._interactionsProvider.retrieveDeferredInteraction(b,a.id)},removeDeferredInteraction:function(a){var b=this._agent.getHandle();return this._interactionsProvider.removeDeferredInteraction(b,a.workRequestId,a.id)},consult:function(a,b,c){var d=this._agent.getHandle();return this._interactionsProvider.consult(d,a.workRequestId,a.id,b,c)},consultCompleteAsTransfer:function(a){var b=this._agent.getHandle();return this._interactionsProvider.consultCompleteAsTransfer(b,a.workRequestId,a.id)},consultCompleteAsConference:function(a){var b=this._agent.getHandle();return this._interactionsProvider.consultCompleteAsConference(b,a.workRequestId,a.id)},extendACW:function(a){var b=this._agent.getHandle();return this._interactionsProvider.extendACW(b,a.workRequestId,a.id)},completeACW:function(a){var b=this._agent.getHandle();return this._interactionsProvider.completeACW(b,a.workRequestId,a.id)},sendMessage:function(a,b,c){var d=this._agent.getHandle(),e=a.data.workRequestId,f=a.data.interactionId,g=JSON.stringify({subject:"",body:b,importance:a.getImportance(),interactionMediaId:a.id,eventType:"MESSAGE",sensitivity:c});return this._interactionsProvider.sendMessage(d,e,f,g)},sendRichMediaMessage:function(a,c,d,e){var f=this._agent.getHandle(),g=a.data.workRequestId,h=a.data.interactionId,i={body:c,eventType:"RICHMEDIA",interactionMediaId:a.id,subject:"",richMediaType:d};return i=JSON.stringify(b.assignIn(i,e)),this._interactionsProvider.sendMessage(f,g,h,i)},sendEmailMessage:function(a,b){var c=this._agent.getHandle(),d=a.data.workRequestId,e=a.data.interactionId,f=JSON.stringify({subject:b.subject,body:b.message,to:b.to,from:b.from,cc:b.cc||[],bcc:b.bcc||[],importance:a.getImportance(),interactionMediaId:a.id});return this._interactionsProvider.sendEmailMessage(c,d,e,f,b.type)},reportTyping:function(a,b){var c=this._agent.getHandle(),d=a.data.workRequestId,e=a.data.interactionId,f=JSON.stringify({subject:"",body:"",importance:a.getImportance(),interactionMediaId:a.id,eventType:"IS_TYPING",sensitivity:b});return this._interactionsProvider.sendMessage(c,d,e,f)},sendPagePushUrl:function(a,b,c){var d=this._agent.getHandle(),e=a.data.workRequestId,f=a.data.interactionId,g=JSON.stringify({subject:"",body:b,importance:a.getImportance(),interactionMediaId:a.id,eventType:"PAGE_PUSH",sensitivity:c});return this._interactionsProvider.sendMessage(d,e,f,g)},sendCoBrowseSessionKey:function(a,b){var c=this._agent.getHandle(),d=a.data.workRequestId,e=a.data.interactionId,f=JSON.stringify({subject:"",body:b,importance:a.getImportance(),interactionMediaId:a.id,eventType:"COBROWSE_SESSION_KEY"});return this._interactionsProvider.sendMessage(c,d,e,f)},setWorkCode:function(a,b){var c=this._agent.getHandle();return this._interactionsProvider.setWorkCode(c,a.workRequestId,a.id,b)},setDispositionCode:function(a,b){var c=this._agent.getHandle();return this._interactionsProvider.setDispositionCode(c,a.workRequestId,a.id,b)},sendDTMF:function(a,b){var c=this._agent.getHandle();return this._interactionsProvider.sendDTMF(c,a.workRequestId,a.id,b)},removeAttachments:function(a,b){var c=this._agent.getHandle(),d=a.data.workRequestId,e=a.data.interactionId;return this._interactionsProvider.removeAttachments(c,d,e,b)},applyDraftAttachments:function(a){var b=this._agent.getHandle(),c=a.data.workRequestId,d=a.data.interactionId;return this._interactionsProvider.applyDraftAttachments(b,c,d)},applyForwardAttachments:function(a){var b=this._agent.getHandle(),c=a.data.workRequestId,d=a.data.interactionId;return this._interactionsProvider.applyForwardAttachments(b,c,d)},muteAudio:function(a){return this._interactionsProvider.muteAudio(a)},unmuteAudio:function(a){return this._interactionsProvider.unmuteAudio(a)},setVideoMode:function(a,b){return this._interactionsProvider.setVideoMode(a,b)},enableLocalVideo:function(a){return this.setVideoMode(a,"SEND_RECEIVE")},disableLocalVideo:function(a){return this.setVideoMode(a,"RECEIVE_ONLY")}},a.Services.Work.WorkService=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(){a.Base.Collections.Model.call(this,{idAttribute:"header"})}c.prototype={getHeader:function(){return this.data.header},getValue:function(){return this.data.value}},b.defaults(c.prototype,a.Base.Collections.Model.prototype),a.Base.Authentication.Token=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(){a.Base.Collections.Collection.call(this,a.Base.Authentication.Token,{idAttribute:"header"})}c.prototype={findAllByTokenTypes:function(a){var c=[];return b.forEach(a,b.bind(function(a){c.push(this.findAll({id:a}))},this)),b.flatten(c)}},b.defaults(c.prototype,a.Base.Collections.Collection.prototype),a.Base.Authentication.TokenCollection=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(){a.Base.Collections.Collection.call(this,a.Base.Mediator.Provider),this._mediator=new a.Base.Mediator}c.prototype={createProvider:function(a,d,e){var f=b.find(c.Types,{key:e});if(f){var g=a.fetchByName(f.prerequisites),h=f.initialise(d,g);this.add(h),this._mediator.injectProvider(h,f.provider)}},removeProvider:function(a){var d=b.find(c.Types,{key:a});if(d){var e=d.destroy();this.remove(e),this._mediator.removeProvider(d.provider)}},getMediator:function(){return this._mediator},removeMediator:function(){return this._mediator=null,this._mediator}},c.Types=[{provider:"UAC",key:"uacConfiguration",prerequisites:["tokenCollection"],model:a.Providers.UAC.Provider,initialise:function(b,c){var d=new a.Providers.UAC.ProviderFactory(c.tokenCollection);return d.init(b)},destroy:function(){}},{provider:"CP",key:"cpConfiguration",model:a.Providers.CP.Provider,initialise:function(b){var c=new a.Providers.CP.ProviderFactory;return c.init(b)},destroy:function(){}}],b.defaults(c.prototype,a.Base.Collections.Collection.prototype),a.Base.Mediator.ProviderCollection=c}(AvayaCustomerServices,_),function(a,b,c){"use strict";function d(b,c,d){a.Base.Observable.call(this),this._tokenProvider=b,this._config=c,this._options=d,this._xhrPool=[],this.name=c.name}function e(c,d,e,g){var h=new a.Base.Network.HTTPRequest({}),i=h.encode(d.data);"GET"===d.method&&i&&(d.url+="?"+i,i=null),h.open(d.method,d.url,d.options.async),h.setRequestHeaders(d.options.headers),h.addOnStateChangeCallback(b.bind(f,null,c,h,e,g)),h.setTimeout(d.options.timeout||9e4),h.send(i),c._xhrPool.push(h)}function f(c,d,e,f,g){var h=g&&g.currentTarget?g.currentTarget:d._xhr;if(4===h.readyState){if(!h.status||(h.status<200||h.status>=300)&&304!==h.status)a.Base.Logger.error("Rest Provider",h),c.trigger("xhr.error",[h&&h.responseText?h:{code:500003}]),f(h);else if(h.responseText.length>0)try{var i=a.Base.Utils.parseJSON(h.responseText);a.Base.Logger.debug("Rest Provider",h),e(i,h)}catch(j){a.Base.Logger.error("Rest Provider",b.assignIn({},j,{code:500003})),c.trigger("xhr.error",[b.assignIn({},j,{code:500003})]),f(h)}else a.Base.Logger.debug("Rest Provider",h),e(null,h);var k=c._xhrPool.indexOf(d);k>-1&&c._xhrPool.splice(k,1)}}d.prototype={send:function(a,d,f,g){g=b.assignIn({},this._options,g),g.headers=b.assignIn({},this._options.headers,this._tokenProvider.getTokens(),g.headers);var h={method:a,url:this._config.apiUrl+d,options:g,data:f};return new c(b.bind(e,null,this,h))},get:function(a,b,c){return this.send("GET",a,b,c)},post:function(a,b,c){return this.send("POST",a,b,c)},put:function(a,b,c){return this.send("PUT",a,b,c)},del:function(a,b,c){return this.send("DELETE",a,b,c)},close:function(){b.forEach(this._xhrPool,function(a){a.abort()}),this._xhrPool=[]}},b.defaults(d.prototype,a.Base.Observable.prototype),a.Base.Network.RESTProvider=d}(AvayaCustomerServices,_,RSVP.Promise),function(a,b){"use strict";function c(c){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.AGENT_ACTIVATED),this.id=c.newValue.userDetails.id,this.handle=c.newValue.userDetails.userHandle,this.role=c.newValue.userSession.role,this.firstName=c.newValue.userDetails.firstName,this.lastName=c.newValue.userDetails.lastName,this.displayName=c.newValue.userDetails.displayName,this.mailboxNumber=c.newValue.mailboxNumber,this.trunkAccessCode=c.newValue.trunkAccessCode,this.reasonCodes=b.sortBy(c.newValue.reasonCodes,function(a){return parseInt(a.code)}),this.userProfilePreferences=c.newValue.userProfilePreferences,this.userProfileAccountPreferences=c.newValue.userProfileAccountPreferences,this.isActivated=!0,this.isReserveActive=c.newValue.userSession.isReserveActive,this.templateGroups=c.newValue.templateGroups,this.hideRetrieveEmailDraft=!(!c.newValue.userSession.capabilities||"undefined"==typeof c.newValue.userSession.capabilities.hideRetrieveEmailDraft||c.newValue.userSession.capabilities.hideRetrieveEmailDraft===!1)}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.AgentActivateEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.AGENT_DEACTIVATED),this.isActivated=!1,this.reason=b.newValue.reason}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.AgentDeactivateEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b,c){a.Providers.UAC.Message.call(this,b),this.resourceStates=d(c.resourceStates),this.currentState=a.Providers.UAC.MessageTypes.agentState[c.currentState],this.previousState=a.Providers.UAC.MessageTypes.agentState[c.previousState],this.capabilities=c.capabilities,this.isReserveActive=c.isReserveActive,this.lastStateChangeTime=c.lastStateChangeTime}function d(c){var d={};return b.forEach(c,function(b){var c=a.Providers.UAC.MessageTypes.resourceTypes[b.channelType];d[c]={state:a.Providers.UAC.MessageTypes.resourceState[b.state],stateReason:b.stateReason,capabilities:b.capabilities}}),d}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.AgentStateMessage=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.AgentStateMessage.call(this,a.Providers.UAC.MessageTypes.eventName.AGENT_STATE_UNKNOWN,b.newValue)}b.defaults(c.prototype,a.Providers.UAC.AgentStateMessage.prototype),a.Providers.UAC.AgentUnknownStateEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.CONFIGURATION_CREATED),this.settings=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.ConfigurationCreatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.CONFIGURATION_DELETED),this.settings=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.ConfigurationDeletedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.CONFIGURATION_UPDATED),this.settings=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.ConfigurationUpdatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.DEFERRED_INTERACTION),this.id=b.newValue.id,this.contactId=b.newValue.contactId,this.channel=a.Providers.UAC.Response.channelTypes[b.newValue.channelType],this.workRequestId=b.newValue.workRequestId,this.capabilities=b.newValue.capabilities,this.customer=b.newValue.customer,this.externalInteractionId=b.newValue.externalInteractionId,this.userSessionId=b.newValue.userSessionId,this.service=b.newValue.service,this.deferTime=b.newValue.deferTime,this.deferCode=b.newValue.deferCode,this.routingId=b.newValue.routingId,this.providerId=b.newValue.providerId,this.resourceAddress=b.newValue.resourceAddress,this.deferInteractionState=a.Providers.UAC.Response.deferInteractionStates[b.newValue.deferInteractionState]}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.DeferredInteractionEvent=c}(AvayaCustomerServices,_),function(a){"use strict";function b(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.ERROR),this.code=b.newValue.code,this.message=b.newValue.message,this.reason=b.newValue.detail,this.scope=b.newValue.scope,this.scopeId=b.newValue.scopeId,this.severity=b.newValue.severity,this.source=b.newValue.source,this.messagePlaceholders=b.newValue.messagePlaceholders}a.Providers.UAC.ErrorEvent=b}(AvayaCustomerServices),function(a,b){"use strict";function c(c,d){a.Providers.UAC.Message.call(this,c),this.pagePushUrl=b.filter(d,{type:"PAGE_PUSH"}),this.suggestedPhrase=b.filter(d,{type:"SUGGESTED_PHRASE"}),this.contextStore=b.filter(d,{type:"CONTEXT_STORE"}),this.screenPop=b.filter(d,{type:"SCREEN_POP"}),this.cobrowse=b.filter(d,{type:"COBROWSE"}),this.customerHistory=b.filter(d,{type:"CUSTOMER_HISTORY"}),this.customerDetails=b.filter(d,{type:"CUSTOMER_DETAILS"}),this.clientValidation=b.filter(d,{type:"CLIENT_VALIDATION"}),this.campaignScripts=b.filter(d,{type:"CAMPAIGN_SCRIPT"}),this.fromAddresses=b.filter(d,{type:"ORIGINATOR"}),this.textDir=b.filter(d,{type:"TEXT_DIRECTION"})}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionContextMessage=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.InteractionContextMessage.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_CONTEXT_UPDATED,b.newValue),this.id=b.parentId}b.defaults(c.prototype,a.Providers.UAC.InteractionContextMessage.prototype),a.Providers.UAC.InteractionContextUpdatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_DELETE),this.id=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionDeleteEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(c){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_CREATED),this.id=c.newValue.interactionMediaId,this.workRequestId=c.newValue.workRequestId,this.interactionId=c.newValue.uamInteractionId,this.participants=c.newValue.participants,this.messages=b.filter(c.newValue.chatMessages,function(a){var b=a&&a.chatMessageEvent&&a.chatMessageEvent.chatEventType;return!!d[b]})}var d={MESSAGE:"MESSAGE",PAGE_PUSH:"PAGE_PUSH",TRANSFERRED_FILE:"TRANSFERRED_FILE",CUSTOMER_DOWNLOAD_INITIATED:"CUSTOMER_DOWNLOAD_INITIATED",CUSTOMER_DOWNLOAD_COMPLETE:"CUSTOMER_DOWNLOAD_COMPLETE",QUERY_RESPONSE:"QUERY_RESPONSE",WIDGET:"WIDGET"};b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaChatCreatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_CONNECTED),this.id=b.newValue.interactionMediaId,this.participant=b.newValue.receivedFrom,this.type=a.Providers.UAC.Response.mediaEventTypes.CONNECTED}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaConnectedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_CUSTOMER_DOWNLOAD_COMPLETE),
this.id=b.newValue.interactionMediaId,this.attachment=b.newValue.parts.length?b.newValue.parts[0]:{},this.receivedFrom=b.newValue.receivedFrom,this.arrivalDate=b.newValue.arrivalDate,this.message=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaCustomerDownloadCompleteEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_CUSTOMER_DOWNLOAD_INITIATED),this.id=b.newValue.interactionMediaId,this.attachment=b.newValue.parts.length?b.newValue.parts[0]:{},this.receivedFrom=b.newValue.receivedFrom,this.arrivalDate=b.newValue.arrivalDate,this.message=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaCustomerDownloadInitiatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_DELETED),this.id=b.newValue,this.type=a.Providers.UAC.Response.mediaUpdateTypes.DELETE}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaDeleteEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_DISCONNECTED),this.id=b.newValue.interactionMediaId,this.participant=b.newValue.receivedFrom,this.type=a.Providers.UAC.Response.mediaEventTypes.DISCONNECTED}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaDisconnectedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_EMAIL_ATTACHMENTS_ADDED),this.id=b.newValue.interactionMediaId,this.attachments=b.newValue.parts}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaEmailAttachmentsAddedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_EMAIL_ATTACHMENTS_REMOVED),this.id=b.newValue.interactionMediaId,this.attachments=b.newValue.parts}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaEmailAttachmentsRemovedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(c){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_CREATED),this.id=c.newValue.interactionMediaId,this.workRequestId=c.newValue.workRequestId,this.interactionId=c.newValue.uamInteractionId,this.participants=c.newValue.participants,this.messages=b.filter(c.newValue.emailMessages,function(a){return a&&a.emailMessageEvent&&a.emailMessageEvent.emailEventType&&"MESSAGE"===a.emailMessageEvent.emailEventType}),this.draftMessages=b.filter(c.newValue.emailMessages,function(a){return a&&a.emailMessageEvent&&a.emailMessageEvent.emailEventType&&"DRAFT"===a.emailMessageEvent.emailEventType})}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaEmailCreatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_EMAIL_EMAIL_FILE_LIMIT_EXCEEDED),this.id=b.newValue.interactionMediaId,this.message=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaEmailFileLimitExceededEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_EMAIL_FORWARD_SENT),this.id=b.newValue.interactionMediaId,this.message=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaEmailForwardSentEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_EMAIL_MESSAGE),this.id=b.newValue.interactionMediaId,this.message=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaEmailMessageEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){if(a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_MESSAGE_CREATED),this.id=b.newValue.interactionMediaId,this.message=b.newValue,this.message.type===a.Providers.UAC.Response.channelTypes.MESSAGING&&(this.message.chatMessageEvent.chatEventType===a.Providers.UAC.Response.mediaEventTypes.ERROR&&(this.message.errorDescription=this.message.body,delete this.message.body),this.message.customData)){var c=a.Base.Utils.parseJSON(this.message.customData);c&&c.asyncMessageInfo&&c.asyncMessageInfo.message&&(c=c.asyncMessageInfo.message),c&&(this.message.body=c,delete this.message.customData)}}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaMessageCreatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_MESSAGE_IS_TYPING),this.id=b.newValue.interactionMediaId,this.participant=b.newValue.receivedFrom,this.type=a.Providers.UAC.Response.mediaEventTypes.IS_TYPING}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaMessageIsTypingEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_PAGE_PUSH),this.id=b.newValue.interactionMediaId,this.message=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaPagePushUrlEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_PARTICIPANT_JOINED),this.id=b.newValue.interactionMediaId,this.participant=b.newValue.participant,this.participants=b.newValue.interactionMedia.participants}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaParticipantJoinedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_PARTICIPANT_LEFT),this.id=b.newValue.interactionMediaId,this.participant=b.newValue.participant,this.participants=b.newValue.interactionMedia.participants}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaParticipantLeftEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(c){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_PARTICIPANT_LIST),this.id=c.parentId,this.participants=b.toArray(c.newValue)}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaParticipantListEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(c){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_CREATED),this.id=c.newValue.interactionMediaId,this.workRequestId=c.newValue.workRequestId,this.interactionId=c.newValue.uamInteractionId,this.participants=c.newValue.participants,this.messages=b.filter(c.newValue.chatMessages,function(a){var b=a&&a.chatMessageEvent&&a.chatMessageEvent.chatEventType;return!!d[b]}),this.messages=b.forEach(this.messages,function(b){if(b.chatMessageEvent.chatEventType===d.ERROR&&(b.errorDescription=b.body,delete b.body),b.customData){var c=a.Base.Utils.parseJSON(b.customData);c&&c.asyncMessageInfo&&c.asyncMessageInfo.message&&(c=c.asyncMessageInfo.message),c&&(b.body=c,delete b.customData)}})}var d={RICHMEDIA:"RICHMEDIA",ERROR:"ERROR",PAGE_PUSH:"PAGE_PUSH",TRANSFERRED_FILE:"TRANSFERRED_FILE",CUSTOMER_DOWNLOAD_INITIATED:"CUSTOMER_DOWNLOAD_INITIATED",CUSTOMER_DOWNLOAD_COMPLETE:"CUSTOMER_DOWNLOAD_COMPLETE",QUERY_RESPONSE:"QUERY_RESPONSE",WIDGET:"WIDGET"};b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaRichMediaCreatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(c){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_CREATED),this.id=c.newValue.interactionMediaId,this.workRequestId=c.newValue.workRequestId,this.interactionId=c.newValue.uamInteractionId,this.participants=c.newValue.participants,this.messages=b.filter(c.newValue.chatMessages,function(a){var b=a&&a.chatMessageEvent&&a.chatMessageEvent.chatEventType;return!!d[b]}),this.type=c.newValue.type,this.source=c.newValue.source,this.chatFlags=c.newValue.chatFlags}var d={MESSAGE:"MESSAGE",PAGE_PUSH:"PAGE_PUSH",TRANSFERRED_FILE:"TRANSFERRED_FILE",CUSTOMER_DOWNLOAD_INITIATED:"CUSTOMER_DOWNLOAD_INITIATED",CUSTOMER_DOWNLOAD_COMPLETE:"CUSTOMER_DOWNLOAD_COMPLETE"};b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaSocialCreatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_MEDIA_TRANSFERRED_FILE),this.id=b.newValue.interactionMediaId,this.attachments=b.newValue.parts,this.receivedFrom=b.newValue.receivedFrom,this.arrivalDate=b.newValue.arrivalDate,this.message=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMediaTransferredFileEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b,c){a.Providers.UAC.Message.call(this,b),this.id=c.newValue.id,this.contactId=c.newValue.contactId,this.channel=a.Providers.UAC.Response.channelTypes[c.newValue.channelType],this.state=a.Providers.UAC.Response.interactionStates[c.newValue.currentState],this.createdAt=c.newValue.created,this.capabilities=c.newValue.capabilities,this.workRequestId=c.newValue.workRequestId,this.originatingAddress=c.newValue.originatingAddress,this.destinationAddress=c.newValue.destinationAddress,this.direction=c.newValue.direction,this.isCustomerInteraction=c.newValue.isCustomerInteraction,this.isRoutingDefaulted=c.newValue.isRoutingDefaulted,this.workCode=c.newValue.workCode,this.dispositionCode=c.newValue.dispositionCode,this.deferCode=c.newValue.deferCode,this.participants=c.newValue.participants,this.userToUserInfo=c.newValue.userToUserInfo,this.isWebRtcCall=c.newValue.isWebRtcCall,this.isACWEnabled=c.newValue.isACWEnabled,this.isACWExtended=c.newValue.isACWExtended,this.isAutoAnswerEnabled=c.newValue.isAutoAnswerEnabled,this.autoAnswerTimerExpireDT=c.newValue.autoAnswerTimerExpireDT,this.topic=c.newValue.topic,this.topicId=c.newValue.topicId,this.establishedTime=c.newValue.establishedTime,this.stateChangeTime=c.newValue.lastStateChangeTime,this.acwEstablishedTime=c.newValue.acwEstablishedTime,this.acwDuration=c.newValue.acwDuration,this.externalInteractionId=c.newValue.externalInteractionId,this.interactionType=c.newValue.interactionType,this.stateReason=c.newValue.stateReason,this.isObserved=c.newValue.isObserved,this.isTransferredToService=c.newValue.isTransferredToService,this.isTransferredToUser=c.newValue.isTransferredToUser,this.skill=c.newValue.skill,this.skillId=c.newValue.skillId,this.intrinsics=c.newValue.intrinsics,this.isCallback=c.newValue.isCallback,this.tenantId=c.newValue.tenantId,this.tenantName=c.newValue.tenantName}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionMessage=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.InteractionMessage.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_PASSIVE,b)}b.defaults(c.prototype,a.Providers.UAC.InteractionMessage.prototype),a.Providers.UAC.InteractionPassiveEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.Message.call(this,a.Providers.UAC.MessageTypes.eventName.DESTINATION_PARTICIPANT_ACCEPTED),this.id=b.newValue}b.defaults(c.prototype,a.Providers.UAC.Message.prototype),a.Providers.UAC.InteractionRemoteParticipantAcceptedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.InteractionMessage.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_UNKNOWN,b)}b.defaults(c.prototype,a.Providers.UAC.InteractionMessage.prototype),a.Providers.UAC.InteractionUnknownEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.InteractionMessage.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_UPDATE,b)}b.defaults(c.prototype,a.Providers.UAC.InteractionMessage.prototype),a.Providers.UAC.InteractionUpdateEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.AgentStateMessage.call(this,a.Providers.UAC.MessageTypes.eventName.AGENT_STATE_AFTER_CONTACT_WORK_PENDING,b.newValue),this.reasonCode=b.newValue.stateReason}b.defaults(c.prototype,a.Providers.UAC.AgentStateMessage.prototype),a.Providers.UAC.AgentAfterContactWorkPendingStateEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.AgentStateMessage.call(this,a.Providers.UAC.MessageTypes.eventName.AGENT_STATE_AFTER_CONTACT_WORK,b.newValue),this.reasonCode=b.newValue.stateReason}b.defaults(c.prototype,a.Providers.UAC.AgentStateMessage.prototype),a.Providers.UAC.AgentAfterContactWorkStateEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.AgentStateMessage.call(this,a.Providers.UAC.MessageTypes.eventName.AGENT_STATE_COMPLETE,b.newValue)}b.defaults(c.prototype,a.Providers.UAC.AgentStateMessage.prototype),a.Providers.UAC.AgentCompleteStateEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.AgentStateMessage.call(this,a.Providers.UAC.MessageTypes.eventName.AGENT_STATE_LOGGED_OUT,b.newValue),this.reasonCode=b.newValue.stateReason}b.defaults(c.prototype,a.Providers.UAC.AgentStateMessage.prototype),a.Providers.UAC.AgentLoggedOutStateEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.AgentStateMessage.call(this,a.Providers.UAC.MessageTypes.eventName.AGENT_STATE_LOGIN_PENDING,b.newValue)}b.defaults(c.prototype,a.Providers.UAC.AgentStateMessage.prototype),a.Providers.UAC.AgentLoginPendingStateEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.AgentStateMessage.call(this,a.Providers.UAC.MessageTypes.eventName.AGENT_STATE_LOGOUT_PENDING,b.newValue),this.reasonCode=b.newValue.stateReason}b.defaults(c.prototype,a.Providers.UAC.AgentStateMessage.prototype),a.Providers.UAC.AgentLogoutPendingStateEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.AgentStateMessage.call(this,a.Providers.UAC.MessageTypes.eventName.AGENT_STATE_NOT_READY_PENDING,b.newValue),this.reasonCode=b.newValue.stateReason}b.defaults(c.prototype,a.Providers.UAC.AgentStateMessage.prototype),a.Providers.UAC.AgentNotReadyPendingStateEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.AgentStateMessage.call(this,a.Providers.UAC.MessageTypes.eventName.AGENT_STATE_NOT_READY,b.newValue),this.reasonCode=b.newValue.stateReason}b.defaults(c.prototype,a.Providers.UAC.AgentStateMessage.prototype),a.Providers.UAC.AgentNotReadyStateEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.AgentStateMessage.call(this,a.Providers.UAC.MessageTypes.eventName.AGENT_STATE_READY,b.newValue)}b.defaults(c.prototype,a.Providers.UAC.AgentStateMessage.prototype),a.Providers.UAC.AgentReadyStateEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.InteractionMessage.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_ACTIVE,b)}b.defaults(c.prototype,a.Providers.UAC.InteractionMessage.prototype),a.Providers.UAC.InteractionActiveEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.InteractionMessage.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_ACW,b)}b.defaults(c.prototype,a.Providers.UAC.InteractionMessage.prototype),a.Providers.UAC.InteractionACWEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.InteractionMessage.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_ACW_PENDING,b)}b.defaults(c.prototype,a.Providers.UAC.InteractionMessage.prototype),a.Providers.UAC.InteractionACWPendingEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.InteractionContextMessage.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_CONTEXT_CREATED,b.newValue.contexts),this.id=b.newValue.id,this.interactionId=b.newValue.interactionId}b.defaults(c.prototype,a.Providers.UAC.InteractionContextMessage.prototype),a.Providers.UAC.InteractionContextCreatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.InteractionContextMessage.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_CONTEXT_DELETED,b.newValue),this.id=b.parentId}b.defaults(c.prototype,a.Providers.UAC.InteractionContextMessage.prototype),a.Providers.UAC.InteractionContextDeleteEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.InteractionMessage.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_CREATED,b)}b.defaults(c.prototype,a.Providers.UAC.InteractionMessage.prototype),a.Providers.UAC.InteractionCreatedEvent=c}(AvayaCustomerServices,_),function(a,b){"use strict";function c(b){a.Providers.UAC.InteractionMessage.call(this,a.Providers.UAC.MessageTypes.eventName.INTERACTION_HELD,b)}b.defaults(c.prototype,a.Providers.UAC.InteractionMessage.prototype),a.Providers.UAC.InteractionHeldEvent=c}(AvayaCustomerServices,_);